---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-vb
title: Inserción por lotes (VB) | Microsoft Docs
author: rick-anderson
description: Obtenga información sobre cómo insertar varios registros de base de datos en una sola operación. En la capa de interfaz de usuario, se extiende GridView para permitir que el usuario escriba varios...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: 48e2a4ae-77ca-4208-a204-c38c690ffb59
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-vb
msc.type: authoredcontent
ms.openlocfilehash: 413a0e209b1899414eaab70aff07ee0d3223f28f
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78501493"
---
# <a name="batch-inserting-vb"></a><span data-ttu-id="74c00-104">Inserción por lotes (VB)</span><span class="sxs-lookup"><span data-stu-id="74c00-104">Batch Inserting (VB)</span></span>

<span data-ttu-id="74c00-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="74c00-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="74c00-106">[Descargar código](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_VB.zip) o [Descargar PDF](batch-inserting-vb/_static/datatutorial66vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="74c00-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_VB.zip) or [Download PDF](batch-inserting-vb/_static/datatutorial66vb1.pdf)</span></span>

> <span data-ttu-id="74c00-107">Obtenga información sobre cómo insertar varios registros de base de datos en una sola operación.</span><span class="sxs-lookup"><span data-stu-id="74c00-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="74c00-108">En la capa de la interfaz de usuario se extiende GridView para permitir que el usuario escriba varios registros nuevos.</span><span class="sxs-lookup"><span data-stu-id="74c00-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="74c00-109">En la capa de acceso a datos se ajustan las distintas operaciones de inserción dentro de una transacción para asegurarse de que todas las inserciones se realizan correctamente o se revierten todas las inserciones.</span><span class="sxs-lookup"><span data-stu-id="74c00-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="74c00-110">Introducción</span><span class="sxs-lookup"><span data-stu-id="74c00-110">Introduction</span></span>

<span data-ttu-id="74c00-111">En el tutorial de [actualización por lotes](batch-updating-vb.md) , examinamos la personalización del control GridView para presentar una interfaz en la que varios registros eran editables.</span><span class="sxs-lookup"><span data-stu-id="74c00-111">In the [Batch Updating](batch-updating-vb.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="74c00-112">El usuario que visita la página puede realizar una serie de cambios y, a continuación, con un solo clic de botón, realizar una actualización por lotes.</span><span class="sxs-lookup"><span data-stu-id="74c00-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="74c00-113">En situaciones en las que los usuarios suelen actualizar muchos registros de una sola vez, este tipo de interfaz puede ahorrar innumerables clics y modificadores de contexto de teclado al mouse en comparación con las características de edición por filas predeterminadas que se exploraron primero de nuevo en la [información general sobre la inserción, actualización y eliminación de datos](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="74c00-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial.</span></span>

<span data-ttu-id="74c00-114">Este concepto también se puede aplicar al agregar registros.</span><span class="sxs-lookup"><span data-stu-id="74c00-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="74c00-115">Imagine que aquí en Northwind Traders reciben normalmente envíos de proveedores que contienen varios productos para una categoría determinada.</span><span class="sxs-lookup"><span data-stu-id="74c00-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="74c00-116">Por ejemplo, es posible que recibamos un envío de seis productos diferentes de té y café de Tokio Traders.</span><span class="sxs-lookup"><span data-stu-id="74c00-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="74c00-117">Si un usuario introduce los seis productos a la vez a través de un control DetailsView, tendrán que elegir muchos de los mismos valores una y otra vez: deben elegir la misma categoría (bebidas), el mismo proveedor (Tokyo Traders), el mismo valor que no se ha suspendido ( False) y las mismas unidades en el valor de orden (0).</span><span class="sxs-lookup"><span data-stu-id="74c00-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="74c00-118">Esta entrada repetitiva de datos no solo lleva mucho tiempo, pero es propenso a errores.</span><span class="sxs-lookup"><span data-stu-id="74c00-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="74c00-119">Con un poco de trabajo, podemos crear una interfaz de inserción por lotes que permita al usuario elegir el proveedor y la categoría una vez, especificar una serie de nombres de producto y precios de unidad y, a continuación, hacer clic en un botón para agregar los nuevos productos a la base de datos (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="74c00-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="74c00-120">A medida que se agrega cada producto, se asignan a los campos de datos `ProductName` y `UnitPrice` los valores especificados en los cuadros de texto, mientras que los valores `CategoryID` y `SupplierID` se asignan a los valores de DropDownLists en la parte superior del formulario.</span><span class="sxs-lookup"><span data-stu-id="74c00-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="74c00-121">Los valores `Discontinued` y `UnitsOnOrder` se establecen en los valores codificados de forma rígida de `False` y 0, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="74c00-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `False` and 0, respectively.</span></span>

<span data-ttu-id="74c00-122">[![la interfaz de inserción por lotes](batch-inserting-vb/_static/image2.png)](batch-inserting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-122">[![The Batch Inserting Interface](batch-inserting-vb/_static/image2.png)](batch-inserting-vb/_static/image1.png)</span></span>

<span data-ttu-id="74c00-123">**Figura 1**: la interfaz de inserción por lotes ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-vb/_static/image3.png))</span></span>

<span data-ttu-id="74c00-124">En este tutorial, se creará una página que implementa la interfaz de inserción por lotes que se muestra en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="74c00-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="74c00-125">Al igual que con los dos tutoriales anteriores, se ajustarán las inserciones dentro del ámbito de una transacción para garantizar la atomicidad.</span><span class="sxs-lookup"><span data-stu-id="74c00-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="74c00-126">Vamos a empezar a trabajar.</span><span class="sxs-lookup"><span data-stu-id="74c00-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="74c00-127">Paso 1: creación de la interfaz de visualización</span><span class="sxs-lookup"><span data-stu-id="74c00-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="74c00-128">Este tutorial constará de una sola página que se divide en dos regiones: una región de presentación y una región de inserción.</span><span class="sxs-lookup"><span data-stu-id="74c00-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="74c00-129">La interfaz de visualización, que crearemos en este paso, muestra los productos en un control GridView e incluye un botón titulado envío de producto de proceso.</span><span class="sxs-lookup"><span data-stu-id="74c00-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="74c00-130">Al hacer clic en este botón, la interfaz de visualización se sustituye por la interfaz de inserción, que se muestra en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="74c00-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="74c00-131">La interfaz de visualización se devuelve después de hacer clic en los botones agregar productos desde envío o cancelar.</span><span class="sxs-lookup"><span data-stu-id="74c00-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="74c00-132">Vamos a crear la interfaz de inserción en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="74c00-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="74c00-133">Al crear una página que tiene dos interfaces, solo una de las cuales es visible a la vez, cada interfaz normalmente se coloca dentro de un [control Web de panel](http://www.w3schools.com/aspnet/control_panel.asp), que actúa como contenedor de otros controles.</span><span class="sxs-lookup"><span data-stu-id="74c00-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="74c00-134">Por lo tanto, la página tendrá dos controles de panel uno por cada interfaz.</span><span class="sxs-lookup"><span data-stu-id="74c00-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="74c00-135">Para empezar, abra la página `BatchInsert.aspx` en la carpeta `BatchData` y arrastre un panel desde el cuadro de herramientas hasta el diseñador (vea la figura 2).</span><span class="sxs-lookup"><span data-stu-id="74c00-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="74c00-136">Establezca la propiedad panel s `ID` en `DisplayInterface`.</span><span class="sxs-lookup"><span data-stu-id="74c00-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="74c00-137">Al agregar el panel al diseñador, sus propiedades `Height` y `Width` se establecen en 50px y 125px, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="74c00-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="74c00-138">Borre estos valores de propiedad del ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="74c00-138">Clear out these property values from the Properties window.</span></span>

<span data-ttu-id="74c00-139">[![arrastrar un panel desde el cuadro de herramientas hasta el diseñador](batch-inserting-vb/_static/image5.png)](batch-inserting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-vb/_static/image5.png)](batch-inserting-vb/_static/image4.png)</span></span>

<span data-ttu-id="74c00-140">**Figura 2**: arrastre un panel desde el cuadro de herramientas hasta el diseñador ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-vb/_static/image6.png))</span></span>

<span data-ttu-id="74c00-141">A continuación, arrastre un botón y un control GridView al panel.</span><span class="sxs-lookup"><span data-stu-id="74c00-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="74c00-142">Establezca la propiedad Button s `ID` en `ProcessShipment` y su propiedad `Text` para procesar el envío del producto.</span><span class="sxs-lookup"><span data-stu-id="74c00-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="74c00-143">Establezca la propiedad GridView s `ID` en `ProductsGrid` y, desde su etiqueta inteligente, enlácelo a un nuevo ObjectDataSource denominado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74c00-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="74c00-144">Configure ObjectDataSource para que extraiga sus datos del método `ProductsBLL` Class s `GetProducts`.</span><span class="sxs-lookup"><span data-stu-id="74c00-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="74c00-145">Puesto que este GridView solo se usa para Mostrar datos, establezca las listas desplegables de las pestañas actualizar, insertar y eliminar en (ninguno).</span><span class="sxs-lookup"><span data-stu-id="74c00-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="74c00-146">Haga clic en finalizar para completar el Asistente para configurar orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="74c00-146">Click Finish to complete the Configure Data Source wizard.</span></span>

<span data-ttu-id="74c00-147">[![mostrar los datos devueltos por el método ProductsBLL de la clase GetProducts](batch-inserting-vb/_static/image8.png)](batch-inserting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-vb/_static/image8.png)](batch-inserting-vb/_static/image7.png)</span></span>

<span data-ttu-id="74c00-148">**Figura 3**: mostrar los datos devueltos por el método `ProductsBLL` Class s `GetProducts` ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-vb/_static/image9.png))</span></span>

<span data-ttu-id="74c00-149">[![establecer las listas desplegables de las pestañas actualizar, insertar y eliminar en (ninguna)](batch-inserting-vb/_static/image11.png)](batch-inserting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-vb/_static/image11.png)](batch-inserting-vb/_static/image10.png)</span></span>

<span data-ttu-id="74c00-150">**Figura 4**: establecer las listas desplegables de las pestañas actualizar, insertar y eliminar en (ninguna) ([haga clic para ver la imagen a tamaño completo](batch-inserting-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-vb/_static/image12.png))</span></span>

<span data-ttu-id="74c00-151">Después de completar el Asistente de ObjectDataSource, Visual Studio agregará BoundFields y CheckBoxField para los campos de datos del producto.</span><span class="sxs-lookup"><span data-stu-id="74c00-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="74c00-152">Quite todos los campos, excepto los `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`y `Discontinued`.</span><span class="sxs-lookup"><span data-stu-id="74c00-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="74c00-153">No dude en hacer personalizaciones estéticas.</span><span class="sxs-lookup"><span data-stu-id="74c00-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="74c00-154">Decidí dar formato al campo `UnitPrice` como un valor de moneda, reordenar los campos y cambiar el nombre de varios de los campos `HeaderText` valores.</span><span class="sxs-lookup"><span data-stu-id="74c00-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="74c00-155">Configure también GridView para incluir la compatibilidad de paginación y ordenación. para ello, active las casillas habilitar paginación y habilitar ordenación en la etiqueta inteligente de GridView s.</span><span class="sxs-lookup"><span data-stu-id="74c00-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="74c00-156">Después de agregar los controles panel, botón, GridView y ObjectDataSource y personalizar los campos de GridView, el marcado declarativo de la página debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="74c00-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](batch-inserting-vb/samples/sample1.aspx)]

<span data-ttu-id="74c00-157">Tenga en cuenta que el marcado del botón y el control GridView aparecen dentro de las etiquetas de apertura y cierre de `<asp:Panel>`.</span><span class="sxs-lookup"><span data-stu-id="74c00-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="74c00-158">Dado que estos controles se encuentran dentro del panel de `DisplayInterface`, se pueden ocultar simplemente estableciendo la propiedad panel s `Visible` en `False`.</span><span class="sxs-lookup"><span data-stu-id="74c00-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `False`.</span></span> <span data-ttu-id="74c00-159">El paso 3 examina mediante programación el cambio de la propiedad panel s `Visible` en respuesta a un clic en un botón para mostrar una interfaz ocultando la otra.</span><span class="sxs-lookup"><span data-stu-id="74c00-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="74c00-160">Dedique un momento a ver nuestro progreso a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="74c00-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="74c00-161">Como se muestra en la figura 5, debería ver un botón procesar envío de producto sobre un control GridView que enumera los productos diez a la vez.</span><span class="sxs-lookup"><span data-stu-id="74c00-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>

<span data-ttu-id="74c00-162">[![GridView muestra los productos y ofrece funciones de ordenación y paginación](batch-inserting-vb/_static/image14.png)](batch-inserting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-vb/_static/image14.png)](batch-inserting-vb/_static/image13.png)</span></span>

<span data-ttu-id="74c00-163">**Figura 5**: el control GridView muestra los productos y ofrece funciones de ordenación y paginación ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-vb/_static/image15.png))</span></span>

## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="74c00-164">Paso 2: creación de la interfaz de inserción</span><span class="sxs-lookup"><span data-stu-id="74c00-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="74c00-165">Una vez completada la interfaz de pantalla, se vuelve a preparar para crear la interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="74c00-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="74c00-166">En este tutorial, vamos a crear una interfaz de inserción que solicita un único proveedor y un valor de categoría y, a continuación, permite al usuario escribir hasta cinco nombres de producto y valores de precio por unidad.</span><span class="sxs-lookup"><span data-stu-id="74c00-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="74c00-167">Con esta interfaz, el usuario puede Agregar de uno a cinco productos nuevos que compartan la misma categoría y proveedor, pero que tengan nombres de producto y precios únicos.</span><span class="sxs-lookup"><span data-stu-id="74c00-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="74c00-168">Empiece arrastrando un panel desde el cuadro de herramientas hasta el diseñador, colocándolo debajo del panel de `DisplayInterface` existente.</span><span class="sxs-lookup"><span data-stu-id="74c00-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="74c00-169">Establezca la propiedad `ID` de este panel recién agregado en `InsertingInterface` y establezca su propiedad `Visible` en `False`.</span><span class="sxs-lookup"><span data-stu-id="74c00-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `False`.</span></span> <span data-ttu-id="74c00-170">En el paso 3, agregaremos el código que establece la propiedad `Visible` del panel `InsertingInterface` en `True`.</span><span class="sxs-lookup"><span data-stu-id="74c00-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `True` in Step 3.</span></span> <span data-ttu-id="74c00-171">Borre también los valores de la propiedad panel s `Height` y `Width`.</span><span class="sxs-lookup"><span data-stu-id="74c00-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="74c00-172">A continuación, necesitamos crear la interfaz de inserción que se mostró en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="74c00-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="74c00-173">Esta interfaz se puede crear a través de diversas técnicas HTML, pero vamos a usar una tabla bastante sencilla: una tabla de cuatro columnas y siete filas.</span><span class="sxs-lookup"><span data-stu-id="74c00-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="74c00-174">Al escribir el marcado para los elementos de `<table>` HTML, prefiero usar la vista de código fuente.</span><span class="sxs-lookup"><span data-stu-id="74c00-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="74c00-175">Aunque Visual Studio tiene herramientas para agregar elementos `<table>` a través del diseñador, el diseñador parece estar demasiado dispuesto para insertar la configuración de `style` en el marcado.</span><span class="sxs-lookup"><span data-stu-id="74c00-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="74c00-176">Una vez que se ha creado el marcado de `<table>`, normalmente se vuelve al diseñador para agregar los controles Web y establecer sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="74c00-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="74c00-177">Al crear tablas con columnas y filas predeterminadas, prefiero usar HTML estático en lugar del [control Web Table](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) , ya que todos los controles Web situados dentro de un control Web Table solo pueden tener acceso mediante el patrón `FindControl("controlID")`.</span><span class="sxs-lookup"><span data-stu-id="74c00-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="74c00-178">No obstante, se usan controles Web de tabla para tablas de tamaño dinámico (aquellas cuyas filas o columnas se basan en algunos criterios especificados por el usuario o en una base de datos), ya que el control Web Table se puede construir mediante programación.</span><span class="sxs-lookup"><span data-stu-id="74c00-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>

<span data-ttu-id="74c00-179">Escriba el siguiente marcado dentro de las etiquetas `<asp:Panel>` del panel `InsertingInterface`:</span><span class="sxs-lookup"><span data-stu-id="74c00-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>

[!code-html[Main](batch-inserting-vb/samples/sample2.html)]

<span data-ttu-id="74c00-180">Este marcado de `<table>` no incluye todavía ningún control Web, los agregaremos en breve.</span><span class="sxs-lookup"><span data-stu-id="74c00-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="74c00-181">Tenga en cuenta que cada elemento `<tr>` contiene una configuración de clase CSS determinada: `BatchInsertHeaderRow` para la fila de encabezado donde va a ir el proveedor y la categoría DropDownLists; `BatchInsertFooterRow` para la fila de pie de página en la que Irán los botones agregar productos de envío y cancelar. y alternan `BatchInsertRow` y `BatchInsertAlternatingRow` valores de las filas que contendrán los controles de cuadro de texto Product y Unit Price.</span><span class="sxs-lookup"><span data-stu-id="74c00-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="74c00-182">He creado las clases CSS correspondientes en el archivo `Styles.css` para dar a la interfaz de inserción una apariencia similar a la de los controles GridView y DetailsView que se usan en estos tutoriales.</span><span class="sxs-lookup"><span data-stu-id="74c00-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="74c00-183">Estas clases CSS se muestran a continuación.</span><span class="sxs-lookup"><span data-stu-id="74c00-183">These CSS classes are shown below.</span></span>

[!code-css[Main](batch-inserting-vb/samples/sample3.css)]

<span data-ttu-id="74c00-184">Con este marcado escrito, vuelva a la Vista de diseño.</span><span class="sxs-lookup"><span data-stu-id="74c00-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="74c00-185">Este `<table>` debe mostrarse como una tabla de cuatro columnas de siete filas en el diseñador, tal como se muestra en la figura 6.</span><span class="sxs-lookup"><span data-stu-id="74c00-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>

<span data-ttu-id="74c00-186">[![la interfaz de inserción se compone de una tabla de cuatro columnas y siete filas](batch-inserting-vb/_static/image17.png)](batch-inserting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-vb/_static/image17.png)](batch-inserting-vb/_static/image16.png)</span></span>

<span data-ttu-id="74c00-187">**Figura 6**: la interfaz de inserción se compone de una tabla de cuatro columnas y siete filas ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-vb/_static/image18.png))</span></span>

<span data-ttu-id="74c00-188">Ahora estamos listos para agregar los controles Web a la interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="74c00-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="74c00-189">Arrastre dos DropDownLists desde el cuadro de herramientas hasta las celdas adecuadas de la tabla uno para el proveedor y otro para la categoría.</span><span class="sxs-lookup"><span data-stu-id="74c00-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="74c00-190">Establezca la propiedad Supplier DropDownList s `ID` en `Suppliers` y enlácelo a un nuevo ObjectDataSource denominado `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74c00-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="74c00-191">Configure el nuevo ObjectDataSource para recuperar sus datos del método `SuppliersBLL` Class s `GetSuppliers` y establezca la lista desplegable actualizar pestaña s en (ninguno).</span><span class="sxs-lookup"><span data-stu-id="74c00-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="74c00-192">Haga clic en Finalizar para completar el asistente.</span><span class="sxs-lookup"><span data-stu-id="74c00-192">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="74c00-193">[![configurar ObjectDataSource para usar el método SuppliersBLL de la clase GetSuppliers](batch-inserting-vb/_static/image20.png)](batch-inserting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-vb/_static/image20.png)](batch-inserting-vb/_static/image19.png)</span></span>

<span data-ttu-id="74c00-194">**Figura 7**: configuración de ObjectDataSource para usar el método `SuppliersBLL` Class s `GetSuppliers` ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-vb/_static/image21.png))</span></span>

<span data-ttu-id="74c00-195">Haga que el `Suppliers` DropDownList muestre el `CompanyName` campo de datos y use el campo de datos `SupplierID` como sus valores `ListItem` s.</span><span class="sxs-lookup"><span data-stu-id="74c00-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>

<span data-ttu-id="74c00-196">[![mostrar el campo de datos CompanyName y usar SupplierID como valor](batch-inserting-vb/_static/image23.png)](batch-inserting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-vb/_static/image23.png)](batch-inserting-vb/_static/image22.png)</span></span>

<span data-ttu-id="74c00-197">**Figura 8**: mostrar el `CompanyName` campo de datos y usar `SupplierID` como valor ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-vb/_static/image24.png))</span></span>

<span data-ttu-id="74c00-198">Denomine al segundo `Categories` de DropDownList y enlácelo a un nuevo ObjectDataSource denominado `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="74c00-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="74c00-199">Configure el `CategoriesDataSource` ObjectDataSource para usar el método de `GetCategories` `CategoriesBLL` Class s; establezca las listas desplegables de las pestañas actualizar y eliminar en (ninguna) y haga clic en finalizar para completar el asistente.</span><span class="sxs-lookup"><span data-stu-id="74c00-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="74c00-200">Por último, haga que el DropDownList muestre el `CategoryName` campo de datos y use el `CategoryID` como valor.</span><span class="sxs-lookup"><span data-stu-id="74c00-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="74c00-201">Después de que estos dos DropDownLists se hayan agregado y enlazado al ObjectDataSource configurado correctamente, la pantalla debe tener un aspecto similar al de la ilustración 9.</span><span class="sxs-lookup"><span data-stu-id="74c00-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>

<span data-ttu-id="74c00-202">[![la fila de encabezado contiene ahora los proveedores y las categorías DropDownLists](batch-inserting-vb/_static/image26.png)](batch-inserting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-vb/_static/image26.png)](batch-inserting-vb/_static/image25.png)</span></span>

<span data-ttu-id="74c00-203">**Figura 9**: la fila de encabezado contiene ahora el `Suppliers` y `Categories` DropDownLists ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-vb/_static/image27.png))</span></span>

<span data-ttu-id="74c00-204">Ahora tenemos que crear los cuadros de texto para recopilar el nombre y el precio de cada nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="74c00-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="74c00-205">Arrastre un control TextBox desde el cuadro de herramientas hasta el diseñador para cada una de las cinco filas Product Name y price.</span><span class="sxs-lookup"><span data-stu-id="74c00-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="74c00-206">Establezca las propiedades del `ID` de los cuadros de texto en `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, etc.</span><span class="sxs-lookup"><span data-stu-id="74c00-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="74c00-207">Agregue un control CompareValidator después de cada uno de los cuadros de texto de precio por unidad y establezca la propiedad `ControlToValidate` en el `ID`adecuado.</span><span class="sxs-lookup"><span data-stu-id="74c00-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="74c00-208">Establezca también la propiedad `Operator` en `GreaterThanEqual`, `ValueToCompare` en 0 y `Type` en `Currency`.</span><span class="sxs-lookup"><span data-stu-id="74c00-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="74c00-209">Esta configuración indica a CompareValidator que asegúrese de que el precio, si se especifica, es un valor de moneda válido que es mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="74c00-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="74c00-210">Establezca la propiedad `Text` en \*y `ErrorMessage` en el precio debe ser mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="74c00-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="74c00-211">También puede omitir cualquier símbolo de moneda.</span><span class="sxs-lookup"><span data-stu-id="74c00-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="74c00-212">La interfaz de inserción no incluye ningún control RequiredFieldValidator, aunque el campo de `ProductName` de la tabla de base de datos `Products` no permite valores `NULL`.</span><span class="sxs-lookup"><span data-stu-id="74c00-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="74c00-213">Esto se debe a que queremos permitir que el usuario escriba hasta cinco productos.</span><span class="sxs-lookup"><span data-stu-id="74c00-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="74c00-214">Por ejemplo, si el usuario proporcionara el nombre del producto y el precio por unidad de las tres primeras filas y deja las dos últimas filas en blanco, solo agregaremos tres nuevos productos al sistema.</span><span class="sxs-lookup"><span data-stu-id="74c00-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="74c00-215">No obstante, dado que `ProductName` es necesario, se debe comprobar mediante programación para asegurarse de que, si se especifica un precio por unidad, se proporciona un valor de nombre de producto correspondiente.</span><span class="sxs-lookup"><span data-stu-id="74c00-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="74c00-216">Abordaremos esta comprobación en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="74c00-216">We'll tackle this check in Step 4.</span></span>

<span data-ttu-id="74c00-217">Al validar la entrada del usuario, el CompareValidator informa de los datos no válidos si el valor contiene un símbolo de moneda.</span><span class="sxs-lookup"><span data-stu-id="74c00-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="74c00-218">Agregue un signo $ delante de cada uno de los cuadros de texto precio por unidad para servir como una indicación visual que indica al usuario que omita el símbolo de moneda al especificar el precio.</span><span class="sxs-lookup"><span data-stu-id="74c00-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="74c00-219">Por último, agregue un control ValidationSummary en el panel `InsertingInterface`, configuración de su propiedad `ShowMessageBox` a `True` y su propiedad `ShowSummary` a `False`.</span><span class="sxs-lookup"><span data-stu-id="74c00-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="74c00-220">Con esta configuración, si el usuario escribe un valor de precio unitario no válido, aparecerá un asterisco junto a los controles de cuadro de texto infractores y el control ValidationSummary mostrará un cuadro de mensajes del lado cliente que muestra el mensaje de error que se especificó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="74c00-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="74c00-221">En este punto, la pantalla debe tener un aspecto similar al de la figura 10.</span><span class="sxs-lookup"><span data-stu-id="74c00-221">At this point, your screen should look similar to Figure 10.</span></span>

<span data-ttu-id="74c00-222">[![la interfaz de inserción ahora incluye cuadros de texto para los nombres y precios de los productos](batch-inserting-vb/_static/image29.png)](batch-inserting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-vb/_static/image29.png)](batch-inserting-vb/_static/image28.png)</span></span>

<span data-ttu-id="74c00-223">**Figura 10**: la interfaz de inserción ahora incluye cuadros de texto para los nombres y precios de los productos ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-vb/_static/image30.png))</span></span>

<span data-ttu-id="74c00-224">A continuación, es necesario agregar los botones agregar productos desde envío y cancelar a la fila de pie de página.</span><span class="sxs-lookup"><span data-stu-id="74c00-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="74c00-225">Arrastre dos controles de botón desde el cuadro de herramientas al pie de página de la interfaz de inserción, estableciendo los botones `ID` propiedades en `AddProducts` y `CancelButton` y `Text` propiedades para agregar productos de envío y cancelación, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="74c00-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="74c00-226">Además, establezca la propiedad `CancelButton` control s `CausesValidation` en `false`.</span><span class="sxs-lookup"><span data-stu-id="74c00-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="74c00-227">Por último, es necesario agregar un control Web de etiqueta que mostrará mensajes de estado para las dos interfaces.</span><span class="sxs-lookup"><span data-stu-id="74c00-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="74c00-228">Por ejemplo, cuando un usuario agrega correctamente un nuevo envío de productos, queremos volver a la interfaz de pantalla y mostrar un mensaje de confirmación.</span><span class="sxs-lookup"><span data-stu-id="74c00-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="74c00-229">Sin embargo, si el usuario proporciona un precio para un nuevo producto pero deja el nombre del producto, es necesario mostrar un mensaje de advertencia, ya que el campo `ProductName` es obligatorio.</span><span class="sxs-lookup"><span data-stu-id="74c00-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="74c00-230">Puesto que necesitamos que este mensaje se muestre en ambas interfaces, colóquelo en la parte superior de la página fuera de los paneles.</span><span class="sxs-lookup"><span data-stu-id="74c00-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="74c00-231">Arrastre un control Web Label desde el cuadro de herramientas hasta la parte superior de la página en el diseñador.</span><span class="sxs-lookup"><span data-stu-id="74c00-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="74c00-232">Establezca la propiedad `ID` en `StatusLabel`, borre la propiedad `Text` y establezca las propiedades `Visible` y `EnableViewState` en `False`.</span><span class="sxs-lookup"><span data-stu-id="74c00-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `False`.</span></span> <span data-ttu-id="74c00-233">Como hemos podido ver en los tutoriales anteriores, al establecer la propiedad `EnableViewState` en `False` nos permite cambiar mediante programación los valores de la propiedad label s y hacer que se reviertan automáticamente a sus valores predeterminados en el PostBack posterior.</span><span class="sxs-lookup"><span data-stu-id="74c00-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `False` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="74c00-234">Esto simplifica el código para mostrar un mensaje de estado en respuesta a alguna acción del usuario que desaparece en el PostBack posterior.</span><span class="sxs-lookup"><span data-stu-id="74c00-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="74c00-235">Por último, establezca la propiedad `StatusLabel` control s `CssClass` en warning, que es el nombre de una clase CSS definida en `Styles.css` que muestra texto en una fuente grande, cursiva, negrita y rojo.</span><span class="sxs-lookup"><span data-stu-id="74c00-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="74c00-236">En la figura 11 se muestra el diseñador de Visual Studio una vez agregada y configurada la etiqueta.</span><span class="sxs-lookup"><span data-stu-id="74c00-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>

<span data-ttu-id="74c00-237">[![Coloque el control StatusLabel sobre los dos controles de panel](batch-inserting-vb/_static/image32.png)](batch-inserting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-vb/_static/image32.png)](batch-inserting-vb/_static/image31.png)</span></span>

<span data-ttu-id="74c00-238">**Figura 11**: Coloque el control `StatusLabel` sobre los dos controles de panel ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-vb/_static/image33.png))</span></span>

## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="74c00-239">Paso 3: cambiar entre las interfaces de presentación e inserción</span><span class="sxs-lookup"><span data-stu-id="74c00-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="74c00-240">Llegados a este punto, hemos completado el marcado para nuestras interfaces de visualización e inserción, pero todavía hemos dejado dos tareas:</span><span class="sxs-lookup"><span data-stu-id="74c00-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="74c00-241">Cambiar entre las interfaces de presentación e inserción</span><span class="sxs-lookup"><span data-stu-id="74c00-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="74c00-242">Agregar los productos del envío a la base de datos</span><span class="sxs-lookup"><span data-stu-id="74c00-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="74c00-243">Actualmente, la interfaz de visualización está visible pero la interfaz de inserción está oculta.</span><span class="sxs-lookup"><span data-stu-id="74c00-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="74c00-244">Esto se debe a que la propiedad panel `DisplayInterface` s `Visible` está establecida en `True` (el valor predeterminado), mientras que la propiedad `Visible` del panel `InsertingInterface` está establecida en `False`.</span><span class="sxs-lookup"><span data-stu-id="74c00-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `True` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `False`.</span></span> <span data-ttu-id="74c00-245">Para cambiar entre las dos interfaces, simplemente tenemos que alternar cada control s `Visible` valor de propiedad.</span><span class="sxs-lookup"><span data-stu-id="74c00-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="74c00-246">Queremos pasar de la interfaz de pantalla a la interfaz de inserción cuando se haga clic en el botón procesar envío de producto.</span><span class="sxs-lookup"><span data-stu-id="74c00-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="74c00-247">Por lo tanto, cree un controlador de eventos para este evento de botón `Click` que contenga el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="74c00-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>

[!code-vb[Main](batch-inserting-vb/samples/sample4.vb)]

<span data-ttu-id="74c00-248">Este código simplemente oculta el panel de `DisplayInterface` y muestra el panel de `InsertingInterface`.</span><span class="sxs-lookup"><span data-stu-id="74c00-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="74c00-249">A continuación, cree controladores de eventos para los controles de botón Agregar productos desde el envío y cancelar en la interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="74c00-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="74c00-250">Cuando se hace clic en cualquiera de estos botones, es necesario volver a la interfaz de pantalla.</span><span class="sxs-lookup"><span data-stu-id="74c00-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="74c00-251">Cree `Click` controladores de eventos para ambos controles de botón de modo que llamen a `ReturnToDisplayInterface`, un método que se agregará momentáneamente.</span><span class="sxs-lookup"><span data-stu-id="74c00-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="74c00-252">Además de ocultar el panel de `InsertingInterface` y mostrar el panel de `DisplayInterface`, el método `ReturnToDisplayInterface` debe devolver los controles Web a su estado de edición previa.</span><span class="sxs-lookup"><span data-stu-id="74c00-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="74c00-253">Esto implica establecer las propiedades de DropDownLists `SelectedIndex` en 0 y desactivar las propiedades `Text` de los controles de cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="74c00-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="74c00-254">Tenga en cuenta lo que puede suceder si no devolvía los controles a su estado de edición previa antes de volver a la interfaz de visualización.</span><span class="sxs-lookup"><span data-stu-id="74c00-254">Consider what might happen if we didn't return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="74c00-255">Es posible que un usuario haga clic en el botón procesar envío de producto, escriba los productos del envío y, a continuación, haga clic en agregar productos del envío.</span><span class="sxs-lookup"><span data-stu-id="74c00-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="74c00-256">Esto agregaría los productos y devolvería al usuario a la interfaz de pantalla.</span><span class="sxs-lookup"><span data-stu-id="74c00-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="74c00-257">Llegados a este punto, es posible que el usuario quiera agregar otro envío.</span><span class="sxs-lookup"><span data-stu-id="74c00-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="74c00-258">Al hacer clic en el botón procesar envío de producto, se devolverían a la interfaz de inserción, pero las selecciones de DropDownList y los valores de cuadro de texto se seguirían rellenando con los valores anteriores.</span><span class="sxs-lookup"><span data-stu-id="74c00-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>

[!code-vb[Main](batch-inserting-vb/samples/sample5.vb)]

<span data-ttu-id="74c00-259">Ambos controladores de eventos `Click` llaman simplemente al método `ReturnToDisplayInterface`, aunque volveremos al controlador de eventos Add Products from reenvío `Click` en el paso 4 y agregaremos código para guardar los productos.</span><span class="sxs-lookup"><span data-stu-id="74c00-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="74c00-260">`ReturnToDisplayInterface` comienza devolviendo el `Suppliers` y `Categories` DropDownLists a sus primeras opciones.</span><span class="sxs-lookup"><span data-stu-id="74c00-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="74c00-261">Las dos constantes `firstControlID` y `lastControlID` marcan los valores de índice de control inicial y final usados para asignar nombres a los cuadros de texto nombre de producto y precio unitario en la interfaz de inserción y se usan en los límites del bucle `For` que establece las propiedades `Text` de los controles TextBox de nuevo en una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="74c00-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `For` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="74c00-262">Por último, se restablecen las propiedades de los paneles `Visible` para que la interfaz de inserción se oculte y se muestre la interfaz de pantalla.</span><span class="sxs-lookup"><span data-stu-id="74c00-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="74c00-263">Dedique un momento a probar esta página en un explorador.</span><span class="sxs-lookup"><span data-stu-id="74c00-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="74c00-264">Al visitar la página por primera vez, debería ver la interfaz de visualización como se muestra en la figura 5.</span><span class="sxs-lookup"><span data-stu-id="74c00-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="74c00-265">Haga clic en el botón procesar envío de producto.</span><span class="sxs-lookup"><span data-stu-id="74c00-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="74c00-266">La página se devolverá como postback y ahora debería ver la interfaz de inserción como se muestra en la figura 12.</span><span class="sxs-lookup"><span data-stu-id="74c00-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="74c00-267">Al hacer clic en los botones agregar productos desde el envío o cancelar, se muestra la interfaz de pantalla.</span><span class="sxs-lookup"><span data-stu-id="74c00-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="74c00-268">Al ver la interfaz de inserción, dedique un momento a probar el CompareValidators en los cuadros de texto precio por unidad.</span><span class="sxs-lookup"><span data-stu-id="74c00-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="74c00-269">Debería ver una advertencia de cuadro de mensajes del lado cliente al hacer clic en el botón Agregar productos de envío con valores de moneda o precios no válidos con un valor inferior a cero.</span><span class="sxs-lookup"><span data-stu-id="74c00-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>

<span data-ttu-id="74c00-270">[![se muestra la interfaz de inserción después de hacer clic en el botón procesar envío de producto](batch-inserting-vb/_static/image35.png)](batch-inserting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-vb/_static/image35.png)](batch-inserting-vb/_static/image34.png)</span></span>

<span data-ttu-id="74c00-271">**Figura 12**: la interfaz de inserción se muestra después de hacer clic en el botón procesar envío de producto ([haga clic para ver la imagen a tamaño completo](batch-inserting-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-vb/_static/image36.png))</span></span>

## <a name="step-4-adding-the-products"></a><span data-ttu-id="74c00-272">Paso 4: agregar los productos</span><span class="sxs-lookup"><span data-stu-id="74c00-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="74c00-273">Lo único que queda para este tutorial es guardar los productos en la base de datos en el controlador de eventos agregar productos desde el botón de envío `Click`.</span><span class="sxs-lookup"><span data-stu-id="74c00-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="74c00-274">Esto puede realizarse mediante la creación de una `ProductsDataTable` y la adición de una instancia de `ProductsRow` para cada uno de los nombres de producto suministrados.</span><span class="sxs-lookup"><span data-stu-id="74c00-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="74c00-275">Una vez que se han agregado estos `ProductsRow` se realizará una llamada al método `ProductsBLL` de clase `UpdateWithTransaction` pasando el `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="74c00-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="74c00-276">Recuerde que el método `UpdateWithTransaction`, que se creó en el tutorial [ajustar las modificaciones de base de datos dentro de una transacción](wrapping-database-modifications-within-a-transaction-vb.md) , pasa el `ProductsDataTable` al método `UpdateWithTransaction` del `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="74c00-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter`'s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="74c00-277">A partir de ahí, se inicia una transacción ADO.NET y el TableAdapter emite una instrucción `INSERT` a la base de datos para cada `ProductsRow` agregada en la DataTable.</span><span class="sxs-lookup"><span data-stu-id="74c00-277">From there, an ADO.NET transaction is started and the TableAdapter issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="74c00-278">Suponiendo que todos los productos se agregan sin errores, se confirma la transacción; en caso contrario, se revierte.</span><span class="sxs-lookup"><span data-stu-id="74c00-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="74c00-279">También es necesario realizar una comprobación de errores en el código del controlador de eventos agregar productos desde el botón de envío s `Click`.</span><span class="sxs-lookup"><span data-stu-id="74c00-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="74c00-280">Dado que no se usa ningún RequiredFieldValidators en la interfaz de inserción, un usuario puede especificar un precio para un producto omitiendo su nombre.</span><span class="sxs-lookup"><span data-stu-id="74c00-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="74c00-281">Dado que el nombre del producto es obligatorio, si esta condición se despliega, es necesario avisar al usuario y no continuar con las inserciones.</span><span class="sxs-lookup"><span data-stu-id="74c00-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="74c00-282">A continuación se muestra el código completo del controlador de eventos `Click`:</span><span class="sxs-lookup"><span data-stu-id="74c00-282">The complete `Click` event handler code follows:</span></span>

[!code-vb[Main](batch-inserting-vb/samples/sample6.vb)]

<span data-ttu-id="74c00-283">El controlador de eventos se inicia asegurándose de que la propiedad `Page.IsValid` devuelve un valor de `True`.</span><span class="sxs-lookup"><span data-stu-id="74c00-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `True`.</span></span> <span data-ttu-id="74c00-284">Si devuelve `False`, eso significa que uno o varios de los CompareValidators notifican datos no válidos. en tal caso, no queremos intentar insertar los productos especificados o bien, terminaremos con una excepción al intentar asignar el valor del precio unitario especificado por el usuario a la propiedad `ProductsRow` s `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="74c00-284">If it returns `False`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="74c00-285">A continuación, se crea una nueva instancia de `ProductsDataTable` (`products`).</span><span class="sxs-lookup"><span data-stu-id="74c00-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="74c00-286">Un bucle `For` se usa para recorrer en iteración los cuadros de texto nombre del producto y precio de la unidad y las propiedades `Text` se leen en las variables locales `productName` y `unitPrice`.</span><span class="sxs-lookup"><span data-stu-id="74c00-286">A `For` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="74c00-287">Si el usuario ha especificado un valor para el precio por unidad pero no para el nombre de producto correspondiente, el `StatusLabel` muestra el mensaje si proporciona un precio por unidad también debe incluir el nombre del producto y el controlador de eventos se ha cerrado.</span><span class="sxs-lookup"><span data-stu-id="74c00-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="74c00-288">Si se ha proporcionado un nombre de producto, se crea una nueva instancia de `ProductsRow` mediante el método `ProductsDataTable` s `NewProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="74c00-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="74c00-289">Esta nueva `ProductsRow` instancia de `ProductName` propiedad se establece en el cuadro de texto nombre del producto actual, mientras que las propiedades `SupplierID` y `CategoryID` se asignan a las propiedades `SelectedValue` de DropDownLists en el encabezado insertar interfaz s.</span><span class="sxs-lookup"><span data-stu-id="74c00-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="74c00-290">Si el usuario ha especificado un valor para el precio del producto, se asigna a la propiedad `ProductsRow` instancia s `UnitPrice`; de lo contrario, la propiedad se deja sin asignar, lo que dará como resultado un valor de `NULL` para `UnitPrice` en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="74c00-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="74c00-291">Por último, las propiedades `Discontinued` y `UnitsOnOrder` se asignan a los valores codificados de forma rígida `False` y 0, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="74c00-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `False` and 0, respectively.</span></span>

<span data-ttu-id="74c00-292">Una vez asignadas las propiedades a la instancia de `ProductsRow`, se agrega a la `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="74c00-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="74c00-293">Al finalizar el bucle de `For`, se comprueba si se ha agregado algún producto.</span><span class="sxs-lookup"><span data-stu-id="74c00-293">At the completion of the `For` loop, we check whether any products have been added.</span></span> <span data-ttu-id="74c00-294">Después de todo, el usuario puede hacer clic en agregar productos del envío antes de escribir cualquier nombre de producto o precio.</span><span class="sxs-lookup"><span data-stu-id="74c00-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="74c00-295">Si hay al menos un producto en el `ProductsDataTable`, se llama al método `ProductsBLL` clase s `UpdateWithTransaction`.</span><span class="sxs-lookup"><span data-stu-id="74c00-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="74c00-296">Después, los datos se reenlazan a la `ProductsGrid` GridView para que los productos recién agregados aparezcan en la interfaz de pantalla.</span><span class="sxs-lookup"><span data-stu-id="74c00-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="74c00-297">El `StatusLabel` se actualiza para mostrar un mensaje de confirmación y se invoca el `ReturnToDisplayInterface`, ocultando la interfaz de inserción y mostrando la interfaz de pantalla.</span><span class="sxs-lookup"><span data-stu-id="74c00-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="74c00-298">Si no se especificó ningún producto, la interfaz de inserción permanece visible pero el mensaje no se agregó ningún producto.</span><span class="sxs-lookup"><span data-stu-id="74c00-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="74c00-299">Escriba los nombres de producto y los precios de unidad en los cuadros de texto que se muestran.</span><span class="sxs-lookup"><span data-stu-id="74c00-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="74c00-300">Las figuras s 13, 14 y 15 muestran las interfaces de inserción y visualización en acción.</span><span class="sxs-lookup"><span data-stu-id="74c00-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="74c00-301">En la figura 13, el usuario ha especificado un valor de precio por unidad sin un nombre de producto correspondiente.</span><span class="sxs-lookup"><span data-stu-id="74c00-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="74c00-302">La figura 14 muestra la interfaz de visualización después de que se hayan agregado tres nuevos productos correctamente, mientras que la figura 15 muestra dos de los productos recién agregados en GridView (el tercero está en la página anterior).</span><span class="sxs-lookup"><span data-stu-id="74c00-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>

<span data-ttu-id="74c00-303">[![se requiere un nombre de producto al especificar un precio por unidad](batch-inserting-vb/_static/image38.png)](batch-inserting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-vb/_static/image38.png)](batch-inserting-vb/_static/image37.png)</span></span>

<span data-ttu-id="74c00-304">**Figura 13**: se requiere un nombre de producto al especificar un precio por unidad ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-vb/_static/image39.png))</span></span>

<span data-ttu-id="74c00-305">[![se han agregado tres nuevos veggies para el proveedor Mayumi s](batch-inserting-vb/_static/image41.png)](batch-inserting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-vb/_static/image41.png)](batch-inserting-vb/_static/image40.png)</span></span>

<span data-ttu-id="74c00-306">**Figura 14**: se han agregado tres nuevos veggies para el proveedor Mayumi s ([haga clic para ver la imagen de tamaño completo](batch-inserting-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-vb/_static/image42.png))</span></span>

<span data-ttu-id="74c00-307">[![los nuevos productos se pueden encontrar en la última página de GridView](batch-inserting-vb/_static/image44.png)](batch-inserting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="74c00-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-vb/_static/image44.png)](batch-inserting-vb/_static/image43.png)</span></span>

<span data-ttu-id="74c00-308">**Figura 15**: los nuevos productos se pueden encontrar en la última página de GridView ([haga clic para ver la imagen a tamaño completo](batch-inserting-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="74c00-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-vb/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="74c00-309">La lógica de inserción de lotes utilizada en este tutorial incluye las inserciones en el ámbito de la transacción.</span><span class="sxs-lookup"><span data-stu-id="74c00-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="74c00-310">Para comprobarlo, introduzca intencionadamente un error de nivel de base de datos.</span><span class="sxs-lookup"><span data-stu-id="74c00-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="74c00-311">Por ejemplo, en lugar de asignar la propiedad New `ProductsRow` Instance s `CategoryID` al valor seleccionado en el `Categories` DropDownList, asígnelo a un valor como `i * 5`.</span><span class="sxs-lookup"><span data-stu-id="74c00-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="74c00-312">Aquí `i` es el indizador de bucle y tiene valores comprendidos entre 1 y 5.</span><span class="sxs-lookup"><span data-stu-id="74c00-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="74c00-313">Por lo tanto, al agregar dos o más productos en batch INSERT, el primer producto tendrá un valor de `CategoryID` válido (5), pero los productos subsiguientes tendrán `CategoryID` valores que no coincidan con `CategoryID` valores en la tabla de `Categories`.</span><span class="sxs-lookup"><span data-stu-id="74c00-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="74c00-314">El efecto neto es que, mientras que la primera `INSERT` se realizará correctamente, se producirá un error en las subsiguientes con una infracción de la restricción FOREIGN KEY.</span><span class="sxs-lookup"><span data-stu-id="74c00-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="74c00-315">Dado que la inserción por lotes es atómica, se revertirá la primera `INSERT` y se devolverá la base de datos a su estado anterior al inicio del proceso de inserción por lotes.</span><span class="sxs-lookup"><span data-stu-id="74c00-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>

## <a name="summary"></a><span data-ttu-id="74c00-316">Resumen</span><span class="sxs-lookup"><span data-stu-id="74c00-316">Summary</span></span>

<span data-ttu-id="74c00-317">A través de este y los dos tutoriales anteriores, hemos creado interfaces que permiten actualizar, eliminar e insertar lotes de datos, todos los cuales usaban la compatibilidad con transacciones que agregamos a la capa de acceso a datos en el tutorial [ajustar modificaciones de base de datos dentro de una transacción](wrapping-database-modifications-within-a-transaction-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="74c00-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial.</span></span> <span data-ttu-id="74c00-318">En ciertos escenarios, estas interfaces de usuario de procesamiento por lotes mejoran en gran medida la eficiencia del usuario final, ya que reducen el número de clics, los postbacks y los modificadores de contexto de teclado a mouse, a la vez que se mantiene la integridad de los datos subyacentes.</span><span class="sxs-lookup"><span data-stu-id="74c00-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="74c00-319">En este tutorial se completa el trabajo con datos por lotes.</span><span class="sxs-lookup"><span data-stu-id="74c00-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="74c00-320">El siguiente conjunto de tutoriales explora diversos escenarios avanzados de nivel de acceso a datos, incluido el uso de procedimientos almacenados en los métodos de TableAdapter s, la configuración de los valores de conexión y de nivel de comando en la capa DAL, el cifrado de cadenas de conexión, etc.</span><span class="sxs-lookup"><span data-stu-id="74c00-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="74c00-321">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="74c00-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="74c00-322">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="74c00-322">About the Author</span></span>

<span data-ttu-id="74c00-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros de ASP/ASP. net y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="74c00-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="74c00-324">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="74c00-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="74c00-325">Su último libro se [*enseña a ASP.NET 2,0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="74c00-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="74c00-326">Puede ponerse en contacto con usted en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="74c00-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="74c00-327">o a través de su blog, que encontrará en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="74c00-327">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="74c00-328">Agradecimiento especial a</span><span class="sxs-lookup"><span data-stu-id="74c00-328">Special Thanks To</span></span>

<span data-ttu-id="74c00-329">Muchos revisores útiles revisaron esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="74c00-329">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="74c00-330">Los revisores responsables de este tutorial eran Hilton Giesenow y S Ren Jacob Lauritsen.</span><span class="sxs-lookup"><span data-stu-id="74c00-330">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="74c00-331">¿Está interesado en revisar los próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="74c00-331">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="74c00-332">En caso afirmativo, suéltelo en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="74c00-332">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="74c00-333">Anterior</span><span class="sxs-lookup"><span data-stu-id="74c00-333">Previous</span></span>](batch-deleting-vb.md)

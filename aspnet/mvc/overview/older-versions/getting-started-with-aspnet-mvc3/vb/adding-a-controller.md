---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-controller
title: Agregar un controlador (VB) | Microsoft Docs
author: Rick-Anderson
description: Este tutorial le enseñará los aspectos básicos de la creación de una aplicación Web de ASP.NET MVC mediante Microsoft Visual Web Developer 2010 Express Service Pack 1, que es...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: 741259e1-54ac-4f71-b4e8-2bd5560bb950
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-controller
msc.type: authoredcontent
ms.openlocfilehash: 144b00d9ec263231c29365caa2f3fb7b96a7ea16
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/09/2019
ms.locfileid: "59415536"
---
# <a name="adding-a-controller-vb"></a><span data-ttu-id="cb9ab-103">Agregar un controlador (VB)</span><span class="sxs-lookup"><span data-stu-id="cb9ab-103">Adding a Controller (VB)</span></span>

<span data-ttu-id="cb9ab-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="cb9ab-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> <span data-ttu-id="cb9ab-105">Este tutorial le enseñará los aspectos básicos de la creación de una aplicación Web de ASP.NET MVC mediante Microsoft Visual Web Developer 2010 Express Service Pack 1, que es una versión gratuita de Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-105">This tutorial will teach you the basics of building an ASP.NET MVC Web application using Microsoft Visual Web Developer 2010 Express Service Pack 1, which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="cb9ab-106">Antes de empezar, asegúrese de que ha instalado los requisitos previos descritos a continuación.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-106">Before you start, make sure you've installed the prerequisites listed below.</span></span> <span data-ttu-id="cb9ab-107">Puede instalar todos ellos haciendo clic en el siguiente vínculo: [Instalador de plataforma Web](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="cb9ab-107">You can install all of them by clicking the following link: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span></span> <span data-ttu-id="cb9ab-108">Como alternativa, puede instalar individualmente los requisitos previos mediante los vínculos siguientes:</span><span class="sxs-lookup"><span data-stu-id="cb9ab-108">Alternatively, you can individually install the prerequisites using the following links:</span></span>
> 
> - [<span data-ttu-id="cb9ab-109">Requisitos previos de Visual Studio Web Developer Express SP1</span><span class="sxs-lookup"><span data-stu-id="cb9ab-109">Visual Studio Web Developer Express SP1 prerequisites</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [<span data-ttu-id="cb9ab-110">ASP.NET MVC 3 Tools Update</span><span class="sxs-lookup"><span data-stu-id="cb9ab-110">ASP.NET MVC 3 Tools Update</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - <span data-ttu-id="cb9ab-111">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(tiempo de ejecución de herramientas de soporte técnico +)</span><span class="sxs-lookup"><span data-stu-id="cb9ab-111">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + tools support)</span></span>
> 
> <span data-ttu-id="cb9ab-112">Si usa Visual Studio 2010, en lugar de Visual Web Developer 2010, instale los requisitos previos, haga clic en el siguiente vínculo: [Requisitos previos de Visual Studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="cb9ab-112">If you're using Visual Studio 2010 instead of Visual Web Developer 2010, install the prerequisites by clicking the following link: [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span></span>
> 
> <span data-ttu-id="cb9ab-113">Un proyecto de Visual Web Developer con código fuente VB.NET está disponible como acompañamiento de este tema.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-113">A Visual Web Developer project with VB.NET source code is available to accompany this topic.</span></span> <span data-ttu-id="cb9ab-114">[Descargue la versión VB.NET](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span><span class="sxs-lookup"><span data-stu-id="cb9ab-114">[Download the VB.NET version](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span></span> <span data-ttu-id="cb9ab-115">Si lo prefiere C#, cambie a la [C# versión](../cs/adding-a-controller.md) de este tutorial.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-115">If you prefer C#, switch to the [C# version](../cs/adding-a-controller.md) of this tutorial.</span></span>


<span data-ttu-id="cb9ab-116">MVC es el acrónimo *model-view-controller*.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-116">MVC stands for *model-view-controller*.</span></span> <span data-ttu-id="cb9ab-117">MVC es un patrón para desarrollar aplicaciones de forma que cada parte tiene una responsabilidad independiente:</span><span class="sxs-lookup"><span data-stu-id="cb9ab-117">MVC is a pattern for developing applications such that each part has a separate responsibility:</span></span>

- <span data-ttu-id="cb9ab-118">Modelo: Los datos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-118">Model: The data for your application.</span></span>
- <span data-ttu-id="cb9ab-119">Vistas: Los archivos de plantilla que se usará la aplicación para generar respuestas HTML de forma dinámica.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-119">Views: The template files your application will use to dynamically generate HTML responses.</span></span>
- <span data-ttu-id="cb9ab-120">Controladores: Las clases que controlan las solicitudes entrantes de dirección URL a la aplicación, recuperar datos del modelo y, a continuación, especifique las plantillas de vista que representan una respuesta al cliente.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-120">Controllers: Classes that handle incoming URL requests to the application, retrieve model data, and then specify view templates that render a response to the client.</span></span>

<span data-ttu-id="cb9ab-121">Se va a cubrir todos estos conceptos en este tutorial y le enseñaremos a usarlos para crear una aplicación.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-121">We'll be covering all these concepts in this tutorial and show you how to use them to build an application.</span></span>

<span data-ttu-id="cb9ab-122">Crear un nuevo controlador haciendo clic con el *controladores* carpeta en **el Explorador de soluciones** y, a continuación, seleccione **Agregar controlador**.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-122">Create a new controller by right-clicking the *Controllers* folder in **Solution Explorer** and then selecting **Add Controller**.</span></span>

[<span data-ttu-id="cb9ab-123">![AddController](adding-a-controller/_static/image2.png "AddController")</span><span class="sxs-lookup"><span data-stu-id="cb9ab-123">![AddController](adding-a-controller/_static/image2.png "AddController")</span></span>](adding-a-controller/_static/image1.png)

<span data-ttu-id="cb9ab-124">Asigne nombre al nuevo controlador &quot;HelloWorldController&quot; y haga clic en **agregar**.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-124">Name your new controller &quot;HelloWorldController&quot; and click **Add**.</span></span>

[<span data-ttu-id="cb9ab-125">![2AddEmptyController](adding-a-controller/_static/image4.png "2AddEmptyController")</span><span class="sxs-lookup"><span data-stu-id="cb9ab-125">![2AddEmptyController](adding-a-controller/_static/image4.png "2AddEmptyController")</span></span>](adding-a-controller/_static/image3.png)

<span data-ttu-id="cb9ab-126">Tenga en cuenta en **el Explorador de soluciones** a la derecha que se creó automáticamente un nuevo archivo denominado *HelloWorldController.cs* y que el archivo está abierto en el IDE.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-126">Notice in **Solution Explorer** on the right that a new file has been created for you named *HelloWorldController.cs* and that the file is open in the IDE.</span></span>

<span data-ttu-id="cb9ab-127">Dentro de la nueva `public class HelloWorldController` bloquear, cree dos nuevos métodos que tienen un aspecto similar al código siguiente.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-127">Inside the new `public class HelloWorldController` block, create two new methods that look like the following code.</span></span> <span data-ttu-id="cb9ab-128">Usaremos una cadena HTML directamente desde el controlador como un ejemplo.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-128">We'll return a string of HTML directly from the controller as an example.</span></span>

[!code-vb[Main](adding-a-controller/samples/sample1.vb)]

<span data-ttu-id="cb9ab-129">El controlador se denomina `HelloWorldController` y se llama al nuevo método `Index`.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-129">Your controller is named `HelloWorldController` and your new method is named `Index`.</span></span> <span data-ttu-id="cb9ab-130">Ejecute la aplicación (presione F5 o CTRL+F5).</span><span class="sxs-lookup"><span data-stu-id="cb9ab-130">Run the application (press F5 or Ctrl+F5).</span></span> <span data-ttu-id="cb9ab-131">Una vez que haya iniciado el explorador, anexe &quot;HelloWorld&quot; a la ruta de acceso en la barra de direcciones.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-131">Once your browser has started up, append &quot;HelloWorld&quot; to the path in the address bar.</span></span> <span data-ttu-id="cb9ab-132">(En mi equipo, tiene `http://localhost:43246/HelloWorld`) tendrá un aspecto similar a la siguiente captura de pantalla del explorador.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-132">(On my computer, it's `http://localhost:43246/HelloWorld`) Your browser will look like the screenshot below.</span></span> <span data-ttu-id="cb9ab-133">En el método anterior, el código devuelve una cadena directamente.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-133">In the method above, the code returned a string directly.</span></span> <span data-ttu-id="cb9ab-134">Le dijimos que el sistema solo se devuelva algo de HTML, y así ha sido!</span><span class="sxs-lookup"><span data-stu-id="cb9ab-134">We told the system to just return some HTML, and it did!</span></span>

![](adding-a-controller/_static/image5.png)

<span data-ttu-id="cb9ab-135">ASP.NET MVC invoca las clases de controlador diferente (y los métodos de acción diferentes dentro de ellos) según la dirección URL entrante.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-135">ASP.NET MVC invokes different controller classes (and different action methods within them) depending on the incoming URL.</span></span> <span data-ttu-id="cb9ab-136">La lógica de asignación predeterminada utilizada por ASP.NET MVC usa un formato similar al siguiente para controlar qué código se invoca:</span><span class="sxs-lookup"><span data-stu-id="cb9ab-136">The default mapping logic used by ASP.NET MVC uses a format like this to control what code is invoked:</span></span>

`/[Controller]/[ActionName]/[Parameters]`

<span data-ttu-id="cb9ab-137">La primera parte de la dirección URL determina la clase de controlador para ejecutar.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-137">The first part of the URL determines the controller class to execute.</span></span> <span data-ttu-id="cb9ab-138">Por lo tanto */HelloWorld* se asigna a la `HelloWorldController` clase.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-138">So */HelloWorld* maps to the `HelloWorldController` class.</span></span> <span data-ttu-id="cb9ab-139">La segunda parte de la dirección URL determina el método de acción en la clase que se ejecutará.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-139">The second part of the URL determines the action method on the class to execute.</span></span> <span data-ttu-id="cb9ab-140">Por lo tanto */HelloWorld/Index* provocaría el `Index` método de la `HelloWorldController` clase que se ejecutará.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-140">So */HelloWorld/Index* would cause the `Index` method of the `HelloWorldController` class to execute.</span></span> <span data-ttu-id="cb9ab-141">Tenga en cuenta que sólo teníamos que visite */HelloWorld* anteriormente y el `Index` usó el método de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-141">Notice that we only had to visit */HelloWorld* above and the `Index` method was used by default.</span></span> <span data-ttu-id="cb9ab-142">Esto es porque un método denominado `Index` es el método predeterminado que se llamará en un controlador si no se especifica explícitamente.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-142">This is because a method named `Index` is the default method that will be called on a controller if one is not explicitly specified.</span></span>

<span data-ttu-id="cb9ab-143">Vaya a `http://localhost:xxxx/HelloWorld/Welcome`.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-143">Browse to `http://localhost:xxxx/HelloWorld/Welcome`.</span></span> <span data-ttu-id="cb9ab-144">El `Welcome` método se ejecuta y devuelve la cadena &quot;este es el método de acción bienvenida... &quot;.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-144">The `Welcome` method runs and returns the string &quot;This is the Welcome action method...&quot;.</span></span> <span data-ttu-id="cb9ab-145">La asignación de MVC predeterminada es `/[Controller]/[ActionName]/[Parameters]`.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-145">The default MVC mapping is `/[Controller]/[ActionName]/[Parameters]`.</span></span> <span data-ttu-id="cb9ab-146">Para esta dirección URL, el controlador es `HelloWorld` y `Welcome` es el método.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-146">For this URL, the controller is `HelloWorld` and `Welcome` is the method.</span></span> <span data-ttu-id="cb9ab-147">No hemos usado el `[Parameters]` forma parte de la dirección URL todavía.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-147">We haven't used the `[Parameters]` part of the URL yet.</span></span>

![](adding-a-controller/_static/image6.png)

<span data-ttu-id="cb9ab-148">Vamos a modificar el ejemplo ligeramente para que nos podemos pasar cierta información del parámetro en desde la dirección URL al controlador (por ejemplo, */HelloWorld/Welcome? nombre = Scott&amp;numtimes = 4*).</span><span class="sxs-lookup"><span data-stu-id="cb9ab-148">Let's modify the example slightly so that we can pass some parameter information in from the URL to the controller (for example, */HelloWorld/Welcome?name=Scott&amp;numtimes=4*).</span></span> <span data-ttu-id="cb9ab-149">Cambiar su `Welcome` método para incluir dos parámetros, como se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-149">Change your `Welcome` method to include two parameters as shown below.</span></span> <span data-ttu-id="cb9ab-150">Tenga en cuenta que hemos usado la característica de parámetro opcional de VB para indicar que el `numTimes` parámetro, de forma predeterminada en 1 si se pasa ningún valor para ese parámetro.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-150">Note that we've used the VB optional parameter feature to indicate that the `numTimes` parameter should default to 1 if no value is passed for that parameter.</span></span>

[!code-vb[Main](adding-a-controller/samples/sample2.vb)]

<span data-ttu-id="cb9ab-151">Ejecute la aplicación y vaya a `http://localhost:xxxx/HelloWorld/Welcome?name=Scott&numtimes=4` **.**</span><span class="sxs-lookup"><span data-stu-id="cb9ab-151">Run your application and browse to `http://localhost:xxxx/HelloWorld/Welcome?name=Scott&numtimes=4`**.**</span></span> <span data-ttu-id="cb9ab-152">Puede probar valores diferentes para `name` y `numtimes`.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-152">You can try different values for `name` and `numtimes`.</span></span> <span data-ttu-id="cb9ab-153">El sistema asigna automáticamente los parámetros con nombre de la cadena de consulta en la barra de direcciones para los parámetros del método.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-153">The system automatically maps the named parameters from your query string in the address bar to parameters in your method.</span></span>

![](adding-a-controller/_static/image7.png)

<span data-ttu-id="cb9ab-154">En estos ejemplos de ambos el controlador ha realizado la parte de VC de MVC, que es el trabajo de vista y controlador.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-154">In both these examples the controller has been doing the VC portion of MVC — that is the view and controller work.</span></span> <span data-ttu-id="cb9ab-155">El controlador devuelve HTML directamente.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-155">The controller is returning HTML directly.</span></span> <span data-ttu-id="cb9ab-156">Normalmente no queremos que los controles devuelvan HTML directamente, porque resulta muy complicado de código.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-156">Ordinarily we don't want controllers returning HTML directly, since that becomes very cumbersome to code.</span></span> <span data-ttu-id="cb9ab-157">En su lugar, vamos a usar normalmente un archivo de plantilla de vista independiente para ayudar a generar la respuesta HTML.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-157">Instead we'll typically use a separate view template file to help generate the HTML response.</span></span> <span data-ttu-id="cb9ab-158">Veamos cómo podemos hacer esto.</span><span class="sxs-lookup"><span data-stu-id="cb9ab-158">Let's look at how we can do this.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cb9ab-159">[Anterior](intro-to-aspnet-mvc-3.md)
> [Siguiente](adding-a-view.md)</span><span class="sxs-lookup"><span data-stu-id="cb9ab-159">[Previous](intro-to-aspnet-mvc-3.md)
[Next](adding-a-view.md)</span></span>

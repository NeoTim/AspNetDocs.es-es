---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
title: Actualizar TableAdapter para usar combinaciones (C#) | Microsoft Docs
author: rick-anderson
description: Cuando se trabaja con una base de datos, es habitual solicitar datos distribuidos en varias tablas. Para recuperar datos de dos tablas diferentes, se puede usar...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 675531a7-cb54-4dd6-89ac-2636e4c285a5
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
msc.type: authoredcontent
ms.openlocfilehash: 24ff3645783dabfcdef5ac313a2d4833e4998efc
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2019
ms.locfileid: "74608169"
---
# <a name="updating-the-tableadapter-to-use-joins-c"></a><span data-ttu-id="a92ad-104">Actualizar TableAdapter para usar JOIN (C#)</span><span class="sxs-lookup"><span data-stu-id="a92ad-104">Updating the TableAdapter to Use JOINs (C#)</span></span>

<span data-ttu-id="a92ad-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a92ad-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a92ad-106">[Descargar código](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) o [Descargar PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a92ad-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span></span>

> <span data-ttu-id="a92ad-107">Cuando se trabaja con una base de datos, es habitual solicitar datos distribuidos en varias tablas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="a92ad-108">Para recuperar datos de dos tablas diferentes, se puede usar una subconsulta correlacionada o una operación de combinación.</span><span class="sxs-lookup"><span data-stu-id="a92ad-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="a92ad-109">En este tutorial se comparan las subconsultas correlacionadas y la sintaxis de JOIN antes de ver cómo crear un TableAdapter que incluya una combinación en su consulta principal.</span><span class="sxs-lookup"><span data-stu-id="a92ad-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>

## <a name="introduction"></a><span data-ttu-id="a92ad-110">Introducción</span><span class="sxs-lookup"><span data-stu-id="a92ad-110">Introduction</span></span>

<span data-ttu-id="a92ad-111">Con las bases de datos relacionales, los datos que estamos interesados en trabajar con se suelen distribuir en varias tablas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="a92ad-112">Por ejemplo, al mostrar la información del producto, es probable que desee enumerar los nombres correspondientes de las categorías y los proveedores de cada producto.</span><span class="sxs-lookup"><span data-stu-id="a92ad-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="a92ad-113">La tabla `Products` tiene valores `CategoryID` y `SupplierID`, pero los nombres de categoría y proveedor reales están en las tablas `Categories` y `Suppliers`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="a92ad-114">Para recuperar información de otra tabla relacionada, podemos usar *subconsultas* correlacionadas o `JOIN`*s*.</span><span class="sxs-lookup"><span data-stu-id="a92ad-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="a92ad-115">Una subconsulta correlacionada es una consulta `SELECT` anidada que hace referencia a las columnas de la consulta externa.</span><span class="sxs-lookup"><span data-stu-id="a92ad-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="a92ad-116">Por ejemplo, en el tutorial [creación de una capa de acceso a datos](../introduction/creating-a-data-access-layer-cs.md) usamos dos subconsultas correlacionadas en la consulta principal `ProductsTableAdapter` s para devolver los nombres de categoría y proveedor de cada producto.</span><span class="sxs-lookup"><span data-stu-id="a92ad-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="a92ad-117">Una `JOIN` es una construcción de SQL que combina filas relacionadas de dos tablas diferentes.</span><span class="sxs-lookup"><span data-stu-id="a92ad-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="a92ad-118">Usamos un `JOIN` en el tutorial de [consultas de datos con el control SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) para mostrar información de categoría junto con cada producto.</span><span class="sxs-lookup"><span data-stu-id="a92ad-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="a92ad-119">La razón por la que tenemos abstained de usar `JOIN` s con TableAdapters es debido a las limitaciones del asistente de TableAdapter s para generar automáticamente las instrucciones `INSERT`, `UPDATE`y `DELETE` correspondientes.</span><span class="sxs-lookup"><span data-stu-id="a92ad-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="a92ad-120">Más concretamente, si la consulta principal de TableAdapter s contiene cualquier `JOIN`, el TableAdapter no puede crear automáticamente las instrucciones SQL o los procedimientos almacenados ad hoc para sus propiedades `InsertCommand`, `UpdateCommand`y `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="a92ad-121">En este tutorial, compararemos brevemente y contrastan las subconsultas correlacionadas y `JOIN` s antes de explorar cómo crear un TableAdapter que incluya `JOIN` s en su consulta principal.</span><span class="sxs-lookup"><span data-stu-id="a92ad-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="a92ad-122">Comparar y contrastar las subconsultas correlacionadas y`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="a92ad-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="a92ad-123">Recuerde que los `ProductsTableAdapter` creados en el primer tutorial del conjunto de datos de `Northwind` usan subconsultas correlacionadas para devolver cada producto de la categoría correspondiente y el nombre del proveedor.</span><span class="sxs-lookup"><span data-stu-id="a92ad-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="a92ad-124">A continuación se muestra la consulta principal `ProductsTableAdapter` s.</span><span class="sxs-lookup"><span data-stu-id="a92ad-124">The `ProductsTableAdapter` s main query is shown below.</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample1.sql)]

<span data-ttu-id="a92ad-125">Las dos subconsultas correlacionadas: `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` y `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` son `SELECT` consultas que devuelven un único valor por producto como columna adicional en la lista de columnas de la instrucción de `SELECT` externa.</span><span class="sxs-lookup"><span data-stu-id="a92ad-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="a92ad-126">Como alternativa, se puede usar un `JOIN` para devolver cada proveedor y nombre de categoría del producto.</span><span class="sxs-lookup"><span data-stu-id="a92ad-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="a92ad-127">La consulta siguiente devuelve el mismo resultado que el anterior, pero usa `JOIN` s en lugar de subconsultas:</span><span class="sxs-lookup"><span data-stu-id="a92ad-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample2.sql)]

<span data-ttu-id="a92ad-128">Un `JOIN` combina los registros de una tabla con registros de otra tabla en función de algunos criterios.</span><span class="sxs-lookup"><span data-stu-id="a92ad-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="a92ad-129">En la consulta anterior, por ejemplo, el `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` indica a SQL Server que combine cada registro de producto con el registro de categoría cuyo valor de `CategoryID` coincide con el valor de `CategoryID` del producto.</span><span class="sxs-lookup"><span data-stu-id="a92ad-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="a92ad-130">El resultado combinado nos permite trabajar con los campos de categoría correspondientes para cada producto (como `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="a92ad-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="a92ad-131">los `JOIN` s suelen usarse para consultar datos de bases de datos relacionales.</span><span class="sxs-lookup"><span data-stu-id="a92ad-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="a92ad-132">Si no está familiarizado con la sintaxis de `JOIN` o necesita resaltar un poco en su uso, se recomienda el [tutorial de combinación de SQL](http://www.w3schools.com/sql/sql_join.asp) en [escuelas de W3](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="a92ad-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="a92ad-133">También merece la pena leer las secciones [aspectos básicos del`JOIN`](https://msdn.microsoft.com/library/ms191517.aspx) y [subconsultas](https://msdn.microsoft.com/library/ms189575.aspx) de los [libros en pantalla de SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="a92ad-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>

<span data-ttu-id="a92ad-134">Puesto que `JOIN` s y las subconsultas correlacionadas se pueden usar para recuperar los datos relacionados de otras tablas, muchos desarrolladores dejan el arañazo de sus cabezales y se preguntan qué enfoque usar.</span><span class="sxs-lookup"><span data-stu-id="a92ad-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="a92ad-135">Todos los gurús de SQL a los que he hablado han mencionado aproximadamente lo mismo, que no es tan importante para el rendimiento, ya que SQL Server producirá planes de ejecución aproximadamente idénticos.</span><span class="sxs-lookup"><span data-stu-id="a92ad-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="a92ad-136">A continuación, le aconsejamos que use la técnica con la que usted y su equipo se sienten más cómodos.</span><span class="sxs-lookup"><span data-stu-id="a92ad-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="a92ad-137">Merece la pena tener en cuenta que, después de que se informan estos consejos, estos expertos expresan inmediatamente su preferencia de `JOIN` s en las subconsultas correlacionadas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="a92ad-138">Al compilar una capa de acceso a datos mediante conjuntos de datos con tipo, las herramientas funcionan mejor cuando se usan subconsultas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="a92ad-139">En concreto, el Asistente de TableAdapter s no generará automáticamente las instrucciones `INSERT`, `UPDATE`y `DELETE` correspondientes si la consulta principal contiene `JOIN` s, pero generará automáticamente estas instrucciones cuando se utilicen subconsultas correlacionadas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="a92ad-140">Para explorar este defecto, cree un conjunto de un conjunto de tipos temporal en la carpeta `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="a92ad-141">Durante el Asistente para la configuración de TableAdapter, elija usar instrucciones SQL ad hoc y escriba la siguiente consulta de `SELECT` (consulte la figura 1):</span><span class="sxs-lookup"><span data-stu-id="a92ad-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample3.sql)]

<span data-ttu-id="a92ad-142">[![escriba una consulta principal que contenga combinaciones](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span></span>

<span data-ttu-id="a92ad-143">**Figura 1**: escriba una consulta principal que contenga `JOIN` s ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span></span>

<span data-ttu-id="a92ad-144">De forma predeterminada, el TableAdapter creará automáticamente `INSERT`, `UPDATE`y `DELETE` instrucciones basadas en la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="a92ad-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="a92ad-145">Si hace clic en el botón avanzadas, puede ver que esta característica está habilitada.</span><span class="sxs-lookup"><span data-stu-id="a92ad-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="a92ad-146">A pesar de esta configuración, el TableAdapter no podrá crear las instrucciones `INSERT`, `UPDATE`y `DELETE` porque la consulta principal contiene una `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>

![Escriba una consulta principal que contenga combinaciones](updating-the-tableadapter-to-use-joins-cs/_static/image4.png)

<span data-ttu-id="a92ad-148">**Figura 2**: escriba una consulta principal que contenga `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="a92ad-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>

<span data-ttu-id="a92ad-149">Haga clic en Finalizar para completar el asistente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="a92ad-150">En este momento, el diseñador de DataSet s incluirá un solo TableAdapter con un DataTable con columnas para cada uno de los campos devueltos en la lista de columnas de `SELECT` consulta.</span><span class="sxs-lookup"><span data-stu-id="a92ad-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="a92ad-151">Esto incluye el `CategoryName` y `SupplierName`, como se muestra en la figura 3.</span><span class="sxs-lookup"><span data-stu-id="a92ad-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>

![La DataTable incluye una columna para cada campo devuelto en la lista de columnas.](updating-the-tableadapter-to-use-joins-cs/_static/image5.png)

<span data-ttu-id="a92ad-153">**Figura 3**: la DataTable incluye una columna para cada campo devuelto en la lista de columnas</span><span class="sxs-lookup"><span data-stu-id="a92ad-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>

<span data-ttu-id="a92ad-154">Aunque el objeto DataTable tiene las columnas adecuadas, el TableAdapter carece de valores para sus propiedades `InsertCommand`, `UpdateCommand`y `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="a92ad-155">Para confirmarlo, haga clic en el TableAdapter en el diseñador y, a continuación, vaya a la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="a92ad-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="a92ad-156">Allí verá que las propiedades `InsertCommand`, `UpdateCommand`y `DeleteCommand` están establecidas en (ninguno).</span><span class="sxs-lookup"><span data-stu-id="a92ad-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>

<span data-ttu-id="a92ad-157">[![las propiedades InsertCommand, UpdateCommand y DeleteCommand están establecidas en (ninguna)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span></span>

<span data-ttu-id="a92ad-158">**Figura 4**: las propiedades `InsertCommand`, `UpdateCommand`y `DeleteCommand` están establecidas en (ninguno) ([haga clic para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span></span>

<span data-ttu-id="a92ad-159">Para solucionar este inconveniente, podemos proporcionar manualmente las instrucciones y los parámetros de SQL para las propiedades `InsertCommand`, `UpdateCommand`y `DeleteCommand` a través del ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="a92ad-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="a92ad-160">Como alternativa, podríamos empezar configurando la consulta principal de TableAdapter s para que *no* incluya ningún `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="a92ad-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="a92ad-161">Esto permitirá que se generen automáticamente las instrucciones `INSERT`, `UPDATE`y `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="a92ad-162">Después de completar el asistente, podríamos actualizar manualmente los `SelectCommand` TableAdapter s desde el ventana Propiedades para que incluya la sintaxis de `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="a92ad-163">Aunque este enfoque funciona, es muy complicado cuando se usan consultas SQL ad hoc, ya que cada vez que se reconfigura la consulta principal de TableAdapter s a través del asistente, se vuelven a crear las instrucciones de `INSERT`, `UPDATE`y `DELETE` generadas automáticamente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="a92ad-164">Esto significa que todas las personalizaciones que se han realizado posteriormente se perderían si hacemos clic con el botón derecho en el TableAdapter, seleccionamos configurar en el menú contextual y completamos el Asistente de nuevo.</span><span class="sxs-lookup"><span data-stu-id="a92ad-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="a92ad-165">La fragilidad de las instrucciones de `INSERT`, `UPDATE`y `DELETE` generadas automáticamente por TableAdapter se limita a las instrucciones SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="a92ad-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="a92ad-166">Si el TableAdapter utiliza procedimientos almacenados, puede personalizar los procedimientos almacenados `SelectCommand`, `InsertCommand`, `UpdateCommand`o `DeleteCommand` y volver a ejecutar el Asistente para configuración de TableAdapter sin tener que preocuparse de que se modifiquen los procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="a92ad-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="a92ad-167">En los siguientes pasos se creará un TableAdapter que, inicialmente, usa una consulta principal que omite cualquier `JOIN` s para que los procedimientos almacenados de inserción, actualización y eliminación correspondientes se generen automáticamente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="a92ad-168">A continuación, actualizaremos el `SelectCommand` para que use una `JOIN` que devuelva columnas adicionales de las tablas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="a92ad-169">Por último, crearemos una clase de capa de lógica de negocios correspondiente y mostraremos el uso de TableAdapter en una página web de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a92ad-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="a92ad-170">Paso 1: crear el TableAdapter con una consulta principal simplificada</span><span class="sxs-lookup"><span data-stu-id="a92ad-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="a92ad-171">En este tutorial, vamos a agregar un TableAdapter y un DataTable fuertemente tipado para la tabla `Employees` del conjunto de `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="a92ad-172">La tabla `Employees` contiene un campo `ReportsTo` que especifica la `EmployeeID` del Director de empleados.</span><span class="sxs-lookup"><span data-stu-id="a92ad-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="a92ad-173">Por ejemplo, el empleado Anne Dodsworth tiene un valor `ReportTo` de 5, que es el `EmployeeID` de Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="a92ad-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="a92ad-174">Por lo tanto, Cecilia informa a Steven, su director.</span><span class="sxs-lookup"><span data-stu-id="a92ad-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="a92ad-175">Junto con la notificación de cada empleado `ReportsTo` valor, es posible que también quiera recuperar el nombre de su administrador.</span><span class="sxs-lookup"><span data-stu-id="a92ad-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="a92ad-176">Esto puede realizarse mediante un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="a92ad-177">Pero el uso de un `JOIN` al crear el TableAdapter inicialmente impide que el asistente genere automáticamente las funciones de inserción, actualización y eliminación correspondientes.</span><span class="sxs-lookup"><span data-stu-id="a92ad-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="a92ad-178">Por lo tanto, comenzaremos por crear un TableAdapter cuya consulta principal no contenga ningún `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="a92ad-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="a92ad-179">A continuación, en el paso 2, actualizaremos el procedimiento almacenado de consulta principal para recuperar el nombre del administrador a través de un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="a92ad-180">Para empezar, abra el conjunto de `NorthwindWithSprocs` en la carpeta `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="a92ad-181">Haga clic con el botón secundario en el diseñador, seleccione la opción Agregar en el menú contextual y elija el elemento de menú TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="a92ad-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="a92ad-182">Se iniciará el Asistente para la configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="a92ad-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="a92ad-183">Como se muestra en la figura 5, haga que el asistente cree nuevos procedimientos almacenados y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="a92ad-184">Para obtener un actualizador sobre cómo crear nuevos procedimientos almacenados desde el Asistente de TableAdapter s, consulte el tutorial [creación de nuevos procedimientos almacenados para el conjunto de objetos de tipo TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="a92ad-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="a92ad-185">[![seleccionar la opción crear nuevos procedimientos almacenados](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span></span>

<span data-ttu-id="a92ad-186">**Figura 5**: seleccione la opción crear nuevos procedimientos almacenados ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span></span>

<span data-ttu-id="a92ad-187">Use la siguiente instrucción `SELECT` para la consulta principal de TableAdapter s:</span><span class="sxs-lookup"><span data-stu-id="a92ad-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample4.sql)]

<span data-ttu-id="a92ad-188">Puesto que esta consulta no incluye ningún `JOIN` s, el Asistente para TableAdapter creará automáticamente procedimientos almacenados con las instrucciones `INSERT`, `UPDATE`y `DELETE` correspondientes, así como un procedimiento almacenado para ejecutar la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="a92ad-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="a92ad-189">El siguiente paso nos permite nombrar los procedimientos almacenados de TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="a92ad-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="a92ad-190">Use los nombres `Employees_Select`, `Employees_Insert`, `Employees_Update`y `Employees_Delete`, como se muestra en la figura 6.</span><span class="sxs-lookup"><span data-stu-id="a92ad-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>

<span data-ttu-id="a92ad-191">[![nombre de los procedimientos almacenados de TableAdapter s](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span></span>

<span data-ttu-id="a92ad-192">**Ilustración 6**: asignar un nombre a los procedimientos almacenados de TableAdapter s ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span></span>

<span data-ttu-id="a92ad-193">El paso final nos pide asignar un nombre a los métodos de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="a92ad-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="a92ad-194">Utilice `Fill` y `GetEmployees` como nombres de método.</span><span class="sxs-lookup"><span data-stu-id="a92ad-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="a92ad-195">Asegúrese también de dejar activada la casilla crear métodos para enviar actualizaciones directamente a la base de datos (GenerateDBDirectMethods).</span><span class="sxs-lookup"><span data-stu-id="a92ad-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>

<span data-ttu-id="a92ad-196">[![el nombre de los métodos de TableAdapter s Fill y GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span></span>

<span data-ttu-id="a92ad-197">**Figura 7**: asigne un nombre a los métodos de TableAdapter `Fill` y `GetEmployees` ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span></span>

<span data-ttu-id="a92ad-198">Después de completar el asistente, dedique un momento a examinar los procedimientos almacenados en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a92ad-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="a92ad-199">Debería ver cuatro nuevos: `Employees_Select`, `Employees_Insert`, `Employees_Update`y `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="a92ad-200">A continuación, inspeccione el `EmployeesDataTable` y `EmployeesTableAdapter` que acaba de crear.</span><span class="sxs-lookup"><span data-stu-id="a92ad-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="a92ad-201">DataTable contiene una columna para cada campo devuelto por la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="a92ad-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="a92ad-202">Haga clic en el TableAdapter y, a continuación, vaya a la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="a92ad-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="a92ad-203">Allí verá que las propiedades `InsertCommand`, `UpdateCommand`y `DeleteCommand` están configuradas correctamente para llamar a los procedimientos almacenados correspondientes.</span><span class="sxs-lookup"><span data-stu-id="a92ad-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>

<span data-ttu-id="a92ad-204">[![TableAdapter incluye funcionalidades de inserción, actualización y eliminación](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span></span>

<span data-ttu-id="a92ad-205">**Figura 8**: el TableAdapter incluye funcionalidades de inserción, actualización y eliminación ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span></span>

<span data-ttu-id="a92ad-206">Con los procedimientos almacenados INSERT, Update y DELETE creados automáticamente y las propiedades `InsertCommand`, `UpdateCommand`y `DeleteCommand` configuradas correctamente, estamos preparados para personalizar el procedimiento almacenado `SelectCommand` s con el fin de devolver información adicional sobre cada director de empleados.</span><span class="sxs-lookup"><span data-stu-id="a92ad-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="a92ad-207">En concreto, es necesario actualizar el `Employees_Select` procedimiento almacenado para usar una `JOIN` y devolver los valores de `FirstName` y `LastName` de administrador.</span><span class="sxs-lookup"><span data-stu-id="a92ad-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="a92ad-208">Una vez actualizado el procedimiento almacenado, será necesario actualizar el objeto DataTable para que incluya estas columnas adicionales.</span><span class="sxs-lookup"><span data-stu-id="a92ad-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="a92ad-209">Abordaremos estas dos tareas en los pasos 2 y 3.</span><span class="sxs-lookup"><span data-stu-id="a92ad-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="a92ad-210">Paso 2: personalizar el procedimiento almacenado para incluir un`JOIN`</span><span class="sxs-lookup"><span data-stu-id="a92ad-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="a92ad-211">Para empezar, vaya a la Explorador de servidores, explore en profundidad la carpeta de procedimientos almacenados de la base de datos Northwind y abra el procedimiento almacenado `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="a92ad-212">Si no ve este procedimiento almacenado, haga clic con el botón secundario en la carpeta procedimientos almacenados y elija actualizar.</span><span class="sxs-lookup"><span data-stu-id="a92ad-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="a92ad-213">Actualice el procedimiento almacenado para que use un `LEFT JOIN` para devolver el nombre y el apellido del administrador:</span><span class="sxs-lookup"><span data-stu-id="a92ad-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>

[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample5.sql)]

<span data-ttu-id="a92ad-214">Después de actualizar la instrucción `SELECT`, guarde los cambios; para ello, vaya al menú Archivo y elija guardar `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="a92ad-215">Como alternativa, puede hacer clic en el icono guardar en la barra de herramientas o presionar CTRL + S.</span><span class="sxs-lookup"><span data-stu-id="a92ad-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="a92ad-216">Después de guardar los cambios, haga clic con el botón derecho en el `Employees_Select` procedimiento almacenado en el Explorador de servidores y elija Ejecutar.</span><span class="sxs-lookup"><span data-stu-id="a92ad-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="a92ad-217">Se ejecutará el procedimiento almacenado y se mostrarán los resultados en la ventana de salida (vea la ilustración 9).</span><span class="sxs-lookup"><span data-stu-id="a92ad-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>

<span data-ttu-id="a92ad-218">[![los resultados de los procedimientos almacenados se muestran en el Ventana de salida](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span></span>

<span data-ttu-id="a92ad-219">**Figura 9**: los resultados de los procedimientos almacenados se muestran en el ventana de salida ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span></span>

## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="a92ad-220">Paso 3: actualizar las columnas de DataTable s</span><span class="sxs-lookup"><span data-stu-id="a92ad-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="a92ad-221">En este momento, el `Employees_Select` procedimiento almacenado devuelve `ManagerFirstName` y `ManagerLastName`, pero el `EmployeesDataTable` no tiene estas columnas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="a92ad-222">Estas columnas que faltan se pueden agregar a la DataTable de una de estas dos maneras:</span><span class="sxs-lookup"><span data-stu-id="a92ad-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="a92ad-223">**Manualmente** : haga clic con el botón derecho en DataTable en el diseñador de DataSet y, en el menú Agregar, elija columna.</span><span class="sxs-lookup"><span data-stu-id="a92ad-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="a92ad-224">Después, puede asignar un nombre a la columna y establecer sus propiedades en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="a92ad-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="a92ad-225">**Automáticamente** : el Asistente para configuración de TableAdapter actualizará las columnas DataTable s para reflejar los campos devueltos por el `SelectCommand` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="a92ad-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="a92ad-226">Cuando se utilizan instrucciones SQL ad hoc, el Asistente también quitará las propiedades `InsertCommand`, `UpdateCommand`y `DeleteCommand`, ya que el `SelectCommand` contiene ahora una `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="a92ad-227">Pero cuando se usan procedimientos almacenados, estas propiedades de comando permanecen intactas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="a92ad-228">Hemos explorado manualmente la adición de columnas DataTable en los tutoriales anteriores, incluidos el maestro y los [detalles, con una lista con viñetas de registros maestros con una lista de datos de detalles](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) y la carga de [archivos](../working-with-binary-files/uploading-files-cs.md), y veremos este proceso de nuevo con más detalle en el siguiente tutorial.</span><span class="sxs-lookup"><span data-stu-id="a92ad-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) and [Uploading Files](../working-with-binary-files/uploading-files-cs.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="a92ad-229">Sin embargo, para este tutorial, se permite usar el enfoque automático mediante el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="a92ad-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="a92ad-230">Para empezar, haga clic con el botón derecho en el `EmployeesTableAdapter` y seleccione configurar en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="a92ad-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="a92ad-231">Se abre el Asistente para configuración de TableAdapter, que enumera los procedimientos almacenados que se usan para seleccionar, insertar, actualizar y eliminar, junto con los valores devueltos y los parámetros (si existen).</span><span class="sxs-lookup"><span data-stu-id="a92ad-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="a92ad-232">La figura 10 muestra este asistente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="a92ad-233">Aquí podemos ver que el procedimiento almacenado de `Employees_Select` ahora devuelve los campos `ManagerFirstName` y `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>

<span data-ttu-id="a92ad-234">[![el asistente muestra la lista de columnas actualizada para el procedimiento almacenado Employees_Select](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span></span>

<span data-ttu-id="a92ad-235">**Figura 10**: el asistente muestra la lista de columnas actualizada para el `Employees_Select` procedimiento almacenado ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span></span>

<span data-ttu-id="a92ad-236">Para completar el asistente, haga clic en finalizar.</span><span class="sxs-lookup"><span data-stu-id="a92ad-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="a92ad-237">Al volver al diseñador de DataSet, el `EmployeesDataTable` incluye dos columnas adicionales: `ManagerFirstName` y `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>

<span data-ttu-id="a92ad-238">[![EmployeesDataTable contiene dos nuevas columnas](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span></span>

<span data-ttu-id="a92ad-239">**Figura 11**: el `EmployeesDataTable` contiene dos nuevas columnas ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span></span>

<span data-ttu-id="a92ad-240">Para ilustrar que el procedimiento almacenado `Employees_Select` actualizado está en vigor y que las funciones de inserción, actualización y eliminación de TableAdapter siguen siendo funcionales, permita crear una página web que permita a los usuarios ver y eliminar empleados.</span><span class="sxs-lookup"><span data-stu-id="a92ad-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="a92ad-241">Sin embargo, antes de crear este tipo de página, es necesario crear primero una nueva clase en la capa de lógica de negocios para trabajar con los empleados del conjunto de `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="a92ad-242">En el paso 4, crearemos una clase `EmployeesBLLWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="a92ad-243">En el paso 5, usaremos esta clase desde una página de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a92ad-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="a92ad-244">Paso 4: implementación de la capa de lógica de negocios</span><span class="sxs-lookup"><span data-stu-id="a92ad-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="a92ad-245">Cree un nuevo archivo de clase en la carpeta `~/App_Code/BLL` denominada `EmployeesBLLWithSprocs.cs`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.cs`.</span></span> <span data-ttu-id="a92ad-246">Esta clase imita la semántica de la clase de `EmployeesBLL` existente, solo esta nueva proporciona menos métodos y utiliza el conjunto de `NorthwindWithSprocs` (en lugar de `Northwind` conjunto de caracteres).</span><span class="sxs-lookup"><span data-stu-id="a92ad-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="a92ad-247">Agregue el código siguiente a la clase `EmployeesBLLWithSprocs` .</span><span class="sxs-lookup"><span data-stu-id="a92ad-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>

[!code-csharp[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample6.cs)]

<span data-ttu-id="a92ad-248">La propiedad `EmployeesBLLWithSprocs` Class s `Adapter` devuelve una instancia de la `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="a92ad-249">Lo usan los métodos `GetEmployees` y `DeleteEmployee` de la clase s.</span><span class="sxs-lookup"><span data-stu-id="a92ad-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="a92ad-250">El método `GetEmployees` llama al método `GetEmployees` `EmployeesTableAdapter` correspondiente, que invoca el procedimiento almacenado `Employees_Select` y rellena sus resultados en un `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="a92ad-251">El método `DeleteEmployee` llama de forma similar al método `EmployeesTableAdapter` s `Delete`, que invoca el procedimiento almacenado `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="a92ad-252">Paso 5: trabajar con los datos de la capa de presentación</span><span class="sxs-lookup"><span data-stu-id="a92ad-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="a92ad-253">Una vez completada la clase `EmployeesBLLWithSprocs`, se vuelve a preparar para trabajar con los datos de los empleados a través de una página de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a92ad-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="a92ad-254">Abra la página `JOINs.aspx` en la carpeta `AdvancedDAL` y arrastre un control GridView desde el cuadro de herramientas hasta el diseñador, estableciendo su propiedad `ID` en `Employees`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="a92ad-255">A continuación, desde la etiqueta inteligente de GridView s, enlace la cuadrícula a un nuevo control ObjectDataSource denominado `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="a92ad-256">Configure ObjectDataSource para usar la clase `EmployeesBLLWithSprocs` y, en las pestañas seleccionar y eliminar, asegúrese de que los métodos `GetEmployees` y `DeleteEmployee` estén seleccionados en las listas desplegables.</span><span class="sxs-lookup"><span data-stu-id="a92ad-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="a92ad-257">Haga clic en finalizar para completar la configuración de ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="a92ad-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>

<span data-ttu-id="a92ad-258">[![configurar ObjectDataSource para usar la clase EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span></span>

<span data-ttu-id="a92ad-259">**Figura 12**: configuración de ObjectDataSource para usar la clase `EmployeesBLLWithSprocs` ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span></span>

<span data-ttu-id="a92ad-260">[![que ObjectDataSource use los métodos GetEmployees y DeleteEmployee](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span></span>

<span data-ttu-id="a92ad-261">**Figura 13**: hacer que ObjectDataSource use los métodos `GetEmployees` y `DeleteEmployee` ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span></span>

<span data-ttu-id="a92ad-262">Visual Studio agregará BoundField a GridView para cada una de las columnas de `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="a92ad-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="a92ad-263">Quite todas estas BoundFields, excepto `Title`, `LastName`, `FirstName`, `ManagerFirstName`y `ManagerLastName` y cambiar el nombre de las propiedades de `HeaderText` de los cuatro últimos BoundFields a apellidos, nombre, nombre de administrador y apellidos de administrador, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="a92ad-264">Para permitir que los usuarios eliminen los empleados de esta página, es necesario hacer dos cosas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="a92ad-265">En primer lugar, indique a GridView que proporcione capacidades de eliminación mediante la comprobación de la opción Habilitar eliminación de su etiqueta inteligente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="a92ad-266">En segundo lugar, cambie la propiedad ObjectDataSource s `OldValuesParameterFormatString` del valor establecido por el Asistente para ObjectDataSource (`original_{0}`) a su valor predeterminado (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="a92ad-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="a92ad-267">Después de realizar estos cambios, el marcado declarativo de GridView y ObjectDataSource s debería tener un aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="a92ad-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample7.aspx)]

<span data-ttu-id="a92ad-268">Pruebe la página visitando el explorador.</span><span class="sxs-lookup"><span data-stu-id="a92ad-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="a92ad-269">Como se muestra en la figura 14, la página enumerará cada empleado y su nombre de administrador (suponiendo que tienen uno).</span><span class="sxs-lookup"><span data-stu-id="a92ad-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>

<span data-ttu-id="a92ad-270">[![la combinación en el Employees_Select procedimiento almacenado devuelve el nombre del administrador](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span></span>

<span data-ttu-id="a92ad-271">**Figura 14**: el `JOIN` en el `Employees_Select` procedimiento almacenado devuelve el nombre del administrador ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span></span>

<span data-ttu-id="a92ad-272">Al hacer clic en el botón eliminar, se inicia el flujo de trabajo de eliminación, que culmina en la ejecución del `Employees_Delete` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="a92ad-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="a92ad-273">Sin embargo, el intento de `DELETE` instrucción en el procedimiento almacenado produce un error debido a una infracción de la restricción de clave externa (vea la figura 15).</span><span class="sxs-lookup"><span data-stu-id="a92ad-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="a92ad-274">En concreto, cada empleado tiene uno o varios registros en la tabla `Orders`, lo que provocará un error en la eliminación.</span><span class="sxs-lookup"><span data-stu-id="a92ad-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>

<span data-ttu-id="a92ad-275">[![eliminar un empleado que tiene pedidos correspondientes tiene como resultado una infracción de restricción de clave externa](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="a92ad-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span></span>

<span data-ttu-id="a92ad-276">**Figura 15**: eliminación de un empleado que tiene pedidos correspondientes da como resultado una infracción de restricción de clave externa ([haga clic para ver la imagen de tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="a92ad-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span></span>

<span data-ttu-id="a92ad-277">Para permitir que se elimine un empleado, puede:</span><span class="sxs-lookup"><span data-stu-id="a92ad-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="a92ad-278">Actualice la restricción FOREIGN KEY para las eliminaciones en cascada.</span><span class="sxs-lookup"><span data-stu-id="a92ad-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="a92ad-279">Elimine manualmente los registros de la tabla `Orders` para los empleados que desea eliminar, o bien</span><span class="sxs-lookup"><span data-stu-id="a92ad-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="a92ad-280">Actualice el `Employees_Delete` procedimiento almacenado para eliminar primero los registros relacionados de la tabla de `Orders` antes de eliminar el registro de `Employees`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="a92ad-281">Hemos explicado esta técnica en el tutorial [uso de procedimientos almacenados existentes para el conjunto de objetos del mismo tipo](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="a92ad-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="a92ad-282">Dejo esto como un ejercicio para el lector.</span><span class="sxs-lookup"><span data-stu-id="a92ad-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="a92ad-283">Resumen</span><span class="sxs-lookup"><span data-stu-id="a92ad-283">Summary</span></span>

<span data-ttu-id="a92ad-284">Cuando se trabaja con bases de datos relacionales, es habitual que las consultas extraigan sus datos de varias tablas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="a92ad-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="a92ad-285">Las subconsultas correlacionadas y `JOIN` s proporcionan dos técnicas diferentes para tener acceso a los datos de las tablas relacionadas en una consulta.</span><span class="sxs-lookup"><span data-stu-id="a92ad-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="a92ad-286">En los tutoriales anteriores, normalmente se usan subconsultas correlacionadas porque el TableAdapter no puede generar automáticamente instrucciones `INSERT`, `UPDATE`y `DELETE` para las consultas que implican `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="a92ad-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="a92ad-287">Aunque estos valores se pueden proporcionar manualmente, al usar las instrucciones SQL ad hoc, se sobrescribirán las personalizaciones cuando se complete el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="a92ad-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="a92ad-288">Afortunadamente, los TableAdapters creados con procedimientos almacenados no sufren la misma fragilidad que los creados mediante instrucciones SQL ad-hoc.</span><span class="sxs-lookup"><span data-stu-id="a92ad-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="a92ad-289">Por lo tanto, es factible crear un TableAdapter cuya consulta principal utiliza un `JOIN` cuando se usan procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="a92ad-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="a92ad-290">En este tutorial, vimos cómo crear este tipo de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="a92ad-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="a92ad-291">Iniciamos con una consulta `SELECT` de `JOIN`menos para la consulta principal de TableAdapter s de modo que los procedimientos almacenados de inserción, actualización y eliminación correspondientes se crearan automáticamente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="a92ad-292">Una vez completada la configuración inicial de TableAdapter s, hemos aumentado el `SelectCommand` procedimiento almacenado para usar una `JOIN` y volver a ejecutar el Asistente para configuración de TableAdapter para actualizar las columnas de `EmployeesDataTable` s.</span><span class="sxs-lookup"><span data-stu-id="a92ad-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="a92ad-293">Volver a ejecutar el Asistente para configuración de TableAdapter actualizó automáticamente el `EmployeesDataTable` columnas para reflejar los campos de datos devueltos por el procedimiento almacenado `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="a92ad-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="a92ad-294">Como alternativa, podríamos haber agregado estas columnas manualmente a la DataTable.</span><span class="sxs-lookup"><span data-stu-id="a92ad-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="a92ad-295">Veremos cómo agregar columnas manualmente a la DataTable en el siguiente tutorial.</span><span class="sxs-lookup"><span data-stu-id="a92ad-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="a92ad-296">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="a92ad-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a92ad-297">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="a92ad-297">About the Author</span></span>

<span data-ttu-id="a92ad-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros de ASP/ASP. net y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="a92ad-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a92ad-299">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="a92ad-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a92ad-300">Su último libro se [*enseña a ASP.NET 2,0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="a92ad-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a92ad-301">Puede ponerse en contacto con usted en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a92ad-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="a92ad-302">o a través de su blog, que encontrará en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="a92ad-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a92ad-303">Agradecimiento especial a</span><span class="sxs-lookup"><span data-stu-id="a92ad-303">Special Thanks To</span></span>

<span data-ttu-id="a92ad-304">Muchos revisores útiles revisaron esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="a92ad-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a92ad-305">Los revisores responsables de este tutorial fueron Hilton Geisenow, David Suru y Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="a92ad-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="a92ad-306">¿Está interesado en revisar los próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="a92ad-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a92ad-307">En caso afirmativo, suéltelo en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a92ad-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a92ad-308">[Anterior](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [Siguiente](adding-additional-datatable-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="a92ad-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](adding-additional-datatable-columns-cs.md)</span></span>

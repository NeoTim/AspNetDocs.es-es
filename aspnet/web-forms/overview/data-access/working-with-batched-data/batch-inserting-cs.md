---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
title: Lote de inserción (C#) | Microsoft Docs
author: rick-anderson
description: Obtenga información sobre cómo insertar varios registros de base de datos en una sola operación. En la capa de interfaz de usuario se amplía el control GridView para permitir al usuario que escriba n varios...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: cf025e08-48fc-4385-b176-8610aa7b5565
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
msc.type: authoredcontent
ms.openlocfilehash: 49bdb8e6429449417f2a5ecb2a00101928e3c82e
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/17/2019
ms.locfileid: "59401028"
---
# <a name="batch-inserting-c"></a><span data-ttu-id="18069-104">Inserción por lotes (C#)</span><span class="sxs-lookup"><span data-stu-id="18069-104">Batch Inserting (C#)</span></span>

<span data-ttu-id="18069-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="18069-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="18069-106">[Descargar código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) o [descargar PDF](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="18069-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) or [Download PDF](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span></span>

> <span data-ttu-id="18069-107">Obtenga información sobre cómo insertar varios registros de base de datos en una sola operación.</span><span class="sxs-lookup"><span data-stu-id="18069-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="18069-108">En la capa de interfaz de usuario se amplía el control GridView para permitir al usuario escribir varios registros nuevos.</span><span class="sxs-lookup"><span data-stu-id="18069-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="18069-109">En la capa de acceso a datos se encapsulan las operaciones de inserción varias dentro de una transacción para garantizar que todas las inserciones se realizan correctamente o se revierten todas las inserciones.</span><span class="sxs-lookup"><span data-stu-id="18069-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="18069-110">Introducción</span><span class="sxs-lookup"><span data-stu-id="18069-110">Introduction</span></span>

<span data-ttu-id="18069-111">En el [actualización por lotes](batch-updating-cs.md) tutorial analizamos personalizar el control GridView para presentar una interfaz donde estaban puede editables varios registros.</span><span class="sxs-lookup"><span data-stu-id="18069-111">In the [Batch Updating](batch-updating-cs.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="18069-112">El usuario visita la página podría realizar una serie de cambios y, a continuación, con un solo clic el botón, realizar una actualización por lotes.</span><span class="sxs-lookup"><span data-stu-id="18069-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="18069-113">Para situaciones donde los usuarios normalmente actualizan varios registros en una sola operación, esta interfaz puede ahorrar innumerables clics y cambios de contexto de teclado para el mouse cuando se compara con el valor predeterminado por fila características de edición que se han explorado en primer lugar en el [un Información general de insertar, actualizar y eliminar datos](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="18069-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial.</span></span>

<span data-ttu-id="18069-114">Este concepto también se puede aplicar cuando se agreguen registros.</span><span class="sxs-lookup"><span data-stu-id="18069-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="18069-115">Imagine que aquí de Northwind Traders se suele recepción envíos de proveedores que contienen un número de productos para una categoría determinada.</span><span class="sxs-lookup"><span data-stu-id="18069-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="18069-116">Por ejemplo, podríamos recibimos un envío de seis productos de café y té diferentes de Tokio Traders.</span><span class="sxs-lookup"><span data-stu-id="18069-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="18069-117">Si un usuario escribe los seis productos de uno a la vez a través de un control DetailsView, deberá elegir muchos de los mismos valores y otra vez: deberá elegir la misma categoría (bebidas), el mismo proveedor (Tokio Traders), el mismo valor (de suspendido False) y las mismas unidades en el valor de orden (0).</span><span class="sxs-lookup"><span data-stu-id="18069-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="18069-118">Esta entrada de datos repetitivos no sólo es lenta, pero es propensa a errores.</span><span class="sxs-lookup"><span data-stu-id="18069-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="18069-119">Podemos crear un lote de inserción de interfaz que permite al usuario elegir el proveedor y la categoría una vez, escriba una serie de nombres de producto y los precios de venta y, a continuación, haga clic en un botón para agregar los nuevos productos a la base de datos con un poco de trabajo (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="18069-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="18069-120">Al agregar cada producto, su `ProductName` y `UnitPrice` campos de datos se asignan los valores especificados en los cuadros de texto, mientras que su `CategoryID` y `SupplierID` valores se asignan los valores de las listas desplegables en el fo superior del formulario.</span><span class="sxs-lookup"><span data-stu-id="18069-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="18069-121">El `Discontinued` y `UnitsOnOrder` valores se establecen en los valores codificados de forma rígida de `false` y 0, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="18069-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `false` and 0, respectively.</span></span>


<span data-ttu-id="18069-122">[![La interfaz de inserción por lotes](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="18069-122">[![The Batch Inserting Interface](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span></span>

<span data-ttu-id="18069-123">**Figura 1**: La interfaz de inserción por lotes ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="18069-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-cs/_static/image3.png))</span></span>


<span data-ttu-id="18069-124">En este tutorial crearemos una página que implementa el lote de inserción de interfaz que se muestra en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="18069-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="18069-125">Como con los dos tutoriales anteriores, se ajustarán las inserciones dentro del ámbito de una transacción para garantizar la atomicidad.</span><span class="sxs-lookup"><span data-stu-id="18069-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="18069-126">Introducción s Let!</span><span class="sxs-lookup"><span data-stu-id="18069-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="18069-127">Paso 1: Creación de la interfaz de visualización</span><span class="sxs-lookup"><span data-stu-id="18069-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="18069-128">En este tutorial se compone de una sola página que se divide en dos regiones: una región de presentación y una región de inserción.</span><span class="sxs-lookup"><span data-stu-id="18069-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="18069-129">La interfaz de presentación, vamos a crear en este paso, muestra los productos en un control GridView e incluye un botón llamado el proceso de envío del producto.</span><span class="sxs-lookup"><span data-stu-id="18069-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="18069-130">Cuando se hace clic en este botón, la interfaz de presentación se reemplaza con la interfaz de inserción, que se muestra en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="18069-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="18069-131">Devuelve la interfaz de la pantalla después de agregar productos de envío o se hace clic en los botones Cancelar.</span><span class="sxs-lookup"><span data-stu-id="18069-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="18069-132">Vamos a crear la interfaz de inserción en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="18069-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="18069-133">Al crear una página que tiene dos interfaces, sólo uno de los cuales está visible en un momento, cada interfaz normalmente se coloca dentro de un [control Panel Web](http://www.w3schools.com/aspnet/control_panel.asp), que actúa como contenedor para otros controles.</span><span class="sxs-lookup"><span data-stu-id="18069-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="18069-134">Por lo tanto, nuestra página tendrá dos controles de Panel uno para cada interfaz.</span><span class="sxs-lookup"><span data-stu-id="18069-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="18069-135">Comience abriendo la `BatchInsert.aspx` página en el `BatchData` arrastrar un Panel desde el cuadro de herramientas hasta el diseñador y carpeta (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="18069-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="18069-136">Establecer el Panel de s `ID` propiedad `DisplayInterface`.</span><span class="sxs-lookup"><span data-stu-id="18069-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="18069-137">Cuando se agrega el Panel hasta el diseñador, su `Height` y `Width` propiedades se establecen en 50 px y 125px, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="18069-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="18069-138">Limpiar estos valores de propiedad de la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="18069-138">Clear out these property values from the Properties window.</span></span>


<span data-ttu-id="18069-139">[![Arrastre un Panel desde el cuadro de herramientas hasta el diseñador](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="18069-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span></span>

<span data-ttu-id="18069-140">**Figura 2**: Arrastre un Panel desde el cuadro de herramientas hasta el diseñador ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="18069-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-cs/_static/image6.png))</span></span>


<span data-ttu-id="18069-141">A continuación, arrastre un control de botón y GridView en el Panel.</span><span class="sxs-lookup"><span data-stu-id="18069-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="18069-142">Establezca el botón s `ID` propiedad `ProcessShipment` y su `Text` propiedad proceso de envío del producto.</span><span class="sxs-lookup"><span data-stu-id="18069-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="18069-143">Establezca la s GridView `ID` propiedad `ProductsGrid` y, en la etiqueta inteligente, de enlazarla a un nuevo origen ObjectDataSource denominado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="18069-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="18069-144">Configurar el origen ObjectDataSource para extraer sus datos de la `ProductsBLL` clase s `GetProducts` método.</span><span class="sxs-lookup"><span data-stu-id="18069-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="18069-145">Puesto que este GridView sólo se utiliza para mostrar los datos, establezca las listas desplegables en la actualización, INSERCIÓN y eliminar pestañas en (None).</span><span class="sxs-lookup"><span data-stu-id="18069-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="18069-146">Haga clic en Finalizar para completar al Asistente para configurar orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="18069-146">Click Finish to complete the Configure Data Source wizard.</span></span>


<span data-ttu-id="18069-147">[![Mostrar los datos devueltos por el método de clase ProductsBLL s GetProducts](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="18069-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span></span>

<span data-ttu-id="18069-148">**Figura 3**: Mostrar los datos devueltos desde el `ProductsBLL` clase s `GetProducts` método ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="18069-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-cs/_static/image9.png))</span></span>


<span data-ttu-id="18069-149">[![Establecer las listas desplegables en la actualización, INSERCIÓN y eliminar las fichas en (None)](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="18069-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span></span>

<span data-ttu-id="18069-150">**Figura 4**: Establecer la lista desplegable se enumeran en la actualización, INSERCIÓN y eliminar pestañas en (None) ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="18069-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-cs/_static/image12.png))</span></span>


<span data-ttu-id="18069-151">Después de completar al ObjectDataSource wizard, Visual Studio agregará BoundFields y un CampoCasillaVerificación para los campos de datos del producto.</span><span class="sxs-lookup"><span data-stu-id="18069-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="18069-152">Quite todos menos a los `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, y `Discontinued` campos.</span><span class="sxs-lookup"><span data-stu-id="18069-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="18069-153">No dude en realizar personalizaciones estéticas.</span><span class="sxs-lookup"><span data-stu-id="18069-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="18069-154">He decidido dar formato a la `UnitPrice` campo como un valor de moneda, reordenar los campos y cambiar el nombre de algunos de los campos `HeaderText` valores.</span><span class="sxs-lookup"><span data-stu-id="18069-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="18069-155">También configurar el control GridView para incluir la paginación y ordenación soporte activando las casillas de verificación Habilitar paginación y habilitar la ordenación en la etiqueta inteligente de s GridView.</span><span class="sxs-lookup"><span data-stu-id="18069-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="18069-156">Después de agregar los controles de Panel, botón, GridView y ObjectDataSource y personalizar los campos de s GridView, el marcado declarativo de la página s debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="18069-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](batch-inserting-cs/samples/sample1.aspx)]

<span data-ttu-id="18069-157">Tenga en cuenta que el marcado para el botón y GridView aparecen dentro de la apertura y cierre `<asp:Panel>` etiquetas.</span><span class="sxs-lookup"><span data-stu-id="18069-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="18069-158">Puesto que estos controles están en el `DisplayInterface` Panel, nos podemos ocultarlos simplemente estableciendo el Panel s `Visible` propiedad `false`.</span><span class="sxs-lookup"><span data-stu-id="18069-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `false`.</span></span> <span data-ttu-id="18069-159">Paso 3 examina cambiar mediante programación el Panel s `Visible` haga clic en Propiedades en respuesta a un botón para mostrar una interfaz ocultando la otra.</span><span class="sxs-lookup"><span data-stu-id="18069-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="18069-160">Dedique un momento para ver nuestro progreso a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="18069-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="18069-161">Como se muestra en la figura 5, debería ver un botón de envío del producto de proceso por encima de un control GridView que muestra los diez productos a la vez.</span><span class="sxs-lookup"><span data-stu-id="18069-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>


<span data-ttu-id="18069-162">[![El control GridView enumera los productos y ofrece la ordenación y paginación capacidades](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="18069-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span></span>

<span data-ttu-id="18069-163">**Figura 5**: El control GridView enumera los productos y ofrece la ordenación y paginación capacidades ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="18069-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-cs/_static/image15.png))</span></span>


## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="18069-164">Paso 2: Creación de la interfaz de inserción</span><span class="sxs-lookup"><span data-stu-id="18069-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="18069-165">Con la interfaz de pantalla completa, que está listo para crear la inserción de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="18069-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="18069-166">Para este tutorial, permiten crear una interfaz de inserción que se le pide un valor único de proveedor y categoría y, a continuación, permite al usuario escribir hasta cinco nombres de producto y los valores de precio unitario de s.</span><span class="sxs-lookup"><span data-stu-id="18069-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="18069-167">Con esta interfaz, el usuario puede agregar uno a cinco nuevos productos que todos compartan la misma categoría y proveedor, pero tienen precios y los nombres de producto único.</span><span class="sxs-lookup"><span data-stu-id="18069-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="18069-168">Comience por arrastrar un Panel desde el cuadro de herramientas hasta el diseñador, colocarlo debajo existente `DisplayInterface` Panel.</span><span class="sxs-lookup"><span data-stu-id="18069-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="18069-169">Establecer el `ID` recién agrega la propiedad de este Panel para `InsertingInterface` y establezca su `Visible` propiedad `false`.</span><span class="sxs-lookup"><span data-stu-id="18069-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `false`.</span></span> <span data-ttu-id="18069-170">Vamos a agregar código que establece la `InsertingInterface` Panel s `Visible` propiedad `true` en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="18069-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `true` in Step 3.</span></span> <span data-ttu-id="18069-171">Borrar el Panel s también `Height` y `Width` los valores de propiedad.</span><span class="sxs-lookup"><span data-stu-id="18069-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="18069-172">A continuación, necesitamos crear la interfaz de inserción que se mostró en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="18069-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="18069-173">Esta interfaz se puede crear a través de una variedad de técnicas HTML, pero vamos a utilizar uno bastante sencillo: una tabla de cuatro columnas y filas siete.</span><span class="sxs-lookup"><span data-stu-id="18069-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="18069-174">Al escribir el marcado HTML `<table>` elementos, prefiero usar la vista del origen.</span><span class="sxs-lookup"><span data-stu-id="18069-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="18069-175">Mientras que Visual Studio dispone de herramientas para agregar `<table>` elementos a través del diseñador, el diseñador parece todo demasiado dispuesto inyectar treta para `style` configuración en el marcado.</span><span class="sxs-lookup"><span data-stu-id="18069-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="18069-176">Una vez que he creado la `<table>` marcado, normalmente volver al diseñador para agregar los controles Web y establecer sus propiedades.</span><span class="sxs-lookup"><span data-stu-id="18069-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="18069-177">Al crear tablas con filas y columnas predeterminadas prefieren usar HTML estático en lugar de [control de tabla Web](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) porque los controles de Web situados dentro de un control de tabla Web solo se pueden acceder mediante el `FindControl("controlID")` patrón.</span><span class="sxs-lookup"><span data-stu-id="18069-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="18069-178">Sin embargo,, uso los controles Web de la tabla para las tablas de tamaño dinámicamente (los cuyas filas o columnas se basan en alguna base de datos o los criterios especificados por el usuario), desde el control puede crearse mediante programación de tabla Web.</span><span class="sxs-lookup"><span data-stu-id="18069-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>


<span data-ttu-id="18069-179">Escriba el siguiente marcado dentro de la `<asp:Panel>` etiquetas de la `InsertingInterface` Panel:</span><span class="sxs-lookup"><span data-stu-id="18069-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>


[!code-html[Main](batch-inserting-cs/samples/sample2.html)]

<span data-ttu-id="18069-180">Esto `<table>` marcado no incluye todos los controles Web aún, vamos a agregarlos momentáneamente.</span><span class="sxs-lookup"><span data-stu-id="18069-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="18069-181">Tenga en cuenta que cada `<tr>` elemento contiene un valor específico de clase CSS: `BatchInsertHeaderRow` para la fila de encabezado donde el proveedor y la categoría DropDownLists irá; `BatchInsertFooterRow` para la fila de pie de página donde se van agregar productos de envío y los botones Cancelar; y alternos `BatchInsertRow` y `BatchInsertAlternatingRow` controles TextBox de precios de los valores de las filas que se va a contener el producto y la unidad.</span><span class="sxs-lookup"><span data-stu-id="18069-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="18069-182">Se ve crea clases CSS correspondientes en el `Styles.css` archivo para que la interfaz de insertar un aspecto similar a la GridView y DetailsView controla se ve que se usan en estos tutoriales.</span><span class="sxs-lookup"><span data-stu-id="18069-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="18069-183">Estas clases CSS se muestran a continuación.</span><span class="sxs-lookup"><span data-stu-id="18069-183">These CSS classes are shown below.</span></span>


[!code-css[Main](batch-inserting-cs/samples/sample3.css)]

<span data-ttu-id="18069-184">Con este marcado, vuelva a la vista de diseño.</span><span class="sxs-lookup"><span data-stu-id="18069-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="18069-185">Esto `<table>` debe aparecer como una tabla de cuatro columnas y siete filas en el diseñador, como se muestra en la figura 6.</span><span class="sxs-lookup"><span data-stu-id="18069-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>


<span data-ttu-id="18069-186">[![La interfaz de inserción se compone de una tabla de una fila de siete de cuatro columnas](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="18069-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span></span>

<span data-ttu-id="18069-187">**Figura 6**: La interfaz de inserción se compone de una tabla de una fila de siete de cuatro columnas ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="18069-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-cs/_static/image18.png))</span></span>


<span data-ttu-id="18069-188">Nos re ahora está listo para agregar los controles Web a la interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="18069-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="18069-189">Arrastre dos DropDownLists desde el cuadro de herramientas a las celdas de la tabla para el proveedor y otra para la categoría adecuadas.</span><span class="sxs-lookup"><span data-stu-id="18069-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="18069-190">Establecer proveedor DropDownList s `ID` propiedad `Suppliers` y enlazarlo a un nuevo origen ObjectDataSource denominado `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="18069-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="18069-191">Configurar el nuevo origen ObjectDataSource para recuperar sus datos desde el `SuppliersBLL` clase s `GetSuppliers` método y la actualización del conjunto pestaña lista desplegable de s en (None).</span><span class="sxs-lookup"><span data-stu-id="18069-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="18069-192">Haga clic en Finalizar para completar al asistente.</span><span class="sxs-lookup"><span data-stu-id="18069-192">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="18069-193">[![Configurar el origen ObjectDataSource para usar el método de clase SuppliersBLL s GetSuppliers](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="18069-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span></span>

<span data-ttu-id="18069-194">**Figura 7**: Configurar el origen ObjectDataSource que se usarán el `SuppliersBLL` clase s `GetSuppliers` método ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="18069-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-cs/_static/image21.png))</span></span>


<span data-ttu-id="18069-195">Tiene la `Suppliers` DropDownList mostrar el `CompanyName` campo de datos y el uso la `SupplierID` del campo de datos como su `ListItem` s valores.</span><span class="sxs-lookup"><span data-stu-id="18069-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>


<span data-ttu-id="18069-196">[![Mostrar el campo de datos CompanyName y usar SupplierID como valor](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="18069-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span></span>

<span data-ttu-id="18069-197">**Figura 8**: Mostrar el `CompanyName` campo de datos y Use `SupplierID` como el valor ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="18069-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-cs/_static/image24.png))</span></span>


<span data-ttu-id="18069-198">Nombre de la segunda DropDownList `Categories` y enlazarlo a un nuevo origen ObjectDataSource denominado `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="18069-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="18069-199">Configurar la `CategoriesDataSource` ObjectDataSource para usar el `CategoriesBLL` clase s `GetCategories` método; el conjunto de la lista desplegable se enumera en las fichas UPDATE y DELETE en (None) y haga clic en Finalizar para completar el asistente.</span><span class="sxs-lookup"><span data-stu-id="18069-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="18069-200">Por último, tiene la presentación de DropDownList el `CategoryName` campo de datos y use el `CategoryID` como valor.</span><span class="sxs-lookup"><span data-stu-id="18069-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="18069-201">Después de que estos dos DropDownLists han sido agregados y enlazado a ObjectDataSource configurado adecuadamente, la pantalla debe ser similar a la figura 9.</span><span class="sxs-lookup"><span data-stu-id="18069-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>


<span data-ttu-id="18069-202">[![La fila de encabezado contiene ahora los proveedores y categorías DropDownLists](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="18069-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span></span>

<span data-ttu-id="18069-203">**Figura 9**: El encabezado de fila contiene ahora el `Suppliers` y `Categories` DropDownLists ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="18069-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-cs/_static/image27.png))</span></span>


<span data-ttu-id="18069-204">Ahora debemos crear los cuadros de texto para recopilar el nombre y el precio de cada nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="18069-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="18069-205">Arrastre un control de cuadro de texto del cuadro de herramientas hasta el diseñador para cada una de las filas de nombre y el precio del cinco producto.</span><span class="sxs-lookup"><span data-stu-id="18069-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="18069-206">Establecer el `ID` las propiedades de los cuadros de texto a `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="18069-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="18069-207">Agregue un control CompareValidator después de cada uno de los cuadros de texto, establecer el precio por unidad el `ControlToValidate` propiedad correspondientes `ID`.</span><span class="sxs-lookup"><span data-stu-id="18069-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="18069-208">Establezca también la `Operator` propiedad `GreaterThanEqual`, `ValueToCompare` en 0, y `Type` a `Currency`.</span><span class="sxs-lookup"><span data-stu-id="18069-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="18069-209">Estas configuraciones indicar CompareValidator para asegurarse de que el precio, si se especifica, es un valor de moneda válidos que es mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="18069-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="18069-210">Establecer el `Text` propiedad \*, y `ErrorMessage` al precio debe ser mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="18069-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="18069-211">Además, por favor, omita cualquier símbolo de divisa.</span><span class="sxs-lookup"><span data-stu-id="18069-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="18069-212">La interfaz de inserción no incluye los controles RequiredFieldValidator, aunque el `ProductName` campo el `Products` tabla de base de datos no admite `NULL` valores.</span><span class="sxs-lookup"><span data-stu-id="18069-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="18069-213">Esto es porque queremos permitir que el usuario escriba hasta cinco productos.</span><span class="sxs-lookup"><span data-stu-id="18069-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="18069-214">Por ejemplo, si el usuario proporcionar el nombre y la unidad de precio del producto para las tres primeras filas, dejando en blanco, las dos últimas filas d solo agregamos tres nuevos productos en el sistema.</span><span class="sxs-lookup"><span data-stu-id="18069-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="18069-215">Puesto que `ProductName` es necesario, sin embargo, se deberá comprobar mediante programación garantizar que si un precio de venta se especifica que se proporciona un valor de nombre de producto correspondiente.</span><span class="sxs-lookup"><span data-stu-id="18069-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="18069-216">Trataremos esta comprobación en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="18069-216">We'll tackle this check in Step 4.</span></span>


<span data-ttu-id="18069-217">Al validar la entrada del usuario s, CompareValidator notifica datos no válidos si el valor contiene un símbolo de moneda.</span><span class="sxs-lookup"><span data-stu-id="18069-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="18069-218">Agregue un carácter $ delante de cada uno de los cuadros de texto para que actúe como una indicación visual que indica al usuario que omite el símbolo de moneda al entrar en el precio del precio unitario.</span><span class="sxs-lookup"><span data-stu-id="18069-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="18069-219">Por último, agregue un control ValidationSummary dentro de la `InsertingInterface` Panel de configuración de su `ShowMessageBox` propiedad `true` y su `ShowSummary` propiedad `false`.</span><span class="sxs-lookup"><span data-stu-id="18069-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span> <span data-ttu-id="18069-220">Con esta configuración, si el usuario escribe un valor del precio de unidad no válida, aparecerá un asterisco junto a los controles de cuadro de texto incorrectos y el control ValidationSummary mostrará un cuadro de mensajes del lado cliente que se muestra el mensaje de error que se especificó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="18069-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="18069-221">En este momento, la pantalla debe ser similar a la figura 10.</span><span class="sxs-lookup"><span data-stu-id="18069-221">At this point, your screen should look similar to Figure 10.</span></span>


<span data-ttu-id="18069-222">[![La interfaz de inserción incluye ahora los cuadros de texto para los productos de nombres y precios](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="18069-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span></span>

<span data-ttu-id="18069-223">**Figura 10**: La inserción de interfaz ahora incluye cuadros de texto para los nombres de productos y los precios ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="18069-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-cs/_static/image30.png))</span></span>


<span data-ttu-id="18069-224">A continuación, necesitamos agregar agregar productos de botones de envío y de cancelación a la fila de pie de página.</span><span class="sxs-lookup"><span data-stu-id="18069-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="18069-225">Arrastre dos controles de botón en el cuadro de herramientas en el pie de página de la interfaz de inserción, la configuración de los botones `ID` propiedades a `AddProducts` y `CancelButton` y `Text` propiedades para agregar productos de envío y Cancelar, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="18069-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="18069-226">Además, establezca el `CancelButton` control s `CausesValidation` propiedad `false`.</span><span class="sxs-lookup"><span data-stu-id="18069-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="18069-227">Por último, necesitamos agregar un control Web de la etiqueta que se mostrará mensajes de estado de las dos interfaces.</span><span class="sxs-lookup"><span data-stu-id="18069-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="18069-228">Por ejemplo, cuando un usuario agrega correctamente un nuevo envío de productos, queremos volver a la interfaz de presentación y mostrar un mensaje de confirmación.</span><span class="sxs-lookup"><span data-stu-id="18069-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="18069-229">Si, sin embargo, el usuario proporciona un precio para un producto nuevo, pero deja el nombre del producto, es necesario mostrar un mensaje de advertencia desde la `ProductName` campo es obligatorio.</span><span class="sxs-lookup"><span data-stu-id="18069-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="18069-230">Debido a que necesitamos este mensaje para mostrar de ambas interfaces, colóquelo en la parte superior de la página fuera de los paneles.</span><span class="sxs-lookup"><span data-stu-id="18069-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="18069-231">Arrastre un control Web de la etiqueta del cuadro de herramientas a la parte superior de la página en el diseñador.</span><span class="sxs-lookup"><span data-stu-id="18069-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="18069-232">Establecer el `ID` propiedad a `StatusLabel`, desactive out el `Text` propiedad y establezca el `Visible` y `EnableViewState` propiedades a `false`.</span><span class="sxs-lookup"><span data-stu-id="18069-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `false`.</span></span> <span data-ttu-id="18069-233">Como hemos visto en los tutoriales anteriores, establecer el `EnableViewState` propiedad `false` nos permite cambiar los valores de propiedad de etiqueta s mediante programación y tenerlos revertir automáticamente a sus valores predeterminados en el postback subsiguientes.</span><span class="sxs-lookup"><span data-stu-id="18069-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `false` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="18069-234">Esto simplifica el código para mostrar un mensaje de estado en respuesta a alguna acción del usuario que desaparece en el postback subsiguientes.</span><span class="sxs-lookup"><span data-stu-id="18069-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="18069-235">Por último, establezca el `StatusLabel` control s `CssClass` propiedad a la advertencia, que es el nombre de una clase CSS definida en `Styles.css` que muestra texto en una fuente grande, cursiva, negrita y roja.</span><span class="sxs-lookup"><span data-stu-id="18069-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="18069-236">Figura 11 muestra el Diseñador de Visual Studio después de la etiqueta se ha agregado y configurado.</span><span class="sxs-lookup"><span data-stu-id="18069-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>


<span data-ttu-id="18069-237">[![Colocar el Control StatusLabel como encima de los dos controles de Panel](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="18069-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span></span>

<span data-ttu-id="18069-238">**Figura 11**: Colocar el `StatusLabel` Control encima de los dos controles de Panel ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="18069-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-cs/_static/image33.png))</span></span>


## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="18069-239">Paso 3: Cambiar entre la presentación y la inserción de Interfaces</span><span class="sxs-lookup"><span data-stu-id="18069-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="18069-240">En este punto hemos completado el marcado de nuestra presentación y la inserción de interfaces, pero nos re aún quedan dos tareas:</span><span class="sxs-lookup"><span data-stu-id="18069-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="18069-241">Cambiar entre la presentación y la inserción de interfaces</span><span class="sxs-lookup"><span data-stu-id="18069-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="18069-242">Agregar los productos en el envío a la base de datos</span><span class="sxs-lookup"><span data-stu-id="18069-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="18069-243">Actualmente, la interfaz de presentación está visible, pero la interfaz de inserción está oculta.</span><span class="sxs-lookup"><span data-stu-id="18069-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="18069-244">Esto es porque el `DisplayInterface` Panel s `Visible` propiedad está establecida en `true` (el valor predeterminado), mientras que el `InsertingInterface` Panel s `Visible` propiedad está establecida en `false`.</span><span class="sxs-lookup"><span data-stu-id="18069-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `true` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `false`.</span></span> <span data-ttu-id="18069-245">Para cambiar entre las dos interfaces simplemente tenemos que activar o desactivar cada control s `Visible` valor de propiedad.</span><span class="sxs-lookup"><span data-stu-id="18069-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="18069-246">Deseamos mover desde la interfaz de presentación a la interfaz de inserción cuando se hace clic en el botón de envío del producto de proceso.</span><span class="sxs-lookup"><span data-stu-id="18069-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="18069-247">Por lo tanto, crear un controlador de eventos para este botón s `Click` eventos que contiene el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="18069-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample4.cs)]

<span data-ttu-id="18069-248">Este código simplemente oculta el `DisplayInterface` Panel y se muestra en el `InsertingInterface` Panel.</span><span class="sxs-lookup"><span data-stu-id="18069-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="18069-249">A continuación, crear controladores de eventos para agregar productos de envío y el botón Cancelar los controles en la interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="18069-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="18069-250">Cuando se hace clic en cualquiera de estos botones, es necesario volver a la interfaz de presentación.</span><span class="sxs-lookup"><span data-stu-id="18069-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="18069-251">Crear `Click` controladores de eventos para los controles de botón para que llame a `ReturnToDisplayInterface`, un método agregará momentáneamente.</span><span class="sxs-lookup"><span data-stu-id="18069-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="18069-252">Además de ocultar la `InsertingInterface` Panel y mostrar el `DisplayInterface` Panel, el `ReturnToDisplayInterface` método debe devolver los controles Web a su estado de edición previamente.</span><span class="sxs-lookup"><span data-stu-id="18069-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="18069-253">Esto implica el establecimiento de las listas desplegables `SelectedIndex` propiedades en 0 y borrarlos el `Text` propiedades de los controles de cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="18069-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="18069-254">Tenga en cuenta qué puede ocurrir si no devolvemos los controles a su estado previo edición antes de volver a la interfaz de presentación.</span><span class="sxs-lookup"><span data-stu-id="18069-254">Consider what might happen if we didn't return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="18069-255">Un usuario podría haga clic en el botón de envío del producto de proceso, escriba los productos desde el envío y, a continuación, haga clic en Agregar productos de envío.</span><span class="sxs-lookup"><span data-stu-id="18069-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="18069-256">Esto sería agregar los productos y el usuario regresará a la interfaz de presentación.</span><span class="sxs-lookup"><span data-stu-id="18069-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="18069-257">En este momento, el usuario podría desear agregar otro envío.</span><span class="sxs-lookup"><span data-stu-id="18069-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="18069-258">Al hacer clic en el botón de envío del producto de proceso que devolvería la interfaz de inserción, pero la DropDownList selecciones y los valores del cuadro de texto todavía se rellenaría con los valores anteriores.</span><span class="sxs-lookup"><span data-stu-id="18069-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample5.cs)]

<span data-ttu-id="18069-259">Ambos `Click` basta con llamar controladores de eventos el `ReturnToDisplayInterface` método, aunque se tendrá que volver a agregar productos de envío `Click` controlador de eventos en el paso 4 y agregue código para guardar los productos.</span><span class="sxs-lookup"><span data-stu-id="18069-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="18069-260">`ReturnToDisplayInterface` se inicia al devolver el `Suppliers` y `Categories` DropDownLists en sus primeras opciones.</span><span class="sxs-lookup"><span data-stu-id="18069-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="18069-261">Las dos constantes `firstControlID` y `lastControlID` marcar iniciales y finales de los valores de índice de control usados en la nomenclatura el precio de nombre y la unidad de producto en la inserción de cuadros de texto de la interfaz y se usan en los límites de la `for` bucle que establece el `Text`hacer una copia de las propiedades de los controles de cuadro de texto en una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="18069-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `for` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="18069-262">Por último, los paneles `Visible` se restablecen las propiedades para que se oculte la interfaz de inserción y la interfaz de la pantalla mostrada.</span><span class="sxs-lookup"><span data-stu-id="18069-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="18069-263">Dedique un momento para probar esta página en un explorador.</span><span class="sxs-lookup"><span data-stu-id="18069-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="18069-264">Cuando se visita primero la página debería ver la interfaz de presentación como se mostró en la figura 5.</span><span class="sxs-lookup"><span data-stu-id="18069-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="18069-265">Haga clic en el botón de envío del producto de proceso.</span><span class="sxs-lookup"><span data-stu-id="18069-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="18069-266">La página se postback y ahora debería ver la interfaz de inserción tal como se muestra en la figura 12.</span><span class="sxs-lookup"><span data-stu-id="18069-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="18069-267">Al hacer clic en cualquier el agregar productos de botones de envío o en Cancelar, se devuelve a la interfaz de presentación.</span><span class="sxs-lookup"><span data-stu-id="18069-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="18069-268">Durante la visualización de la interfaz de inserción, dedique un momento para probar la CompareValidators en el precio unitario de cuadros de texto.</span><span class="sxs-lookup"><span data-stu-id="18069-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="18069-269">Debería ver un cuadro de mensajes del lado cliente de advertencia al hacer clic en Agregar productos de botón de envío con los valores de moneda no válido o los precios con un valor menor que cero.</span><span class="sxs-lookup"><span data-stu-id="18069-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>


<span data-ttu-id="18069-270">[![Se muestra la interfaz de inserción tras hacer clic en el botón de envío del producto de proceso](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="18069-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span></span>

<span data-ttu-id="18069-271">**Figura 12**: Se muestra la interfaz de inserción tras hacer clic en el botón de envío del producto de proceso ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="18069-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-cs/_static/image36.png))</span></span>


## <a name="step-4-adding-the-products"></a><span data-ttu-id="18069-272">Paso 4: Agregar los productos</span><span class="sxs-lookup"><span data-stu-id="18069-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="18069-273">Todo lo que queda de este tutorial es guardar los productos en la base de datos en los productos de agregar de botón de envío s `Click` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="18069-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="18069-274">Esto puede realizarse mediante la creación de un `ProductsDataTable` y agregando un `ProductsRow` instancia para cada uno de los nombres de producto proporcionados.</span><span class="sxs-lookup"><span data-stu-id="18069-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="18069-275">Una vez que estos `ProductsRow` se han agregado se hará una llamada a la `ProductsBLL` clase s `UpdateWithTransaction` método pasando la `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="18069-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="18069-276">Recuerde que el `UpdateWithTransaction` método, que se creó en el [ajuste modificaciones de base de datos dentro de una transacción](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, pasa el `ProductsDataTable` a la `ProductsTableAdapter` s `UpdateWithTransaction` método.</span><span class="sxs-lookup"><span data-stu-id="18069-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter` s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="18069-277">Desde allí, se inicia una transacción de ADO.NET y los problemas de TableAdapter un `INSERT` instrucción a la base de datos para cada agregado `ProductsRow` en la tabla de datos.</span><span class="sxs-lookup"><span data-stu-id="18069-277">From there, an ADO.NET transaction is started and the TableAdapter issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="18069-278">Suponiendo que se agregan todos los productos sin errores, que se confirma la transacción, en caso contrario se revierte.</span><span class="sxs-lookup"><span data-stu-id="18069-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="18069-279">El código para agregar productos de botón de envío s `Click` controlador de eventos también se necesita realizar un poco de comprobación de errores.</span><span class="sxs-lookup"><span data-stu-id="18069-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="18069-280">Puesto que no hay ningún RequiredFieldValidators utilizado en la interfaz de inserción, un usuario podría escribir un precio para un producto mientras omite su nombre.</span><span class="sxs-lookup"><span data-stu-id="18069-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="18069-281">Puesto que el nombre de producto s es obligatorio, si se desarrolla una condición de ese tipo se debe avisar al usuario y no continuar con las inserciones.</span><span class="sxs-lookup"><span data-stu-id="18069-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="18069-282">La completa `Click` sigue el código del controlador de eventos:</span><span class="sxs-lookup"><span data-stu-id="18069-282">The complete `Click` event handler code follows:</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample6.cs)]

<span data-ttu-id="18069-283">El controlador de eventos se inicia si se asegura que el `Page.IsValid` propiedad devuelve un valor de `true`.</span><span class="sxs-lookup"><span data-stu-id="18069-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `true`.</span></span> <span data-ttu-id="18069-284">Si devuelve `false`, a continuación, eso significa que uno o varios de los CompareValidators notifican datos no válidos; en ese caso no queremos intenta insertar los productos especificados o se terminará con una excepción al intentar asignar el precio unitario escrito por el usuario valor para el `ProductsRow` s `UnitPrice` propiedad.</span><span class="sxs-lookup"><span data-stu-id="18069-284">If it returns `false`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="18069-285">A continuación, un nuevo `ProductsDataTable` se crea la instancia (`products`).</span><span class="sxs-lookup"><span data-stu-id="18069-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="18069-286">Un `for` bucle se usa para iterar por el nombre y la unidad de precio del producto cuadros de texto y el `Text` se leen las propiedades en las variables locales `productName` y `unitPrice`.</span><span class="sxs-lookup"><span data-stu-id="18069-286">A `for` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="18069-287">Si el usuario ha escrito un valor para el precio unitario, pero no para el nombre del producto correspondiente, el `StatusLabel` muestra el mensaje si se proporciona una unidad de precio, también debe incluir el nombre del producto y se sale del controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="18069-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="18069-288">Si se ha proporcionado un nombre de producto, un nuevo `ProductsRow` instancia se crea utilizando el `ProductsDataTable` s `NewProductsRow` método.</span><span class="sxs-lookup"><span data-stu-id="18069-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="18069-289">Esta nueva `ProductsRow` instancia s `ProductName` propiedad está establecida en el producto actual mientras el cuadro de texto Nombre el `SupplierID` y `CategoryID` propiedades se asignan a la `SelectedValue` propiedades de las listas desplegables en el encabezado de la interfaz s insertar.</span><span class="sxs-lookup"><span data-stu-id="18069-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="18069-290">Si el usuario especificó un valor para el precio del producto s, se asigna a la `ProductsRow` instancia s `UnitPrice` propiedad; en caso contrario, es la propiedad izquierda no está asignado, lo que dará como resultado un `NULL` valor para `UnitPrice` en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="18069-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="18069-291">Por último, el `Discontinued` y `UnitsOnOrder` propiedades se asignan a los valores codificados de forma rígida `false` y 0, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="18069-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `false` and 0, respectively.</span></span>

<span data-ttu-id="18069-292">Después de las propiedades se han asignado a la `ProductsRow` instancia se agrega a la `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="18069-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="18069-293">Al finalizar el `for` bucle, comprobamos si se han agregado todos los productos.</span><span class="sxs-lookup"><span data-stu-id="18069-293">At the completion of the `for` loop, we check whether any products have been added.</span></span> <span data-ttu-id="18069-294">El usuario puede, después de todo, ha hecho clic en Agregar productos de envío antes de entrar en los nombres de producto o los precios.</span><span class="sxs-lookup"><span data-stu-id="18069-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="18069-295">Si hay al menos un producto en el `ProductsDataTable`, `ProductsBLL` clase s `UpdateWithTransaction` se llama al método.</span><span class="sxs-lookup"><span data-stu-id="18069-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="18069-296">A continuación, se vuelve a enlazar los datos a la `ProductsGrid` GridView para que los productos recién agregados aparecerá en la interfaz de presentación.</span><span class="sxs-lookup"><span data-stu-id="18069-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="18069-297">El `StatusLabel` se actualiza para mostrar un mensaje de confirmación y la `ReturnToDisplayInterface` se invoca, ocultar la inserción de interfaz y que muestra la interfaz de presentación.</span><span class="sxs-lookup"><span data-stu-id="18069-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="18069-298">Si no hay productos se han especificado, la interfaz de inserción permanece en la pantalla, pero el mensaje que no hay productos se han agregado.</span><span class="sxs-lookup"><span data-stu-id="18069-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="18069-299">Escriba los nombres de producto y los precios de venta en los cuadros de texto se muestra.</span><span class="sxs-lookup"><span data-stu-id="18069-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="18069-300">Figura 13, 14 y 15 muestran la inserción de y mostrar interfaces en acción.</span><span class="sxs-lookup"><span data-stu-id="18069-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="18069-301">En la figura 13, el usuario ha escrito un valor del precio unitario sin un nombre de producto correspondiente.</span><span class="sxs-lookup"><span data-stu-id="18069-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="18069-302">Figura 14 se muestra la interfaz de la pantalla después de tres nuevos productos se han agregado correctamente, mientras que la figura 15 muestra dos de los productos recién agregados en el control GridView (el tercero es en la página anterior).</span><span class="sxs-lookup"><span data-stu-id="18069-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>


<span data-ttu-id="18069-303">[![Un nombre de producto es necesaria al escribir un precio por unidad](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="18069-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span></span>

<span data-ttu-id="18069-304">**Figura 13**: Un nombre de producto es necesaria al escribir un precio por unidad ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="18069-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-cs/_static/image39.png))</span></span>


<span data-ttu-id="18069-305">[![Se han agregado tres verduras nuevo para el proveedor Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="18069-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span></span>

<span data-ttu-id="18069-306">**Figura 14**: Tres nuevos verduras se han agregado para el s proveedor Mayumi ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="18069-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-cs/_static/image42.png))</span></span>


<span data-ttu-id="18069-307">[![Los nuevos productos pueden encontrarse en la última página del control GridView](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="18069-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span></span>

<span data-ttu-id="18069-308">**Figura 15**: Los nuevos productos se encuentran en la última página del control GridView ([haga clic aquí para ver imagen en tamaño completo](batch-inserting-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="18069-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-cs/_static/image45.png))</span></span>


> [!NOTE]
> <span data-ttu-id="18069-309">El lote de inserción de lógica que se usa en este tutorial incluye las inserciones dentro del ámbito de transacción.</span><span class="sxs-lookup"><span data-stu-id="18069-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="18069-310">Para comprobarlo, intencionadamente introducir un error de nivel de base de datos.</span><span class="sxs-lookup"><span data-stu-id="18069-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="18069-311">Por ejemplo, en lugar de asignar la nueva `ProductsRow` instancia s `CategoryID` propiedad al valor seleccionado en el `Categories` DropDownList, asigne un valor como `i * 5`.</span><span class="sxs-lookup"><span data-stu-id="18069-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="18069-312">Aquí `i` es el indizador de bucle y tiene valores comprendidos entre 1 y 5.</span><span class="sxs-lookup"><span data-stu-id="18069-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="18069-313">Por consiguiente, al agregar dos o más productos en lote inserción el primer producto tendrá válido `CategoryID` valor (5), pero con productos posteriores tendrán `CategoryID` valores que no coinciden con hasta `CategoryID` valores en el `Categories` tabla.</span><span class="sxs-lookup"><span data-stu-id="18069-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="18069-314">El efecto neto es que mientras la primera `INSERT` se realizará correctamente, se producirá un error de las posteriores con una infracción de restricción de clave externa.</span><span class="sxs-lookup"><span data-stu-id="18069-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="18069-315">Puesto que la inserción de lote es atómica, la primera `INSERT` se revertirá, devolver la base de datos a su estado antes de que el proceso de insertar el lote se inició.</span><span class="sxs-lookup"><span data-stu-id="18069-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>


## <a name="summary"></a><span data-ttu-id="18069-316">Resumen</span><span class="sxs-lookup"><span data-stu-id="18069-316">Summary</span></span>

<span data-ttu-id="18069-317">Sobre esto y los dos tutoriales anteriores que hemos creado interfaces que permiten actualizar, eliminar, y la inserción de lotes de datos, que usa la compatibilidad de transacciones que agregamos a la capa de acceso a datos en el [modificaciones de base de datos de ajuste dentro de una transacción](wrapping-database-modifications-within-a-transaction-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="18069-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial.</span></span> <span data-ttu-id="18069-318">Para determinados escenarios, estas interfaces de usuario de procesamiento por lotes mejoran considerablemente la eficacia del usuario final mediante la reducción del número de clics, las devoluciones de datos y cambios de contexto de teclado para el mouse, al tiempo que mantiene la integridad de los datos subyacentes.</span><span class="sxs-lookup"><span data-stu-id="18069-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="18069-319">En este tutorial se complete nuestra cómo trabajar con datos por lotes.</span><span class="sxs-lookup"><span data-stu-id="18069-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="18069-320">El siguiente conjunto de tutoriales explora una variedad de escenarios avanzados de capa de acceso a datos, incluido el uso de procedimientos almacenados en los métodos TableAdapter s, configuración de nivel de conexión y comando en la capa DAL, cifrar cadenas de conexión y mucho más!</span><span class="sxs-lookup"><span data-stu-id="18069-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="18069-321">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="18069-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="18069-322">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="18069-322">About the Author</span></span>

<span data-ttu-id="18069-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), trabaja con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="18069-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="18069-324">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="18069-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="18069-325">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="18069-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="18069-326">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="18069-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="18069-327">o a través de su blog, que puede encontrarse en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="18069-327">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="18069-328">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="18069-328">Special Thanks To</span></span>

<span data-ttu-id="18069-329">Esta serie de tutoriales ha sido revisada por muchos revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="18069-329">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="18069-330">Provocar a revisores para este tutorial fueron Hilton Giesenow y S ren Jacob Lauritsen.</span><span class="sxs-lookup"><span data-stu-id="18069-330">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="18069-331">¿Está interesado en leer mi próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="18069-331">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="18069-332">Si es así, envíeme una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="18069-332">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="18069-333">[Anterior](batch-deleting-cs.md)
> [Siguiente](wrapping-database-modifications-within-a-transaction-vb.md)</span><span class="sxs-lookup"><span data-stu-id="18069-333">[Previous](batch-deleting-cs.md)
[Next](wrapping-database-modifications-within-a-transaction-vb.md)</span></span>

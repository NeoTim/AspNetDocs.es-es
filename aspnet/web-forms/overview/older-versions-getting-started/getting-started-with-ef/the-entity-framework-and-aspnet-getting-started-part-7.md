---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
title: Introducción con Entity Framework 4,0 Database First y ASP.NET 4 formularios Web Forms, parte 7 | Microsoft Docs
author: tdykstra
description: En la aplicación Web de ejemplo contoso University se muestra cómo crear aplicaciones de formularios Web Forms de ASP.NET mediante el Entity Framework. La aplicación de ejemplo es...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: f8afb245-b705-419c-8790-0b295e90d5e2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
msc.type: authoredcontent
ms.openlocfilehash: 18d4b44c5e23fd6942c3adf48a33a5602e6df6d0
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78488527"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-7"></a><span data-ttu-id="a0676-104">Introducción con Entity Framework 4,0 Database First y ASP.NET 4 formularios Web Forms, parte 7</span><span class="sxs-lookup"><span data-stu-id="a0676-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 7</span></span>

<span data-ttu-id="a0676-105">por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="a0676-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="a0676-106">En la aplicación Web de ejemplo contoso University se muestra cómo crear aplicaciones de formularios Web Forms de ASP.NET mediante el Entity Framework 4,0 y Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="a0676-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="a0676-107">Para obtener información sobre la serie de tutoriales, consulte [el primer tutorial de la serie](the-entity-framework-and-aspnet-getting-started-part-1.md) .</span><span class="sxs-lookup"><span data-stu-id="a0676-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="using-stored-procedures"></a><span data-ttu-id="a0676-108">Utilizar procedimientos almacenados</span><span class="sxs-lookup"><span data-stu-id="a0676-108">Using Stored Procedures</span></span>

<span data-ttu-id="a0676-109">En el tutorial anterior, implementó un patrón de herencia de tabla por jerarquía.</span><span class="sxs-lookup"><span data-stu-id="a0676-109">In the previous tutorial you implemented a table-per-hierarchy inheritance pattern.</span></span> <span data-ttu-id="a0676-110">En este tutorial se muestra cómo usar procedimientos almacenados para obtener más control sobre el acceso a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a0676-110">This tutorial will show you how to use stored procedures to gain more control over database access.</span></span>

<span data-ttu-id="a0676-111">El Entity Framework le permite especificar que debe utilizar procedimientos almacenados para el acceso a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a0676-111">The Entity Framework lets you specify that it should use stored procedures for database access.</span></span> <span data-ttu-id="a0676-112">Para cualquier tipo de entidad, puede especificar un procedimiento almacenado que se utilizará para crear, actualizar o eliminar entidades de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="a0676-112">For any entity type, you can specify a stored procedure to use for creating, updating, or deleting entities of that type.</span></span> <span data-ttu-id="a0676-113">Después, en el modelo de datos, puede Agregar referencias a los procedimientos almacenados que puede usar para realizar tareas como la recuperación de conjuntos de entidades.</span><span class="sxs-lookup"><span data-stu-id="a0676-113">Then in the data model you can add references to stored procedures that you can use to perform tasks such as retrieving sets of entities.</span></span>

<span data-ttu-id="a0676-114">El uso de procedimientos almacenados es un requisito común para el acceso a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a0676-114">Using stored procedures is a common requirement for database access.</span></span> <span data-ttu-id="a0676-115">En algunos casos, es posible que un administrador de bases de datos requiera que todo el acceso a la base de datos pase por procedimientos almacenados por motivos de seguridad.</span><span class="sxs-lookup"><span data-stu-id="a0676-115">In some cases a database administrator may require that all database access go through stored procedures for security reasons.</span></span> <span data-ttu-id="a0676-116">En otros casos, puede que desee crear lógica de negocios en algunos de los procesos que utiliza el Entity Framework al actualizar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a0676-116">In other cases you may want to build business logic into some of the processes that the Entity Framework uses when it updates the database.</span></span> <span data-ttu-id="a0676-117">Por ejemplo, cada vez que se elimina una entidad, puede que desee copiarla en una base de datos de archivo.</span><span class="sxs-lookup"><span data-stu-id="a0676-117">For example, whenever an entity is deleted you might want to copy it to an archive database.</span></span> <span data-ttu-id="a0676-118">O, cada vez que se actualiza una fila, es posible que desee escribir una fila en una tabla de registro que registre quién realizó el cambio.</span><span class="sxs-lookup"><span data-stu-id="a0676-118">Or whenever a row is updated you might want to write a row to a logging table that records who made the change.</span></span> <span data-ttu-id="a0676-119">Puede realizar estos tipos de tareas en un procedimiento almacenado al que se llama cada vez que el Entity Framework elimina una entidad o actualiza una entidad.</span><span class="sxs-lookup"><span data-stu-id="a0676-119">You can perform these kinds of tasks in a stored procedure that's called whenever the Entity Framework deletes an entity or updates an entity.</span></span>

<span data-ttu-id="a0676-120">Como en el tutorial anterior, no se crearán páginas nuevas.</span><span class="sxs-lookup"><span data-stu-id="a0676-120">As in the previous tutorial, you'll not create any new pages.</span></span> <span data-ttu-id="a0676-121">En su lugar, cambiará la forma en que el Entity Framework tiene acceso a la base de datos para algunas de las páginas que ya ha creado.</span><span class="sxs-lookup"><span data-stu-id="a0676-121">Instead, you'll change the way the Entity Framework accesses the database for some of the pages you already created.</span></span>

<span data-ttu-id="a0676-122">En este tutorial, creará procedimientos almacenados en la base de datos para insertar entidades `Student` y `Instructor`.</span><span class="sxs-lookup"><span data-stu-id="a0676-122">In this tutorial you'll create stored procedures in the database for inserting `Student` and `Instructor` entities.</span></span> <span data-ttu-id="a0676-123">Los agregará al modelo de datos y especificará que los Entity Framework deberían utilizarlos para agregar `Student` y `Instructor` entidades a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a0676-123">You'll add them to the data model, and you'll specify that the Entity Framework should use them for adding `Student` and `Instructor` entities to the database.</span></span> <span data-ttu-id="a0676-124">También creará un procedimiento almacenado que puede usar para recuperar entidades `Course`.</span><span class="sxs-lookup"><span data-stu-id="a0676-124">You'll also create a stored procedure that you can use to retrieve `Course` entities.</span></span>

## <a name="creating-stored-procedures-in-the-database"></a><span data-ttu-id="a0676-125">Crear procedimientos almacenados en la base de datos</span><span class="sxs-lookup"><span data-stu-id="a0676-125">Creating Stored Procedures in the Database</span></span>

<span data-ttu-id="a0676-126">(Si utiliza el archivo *School. MDF* del proyecto disponible para su descarga con este tutorial, puede omitir esta sección porque los procedimientos almacenados ya existen).</span><span class="sxs-lookup"><span data-stu-id="a0676-126">(If you're using the *School.mdf* file from the project available for download with this tutorial, you can skip this section because the stored procedures already exist.)</span></span>

<span data-ttu-id="a0676-127">En **Explorador de servidores**, expanda *School. MDF*, haga clic con el botón secundario en **procedimientos almacenados**y seleccione **Agregar nuevo procedimiento almacenado**.</span><span class="sxs-lookup"><span data-stu-id="a0676-127">In **Server Explorer**, expand *School.mdf*, right-click **Stored Procedures**, and select **Add New Stored Procedure**.</span></span>

<span data-ttu-id="a0676-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span></span>

<span data-ttu-id="a0676-129">Copie las siguientes instrucciones SQL y péguelas en la ventana procedimiento almacenado, reemplazando el procedimiento almacenado esqueleto.</span><span class="sxs-lookup"><span data-stu-id="a0676-129">Copy the following SQL statements and paste them into the stored procedure window, replacing the skeleton stored procedure.</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample1.sql)]

<span data-ttu-id="a0676-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span></span>

<span data-ttu-id="a0676-131">`Student` entidades tienen cuatro propiedades: `PersonID`, `LastName`, `FirstName`y `EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="a0676-131">`Student` entities have four properties: `PersonID`, `LastName`, `FirstName`, and `EnrollmentDate`.</span></span> <span data-ttu-id="a0676-132">La base de datos genera automáticamente el valor de identificador y el procedimiento almacenado acepta parámetros para los otros tres.</span><span class="sxs-lookup"><span data-stu-id="a0676-132">The database generates the ID value automatically, and the stored procedure accepts parameters for the other three.</span></span> <span data-ttu-id="a0676-133">El procedimiento almacenado devuelve el valor de la clave de registro de la nueva fila para que el Entity Framework pueda realizar un seguimiento de la versión de la entidad que mantiene en la memoria.</span><span class="sxs-lookup"><span data-stu-id="a0676-133">The stored procedure returns the value of the new row's record key so that the Entity Framework can keep track of that in the version of the entity it keeps in memory.</span></span>

<span data-ttu-id="a0676-134">Guarde y cierre la ventana del procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="a0676-134">Save and close the stored procedure window.</span></span>

<span data-ttu-id="a0676-135">Cree un `InsertInstructor` procedimiento almacenado de la misma manera, mediante las siguientes instrucciones SQL:</span><span class="sxs-lookup"><span data-stu-id="a0676-135">Create an `InsertInstructor` stored procedure in the same manner, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample2.sql)]

<span data-ttu-id="a0676-136">Cree también `Update` procedimientos almacenados para las entidades `Student` y `Instructor`.</span><span class="sxs-lookup"><span data-stu-id="a0676-136">Create `Update` stored procedures for `Student` and `Instructor` entities also.</span></span> <span data-ttu-id="a0676-137">(La base de datos ya tiene un procedimiento almacenado `DeletePerson` que funcionará para las entidades `Instructor` y `Student`).</span><span class="sxs-lookup"><span data-stu-id="a0676-137">(The database already has a `DeletePerson` stored procedure which will work for both `Instructor` and `Student` entities.)</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample3.sql)]

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample4.sql)]

<span data-ttu-id="a0676-138">En este tutorial, asignará las tres funciones, INSERT, Update y DELETE, para cada tipo de entidad.</span><span class="sxs-lookup"><span data-stu-id="a0676-138">In this tutorial you'll map all three functions -- insert, update, and delete -- for each entity type.</span></span> <span data-ttu-id="a0676-139">La Entity Framework versión 4 le permite asignar solo una o dos de estas funciones a procedimientos almacenados sin asignar las demás, con una excepción: Si asigna la función de actualización pero no la función de eliminación, el Entity Framework producirá una excepción cuando intento de eliminar una entidad.</span><span class="sxs-lookup"><span data-stu-id="a0676-139">The Entity Framework version 4 allows you to map just one or two of these functions to stored procedures without mapping the others, with one exception: if you map the update function but not the delete function, the Entity Framework will throw an exception when you attempt to delete an entity.</span></span> <span data-ttu-id="a0676-140">En la versión 3,5 de Entity Framework, no tenía esta gran flexibilidad en la asignación de procedimientos almacenados: Si asigna una función, era necesario asignar los tres.</span><span class="sxs-lookup"><span data-stu-id="a0676-140">In the Entity Framework version 3.5, you did not have this much flexibility in mapping stored procedures: if you mapped one function you were required to map all three.</span></span>

<span data-ttu-id="a0676-141">Para crear un procedimiento almacenado que lea en lugar de los datos de actualizaciones, cree uno que seleccione todas `Course` entidades, mediante las siguientes instrucciones SQL:</span><span class="sxs-lookup"><span data-stu-id="a0676-141">To create a stored procedure that reads rather than updates data, create one that selects all `Course` entities, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample5.sql)]

## <a name="adding-the-stored-procedures-to-the-data-model"></a><span data-ttu-id="a0676-142">Agregar los procedimientos almacenados al modelo de datos</span><span class="sxs-lookup"><span data-stu-id="a0676-142">Adding the Stored Procedures to the Data Model</span></span>

<span data-ttu-id="a0676-143">Ahora, los procedimientos almacenados se definen en la base de datos, pero se deben agregar al modelo de datos para que estén disponibles para el Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="a0676-143">The stored procedures are now defined in the database, but they must be added to the data model to make them available to the Entity Framework.</span></span> <span data-ttu-id="a0676-144">Abra *SchoolModel. edmx*, haga clic con el botón secundario en la superficie de diseño y seleccione **Actualizar modelo desde base de datos**.</span><span class="sxs-lookup"><span data-stu-id="a0676-144">Open *SchoolModel.edmx*, right-click the design surface, and select **Update Model from Database**.</span></span> <span data-ttu-id="a0676-145">En la pestaña **Agregar** del cuadro de diálogo **Elija los objetos de base de datos** , expanda **procedimientos almacenados**, seleccione los procedimientos almacenados recién creados y el `DeletePerson` procedimiento almacenado y, a continuación, haga clic en **Finalizar**.</span><span class="sxs-lookup"><span data-stu-id="a0676-145">In the **Add** tab of the **Choose Your Database Objects** dialog box, expand **Stored Procedures**, select the newly created stored procedures and the `DeletePerson` stored procedure, and then click **Finish**.</span></span>

<span data-ttu-id="a0676-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span></span>

## <a name="mapping-the-stored-procedures"></a><span data-ttu-id="a0676-147">Asignar los procedimientos almacenados</span><span class="sxs-lookup"><span data-stu-id="a0676-147">Mapping the Stored Procedures</span></span>

<span data-ttu-id="a0676-148">En el diseñador de modelos de datos, haga clic con el botón secundario en la entidad `Student` y seleccione **asignación de procedimiento almacenado**.</span><span class="sxs-lookup"><span data-stu-id="a0676-148">In the data model designer, right-click the `Student` entity and select **Stored Procedure Mapping**.</span></span>

<span data-ttu-id="a0676-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span></span>

<span data-ttu-id="a0676-150">Aparece la ventana detalles de la **asignación** , en la que puede especificar procedimientos almacenados que el Entity Framework debe usar para insertar, actualizar y eliminar entidades de este tipo.</span><span class="sxs-lookup"><span data-stu-id="a0676-150">The **Mapping Details** window appears, in which you can specify stored procedures that the Entity Framework should use for inserting, updating, and deleting entities of this type.</span></span>

<span data-ttu-id="a0676-151">[![Image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span></span>

<span data-ttu-id="a0676-152">Establezca la función **Insert** en **InsertStudent**.</span><span class="sxs-lookup"><span data-stu-id="a0676-152">Set the **Insert** function to **InsertStudent**.</span></span> <span data-ttu-id="a0676-153">En la ventana se muestra una lista de parámetros de procedimientos almacenados, cada uno de los cuales debe estar asignado a una propiedad de entidad.</span><span class="sxs-lookup"><span data-stu-id="a0676-153">The window shows a list of stored procedure parameters, each of which must be mapped to an entity property.</span></span> <span data-ttu-id="a0676-154">Dos de estos se asignan automáticamente porque los nombres son los mismos.</span><span class="sxs-lookup"><span data-stu-id="a0676-154">Two of these are mapped automatically because the names are the same.</span></span> <span data-ttu-id="a0676-155">No hay ninguna propiedad de entidad denominada `FirstName`, por lo que debe seleccionar manualmente `FirstMidName` en una lista desplegable que muestra las propiedades de la entidad disponibles.</span><span class="sxs-lookup"><span data-stu-id="a0676-155">There's no entity property named `FirstName`, so you must manually select `FirstMidName` from a drop-down list that shows available entity properties.</span></span> <span data-ttu-id="a0676-156">(Esto se debe a que ha cambiado el nombre de la propiedad `FirstName` por `FirstMidName` en el primer tutorial).</span><span class="sxs-lookup"><span data-stu-id="a0676-156">(This is because you changed the name of the `FirstName` property to `FirstMidName` in the first tutorial.)</span></span>

<span data-ttu-id="a0676-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span></span>

<span data-ttu-id="a0676-158">En la misma ventana detalles de la **asignación** , asigne la función `Update` al procedimiento almacenado `UpdateStudent` (Asegúrese de especificar `FirstMidName` como el valor del parámetro para `FirstName`, como hizo con el `Insert` procedimiento almacenado) y la función `Delete` en el procedimiento almacenado `DeletePerson`.</span><span class="sxs-lookup"><span data-stu-id="a0676-158">In the same **Mapping Details** window, map the `Update` function to the `UpdateStudent` stored procedure (make sure you specify `FirstMidName` as the parameter value for `FirstName`, as you did for the `Insert` stored procedure) and the `Delete` function to the `DeletePerson` stored procedure.</span></span>

<span data-ttu-id="a0676-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span></span>

<span data-ttu-id="a0676-160">Siga el mismo procedimiento para asignar los procedimientos almacenados de inserción, actualización y eliminación para los instructores a la entidad `Instructor`.</span><span class="sxs-lookup"><span data-stu-id="a0676-160">Follow the same procedure to map the insert, update, and delete stored procedures for instructors to the `Instructor` entity.</span></span>

<span data-ttu-id="a0676-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span></span>

<span data-ttu-id="a0676-162">En el caso de los procedimientos almacenados que leen en lugar de actualizar datos, se usa la ventana **Explorador de modelos** para asignar el procedimiento almacenado al tipo de entidad que devuelve.</span><span class="sxs-lookup"><span data-stu-id="a0676-162">For stored procedures that read rather than update data, you use the **Model Browser** window to map the stored procedure to the entity type it returns.</span></span> <span data-ttu-id="a0676-163">En el diseñador de modelos de datos, haga clic con el botón secundario en la superficie de diseño y seleccione **Explorador de modelos**.</span><span class="sxs-lookup"><span data-stu-id="a0676-163">In the data model designer, right-click the design surface and select **Model Browser**.</span></span> <span data-ttu-id="a0676-164">Abra el nodo **SchoolModel. Store** y, a continuación, abra el nodo **procedimientos almacenados** .</span><span class="sxs-lookup"><span data-stu-id="a0676-164">Open the **SchoolModel.Store** node and then open the **Stored Procedures** node.</span></span> <span data-ttu-id="a0676-165">A continuación, haga clic con el botón secundario en el `GetCourses` procedimiento almacenado y seleccione **Agregar importación de función**.</span><span class="sxs-lookup"><span data-stu-id="a0676-165">Then right-click the `GetCourses` stored procedure and select **Add Function Import**.</span></span>

<span data-ttu-id="a0676-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span></span>

<span data-ttu-id="a0676-167">En el cuadro de diálogo **Agregar importación de función** , en **devuelve una colección de** **entidades**seleccionadas y, a continuación, seleccione `Course` como el tipo de entidad devuelto.</span><span class="sxs-lookup"><span data-stu-id="a0676-167">In the **Add Function Import** dialog box, under **Returns a Collection Of** select **Entities**, and then select `Course` as the entity type returned.</span></span> <span data-ttu-id="a0676-168">Cuando haya terminado, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="a0676-168">When you're done, click **OK**.</span></span> <span data-ttu-id="a0676-169">Guarde y cierre el archivo *. edmx* .</span><span class="sxs-lookup"><span data-stu-id="a0676-169">Save and close the *.edmx* file.</span></span>

<span data-ttu-id="a0676-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span></span>

## <a name="using-insert-update-and-delete-stored-procedures"></a><span data-ttu-id="a0676-171">Usar procedimientos almacenados INSERT, Update y DELETE</span><span class="sxs-lookup"><span data-stu-id="a0676-171">Using Insert, Update, and Delete Stored Procedures</span></span>

<span data-ttu-id="a0676-172">Los procedimientos almacenados para insertar, actualizar y eliminar datos los utiliza el Entity Framework automáticamente después de agregarlos al modelo de datos y asignarlos a las entidades adecuadas.</span><span class="sxs-lookup"><span data-stu-id="a0676-172">Stored procedures to insert, update, and delete data are used by the Entity Framework automatically after you've added them to the data model and mapped them to the appropriate entities.</span></span> <span data-ttu-id="a0676-173">Ahora puede ejecutar la página *StudentsAdd. aspx* y cada vez que cree un estudiante nuevo, el Entity Framework utilizará el `InsertStudent` procedimiento almacenado para agregar la nueva fila a la tabla de `Student`.</span><span class="sxs-lookup"><span data-stu-id="a0676-173">You can now run the *StudentsAdd.aspx* page, and every time you create a new student, the Entity Framework will use the `InsertStudent` stored procedure to add the new row to the `Student` table.</span></span>

<span data-ttu-id="a0676-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span></span>

<span data-ttu-id="a0676-175">Ejecute la página Students *. aspx* y el nuevo estudiante aparecerá en la lista.</span><span class="sxs-lookup"><span data-stu-id="a0676-175">Run the *Students.aspx* page and the new student appears in the list.</span></span>

<span data-ttu-id="a0676-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span></span>

<span data-ttu-id="a0676-177">Cambie el nombre para comprobar que la función de actualización funciona y, a continuación, elimine el estudiante para comprobar que funciona la función de eliminación.</span><span class="sxs-lookup"><span data-stu-id="a0676-177">Change the name to verify that the update function works, and then delete the student to verify that the delete function works.</span></span>

<span data-ttu-id="a0676-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="a0676-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span></span>

## <a name="using-select-stored-procedures"></a><span data-ttu-id="a0676-179">Usar procedimientos almacenados Select</span><span class="sxs-lookup"><span data-stu-id="a0676-179">Using Select Stored Procedures</span></span>

<span data-ttu-id="a0676-180">El Entity Framework no ejecuta automáticamente procedimientos almacenados como `GetCourses`y no se pueden usar con el control `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="a0676-180">The Entity Framework does not automatically run stored procedures such as `GetCourses`, and you cannot use them with the `EntityDataSource` control.</span></span> <span data-ttu-id="a0676-181">Para usarlos, se les llama desde el código.</span><span class="sxs-lookup"><span data-stu-id="a0676-181">To use them, you call them from code.</span></span>

<span data-ttu-id="a0676-182">Abra el archivo *InstructorsCourses.aspx.CS* .</span><span class="sxs-lookup"><span data-stu-id="a0676-182">Open the *InstructorsCourses.aspx.cs* file.</span></span> <span data-ttu-id="a0676-183">El método `PopulateDropDownLists` usa una consulta LINQ to Entities para recuperar todas las entidades Course para que pueda recorrer en bucle la lista y determinar a qué se asigna un instructor y cuáles están sin asignar:</span><span class="sxs-lookup"><span data-stu-id="a0676-183">The `PopulateDropDownLists` method uses a LINQ-to-Entities query to retrieve all course entities so that it can loop through the list and determine which ones an instructor is assigned to and which ones are unassigned:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample6.cs)]

<span data-ttu-id="a0676-184">Reemplácelo por el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="a0676-184">Replace this with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample7.cs)]

<span data-ttu-id="a0676-185">La página ahora usa el `GetCourses` procedimiento almacenado para recuperar la lista de todos los cursos.</span><span class="sxs-lookup"><span data-stu-id="a0676-185">The page now uses the `GetCourses` stored procedure to retrieve the list of all courses.</span></span> <span data-ttu-id="a0676-186">Ejecute la página para comprobar que funciona como antes.</span><span class="sxs-lookup"><span data-stu-id="a0676-186">Run the page to verify that it works as it did before.</span></span>

<span data-ttu-id="a0676-187">(Es posible que las propiedades de navegación de las entidades recuperadas por un procedimiento almacenado no se rellenen automáticamente con los datos relacionados con dichas entidades, en función de la configuración predeterminada de `ObjectContext`.</span><span class="sxs-lookup"><span data-stu-id="a0676-187">(Navigation properties of entities retrieved by a stored procedure might not be automatically populated with the data related to those entities, depending on `ObjectContext` default settings.</span></span> <span data-ttu-id="a0676-188">Para obtener más información, vea [cargar objetos relacionados](https://msdn.microsoft.com/library/bb896272.aspx) en MSDN Library).</span><span class="sxs-lookup"><span data-stu-id="a0676-188">For more information, see [Loading Related Objects](https://msdn.microsoft.com/library/bb896272.aspx) in the MSDN Library.)</span></span>

<span data-ttu-id="a0676-189">En el siguiente tutorial, aprenderá a usar la funcionalidad de datos dinámicos para que sea más fácil programar y probar reglas de validación y formato de datos.</span><span class="sxs-lookup"><span data-stu-id="a0676-189">In the next tutorial, you'll learn how to use Dynamic Data functionality to make it easier to program and test data formatting and validation rules.</span></span> <span data-ttu-id="a0676-190">En lugar de especificar en cada una de las reglas de página web como cadenas de formato de datos y si se requiere o no un campo, puede especificar dichas reglas en los metadatos del modelo de datos y se aplican automáticamente en todas las páginas.</span><span class="sxs-lookup"><span data-stu-id="a0676-190">Instead of specifying on each web page rules such as data format strings and whether or not a field is required, you can specify such rules in data model metadata and they're automatically applied on every page.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a0676-191">[Anterior](the-entity-framework-and-aspnet-getting-started-part-6.md)
> [Siguiente](the-entity-framework-and-aspnet-getting-started-part-8.md)</span><span class="sxs-lookup"><span data-stu-id="a0676-191">[Previous](the-entity-framework-and-aspnet-getting-started-part-6.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-8.md)</span></span>

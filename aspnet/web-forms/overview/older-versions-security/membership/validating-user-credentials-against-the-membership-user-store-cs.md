---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
title: Validar las credenciales de usuario en el almacén de usuarios de pertenencia (C#) | Microsoft Docs
author: rick-anderson
description: En este tutorial, veremos cómo validar las credenciales de un usuario en el almacén de usuarios de pertenencia mediante los medios de programación y el control de inicio de sesión....
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 61aa4e08-aa81-4aeb-8ebe-19ba7a65e04c
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
msc.type: authoredcontent
ms.openlocfilehash: fd50f4e63c75cf77eb21629d0c11a859da6b357d
ms.sourcegitcommit: 4e6d586faadbe4d9ef27122f86335ec9385134af
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/28/2020
ms.locfileid: "89045239"
---
# <a name="validating-user-credentials-against-the-membership-user-store-c"></a><span data-ttu-id="06c9a-103">Validar las credenciales de usuario en el almacén de usuarios de pertenencia (C#)</span><span class="sxs-lookup"><span data-stu-id="06c9a-103">Validating User Credentials Against the Membership User Store (C#)</span></span>

<span data-ttu-id="06c9a-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="06c9a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="06c9a-105">[Descargar código](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip) o [Descargar PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="06c9a-105">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span></span>

> <span data-ttu-id="06c9a-106">En este tutorial, examinaremos cómo validar las credenciales de un usuario en el almacén de usuarios de pertenencia mediante el uso de los medios de programación y el control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="06c9a-107">También veremos cómo personalizar la apariencia y el comportamiento del control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-107">We will also look at how to customize the login control's appearance and behavior.</span></span>

## <a name="introduction"></a><span data-ttu-id="06c9a-108">Introducción</span><span class="sxs-lookup"><span data-stu-id="06c9a-108">Introduction</span></span>

<span data-ttu-id="06c9a-109">En el <a id="Tutorial05"></a> [tutorial anterior](creating-user-accounts-cs.md) , hemos visto cómo crear una nueva cuenta de usuario en el marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="06c9a-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-cs.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="06c9a-110">En primer lugar, hemos examinado la creación de cuentas de usuario mediante programación a través del `Membership` método de la clase `CreateUser` y, a continuación, hemos examinado mediante el control Web CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="06c9a-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="06c9a-111">Sin embargo, la página de inicio de sesión valida actualmente las credenciales proporcionadas en una lista codificada de forma rígida de pares de nombre de usuario y contraseña.</span><span class="sxs-lookup"><span data-stu-id="06c9a-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="06c9a-112">Necesitamos actualizar la lógica de la página de inicio de sesión para validar las credenciales en el almacén de usuario del marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="06c9a-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="06c9a-113">De forma muy parecida a la creación de cuentas de usuario, las credenciales se pueden validar mediante programación o mediante declaración.</span><span class="sxs-lookup"><span data-stu-id="06c9a-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="06c9a-114">La API de pertenencia incluye un método para validar mediante programación las credenciales de un usuario con el almacén del usuario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="06c9a-115">Y ASP.NET se distribuyen con el control Web de inicio de sesión, que representa una interfaz de usuario con cuadros de texto para el nombre de usuario y la contraseña, y un botón para iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="06c9a-116">En este tutorial, examinaremos cómo validar las credenciales de un usuario en el almacén de usuarios de pertenencia mediante el uso de los medios de programación y el control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="06c9a-117">También veremos cómo personalizar la apariencia y el comportamiento del control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="06c9a-118">Comencemos.</span><span class="sxs-lookup"><span data-stu-id="06c9a-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="06c9a-119">Paso 1: validación de credenciales en el almacén de usuarios de pertenencia</span><span class="sxs-lookup"><span data-stu-id="06c9a-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="06c9a-120">En el caso de los sitios web que usan la autenticación de formularios, un usuario inicia sesión en el sitio Web visitando una página de inicio de sesión y especifica sus credenciales.</span><span class="sxs-lookup"><span data-stu-id="06c9a-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="06c9a-121">Después, estas credenciales se comparan con el almacén del usuario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="06c9a-122">Si son válidos, se concede al usuario un vale de autenticación de formularios, que es un token de seguridad que indica la identidad y la autenticidad del visitante.</span><span class="sxs-lookup"><span data-stu-id="06c9a-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="06c9a-123">Para validar un usuario con el marco de pertenencia, use el `Membership` [ `ValidateUser` método](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx)de la clase.</span><span class="sxs-lookup"><span data-stu-id="06c9a-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="06c9a-124">El `ValidateUser` método toma dos parámetros de entrada *`username`* y *`password`* devuelve un valor booleano que indica si las credenciales son válidas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-124">The `ValidateUser` method takes in two input parameters - *`username`* and *`password`* - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="06c9a-125">Al igual que con el `CreateUser` método que examinamos en el tutorial anterior, el `ValidateUser` método delega la validación real en el proveedor de pertenencia configurado.</span><span class="sxs-lookup"><span data-stu-id="06c9a-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="06c9a-126">`SqlMembershipProvider`Valida las credenciales proporcionadas obteniendo la contraseña del usuario especificado mediante el `aspnet_Membership_GetPasswordWithFormat` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="06c9a-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="06c9a-127">Recuerde que el `SqlMembershipProvider` almacena las contraseñas de los usuarios con uno de estos tres formatos: Clear, encrypted o Hashed.</span><span class="sxs-lookup"><span data-stu-id="06c9a-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="06c9a-128">El `aspnet_Membership_GetPasswordWithFormat` procedimiento almacenado devuelve la contraseña en su formato sin procesar.</span><span class="sxs-lookup"><span data-stu-id="06c9a-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="06c9a-129">En el caso de las contraseñas cifradas o con hash, el `SqlMembershipProvider` transforma el *`password`* valor pasado al `ValidateUser` método en su estado cifrado o hash equivalente y, a continuación, lo compara con lo que se devolvió en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="06c9a-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the *`password`* value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="06c9a-130">Si la contraseña almacenada en la base de datos coincide con la especificada por el usuario, las credenciales son válidas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="06c9a-131">Vamos a actualizar la página de inicio de sesión (~/ `Login.aspx` ) para que valide las credenciales proporcionadas en el almacén de usuario del marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="06c9a-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="06c9a-132">Esta página de inicio de sesión se creó de nuevo en el tutorial Introducción a la <a id="Tutorial02"></a> [*autenticación de formularios*](../introduction/an-overview-of-forms-authentication-cs.md) , creación de una interfaz con dos cuadros de texto para el nombre de usuario y contraseña, una casilla recordarme y un botón de inicio de sesión (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="06c9a-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="06c9a-133">El código valida las credenciales especificadas en una lista codificada de forma rígida de pares de nombre de usuario y contraseña (Scott/contraseña, Jisun/contraseña y Sam/contraseña).</span><span class="sxs-lookup"><span data-stu-id="06c9a-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="06c9a-134">En el <a id="Tutorial03"></a> tutorial configuración de la [*autenticación de formularios y temas avanzados*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) , hemos actualizado el código de la página de inicio de sesión para almacenar información adicional en la propiedad del vale de autenticación de formularios `UserData` .</span><span class="sxs-lookup"><span data-stu-id="06c9a-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>

<span data-ttu-id="06c9a-135">[![La interfaz de la página de inicio de sesión incluye dos cuadros de texto, un CheckBoxList y un botón](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span></span>

<span data-ttu-id="06c9a-136">**Figura 1**: la interfaz de la página de inicio de sesión incluye dos cuadros de texto, un CheckBoxList y un botón ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png))</span></span>

<span data-ttu-id="06c9a-137">La interfaz de usuario de la página de inicio de sesión puede permanecer sin cambios, pero es necesario reemplazar el controlador de eventos del botón de inicio de sesión `Click` por código que valida al usuario en el almacén de usuario del marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="06c9a-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="06c9a-138">Actualice el controlador de eventos para que el código aparezca como sigue:</span><span class="sxs-lookup"><span data-stu-id="06c9a-138">Update the event handler so that its code appears as follows:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample1.cs)]

<span data-ttu-id="06c9a-139">Este código es muy sencillo.</span><span class="sxs-lookup"><span data-stu-id="06c9a-139">This code is remarkably simple.</span></span> <span data-ttu-id="06c9a-140">Comencemos llamando al `Membership.ValidateUser` método, pasando el nombre de usuario y la contraseña proporcionados.</span><span class="sxs-lookup"><span data-stu-id="06c9a-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="06c9a-141">Si ese método devuelve true, el usuario inicia sesión en el sitio mediante el `FormsAuthentication` método RedirectFromLoginPage de la clase.</span><span class="sxs-lookup"><span data-stu-id="06c9a-141">If that method returns true, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="06c9a-142">(Como se explicó en el <a id="Tutorial2"></a> [*Una introducción al tutorial de autenticación de formularios*](../introduction/an-overview-of-forms-authentication-cs.md) , `FormsAuthentication.RedirectFromLoginPage` crea el vale de autenticación de formularios y, a continuación, redirige al usuario a la página correspondiente. Sin embargo, si las credenciales no son válidas, `InvalidCredentialsMessage` se muestra la etiqueta, lo que informa al usuario de que su nombre de usuario o contraseña eran incorrectos.</span><span class="sxs-lookup"><span data-stu-id="06c9a-142">(As we discussed in the <a id="Tutorial2"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="06c9a-143">Así de simple.</span><span class="sxs-lookup"><span data-stu-id="06c9a-143">That's all there is to it!</span></span>

<span data-ttu-id="06c9a-144">Para comprobar que la página de inicio de sesión funciona según lo previsto, intente iniciar sesión con una de las cuentas de usuario que creó en el tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="06c9a-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="06c9a-145">O bien, si aún no ha creado una cuenta, continúe y cree una en la `~/Membership/CreatingUserAccounts.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="06c9a-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="06c9a-146">Cuando el usuario escribe sus credenciales y envía el formulario de la página de inicio de sesión, las credenciales, incluida su contraseña, se transmiten a través de Internet al servidor Web en *texto sin formato*.</span><span class="sxs-lookup"><span data-stu-id="06c9a-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="06c9a-147">Esto significa que cualquier pirata informático que examine el tráfico de red puede ver el nombre de usuario y la contraseña.</span><span class="sxs-lookup"><span data-stu-id="06c9a-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="06c9a-148">Para evitar esto, es esencial cifrar el tráfico de red mediante el uso de [capas de sockets seguros (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span><span class="sxs-lookup"><span data-stu-id="06c9a-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="06c9a-149">Esto garantizará que las credenciales (así como el marcado HTML de la página completa) se cifren desde el momento en que salen del explorador hasta que las reciba el servidor Web.</span><span class="sxs-lookup"><span data-stu-id="06c9a-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>

### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="06c9a-150">Cómo controla el marco de pertenencia los intentos de inicio de sesión no válidos</span><span class="sxs-lookup"><span data-stu-id="06c9a-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="06c9a-151">Cuando un visitante llega a la página de inicio de sesión y envía sus credenciales, el explorador realiza una solicitud HTTP a la página de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="06c9a-152">Si las credenciales son válidas, la respuesta HTTP incluye el vale de autenticación en una cookie.</span><span class="sxs-lookup"><span data-stu-id="06c9a-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="06c9a-153">Por lo tanto, un pirata informático que intente interrumpir su sitio podría crear un programa que envíe de forma exhaustiva las solicitudes HTTP a la página de inicio de sesión con un nombre de usuario válido y una estimación en la contraseña.</span><span class="sxs-lookup"><span data-stu-id="06c9a-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="06c9a-154">Si la suposición de la contraseña es correcta, la página de inicio de sesión devolverá la cookie de vale de autenticación, momento en el que el programa sabe que tiene stumbled en un par de nombre de usuario/contraseña válido.</span><span class="sxs-lookup"><span data-stu-id="06c9a-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="06c9a-155">Por fuerza bruta, este tipo de programa podría ser capaz de caso en la contraseña de un usuario, en especial si la contraseña es débil.</span><span class="sxs-lookup"><span data-stu-id="06c9a-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="06c9a-156">Para evitar estos ataques por fuerza bruta, el marco de pertenencia bloquea a un usuario si hay un cierto número de intentos de inicio de sesión incorrectos en un período de tiempo determinado.</span><span class="sxs-lookup"><span data-stu-id="06c9a-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="06c9a-157">Los parámetros exactos se pueden configurar mediante las dos siguientes opciones de configuración del proveedor de pertenencia:</span><span class="sxs-lookup"><span data-stu-id="06c9a-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="06c9a-158">`maxInvalidPasswordAttempts` : especifica el número de intentos de contraseña no válidos que se permiten para el usuario durante el período de tiempo antes de que se bloquee la cuenta. El valor predeterminado es 5.</span><span class="sxs-lookup"><span data-stu-id="06c9a-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="06c9a-159">`passwordAttemptWindow` : indica el período de tiempo en minutos durante el cual el número especificado de intentos de inicio de sesión no válidos hará que se bloquee la cuenta. El valor predeterminado es 10.</span><span class="sxs-lookup"><span data-stu-id="06c9a-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="06c9a-160">Si un usuario se ha bloqueado, no podrá iniciar sesión hasta que un administrador desbloquee su cuenta.</span><span class="sxs-lookup"><span data-stu-id="06c9a-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="06c9a-161">Cuando se bloquea un usuario, el `ValidateUser` método *siempre* devolverá `false` , incluso si se proporcionan credenciales válidas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-161">When a user is locked out, the `ValidateUser` method will *always* return `false`, even if valid credentials are supplied.</span></span> <span data-ttu-id="06c9a-162">Aunque este comportamiento reduce la probabilidad de que un pirata informático entre en el sitio a través de métodos de fuerza bruta, puede acabar bloqueando un usuario válido que simplemente olvidó su contraseña o que tiene un bloqueo de mayúsculas o minúsculas en un día de escritura incorrecto.</span><span class="sxs-lookup"><span data-stu-id="06c9a-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="06c9a-163">Desafortunadamente, no hay ninguna herramienta integrada para desbloquear una cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="06c9a-164">Para desbloquear una cuenta, puede modificar la base de datos directamente: cambie el `IsLockedOut` campo de la `aspnet_Membership` tabla para la cuenta de usuario adecuada o cree una interfaz basada en Web que muestre las cuentas bloqueadas con opciones para desbloquearlas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="06c9a-165">Examinaremos la creación de interfaces administrativas para llevar a cabo tareas comunes relacionadas con la cuenta de usuario y los roles en un tutorial futuro.</span><span class="sxs-lookup"><span data-stu-id="06c9a-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="06c9a-166">Una desventaja del `ValidateUser` método es que cuando las credenciales proporcionadas no son válidas, no proporciona ninguna explicación sobre el motivo.</span><span class="sxs-lookup"><span data-stu-id="06c9a-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="06c9a-167">Es posible que las credenciales no sean válidas porque no hay ningún par de nombre de usuario/contraseña coincidente en el almacén del usuario, o porque el usuario aún no se ha aprobado o porque el usuario se ha bloqueado. En el paso 4, veremos cómo mostrar un mensaje más detallado al usuario cuando se produce un error en el intento de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>

## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="06c9a-168">Paso 2: recopilación de credenciales a través del control Web de inicio de sesión</span><span class="sxs-lookup"><span data-stu-id="06c9a-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="06c9a-169">El [control Web de inicio de sesión](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) representa una interfaz de usuario predeterminada muy similar a la que se ha creado en el tutorial Introducción a la <a id="SKM5"></a> [*autenticación de formularios*](../introduction/an-overview-of-forms-authentication-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="06c9a-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="SKM5"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial.</span></span> <span data-ttu-id="06c9a-170">El uso del control de inicio de sesión nos ahorra el trabajo de tener que crear la interfaz para recopilar las credenciales del visitante.</span><span class="sxs-lookup"><span data-stu-id="06c9a-170">Using the Login control saves us the work of having to create the interface to collect the visitor's credentials.</span></span> <span data-ttu-id="06c9a-171">Además, el control de inicio de sesión inicia sesión automáticamente en el usuario (suponiendo que las credenciales enviadas son válidas), lo que nos evita tener que escribir código.</span><span class="sxs-lookup"><span data-stu-id="06c9a-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="06c9a-172">Vamos a actualizar `Login.aspx` , reemplazando la interfaz creada manualmente y el código por un control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="06c9a-173">Comience quitando el marcado y el código existentes en `Login.aspx` .</span><span class="sxs-lookup"><span data-stu-id="06c9a-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="06c9a-174">Puede eliminarlo de forma inadecuada o simplemente comentarlo. Para marcar como comentario el marcado declarativo, inclúyalo con los `<%--` `--%>` delimitadores y.</span><span class="sxs-lookup"><span data-stu-id="06c9a-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="06c9a-175">Puede especificar estos delimitadores manualmente, o bien, como se muestra en la figura 2, puede seleccionar el texto que desea comentar y, a continuación, hacer clic en el icono marcar como comentario las líneas seleccionadas en la barra de herramientas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="06c9a-176">Del mismo modo, puede usar el icono marcar como comentario las líneas seleccionadas para comentar el código seleccionado en la clase de código subyacente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>

<span data-ttu-id="06c9a-177">[![Comentar el marcado declarativo y el código fuente existentes en login. aspx](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span></span>

<span data-ttu-id="06c9a-178">**Figura 2**: comentar el marcado declarativo y el código fuente existentes en `Login.aspx` ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in `Login.aspx` ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="06c9a-179">El icono marcar como comentario las líneas seleccionadas no está disponible cuando se ve el marcado declarativo en Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="06c9a-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="06c9a-180">Si no usa Visual Studio 2008, deberá agregar manualmente los `<%--` `--%>` delimitadores y.</span><span class="sxs-lookup"><span data-stu-id="06c9a-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>

<span data-ttu-id="06c9a-181">A continuación, arrastre un control login desde el cuadro de herramientas de a la página y establezca su `ID` propiedad en `myLogin` .</span><span class="sxs-lookup"><span data-stu-id="06c9a-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="06c9a-182">En este punto, la pantalla debe tener un aspecto similar al de la figura 3.</span><span class="sxs-lookup"><span data-stu-id="06c9a-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="06c9a-183">Tenga en cuenta que la interfaz predeterminada del control de inicio de sesión incluye controles de cuadro de texto para el nombre de usuario y la contraseña, una casilla recordarme próxima vez y un botón iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="06c9a-184">También hay `RequiredFieldValidator` controles para los dos cuadros de texto.</span><span class="sxs-lookup"><span data-stu-id="06c9a-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>

<span data-ttu-id="06c9a-185">[![Agregar un control de inicio de sesión a la página](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span></span>

<span data-ttu-id="06c9a-186">**Figura 3**: agregar un control de inicio de sesión a la página ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))</span></span>

<span data-ttu-id="06c9a-187">Y ya hemos terminado.</span><span class="sxs-lookup"><span data-stu-id="06c9a-187">And we're done!</span></span> <span data-ttu-id="06c9a-188">Cuando se haga clic en el botón iniciar sesión del control de inicio de sesión, se producirá un postback y el control de inicio de sesión llamará al `Membership.ValidateUser` método y pasará el nombre de usuario y la contraseña especificados.</span><span class="sxs-lookup"><span data-stu-id="06c9a-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="06c9a-189">Si las credenciales no son válidas, el control de inicio de sesión muestra un mensaje que indica que.</span><span class="sxs-lookup"><span data-stu-id="06c9a-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="06c9a-190">Sin embargo, si las credenciales son válidas, el control de inicio de sesión crea el vale de autenticación de formularios y redirige al usuario a la página correspondiente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="06c9a-191">El control de inicio de sesión utiliza cuatro factores para determinar la página adecuada a la que se redirigirá al usuario tras un inicio de sesión correcto:</span><span class="sxs-lookup"><span data-stu-id="06c9a-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="06c9a-192">Si el control de inicio de sesión está en la página de inicio de sesión tal y como se define `loginUrl` en la configuración de autenticación de formularios; el valor predeterminado de esta configuración es `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="06c9a-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="06c9a-193">La presencia de un `ReturnUrl` parámetro QueryString</span><span class="sxs-lookup"><span data-stu-id="06c9a-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="06c9a-194">Valor de la [ `DestinationUrl` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx) del control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="06c9a-195">El `defaultUrl` valor especificado en los valores de configuración de autenticación de formularios; el valor predeterminado de esta configuración es `Default.aspx`</span><span class="sxs-lookup"><span data-stu-id="06c9a-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is `Default.aspx`</span></span>

<span data-ttu-id="06c9a-196">En la figura 4 se describe el modo en que el control de inicio de sesión utiliza estos cuatro parámetros para llegar a su decisión de página adecuada.</span><span class="sxs-lookup"><span data-stu-id="06c9a-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>

<span data-ttu-id="06c9a-197">[![Agregar un control de inicio de sesión a la página](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span></span>

<span data-ttu-id="06c9a-198">**Figura 4**: agregar un control de inicio de sesión a la página ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))</span></span>

<span data-ttu-id="06c9a-199">Dedique un momento a probar el control de inicio de sesión visitando el sitio a través de un explorador e iniciar sesión como un usuario existente en el marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="06c9a-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="06c9a-200">La interfaz representada del control de inicio de sesión es muy configurable.</span><span class="sxs-lookup"><span data-stu-id="06c9a-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="06c9a-201">Hay una serie de propiedades que influyen en su apariencia; lo que es más, el control de inicio de sesión se puede convertir en una plantilla para un control preciso sobre el diseño de los elementos de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="06c9a-202">En el resto de este paso se examina cómo personalizar la apariencia y el diseño.</span><span class="sxs-lookup"><span data-stu-id="06c9a-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="06c9a-203">Personalizar la apariencia del control de inicio de sesión</span><span class="sxs-lookup"><span data-stu-id="06c9a-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="06c9a-204">La configuración predeterminada de las propiedades del control de inicio de sesión representa una interfaz de usuario con un título (inicio de sesión), controles de cuadro de texto y etiquetas para las entradas de nombre de usuario y contraseña, una casilla recordarme próxima vez y un botón iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="06c9a-205">Todos los aspectos de estos elementos se pueden configurar a través de las numerosas propiedades del control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="06c9a-206">Además, los elementos de la interfaz de usuario adicionales, como un vínculo a una página para crear una nueva cuenta de usuario, se pueden agregar estableciendo una o dos propiedades.</span><span class="sxs-lookup"><span data-stu-id="06c9a-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="06c9a-207">Vamos a pasar unos momentos para gussyr el aspecto del control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="06c9a-208">Como la `Login.aspx` página ya tiene texto en la parte superior de la página que indica login, el título del control de inicio de sesión es superfluo.</span><span class="sxs-lookup"><span data-stu-id="06c9a-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="06c9a-209">Por lo tanto, borre el valor de la [ `TitleText` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) para quitar el título del control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="06c9a-210">El nombre de usuario: y la contraseña: las etiquetas a la izquierda de los dos controles de cuadro de texto se pueden personalizar a través de las [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) [ `PasswordLabelText` propiedades](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx)y, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="06c9a-211">Vamos a cambiar el nombre de usuario: Label por Read username:.</span><span class="sxs-lookup"><span data-stu-id="06c9a-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="06c9a-212">Los estilos de etiqueta y de cuadro de texto se pueden configurar a través de las [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) [ `TextBoxStyle` propiedades](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx)y, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="06c9a-213">La propiedad texto de la casilla recordarme próxima vez se puede establecer mediante el del control de inicio de sesión [`RememberMeText property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx) , y su estado de activación predeterminado es configurable a través de [`RememberMeSet property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (cuyo valor predeterminado es false).</span><span class="sxs-lookup"><span data-stu-id="06c9a-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="06c9a-214">Continúe y establezca la `RememberMeSet` propiedad en true para que la casilla recordarme próxima vez esté activada de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="06c9a-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="06c9a-215">El control de inicio de sesión ofrece dos propiedades para ajustar el diseño de sus controles de interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="06c9a-216">[`TextLayout property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx)Indica si las etiquetas username: y password: aparecen a la izquierda de sus cuadros de texto correspondientes (el valor predeterminado), o por encima de ellas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-216">The [`TextLayout property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="06c9a-217">[`Orientation property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx)Indica si las entradas de nombre de usuario y contraseña están ubicadas verticalmente (una encima de la otra) o horizontalmente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-217">The [`Orientation property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="06c9a-218">Voy a dejar estas dos propiedades establecidas en sus valores predeterminados, pero recomiendo que pruebe a establecer estas dos propiedades en sus valores no predeterminados para ver el efecto resultante.</span><span class="sxs-lookup"><span data-stu-id="06c9a-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="06c9a-219">En la siguiente sección, configuración del diseño del control de inicio de sesión, veremos el uso de plantillas para definir el diseño preciso de los elementos de la interfaz de usuario del control de diseño.</span><span class="sxs-lookup"><span data-stu-id="06c9a-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>

<span data-ttu-id="06c9a-220">¿Desea ajustar la configuración de las propiedades del control de inicio de sesión estableciendo las [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) [ `CreateUserUrl` propiedades](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) y en no registrado todavía?</span><span class="sxs-lookup"><span data-stu-id="06c9a-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="06c9a-221">Cree una cuenta.</span><span class="sxs-lookup"><span data-stu-id="06c9a-221">Create an account!</span></span> <span data-ttu-id="06c9a-222">y `~/Membership/CreatingUserAccounts.aspx` , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="06c9a-223">Esto agrega un hipervínculo a la interfaz del control de inicio de sesión que apunta a la página que hemos creado en el <a id="SKM6"></a> [tutorial anterior](creating-user-accounts-cs.md).</span><span class="sxs-lookup"><span data-stu-id="06c9a-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="SKM6"></a>[preceding tutorial](creating-user-accounts-cs.md).</span></span> <span data-ttu-id="06c9a-224">Las propiedades y propiedades del control de inicio de sesión y [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) [ `HelpPageUrl` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) y funcionan de la misma manera, la representación de vínculos a una página de ayuda y una página de recuperación de contraseña. [ `PasswordRecoveryUrl` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx)</span><span class="sxs-lookup"><span data-stu-id="06c9a-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="06c9a-225">Después de realizar estos cambios en las propiedades, el marcado y la apariencia declarativos del control de inicio de sesión deben tener un aspecto similar al que se muestra en la figura 5.</span><span class="sxs-lookup"><span data-stu-id="06c9a-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>

<span data-ttu-id="06c9a-226">[![Los valores de las propiedades del control de inicio de sesión determinan su apariencia](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span></span>

<span data-ttu-id="06c9a-227">**Figura 5**: los valores de las propiedades del control de inicio de sesión determinan su apariencia ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png))</span></span>

### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="06c9a-228">Configurar el diseño del control de inicio de sesión</span><span class="sxs-lookup"><span data-stu-id="06c9a-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="06c9a-229">La interfaz de usuario predeterminada del control Web de inicio de sesión dispone de la interfaz en un código HTML `<table>` .</span><span class="sxs-lookup"><span data-stu-id="06c9a-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="06c9a-230">Pero ¿qué ocurre si necesitamos un mayor control sobre la salida representada?</span><span class="sxs-lookup"><span data-stu-id="06c9a-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="06c9a-231">Tal vez desee reemplazar el `<table>` por una serie de `<div>` etiquetas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="06c9a-232">¿O si nuestra aplicación requiere credenciales adicionales para la autenticación?</span><span class="sxs-lookup"><span data-stu-id="06c9a-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="06c9a-233">Muchos sitios web financieros, por ejemplo, requieren que los usuarios suministren no solo un nombre de usuario y una contraseña, sino también un número de identificación personal (PIN) u otra información de identificación.</span><span class="sxs-lookup"><span data-stu-id="06c9a-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="06c9a-234">Sea cual sea el motivo, es posible convertir el control de inicio de sesión en una plantilla, desde donde podemos definir explícitamente el marcado declarativo de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="06c9a-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="06c9a-235">Necesitamos hacer dos cosas para actualizar el control de inicio de sesión para recopilar credenciales adicionales:</span><span class="sxs-lookup"><span data-stu-id="06c9a-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="06c9a-236">Actualice la interfaz del control de inicio de sesión para incluir controles Web para recopilar las credenciales adicionales.</span><span class="sxs-lookup"><span data-stu-id="06c9a-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="06c9a-237">Invalide la lógica de autenticación interna del control de inicio de sesión para que un usuario solo se autentique si su nombre de usuario y contraseña son válidos y sus credenciales adicionales también son válidas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="06c9a-238">Para llevar a cabo la primera tarea, es necesario convertir el control de inicio de sesión en una plantilla y agregar los controles Web necesarios.</span><span class="sxs-lookup"><span data-stu-id="06c9a-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="06c9a-239">Como en la segunda tarea, la lógica de autenticación del control de inicio de sesión se puede reemplazar mediante la creación de un controlador de eventos para el [ `Authenticate` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)del control.</span><span class="sxs-lookup"><span data-stu-id="06c9a-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="06c9a-240">Vamos a actualizar el control de inicio de sesión para que solicite a los usuarios el nombre de usuario, la contraseña y la dirección de correo electrónico, y solo autentique al usuario si la dirección de correo electrónico proporcionada coincide con su dirección de correo electrónico en el archivo.</span><span class="sxs-lookup"><span data-stu-id="06c9a-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="06c9a-241">En primer lugar, es necesario convertir la interfaz del control de inicio de sesión en una plantilla.</span><span class="sxs-lookup"><span data-stu-id="06c9a-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="06c9a-242">En la etiqueta inteligente del control de inicio de sesión, elija la opción convertir en plantilla.</span><span class="sxs-lookup"><span data-stu-id="06c9a-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>

<span data-ttu-id="06c9a-243">[![Convertir el control de inicio de sesión en una plantilla](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span></span>

<span data-ttu-id="06c9a-244">**Figura 6**: conversión del control de inicio de sesión en una plantilla ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="06c9a-245">Para revertir el control de inicio de sesión a su versión anterior a la plantilla, haga clic en el vínculo de restablecimiento de la etiqueta inteligente del control.</span><span class="sxs-lookup"><span data-stu-id="06c9a-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>

<span data-ttu-id="06c9a-246">Al convertir el control de inicio de sesión en una plantilla `LayoutTemplate` , se agrega un al marcado declarativo del control con elementos HTML y controles Web que definen la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="06c9a-247">Como se muestra en la figura 7, al convertir el control en una plantilla se quitan varias propiedades del ventana Propiedades, como `TitleText` , `CreateUserUrl` , etc., ya que estos valores de propiedad se omiten cuando se usa una plantilla.</span><span class="sxs-lookup"><span data-stu-id="06c9a-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>

<span data-ttu-id="06c9a-248">[![Hay menos propiedades disponibles cuando el control de inicio de sesión se convierte en una plantilla.](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span></span>

<span data-ttu-id="06c9a-249">**Figura 7**: hay menos propiedades disponibles cuando el control de inicio de sesión se convierte en una plantilla ([haga clic para ver la imagen a tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png))</span></span>

<span data-ttu-id="06c9a-250">El marcado HTML en `LayoutTemplate` puede modificarse según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="06c9a-251">Del mismo modo, no dude en agregar nuevos controles Web a la plantilla.</span><span class="sxs-lookup"><span data-stu-id="06c9a-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="06c9a-252">Sin embargo, es importante que los controles Web principales del control de inicio de sesión permanezcan en la plantilla y mantengan sus valores asignados `ID` .</span><span class="sxs-lookup"><span data-stu-id="06c9a-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="06c9a-253">En concreto, no quite ni cambie el nombre de `UserName` los `Password` cuadros de texto o, la casilla, el `RememberMe` `LoginButton` botón, la `FailureText` etiqueta ni los `RequiredFieldValidator` controles.</span><span class="sxs-lookup"><span data-stu-id="06c9a-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="06c9a-254">Para recopilar la dirección de correo electrónico del visitante, es necesario agregar un cuadro de texto a la plantilla.</span><span class="sxs-lookup"><span data-stu-id="06c9a-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="06c9a-255">Agregue el siguiente marcado declarativo entre la fila de la tabla ( `<tr>` ) que contiene el `Password` cuadro de texto y la fila de la tabla que contiene la casilla recordarme próxima vez:</span><span class="sxs-lookup"><span data-stu-id="06c9a-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample2.aspx)]

<span data-ttu-id="06c9a-256">Después de agregar el `Email` cuadro de texto, visite la página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="06c9a-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="06c9a-257">Como se muestra en la figura 8, la interfaz de usuario del control de inicio de sesión ahora incluye un tercer cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="06c9a-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>

<span data-ttu-id="06c9a-258">[![El control de inicio de sesión incluye ahora un cuadro de texto para la dirección de correo electrónico del usuario](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span></span>

<span data-ttu-id="06c9a-259">**Figura 8**: el control de inicio de sesión ahora incluye un cuadro de texto para la dirección de correo electrónico del usuario ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png))</span></span>

<span data-ttu-id="06c9a-260">En este momento, el control de inicio de sesión sigue usando el `Membership.ValidateUser` método para validar las credenciales proporcionadas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="06c9a-261">En consecuencia, el valor especificado en el `Email` cuadro de texto no tiene en cuenta si el usuario puede iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="06c9a-262">En el paso 3, veremos cómo invalidar la lógica de autenticación del control de inicio de sesión para que las credenciales solo se consideren válidas si el nombre de usuario y la contraseña son válidos y la dirección de correo electrónico proporcionada coincide con la dirección de correo electrónico del archivo.</span><span class="sxs-lookup"><span data-stu-id="06c9a-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="06c9a-263">Paso 3: modificar la lógica de autenticación del control de inicio de sesión</span><span class="sxs-lookup"><span data-stu-id="06c9a-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="06c9a-264">Cuando un visitante suministra sus credenciales y hace clic en el botón iniciar sesión, se recorre un postback y el control de inicio de sesión progresa a través de su flujo de trabajo de autenticación.</span><span class="sxs-lookup"><span data-stu-id="06c9a-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="06c9a-265">El flujo de trabajo se inicia generando el [ `LoggingIn` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span><span class="sxs-lookup"><span data-stu-id="06c9a-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="06c9a-266">Cualquier controlador de eventos asociado a este evento puede cancelar la operación de inicio de sesión estableciendo la `e.Cancel` propiedad en `true` .</span><span class="sxs-lookup"><span data-stu-id="06c9a-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `true`.</span></span>

<span data-ttu-id="06c9a-267">Si no se cancela la operación de inicio de sesión, el flujo de trabajo progresa generando el [ `Authenticate` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span><span class="sxs-lookup"><span data-stu-id="06c9a-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="06c9a-268">Si hay un controlador de eventos para el `Authenticate` evento, es responsable de determinar si las credenciales proporcionadas son válidas o no.</span><span class="sxs-lookup"><span data-stu-id="06c9a-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="06c9a-269">Si no se especifica ningún controlador de eventos, el control de inicio de sesión utiliza el `Membership.ValidateUser` método para determinar la validez de las credenciales.</span><span class="sxs-lookup"><span data-stu-id="06c9a-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="06c9a-270">Si las credenciales proporcionadas son válidas, se crea el vale de autenticación de formularios, se genera el [ `LoggedIn` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) y se redirige al usuario a la página correspondiente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="06c9a-271">Sin embargo, si las credenciales se consideran no válidas, se genera el [ `LoginError` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) y se muestra un mensaje que informa al usuario de que sus credenciales no son válidas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="06c9a-272">De forma predeterminada, en caso de error, el control de inicio de sesión simplemente establece la `FailureText` propiedad text del control etiqueta en un mensaje de error (el intento de inicio de sesión no se ha realizado correctamente).</span><span class="sxs-lookup"><span data-stu-id="06c9a-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="06c9a-273">Vuelva a intentarlo).</span><span class="sxs-lookup"><span data-stu-id="06c9a-273">Please try again ).</span></span> <span data-ttu-id="06c9a-274">Sin embargo, si la [ `FailureAction` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) del control de inicio de sesión se establece en `RedirectToLoginPage` , el control de inicio de sesión emite un `Response.Redirect` a la página de inicio de sesión que anexa el parámetro QueryString `loginfailure=1` (que hace que el control de inicio de sesión muestre el mensaje de error).</span><span class="sxs-lookup"><span data-stu-id="06c9a-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="06c9a-275">En la ilustración 9 se ofrece un diagrama de flujo del flujo de trabajo de autenticación.</span><span class="sxs-lookup"><span data-stu-id="06c9a-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>

<span data-ttu-id="06c9a-276">[![El flujo de trabajo de autenticación del control de inicio de sesión](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span></span>

<span data-ttu-id="06c9a-277">**Figura 9**: flujo de trabajo de autenticación del control de inicio de sesión ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="06c9a-278">Si se le pregunta si desea utilizar la `FailureAction` opción de `RedirectToLogin` Página de, considere el siguiente escenario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="06c9a-279">`Site.master`En la actualidad, ahora nuestra página maestra tiene el texto, Hola, extraño mostrado en la columna izquierda cuando lo visita un usuario anónimo, pero Imagine que queríamos reemplazar ese texto por un control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="06c9a-280">Esto permitiría que un usuario anónimo iniciara sesión desde cualquier página del sitio, en lugar de requerir que visite directamente la página de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="06c9a-281">Sin embargo, si un usuario no pudo iniciar sesión a través del control de inicio de sesión representado por la página maestra, puede que tenga sentido redirigirlos a la página de inicio de sesión ( `Login.aspx` ), ya que es probable que esa página incluya instrucciones, vínculos y otra ayuda, como vínculos para crear una nueva cuenta o recuperar una contraseña perdida, que no se agregaron a la página maestra.</span><span class="sxs-lookup"><span data-stu-id="06c9a-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>

### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="06c9a-282">Crear el `Authenticate` controlador de eventos</span><span class="sxs-lookup"><span data-stu-id="06c9a-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="06c9a-283">Para poder conectar la lógica de autenticación personalizada, es necesario crear un controlador de eventos para el evento del control de inicio de sesión `Authenticate` .</span><span class="sxs-lookup"><span data-stu-id="06c9a-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="06c9a-284">Al crear un controlador de eventos para el `Authenticate` evento, se generará la siguiente definición de controlador de eventos:</span><span class="sxs-lookup"><span data-stu-id="06c9a-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample3.cs)]

<span data-ttu-id="06c9a-285">Como puede ver, `Authenticate` se pasa al controlador de eventos un objeto de tipo [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) como el segundo parámetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="06c9a-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="06c9a-286">La `AuthenticateEventArgs` clase contiene una propiedad booleana denominada `Authenticated` que se utiliza para especificar si las credenciales proporcionadas son válidas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="06c9a-287">La tarea, a continuación, es escribir aquí el código que determina si las credenciales proporcionadas son válidas o no, y para establecer la `e.Authenticate` propiedad en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="06c9a-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="06c9a-288">Determinación y validación de las credenciales proporcionadas</span><span class="sxs-lookup"><span data-stu-id="06c9a-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="06c9a-289">Use las propiedades y del control de inicio de sesión [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) para determinar las credenciales de nombre de usuario y contraseña escritas por el usuario. [ `Password` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx)</span><span class="sxs-lookup"><span data-stu-id="06c9a-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="06c9a-290">Para determinar los valores especificados en los controles Web adicionales (como el cuadro de `Email` texto que se agregó en el paso anterior), use *`LoginControlID`* `.FindControl` (" *`controlID`* ") para obtener una referencia mediante programación al control Web en la plantilla cuya `ID` propiedad es igual a *`controlID`* .</span><span class="sxs-lookup"><span data-stu-id="06c9a-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use *`LoginControlID`*`.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="06c9a-291">Por ejemplo, para obtener una referencia al `Email` cuadro de texto, use el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="06c9a-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`TextBox EmailTextBox = myLogin.FindControl("Email") as TextBox;`

<span data-ttu-id="06c9a-292">Con el fin de validar las credenciales del usuario, es necesario hacer dos cosas:</span><span class="sxs-lookup"><span data-stu-id="06c9a-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="06c9a-293">Asegúrese de que el nombre de usuario y la contraseña proporcionados son válidos.</span><span class="sxs-lookup"><span data-stu-id="06c9a-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="06c9a-294">Asegúrese de que la dirección de correo electrónico especificada coincide con la dirección de correo electrónico del archivo para el usuario que intenta iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="06c9a-295">Para realizar la primera comprobación, podemos usar simplemente el `Membership.ValidateUser` método como vimos en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="06c9a-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="06c9a-296">Para la segunda comprobación, es necesario determinar la dirección de correo electrónico del usuario para que podamos compararla con la dirección de correo electrónico introducida en el control de cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="06c9a-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="06c9a-297">Para obtener información sobre un usuario determinado, use el `Membership` [ `GetUser` método](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx)de la clase.</span><span class="sxs-lookup"><span data-stu-id="06c9a-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="06c9a-298">El `GetUser` método tiene varias sobrecargas.</span><span class="sxs-lookup"><span data-stu-id="06c9a-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="06c9a-299">Si se utiliza sin pasar ningún parámetro, devuelve información sobre el usuario que ha iniciado sesión actualmente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="06c9a-300">Para obtener información acerca de un usuario determinado, llame a `GetUser` pasar su nombre de usuario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="06c9a-301">En cualquier caso, `GetUser` devuelve un [ `MembershipUser` objeto](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), que tiene propiedades como `UserName` , `Email` , `IsApproved` ,, etc `IsOnline` .</span><span class="sxs-lookup"><span data-stu-id="06c9a-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="06c9a-302">El código siguiente implementa estas dos comprobaciones.</span><span class="sxs-lookup"><span data-stu-id="06c9a-302">The following code implements these two checks.</span></span> <span data-ttu-id="06c9a-303">Si ambos pasan, `e.Authenticate` se establece en `true` , de lo contrario, se asigna `false` .</span><span class="sxs-lookup"><span data-stu-id="06c9a-303">If both pass, then `e.Authenticate` is set to `true`, otherwise it is assigned `false`.</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample4.cs)]

<span data-ttu-id="06c9a-304">Con este código en su lugar, intente iniciar sesión como un usuario válido y escriba el nombre de usuario, la contraseña y la dirección de correo electrónico correctos.</span><span class="sxs-lookup"><span data-stu-id="06c9a-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="06c9a-305">Inténtelo de nuevo, pero esta vez use de una dirección de correo electrónico incorrecta (consulte la figura 10).</span><span class="sxs-lookup"><span data-stu-id="06c9a-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="06c9a-306">Por último, pruébelo una tercera vez con un nombre de usuario que no existe.</span><span class="sxs-lookup"><span data-stu-id="06c9a-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="06c9a-307">En el primer caso, debe iniciar sesión correctamente en el sitio, pero en los dos últimos casos debería ver el mensaje de credenciales no válidos del control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>

<span data-ttu-id="06c9a-308">[![Tito no puede iniciar sesión al proporcionar una dirección de correo electrónico incorrecta](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span></span>

<span data-ttu-id="06c9a-309">**Figura 10**: Tito no puede iniciar sesión al proporcionar una dirección de correo electrónico incorrecta ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="06c9a-310">Como se describe en la sección Cómo el marco de pertenencia controla los intentos de inicio de sesión no válidos en el paso 1, cuando `Membership.ValidateUser` se llama al método y se pasan credenciales no válidas, realiza un seguimiento del intento de inicio de sesión no válido y bloquea al usuario si supera un umbral determinado de intentos no válidos dentro de un período de tiempo especificado.</span><span class="sxs-lookup"><span data-stu-id="06c9a-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="06c9a-311">Dado que la lógica de autenticación personalizada llama al `ValidateUser` método, una contraseña incorrecta para un nombre de usuario válido incrementará el contador de intentos de inicio de sesión no válidos, pero este contador no se incrementará en el caso de que el nombre de usuario y la contraseña sean válidos, pero la dirección de correo electrónico no es correcta.</span><span class="sxs-lookup"><span data-stu-id="06c9a-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="06c9a-312">Lo más probable es que este comportamiento sea adecuado, ya que es improbable que un pirata informático conozca el nombre de usuario y la contraseña, pero que tenga que usar técnicas de fuerza bruta para determinar la dirección de correo electrónico del usuario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>

## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="06c9a-313">Paso 4: mejorar el mensaje de credenciales no válidas del control de inicio de sesión</span><span class="sxs-lookup"><span data-stu-id="06c9a-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="06c9a-314">Cuando un usuario intenta iniciar sesión con credenciales no válidas, el control de inicio de sesión muestra un mensaje que explica que el intento de inicio de sesión no se ha realizado correctamente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="06c9a-315">En concreto, el control muestra el mensaje especificado por su [ `FailureText` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), que tiene un valor predeterminado de su intento de inicio de sesión no se ha realizado correctamente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="06c9a-316">Inténtelo de nuevo.</span><span class="sxs-lookup"><span data-stu-id="06c9a-316">Please try again.</span></span>

<span data-ttu-id="06c9a-317">Recuerde que hay muchas razones por las que las credenciales de un usuario no son válidas:</span><span class="sxs-lookup"><span data-stu-id="06c9a-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="06c9a-318">Puede que el nombre de usuario no exista</span><span class="sxs-lookup"><span data-stu-id="06c9a-318">The username may not exist</span></span>
- <span data-ttu-id="06c9a-319">El nombre de usuario existe, pero la contraseña no es válida</span><span class="sxs-lookup"><span data-stu-id="06c9a-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="06c9a-320">El nombre de usuario y la contraseña son válidos, pero el usuario aún no se ha aprobado</span><span class="sxs-lookup"><span data-stu-id="06c9a-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="06c9a-321">El nombre de usuario y la contraseña son válidos, pero el usuario está bloqueado (lo más probable es que haya superado el número de intentos de inicio de sesión no válidos en el período de tiempo especificado)</span><span class="sxs-lookup"><span data-stu-id="06c9a-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="06c9a-322">Y puede haber otras razones para usar la lógica de autenticación personalizada.</span><span class="sxs-lookup"><span data-stu-id="06c9a-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="06c9a-323">Por ejemplo, con el código que escribimos en el paso 3, el nombre de usuario y la contraseña pueden ser válidos, pero la dirección de correo electrónico puede ser incorrecta.</span><span class="sxs-lookup"><span data-stu-id="06c9a-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="06c9a-324">Independientemente de la razón por la que las credenciales no sean válidas, el control de inicio de sesión muestra el mismo mensaje de error.</span><span class="sxs-lookup"><span data-stu-id="06c9a-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="06c9a-325">Esta falta de comentarios puede ser confusa para un usuario cuya cuenta aún no se ha aprobado o que se ha bloqueado. Sin embargo, con un poco de trabajo, podemos hacer que el control de inicio de sesión muestre un mensaje más adecuado.</span><span class="sxs-lookup"><span data-stu-id="06c9a-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="06c9a-326">Cada vez que un usuario intenta iniciar sesión con credenciales no válidas, el control de inicio de sesión genera su `LoginError` evento.</span><span class="sxs-lookup"><span data-stu-id="06c9a-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="06c9a-327">Continúe y cree un controlador de eventos para este evento y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="06c9a-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample5.cs)]

<span data-ttu-id="06c9a-328">El código anterior se inicia estableciendo la propiedad del control de inicio de sesión `FailureText` en el valor predeterminado (el intento de inicio de sesión no se ha realizado correctamente).</span><span class="sxs-lookup"><span data-stu-id="06c9a-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="06c9a-329">Vuelva a intentarlo).</span><span class="sxs-lookup"><span data-stu-id="06c9a-329">Please try again ).</span></span> <span data-ttu-id="06c9a-330">A continuación, comprueba si el nombre de usuario proporcionado se asigna a una cuenta de usuario existente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="06c9a-331">En ese caso, consulta las `MembershipUser` propiedades y del objeto `IsLockedOut` resultante `IsApproved` para determinar si la cuenta se ha bloqueado o aún no se ha aprobado.</span><span class="sxs-lookup"><span data-stu-id="06c9a-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="06c9a-332">En cualquier caso, la `FailureText` propiedad se actualiza a un valor correspondiente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="06c9a-333">Para probar este código, intente iniciar sesión de forma intencionada como un usuario existente, pero use una contraseña incorrecta.</span><span class="sxs-lookup"><span data-stu-id="06c9a-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="06c9a-334">Haga esto cinco veces en una fila en un período de 10 minutos y se bloqueará la cuenta. Como se muestra en la figura 11, los intentos de inicio de sesión subsiguientes siempre producirán un error (incluso con la contraseña correcta), pero ahora mostrarán el más descriptivo que se ha bloqueado su cuenta debido a demasiados intentos de inicio de sesión no válidos.</span><span class="sxs-lookup"><span data-stu-id="06c9a-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="06c9a-335">Póngase en contacto con el administrador para que le desbloquee el mensaje de la cuenta.</span><span class="sxs-lookup"><span data-stu-id="06c9a-335">Please contact the administrator to have your account unlocked message.</span></span>

<span data-ttu-id="06c9a-336">[![Tito ha realizado demasiados intentos de inicio de sesión no válidos y se ha bloqueado.](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="06c9a-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span></span>

<span data-ttu-id="06c9a-337">**Figura 11**: Tito realizó demasiados intentos de inicio de sesión no válidos y se bloqueó ([haga clic para ver la imagen de tamaño completo](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="06c9a-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="06c9a-338">Resumen</span><span class="sxs-lookup"><span data-stu-id="06c9a-338">Summary</span></span>

<span data-ttu-id="06c9a-339">Antes de este tutorial, la página de inicio de sesión validó las credenciales proporcionadas en una lista codificada de forma rígida de pares de nombre de usuario y contraseña.</span><span class="sxs-lookup"><span data-stu-id="06c9a-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="06c9a-340">En este tutorial, se actualizó la página para validar las credenciales en el marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="06c9a-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="06c9a-341">En el paso 1 examinamos el uso del `Membership.ValidateUser` método mediante programación.</span><span class="sxs-lookup"><span data-stu-id="06c9a-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="06c9a-342">En el paso 2 Hemos reemplazado la interfaz de usuario y el código creados manualmente con el control de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="06c9a-343">El control de inicio de sesión representa una interfaz de usuario de inicio de sesión estándar y valida automáticamente las credenciales del usuario con el marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="06c9a-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="06c9a-344">Además, en el caso de credenciales válidas, el control de inicio de sesión inicia la sesión del usuario mediante la autenticación de formularios.</span><span class="sxs-lookup"><span data-stu-id="06c9a-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="06c9a-345">En Resumen, la experiencia del usuario de inicio de sesión totalmente funcional está disponible simplemente arrastrando el control de inicio de sesión a una página, sin necesidad de marcado o código declarativo adicional.</span><span class="sxs-lookup"><span data-stu-id="06c9a-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="06c9a-346">Lo que es más, el control de inicio de sesión es muy personalizable, lo que permite un gran grado de control sobre la lógica de autenticación y la interfaz de usuario representada.</span><span class="sxs-lookup"><span data-stu-id="06c9a-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="06c9a-347">En este momento, los visitantes a nuestro sitio web pueden crear una nueva cuenta de usuario e iniciar sesión en el sitio, pero aún veremos cómo restringir el acceso a las páginas basadas en el usuario autenticado.</span><span class="sxs-lookup"><span data-stu-id="06c9a-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="06c9a-348">Actualmente, cualquier usuario autenticado o anónimo puede ver cualquier página de nuestro sitio.</span><span class="sxs-lookup"><span data-stu-id="06c9a-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="06c9a-349">Además de controlar el acceso a las páginas de un sitio por usuario, es posible que tengamos ciertas páginas cuya funcionalidad depende del usuario.</span><span class="sxs-lookup"><span data-stu-id="06c9a-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="06c9a-350">En el siguiente tutorial se examina cómo limitar el acceso y la funcionalidad en página en función del usuario que ha iniciado sesión.</span><span class="sxs-lookup"><span data-stu-id="06c9a-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="06c9a-351">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="06c9a-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="06c9a-352">Más información</span><span class="sxs-lookup"><span data-stu-id="06c9a-352">Further Reading</span></span>

<span data-ttu-id="06c9a-353">Para obtener más información sobre los temas descritos en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="06c9a-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="06c9a-354">Mostrar mensajes personalizados a usuarios bloqueados y no aprobados</span><span class="sxs-lookup"><span data-stu-id="06c9a-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="06c9a-355">Examen de la pertenencia, los roles y el perfil de ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="06c9a-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="06c9a-356">Cómo: crear una página de inicio de sesión de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="06c9a-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="06c9a-357">Documentación técnica del control de inicio de sesión</span><span class="sxs-lookup"><span data-stu-id="06c9a-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="06c9a-358">Usar los controles de inicio de sesión</span><span class="sxs-lookup"><span data-stu-id="06c9a-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="06c9a-359">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="06c9a-359">About the Author</span></span>

<span data-ttu-id="06c9a-360">Scott Mitchell, autor de varios libros de ASP/ASP. NET y fundador de 4GuysFromRolla.com, ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="06c9a-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="06c9a-361">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="06c9a-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="06c9a-362">Su último libro se *[enseña a ASP.NET 2,0 en 24 horas](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="06c9a-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="06c9a-363">Se puede acceder a Scott en [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) o a través de su blog en [http://ScottOnWriting.NET](http://scottonwriting.net/) .</span><span class="sxs-lookup"><span data-stu-id="06c9a-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="06c9a-364">Agradecimiento especial a</span><span class="sxs-lookup"><span data-stu-id="06c9a-364">Special Thanks To</span></span>

<span data-ttu-id="06c9a-365">Muchos revisores útiles revisaron esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="06c9a-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="06c9a-366">Los revisores responsables de este tutorial eran Teresa Murphy y Michael Olivero.</span><span class="sxs-lookup"><span data-stu-id="06c9a-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="06c9a-367">¿Está interesado en revisar los próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="06c9a-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="06c9a-368">Si es así, suéltelo en una línea en [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com) .</span><span class="sxs-lookup"><span data-stu-id="06c9a-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="06c9a-369">[Anterior](creating-user-accounts-cs.md)
> [Siguiente](user-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="06c9a-369">[Previous](creating-user-accounts-cs.md)
[Next](user-based-authorization-cs.md)</span></span>

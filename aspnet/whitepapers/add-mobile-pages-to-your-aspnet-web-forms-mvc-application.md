---
uid: whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
title: 'Cómo: agregar páginas móviles a la aplicación de formularios Web Forms o MVC de ASP.NET | Microsoft Docs'
author: rick-anderson
description: En este artículo se describen las distintas formas de servir páginas optimizadas para dispositivos móviles de la aplicación ASP.NET Web Forms/MVC y se sugiere la arquitectura y...
ms.author: riande
ms.date: 01/20/2011
ms.assetid: 3124f28e-cc32-418a-afe3-519fa56f4c36
msc.legacyurl: /whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
msc.type: content
ms.openlocfilehash: 63c555358d06a9506bb5c8c993800c3307108192
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78462217"
---
# <a name="how-to-add-mobile-pages-to-your-aspnet-web-forms--mvc-application"></a><span data-ttu-id="85ec5-103">Cómo: agregar páginas móviles a la aplicación de formularios Web Forms o MVC de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="85ec5-103">How To: Add Mobile Pages to Your ASP.NET Web Forms / MVC Application</span></span>

> <span data-ttu-id="85ec5-104">**Se aplica a**</span><span class="sxs-lookup"><span data-stu-id="85ec5-104">**Applies To**</span></span>
> 
> - <span data-ttu-id="85ec5-105">ASP.NET Web Forms versión 4,0</span><span class="sxs-lookup"><span data-stu-id="85ec5-105">ASP.NET Web Forms version 4.0</span></span>
> - <span data-ttu-id="85ec5-106">ASP.NET MVC versión 3,0</span><span class="sxs-lookup"><span data-stu-id="85ec5-106">ASP.NET MVC version 3.0</span></span>
> 
> <span data-ttu-id="85ec5-107">**Resumen**</span><span class="sxs-lookup"><span data-stu-id="85ec5-107">**Summary**</span></span>
> 
> <span data-ttu-id="85ec5-108">En este artículo se describen las distintas formas de atender las páginas optimizadas para dispositivos móviles desde la aplicación Web Forms/MVC de ASP.NET y se sugieren problemas de diseño y arquitectura que se deben tener en cuenta a la hora de dirigirse a una amplia gama de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-108">This How To describes various ways to serve pages optimized for mobile devices from your ASP.NET Web Forms / MVC application, and suggests architectural and design issues to consider when targeting a broad range of devices.</span></span> <span data-ttu-id="85ec5-109">En este documento también se explica por qué los controles móviles de ASP.NET de ASP.NET 2,0 a 3,5 ahora están obsoletos y se describen algunas alternativas modernas.</span><span class="sxs-lookup"><span data-stu-id="85ec5-109">This document also explains why the ASP.NET Mobile Controls from ASP.NET 2.0 to 3.5 are now obsolete, and discusses some modern alternatives.</span></span>

## <a name="contents"></a><span data-ttu-id="85ec5-110">Contenido</span><span class="sxs-lookup"><span data-stu-id="85ec5-110">Contents</span></span>

- <span data-ttu-id="85ec5-111">Información general</span><span class="sxs-lookup"><span data-stu-id="85ec5-111">Overview</span></span>
- <span data-ttu-id="85ec5-112">Opciones de arquitectura</span><span class="sxs-lookup"><span data-stu-id="85ec5-112">Architectural options</span></span>
- <span data-ttu-id="85ec5-113">Detección de exploradores y dispositivos</span><span class="sxs-lookup"><span data-stu-id="85ec5-113">Browser and device detection</span></span>
- <span data-ttu-id="85ec5-114">Cómo pueden las aplicaciones de formularios Web Forms de ASP.NET presentar páginas específicas para dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-114">How ASP.NET Web Forms applications can present mobile-specific pages</span></span>
- <span data-ttu-id="85ec5-115">Cómo pueden las aplicaciones MVC de ASP.NET presentar páginas específicas para móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-115">How ASP.NET MVC applications can present mobile-specific pages</span></span>
- <span data-ttu-id="85ec5-116">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="85ec5-116">Additional resources</span></span>

<span data-ttu-id="85ec5-117">Para ver ejemplos de código descargables que muestran las técnicas de estas notas del producto para formularios Web Forms de ASP.NET y MVC, consulte [Mobile Apps sitios de & con ASP.net](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="85ec5-117">For downloadable code samples demonstrating this white paper's techniques for both ASP.NET Web Forms and MVC, see [Mobile Apps & Sites with ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span></span>

## <a name="overview"></a><span data-ttu-id="85ec5-118">Información general</span><span class="sxs-lookup"><span data-stu-id="85ec5-118">Overview</span></span>

<span data-ttu-id="85ec5-119">Dispositivos móviles: smartphones, teléfonos de características y tabletas: continúe creciendo en popularidad como medio para tener acceso a la Web.</span><span class="sxs-lookup"><span data-stu-id="85ec5-119">Mobile devices – smartphones, feature phones, and tablets – continue to grow in popularity as a means to access the Web.</span></span> <span data-ttu-id="85ec5-120">Para muchos desarrolladores web y empresas orientadas a la web, esto significa que es cada vez más importante proporcionar una excelente experiencia de exploración para los visitantes que usan esos dispositivos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-120">For many web developers and web-oriented businesses, this means it's increasingly important to provide a great browsing experience for visitors using those devices.</span></span>

### <a name="how-earlier-versions-of-aspnet-supported-mobile-browsers"></a><span data-ttu-id="85ec5-121">Cómo las versiones anteriores de ASP.NET eran compatibles con los exploradores móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-121">How earlier versions of ASP.NET supported mobile browsers</span></span>

<span data-ttu-id="85ec5-122">ASP.NET Versions 2,0 to 3,5 incluye *ASP.NET Mobile Controls*: un conjunto de controles de servidor para dispositivos móviles en el ensamblado *System. Web. Mobile. dll* y el espacio de nombres *System. Web. UI. MobileControls* .</span><span class="sxs-lookup"><span data-stu-id="85ec5-122">ASP.NET versions 2.0 to 3.5 included *ASP.NET Mobile Controls*: a set of server controls for mobile devices in the *System.Web.Mobile.dll* assembly and the *System.Web.UI.MobileControls* namespace.</span></span> <span data-ttu-id="85ec5-123">El ensamblado todavía está incluido en ASP.NET 4, pero está en desuso.</span><span class="sxs-lookup"><span data-stu-id="85ec5-123">The assembly is still included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="85ec5-124">Se recomienda a los desarrolladores que migren a enfoques más modernos, como los descritos en este documento.</span><span class="sxs-lookup"><span data-stu-id="85ec5-124">Developers are advised to migrate to more modern approaches, such as those described in this paper.</span></span>

<span data-ttu-id="85ec5-125">La razón por la que los controles móviles ASP.NET se han marcado como obsoletos es que su diseño está orientado en torno a los teléfonos móviles que eran comunes en torno a 2005 y versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="85ec5-125">The reason why ASP.NET Mobile Controls have been marked as obsolete is that their design is oriented around the mobile phones that were common around 2005 and earlier.</span></span> <span data-ttu-id="85ec5-126">Los controles están diseñados principalmente para representar el marcado WML o cHTML (en lugar de HTML normal) para los exploradores WAP de esa era.</span><span class="sxs-lookup"><span data-stu-id="85ec5-126">The controls are mainly designed to render WML or cHTML markup (instead of regular HTML) for the WAP browsers of that era.</span></span> <span data-ttu-id="85ec5-127">No obstante, WAP, WML y cHTML ya no son relevantes para la mayoría de los proyectos, porque HTML ahora se ha convertido en el lenguaje de marcado omnipresente para exploradores móviles y de escritorio.</span><span class="sxs-lookup"><span data-stu-id="85ec5-127">But WAP, WML, and cHTML are no longer relevant for most projects, because HTML has now become the ubiquitous markup language for mobile and desktop browsers alike.</span></span>

### <a name="the-challenges-of-supporting-mobile-devices-today"></a><span data-ttu-id="85ec5-128">Los desafíos de admitir dispositivos móviles hoy en día</span><span class="sxs-lookup"><span data-stu-id="85ec5-128">The challenges of supporting mobile devices today</span></span>

<span data-ttu-id="85ec5-129">Aunque los exploradores móviles ahora son compatibles con HTML de un momento más universal, se enfrentarán a muchos desafíos a la hora de crear excelentes experiencias de exploración móvil:</span><span class="sxs-lookup"><span data-stu-id="85ec5-129">Even though mobile browsers now almost universally support HTML, you will still face many challenges when aiming to create great mobile browsing experiences:</span></span>

- <span data-ttu-id="85ec5-130">***Tamaño de pantalla*** : los dispositivos móviles varían drásticamente en el formulario, y sus pantallas suelen ser mucho menores que los monitores de escritorio.</span><span class="sxs-lookup"><span data-stu-id="85ec5-130">***Screen size*** - Mobile devices vary dramatically in form, and their screens are often much smaller than desktop monitors.</span></span> <span data-ttu-id="85ec5-131">Por lo tanto, puede que tenga que diseñar diseños de página completamente diferentes para ellos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-131">So, you may need to design completely different page layouts for them.</span></span>
- <span data-ttu-id="85ec5-132">***Métodos de entrada*** : algunos dispositivos tienen teclados, otros tienen lápiz óptico y otros usan la función táctil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-132">***Input methods*** – Some devices have keypads, some have styluses, others use touch.</span></span> <span data-ttu-id="85ec5-133">Es posible que tenga que tener en cuenta varios mecanismos de navegación y métodos de entrada de datos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-133">You may need to consider multiple navigation mechanisms and data input methods.</span></span>
- <span data-ttu-id="85ec5-134">***Compatibilidad con estándares*** : muchos exploradores móviles no son compatibles con los estándares HTML, CSS o JavaScript más recientes.</span><span class="sxs-lookup"><span data-stu-id="85ec5-134">***Standards compliance*** – Many mobile browsers do not support the latest HTML, CSS, or JavaScript standards.</span></span>
- <span data-ttu-id="85ec5-135">***Ancho de banda*** : el rendimiento de la red de datos móviles varía de forma natural y algunos usuarios finales tienen tarifas que se cobran por megabyte.</span><span class="sxs-lookup"><span data-stu-id="85ec5-135">***Bandwidth*** – Cellular data network performance varies wildly, and some end users are on tariffs that charge by the megabyte.</span></span>

<span data-ttu-id="85ec5-136">No hay ninguna solución que sea de un solo tamaño. la aplicación tendrá que buscar y comportarse de forma diferente según el dispositivo que tiene acceso a ella.</span><span class="sxs-lookup"><span data-stu-id="85ec5-136">There's no one-size-fits-all solution; your application will have to look and behave differently according to the device accessing it.</span></span> <span data-ttu-id="85ec5-137">En función del nivel de soporte técnico móvil que desee, puede ser un desafío mayor para los desarrolladores web que en el caso de las "guerras del explorador".</span><span class="sxs-lookup"><span data-stu-id="85ec5-137">Depending on what level of mobile support you want, this can be a bigger challenge for web developers than the desktop "browser wars" ever was.</span></span>

<span data-ttu-id="85ec5-138">Los desarrolladores que se aproximan a la compatibilidad con exploradores móviles por primera vez suelen pensar que solo es importante admitir los smartphones más recientes y más sofisticados (por ejemplo, Windows Phone 7, iPhone o Android), quizás porque los desarrolladores suelen ser de su propiedad. dispositivos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-138">Developers approaching mobile browser support for the first time often initially think it's only important to support the latest and most sophisticated smartphones (e.g., Windows Phone 7, iPhone, or Android), perhaps because developers often personally own such devices.</span></span> <span data-ttu-id="85ec5-139">Sin embargo, los teléfonos más baratos siguen siendo extremadamente populares y sus propietarios los usan para explorar la web, especialmente en los países en los que los teléfonos móviles son más fáciles de obtener que una conexión de banda ancha.</span><span class="sxs-lookup"><span data-stu-id="85ec5-139">However, cheaper phones are still extremely popular, and their owners do use them to browse the web – especially in countries where mobile phones are easier to get than a broadband connection.</span></span> <span data-ttu-id="85ec5-140">Su empresa deberá decidir qué gama de dispositivos se admiten si tiene en cuenta a sus clientes probables.</span><span class="sxs-lookup"><span data-stu-id="85ec5-140">Your business will need to decide what range of devices to support by considering its likely customers.</span></span> <span data-ttu-id="85ec5-141">Si va a crear un catálogo en línea para un spa de estado de lujo, puede tomar una decisión empresarial únicamente para dirigirse a smartphones avanzados, mientras que si está creando un sistema de reserva de vales para una cine, es probable que tenga que tener en cuenta los visitantes con características menos eficaces. teléfonos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-141">If you're building an online brochure for a luxury health spa, you might make a business decision only to target advanced smartphones, whereas if you're creating a ticket booking system for a cinema, you probably need to account for visitors with less powerful feature phones.</span></span>

## <a name="architectural-options"></a><span data-ttu-id="85ec5-142">Opciones de arquitectura</span><span class="sxs-lookup"><span data-stu-id="85ec5-142">Architectural options</span></span>

<span data-ttu-id="85ec5-143">Antes de obtener los detalles técnicos específicos de los formularios Web Forms o MVC de ASP.NET, tenga en cuenta que los desarrolladores web en general tienen tres opciones principales para admitir exploradores móviles:</span><span class="sxs-lookup"><span data-stu-id="85ec5-143">Before we get to the specific technical details of ASP.NET Web Forms or MVC, note that web developers in general have three main possible options for supporting mobile browsers:</span></span>

1. <span data-ttu-id="85ec5-144">***No hacer nada:*** Puede simplemente crear una aplicación web estándar y orientada al escritorio y basarse en exploradores móviles para representarla de forma aceptable.</span><span class="sxs-lookup"><span data-stu-id="85ec5-144">***Do nothing –*** You can simply create a standard, desktop-oriented web application, and rely on mobile browsers to render it acceptably.</span></span> 

    - <span data-ttu-id="85ec5-145">**Ventaja**: es la opción más barata de implementar y mantener: sin trabajo adicional</span><span class="sxs-lookup"><span data-stu-id="85ec5-145">**Advantage**: It's the cheapest option to implement and maintain – no extra work</span></span>
    - <span data-ttu-id="85ec5-146">**Desventaja**: ofrece la peor experiencia del usuario final:</span><span class="sxs-lookup"><span data-stu-id="85ec5-146">**Disadvantage**: Gives the worst end-user experience:</span></span> 

        - <span data-ttu-id="85ec5-147">Los smartphones más recientes pueden presentar el código HTML, así como un explorador de escritorio, pero los usuarios todavía se verán obligados a hacer zoom y desplazarse horizontal y verticalmente para consumir el contenido en una pantalla pequeña.</span><span class="sxs-lookup"><span data-stu-id="85ec5-147">The latest smartphones may render your HTML just as well as a desktop browser, but users will still be forced to zoom and scroll horizontally and vertically to consume your content on a small screen.</span></span> <span data-ttu-id="85ec5-148">Esto está lejos del óptimo.</span><span class="sxs-lookup"><span data-stu-id="85ec5-148">This is far from optimal.</span></span>
        - <span data-ttu-id="85ec5-149">Los dispositivos y los teléfonos de características más antiguos pueden no representar el marcado de forma satisfactoria.</span><span class="sxs-lookup"><span data-stu-id="85ec5-149">Older devices and feature phones may fail to render your markup in a satisfactory way.</span></span>
        - <span data-ttu-id="85ec5-150">Incluso en los dispositivos de tableta más recientes (cuyas pantallas pueden ser tan grandes como las pantallas de portátiles), se aplican reglas de interacción diferentes.</span><span class="sxs-lookup"><span data-stu-id="85ec5-150">Even on the latest tablet devices (whose screens can be as big as laptop screens), different interaction rules apply.</span></span> <span data-ttu-id="85ec5-151">La entrada táctil funciona mejor con botones y vínculos más grandes que se reparten más allá y no hay ninguna manera de mantener el cursor del mouse sobre un menú emergente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-151">Touch-based input works best with larger buttons and links spread further apart, and there's no way to hover a mouse cursor over a fly-out menu.</span></span>
2. <span data-ttu-id="85ec5-152">***Resolver el problema en el cliente* :** con un uso cuidadoso de CSS y la [mejora progresiva](http://en.wikipedia.org/wiki/Progressive_enhancement) , puede crear marcado, estilos y scripts que se adapten a cualquier explorador que los ejecute.</span><span class="sxs-lookup"><span data-stu-id="85ec5-152">***Solve the problem on the client* –** With careful use of CSS and [progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) you can create markup, styles, and scripts that adapt to whatever browser is running them.</span></span> <span data-ttu-id="85ec5-153">Por ejemplo, con [las consultas de medios CSS 3](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), puede crear un diseño de varias columnas que se convierte en un diseño de una sola columna en los dispositivos cuyas pantallas son más estrechas que el umbral seleccionado.</span><span class="sxs-lookup"><span data-stu-id="85ec5-153">For example, with [CSS 3 media queries](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), you could create a multi-column layout that turns into a single column layout on devices whose screens are narrower than a chosen threshold.</span></span> 

    - <span data-ttu-id="85ec5-154">**Ventaja**: optimiza la representación del dispositivo específico en uso, incluso en el caso de dispositivos futuros desconocidos según la pantalla y las características de entrada que tengan.</span><span class="sxs-lookup"><span data-stu-id="85ec5-154">**Advantage**: Optimizes rendering for the specific device in use, even for unknown future devices according to whatever screen and input characteristics they have</span></span>
    - <span data-ttu-id="85ec5-155">**Ventaja**: le permite compartir fácilmente la lógica del lado servidor en todos los tipos de dispositivos: duplicación mínima de código o esfuerzo</span><span class="sxs-lookup"><span data-stu-id="85ec5-155">**Advantage**: Easily lets you share server-side logic across all device types – minimal duplication of code or effort</span></span>
    - <span data-ttu-id="85ec5-156">**Desventaja**: los dispositivos móviles son tan diferentes de los dispositivos de escritorio que realmente desea que las páginas móviles sean completamente diferentes de las páginas de escritorio, mostrando información diferente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-156">**Disadvantage**: Mobile devices are so different from desktop devices that you may really want your mobile pages to be completely different from your desktop pages, showing different information.</span></span> <span data-ttu-id="85ec5-157">Estas variaciones pueden ser ineficaces o imposibles de lograr de forma sólida a través de CSS, en especial teniendo en cuenta cómo los dispositivos más antiguos incoherentes interpretan las reglas de CSS.</span><span class="sxs-lookup"><span data-stu-id="85ec5-157">Such variations can be inefficient or impossible to achieve robustly through CSS alone, especially considering how inconsistently older devices interpret CSS rules.</span></span> <span data-ttu-id="85ec5-158">Esto es especialmente cierto en el caso de los atributos CSS 3.</span><span class="sxs-lookup"><span data-stu-id="85ec5-158">This is particularly true of CSS 3 attributes.</span></span>
    - <span data-ttu-id="85ec5-159">**Desventaja**: no proporciona compatibilidad con la lógica del lado servidor y los flujos de trabajo de distintos dispositivos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-159">**Disadvantage**: Provides no support for varying server-side logic and workflows for different devices.</span></span> <span data-ttu-id="85ec5-160">Por ejemplo, no puede implementar un flujo de trabajo de retirada de carro de la compra simplificado para usuarios móviles por medio de CSS únicamente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-160">You can't, for example, implement a simplified shopping cart checkout workflow for mobile users by means of CSS alone.</span></span>
    - <span data-ttu-id="85ec5-161">**Desventaja**: uso de ancho de banda ineficaz.</span><span class="sxs-lookup"><span data-stu-id="85ec5-161">**Disadvantage**: Inefficient bandwidth use.</span></span> <span data-ttu-id="85ec5-162">Es posible que el servidor tenga que transmitir el marcado y los estilos que se aplican a todos los dispositivos posibles, aunque el dispositivo de destino solo usará un subconjunto de esa información.</span><span class="sxs-lookup"><span data-stu-id="85ec5-162">You server may have to transmit the markup and styles that apply to all possible devices, even though the target device will only use a subset of that information.</span></span>
3. <span data-ttu-id="85ec5-163">***Solucione el problema en el servidor* :** Si el servidor sabe qué dispositivo está accediendo a él, o al menos las características de ese dispositivo, como el tamaño de pantalla y el método de entrada, y si se trata de un dispositivo móvil, puede ejecutar una lógica diferente y generar un marcado HTML diferente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-163">***Solve the problem on the server* –** If your server knows what device is accessing it – or at least the characteristics of that device, such as its screen size and input method, and whether it's a mobile device – it can run different logic and output different HTML markup.</span></span> 

    - <span data-ttu-id="85ec5-164">**Ventaja:** Flexibilidad máxima.</span><span class="sxs-lookup"><span data-stu-id="85ec5-164">**Advantage:** Maximum flexibility.</span></span> <span data-ttu-id="85ec5-165">No hay ningún límite en cuanto a cuánto puede variar la lógica del lado servidor para dispositivos móviles u optimizar el marcado para el diseño deseado específico del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="85ec5-165">There's no limit to how much you can vary your server-side logic for mobiles or optimize your markup for the desired, device-specific layout.</span></span>
    - <span data-ttu-id="85ec5-166">**Ventaja:** Uso eficaz del ancho de banda.</span><span class="sxs-lookup"><span data-stu-id="85ec5-166">**Advantage:** Efficient bandwidth use.</span></span> <span data-ttu-id="85ec5-167">Solo necesita transmitir el marcado y la información de estilo que el dispositivo de destino va a usar.</span><span class="sxs-lookup"><span data-stu-id="85ec5-167">You only need to transmit the markup and styling information that the target device is going to use.</span></span>
    - <span data-ttu-id="85ec5-168">**Desventaja:** A veces obliga a repetir el trabajo o el código (por ejemplo, creando copias similares pero ligeramente diferentes de las páginas de formularios Web Forms o las vistas de MVC).</span><span class="sxs-lookup"><span data-stu-id="85ec5-168">**Disadvantage:** Sometimes forces repetition of effort or code (e.g., making you create similar but slightly different copies of your Web Forms pages or MVC views).</span></span> <span data-ttu-id="85ec5-169">Siempre que sea posible, se factoriza la lógica común en un nivel o servicio subyacente, pero es posible que algunas partes del código o el marcado de la interfaz de usuario se dupliquen y se mantengan en paralelo.</span><span class="sxs-lookup"><span data-stu-id="85ec5-169">Where possible you will factor out common logic into an underlying layer or service, but still, some parts of your UI code or markup may have to be duplicated and then maintained in parallel.</span></span>
    - <span data-ttu-id="85ec5-170">**Desventaja:** La detección de dispositivos no es trivial.</span><span class="sxs-lookup"><span data-stu-id="85ec5-170">**Disadvantage:** Device detection is not trivial.</span></span> <span data-ttu-id="85ec5-171">Requiere una lista o una base de datos de tipos de dispositivo conocidos y sus características (que puede que no siempre estén bien actualizadas) y no se garantiza que coincidan con precisión con cada solicitud entrante.</span><span class="sxs-lookup"><span data-stu-id="85ec5-171">It requires a list or database of known device types and their characteristics (which may not always be perfectly up-to-date) and isn't guaranteed to accurately match every incoming request.</span></span> <span data-ttu-id="85ec5-172">En este documento se describen algunas opciones y sus problemas más adelante.</span><span class="sxs-lookup"><span data-stu-id="85ec5-172">This document describes some options and their pitfalls later.</span></span>

<span data-ttu-id="85ec5-173">Para obtener los mejores resultados, la mayoría de los desarrolladores tienen que combinar las opciones (2) y (3).</span><span class="sxs-lookup"><span data-stu-id="85ec5-173">To get the best results, most developers find they need to combine options (2) and (3).</span></span> <span data-ttu-id="85ec5-174">Las diferencias estilísticas secundarias se adaptan mejor al cliente mediante CSS o incluso JavaScript, mientras que las principales diferencias en los datos, el flujo de trabajo o el marcado se implementan de forma más eficaz en el código del lado servidor.</span><span class="sxs-lookup"><span data-stu-id="85ec5-174">Minor stylistic differences are best accommodated on the client using CSS or even JavaScript, whereas major differences in data, workflow, or markup are most effectively implemented in server-side code.</span></span>

### <a name="this-paper-focuses-on-server-side-techniques"></a><span data-ttu-id="85ec5-175">Este documento se centra en las técnicas del lado servidor</span><span class="sxs-lookup"><span data-stu-id="85ec5-175">This paper focuses on server-side techniques</span></span>

<span data-ttu-id="85ec5-176">Dado que los formularios Web Forms y MVC de ASP.NET son principalmente tecnologías del lado servidor, estas notas del producto se centrarán en las técnicas de servidor que permiten generar diferentes marcado y lógica para los exploradores móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-176">Since ASP.NET Web Forms and MVC are both primarily server-side technologies, this white paper will focus on server-side techniques that let you produce different markup and logic for mobile browsers.</span></span> <span data-ttu-id="85ec5-177">Por supuesto, también puede combinarlo con cualquier técnica de cliente (por ejemplo, consultas de medios CSS 3, JavaScript de mejora progresiva), pero esto es más importante para el diseño web que el desarrollo de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="85ec5-177">Of course, you can also combine this with any client-side technique (e.g., CSS 3 media queries, progressive-enhancement JavaScript), but that's more a matter of web design than ASP.NET development.</span></span>

## <a name="browser-and-device-detection"></a><span data-ttu-id="85ec5-178">Detección de exploradores y dispositivos</span><span class="sxs-lookup"><span data-stu-id="85ec5-178">Browser and device detection</span></span>

<span data-ttu-id="85ec5-179">El requisito previo de clave para todas las técnicas de servidor para admitir dispositivos móviles es saber qué dispositivo usa el visitante.</span><span class="sxs-lookup"><span data-stu-id="85ec5-179">The key prerequisite for all server-side techniques for supporting mobile devices is to know what device your visitor is using.</span></span> <span data-ttu-id="85ec5-180">De hecho, incluso mejor que conocer el fabricante y el número de modelo de ese dispositivo está conociendo las *características* del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="85ec5-180">In fact, even better than knowing the manufacturer and model number of that device is knowing the *characteristics* of the device.</span></span> <span data-ttu-id="85ec5-181">Las características pueden incluir:</span><span class="sxs-lookup"><span data-stu-id="85ec5-181">Characteristics may include:</span></span>

- <span data-ttu-id="85ec5-182">¿Es un dispositivo móvil?</span><span class="sxs-lookup"><span data-stu-id="85ec5-182">Is it a mobile device?</span></span>
- <span data-ttu-id="85ec5-183">Método de entrada (mouse/teclado, táctil, teclado, joystick,...)</span><span class="sxs-lookup"><span data-stu-id="85ec5-183">Input method (mouse/keyboard, touch, keypad, joystick, …)</span></span>
- <span data-ttu-id="85ec5-184">Tamaño de la pantalla (físicamente y en píxeles)</span><span class="sxs-lookup"><span data-stu-id="85ec5-184">Screen size (physically and in pixels)</span></span>
- <span data-ttu-id="85ec5-185">Formatos de datos y medios admitidos</span><span class="sxs-lookup"><span data-stu-id="85ec5-185">Supported media and data formats</span></span>
- <span data-ttu-id="85ec5-186">Etc.</span><span class="sxs-lookup"><span data-stu-id="85ec5-186">Etc.</span></span>

<span data-ttu-id="85ec5-187">Es mejor tomar decisiones en función de las características que el número de modelo, ya que, de este modo, estará mejor equipado para controlar futuros dispositivos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-187">It's better to make decisions based on characteristics than model number, because then you'll be better equipped to handle future devices.</span></span>

### <a name="using-aspnets-built-in-browser-detection-support"></a><span data-ttu-id="85ec5-188">Mediante ASP. Compatibilidad con la detección integrada del explorador de la red</span><span class="sxs-lookup"><span data-stu-id="85ec5-188">Using ASP.NET's built-in browser detection support</span></span>

<span data-ttu-id="85ec5-189">Los desarrolladores de formularios Web Forms de ASP.NET y MVC pueden detectar inmediatamente características importantes de un explorador visitante mediante la inspección de las propiedades del objeto *request. Browser* .</span><span class="sxs-lookup"><span data-stu-id="85ec5-189">ASP.NET Web Forms and MVC developers can immediately discover important characteristics of a visiting browser by inspecting properties of the *Request.Browser* object.</span></span> <span data-ttu-id="85ec5-190">Por ejemplo, vea</span><span class="sxs-lookup"><span data-stu-id="85ec5-190">For example, see</span></span>

- <span data-ttu-id="85ec5-191">Request.Browser.IsMobileDevice</span><span class="sxs-lookup"><span data-stu-id="85ec5-191">Request.Browser.IsMobileDevice</span></span>
- <span data-ttu-id="85ec5-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span><span class="sxs-lookup"><span data-stu-id="85ec5-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span></span>
- <span data-ttu-id="85ec5-193">Request.Browser.ScreenPixelsWidth</span><span class="sxs-lookup"><span data-stu-id="85ec5-193">Request.Browser.ScreenPixelsWidth</span></span>
- <span data-ttu-id="85ec5-194">Request.Browser.SupportsXmlHttp</span><span class="sxs-lookup"><span data-stu-id="85ec5-194">Request.Browser.SupportsXmlHttp</span></span>
- <span data-ttu-id="85ec5-195">...y muchos otros</span><span class="sxs-lookup"><span data-stu-id="85ec5-195">…and many others</span></span>

<span data-ttu-id="85ec5-196">En segundo plano, la plataforma ASP.NET coincide con el encabezado HTTP de *agente de usuario* (UA) entrante con expresiones regulares en un conjunto de archivos XML de definición de explorador.</span><span class="sxs-lookup"><span data-stu-id="85ec5-196">Behind the scenes, the ASP.NET platform matches the incoming *User-Agent* (UA) HTTP header against regular expressions in a set of Browser Definition XML files.</span></span> <span data-ttu-id="85ec5-197">De forma predeterminada, la plataforma incluye definiciones para muchos dispositivos móviles comunes y puede Agregar archivos de definición de explorador personalizados para los demás usuarios que desee reconocer.</span><span class="sxs-lookup"><span data-stu-id="85ec5-197">By default the platform includes definitions for many common mobile devices, and you can add custom Browser Definition files for others you wish to recognize.</span></span> <span data-ttu-id="85ec5-198">Para obtener más información, vea la página de MSDN [ASP.net controles de servidor Web y capacidades del explorador](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span><span class="sxs-lookup"><span data-stu-id="85ec5-198">For more details, see the MSDN page [ASP.NET Web Server Controls and Browser Capabilities](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span></span>

### <a name="using-the-wurfl-device-database-via-51degreesmobi-foundation"></a><span data-ttu-id="85ec5-199">Usar la base de datos de dispositivos WURFL a través de 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="85ec5-199">Using the WURFL device database via 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="85ec5-200">While ASP. La compatibilidad con la detección integrada del explorador de la red será suficiente para muchas aplicaciones. hay dos casos principales en los que es posible que no sea suficiente:</span><span class="sxs-lookup"><span data-stu-id="85ec5-200">While ASP.NET's built-in browser detection support will be sufficient for many applications, there are two main cases when it might not be enough:</span></span>

- <span data-ttu-id="85ec5-201">***Quiere reconocer los dispositivos más recientes***(sin crear manualmente los archivos de definición del explorador).</span><span class="sxs-lookup"><span data-stu-id="85ec5-201">***You want to recognize the latest devices***(without manually creating Browser Definition files for them).</span></span> <span data-ttu-id="85ec5-202">Tenga en cuenta que los archivos de definición del explorador de .NET 4 no son lo suficientemente recientes para reconocer Windows Phone 7, teléfonos Android, exploradores de Operating Mobile o Apple iPad.</span><span class="sxs-lookup"><span data-stu-id="85ec5-202">Note that .NET 4's Browser Definition files are not recent enough to recognize Windows Phone 7, Android phones, Opera Mobile browsers, or Apple iPads.</span></span>
- <span data-ttu-id="85ec5-203">***Necesita información más detallada sobre las funcionalidades del dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="85ec5-203">***You need more detailed information about device capabilities***.</span></span> <span data-ttu-id="85ec5-204">Es posible que tenga que conocer el método de entrada de un dispositivo (por ejemplo, Touch vs teclado) o los formatos de audio que admite el explorador.</span><span class="sxs-lookup"><span data-stu-id="85ec5-204">You may need to know about a device's input method (e.g., touch vs keypad), or what audio formats the browser supports.</span></span> <span data-ttu-id="85ec5-205">Esta información no está disponible en los archivos de definición de explorador estándar.</span><span class="sxs-lookup"><span data-stu-id="85ec5-205">This information isn't available in the standard Browser Definition files.</span></span>

<span data-ttu-id="85ec5-206">El [proyecto de *archivo de recursos universal inalámbrico* (wurfl)](http://wurfl.sourceforge.net/) mantiene información más actualizada y detallada acerca de los dispositivos móviles que se usan hoy en día.</span><span class="sxs-lookup"><span data-stu-id="85ec5-206">The [*Wireless Universal Resource File* (WURFL) project](http://wurfl.sourceforge.net/) maintains much more up-to-date and detailed information about mobile devices in use today.</span></span>

<span data-ttu-id="85ec5-207">La gran noticia para los desarrolladores de .NET es que ASP. La característica de detección de exploradores de red es extensible, por lo que es posible mejorarla para solucionar estos problemas.</span><span class="sxs-lookup"><span data-stu-id="85ec5-207">The great news for .NET developers is that ASP.NET's browser detection feature is extensible, so it's possible to enhance it to overcome these problems.</span></span> <span data-ttu-id="85ec5-208">Por ejemplo, puede Agregar la biblioteca de código abierto [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) Library al proyecto.</span><span class="sxs-lookup"><span data-stu-id="85ec5-208">For example, you can add the open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) library to your project.</span></span> <span data-ttu-id="85ec5-209">Es un proveedor de funciones de ASP.NET o IHttpModule (utilizable en formularios Web Forms y aplicaciones MVC) que lee directamente los datos de WURFL y los enlaza a ASP. Mecanismo de detección de explorador integrado de la red.</span><span class="sxs-lookup"><span data-stu-id="85ec5-209">It's an ASP.NET IHttpModule or Browser Capabilities Provider (usable on both Web Forms and MVC applications), that directly reads WURFL data and hooks it into ASP.NET's built-in browser detection mechanism.</span></span> <span data-ttu-id="85ec5-210">Una vez que haya instalado el módulo, *request. Browser* contendrá una información mucho más precisa y detallada: reconocerá correctamente muchos de los dispositivos mencionados anteriormente y mostrará sus capacidades (incluidas otras funcionalidades como el método de entrada).</span><span class="sxs-lookup"><span data-stu-id="85ec5-210">Once you've installed the module, *Request.Browser* will suddenly contain a lot more accurate and detailed information: it will correctly recognize many of the devices previously mentioned and list their capabilities (including additional capabilities such as input method).</span></span> <span data-ttu-id="85ec5-211">Consulte la documentación del proyecto para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-211">See the project's documentation for more details.</span></span>

## <a name="how-web-forms-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="85ec5-212">Cómo pueden las aplicaciones de Web Forms presentar páginas específicas para dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-212">How Web Forms applications can present mobile-specific pages</span></span>

<span data-ttu-id="85ec5-213">De forma predeterminada, este es el modo en que se muestra una nueva aplicación de formularios Web Forms en dispositivos móviles comunes:</span><span class="sxs-lookup"><span data-stu-id="85ec5-213">By default, here's how a brand new Web Forms application displays on common mobile devices:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image1.png)

<span data-ttu-id="85ec5-214">Claramente, ninguno de los diseños tiene un aspecto muy descriptivo: esta página se diseñó para un monitor grande, orientado a horizontal, no para una pequeña pantalla orientada verticalmente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-214">Clearly, neither layout looks very mobile-friendly – this page was designed for a large, landscape-oriented monitor, not for a small portrait-oriented screen.</span></span> <span data-ttu-id="85ec5-215">¿Qué puede hacer al respecto?</span><span class="sxs-lookup"><span data-stu-id="85ec5-215">So what can you do about it?</span></span>

<span data-ttu-id="85ec5-216">Como se explicó anteriormente en este documento, hay muchas maneras de adaptar las páginas para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-216">As discussed earlier in this paper, there are many ways to tailor your pages for mobile devices.</span></span> <span data-ttu-id="85ec5-217">Algunas técnicas se basan en el servidor y otras se ejecutan en el cliente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-217">Some techniques are server-based, others run on the client.</span></span>

### <a name="creating-a-mobile-specific-master-page"></a><span data-ttu-id="85ec5-218">Crear una página maestra específica para dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-218">Creating a mobile-specific master page</span></span>

<span data-ttu-id="85ec5-219">En función de sus requisitos, puede usar los mismos formularios Web para todos los visitantes, pero tener dos páginas maestras independientes: una para los visitantes del escritorio, otra para los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-219">Depending on your requirements, you may be able to use the same Web Forms for all visitors, but have two separate master pages: one for desktop visitors, another for mobile visitors.</span></span> <span data-ttu-id="85ec5-220">Esto le ofrece la flexibilidad de cambiar la hoja de estilos CSS o el marcado HTML de nivel superior para adaptarse a los dispositivos móviles, sin obligarle a duplicar la lógica de la página.</span><span class="sxs-lookup"><span data-stu-id="85ec5-220">This gives you the flexibility of changing the CSS stylesheet or your top-level HTML markup to suit mobile devices, without forcing you to duplicate any page logic.</span></span>

<span data-ttu-id="85ec5-221">Esto es fácil de hacer.</span><span class="sxs-lookup"><span data-stu-id="85ec5-221">This is easy to do.</span></span> <span data-ttu-id="85ec5-222">Por ejemplo, puede Agregar un controlador de PreInit como el siguiente a un formulario web:</span><span class="sxs-lookup"><span data-stu-id="85ec5-222">For example, you can add a PreInit handler such as the following to a Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample1.cs)]

<span data-ttu-id="85ec5-223">Ahora, cree una página maestra denominada Mobile. Master en la carpeta de nivel superior de la aplicación y se usará cuando se detecte un dispositivo móvil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-223">Now, create a master page called Mobile.Master in the top-level folder of your application, and it will be used when a mobile device is detected.</span></span> <span data-ttu-id="85ec5-224">Si es necesario, la página maestra móvil puede hacer referencia a una hoja de estilos CSS específica del móvil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-224">Your mobile master page can reference a mobile-specific CSS stylesheet if necessary.</span></span> <span data-ttu-id="85ec5-225">Los visitantes del escritorio seguirán viendo la página maestra predeterminada, no la del móvil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-225">Desktop visitors will still see your default master page, not the mobile one.</span></span>

### <a name="creating-independent-mobile-specific-web-forms"></a><span data-ttu-id="85ec5-226">Creación de formularios Web Forms específicos para móviles independientes</span><span class="sxs-lookup"><span data-stu-id="85ec5-226">Creating independent mobile-specific Web Forms</span></span>

<span data-ttu-id="85ec5-227">Para obtener la máxima flexibilidad, puede profundizar mucho más que simplemente tener páginas maestras independientes para diferentes tipos de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-227">For maximum flexibility, you can go much further than just having separate master pages for different device types.</span></span> <span data-ttu-id="85ec5-228">Puede implementar dos *conjuntos totalmente independientes de páginas de formularios Web Forms* : uno para los exploradores de escritorio y otro para los móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-228">You can implement two *totally separate sets of Web Forms pages* – one set for desktop browsers, another set for mobiles.</span></span> <span data-ttu-id="85ec5-229">Esto funciona mejor si desea presentar información o flujos de trabajo muy diferentes a los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-229">This works best if you want to present very different information or workflows to mobile visitors.</span></span> <span data-ttu-id="85ec5-230">En el resto de esta sección se describe detalladamente este enfoque.</span><span class="sxs-lookup"><span data-stu-id="85ec5-230">The rest of this section describes this approach in detail.</span></span>

<span data-ttu-id="85ec5-231">Suponiendo que ya tiene una aplicación de formularios Web Forms diseñada para los exploradores de escritorio, la manera más fácil de proceder es crear una subcarpeta denominada "móvil" dentro del proyecto y crear las páginas móviles allí.</span><span class="sxs-lookup"><span data-stu-id="85ec5-231">Assuming you already have a Web Forms application designed for desktop browsers, the easiest way to proceed is to create a subfolder called "Mobile" within your project, and build your mobile pages there.</span></span> <span data-ttu-id="85ec5-232">Puede crear un subsitio completo, con sus propias páginas maestras, hojas de estilos y páginas, con las mismas técnicas que usaría para cualquier otra aplicación de formularios Web Forms.</span><span class="sxs-lookup"><span data-stu-id="85ec5-232">You can construct an entire sub-site, with its own master pages, style sheets, and pages, using all the same techniques that you'd use for any other Web Forms application.</span></span> <span data-ttu-id="85ec5-233">No tiene que generar necesariamente un equivalente móvil para *cada* página del sitio de escritorio; puede elegir qué subconjunto de funcionalidad tiene sentido para los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-233">You don't necessarily need to produce a mobile equivalent for *every* page in your desktop site; you can choose what subset of functionality makes sense for mobile visitors.</span></span>

<span data-ttu-id="85ec5-234">Las páginas móviles pueden compartir recursos estáticos comunes (como imágenes, JavaScript o archivos CSS) con las páginas normales, si así lo desea.</span><span class="sxs-lookup"><span data-stu-id="85ec5-234">Your mobile pages can share common static resources (such as images, JavaScript, or CSS files) with your regular pages if you wish.</span></span> <span data-ttu-id="85ec5-235">Dado que la carpeta "móvil" *no* se marcará como una aplicación independiente cuando se hospeda en IIS (es simplemente una subcarpeta simple de páginas de formularios Web Forms), también compartirá la misma configuración, los mismos datos de sesión y otras infraestructuras que las páginas de escritorio.</span><span class="sxs-lookup"><span data-stu-id="85ec5-235">Since your "Mobile" folder will *not* be marked as a separate application when hosted in IIS (it's just a simple subfolder of Web Forms pages), it will also share all the same configuration, Session data, and other infrastructure as your desktop pages.</span></span>

> [!NOTE]
> <span data-ttu-id="85ec5-236">Dado que este enfoque normalmente implica la duplicación de código (es probable que las páginas móviles compartan algunas similitudes con las páginas de escritorio), es importante factorizar cualquier lógica de negocios común o el código de acceso a datos en una capa o servicio compartido subyacente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-236">Since this approach usually involves some duplication of code (mobile pages are likely to share some similarities with desktop pages), it's important to factor out any common business logic or data access code into a shared underlying layer or service.</span></span> <span data-ttu-id="85ec5-237">De lo contrario, se duplicará el esfuerzo de crear y mantener la aplicación.</span><span class="sxs-lookup"><span data-stu-id="85ec5-237">Otherwise, you'll double the effort of creating and maintaining your application.</span></span>

#### <a name="redirecting-mobile-visitors-to-your-mobile-pages"></a><span data-ttu-id="85ec5-238">Redirigir a los visitantes móviles a las páginas móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-238">Redirecting mobile visitors to your mobile pages</span></span>

<span data-ttu-id="85ec5-239">A menudo es conveniente redirigir a los visitantes móviles a las páginas móviles solo en la *primera* solicitud de su sesión de exploración (y no en todas las solicitudes de su sesión), porque:</span><span class="sxs-lookup"><span data-stu-id="85ec5-239">It's often convenient to redirect mobile visitors to the mobile pages only on the *first* request in their browsing session (and not on every request in their session), because:</span></span>

- <span data-ttu-id="85ec5-240">Después, puede permitir que los visitantes móviles accedan fácilmente a las páginas de escritorio si lo desean: solo tiene que colocar un vínculo en la página maestra que vaya a "versión de escritorio".</span><span class="sxs-lookup"><span data-stu-id="85ec5-240">You can then easily allow mobile visitors to access your desktop pages if they wish – just put a link on your master page that goes to "Desktop version".</span></span> <span data-ttu-id="85ec5-241">El visitante no se redirigirá de nuevo a una página móvil, ya que ya no es la primera solicitud de su sesión.</span><span class="sxs-lookup"><span data-stu-id="85ec5-241">The visitor won't be redirected back to a mobile page, because it's no longer the first request in their session.</span></span>
- <span data-ttu-id="85ec5-242">Evita el riesgo de interferir con las solicitudes de los recursos dinámicos compartidos entre los elementos móviles y de escritorio del sitio (por ejemplo, si tiene un formulario web común que los componentes de escritorio y móviles del sitio se muestran en un IFRAME, o algunos controladores Ajax).</span><span class="sxs-lookup"><span data-stu-id="85ec5-242">It avoids the risk of interfering with requests for any dynamic resources shared between desktop and mobile parts of your site (e.g., if you have a common Web Form that both desktop and mobile parts of your site display in an IFRAME, or certain Ajax handlers)</span></span>

<span data-ttu-id="85ec5-243">Para ello, puede colocar la lógica de redirección en una **sesión\_** método de inicio.</span><span class="sxs-lookup"><span data-stu-id="85ec5-243">To do this, you can place your redirection logic in a **Session\_Start** method.</span></span> <span data-ttu-id="85ec5-244">Por ejemplo, agregue el método siguiente al archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="85ec5-244">For example, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample2.cs)]

#### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="85ec5-245">Configuración de la autenticación de formularios para respetar las páginas móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-245">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="85ec5-246">Tenga en cuenta que la autenticación mediante formularios realiza determinadas suposiciones sobre dónde puede redirigir a los visitantes durante y después del proceso de autenticación:</span><span class="sxs-lookup"><span data-stu-id="85ec5-246">Note that Forms Authentication makes certain assumptions about where it can redirect visitors during and after the authentication process:</span></span>

- <span data-ttu-id="85ec5-247">Cuando un usuario debe autenticarse, la autenticación de formularios los redirigirá a la página de inicio de sesión de escritorio, independientemente de si es un usuario de escritorio o móvil (porque solo tiene un concepto de *una* dirección URL de inicio de sesión).</span><span class="sxs-lookup"><span data-stu-id="85ec5-247">When a user needs to be authenticated, Forms Authentication will redirect them to your desktop login page, regardless of whether they're a desktop or mobile user (because it only has a concept of *one* login URL).</span></span> <span data-ttu-id="85ec5-248">Suponiendo que desea aplicar estilo a la página de inicio de sesión móvil de forma diferente, debe mejorar la página de inicio de sesión de escritorio para que redirija a los usuarios móviles a una página de inicio de sesión móvil independiente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-248">Assuming you want to style your mobile login page differently, you need to enhance your desktop login page so that it redirects mobile users to a separate mobile login page.</span></span> <span data-ttu-id="85ec5-249">Por ejemplo, agregue el código siguiente al código subyacente de la página de inicio de sesión de **escritorio** :</span><span class="sxs-lookup"><span data-stu-id="85ec5-249">For example, add the following code to your **desktop** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample3.cs)]
- <span data-ttu-id="85ec5-250">Después de que un usuario inicie sesión correctamente, la autenticación de formularios redirigirá de forma predeterminada a la Página principal del escritorio (porque solo tiene un concepto de *una* página predeterminada).</span><span class="sxs-lookup"><span data-stu-id="85ec5-250">After a user successfully logs in, Forms Authentication will by default redirect them to your desktop home page (because it only has a concept of *one* default page).</span></span> <span data-ttu-id="85ec5-251">Debe mejorar la página de inicio de sesión móvil para que redirija a la Página principal móvil después de un inicio de sesión correcto.</span><span class="sxs-lookup"><span data-stu-id="85ec5-251">You need to enhance your mobile login page so that it redirects to the mobile home page after a successful log-in.</span></span> <span data-ttu-id="85ec5-252">Por ejemplo, agregue el código siguiente al código subyacente de la página de inicio de sesión **móvil** :</span><span class="sxs-lookup"><span data-stu-id="85ec5-252">For example, add the following code to your **mobile** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample4.cs)]
  
  <span data-ttu-id="85ec5-253">En este código se supone que la página tiene un control de servidor de inicio de sesión denominado LoginUser, como en la plantilla de proyecto predeterminada.</span><span class="sxs-lookup"><span data-stu-id="85ec5-253">This code assumes your page has a Login server control called LoginUser, as in the default project template.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="85ec5-254">Trabajar con el almacenamiento en caché de resultados</span><span class="sxs-lookup"><span data-stu-id="85ec5-254">Working with Output Caching</span></span>

<span data-ttu-id="85ec5-255">Si usa el almacenamiento en caché de resultados, tenga en cuidado que, de forma predeterminada, es posible que un usuario de escritorio visite una determinada dirección URL (lo que hace que su salida se almacene en caché), seguida de un usuario móvil que recibe la salida del escritorio almacenado en caché.</span><span class="sxs-lookup"><span data-stu-id="85ec5-255">If you're using output caching, beware that by default it's possible for a desktop user to visit a certain URL (causing its output to be cached), followed by a mobile user who then receives the cached desktop output.</span></span> <span data-ttu-id="85ec5-256">Esta advertencia se aplica tanto si solo está modificando la página maestra por tipo de dispositivo, como si implementa formularios Web Forms totalmente independientes por tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="85ec5-256">This warning applies whether you're just varying your master page by device type, or implementing totally separate Web Forms per device type.</span></span>

<span data-ttu-id="85ec5-257">Para evitar el problema, puede indicar a ASP.NET que varíe la entrada de la memoria caché según si el visitante usa un dispositivo móvil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-257">To avoid the problem, you can instruct ASP.NET to vary the cache entry according to whether the visitor is using a mobile device.</span></span> <span data-ttu-id="85ec5-258">Agregue un parámetro VaryByCustom a la declaración OutputCache de la página como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="85ec5-258">Add a VaryByCustom parameter to your page's OutputCache declaration as follows:</span></span>

[!code-aspx[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample5.aspx)]

<span data-ttu-id="85ec5-259">A continuación, defina *isMobileDevice* como parámetro de caché personalizado agregando la siguiente invalidación de método al archivo global.asax.CS:</span><span class="sxs-lookup"><span data-stu-id="85ec5-259">Next, define *isMobileDevice* as a custom cache parameter by adding the following method override to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample6.cs)]

<span data-ttu-id="85ec5-260">Esto garantizará que los visitantes móviles de la página no reciban la salida previamente colocada en la memoria caché por un visitante del escritorio.</span><span class="sxs-lookup"><span data-stu-id="85ec5-260">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="85ec5-261">Un ejemplo funcional</span><span class="sxs-lookup"><span data-stu-id="85ec5-261">A working example</span></span>

<span data-ttu-id="85ec5-262">Para ver estas técnicas en acción, descargue los [ejemplos de código de este documento](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="85ec5-262">To see these techniques in action, download [this white paper's code samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="85ec5-263">La aplicación de ejemplo de formularios Web Forms redirige automáticamente a los usuarios móviles a un conjunto de páginas específicas de dispositivos móviles en una subcarpeta denominada móvil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-263">The Web Forms sample application automatically redirects mobile users to a set of mobile-specific pages in a subfolder called Mobile.</span></span> <span data-ttu-id="85ec5-264">El marcado y el estilo de esas páginas están optimizados mejor para los exploradores móviles, como puede ver en las siguientes capturas de pantallas:</span><span class="sxs-lookup"><span data-stu-id="85ec5-264">The markup and styling of those pages is better optimized for mobile browsers, as you can see from the following screenshots:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image2.png)

<span data-ttu-id="85ec5-265">Para obtener más sugerencias sobre cómo optimizar el marcado y CSS para exploradores móviles, vea la sección "aplicar estilos a páginas móviles para exploradores móviles" más adelante en este documento.</span><span class="sxs-lookup"><span data-stu-id="85ec5-265">For more tips about optimizing your markup and CSS for mobile browsers, see the section "Styling mobile pages for mobile browsers" later in this document.</span></span>

## <a name="how-aspnet-mvc-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="85ec5-266">Cómo pueden las aplicaciones MVC de ASP.NET presentar páginas específicas para móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-266">How ASP.NET MVC applications can present mobile-specific pages</span></span>

<span data-ttu-id="85ec5-267">Dado que el patrón modelo-vista-controlador separa la lógica de la aplicación (en los controladores) de la lógica de presentación (en vistas), puede elegir cualquiera de los métodos siguientes para controlar la compatibilidad con dispositivos móviles en el código del servidor:</span><span class="sxs-lookup"><span data-stu-id="85ec5-267">Since the Model-View-Controller pattern decouples application logic (in controllers) from presentation logic (in views), you can choose from any of the following approaches to handling mobile support in server-side code:</span></span>

1. <span data-ttu-id="85ec5-268">\*\**utilizan los mismos controladores y vistas para los exploradores de escritorio y móviles, pero representan las vistas con diseños de Razor diferentes en función del tipo de dispositivo *.**</span><span class="sxs-lookup"><span data-stu-id="85ec5-268">\***Use the same controllers and views for both desktop and mobile browsers, but render the views with different Razor layouts depending on the device type\*.**</span></span> <span data-ttu-id="85ec5-269">Esta opción funciona mejor si muestra datos idénticos en todos los dispositivos, pero simplemente desea proporcionar diferentes hojas de estilos CSS o cambiar algunos elementos HTML de nivel superior para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-269">This option works best if you're displaying identical data on all devices, but simply want to supply different CSS stylesheets or change a few top-level HTML elements for mobiles.</span></span>
2. <span data-ttu-id="85ec5-270">***Use los mismos controladores para los exploradores de escritorio y móviles, pero represente vistas diferentes según el tipo de dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="85ec5-270">***Use the same controllers for both desktop and mobile browsers, but render different views depending on the device type***.</span></span> <span data-ttu-id="85ec5-271">Esta opción funciona mejor si se muestran aproximadamente los mismos datos y se proporcionan los mismos flujos de trabajo para los usuarios finales, pero se desea representar un marcado HTML muy diferente para adaptarse al dispositivo que se está usando.</span><span class="sxs-lookup"><span data-stu-id="85ec5-271">This option works best if you're displaying roughly the same data and providing the same workflows for end users, but want to render very different HTML markup to suit the device being used.</span></span>
3. <span data-ttu-id="85ec5-272">\*\**crear áreas independientes para exploradores móviles y de escritorio, implementando controladores independientes y vistas para cada *.**</span><span class="sxs-lookup"><span data-stu-id="85ec5-272">\***Create separate areas for desktop and mobile browsers, implementing independent controllers and views for each\*.**</span></span> <span data-ttu-id="85ec5-273">Esta opción funciona mejor si se muestran pantallas muy diferentes, que contienen información diferente y que conducen al usuario a través de diferentes flujos de trabajo optimizados para su tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="85ec5-273">This option works best if you're displaying very different screens, containing different information and leading the user through different workflows optimized for their device type.</span></span> <span data-ttu-id="85ec5-274">Puede significar alguna repetición del código, pero puede minimizarlo mediante la división de la lógica común en una capa o servicio subyacente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-274">It may mean some repetition of code, but you can minimize that by factoring out common logic into an underlying layer or service.</span></span>

<span data-ttu-id="85ec5-275">Si desea tomar la **primera** opción y variar solo el diseño de Razor por tipo de dispositivo, es muy fácil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-275">If you want to take the **first** option and vary only the Razor layout per device type, it's very easy.</span></span> <span data-ttu-id="85ec5-276">Solo tiene que modificar el archivo \_ViewStart. cshtml de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="85ec5-276">Just modify your \_ViewStart.cshtml file as follows:</span></span>

[!code-cshtml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample7.cshtml)]

<span data-ttu-id="85ec5-277">Ahora puede crear un diseño específico para móviles denominado \_LayoutMobile. cshtml con una estructura de página y reglas CSS optimizadas para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-277">Now you can create a mobile-specific layout called \_LayoutMobile.cshtml with a page structure and CSS rules optimized for mobile devices.</span></span>

<span data-ttu-id="85ec5-278">Si desea que la **segunda** opción represente vistas totalmente diferentes según el tipo de dispositivo del visitante, consulte la [entrada de blog de Scott Hanselman](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span><span class="sxs-lookup"><span data-stu-id="85ec5-278">If you want to take the **second** option render totally different views according to the visitor's device type, see [Scott Hanselman's blog post](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span></span>

<span data-ttu-id="85ec5-279">El resto de este documento se centra en la **tercera** opción: crear controladores *y* vistas independientes para dispositivos móviles, por lo que puede controlar exactamente qué subconjunto de funcionalidad se ofrece para los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-279">The rest of this paper focuses on the **third** option – creating separate controllers *and* views for mobile devices – so you can control exactly what subset of functionality is offered for mobile visitors.</span></span>

### <a name="setting-up-a-mobile-area-within-your-aspnet-mvc-application"></a><span data-ttu-id="85ec5-280">Configuración de un área móvil en la aplicación ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="85ec5-280">Setting up a Mobile area within your ASP.NET MVC application</span></span>

<span data-ttu-id="85ec5-281">Puede Agregar un área denominada "móvil" a una aplicación existente de ASP.NET MVC de la manera normal: haga clic con el botón derecho en el nombre del proyecto en Explorador de soluciones y, a continuación, elija Agregar área de à.</span><span class="sxs-lookup"><span data-stu-id="85ec5-281">You can add an area called "Mobile" to an existing ASP.NET MVC application in the normal way: right-click on your project name in Solution Explorer, then choose Add à Area.</span></span> <span data-ttu-id="85ec5-282">Después, puede agregar controladores y vistas como lo haría con cualquier otra área dentro de una aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="85ec5-282">You can then add controllers and views as you would for any other area within an ASP.NET MVC application.</span></span> <span data-ttu-id="85ec5-283">Por ejemplo, agregue al área móvil un nuevo controlador denominado HomeController para que actúe como una página principal para los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-283">For example, add to your Mobile area a new controller called HomeController to act as a homepage for mobile visitors.</span></span>

### <a name="ensuring-the-url-mobile-reaches-the-mobile-homepage"></a><span data-ttu-id="85ec5-284">Asegurarse de que la dirección URL/Mobile llegue a la Página principal móvil</span><span class="sxs-lookup"><span data-stu-id="85ec5-284">Ensuring the URL /Mobile reaches the mobile homepage</span></span>

<span data-ttu-id="85ec5-285">Si desea que la dirección URL/Mobile llegue a la acción de índice en HomeController dentro del área móvil, deberá realizar dos pequeños cambios en la configuración de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="85ec5-285">If you want the URL /Mobile to reach the Index action on HomeController inside your Mobile area, you will need to make two small changes to your routing configuration.</span></span> <span data-ttu-id="85ec5-286">En primer lugar, actualice la clase MobileAreaRegistration para que HomeController sea el controlador predeterminado en el área móvil, tal como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="85ec5-286">First, update your MobileAreaRegistration class so that HomeController is the default controller in your Mobile area, as shown in the following code:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample8.cs)]

<span data-ttu-id="85ec5-287">Esto significa que la Página principal móvil ahora se encontrará en/Mobile, en lugar de/Mobile/Home, ya que "Home" es ahora el nombre del controlador predeterminado implícitamente para las páginas móviles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-287">This means the mobile homepage will now be located at /Mobile, rather than /Mobile/Home, because "Home" is now the implicitly default controller name for mobile pages.</span></span>

<span data-ttu-id="85ec5-288">A continuación, tenga en cuenta que al agregar un segundo HomeController a la aplicación (es decir, el móvil, además del escritorio existente), habrá interrumpido la Página principal de escritorio normal.</span><span class="sxs-lookup"><span data-stu-id="85ec5-288">Next, note that by adding a second HomeController to your application (i.e., the mobile one, in addition to the existing desktop one), you'll have broken your regular desktop homepage.</span></span> <span data-ttu-id="85ec5-289">Se producirá un error que indica*que se encontraron varios tipos que coinciden con el controlador denominado ' Home '* ".</span><span class="sxs-lookup"><span data-stu-id="85ec5-289">It will fail with the error "*Multiple types were found that match the controller named 'Home'*".</span></span> <span data-ttu-id="85ec5-290">Para resolver este error, actualice la configuración de enrutamiento de nivel superior (en Global.asax.cs) para especificar que el HomeController de escritorio debe tener prioridad cuando haya ambigüedad:</span><span class="sxs-lookup"><span data-stu-id="85ec5-290">To resolve this, update your top-level routing configuration (in Global.asax.cs) to specify that your desktop HomeController should take priority when there's ambiguity:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample9.cs)]

<span data-ttu-id="85ec5-291">Ahora el error desaparecerá y la dirección URL http:\/\/*yoursite*/llegará a la Página principal del escritorio y http:\/\/*yoursite*/Mobile/llegarán a la Página principal de Mobile.</span><span class="sxs-lookup"><span data-stu-id="85ec5-291">Now the error will go away, and the URL http:\/\/*yoursite*/ will reach the desktop homepage, and http:\/\/*yoursite*/mobile/ will reach the mobile homepage.</span></span>

### <a name="redirecting-mobile-visitors-to-your-mobile-area"></a><span data-ttu-id="85ec5-292">Redirigir visitantes móviles a su área móvil</span><span class="sxs-lookup"><span data-stu-id="85ec5-292">Redirecting mobile visitors to your mobile area</span></span>

<span data-ttu-id="85ec5-293">Hay muchos puntos de extensibilidad diferentes en ASP.NET MVC, por lo que hay muchas formas posibles de inyectar la lógica de redirección.</span><span class="sxs-lookup"><span data-stu-id="85ec5-293">There are many different extensibility points in ASP.NET MVC, so there are many possible ways to inject redirection logic.</span></span> <span data-ttu-id="85ec5-294">Una opción ordenada es crear un atributo de filtro, [RedirectMobileDevicesToMobileArea], que realiza una redirección si se cumplen las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="85ec5-294">One neat option is to create a filter attribute, [RedirectMobileDevicesToMobileArea], that performs a redirection if the following conditions are met:</span></span>

1. <span data-ttu-id="85ec5-295">Es la primera solicitud de la sesión del usuario (es decir, Session. IsNewSession es igual a true)</span><span class="sxs-lookup"><span data-stu-id="85ec5-295">It's the first request in the user's session (i.e., Session.IsNewSession equals true)</span></span>
2. <span data-ttu-id="85ec5-296">La solicitud proviene de un explorador móvil (es decir, Request. Browser. IsMobileDevice es igual a true)</span><span class="sxs-lookup"><span data-stu-id="85ec5-296">The request comes from a mobile browser (i.e., Request.Browser.IsMobileDevice equals true)</span></span>
3. <span data-ttu-id="85ec5-297">El usuario todavía no está solicitando un recurso en el área móvil (es decir, la parte de la *ruta de acceso* de la dirección URL no comienza por/Mobile)</span><span class="sxs-lookup"><span data-stu-id="85ec5-297">The user is not already requesting a resource in the mobile area (i.e., the *path* part of the URL does not begin with /Mobile)</span></span>

<span data-ttu-id="85ec5-298">El ejemplo descargable incluido en estas notas del producto incluye una implementación de esta lógica.</span><span class="sxs-lookup"><span data-stu-id="85ec5-298">The downloadable sample included with this white paper includes an implementation of this logic.</span></span> <span data-ttu-id="85ec5-299">Se implementa como un filtro de autorización, que se deriva de AuthorizeAttribute, lo que significa que puede funcionar correctamente incluso si se usa el almacenamiento en caché de resultados (de lo contrario, si un visitante del escritorio accede primero a una dirección URL determinada, la salida del escritorio se podría almacenar en caché y, a continuación, atender a visitantes móviles posteriores).</span><span class="sxs-lookup"><span data-stu-id="85ec5-299">It's implemented as an authorization filter, derived from AuthorizeAttribute, which means it can work correctly even if you are using output caching (otherwise, if a desktop visitor first accesses a certain URL, the desktop output might be cached and then served to subsequent mobile visitors).</span></span>

<span data-ttu-id="85ec5-300">Como filtro, puede elegir aplicarlo a controladores y acciones específicos, por ejemplo,</span><span class="sxs-lookup"><span data-stu-id="85ec5-300">As it's a filter, you can choose either to apply it to specific controllers and actions, e.g.,</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample10.cs)]

<span data-ttu-id="85ec5-301">…</span><span class="sxs-lookup"><span data-stu-id="85ec5-301">…</span></span> <span data-ttu-id="85ec5-302">o bien, puede aplicarlo a todos los controladores y acciones como un *filtro global* de MVC 3 en el archivo global.asax.CS:</span><span class="sxs-lookup"><span data-stu-id="85ec5-302">or you can apply it to all controllers and actions as an MVC 3 *global filter* in your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample11.cs)]

<span data-ttu-id="85ec5-303">En el ejemplo descargable también se muestra cómo puede crear subclases de este atributo que se redirigen a ubicaciones específicas dentro de su área móvil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-303">The downloadable sample also demonstrates how you can create subclasses of this attribute that redirect to specific locations within your mobile area.</span></span> <span data-ttu-id="85ec5-304">Esto significa que, por ejemplo, puede:</span><span class="sxs-lookup"><span data-stu-id="85ec5-304">This means, for example, you can:</span></span>

- <span data-ttu-id="85ec5-305">Registre un filtro global como se muestra arriba que envía a los visitantes móviles a la página de inicio móvil de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="85ec5-305">Register a global filter as shown above that sends mobile visitors to the mobile homepage by default.</span></span>
- <span data-ttu-id="85ec5-306">Aplique también un filtro especial [RedirectMobileDevicesToMobileProductPage] a una acción "ver producto" que lleve a los visitantes móviles a la versión móvil de cualquier página del producto que haya solicitado.</span><span class="sxs-lookup"><span data-stu-id="85ec5-306">Also apply a special [RedirectMobileDevicesToMobileProductPage] filter to a "view product" action that takes mobile visitors to the mobile version of whatever product page they had requested.</span></span>
- <span data-ttu-id="85ec5-307">Aplique también otras subclases especiales del filtro a acciones específicas, redirigiendo a los visitantes móviles a la página móvil equivalente</span><span class="sxs-lookup"><span data-stu-id="85ec5-307">Also apply other special subclasses of the filter to specific actions, redirecting mobile visitors to the equivalent mobile page</span></span>

### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="85ec5-308">Configuración de la autenticación de formularios para respetar las páginas móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-308">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="85ec5-309">Si utiliza la autenticación de formularios, debe tener en cuenta que cuando un usuario necesita iniciar sesión, redirige automáticamente al usuario a una dirección URL de "Inicio de sesión" específica, que de forma predeterminada es **/account/Logon**.</span><span class="sxs-lookup"><span data-stu-id="85ec5-309">If you're using Forms Authentication, you should note that when a user needs to log in, it automatically redirects the user to a single specific "log on" URL, which by default is **/Account/LogOn**.</span></span> <span data-ttu-id="85ec5-310">Esto significa que los usuarios móviles se pueden redirigir a la acción "iniciar sesión" del escritorio.</span><span class="sxs-lookup"><span data-stu-id="85ec5-310">This means that mobile users may be redirected to your desktop "log on" action.</span></span>

<span data-ttu-id="85ec5-311">Para evitar este problema, agregue la lógica a la acción "iniciar sesión" del escritorio para que redirija a los usuarios móviles de nuevo a una acción de inicio de sesión móvil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-311">To avoid this problem, add logic to your desktop "log on" action so that it redirects mobile users again to a mobile "log on" action.</span></span> <span data-ttu-id="85ec5-312">Si está usando la plantilla de aplicación de ASP.NET MVC predeterminada, actualice la acción de inicio de sesión de AccountController como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="85ec5-312">If you're using the default ASP.NET MVC application template, update AccountController's LogOn action as follows:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample12.cs)]

<span data-ttu-id="85ec5-313">…</span><span class="sxs-lookup"><span data-stu-id="85ec5-313">…</span></span> <span data-ttu-id="85ec5-314">y, a continuación, implemente una acción adecuada de "Inicio de sesión" específica de Mobile en un controlador denominado AccountController en su área móvil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-314">and then implement a suitable mobile-specific "log on" action on a controller called AccountController in your Mobile area.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="85ec5-315">Trabajar con el almacenamiento en caché de resultados</span><span class="sxs-lookup"><span data-stu-id="85ec5-315">Working with Output Caching</span></span>

<span data-ttu-id="85ec5-316">Si utiliza el filtro [OutputCache], debe forzar que la entrada de la caché varíe según el tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="85ec5-316">If you're using the [OutputCache] filter, you must force the cache entry to vary by device type.</span></span> <span data-ttu-id="85ec5-317">Por ejemplo, escriba:</span><span class="sxs-lookup"><span data-stu-id="85ec5-317">For example, write:</span></span>

[!code-javascript[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample13.js)]

<span data-ttu-id="85ec5-318">A continuación, agregue el método siguiente al archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="85ec5-318">Then, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample14.cs)]

<span data-ttu-id="85ec5-319">Esto garantizará que los visitantes móviles de la página no reciban la salida previamente colocada en la memoria caché por un visitante del escritorio.</span><span class="sxs-lookup"><span data-stu-id="85ec5-319">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="85ec5-320">Un ejemplo funcional</span><span class="sxs-lookup"><span data-stu-id="85ec5-320">A working example</span></span>

<span data-ttu-id="85ec5-321">Para ver estas técnicas en acción, descargue los [ejemplos asociados de código de este documento](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="85ec5-321">To see these techniques in action, download [this white paper's code associated samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="85ec5-322">El ejemplo incluye una aplicación de ASP.NET MVC 3 (versión candidata) mejorada para admitir dispositivos móviles mediante los métodos descritos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="85ec5-322">The sample includes an ASP.NET MVC 3 (Release Candidate) application enhanced to support mobile devices using the methods described above.</span></span>

## <a name="further-guidance-and-suggestions"></a><span data-ttu-id="85ec5-323">Instrucciones y sugerencias adicionales</span><span class="sxs-lookup"><span data-stu-id="85ec5-323">Further guidance and suggestions</span></span>

<span data-ttu-id="85ec5-324">La siguiente explicación se aplica a los desarrolladores de Web Forms y MVC que usan las técnicas descritas en este documento.</span><span class="sxs-lookup"><span data-stu-id="85ec5-324">The following discussion applies both to Web Forms and MVC developers who are using the techniques covered in this document.</span></span>

### <a name="enhancing-your-redirection-logic-using-51degreesmobi-foundation"></a><span data-ttu-id="85ec5-325">Mejora de la lógica de redirección mediante 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="85ec5-325">Enhancing your redirection logic using 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="85ec5-326">La lógica de redirección que se muestra en este documento puede ser perfectamente suficiente para la aplicación, pero no funcionará si necesita deshabilitar sesiones o con exploradores móviles que rechacen las cookies (no pueden tener sesiones), ya que no sabrá si una solicitud determinada es el primero de ese visitante.</span><span class="sxs-lookup"><span data-stu-id="85ec5-326">The redirection logic shown in this document may be perfectly sufficient for your application, but it won't work if you need to disable sessions, or with mobile browsers that reject cookies (these can't have sessions), because it won't know whether a given request is the first one from that visitor.</span></span>

<span data-ttu-id="85ec5-327">Ya aprendió cómo la base de 51Degrees.mobi de código abierto puede mejorar la precisión de ASP. Detección del explorador de la red.</span><span class="sxs-lookup"><span data-stu-id="85ec5-327">You already learned how the open source 51Degrees.mobi Foundation can improve the accuracy of ASP.NET's browser detection.</span></span> <span data-ttu-id="85ec5-328">También tiene una capacidad integrada para redirigir a los visitantes móviles a ubicaciones específicas configuradas en Web. config. Es capaz de trabajar sin depender de las sesiones de ASP.NET (y, por lo tanto, de las cookies) mediante el almacenamiento de un registro temporal de los valores hash de los encabezados HTTP y las direcciones IP de los visitantes, de modo que sepa si cada solicitud es la primera de un determinado visitador.</span><span class="sxs-lookup"><span data-stu-id="85ec5-328">It also has a built-in ability to redirect mobile visitors to specific locations configured in Web.config. It's able to work without depending on ASP.NET Sessions (and hence cookies) by storing a temporary log of hashes of visitors' HTTP headers and IP addresses, so it knows whether or not each request is the first one from a given vistor.</span></span>

<span data-ttu-id="85ec5-329">El siguiente elemento que se agrega a la sección fiftyOne del archivo Web. config redirigirá la primera solicitud de un dispositivo móvil detectado a la página ~/Mobile/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="85ec5-329">The following element added to the fiftyOne section of the web.config file will redirect the first request from a detected mobile device to the page ~/Mobile/Default.aspx.</span></span> <span data-ttu-id="85ec5-330">*No* se redirigirán las solicitudes a las páginas de la carpeta móvil, independientemente del tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="85ec5-330">Any requests to pages under the Mobile folder will *not* be redirected, regardless of device type.</span></span> <span data-ttu-id="85ec5-331">Si el dispositivo móvil ha estado inactivo durante un período de 20 minutos o más, el dispositivo se olvidará y las solicitudes subsiguientes se tratarán como nuevas para los propósitos de la redirección.</span><span class="sxs-lookup"><span data-stu-id="85ec5-331">If the mobile device has been inactive for a period of 20 minutes or more the device will be forgotten and subsequent requests will be treated as new ones for the purposes of redirection.</span></span>

[!code-xml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample15.xml)]

<span data-ttu-id="85ec5-332">Para obtener más información, consulte la [documentación de 51Degrees.mobi Foundation](https://github.com/51Degrees/dotNET-Device-Detection).</span><span class="sxs-lookup"><span data-stu-id="85ec5-332">For more details, see [51degrees.mobi Foundation documentation](https://github.com/51Degrees/dotNET-Device-Detection).</span></span>

> [!NOTE]
> <span data-ttu-id="85ec5-333">*Puede* usar la característica de redirección de 51Degrees.mobi Foundation en aplicaciones ASP.NET MVC, pero tendrá que definir la configuración de redireccionamiento en términos de direcciones URL sin formato, no en términos de enrutamiento o mediante la colocación de filtros MVC en acciones.</span><span class="sxs-lookup"><span data-stu-id="85ec5-333">You *can* use 51Degrees.mobi Foundation's redirection feature on ASP.NET MVC applications, but you will need to define your redirection configuration in terms of plain URLs, not in terms of routing parameters or by putting MVC filters on actions.</span></span> <span data-ttu-id="85ec5-334">Esto se debe a que, en el momento de la escritura, 51Degrees.mobi Foundation no reconoce filtros ni rutas.</span><span class="sxs-lookup"><span data-stu-id="85ec5-334">This is because (at the time of writing) 51Degrees.mobi Foundation does not recognize filters or routing.</span></span>

### <a name="disabling-transcoders-and-proxy-servers"></a><span data-ttu-id="85ec5-335">Deshabilitar transcodificadores y servidores proxy</span><span class="sxs-lookup"><span data-stu-id="85ec5-335">Disabling Transcoders and Proxy Servers</span></span>

<span data-ttu-id="85ec5-336">Los operadores de red móvil tienen dos objetivos generales en su enfoque para la Internet móvil:</span><span class="sxs-lookup"><span data-stu-id="85ec5-336">Mobile network operators have two broad objectives in their approach to the mobile internet:</span></span>

1. <span data-ttu-id="85ec5-337">Proporcione tanto contenido relevante como sea posible</span><span class="sxs-lookup"><span data-stu-id="85ec5-337">Provide as much relevant content as possible</span></span>
2. <span data-ttu-id="85ec5-338">Maximice el número de clientes que pueden compartir el ancho de banda de red de radio limitado</span><span class="sxs-lookup"><span data-stu-id="85ec5-338">Maximize the number of customers who can share the limited radio network bandwidth</span></span>

<span data-ttu-id="85ec5-339">Dado que la mayoría de las páginas web se diseñaron para pantallas de gran tamaño de escritorio y conexiones de banda ancha de línea fija rápidas, muchos operadores utilizan *transcodificadores* o *servidores proxy* que modifican dinámicamente el contenido Web.</span><span class="sxs-lookup"><span data-stu-id="85ec5-339">Since most web pages were designed for large desktop-sized screens and fast fixed-line broadband connections, many operators use *transcoders* or *proxy servers* that dynamically alter web content.</span></span> <span data-ttu-id="85ec5-340">Pueden modificar el marcado HTML o CSS para adaptarse a pantallas más pequeñas (especialmente para "teléfonos de características" que carecen de la capacidad de procesamiento para administrar diseños complejos) y pueden volver a comprimir las imágenes (lo que reduce significativamente su calidad) para mejorar la velocidad de entrega de páginas.</span><span class="sxs-lookup"><span data-stu-id="85ec5-340">They may modify your HTML markup or CSS to suit smaller screens (especially for "feature phones" that lack the processing power to handle complex layouts), and they may recompress your images (significantly reducing their quality) to improve page delivery speeds.</span></span>

<span data-ttu-id="85ec5-341">Pero si ha realizado el esfuerzo de generar una versión optimizada para dispositivos móviles de su sitio, es probable que no desee que el operador de red interfiera más.</span><span class="sxs-lookup"><span data-stu-id="85ec5-341">But if you've taken the effort to produce a mobile-optimized version of your site, you probably don't want the network operator to interfere with it any further.</span></span> <span data-ttu-id="85ec5-342">Puede Agregar la siguiente línea a la página\_evento Load en cualquier formulario Web ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="85ec5-342">You can add the following line to the Page\_Load event in any ASP.NET Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample16.cs)]

<span data-ttu-id="85ec5-343">O bien, para un controlador ASP.NET MVC, puede Agregar la siguiente invalidación de método para que se aplique a todas las acciones de ese controlador:</span><span class="sxs-lookup"><span data-stu-id="85ec5-343">Or, for an ASP.NET MVC controller, you could add the following method override so that it applies to all actions on that controller:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample17.cs)]

<span data-ttu-id="85ec5-344">El mensaje HTTP resultante informa a los transcodificadores y proxies compatibles con W3C de no modificar el contenido.</span><span class="sxs-lookup"><span data-stu-id="85ec5-344">The resulting HTTP message informs W3C compliant transcoders and proxies not to alter content.</span></span> <span data-ttu-id="85ec5-345">Por supuesto, no hay ninguna garantía de que los operadores de red móvil respeten este mensaje.</span><span class="sxs-lookup"><span data-stu-id="85ec5-345">Of course, there is no guarantee that mobile network operators will respect this message.</span></span>

### <a name="styling-mobile-pages-for-mobile-browsers"></a><span data-ttu-id="85ec5-346">Aplicar estilos a páginas móviles para exploradores móviles</span><span class="sxs-lookup"><span data-stu-id="85ec5-346">Styling mobile pages for mobile browsers</span></span>

<span data-ttu-id="85ec5-347">Queda fuera del ámbito de este documento describir con gran detalle qué tipos de marcado HTML funcionan correctamente o qué técnicas de diseño web maximizan la facilidad de uso en determinados dispositivos.</span><span class="sxs-lookup"><span data-stu-id="85ec5-347">It's beyond the scope of this document to describe in great detail what kinds of HTML markup work correctly or which web design techniques maximize usability on particular devices.</span></span> <span data-ttu-id="85ec5-348">Depende de usted encontrar un diseño suficientemente sencillo, optimizado para una pantalla de tamaño móvil, sin usar trucos de posicionamiento HTML o CSS no confiables.</span><span class="sxs-lookup"><span data-stu-id="85ec5-348">It's up to you to find a sufficiently simple layout, optimized for a mobile-sized screen, without using unreliable HTML or CSS positioning tricks.</span></span> <span data-ttu-id="85ec5-349">Una técnica importante que merece la pena mencionar, sin embargo, es la *etiqueta meta*de la ventanilla.</span><span class="sxs-lookup"><span data-stu-id="85ec5-349">One important technique worth mentioning, however, is the *viewport meta tag*.</span></span>

<span data-ttu-id="85ec5-350">Algunos exploradores móviles modernos, en un esfuerzo muestran páginas Web diseñadas para monitores de escritorio, representan la página en un lienzo virtual, también denominado "ventanilla" (por ejemplo, la ventanilla virtual tiene un ancho de 980 píxeles en el iPhone y 850 píxeles de ancho en Opera Mobile de forma predeterminada) y, a continuación, escale el resultado hacia abajo para ajustarse a los píxeles físicos de la pantalla.</span><span class="sxs-lookup"><span data-stu-id="85ec5-350">Certain modern mobile browsers, in an effort display web pages meant for desktop monitors, render the page on a virtual canvas, also called "viewport" (e.g., the virtual viewport is 980 pixels wide on iPhone, and 850 pixels wide on Opera Mobile by default) and then scale the result down to fit onto the screen's physical pixels.</span></span> <span data-ttu-id="85ec5-351">Después, el usuario puede acercar y desplazarse por la ventanilla.</span><span class="sxs-lookup"><span data-stu-id="85ec5-351">The user can then zoom in and pan around that viewport.</span></span> <span data-ttu-id="85ec5-352">Esto tiene la ventaja de que permite que el explorador muestre la página en su diseño previsto, pero también tiene la desventaja de que fuerza el zoom y la panorámica, lo que no resulta cómodo para el usuario.</span><span class="sxs-lookup"><span data-stu-id="85ec5-352">This has the advantage that it lets the browser display the page in its intended layout, but it's also has the disadvantage that it forces zooming and panning, which is inconvenient for the user.</span></span> <span data-ttu-id="85ec5-353">Si está diseñando para móviles, es mejor diseñar una pantalla estrecha para que no sea necesario hacer zoom o desplazamiento horizontal.</span><span class="sxs-lookup"><span data-stu-id="85ec5-353">If you're designing for mobile, it's better to design for a narrow screen so that no zooming or horizontal scrolling is necessary.</span></span>

<span data-ttu-id="85ec5-354">Una manera de indicar al explorador móvil el ancho que debe tener la ventanilla a través de la etiqueta meta no estándar de la *ventanilla* .</span><span class="sxs-lookup"><span data-stu-id="85ec5-354">A way to tell the mobile browser how wide the viewport should be is through the nonstandard *viewport* meta tag.</span></span> <span data-ttu-id="85ec5-355">Por ejemplo, si agrega lo siguiente a la sección principal de la página,</span><span class="sxs-lookup"><span data-stu-id="85ec5-355">For example, if you add the following to your page's HEAD section,</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample18.html)]

<span data-ttu-id="85ec5-356">…</span><span class="sxs-lookup"><span data-stu-id="85ec5-356">…</span></span> <span data-ttu-id="85ec5-357">a continuación, los exploradores de smartphone diseñarán la página en un lienzo virtual de ancho de 480 píxeles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-357">then supporting smartphone browsers will lay out the page on a 480-pixel wide virtual canvas.</span></span> <span data-ttu-id="85ec5-358">Esto significa que si los elementos HTML definen su ancho en términos porcentuales, los porcentajes se interpretarán con respecto a este ancho de 480 píxeles, no al ancho de la ventanilla predeterminado.</span><span class="sxs-lookup"><span data-stu-id="85ec5-358">This means that if your HTML elements define their widths in percentage terms, the percentages will be interpreted with respect to this 480-pixel width, not the default viewport width.</span></span> <span data-ttu-id="85ec5-359">Como resultado, es menos probable que el usuario tenga que hacer zoom y panorámica horizontalmente, lo que mejora considerablemente la experiencia de exploración móvil.</span><span class="sxs-lookup"><span data-stu-id="85ec5-359">As a result, the user is less likely to have to zoom and pan horizontally – considerably improving the mobile browsing experience.</span></span>

<span data-ttu-id="85ec5-360">Si desea que el ancho de la ventanilla coincida con los píxeles físicos del dispositivo, puede especificar lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="85ec5-360">If you want the viewport width to match the device's physical pixels, you can specify the following:</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample19.html)]

<span data-ttu-id="85ec5-361">Para que esto funcione correctamente, no debe forzar explícitamente que los elementos superen ese ancho (por ejemplo, mediante el uso de un atributo de *ancho* o una propiedad de CSS); de lo contrario, el explorador se verá obligado a usar una ventanilla mayor independientemente de.</span><span class="sxs-lookup"><span data-stu-id="85ec5-361">For this to work correctly, you must not explicitly force elements to exceed that width (e.g., using a *width* attribute or CSS property), otherwise the browser will be forced to use a larger viewport regardless.</span></span> <span data-ttu-id="85ec5-362">Vea también: [más detalles sobre la etiqueta viewport no estándar](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span><span class="sxs-lookup"><span data-stu-id="85ec5-362">See also: [more details about the nonstandard viewport tag](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span></span>

<span data-ttu-id="85ec5-363">La mayoría de los smartphones modernos admiten la *doble orientación*: se pueden mantener en modo vertical u horizontal.</span><span class="sxs-lookup"><span data-stu-id="85ec5-363">Most modern smartphones support *dual orientation*: they can be held in either portrait or landscape mode.</span></span> <span data-ttu-id="85ec5-364">Por lo tanto, es importante no hacer suposiciones sobre el ancho de pantalla en píxeles.</span><span class="sxs-lookup"><span data-stu-id="85ec5-364">So, it's important not to make assumptions about the screen width in pixels.</span></span> <span data-ttu-id="85ec5-365">Ni siquiera Supongamos que el ancho de la pantalla es fijo, ya que el usuario puede volver a orientar el dispositivo mientras está en la página.</span><span class="sxs-lookup"><span data-stu-id="85ec5-365">Don't even assume that the screen width is fixed, because the user can re-orient their device while they are on your page.</span></span>

<span data-ttu-id="85ec5-366">Los dispositivos de Windows Mobile y BlackBerry más antiguos también pueden aceptar las siguientes etiquetas meta en el encabezado de página para informar de que el contenido se ha optimizado para dispositivos móviles y, por tanto, no debe transformarse.</span><span class="sxs-lookup"><span data-stu-id="85ec5-366">Older Windows Mobile and Blackberry devices may also accept the following meta tags in the page header to inform them content has been optimized for mobile and therefore should not be transformed.</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample20.html)]

## <a name="additional-resources"></a><span data-ttu-id="85ec5-367">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="85ec5-367">Additional Resources</span></span>

<span data-ttu-id="85ec5-368">Para obtener una lista de emuladores y simuladores de dispositivos móviles que puede usar para probar la aplicación Web de ASP.NET móvil, consulte la página [simular dispositivos móviles populares para pruebas](../mobile/device-simulators.md).</span><span class="sxs-lookup"><span data-stu-id="85ec5-368">For a list of mobile device emulators and simulators you can use to test your mobile ASP.NET web application, see the page [Simulate popular mobile devices for testing](../mobile/device-simulators.md).</span></span>

## <a name="credits"></a><span data-ttu-id="85ec5-369">Créditos</span><span class="sxs-lookup"><span data-stu-id="85ec5-369">Credits</span></span>

- <span data-ttu-id="85ec5-370">Autor principal: Steven Sanderson</span><span class="sxs-lookup"><span data-stu-id="85ec5-370">Primary author: Steven Sanderson</span></span>
- <span data-ttu-id="85ec5-371">Revisores/escritores de contenido adicionales: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span><span class="sxs-lookup"><span data-stu-id="85ec5-371">Reviewers / additional content writers: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span></span>

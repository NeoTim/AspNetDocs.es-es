---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
title: Agregar columnas adicionales de DataTable (VB) | Microsoft Docs
author: rick-anderson
description: Al usar al Asistente de TableAdapter para crear un conjunto de datos con tipo, la correspondiente DataTable contiene las columnas devueltas por la consulta de base de datos principal. Sin embargo, existen...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 1e8e65f9-fe3e-4250-810b-c90227786bed
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: 969dd42295530396eca4195a8897a5ee93a61bf2
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2019
ms.locfileid: "65133427"
---
# <a name="adding-additional-datatable-columns-vb"></a><span data-ttu-id="3f860-104">Agregar columnas adicionales de DataTable (VB)</span><span class="sxs-lookup"><span data-stu-id="3f860-104">Adding Additional DataTable Columns (VB)</span></span>

<span data-ttu-id="3f860-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3f860-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3f860-106">[Descargar código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) o [descargar PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3f860-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) or [Download PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span></span>

> <span data-ttu-id="3f860-107">Al usar al Asistente de TableAdapter para crear un conjunto de datos con tipo, la correspondiente DataTable contiene las columnas devueltas por la consulta de base de datos principal.</span><span class="sxs-lookup"><span data-stu-id="3f860-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="3f860-108">Pero hay ocasiones cuando la tabla de datos debe incluir columnas adicionales.</span><span class="sxs-lookup"><span data-stu-id="3f860-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="3f860-109">En este tutorial se aprenderá por qué se recomiendan los procedimientos almacenados cuando sea necesario columnas adicionales de DataTable.</span><span class="sxs-lookup"><span data-stu-id="3f860-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="3f860-110">Introducción</span><span class="sxs-lookup"><span data-stu-id="3f860-110">Introduction</span></span>

<span data-ttu-id="3f860-111">Al agregar un TableAdapter a un conjunto de datos con tipo, el esquema de s correspondiente DataTable viene determinada por la consulta principal de TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="3f860-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="3f860-112">Por ejemplo, si la consulta principal devuelve los campos de datos *A*, *B*, y *C*, la DataTable tendrá tres columnas correspondientes denominadas *A*, *B*, y *C*. Además de la consulta principal, un TableAdapter puede incluir consultas adicionales que devuelven, quizás, un subconjunto de los datos en función de algún parámetro.</span><span class="sxs-lookup"><span data-stu-id="3f860-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="3f860-113">Por ejemplo, en además con el `ProductsTableAdapter` consulta principal s, que devuelve información acerca de todos los productos, también contiene métodos como `GetProductsByCategoryID(categoryID)` y `GetProductByProductID(productID)`, que devuelve información de producto específico en función de un parámetro proporcionado.</span><span class="sxs-lookup"><span data-stu-id="3f860-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="3f860-114">El modelo de tener el esquema de DataTable s reflejan la consulta principal de TableAdapter s funciona bien si todos los métodos de TableAdapter s devuelven el mismo o menos campos de datos de aquéllos especificados en la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="3f860-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="3f860-115">Si necesita un método del TableAdapter devolver los campos de datos adicionales, a continuación, nos debemos expanda el esquema de DataTable s en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="3f860-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="3f860-116">En el [maestro/detalle con una lista con viñetas de registros maestros con un control DataList de detalles](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial se ha agregado un método para el `CategoriesTableAdapter` que devuelve el `CategoryID`, `CategoryName`, y `Description` definidos en los campos de datos la consulta principal más `NumberOfProducts`, un campo de datos adicionales que notifica el número de productos asociados con cada categoría.</span><span class="sxs-lookup"><span data-stu-id="3f860-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="3f860-117">Se agrega manualmente una nueva columna a la `CategoriesDataTable` con el fin de capturar la `NumberOfProducts` valor de este nuevo método de campo de datos.</span><span class="sxs-lookup"><span data-stu-id="3f860-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="3f860-118">Como se describe en el [cargar archivos](../working-with-binary-files/uploading-files-vb.md) excelente, tutorial debe tener cuidado con los TableAdapters que utilizan instrucciones SQL ad hoc y tienen métodos cuyos campos de datos no coincide exactamente con la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="3f860-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-vb.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="3f860-119">Si ya se vuelve a ejecutar el Asistente para configuración de TableAdapter, actualizará todos los métodos de TableAdapter s para que su lista de campos de datos coincida con la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="3f860-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="3f860-120">Por lo tanto, cualquier método con listas de columnas personalizadas se revertir a la lista de columnas de la consulta principal s y no devolverá los datos esperados.</span><span class="sxs-lookup"><span data-stu-id="3f860-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="3f860-121">Este problema no ocurre cuando se utilizan procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="3f860-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="3f860-122">En este tutorial veremos cómo ampliar un esquema de DataTable s para incluir columnas adicionales.</span><span class="sxs-lookup"><span data-stu-id="3f860-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="3f860-123">Debido a la fragilidad del TableAdapter al usar instrucciones SQL ad hoc, en este tutorial usaremos los procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="3f860-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="3f860-124">Hacer referencia a la [crear procedimientos almacenados nuevo para la s de conjunto de datos con tipo TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) y [utilizando procedimientos almacenados existentes para la s de conjunto de datos con tipo TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutoriales para obtener más información sobre configuración de un TableAdapter para usar los procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="3f860-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="3f860-125">Paso 1: Agregar un`PriceQuartile`columna a la`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="3f860-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="3f860-126">En el *crear procedimientos almacenados nuevo para la s de conjunto de datos con tipo TableAdapters* tutorial hemos creado un conjunto de datos con tipo denominado `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="3f860-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="3f860-127">Actualmente, este conjunto de datos contiene dos tablas de datos: `ProductsDataTable` y `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="3f860-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="3f860-128">El `ProductsTableAdapter` tiene los tres métodos siguientes:</span><span class="sxs-lookup"><span data-stu-id="3f860-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="3f860-129">`GetProducts` -la consulta principal, que devuelve todos los registros de la `Products` tabla</span><span class="sxs-lookup"><span data-stu-id="3f860-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="3f860-130">`GetProductsByCategoryID(categoryID)` -Devuelve todos los productos con los valores especificados *categoryID*.</span><span class="sxs-lookup"><span data-stu-id="3f860-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="3f860-131">`GetProductByProductID(productID)` -Devuelve el producto específico con los valores especificados *productID*.</span><span class="sxs-lookup"><span data-stu-id="3f860-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="3f860-132">La consulta principal y los dos métodos adicionales devuelven el mismo conjunto de campos de datos, es decir, todas las columnas de la `Products` tabla.</span><span class="sxs-lookup"><span data-stu-id="3f860-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="3f860-133">No hay ningún subconsultas correlacionadas o `JOIN` s extracción de datos relacionados desde el `Categories` o `Suppliers` tablas.</span><span class="sxs-lookup"><span data-stu-id="3f860-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="3f860-134">Por lo tanto, el `ProductsDataTable` tiene una columna correspondiente para cada campo en el `Products` tabla.</span><span class="sxs-lookup"><span data-stu-id="3f860-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="3f860-135">Para este tutorial, s permiten agregar un método para el `ProductsTableAdapter` denominado `GetProductsWithPriceQuartile` que devuelve todos los productos.</span><span class="sxs-lookup"><span data-stu-id="3f860-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="3f860-136">Además de los campos de datos estándar del producto, `GetProductsWithPriceQuartile` también incluirá un `PriceQuartile` campo de datos que se indica en qué cuartil cae el precio del producto s.</span><span class="sxs-lookup"><span data-stu-id="3f860-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="3f860-137">Por ejemplo, aquellos productos cuyos precios se encuentran en el 25% más costoso tendrá un `PriceQuartile` valor 1, mientras que aquellos cuyos precios se encuentran en la parte inferior 25% tendrá un valor de 4.</span><span class="sxs-lookup"><span data-stu-id="3f860-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="3f860-138">Antes de que preocuparse por crear el procedimiento almacenado para devolver esta información, sin embargo, primero es necesario actualizar el `ProductsDataTable` para incluir una columna que contenga el `PriceQuartile` resultados cuando el `GetProductsWithPriceQuartile` se usa el método.</span><span class="sxs-lookup"><span data-stu-id="3f860-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="3f860-139">Abra el `NorthwindWithSprocs` conjunto de datos y haga doble clic en el `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="3f860-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="3f860-140">Elija Agregar en el menú contextual y, a continuación, seleccione la columna.</span><span class="sxs-lookup"><span data-stu-id="3f860-140">Choose Add from the context-menu and then pick Column.</span></span>

<span data-ttu-id="3f860-141">[![Agregar una nueva columna a la ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="3f860-142">**Figura 1**: Agregar una nueva columna a la `ProductsDataTable` ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="3f860-143">Esto agregará una nueva columna a la DataTable denominada Column1 de tipo `System.String`.</span><span class="sxs-lookup"><span data-stu-id="3f860-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="3f860-144">Es necesario actualizar el nombre de la columna s PriceQuartile y su tipo a `System.Int32` desde que se usará para contener un número entre 1 y 4.</span><span class="sxs-lookup"><span data-stu-id="3f860-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="3f860-145">Seleccione la columna recién agregada en el `ProductsDataTable` y, en la ventana Propiedades, establezca la `Name` propiedad PriceQuartile y el `DataType` propiedad `System.Int32`.</span><span class="sxs-lookup"><span data-stu-id="3f860-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>

<span data-ttu-id="3f860-146">[![Establecer las propiedades de tipo de datos y el nuevo nombre de columna s](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="3f860-147">**Figura 2**: Establecer la nueva columna de s `Name` y `DataType` propiedades ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image6.png))</span></span>

<span data-ttu-id="3f860-148">Como se muestra en la figura 2, hay propiedades adicionales que se pueden establecer, por ejemplo, si los valores de la columna deben ser únicos, si la columna es una columna de incremento automático, si la base de datos `NULL` se permiten valores y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="3f860-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="3f860-149">Deje estos valores con sus valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="3f860-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="3f860-150">Paso 2: Crear el`GetProductsWithPriceQuartile`(método)</span><span class="sxs-lookup"><span data-stu-id="3f860-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="3f860-151">Ahora que la `ProductsDataTable` se ha actualizado para incluir la `PriceQuartile` columna, estamos preparados para crear el `GetProductsWithPriceQuartile` método.</span><span class="sxs-lookup"><span data-stu-id="3f860-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="3f860-152">Comience con el botón secundario en TableAdapter y elegir Agregar consulta en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="3f860-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="3f860-153">Se abrirá el Asistente de configuración de la consulta de TableAdapter, que primero nos preguntará si desea usar instrucciones SQL ad hoc o un procedimiento almacenado nuevo o existente.</span><span class="sxs-lookup"><span data-stu-id="3f860-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="3f860-154">Puesto que nos don t aún tiene un procedimiento almacenado que devuelve los datos de precios cuartil, permitir s TableAdapter crear este procedimiento almacenado para nosotros.</span><span class="sxs-lookup"><span data-stu-id="3f860-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="3f860-155">Seleccione la opción de crear nuevo procedimiento almacenado y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="3f860-155">Select the Create new stored procedure option and click Next.</span></span>

<span data-ttu-id="3f860-156">[![Indique al Asistente de TableAdapter para crear el procedimiento almacenado para nosotros](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="3f860-157">**Figura 3**: Indique al Asistente de TableAdapter para crear el almacenado procedimiento para nosotros ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="3f860-158">En la pantalla posteriores, que se muestra en la figura 4, el Asistente nos pregunta a qué tipo de consulta para agregar.</span><span class="sxs-lookup"><span data-stu-id="3f860-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="3f860-159">Puesto que la `GetProductsWithPriceQuartile` método devolverá todas las columnas y los registros desde el `Products` tabla, seleccione el LECT que devuelve filas opción y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="3f860-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>

<span data-ttu-id="3f860-160">[![Nuestra consulta será una instrucción SELECT que devuelve varias filas](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="3f860-161">**Figura 4**: Nuestra consulta será un `SELECT` instrucción que devuelve varias filas ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="3f860-162">A continuación se nos pide la `SELECT` consulta.</span><span class="sxs-lookup"><span data-stu-id="3f860-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="3f860-163">En el asistente, escriba la siguiente consulta:</span><span class="sxs-lookup"><span data-stu-id="3f860-163">Enter the following query into the wizard:</span></span>

[!code-sql[Main](adding-additional-datatable-columns-vb/samples/sample1.sql)]

<span data-ttu-id="3f860-164">La consulta anterior utiliza SQL Server 2005 s nuevo [ `NTILE` función](https://msdn.microsoft.com/library/ms175126.aspx) para dividir los resultados en cuatro grupos donde los grupos están determinados por la `UnitPrice` valores ordenados en orden descendente.</span><span class="sxs-lookup"><span data-stu-id="3f860-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="3f860-165">Lamentablemente, el generador de consultas no sabe cómo analizar el `OVER` palabra clave y se mostrará un error al analizar la consulta anterior.</span><span class="sxs-lookup"><span data-stu-id="3f860-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="3f860-166">Por lo tanto, escribir la consulta anterior directamente en el cuadro de texto en el asistente sin usar el generador de consultas.</span><span class="sxs-lookup"><span data-stu-id="3f860-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="3f860-167">Para obtener más información sobre s NTILE y SQL Server 2005 otras funciones de categoría, vea [devolver resultados de rango con Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) y [sección de funciones de categoría](https://msdn.microsoft.com/library/ms189798.aspx) desde el [SQL Libros en pantalla de Server 2005](https://msdn.microsoft.com/library/ms189798.aspx).</span><span class="sxs-lookup"><span data-stu-id="3f860-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>

<span data-ttu-id="3f860-168">Después de escribir el `SELECT` consulta y haga clic en siguiente, el Asistente nos pide que proporcione un nombre para el procedimiento almacenado que se va a crear.</span><span class="sxs-lookup"><span data-stu-id="3f860-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="3f860-169">Nombre del nuevo procedimiento almacenado `Products_SelectWithPriceQuartile` y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="3f860-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>

<span data-ttu-id="3f860-170">[![Nombre del procedimiento almacenado de Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="3f860-171">**Figura 5**: Nombre del procedimiento almacenado `Products_SelectWithPriceQuartile` ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="3f860-172">Por último, se nos pide un nombre de los métodos de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="3f860-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="3f860-173">Deje ambas rellenar un DataTable y devolver un DataTable casillas de verificación activadas y el nombre de los métodos `FillWithPriceQuartile` y `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3f860-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>

<span data-ttu-id="3f860-174">[![Los métodos nombres TableAdapters y haga clic en Finalizar](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="3f860-175">**Figura 6**: El nombre de los métodos de TableAdapter s y haga clic en Finalizar ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="3f860-176">Con el `SELECT` especificado de la consulta y el procedimiento almacenado y los métodos de TableAdapter con nombre, haga clic en Finalizar para completar el asistente.</span><span class="sxs-lookup"><span data-stu-id="3f860-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="3f860-177">En este momento puede aparecer una advertencia o dos desde el Asistente para la que indica que el `OVER` no se admite la instrucción o construcción de SQL.</span><span class="sxs-lookup"><span data-stu-id="3f860-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="3f860-178">Se pueden omitir estas advertencias.</span><span class="sxs-lookup"><span data-stu-id="3f860-178">These warnings can be ignored.</span></span>

<span data-ttu-id="3f860-179">Después de completar el asistente, debe incluir el TableAdapter los `FillWithPriceQuartile` y `GetProductsWithPriceQuartile` métodos y la base de datos deben incluir un procedimiento almacenado denominado `Products_SelectWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="3f860-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="3f860-180">Dedique un momento para comprobar que el TableAdapter contiene realmente este nuevo método y que el procedimiento almacenado se ha agregado correctamente a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="3f860-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="3f860-181">Al comprobar la base de datos, si no ve el procedimiento almacenado try con los que el botón secundario en la carpeta procedimientos almacenados y elegir la opción actualizar.</span><span class="sxs-lookup"><span data-stu-id="3f860-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>

![Compruebe que se ha agregado un nuevo método a TableAdapter](adding-additional-datatable-columns-vb/_static/image19.png)

<span data-ttu-id="3f860-183">**Figura 7**: Compruebe que se ha agregado un nuevo método a TableAdapter</span><span class="sxs-lookup"><span data-stu-id="3f860-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>

<span data-ttu-id="3f860-184">[![Asegúrese de que la base de datos contiene el Products_SelectWithPriceQuartile procedimiento almacenado](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span></span>

<span data-ttu-id="3f860-185">**Figura 8**: Asegúrese de que la base de datos que contiene el `Products_SelectWithPriceQuartile` Stored Procedure ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="3f860-186">Una de las ventajas de utilizar procedimientos almacenados en lugar de instrucciones SQL ad hoc es que volver a ejecutar al Asistente para configuración de TableAdapter no modificará las listas de columnas de los procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="3f860-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="3f860-187">Puede comprobarlo mediante el botón secundario en TableAdapter, eligiendo la opción de configurar en el menú contextual para iniciar al asistente y, a continuación, haga clic en Finalizar para completarlo.</span><span class="sxs-lookup"><span data-stu-id="3f860-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="3f860-188">A continuación, vaya a la base de datos y ver el `Products_SelectWithPriceQuartile` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="3f860-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="3f860-189">Tenga en cuenta que no se ha modificado su lista de columnas.</span><span class="sxs-lookup"><span data-stu-id="3f860-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="3f860-190">Habíamos estado usando instrucciones SQL ad hoc, volver a ejecutar el Asistente para configuración de TableAdapter habría revertir esta lista de columnas de la consulta s para que coincida con la lista de columnas de la consulta principal, y lo quita de la instrucción NTILE desde la consulta usada por el `GetProductsWithPriceQuartile` método.</span><span class="sxs-lookup"><span data-stu-id="3f860-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>

<span data-ttu-id="3f860-191">Cuando la s de la capa de acceso a datos `GetProductsWithPriceQuartile` se invoca el método, lo TableAdapter ejecuta el `Products_SelectWithPriceQuartile` procedimiento almacenado y agrega una fila a la `ProductsDataTable` de cada registro devuelto.</span><span class="sxs-lookup"><span data-stu-id="3f860-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="3f860-192">Los campos de datos devueltos por el procedimiento almacenado se asignan a la `ProductsDataTable` columnas s.</span><span class="sxs-lookup"><span data-stu-id="3f860-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="3f860-193">Dado que no hay un `PriceQuartile` campo de datos devuelto por el procedimiento almacenado, su valor se asigna a la `ProductsDataTable` s `PriceQuartile` columna.</span><span class="sxs-lookup"><span data-stu-id="3f860-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="3f860-194">Caso de los métodos de TableAdapter cuyas consultas no devuelven un `PriceQuartile` campo de datos, el `PriceQuartile` valor de columna s es el valor especificado por su `DefaultValue` propiedad.</span><span class="sxs-lookup"><span data-stu-id="3f860-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="3f860-195">Como se muestra en la figura 2, este valor se establece en `DBNull`, el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="3f860-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="3f860-196">Si prefiere un valor predeterminado diferente, basta con establecer la `DefaultValue` propiedad según corresponda.</span><span class="sxs-lookup"><span data-stu-id="3f860-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="3f860-197">Asegúrese de que el `DefaultValue` valor es válido según la columna s `DataType` (es decir, `System.Int32` para el `PriceQuartile` columna).</span><span class="sxs-lookup"><span data-stu-id="3f860-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="3f860-198">En este punto hemos realizado los pasos necesarios para agregar una columna adicional a un objeto DataTable.</span><span class="sxs-lookup"><span data-stu-id="3f860-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="3f860-199">Para comprobar que esta columna adicional funciona según lo previsto, permiten crear una página ASP.NET que muestra cada nombre del producto, precio y cuartil precio de s.</span><span class="sxs-lookup"><span data-stu-id="3f860-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="3f860-200">Antes de hacerlo, sin embargo, primero es necesario actualizar la capa de lógica empresarial para que incluya un método que llama hacia abajo a la s DAL `GetProductsWithPriceQuartile` método.</span><span class="sxs-lookup"><span data-stu-id="3f860-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="3f860-201">Se actualizará la capa BLL a continuación, en el paso 3 y, a continuación, cree la página ASP.NET en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="3f860-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="3f860-202">Paso 3: Aumento de la capa de lógica de negocios</span><span class="sxs-lookup"><span data-stu-id="3f860-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="3f860-203">Antes de usar el nuevo `GetProductsWithPriceQuartile` método desde la capa de presentación, primero debemos agregar un método correspondiente a la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="3f860-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="3f860-204">Abra el `ProductsBLLWithSprocs` archivo de clase y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="3f860-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>

[!code-vb[Main](adding-additional-datatable-columns-vb/samples/sample2.vb)]

<span data-ttu-id="3f860-205">Al igual que los otros métodos de recuperación de datos en `ProductsBLLWithSprocs`, `GetProductsWithPriceQuartile` método simplemente llama a la capa DAL s correspondiente `GetProductsWithPriceQuartile` método y devuelve sus resultados.</span><span class="sxs-lookup"><span data-stu-id="3f860-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="3f860-206">Paso 4: Mostrar la información de precios cuartil en una página Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="3f860-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="3f860-207">Con la adición de BLL completar, está listo para crear una página ASP.NET que muestra el cuartil precio de cada producto.</span><span class="sxs-lookup"><span data-stu-id="3f860-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="3f860-208">Abra el `AddingColumns.aspx` página en el `AdvancedDAL` carpeta y arrastre un control GridView del cuadro de herramientas hasta el diseñador, establecer su `ID` propiedad a `Products`.</span><span class="sxs-lookup"><span data-stu-id="3f860-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="3f860-209">En la etiqueta inteligente s GridView, enlazarlo a un nuevo origen ObjectDataSource denominado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="3f860-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="3f860-210">Configurar el origen ObjectDataSource para usar el `ProductsBLLWithSprocs` clase s `GetProductsWithPriceQuartile` método.</span><span class="sxs-lookup"><span data-stu-id="3f860-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="3f860-211">Puesto que se trata de una cuadrícula de solo lectura, establezca las listas desplegables en la actualización, INSERCIÓN y eliminar pestañas en (None).</span><span class="sxs-lookup"><span data-stu-id="3f860-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="3f860-212">[![Configurar el origen ObjectDataSource para usar la clase ProductsBLLWithSprocs](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span></span>

<span data-ttu-id="3f860-213">**Figura 9**: Configurar el origen ObjectDataSource que se usarán el `ProductsBLLWithSprocs` clase ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image25.png))</span></span>

<span data-ttu-id="3f860-214">[![Recuperar información de producto desde el método GetProductsWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span></span>

<span data-ttu-id="3f860-215">**Figura 10**: Recuperar la información de producto desde la `GetProductsWithPriceQuartile` método ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image28.png))</span></span>

<span data-ttu-id="3f860-216">Después de completar al Asistente para configurar orígenes de datos, Visual Studio agregará automáticamente un BoundField o CampoCasillaVerificación en GridView para cada uno de los campos de datos devueltos por el método.</span><span class="sxs-lookup"><span data-stu-id="3f860-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="3f860-217">Uno de estos campos de datos es `PriceQuartile`, que es la columna se agrega a la `ProductsDataTable` en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="3f860-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="3f860-218">Edite los campos de s GridView, quitando todos excepto el `ProductName`, `UnitPrice`, y `PriceQuartile` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="3f860-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="3f860-219">Configurar la `UnitPrice` BoundField para dar formato a su valor como moneda y tener la `UnitPrice` y `PriceQuartile` BoundFields y centro-alineado a la derecha, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="3f860-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="3f860-220">Por último, actualice los restantes BoundFields `HeaderText` propiedades para el producto, precio y precio cuartil, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="3f860-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="3f860-221">Además, active la casilla Habilitar ordenación de la etiqueta inteligente de s GridView.</span><span class="sxs-lookup"><span data-stu-id="3f860-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="3f860-222">Después de estas modificaciones, el marcado declarativo de s GridView y ObjectDataSource debería ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="3f860-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](adding-additional-datatable-columns-vb/samples/sample3.aspx)]

<span data-ttu-id="3f860-223">Figura 11 muestra esta página cuando visita a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="3f860-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="3f860-224">Tenga en cuenta que, inicialmente, los productos se ordenan por su precio en orden descendente con cada producto asignado un adecuado `PriceQuartile` valor.</span><span class="sxs-lookup"><span data-stu-id="3f860-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="3f860-225">Por supuesto estos datos pueden ordenarse por otros criterios con el valor de columna precio cuartil todavía que refleja la clasificación de producto s con respecto al precio (consulte la figura 12).</span><span class="sxs-lookup"><span data-stu-id="3f860-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>

<span data-ttu-id="3f860-226">[![Los productos se ordenan por sus precios](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span></span>

<span data-ttu-id="3f860-227">**Figura 11**: Los productos se ordenan por sus precios ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image31.png))</span></span>

<span data-ttu-id="3f860-228">[![Los productos se ordenan por sus nombres](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="3f860-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span></span>

<span data-ttu-id="3f860-229">**Figura 12**: Los productos se ordenan por sus nombres ([haga clic aquí para ver imagen en tamaño completo](adding-additional-datatable-columns-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="3f860-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image34.png))</span></span>

> [!NOTE]
> <span data-ttu-id="3f860-230">Con unas pocas líneas de código nos podríamos aumentar GridView para que lo colorea las filas del producto basándose en sus `PriceQuartile` valor.</span><span class="sxs-lookup"><span data-stu-id="3f860-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="3f860-231">Nos podríamos color esos productos en el primer cuartil verde claro, los de la segunda cuartil un color amarillo y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="3f860-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="3f860-232">Le sugiero que dedique un momento para agregar esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="3f860-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="3f860-233">Si necesita un actualizador cómo dar formato a un control GridView, consulte el [formato basado en datos personalizados](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="3f860-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>

## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="3f860-234">Un enfoque alternativo - crear otro objeto de TableAdapter</span><span class="sxs-lookup"><span data-stu-id="3f860-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="3f860-235">Como hemos visto en este tutorial, al agregar un método a TableAdapter que devuelva los campos de datos distintos de los especificados por la consulta principal, podemos agregar las columnas correspondientes a la DataTable.</span><span class="sxs-lookup"><span data-stu-id="3f860-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="3f860-236">Este enfoque, sin embargo, funciona bien solo si hay un pequeño número de métodos de TableAdapter que devuelva los campos de datos diferentes, y si esos campos de datos alternativo no varían mucho de la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="3f860-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="3f860-237">En lugar de agregar columnas a la DataTable, en su lugar, puede agregar otro TableAdapter al conjunto de datos que contiene los métodos de la primera TableAdapter que devuelven los campos de datos diferentes.</span><span class="sxs-lookup"><span data-stu-id="3f860-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="3f860-238">Para este tutorial, en lugar de agregar el `PriceQuartile` columna a la `ProductsDataTable` (que solo se usa por la `GetProductsWithPriceQuartile` método), podríamos ha agregado un TableAdapter adicional al conjunto de datos denominado `ProductsWithPriceQuartileTableAdapter` que usa el `Products_SelectWithPriceQuartile` almacenados procedimiento como su consulta principal.</span><span class="sxs-lookup"><span data-stu-id="3f860-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="3f860-239">Las páginas ASP.NET que es necesario para obtener información de producto con el cuartil precio utilizaría el `ProductsWithPriceQuartileTableAdapter`, mientras que aquellos que no se pueden seguir usando el `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="3f860-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="3f860-240">Al agregar un nuevo TableAdapter, DataTables permanecen untarnished y sus columnas reflejan con precisión los campos de datos devueltos por sus métodos de TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="3f860-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="3f860-241">Sin embargo, los TableAdapters adicionales puede introducir la funcionalidad y las tareas repetitivas.</span><span class="sxs-lookup"><span data-stu-id="3f860-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="3f860-242">Por ejemplo, si esas páginas ASP.NET que muestra el `PriceQuartile` columna también es necesario para proporcionar la inserción, actualización y eliminación de soporte técnico, el `ProductsWithPriceQuartileTableAdapter` necesitaría su `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades correctamente configurado.</span><span class="sxs-lookup"><span data-stu-id="3f860-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="3f860-243">Aunque estas propiedades se reflejará el `ProductsTableAdapter` s, esta configuración presenta un paso adicional.</span><span class="sxs-lookup"><span data-stu-id="3f860-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="3f860-244">Además, ahora hay dos maneras de actualizar, eliminar o agregar un producto a la base de datos - a través de la `ProductsTableAdapter` y `ProductsWithPriceQuartileTableAdapter` clases.</span><span class="sxs-lookup"><span data-stu-id="3f860-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="3f860-245">La descarga de este tutorial incluye una `ProductsWithPriceQuartileTableAdapter` clase en el `NorthwindWithSprocs` conjunto de datos que se muestra este enfoque alternativo.</span><span class="sxs-lookup"><span data-stu-id="3f860-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="3f860-246">Resumen</span><span class="sxs-lookup"><span data-stu-id="3f860-246">Summary</span></span>

<span data-ttu-id="3f860-247">En la mayoría de los escenarios, todos los métodos en un TableAdapter devolución el mismo conjunto de campos de datos, pero hay ocasiones es posible que necesite un método determinado o dos para devolver un campo adicional.</span><span class="sxs-lookup"><span data-stu-id="3f860-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="3f860-248">Por ejemplo, en el [maestro/detalle con una lista con viñetas de registros maestros con un control DataList de detalles](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial se ha agregado un método para el `CategoriesTableAdapter` que, además de los campos de datos de la consulta principal s devueltos un `NumberOfProducts` campo que notifica el número de productos asociados con cada categoría.</span><span class="sxs-lookup"><span data-stu-id="3f860-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="3f860-249">En este tutorial explicamos la adición de un método en el `ProductsTableAdapter` que devuelve un `PriceQuartile` campo además de los campos de datos de la consulta principal s.</span><span class="sxs-lookup"><span data-stu-id="3f860-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="3f860-250">Para capturar datos adicionales campos devueltos por los métodos de TableAdapter s que tenemos que agregar las columnas correspondientes a la DataTable.</span><span class="sxs-lookup"><span data-stu-id="3f860-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="3f860-251">Si tiene previsto agregar manualmente las columnas a la DataTable, se recomienda que los TableAdapter utilizan procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="3f860-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="3f860-252">Si el TableAdapter utiliza instrucciones SQL ad hoc, siempre que el Asistente para configuración de TableAdapter se ejecuta todos los métodos de reversión las listas de campos de datos a los campos de datos devueltos por la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="3f860-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="3f860-253">Este problema no se extiende a los procedimientos almacenados, que es la razón por la que se recomiendan y se usaron en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="3f860-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="3f860-254">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="3f860-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3f860-255">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="3f860-255">About the Author</span></span>

<span data-ttu-id="3f860-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), trabaja con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="3f860-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3f860-257">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="3f860-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3f860-258">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3f860-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3f860-259">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3f860-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3f860-260">o a través de su blog, que puede encontrarse en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="3f860-260">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3f860-261">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="3f860-261">Special Thanks To</span></span>

<span data-ttu-id="3f860-262">Esta serie de tutoriales ha sido revisada por muchos revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="3f860-262">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3f860-263">Los revisores para este tutorial fueron Randy Schmidt, Goor Jacky, Bernadette Leigh y Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="3f860-263">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="3f860-264">¿Está interesado en leer mi próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="3f860-264">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3f860-265">Si es así, envíeme una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3f860-265">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3f860-266">[Anterior](updating-the-tableadapter-to-use-joins-vb.md)
> [Siguiente](working-with-computed-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="3f860-266">[Previous](updating-the-tableadapter-to-use-joins-vb.md)
[Next](working-with-computed-columns-vb.md)</span></span>

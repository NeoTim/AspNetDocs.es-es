---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
title: Establecer mediante programación los valores de parámetro de ObjectDataSourceC#() | Microsoft Docs
author: rick-anderson
description: En este tutorial veremos cómo agregar un método a la capa DAL y a la capa BLL que acepta un único parámetro de entrada y devuelve datos. En el ejemplo se establecerá este parámetro...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 1c4588bb-255d-4088-b319-5208da756f4d
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
msc.type: authoredcontent
ms.openlocfilehash: 8aa57172abcfc779fa74b128ad76d42c41dc5b98
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2019
ms.locfileid: "74602207"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-c"></a><span data-ttu-id="8154b-104">Configurar los valores de parámetro de ObjectDataSource mediante programación (C#)</span><span class="sxs-lookup"><span data-stu-id="8154b-104">Programmatically Setting the ObjectDataSource's Parameter Values (C#)</span></span>

<span data-ttu-id="8154b-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8154b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8154b-106">[Descarga](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) de la aplicación de ejemplo o [descarga de PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8154b-106">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span></span>

> <span data-ttu-id="8154b-107">En este tutorial veremos cómo agregar un método a la capa DAL y a la capa BLL que acepta un único parámetro de entrada y devuelve datos.</span><span class="sxs-lookup"><span data-stu-id="8154b-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="8154b-108">En el ejemplo se establecerá este parámetro mediante programación.</span><span class="sxs-lookup"><span data-stu-id="8154b-108">The example will set this parameter programmatically.</span></span>

## <a name="introduction"></a><span data-ttu-id="8154b-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="8154b-109">Introduction</span></span>

<span data-ttu-id="8154b-110">Como vimos en el [tutorial anterior](declarative-parameters-cs.md), hay varias opciones disponibles para pasar de forma declarativa los valores de parámetro a los métodos de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="8154b-110">As we saw in the [previous tutorial](declarative-parameters-cs.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="8154b-111">Si el valor del parámetro está codificado de forma rígida, procede de un control Web en la página o se encuentra en cualquier otro origen que sea legible para un origen de datos `Parameter` objeto, por ejemplo, ese valor se puede enlazar al parámetro de entrada sin escribir una línea de código.</span><span class="sxs-lookup"><span data-stu-id="8154b-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="8154b-112">No obstante, puede haber ocasiones en las que el valor del parámetro proceda de algún origen que aún no tenga en cuenta uno de los objetos de `Parameter` de origen de datos integrados.</span><span class="sxs-lookup"><span data-stu-id="8154b-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="8154b-113">Si nuestro sitio admite cuentas de usuario, es posible que desee establecer el parámetro basándose en el identificador de usuario del visitante que ha iniciado sesión actualmente.</span><span class="sxs-lookup"><span data-stu-id="8154b-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="8154b-114">O bien, es posible que necesitemos personalizar el valor del parámetro antes de enviarlo al método del objeto subyacente de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="8154b-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="8154b-115">Siempre que se invoca el método `Select` de ObjectDataSource, primero se genera su [evento de selección](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="8154b-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="8154b-116">A continuación, se invoca el método del objeto subyacente de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="8154b-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="8154b-117">Una vez que complete los desencadenadores de [eventos seleccionados](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) de ObjectDataSource (la figura 1 muestra esta secuencia de eventos).</span><span class="sxs-lookup"><span data-stu-id="8154b-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="8154b-118">Los valores de parámetro que se pasan al método del objeto subyacente de ObjectDataSource se pueden establecer o personalizar en un controlador de eventos para el evento `Selecting`.</span><span class="sxs-lookup"><span data-stu-id="8154b-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>

<span data-ttu-id="8154b-119">[![se activan y seleccionan los eventos del origen ObjectDataSource antes y después de invocar el método de su objeto subyacente](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8154b-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span></span>

<span data-ttu-id="8154b-120">**Figura 1**: los eventos `Selected` y `Selecting` de ObjectDataSource se activan antes y después de invocar el método de su objeto subyacente ([haga clic para ver la imagen de tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8154b-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span></span>

<span data-ttu-id="8154b-121">En este tutorial, veremos cómo agregar un método a la capa DAL y a la capa BLL que acepta un único parámetro de entrada `Month`, de tipo `int` y devuelve un objeto `EmployeesDataTable` rellenado con los empleados que tienen su aniversario de contratación en el `Month`especificado.</span><span class="sxs-lookup"><span data-stu-id="8154b-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `int` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="8154b-122">En nuestro ejemplo se establecerá este parámetro mediante programación basándose en el mes actual y se mostrará una lista de "aniversarios de los empleados este mes".</span><span class="sxs-lookup"><span data-stu-id="8154b-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="8154b-123">Comencemos.</span><span class="sxs-lookup"><span data-stu-id="8154b-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="8154b-124">Paso 1: agregar un método a`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="8154b-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="8154b-125">En el primer ejemplo, es necesario agregar un medio para recuperar los empleados cuyo `HireDate` haya ocurrido en un mes determinado.</span><span class="sxs-lookup"><span data-stu-id="8154b-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="8154b-126">Para proporcionar esta funcionalidad de acuerdo con la arquitectura, necesitamos crear primero un método en `EmployeesTableAdapter` que se asigne a la instrucción SQL adecuada.</span><span class="sxs-lookup"><span data-stu-id="8154b-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="8154b-127">Para ello, empiece abriendo el conjunto de DataSet con tipo Northwind.</span><span class="sxs-lookup"><span data-stu-id="8154b-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="8154b-128">Haga clic con el botón derecho en la etiqueta `EmployeesTableAdapter` y elija Agregar consulta.</span><span class="sxs-lookup"><span data-stu-id="8154b-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>

<span data-ttu-id="8154b-129">[![agregar una nueva consulta a EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="8154b-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span></span>

<span data-ttu-id="8154b-130">**Figura 2**: agregar una nueva consulta a la `EmployeesTableAdapter` ([haga clic para ver la imagen de tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8154b-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span></span>

<span data-ttu-id="8154b-131">Elija Agregar una instrucción SQL que devuelva filas.</span><span class="sxs-lookup"><span data-stu-id="8154b-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="8154b-132">Cuando llegue a la pantalla especificar una `SELECT` instrucción, la instrucción de `SELECT` predeterminada para el `EmployeesTableAdapter` ya se cargará.</span><span class="sxs-lookup"><span data-stu-id="8154b-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="8154b-133">Simplemente agregue en la cláusula `WHERE`: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="8154b-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="8154b-134">[DatePart](https://msdn.microsoft.com/library/ms174420.aspx) es una función de T-SQL que devuelve una parte de fecha determinada de un tipo de `datetime`; en este caso, vamos a usar `DATEPART` para devolver el mes de la columna de `HireDate`.</span><span class="sxs-lookup"><span data-stu-id="8154b-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>

<span data-ttu-id="8154b-135">[![devolver solo las filas en las que la columna HireDate es menor o igual que el parámetro @HiredBeforeDate](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8154b-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span></span>

<span data-ttu-id="8154b-136">**Figura 3**: devolver solo las filas en las que la `HireDate` columna es menor o igual que el parámetro `@HiredBeforeDate` ([haga clic para ver la imagen de tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="8154b-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span></span>

<span data-ttu-id="8154b-137">Por último, cambie los nombres de método `FillBy` y `GetDataBy` a `FillByHiredDateMonth` y `GetEmployeesByHiredDateMonth`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="8154b-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>

<span data-ttu-id="8154b-138">[![elegir nombres de método más adecuados que FillBy y GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="8154b-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span></span>

<span data-ttu-id="8154b-139">**Ilustración 4**: elegir nombres de método más adecuados que `FillBy` y `GetDataBy` ([haga clic para ver la imagen de tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="8154b-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span></span>

<span data-ttu-id="8154b-140">Haga clic en finalizar para completar el asistente y volver a la superficie de diseño del conjunto de los mismos.</span><span class="sxs-lookup"><span data-stu-id="8154b-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="8154b-141">El `EmployeesTableAdapter` debe incluir ahora un nuevo conjunto de métodos para tener acceso a los empleados contratados en un mes determinado.</span><span class="sxs-lookup"><span data-stu-id="8154b-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>

<span data-ttu-id="8154b-142">[![los nuevos métodos aparecen en el Superficie de diseño del conjunto de los](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="8154b-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span></span>

<span data-ttu-id="8154b-143">**Figura 5**: los nuevos métodos aparecen en el superficie de diseño del conjunto de[información (haga clic para ver la imagen de tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="8154b-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span></span>

## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="8154b-144">Paso 2: agregar el método`GetEmployeesByHiredDateMonth(month)`a la capa de lógica de negocios</span><span class="sxs-lookup"><span data-stu-id="8154b-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="8154b-145">Dado que la arquitectura de la aplicación usa una capa independiente para la lógica de negocios y la lógica de acceso a datos, es necesario agregar un método a la capa BLL que llama a la capa DAL para recuperar los empleados contratados antes de la fecha especificada.</span><span class="sxs-lookup"><span data-stu-id="8154b-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="8154b-146">Abra el archivo `EmployeesBLL.cs` y agregue el siguiente método:</span><span class="sxs-lookup"><span data-stu-id="8154b-146">Open the `EmployeesBLL.cs` file and add the following method:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample1.cs)]

<span data-ttu-id="8154b-147">Al igual que con otros métodos de esta clase, `GetEmployeesByHiredDateMonth(month)` simplemente llama a la capa DAL y devuelve los resultados.</span><span class="sxs-lookup"><span data-stu-id="8154b-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="8154b-148">Paso 3: mostrar a los empleados cuyo aniversario de contratación es este mes</span><span class="sxs-lookup"><span data-stu-id="8154b-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="8154b-149">Nuestro último paso para este ejemplo es mostrar los empleados cuyo aniversario de contratación es este mes.</span><span class="sxs-lookup"><span data-stu-id="8154b-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="8154b-150">Comience agregando un control GridView a la página `ProgrammaticParams.aspx` en la carpeta `BasicReporting` y agregue un nuevo ObjectDataSource como origen de datos.</span><span class="sxs-lookup"><span data-stu-id="8154b-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="8154b-151">Configure ObjectDataSource para usar la clase `EmployeesBLL` con el `SelectMethod` establecido en `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="8154b-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>

<span data-ttu-id="8154b-152">[![usar la clase EmployeesBLL](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="8154b-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span></span>

<span data-ttu-id="8154b-153">**Figura 6**: uso de la clase `EmployeesBLL` ([haga clic para ver la imagen de tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="8154b-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span></span>

<span data-ttu-id="8154b-154">[![seleccionar en el método GetEmployeesByHiredDateMonth (month)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="8154b-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span></span>

<span data-ttu-id="8154b-155">**Figura 7**: seleccione en el método `GetEmployeesByHiredDateMonth(month)` ([haga clic para ver la imagen de tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="8154b-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span></span>

<span data-ttu-id="8154b-156">La última pantalla nos pide que proporcione el `month` origen del valor del parámetro.</span><span class="sxs-lookup"><span data-stu-id="8154b-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="8154b-157">Como estableceremos este valor mediante programación, deje el origen del parámetro establecido en la opción None predeterminada y haga clic en finalizar.</span><span class="sxs-lookup"><span data-stu-id="8154b-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>

<span data-ttu-id="8154b-158">[![dejar el origen del parámetro establecido en ninguno](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="8154b-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span></span>

<span data-ttu-id="8154b-159">**Figura 8**: deje el origen del parámetro establecido en ninguno ([haga clic para ver la imagen de tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="8154b-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span></span>

<span data-ttu-id="8154b-160">Esto creará un objeto de `Parameter` en la colección de `SelectParameters` de ObjectDataSource que no tiene un valor especificado.</span><span class="sxs-lookup"><span data-stu-id="8154b-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>

[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample2.aspx)]

<span data-ttu-id="8154b-161">Para establecer este valor mediante programación, es necesario crear un controlador de eventos para el evento `Selecting` de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="8154b-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="8154b-162">Para ello, vaya al Vista de diseño y haga doble clic en ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="8154b-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="8154b-163">Como alternativa, seleccione ObjectDataSource, vaya a la ventana Propiedades y haga clic en el icono de rayo.</span><span class="sxs-lookup"><span data-stu-id="8154b-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="8154b-164">A continuación, haga doble clic en el cuadro de texto situado junto al evento `Selecting` o escriba el nombre del controlador de eventos que desea usar.</span><span class="sxs-lookup"><span data-stu-id="8154b-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span>

![Haga clic en el icono de rayo en la ventana Propiedades para mostrar los eventos de un control Web.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image25.png)

<span data-ttu-id="8154b-166">**Figura 9**: haga clic en el icono de rayo de la ventana Propiedades para mostrar los eventos de un control Web.</span><span class="sxs-lookup"><span data-stu-id="8154b-166">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>

<span data-ttu-id="8154b-167">Ambos enfoques agregan un nuevo controlador de eventos para el evento de `Selecting` de ObjectDataSource a la clase de código subyacente de la página.</span><span class="sxs-lookup"><span data-stu-id="8154b-167">Both approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="8154b-168">En este controlador de eventos, se pueden leer y escribir en los valores de parámetro mediante `e.InputParameters[parameterName]`, donde *`parameterName`* es el valor del atributo `Name` en la etiqueta `<asp:Parameter>` (la colección `InputParameters` también se puede indizar de forma ordinal, como en `e.InputParameters[index]`).</span><span class="sxs-lookup"><span data-stu-id="8154b-168">In this event handler we can read and write to the parameter values using `e.InputParameters[parameterName]`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters[index]`).</span></span> <span data-ttu-id="8154b-169">Para establecer el parámetro `month` en el mes actual, agregue lo siguiente al controlador de eventos `Selecting`:</span><span class="sxs-lookup"><span data-stu-id="8154b-169">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample3.cs)]

<span data-ttu-id="8154b-170">Al visitar esta página a través de un explorador, podemos ver que solo se contrató a un empleado este mes (marzo) Laura Díaz, que se ha puesto en la empresa desde 1994.</span><span class="sxs-lookup"><span data-stu-id="8154b-170">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>

<span data-ttu-id="8154b-171">[![los empleados cuyo aniversario de este mes se muestran](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="8154b-171">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span></span>

<span data-ttu-id="8154b-172">**Figura 10**: los empleados cuyos aniversarios se muestran en este mes ([haga clic para ver la imagen de tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="8154b-172">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span></span>

## <a name="summary"></a><span data-ttu-id="8154b-173">Resumen</span><span class="sxs-lookup"><span data-stu-id="8154b-173">Summary</span></span>

<span data-ttu-id="8154b-174">Aunque los valores de los parámetros de ObjectDataSource normalmente se pueden establecer de forma declarativa, sin necesidad de una línea de código, es fácil establecer los valores de parámetro mediante programación.</span><span class="sxs-lookup"><span data-stu-id="8154b-174">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="8154b-175">Lo único que debemos hacer es crear un controlador de eventos para el evento `Selecting` de ObjectDataSource, que se activa antes de que se invoque el método del objeto subyacente, y establecer manualmente los valores de uno o varios parámetros a través de la colección `InputParameters`.</span><span class="sxs-lookup"><span data-stu-id="8154b-175">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="8154b-176">Este tutorial concluye la sección de informes básicos.</span><span class="sxs-lookup"><span data-stu-id="8154b-176">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="8154b-177">En el [siguiente tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) se inicia la sección de escenarios de filtrado y detalles principales, en la que veremos técnicas para permitir que el visitante filtre datos y explore en profundidad un informe maestro en un informe de detalles.</span><span class="sxs-lookup"><span data-stu-id="8154b-177">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="8154b-178">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="8154b-178">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8154b-179">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="8154b-179">About the Author</span></span>

<span data-ttu-id="8154b-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros de ASP/ASP. net y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="8154b-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8154b-181">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="8154b-181">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8154b-182">Su último libro se [*enseña a ASP.NET 2,0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8154b-182">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8154b-183">Puede ponerse en contacto con usted en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8154b-183">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8154b-184">o a través de su blog, que encontrará en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8154b-184">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8154b-185">Agradecimiento especial a</span><span class="sxs-lookup"><span data-stu-id="8154b-185">Special Thanks To</span></span>

<span data-ttu-id="8154b-186">Muchos revisores útiles revisaron esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="8154b-186">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8154b-187">El revisor responsable de este tutorial fue Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="8154b-187">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="8154b-188">¿Está interesado en revisar los próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="8154b-188">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8154b-189">En caso afirmativo, suéltelo en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8154b-189">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="8154b-190">[Anterior](declarative-parameters-cs.md)
> [Siguiente](displaying-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8154b-190">[Previous](declarative-parameters-cs.md)
[Next](displaying-data-with-the-objectdatasource-vb.md)</span></span>

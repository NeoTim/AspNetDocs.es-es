---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
title: Creación de clases de modelo con Entity Framework (C-) Microsoft Docs
author: rick-anderson
description: En este tutorial, aprenderá a usar ASP.NET MVC con Microsoft Entity Framework. Aprenderá a usar el Asistente para entidades para crear una ADO.NET Entity Da...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 61644169-e8b1-45dd-bf96-9c2301b69879
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
msc.type: authoredcontent
ms.openlocfilehash: 716d34167258b1005b25b1cd11bfaa6d80763320
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542669"
---
# <a name="creating-model-classes-with-the-entity-framework-c"></a><span data-ttu-id="2423f-104">Crear clases de modelo con Entity Framework (C#)</span><span class="sxs-lookup"><span data-stu-id="2423f-104">Creating Model Classes with the Entity Framework (C#)</span></span>

<span data-ttu-id="2423f-105">por [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="2423f-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="2423f-106">En este tutorial, aprenderá a usar ASP.NET MVC con Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="2423f-107">Aprenderá a usar el Asistente para entidades para crear una ADO.NET Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="2423f-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="2423f-108">En el transcurso de este tutorial, creamos una aplicación web que ilustra cómo seleccionar, insertar, actualizar y eliminar datos de base de datos mediante Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>

<span data-ttu-id="2423f-109">El objetivo de este tutorial es explicar cómo puede crear clases de acceso a datos mediante Microsoft Entity Framework al compilar una aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="2423f-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="2423f-110">En este tutorial no se supone ningún conocimiento previo de Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="2423f-111">Al final de este tutorial, comprenderá cómo usar Entity Framework para seleccionar, insertar, actualizar y eliminar registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="2423f-112">Microsoft Entity Framework es una herramienta de asignación relacional de objetos (O/RM) que le permite generar automáticamente una capa de acceso a datos a partir de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="2423f-113">Entity Framework le permite evitar el tedioso trabajo de crear las clases de acceso a datos a mano.</span><span class="sxs-lookup"><span data-stu-id="2423f-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

<span data-ttu-id="2423f-114">Para ilustrar cómo puede usar Microsoft Entity Framework con ASP.NET MVC, crearemos una aplicación de ejemplo sencilla.</span><span class="sxs-lookup"><span data-stu-id="2423f-114">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="2423f-115">Crearemos una aplicación de base de datos de películas que le permite mostrar y editar registros de base de datos de películas.</span><span class="sxs-lookup"><span data-stu-id="2423f-115">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="2423f-116">En este tutorial se supone que tiene Visual Studio 2008 o Visual Web Developer 2008 con Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="2423f-116">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="2423f-117">Necesita Service Pack 1 para utilizar Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-117">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="2423f-118">Puede descargar Visual Studio 2008 Service Pack 1 o Visual Web Developer con Service Pack 1 desde la siguiente dirección:</span><span class="sxs-lookup"><span data-stu-id="2423f-118">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [https://www.asp.net/downloads/](https://www.asp.net/downloads)

> [!NOTE] 
> 
> <span data-ttu-id="2423f-119">No hay ninguna conexión esencial entre ASP.NET MVC y Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-119">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="2423f-120">Hay varias alternativas a Entity Framework que puede usar con ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="2423f-120">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="2423f-121">Por ejemplo, puede crear las clases de modelo MVC con otras herramientas de O/RM como Microsoft LINQ to SQL, NHibernate o SubSonic.</span><span class="sxs-lookup"><span data-stu-id="2423f-121">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>

## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="2423f-122">Creación de la base de datos de ejemplo de película</span><span class="sxs-lookup"><span data-stu-id="2423f-122">Creating the Movie Sample Database</span></span>

<span data-ttu-id="2423f-123">La aplicación Movie Database utiliza una tabla de base de datos denominada Movies que contiene las siguientes columnas:</span><span class="sxs-lookup"><span data-stu-id="2423f-123">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="2423f-124">Nombre de columna</span><span class="sxs-lookup"><span data-stu-id="2423f-124">Column Name</span></span> | <span data-ttu-id="2423f-125">Tipo de datos</span><span class="sxs-lookup"><span data-stu-id="2423f-125">Data Type</span></span> | <span data-ttu-id="2423f-126">¿Permitir Valores NULL?</span><span class="sxs-lookup"><span data-stu-id="2423f-126">Allow Nulls?</span></span> | <span data-ttu-id="2423f-127">¿Es la clave principal?</span><span class="sxs-lookup"><span data-stu-id="2423f-127">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="2423f-128">Identificador</span><span class="sxs-lookup"><span data-stu-id="2423f-128">Id</span></span> | <span data-ttu-id="2423f-129">int</span><span class="sxs-lookup"><span data-stu-id="2423f-129">int</span></span> | <span data-ttu-id="2423f-130">False</span><span class="sxs-lookup"><span data-stu-id="2423f-130">False</span></span> | <span data-ttu-id="2423f-131">True</span><span class="sxs-lookup"><span data-stu-id="2423f-131">True</span></span> |
| <span data-ttu-id="2423f-132">Título</span><span class="sxs-lookup"><span data-stu-id="2423f-132">Title</span></span> | <span data-ttu-id="2423f-133">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="2423f-133">nvarchar(100)</span></span> | <span data-ttu-id="2423f-134">False</span><span class="sxs-lookup"><span data-stu-id="2423f-134">False</span></span> | <span data-ttu-id="2423f-135">False</span><span class="sxs-lookup"><span data-stu-id="2423f-135">False</span></span> |
| <span data-ttu-id="2423f-136">Director</span><span class="sxs-lookup"><span data-stu-id="2423f-136">Director</span></span> | <span data-ttu-id="2423f-137">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="2423f-137">nvarchar(100)</span></span> | <span data-ttu-id="2423f-138">False</span><span class="sxs-lookup"><span data-stu-id="2423f-138">False</span></span> | <span data-ttu-id="2423f-139">False</span><span class="sxs-lookup"><span data-stu-id="2423f-139">False</span></span> |

<span data-ttu-id="2423f-140">Puede agregar esta tabla a un proyecto de ASP.NET MVC siguiendo estos pasos:</span><span class="sxs-lookup"><span data-stu-id="2423f-140">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="2423f-141">Haga clic con\_el botón derecho en la carpeta Datos de la aplicación en la ventana Explorador de soluciones y seleccione la opción de menú **Agregar, Nuevo elemento.**</span><span class="sxs-lookup"><span data-stu-id="2423f-141">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="2423f-142">En el cuadro de diálogo **Agregar nuevo elemento,** seleccione Base de datos de **SQL Server**, asigne a la base de datos el nombre MoviesDB.mdf y haga clic en el botón **Agregar.**</span><span class="sxs-lookup"><span data-stu-id="2423f-142">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="2423f-143">Haga doble clic en el archivo MoviesDB.mdf para abrir la ventana Explorador de servidores/Explorador de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-143">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="2423f-144">Expanda la conexión de base de datos MoviesDB.mdf, haga clic con el botón derecho en la carpeta Tablas y seleccione la opción de menú **Agregar nueva tabla**.</span><span class="sxs-lookup"><span data-stu-id="2423f-144">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="2423f-145">En el Diseñador de tablas, agregue las columnas Id, Title y Director.</span><span class="sxs-lookup"><span data-stu-id="2423f-145">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="2423f-146">Haga clic en el botón **Guardar** (tiene el icono del disquete) para guardar la nueva tabla con el nombre Películas.</span><span class="sxs-lookup"><span data-stu-id="2423f-146">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="2423f-147">Después de crear la tabla de base de datos Movies, debe agregar algunos datos de ejemplo a la tabla.</span><span class="sxs-lookup"><span data-stu-id="2423f-147">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="2423f-148">Haga clic con el botón derecho en la tabla Películas y seleccione la opción de menú **Mostrar datos**de tabla .</span><span class="sxs-lookup"><span data-stu-id="2423f-148">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="2423f-149">Puede introducir datos de película falsos en la cuadrícula que aparece.</span><span class="sxs-lookup"><span data-stu-id="2423f-149">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="2423f-150">Creación del modelo de datos de entidad ADO.NET</span><span class="sxs-lookup"><span data-stu-id="2423f-150">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="2423f-151">Para usar Entity Framework, debe crear un Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="2423f-151">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="2423f-152">Puede aprovechar el Asistente *para Visual* Studio Entity Data Model para generar un Entity Data Model a partir de una base de datos automáticamente.</span><span class="sxs-lookup"><span data-stu-id="2423f-152">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="2423f-153">Siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="2423f-153">Follow these steps:</span></span>

1. <span data-ttu-id="2423f-154">Haga clic con el botón derecho en la carpeta Modelos de la ventana Explorador de soluciones y seleccione la opción de menú **Agregar, Nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="2423f-154">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="2423f-155">En el cuadro de diálogo **Agregar nuevo elemento,** seleccione la categoría Datos (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="2423f-155">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="2423f-156">Seleccione la ADO.NET Entity **Data Model** plantilla, asigne al Entity Data Model el nombre MoviesDBModel.edmx y haga clic en el botón **Agregar.**</span><span class="sxs-lookup"><span data-stu-id="2423f-156">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="2423f-157">Al hacer clic en el botón **Agregar** se inicia el Asistente para modelos de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-157">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="2423f-158">En el paso Elegir contenido del **modelo,** elija la opción **Generar a partir de una base** de datos y haga clic en el botón **Siguiente** (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="2423f-158">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="2423f-159">En el paso Elegir la conexión de **datos,** seleccione la conexión de base de datos MoviesDB.mdf, escriba el nombre de configuración de conexiones de entidades MoviesDBEntities y haga clic en el botón **Siguiente** (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="2423f-159">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="2423f-160">En el paso Elegir los objetos de base de **datos,** seleccione la tabla Base de datos de películas y haga clic en el botón **Finalizar** (consulte la figura 4).</span><span class="sxs-lookup"><span data-stu-id="2423f-160">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="2423f-161">Después de completar estos pasos, se abre el diseñador de ADO.NET Entity Data Model Designer (Entity Designer).</span><span class="sxs-lookup"><span data-stu-id="2423f-161">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="2423f-162">**Figura 1 – Creación de un nuevo Entity Data Model**</span><span class="sxs-lookup"><span data-stu-id="2423f-162">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-cs/_static/image1.jpg)

<span data-ttu-id="2423f-164">**Figura 2 – Elija el paso de contenido del modelo**</span><span class="sxs-lookup"><span data-stu-id="2423f-164">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-cs/_static/image2.jpg)

<span data-ttu-id="2423f-166">**Figura 3 – Elija su conexión de datos**</span><span class="sxs-lookup"><span data-stu-id="2423f-166">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-cs/_static/image3.jpg)

<span data-ttu-id="2423f-168">**Figura 4 – Elija los objetos de la base de datos**</span><span class="sxs-lookup"><span data-stu-id="2423f-168">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-cs/_static/image4.jpg)

#### <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="2423f-170">Modificación del modelo de datos de entidad de ADO.NET</span><span class="sxs-lookup"><span data-stu-id="2423f-170">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="2423f-171">Después de crear un Entity Data Model, puede modificar el modelo aprovechando Entity Designer (consulte la figura 5).</span><span class="sxs-lookup"><span data-stu-id="2423f-171">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="2423f-172">Puede abrir Entity Designer en cualquier momento haciendo doble clic en el archivo MoviesDBModel.edmx contenido en la carpeta Modelos dentro de la ventana Explorador de soluciones.</span><span class="sxs-lookup"><span data-stu-id="2423f-172">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="2423f-173">**Figura 5: el Diseñador de ADO.NET Entity Data Model**</span><span class="sxs-lookup"><span data-stu-id="2423f-173">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-cs/_static/image5.jpg)

<span data-ttu-id="2423f-175">Por ejemplo, puede usar Entity Designer para cambiar los nombres de las clases que genera el Asistente para datos de Entity Model.</span><span class="sxs-lookup"><span data-stu-id="2423f-175">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="2423f-176">El asistente creó una nueva clase de acceso a datos denominada Movies.</span><span class="sxs-lookup"><span data-stu-id="2423f-176">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="2423f-177">En otras palabras, el asistente dio a la clase el mismo nombre que la tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-177">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="2423f-178">Dado que usaremos esta clase para representar una instancia de Movie determinada, debemos cambiar el nombre de la clase de Películas a Película.</span><span class="sxs-lookup"><span data-stu-id="2423f-178">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="2423f-179">Si desea cambiar el nombre de una clase de entidad, puede hacer doble clic en el nombre de clase en Entity Designer y escribir un nuevo nombre (consulte la figura 6).</span><span class="sxs-lookup"><span data-stu-id="2423f-179">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="2423f-180">Como alternativa, puede cambiar el nombre de una entidad en la ventana Propiedades después de seleccionar una entidad en Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="2423f-180">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="2423f-181">**Figura 6 – Cambio del nombre de una entidad**</span><span class="sxs-lookup"><span data-stu-id="2423f-181">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-cs/_static/image6.jpg)

<span data-ttu-id="2423f-183">Recuerde guardar el Entity Data Model después de realizar una modificación haciendo clic en el botón Guardar (el icono del disquete).</span><span class="sxs-lookup"><span data-stu-id="2423f-183">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="2423f-184">En segundo plano, Entity Designer genera un conjunto de clases de C.</span><span class="sxs-lookup"><span data-stu-id="2423f-184">Behind the scenes, the Entity Designer generates a set of C# classes.</span></span> <span data-ttu-id="2423f-185">Puede ver estas clases abriendo el archivo MoviesDBModel.Designer.cs desde la ventana Explorador de soluciones.</span><span class="sxs-lookup"><span data-stu-id="2423f-185">You can view these classes by opening the MoviesDBModel.Designer.cs file from the Solution Explorer window.</span></span>

<span data-ttu-id="2423f-186">No modifique el código del archivo Designer.cs ya que los cambios se sobrescribirán la próxima vez que use Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="2423f-186">Don't modify the code in the Designer.cs file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="2423f-187">Si desea ampliar la funcionalidad de las clases de entidad definidas en el archivo Designer.cs, puede crear *clases parciales* en archivos independientes.</span><span class="sxs-lookup"><span data-stu-id="2423f-187">If you want to extend the functionality of the entity classes defined in the Designer.cs file then you can create *partial classes* in separate files.</span></span>

#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="2423f-188">Selección de registros de base de datos con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="2423f-188">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="2423f-189">Comencemos a crear nuestra aplicación Movie Database creando una página que muestre una lista de registros de películas.</span><span class="sxs-lookup"><span data-stu-id="2423f-189">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="2423f-190">El controlador Home del listado 1 expone una acción denominada Index().</span><span class="sxs-lookup"><span data-stu-id="2423f-190">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="2423f-191">La acción Index() devuelve todos los registros de película de la tabla de base de datos Movie aprovechando Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-191">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="2423f-192">**Listado 1 – Controllers-HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="2423f-192">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample1.cs)]

<span data-ttu-id="2423f-193">Observe que el controlador en el listado 1 incluye un constructor.</span><span class="sxs-lookup"><span data-stu-id="2423f-193">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="2423f-194">El constructor inicializa un campo \_de nivel de clase denominado db.</span><span class="sxs-lookup"><span data-stu-id="2423f-194">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="2423f-195">El \_campo db representa las entidades de base de datos generadas por Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-195">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="2423f-196">El \_campo db es una instancia de la clase MoviesDBEntities generada por Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="2423f-196">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>

<span data-ttu-id="2423f-197">Para usar la claseMoviesDBEntities en el controlador Home, debe importar el espacio de nombres MovieEntityApp.Models (*MVCProjectName*. Modelos).</span><span class="sxs-lookup"><span data-stu-id="2423f-197">In order to use theMoviesDBEntities class in the Home controller, you must import the MovieEntityApp.Models namespace (*MVCProjectName*.Models).</span></span>

<span data-ttu-id="2423f-198">El \_campo db se utiliza dentro de la acción Index() para recuperar los registros de la tabla de base de datos Movies.</span><span class="sxs-lookup"><span data-stu-id="2423f-198">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="2423f-199">La \_expresión db. MovieSet representa todos los registros de la tabla de base de datos Movies.</span><span class="sxs-lookup"><span data-stu-id="2423f-199">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="2423f-200">El método ToList() se utiliza para convertir el conjunto de&lt;películas en una colección genérica de objetos Movie (List Movie&gt;).</span><span class="sxs-lookup"><span data-stu-id="2423f-200">The ToList() method is used to convert the set of movies into a generic collection of Movie objects (List&lt;Movie&gt;).</span></span>

<span data-ttu-id="2423f-201">Los registros de película se recuperan con la ayuda de LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="2423f-201">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="2423f-202">La acción Index() del listado 1 utiliza la *sintaxis* del método LINQ para recuperar el conjunto de registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-202">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="2423f-203">Si lo prefiere, puede usar la *sintaxis* de consulta LINQ en su lugar.</span><span class="sxs-lookup"><span data-stu-id="2423f-203">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="2423f-204">Las dos sentencias siguientes hacen lo mismo:</span><span class="sxs-lookup"><span data-stu-id="2423f-204">The following two statements do the very same thing:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample2.cs)]

<span data-ttu-id="2423f-205">Use la sintaxis LINQ (sintaxis de método o sintaxis de consulta) que encuentre más intuitiva.</span><span class="sxs-lookup"><span data-stu-id="2423f-205">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="2423f-206">No hay diferencia en el rendimiento entre los dos enfoques: la única diferencia es el estilo.</span><span class="sxs-lookup"><span data-stu-id="2423f-206">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="2423f-207">La vista del listado 2 se utiliza para mostrar los registros de película.</span><span class="sxs-lookup"><span data-stu-id="2423f-207">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="2423f-208">**Listado 2 – Vistas-Home-Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="2423f-208">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample3.aspx)]

<span data-ttu-id="2423f-209">La vista del listado 2 contiene un bucle **foreach** que recorre en iteración cada registro de película y muestra los valores de las propiedades Title y Director del registro de película.</span><span class="sxs-lookup"><span data-stu-id="2423f-209">The view in Listing 2 contains a **foreach** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="2423f-210">Observe que se muestra un vínculo Editar y eliminar junto a cada registro.</span><span class="sxs-lookup"><span data-stu-id="2423f-210">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="2423f-211">Además, aparece un vínculo Agregar película en la parte inferior de la vista (consulte la figura 7).</span><span class="sxs-lookup"><span data-stu-id="2423f-211">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="2423f-212">**Figura 7 – La vista de índice**</span><span class="sxs-lookup"><span data-stu-id="2423f-212">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-cs/_static/image7.jpg)

<span data-ttu-id="2423f-214">La vista de índice es una *vista con tipo.*</span><span class="sxs-lookup"><span data-stu-id="2423f-214">The Index view is a *typed view*.</span></span> <span data-ttu-id="2423f-215">La vista de &lt;índice incluye&gt; una directiva % , % de página % con un *atributo Inherits* que convierte la propiedad Model en una colección List genérica fuertemente tipada de objetos Movie (List&lt;Movie).</span><span class="sxs-lookup"><span data-stu-id="2423f-215">The Index view includes a &lt;%@ Page %&gt; directive with an *Inherits* attribute that casts the Model property to a strongly typed generic List collection of Movie objects (List&lt;Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="2423f-216">Insertar registros de base de datos con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="2423f-216">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="2423f-217">Puede usar Entity Framework para facilitar la inserción de nuevos registros en una tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-217">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="2423f-218">El listado 3 contiene dos nuevas acciones agregadas a la clase de controlador Home que puede usar para insertar nuevos registros en la tabla de base de datos Movie.</span><span class="sxs-lookup"><span data-stu-id="2423f-218">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="2423f-219">**Listado 3 – Controllers-HomeController.cs (Add methods)**</span><span class="sxs-lookup"><span data-stu-id="2423f-219">**Listing 3 – Controllers\HomeController.cs (Add methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample4.cs)]

<span data-ttu-id="2423f-220">La primera acción Add() simplemente devuelve una vista.</span><span class="sxs-lookup"><span data-stu-id="2423f-220">The first Add() action simply returns a view.</span></span> <span data-ttu-id="2423f-221">La vista contiene un formulario para agregar un nuevo registro de base de datos de películas (consulte la figura 8).</span><span class="sxs-lookup"><span data-stu-id="2423f-221">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="2423f-222">Al enviar el formulario, se invoca la segunda acción Add().</span><span class="sxs-lookup"><span data-stu-id="2423f-222">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="2423f-223">Observe que la segunda acción Add() está decorada con el atributo AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="2423f-223">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="2423f-224">Esta acción solo se puede invocar al realizar una operación HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="2423f-224">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="2423f-225">En otras palabras, esta acción solo se puede invocar al publicar un formulario HTML.</span><span class="sxs-lookup"><span data-stu-id="2423f-225">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="2423f-226">La segunda acción Add() crea una nueva instancia de la clase Entity Framework Movie con la ayuda del método TryUpdateModel() de ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="2423f-226">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="2423f-227">El método TryUpdateModel() toma los campos de FormCollection pasados al método Add() y asigna los valores de estos campos de formulario HTML a la clase Movie.</span><span class="sxs-lookup"><span data-stu-id="2423f-227">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>

<span data-ttu-id="2423f-228">Al usar Entity Framework, debe proporcionar una "lista blanca" de propiedades al usar los métodos TryUpdateModel o UpdateModel para actualizar las propiedades de una clase de entidad.</span><span class="sxs-lookup"><span data-stu-id="2423f-228">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>

<span data-ttu-id="2423f-229">A continuación, la acción Add() realiza una validación de formulario sencilla.</span><span class="sxs-lookup"><span data-stu-id="2423f-229">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="2423f-230">La acción comprueba que las propiedades Title y Director tienen valores.</span><span class="sxs-lookup"><span data-stu-id="2423f-230">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="2423f-231">Si hay un error de validación, se agrega un mensaje de error de validación a ModelState.</span><span class="sxs-lookup"><span data-stu-id="2423f-231">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="2423f-232">Si no hay errores de validación, se agrega un nuevo registro de película a la tabla de base de datos Movies con la ayuda de Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-232">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="2423f-233">El nuevo registro se agrega a la base de datos con las dos líneas de código siguientes:</span><span class="sxs-lookup"><span data-stu-id="2423f-233">The new record is added to the database with the following two lines of code:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample5.cs)]

<span data-ttu-id="2423f-234">La primera línea de código agrega la nueva Movie entidad al conjunto de películas que realiza el seguimiento de Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-234">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="2423f-235">La segunda línea de código guarda los cambios realizados en el Movies que se realiza el seguimiento en la base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="2423f-235">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="2423f-236">**Figura 8 – La vista Agregar**</span><span class="sxs-lookup"><span data-stu-id="2423f-236">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-cs/_static/image8.jpg)

#### <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="2423f-238">Actualización de registros de base de datos con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="2423f-238">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="2423f-239">Puede seguir casi el mismo enfoque para editar un registro de base de datos con Entity Framework como el enfoque que acabamos de seguir para insertar un nuevo registro de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-239">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="2423f-240">El listado 4 contiene dos nuevas acciones de controlador denominadas Edit().</span><span class="sxs-lookup"><span data-stu-id="2423f-240">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="2423f-241">La primera acción Edit() devuelve un formulario HTML para editar un registro de película.</span><span class="sxs-lookup"><span data-stu-id="2423f-241">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="2423f-242">La segunda acción Edit() intenta actualizar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-242">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="2423f-243">**Listado 4 – Controllers-HomeController.cs (Métodos de edición)**</span><span class="sxs-lookup"><span data-stu-id="2423f-243">**Listing 4 – Controllers\HomeController.cs (Edit methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample6.cs)]

<span data-ttu-id="2423f-244">La segunda acción Edit() comienza recuperando el registro Movie de la base de datos que coincide con el identificador de la película que se está editando.</span><span class="sxs-lookup"><span data-stu-id="2423f-244">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="2423f-245">La siguiente instrucción LINQ to Entities captura el primer registro de base de datos que coincide con un identificador determinado:</span><span class="sxs-lookup"><span data-stu-id="2423f-245">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample7.cs)]

<span data-ttu-id="2423f-246">A continuación, se utiliza el método TryUpdateModel() para asignar los valores de los campos de formulario HTML a las propiedades de la entidad de película.</span><span class="sxs-lookup"><span data-stu-id="2423f-246">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="2423f-247">Observe que se proporciona una lista blanca para especificar las propiedades exactas que se va a actualizar.</span><span class="sxs-lookup"><span data-stu-id="2423f-247">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="2423f-248">A continuación, se realiza una validación sencilla para comprobar que las propiedades Título de película y Director tienen valores.</span><span class="sxs-lookup"><span data-stu-id="2423f-248">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="2423f-249">Si a cualquiera de las propiedades le falta un valor, se agrega un mensaje de error de validación a ModelState y ModelState.IsValid devuelve el valor false.</span><span class="sxs-lookup"><span data-stu-id="2423f-249">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="2423f-250">Por último, si no hay errores de validación, la tabla de base de datos Movies subyacente se actualiza con cualquier cambio llamando al método SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="2423f-250">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="2423f-251">Al editar registros de base de datos, debe pasar el identificador del registro que se está editando a la acción del controlador que realiza la actualización de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-251">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="2423f-252">De lo contrario, la acción del controlador no sabrá qué registro actualizar en la base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="2423f-252">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="2423f-253">La vista Editar, contenida en el listado 5, incluye un campo de formulario oculto que representa el identificador del registro de base de datos que se está editando.</span><span class="sxs-lookup"><span data-stu-id="2423f-253">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="2423f-254">**Listado 5 – Vistas-Home-Edit.aspx**</span><span class="sxs-lookup"><span data-stu-id="2423f-254">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="2423f-255">Eliminación de registros de base de datos con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="2423f-255">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="2423f-256">La operación final de la base de datos, que necesitamos abordar en este tutorial, es eliminar los registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-256">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="2423f-257">Puede utilizar la acción de controlador en el listado 6 para eliminar un registro de base de datos determinado.</span><span class="sxs-lookup"><span data-stu-id="2423f-257">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="2423f-258">**Listado 6 -- "Controllers" (eliminar acción)**</span><span class="sxs-lookup"><span data-stu-id="2423f-258">**Listing 6 -- \Controllers\HomeController.cs (Delete action)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample9.cs)]

<span data-ttu-id="2423f-259">La acción Delete() recupera primero la entidad Movie que coincide con el identificador pasado a la acción.</span><span class="sxs-lookup"><span data-stu-id="2423f-259">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="2423f-260">A continuación, la película se elimina de la base de datos llamando al método DeleteObject() seguido del método SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="2423f-260">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="2423f-261">Por último, se redirige al usuario a la vista de índice.</span><span class="sxs-lookup"><span data-stu-id="2423f-261">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="2423f-262">Resumen</span><span class="sxs-lookup"><span data-stu-id="2423f-262">Summary</span></span>

<span data-ttu-id="2423f-263">El propósito de este tutorial era demostrar cómo puede crear aplicaciones web controladas por base de datos aprovechando ASP.NET MVC y Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="2423f-263">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="2423f-264">Ha aprendido a crear una aplicación que le permite seleccionar, insertar, actualizar y eliminar registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-264">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="2423f-265">En primer lugar, se describe cómo puede usar el Asistente para Entity Data Model para generar un Entity Data Model desde Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="2423f-265">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="2423f-266">A continuación, aprenderá a usar LINQ to Entities para recuperar un conjunto de registros de base de datos de una tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-266">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="2423f-267">Por último, usamos Entity Framework para insertar, actualizar y eliminar registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2423f-267">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="2423f-268">Siguiente</span><span class="sxs-lookup"><span data-stu-id="2423f-268">Next</span></span>](creating-model-classes-with-linq-to-sql-cs.md)

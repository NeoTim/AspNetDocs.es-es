---
uid: web-forms/overview/data-access/paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb
title: Página de forma eficaz a través de grandes cantidades de datos (VB) | Microsoft Docs
author: rick-anderson
description: La opción de paginación predeterminada de un control de presentación de datos es adecuada cuando se trabaja con grandes cantidades de datos, como su retriev subyacente de control de origen de datos...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: 3e20e64a-8808-4b49-88d6-014e2629d56f
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 5870b9ac2af7d9df927edd8230334dee4885c6a1
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/01/2019
ms.locfileid: "57056762"
---
<a name="efficiently-paging-through-large-amounts-of-data-vb"></a><span data-ttu-id="cd319-103">Pasar página por grandes cantidades de datos de forma eficaz (VB)</span><span class="sxs-lookup"><span data-stu-id="cd319-103">Efficiently Paging Through Large Amounts of Data (VB)</span></span>
====================
<span data-ttu-id="cd319-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cd319-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cd319-105">[Descargue la aplicación de ejemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_25_VB.exe) o [descargar PDF](efficiently-paging-through-large-amounts-of-data-vb/_static/datatutorial25vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cd319-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_25_VB.exe) or [Download PDF](efficiently-paging-through-large-amounts-of-data-vb/_static/datatutorial25vb1.pdf)</span></span>

> <span data-ttu-id="cd319-106">La opción de paginación predeterminada de un control de presentación de datos es adecuada cuando se trabaja con grandes cantidades de datos, como su control de origen de datos subyacente recupera todos los registros, incluso si se muestra solo un subconjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="cd319-106">The default paging option of a data presentation control is unsuitable when working with large amounts of data, as its underlying data source control retrieves all records, even though only a subset of data is displayed.</span></span> <span data-ttu-id="cd319-107">En tales circunstancias, se debe activar en personalizada paginación.</span><span class="sxs-lookup"><span data-stu-id="cd319-107">In such circumstances, we must turn to custom paging.</span></span>


## <a name="introduction"></a><span data-ttu-id="cd319-108">Introducción</span><span class="sxs-lookup"><span data-stu-id="cd319-108">Introduction</span></span>

<span data-ttu-id="cd319-109">Como se explicó en el tutorial anterior, se puede implementar la paginación en uno de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="cd319-109">As we discussed in the preceding tutorial, paging can be implemented in one of two ways:</span></span>

- <span data-ttu-id="cd319-110">**Paginación predeterminada** puede implementarse con sólo marcar la opción de habilitar la paginación en el control Web s de datos de etiqueta inteligente; sin embargo, cada vez que ve una página de datos, recupera el origen ObjectDataSource *todas* de los registros, incluso Aunque sólo un subconjunto de ellos se muestran en la página</span><span class="sxs-lookup"><span data-stu-id="cd319-110">**Default Paging** can be implemented by simply checking the Enable Paging option in the data Web control s smart tag; however, whenever viewing a page of data, the ObjectDataSource retrieves *all* of the records, even though only a subset of them are displayed in the page</span></span>
- <span data-ttu-id="cd319-111">**Paginación personalizada** mejora el rendimiento de forma predeterminada paginación por recuperar solo los registros de la base de datos que se deben mostrar para la página de datos solicitados por el usuario; sin embargo, la paginación personalizada implica un mayor esfuerzo para implementar que la paginación predeterminada</span><span class="sxs-lookup"><span data-stu-id="cd319-111">**Custom Paging** improves the performance of default paging by retrieving only those records from the database that need to be displayed for the particular page of data requested by the user; however, custom paging involves a bit more effort to implement than default paging</span></span>

<span data-ttu-id="cd319-112">Debido a la facilidad de comprobación de implementación solo una casilla y que se van a realizar.</span><span class="sxs-lookup"><span data-stu-id="cd319-112">Due to the ease of implementation just check a checkbox and you re done!</span></span> <span data-ttu-id="cd319-113">paginación predeterminada es una opción atractiva.</span><span class="sxs-lookup"><span data-stu-id="cd319-113">default paging is an attractive option.</span></span> <span data-ttu-id="cd319-114">Su enfoque de ve na en recuperar todos los registros, sin embargo, resulta una opción inverosímil al paginar a través de lo suficientemente grandes cantidades de datos o para sitios con muchos usuarios simultáneos.</span><span class="sxs-lookup"><span data-stu-id="cd319-114">Its na�ve approach in retrieving all of the records, though, makes it an implausible choice when paging through sufficiently large amounts of data or for sites with many concurrent users.</span></span> <span data-ttu-id="cd319-115">En tales circunstancias, nos debemos convertir en personalizada con el fin de proporcionar un sistema con capacidad de respuesta de paginación.</span><span class="sxs-lookup"><span data-stu-id="cd319-115">In such circumstances, we must turn to custom paging in order to provide a responsive system.</span></span>

<span data-ttu-id="cd319-116">El desafío de la paginación personalizada es poder escribir una consulta que devuelve el conjunto de registros necesarios para una determinada página de datos.</span><span class="sxs-lookup"><span data-stu-id="cd319-116">The challenge of custom paging is being able to write a query that returns the precise set of records needed for a particular page of data.</span></span> <span data-ttu-id="cd319-117">Afortunadamente, Microsoft SQL Server 2005 proporciona una nueva palabra clave para resultados de la clasificación, lo que nos permite escribir una consulta que puede recuperar eficazmente el subconjunto correcto de registros.</span><span class="sxs-lookup"><span data-stu-id="cd319-117">Fortunately, Microsoft SQL Server 2005 provides a new keyword for ranking results, which enables us to write a query that can efficiently retrieve the proper subset of records.</span></span> <span data-ttu-id="cd319-118">En este tutorial, veremos cómo usar esta nueva palabra clave de SQL Server 2005 para implementar la paginación personalizada en un control GridView.</span><span class="sxs-lookup"><span data-stu-id="cd319-118">In this tutorial we'll see how to use this new SQL Server 2005 keyword to implement custom paging in a GridView control.</span></span> <span data-ttu-id="cd319-119">Mientras que la interfaz de usuario para la paginación personalizada es idéntica a la paginación de forma predeterminada, ejecución paso a paso de una página a la siguiente mediante paginación personalizada puede ser varios órdenes de magnitud más rápido que la paginación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="cd319-119">While the user interface for custom paging is identical to that for default paging, stepping from one page to the next using custom paging can be several orders of magnitude faster than default paging.</span></span>

> [!NOTE]
> <span data-ttu-id="cd319-120">El número total de registros que se va a paginar a través y la carga que se va a colocar en el servidor de base de datos depende de la ganancia de rendimiento exacto mostrada por la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="cd319-120">The exact performance gain exhibited by custom paging depends on the total number of records being paged through and the load being placed on the database server.</span></span> <span data-ttu-id="cd319-121">Al final de este tutorial veremos algunas métricas aproximadas que presentan las ventajas de rendimiento obtenido a través de la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="cd319-121">At the end of this tutorial we'll look at some rough metrics that showcase the benefits in performance obtained through custom paging.</span></span>


## <a name="step-1-understanding-the-custom-paging-process"></a><span data-ttu-id="cd319-122">Paso 1: Descripción del proceso de paginación personalizada</span><span class="sxs-lookup"><span data-stu-id="cd319-122">Step 1: Understanding the Custom Paging Process</span></span>

<span data-ttu-id="cd319-123">Cuando la paginación de datos, los registros precisos mostrados en una página dependen de la página de datos que se solicita y el número de registros mostrados por página.</span><span class="sxs-lookup"><span data-stu-id="cd319-123">When paging through data, the precise records displayed in a page depend upon the page of data being requested and the number of records displayed per page.</span></span> <span data-ttu-id="cd319-124">Por ejemplo, imagine que queríamos paginar a través de los 81 productos, mostrar los 10 productos por página.</span><span class="sxs-lookup"><span data-stu-id="cd319-124">For example, imagine that we wanted to page through the 81 products, displaying 10 products per page.</span></span> <span data-ttu-id="cd319-125">Al ver la primera página, d queremos productos 1 a 10; al ver la segunda página se d que le interese 11 20 a través de productos y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="cd319-125">When viewing the first page, we d want products 1 through 10; when viewing the second page we d be interested in products 11 through 20, and so on.</span></span>

<span data-ttu-id="cd319-126">Hay tres variables que determinen qué registros deben recuperarse y cómo se debe representar la interfaz de paginación:</span><span class="sxs-lookup"><span data-stu-id="cd319-126">There are three variables that dictate what records need to be retrieved and how the paging interface should be rendered:</span></span>

- <span data-ttu-id="cd319-127">**Índice de fila inicial** el índice de la primera fila de la página de datos que se va a mostrar; este índice se puede calcularse multiplicando el índice de página por los registros que se va a mostrar por página y agregando uno.</span><span class="sxs-lookup"><span data-stu-id="cd319-127">**Start Row Index** the index of the first row in the page of data to display; this index can be calculated by multiplying the page index by the records to display per page and adding one.</span></span> <span data-ttu-id="cd319-128">Por ejemplo, al paginar a través de los registros de 10 a la vez, para la primera página (cuyo índice de página es 0), el índice de fila inicial es 0 \* 10 + 1 o 1; la segunda página (cuyo índice de página es 1), el índice de fila inicial es 1 \* 10 + 1 , o 11.</span><span class="sxs-lookup"><span data-stu-id="cd319-128">For example, when paging through records 10 at a time, for the first page (whose page index is 0), the Start Row Index is 0 \* 10 + 1, or 1; for the second page (whose page index is 1), the Start Row Index is 1 \* 10 + 1, or 11.</span></span>
- <span data-ttu-id="cd319-129">**Número máximo de filas** el número máximo de registros que se muestran por página.</span><span class="sxs-lookup"><span data-stu-id="cd319-129">**Maximum Rows** the maximum number of records to display per page.</span></span> <span data-ttu-id="cd319-130">Esta variable se conoce como el número máximo de filas ya para la última página hay puede ser menos registros devueltos que el tamaño de página.</span><span class="sxs-lookup"><span data-stu-id="cd319-130">This variable is referred to as maximum rows since for the last page there may be fewer records returned than the page size.</span></span> <span data-ttu-id="cd319-131">Por ejemplo, al paginar a través de los registros de 81 productos 10 por página, la página final y novena tendrá sólo un registro.</span><span class="sxs-lookup"><span data-stu-id="cd319-131">For example, when paging through the 81 products 10 records per page, the ninth and final page will have just one record.</span></span> <span data-ttu-id="cd319-132">Sin embargo, no hay ninguna página, mostrará más registros que el valor de número máximo de filas.</span><span class="sxs-lookup"><span data-stu-id="cd319-132">No page, though, will show more records than the Maximum Rows value.</span></span>
- <span data-ttu-id="cd319-133">**Número de registros total** el número total de registros que se va a paginar a través.</span><span class="sxs-lookup"><span data-stu-id="cd319-133">**Total Record Count** the total number of records being paged through.</span></span> <span data-ttu-id="cd319-134">Aunque esta variable no es necesario para determinar qué registros para recuperar de una página determinada, indican la interfaz de paginación.</span><span class="sxs-lookup"><span data-stu-id="cd319-134">While this variable isn t needed to determine what records to retrieve for a given page, it does dictate the paging interface.</span></span> <span data-ttu-id="cd319-135">Por ejemplo, si hay 81 productos que se va a paginar a través, sabe la interfaz de paginación para mostrar los números de página nueve en el interfaz de usuario de paginación.</span><span class="sxs-lookup"><span data-stu-id="cd319-135">For example, if there are 81 products being paged through, the paging interface knows to display nine page numbers in the paging UI.</span></span>

<span data-ttu-id="cd319-136">Con la paginación de forma predeterminada, el índice de fila inicial se calcula como el producto del índice de la página y el tamaño de página más uno, mientras que el número máximo de filas es simplemente el tamaño de página.</span><span class="sxs-lookup"><span data-stu-id="cd319-136">With default paging, the Start Row Index is computed as the product of the page index and the page size plus one, whereas the Maximum Rows is simply the page size.</span></span> <span data-ttu-id="cd319-137">Puesto que la paginación predeterminada recupera todos los registros de la base de datos al representar cualquier página de datos, el índice para cada fila se conoce, por lo que el cambio a la fila de índice de fila de iniciar una tarea trivial.</span><span class="sxs-lookup"><span data-stu-id="cd319-137">Since default paging retrieves all of the records from the database when rendering any page of data, the index for each row is known, thereby making moving to Start Row Index row a trivial task.</span></span> <span data-ttu-id="cd319-138">Además, el número Total de registros está disponible, tal y como s simplemente el número de registros en la tabla de datos (o cualquier objeto se utiliza para almacenar los resultados de la base de datos).</span><span class="sxs-lookup"><span data-stu-id="cd319-138">Moreover, the Total Record Count is readily available, as it s simply the number of records in the DataTable (or whatever object is being used to hold the database results).</span></span>

<span data-ttu-id="cd319-139">Dadas las variables de índice de fila inicial y el número máximo de filas, una implementación personalizada de paginación debe devolver solo el preciso subconjunto de registros empezando por el índice de fila inicial y hasta el número máximo de filas de registros después de eso.</span><span class="sxs-lookup"><span data-stu-id="cd319-139">Given the Start Row Index and Maximum Rows variables, a custom paging implementation must only return the precise subset of records starting at the Start Row Index and up to Maximum Rows number of records after that.</span></span> <span data-ttu-id="cd319-140">Paginación personalizada proporciona dos desafíos:</span><span class="sxs-lookup"><span data-stu-id="cd319-140">Custom paging provides two challenges:</span></span>

- <span data-ttu-id="cd319-141">Debemos poder asociar eficazmente un índice de fila con cada fila en todos los datos que se va a paginar a través de por lo que podemos comenzar a devolver los registros en el índice de fila de inicio especificado</span><span class="sxs-lookup"><span data-stu-id="cd319-141">We must be able to efficiently associate a row index with each row in the entire data being paged through so that we can start returning records at the specified Start Row Index</span></span>
- <span data-ttu-id="cd319-142">Se debe proporcionar el número total de registros que se va a paginar a través de</span><span class="sxs-lookup"><span data-stu-id="cd319-142">We need to provide the total number of records being paged through</span></span>

<span data-ttu-id="cd319-143">En los dos pasos siguientes, examinaremos el script SQL necesario para responder a estas dos desafíos.</span><span class="sxs-lookup"><span data-stu-id="cd319-143">In the next two steps we'll examine the SQL script needed to respond to these two challenges.</span></span> <span data-ttu-id="cd319-144">Además de la secuencia de comandos SQL, también se necesitará implementar métodos en la capa DAL y BLL.</span><span class="sxs-lookup"><span data-stu-id="cd319-144">In addition to the SQL script, we'll also need to implement methods in the DAL and BLL.</span></span>

## <a name="step-2-returning-the-total-number-of-records-being-paged-through"></a><span data-ttu-id="cd319-145">Paso 2: Devuelve el número Total de registros que se va a paginar a través de</span><span class="sxs-lookup"><span data-stu-id="cd319-145">Step 2: Returning the Total Number of Records Being Paged Through</span></span>

<span data-ttu-id="cd319-146">Antes de examinar cómo recuperar el subconjunto preciso de los registros de la página que se muestran, permiten s primer vistazo a cómo se devuelve el número total de registros que se va a paginar a través.</span><span class="sxs-lookup"><span data-stu-id="cd319-146">Before we examine how to retrieve the precise subset of records for the page being displayed, let s first look at how to return the total number of records being paged through.</span></span> <span data-ttu-id="cd319-147">Esta información es necesaria para configurar correctamente la interfaz de usuario de paginación.</span><span class="sxs-lookup"><span data-stu-id="cd319-147">This information is needed in order to properly configure the paging user interface.</span></span> <span data-ttu-id="cd319-148">El número total de registros devueltos por una consulta SQL determinada puede obtenerse utilizando el [ `COUNT` función de agregado](https://msdn.microsoft.com/library/ms175997.aspx).</span><span class="sxs-lookup"><span data-stu-id="cd319-148">The total number of records returned by a particular SQL query can be obtained by using the [`COUNT` aggregate function](https://msdn.microsoft.com/library/ms175997.aspx).</span></span> <span data-ttu-id="cd319-149">Por ejemplo, para determinar el número total de registros en el `Products` tabla, podemos usar la siguiente consulta:</span><span class="sxs-lookup"><span data-stu-id="cd319-149">For example, to determine the total number of records in the `Products` table, we can use the following query:</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample1.sql)]

<span data-ttu-id="cd319-150">Permitir s Agregar un método a nuestro DAL que devuelve esta información.</span><span class="sxs-lookup"><span data-stu-id="cd319-150">Let s add a method to our DAL that returns this information.</span></span> <span data-ttu-id="cd319-151">En concreto, vamos a crear un método DAL llamado `TotalNumberOfProducts()` que se ejecuta el `SELECT` instrucción mostrado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="cd319-151">In particular, we'll create a DAL method called `TotalNumberOfProducts()` that executes the `SELECT` statement shown above.</span></span>

<span data-ttu-id="cd319-152">Comience abriendo la `Northwind.xsd` DataSet con tipo de archivo en el `App_Code/DAL` carpeta.</span><span class="sxs-lookup"><span data-stu-id="cd319-152">Start by opening the `Northwind.xsd` Typed DataSet file in the `App_Code/DAL` folder.</span></span> <span data-ttu-id="cd319-153">A continuación, haga doble clic en el `ProductsTableAdapter` en el diseñador y seleccione Add Query.</span><span class="sxs-lookup"><span data-stu-id="cd319-153">Next, right-click on the `ProductsTableAdapter` in the Designer and choose Add Query.</span></span> <span data-ttu-id="cd319-154">Como se ve visto en los tutoriales anteriores, esto nos permitirá agregar un nuevo método a la capa DAL que, cuando se invoca, se ejecutará una determinada instrucción SQL o procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="cd319-154">As we ve seen in previous tutorials, this will allow us to add a new method to the DAL that, when invoked, will execute a particular SQL statement or stored procedure.</span></span> <span data-ttu-id="cd319-155">Al igual que con nuestros métodos de TableAdapter en los tutoriales anteriores, en esta ocasión optar por usar una instrucción de SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="cd319-155">As with our TableAdapter methods in previous tutorials, for this one opt to use an ad-hoc SQL statement.</span></span>


![Utilice una instrucción de SQL Ad Hoc](efficiently-paging-through-large-amounts-of-data-vb/_static/image1.png)

<span data-ttu-id="cd319-157">**Figura 1**: Utilice una instrucción de SQL Ad Hoc</span><span class="sxs-lookup"><span data-stu-id="cd319-157">**Figure 1**: Use an Ad-Hoc SQL Statement</span></span>


<span data-ttu-id="cd319-158">Podemos especificar qué tipo de consulta para crear en la pantalla siguiente.</span><span class="sxs-lookup"><span data-stu-id="cd319-158">On the next screen we can specify what type of query to create.</span></span> <span data-ttu-id="cd319-159">Puesto que esta consulta devolverá un único valor escalar el número total de registros en el `Products` tabla elegir el `SELECT` que devuelve una opción de valor único.</span><span class="sxs-lookup"><span data-stu-id="cd319-159">Since this query will return a single, scalar value the total number of records in the `Products` table choose the `SELECT` which returns a singe value option.</span></span>


![Configurar la consulta para utilizar una instrucción SELECT que devuelve un valor único](efficiently-paging-through-large-amounts-of-data-vb/_static/image2.png)

<span data-ttu-id="cd319-161">**Figura 2**: Configurar la consulta para utilizar una instrucción SELECT que devuelve un valor único</span><span class="sxs-lookup"><span data-stu-id="cd319-161">**Figure 2**: Configure the Query to Use a SELECT Statement that Returns a Single Value</span></span>


<span data-ttu-id="cd319-162">Después de que indica el tipo de consulta que se utilizará, a continuación se debe especificar la consulta.</span><span class="sxs-lookup"><span data-stu-id="cd319-162">After indicating the type of query to use, we must next specify the query.</span></span>


![Utilice la seleccione COUNT(\*) de consulta de productos](efficiently-paging-through-large-amounts-of-data-vb/_static/image3.png)

<span data-ttu-id="cd319-164">**Figura 3**: Use el número de SELECT (\*) FROM productos consulta</span><span class="sxs-lookup"><span data-stu-id="cd319-164">**Figure 3**: Use the SELECT COUNT(\*) FROM Products Query</span></span>


<span data-ttu-id="cd319-165">Por último, especifique el nombre del método.</span><span class="sxs-lookup"><span data-stu-id="cd319-165">Finally, specify the name for the method.</span></span> <span data-ttu-id="cd319-166">Como s mencionados anteriormente, permiten usar `TotalNumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="cd319-166">As aforementioned, let s use `TotalNumberOfProducts`.</span></span>


![Nombre de la TotalNumberOfProducts DAL (método)](efficiently-paging-through-large-amounts-of-data-vb/_static/image4.png)

<span data-ttu-id="cd319-168">**Figura 4**: Nombre de la TotalNumberOfProducts DAL (método)</span><span class="sxs-lookup"><span data-stu-id="cd319-168">**Figure 4**: Name the DAL Method TotalNumberOfProducts</span></span>


<span data-ttu-id="cd319-169">Después de hacer clic en Finalizar, el asistente agregará la `TotalNumberOfProducts` método a la capa DAL.</span><span class="sxs-lookup"><span data-stu-id="cd319-169">After clicking Finish, the wizard will add the `TotalNumberOfProducts` method to the DAL.</span></span> <span data-ttu-id="cd319-170">Los métodos devuelven escalares en la capa DAL devuelven tipos que aceptan valores NULL, en caso de que el resultado de la consulta SQL es `NULL`.</span><span class="sxs-lookup"><span data-stu-id="cd319-170">The scalar returning methods in the DAL return nullable types, in case the result from the SQL query is `NULL`.</span></span> <span data-ttu-id="cd319-171">Nuestro `COUNT` consulta, sin embargo, siempre devolverá una que no sean de`NULL` valor; en cualquier caso, el método DAL devuelve un entero que acepta valores NULL.</span><span class="sxs-lookup"><span data-stu-id="cd319-171">Our `COUNT` query, however, will always return a non-`NULL` value; regardless, the DAL method returns a nullable integer.</span></span>

<span data-ttu-id="cd319-172">Además del método DAL, también se necesita un método en la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="cd319-172">In addition to the DAL method, we also need a method in the BLL.</span></span> <span data-ttu-id="cd319-173">Abra el `ProductsBLL` archivo de clase y agregue un `TotalNumberOfProducts` método que llama simplemente hacia abajo a la s DAL `TotalNumberOfProducts` método:</span><span class="sxs-lookup"><span data-stu-id="cd319-173">Open the `ProductsBLL` class file and add a `TotalNumberOfProducts` method that simply calls down to the DAL s `TotalNumberOfProducts` method:</span></span>


[!code-vb[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample2.vb)]

<span data-ttu-id="cd319-174">La s DAL `TotalNumberOfProducts` método devuelve un entero que acepta valores NULL; sin embargo, se ve que se creó el `ProductsBLL` clase s `TotalNumberOfProducts` método para que devuelva un entero estándar.</span><span class="sxs-lookup"><span data-stu-id="cd319-174">The DAL s `TotalNumberOfProducts` method returns a nullable integer; however, we ve created the `ProductsBLL` class s `TotalNumberOfProducts` method so that it returns a standard integer.</span></span> <span data-ttu-id="cd319-175">Por lo tanto, necesitamos tener la `ProductsBLL` clase s `TotalNumberOfProducts` método devuelve la parte del valor del entero que acepta valores NULL devuelto por la s DAL `TotalNumberOfProducts` método.</span><span class="sxs-lookup"><span data-stu-id="cd319-175">Therefore, we need to have the `ProductsBLL` class s `TotalNumberOfProducts` method return the value portion of the nullable integer returned by the DAL s `TotalNumberOfProducts` method.</span></span> <span data-ttu-id="cd319-176">La llamada a `GetValueOrDefault()` devuelve el valor del entero que acepta valores NULL, si existe; si el entero que acepta valores NULL es `null`, sin embargo, devuelve el valor del entero de forma predeterminada, 0.</span><span class="sxs-lookup"><span data-stu-id="cd319-176">The call to `GetValueOrDefault()` returns the value of the nullable integer, if it exists; if the nullable integer is `null`, however, it returns the default integer value, 0.</span></span>

## <a name="step-3-returning-the-precise-subset-of-records"></a><span data-ttu-id="cd319-177">Paso 3: Devolver el preciso subconjunto de registros</span><span class="sxs-lookup"><span data-stu-id="cd319-177">Step 3: Returning the Precise Subset of Records</span></span>

<span data-ttu-id="cd319-178">La siguiente tarea consiste en crear métodos de DAL y BLL que aceptan el índice de fila inicial y las variables de número máximo de filas describen anteriormente y devuelvan los registros correspondientes.</span><span class="sxs-lookup"><span data-stu-id="cd319-178">Our next task is to create methods in the DAL and BLL that accept the Start Row Index and Maximum Rows variables discussed earlier and return the appropriate records.</span></span> <span data-ttu-id="cd319-179">Antes de hacerlo, permiten s primer vistazo a la secuencia de comandos SQL necesario.</span><span class="sxs-lookup"><span data-stu-id="cd319-179">Before we do that, let s first look at the needed SQL script.</span></span> <span data-ttu-id="cd319-180">El reto de nosotros es que debemos ser capaz de asignar eficazmente un índice para cada fila en todos los resultados que se va a paginar a través de poder, podemos devolver esos registros empezando en el índice de fila inicial (y hasta el número máximo de registros de registros).</span><span class="sxs-lookup"><span data-stu-id="cd319-180">The challenge facing us is that we must be able to efficiently assign an index to each row in the entire results being paged through so that we can return just those records starting at the Start Row Index (and up to the Maximum Records number of records).</span></span>

<span data-ttu-id="cd319-181">Esto no es un desafío si ya existe una columna en la tabla de base de datos que actúa como un índice de fila.</span><span class="sxs-lookup"><span data-stu-id="cd319-181">This is not a challenge if there is already a column in the database table that serves as a row index.</span></span> <span data-ttu-id="cd319-182">A primera vista podríamos pensar que el `Products` tabla s `ProductID` campo sería suficiente, ya que tiene el primer producto `ProductID` de 1, el segundo un 2, y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="cd319-182">At first glance we might think that the `Products` table s `ProductID` field would suffice, as the first product has `ProductID` of 1, the second a 2, and so on.</span></span> <span data-ttu-id="cd319-183">Sin embargo, la eliminación de un producto deja una discontinuidad en la secuencia, anulando este enfoque.</span><span class="sxs-lookup"><span data-stu-id="cd319-183">However, deleting a product leaves a gap in the sequence, nullifying this approach.</span></span>

<span data-ttu-id="cd319-184">Hay dos técnicas generales que usa para asociar eficazmente un índice de fila con los datos en la página a través de lo que permite el subconjunto de registros que deben recuperarse preciso:</span><span class="sxs-lookup"><span data-stu-id="cd319-184">There are two general techniques used to efficiently associate a row index with the data to page through, thereby enabling the precise subset of records to be retrieved:</span></span>

- <span data-ttu-id="cd319-185">**Con SQL Server 2005 s `ROW_NUMBER()` palabra clave** es nuevo en SQL Server 2005, el `ROW_NUMBER()` palabra clave asocia una clasificación de cada registro devuelto en función de algunos pedidos.</span><span class="sxs-lookup"><span data-stu-id="cd319-185">**Using SQL Server 2005 s `ROW_NUMBER()` Keyword** new to SQL Server 2005, the `ROW_NUMBER()` keyword associates a ranking with each returned record based on some ordering.</span></span> <span data-ttu-id="cd319-186">Esta clasificación puede usarse como un índice de fila para cada fila.</span><span class="sxs-lookup"><span data-stu-id="cd319-186">This ranking can be used as a row index for each row.</span></span>
- <span data-ttu-id="cd319-187">**Uso de una Variable de tabla y `SET ROWCOUNT`**  s de SQL Server [ `SET ROWCOUNT` instrucción](https://msdn.microsoft.com/library/ms188774.aspx) puede utilizarse para especificar el número total de registros debe procesar una consulta antes de finalizar; [variables de tabla](http://www.sqlteam.com/item.asp?ItemID=9454) son variables locales de Transact-SQL que pueden contener datos tabulares, akin [tablas temporales](http://www.sqlteam.com/item.asp?ItemID=2029).</span><span class="sxs-lookup"><span data-stu-id="cd319-187">**Using a Table Variable and `SET ROWCOUNT`** SQL Server s [`SET ROWCOUNT` statement](https://msdn.microsoft.com/library/ms188774.aspx) can be used to specify how many total records a query should process before terminating; [table variables](http://www.sqlteam.com/item.asp?ItemID=9454) are local T-SQL variables that can hold tabular data, akin to [temporary tables](http://www.sqlteam.com/item.asp?ItemID=2029).</span></span> <span data-ttu-id="cd319-188">Este enfoque funciona igualmente bien con Microsoft SQL Server 2005 y SQL Server 2000 (mientras que el `ROW_NUMBER()` enfoque solo funciona con SQL Server 2005).</span><span class="sxs-lookup"><span data-stu-id="cd319-188">This approach works equally well with both Microsoft SQL Server 2005 and SQL Server 2000 (whereas the `ROW_NUMBER()` approach only works with SQL Server 2005).</span></span>  
  
  <span data-ttu-id="cd319-189">La idea aquí es crear una variable de tabla que tiene un `IDENTITY` y columnas para las claves principales de la tabla cuyos datos se envía un mensaje a través.</span><span class="sxs-lookup"><span data-stu-id="cd319-189">The idea here is to create a table variable that has an `IDENTITY` column and columns for the primary keys of the table whose data is being paged through.</span></span> <span data-ttu-id="cd319-190">A continuación, se vuelca el contenido de la tabla cuyos datos se envía un mensaje a través en la variable de tabla, con lo que se asocia un índice de fila secuenciales (a través de la `IDENTITY` columna) para cada registro en la tabla.</span><span class="sxs-lookup"><span data-stu-id="cd319-190">Next, the contents of the table whose data is being paged through is dumped into the table variable, thereby associating a sequential row index (via the `IDENTITY` column) for each record in the table.</span></span> <span data-ttu-id="cd319-191">Una vez que se ha rellenado la variable de tabla, un `SELECT` instrucción en la variable de tabla, se combina con la tabla subyacente, se puede ejecutar para extraer los registros determinados.</span><span class="sxs-lookup"><span data-stu-id="cd319-191">Once the table variable has been populated, a `SELECT` statement on the table variable, joined with the underlying table, can be executed to pull out the particular records.</span></span> <span data-ttu-id="cd319-192">El `SET ROWCOUNT` instrucción se utiliza para limitar el número de registros que se deban volcarse en la variable de tabla de forma inteligente.</span><span class="sxs-lookup"><span data-stu-id="cd319-192">The `SET ROWCOUNT` statement is used to intelligently limit the number of records that need to be dumped into the table variable.</span></span>  
  
  <span data-ttu-id="cd319-193">Esta eficacia del enfoque s se basa en el número de página que se solicita, como el `SET ROWCOUNT` valor se asigna el valor de índice de fila inicial más el número máximo de filas.</span><span class="sxs-lookup"><span data-stu-id="cd319-193">This approach s efficiency is based on the page number being requested, as the `SET ROWCOUNT` value is assigned the value of Start Row Index plus the Maximum Rows.</span></span> <span data-ttu-id="cd319-194">Al paginar a través de páginas numeradas de baja, como la primera algunas páginas de datos de este enfoque es muy eficaz.</span><span class="sxs-lookup"><span data-stu-id="cd319-194">When paging through low-numbered pages such as the first few pages of data this approach is very efficient.</span></span> <span data-ttu-id="cd319-195">Sin embargo, exhibe performance de paginación de forma predeterminada cuando se recuperan de una página cerca del final.</span><span class="sxs-lookup"><span data-stu-id="cd319-195">However, it exhibits default paging-like performance when retrieving a page near the end.</span></span>

<span data-ttu-id="cd319-196">En este tutorial implementa paginación personalizado mediante la `ROW_NUMBER()` palabra clave.</span><span class="sxs-lookup"><span data-stu-id="cd319-196">This tutorial implements custom paging using the `ROW_NUMBER()` keyword.</span></span> <span data-ttu-id="cd319-197">Para obtener más información sobre el uso de la variable de tabla y `SET ROWCOUNT` técnica, consulte [A varios métodos eficaces para paginar a través de grandes conjuntos de resultados](http://www.4guysfromrolla.com/webtech/042606-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="cd319-197">For more information on using the table variable and `SET ROWCOUNT` technique, see [A More Efficient Method for Paging Through Large Result Sets](http://www.4guysfromrolla.com/webtech/042606-1.shtml).</span></span>

<span data-ttu-id="cd319-198">El `ROW_NUMBER()` palabra clave asociada una clasificación de cada registro devuelto a través de un orden concreto utilizando la sintaxis siguiente:</span><span class="sxs-lookup"><span data-stu-id="cd319-198">The `ROW_NUMBER()` keyword associated a ranking with each record returned over a particular ordering using the following syntax:</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample3.sql)]

<span data-ttu-id="cd319-199">`ROW_NUMBER()` Devuelve un valor numérico que especifica el rango para cada registro con respecto a que el orden indicado.</span><span class="sxs-lookup"><span data-stu-id="cd319-199">`ROW_NUMBER()` returns a numerical value that specifies the rank for each record with regards to the indicated ordering.</span></span> <span data-ttu-id="cd319-200">Por ejemplo, para ver el rango para cada producto, ordenada de mayor costoso al menos, podríamos usar la siguiente consulta:</span><span class="sxs-lookup"><span data-stu-id="cd319-200">For example, to see the rank for each product, ordered from the most expensive to the least, we could use the following query:</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample4.sql)]

<span data-ttu-id="cd319-201">Figura 5 muestra esta consulta los resultados de s cuando se ejecuta a través de la ventana de consulta en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="cd319-201">Figure 5 shows this query s results when run through the query window in Visual Studio.</span></span> <span data-ttu-id="cd319-202">Tenga en cuenta que los productos se ordenan por precio, junto con un rango de precios para cada fila.</span><span class="sxs-lookup"><span data-stu-id="cd319-202">Note that the products are ordered by price, along with a price rank for each row.</span></span>


![Se incluye el rango de precios para cada registro devuelto](efficiently-paging-through-large-amounts-of-data-vb/_static/image5.png)

<span data-ttu-id="cd319-204">**Figura 5**: Se incluye el rango de precios para cada registro devuelto</span><span class="sxs-lookup"><span data-stu-id="cd319-204">**Figure 5**: The Price Rank is Included for Each Returned Record</span></span>


> [!NOTE]
> <span data-ttu-id="cd319-205">`ROW_NUMBER()` es solo una de las muchas nuevas funciones de categoría disponibles en SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="cd319-205">`ROW_NUMBER()` is just one of the many new ranking functions available in SQL Server 2005.</span></span> <span data-ttu-id="cd319-206">Para obtener una explicación más exhaustiva de `ROW_NUMBER()`, junto con las funciones de categoría, leer [devolver resultados de rango con Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="cd319-206">For a more thorough discussion of `ROW_NUMBER()`, along with the other ranking functions, read [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml).</span></span>


<span data-ttu-id="cd319-207">Cuando los resultados de clasificación por especificado `ORDER BY` columna en el `OVER` cláusula (`UnitPrice`, en el ejemplo anterior), SQL Server debe ordenar los resultados.</span><span class="sxs-lookup"><span data-stu-id="cd319-207">When ranking the results by the specified `ORDER BY` column in the `OVER` clause (`UnitPrice`, in the above example), SQL Server must sort the results.</span></span> <span data-ttu-id="cd319-208">Esto es una operación rápida si hay un índice clúster a través de las columnas que se va a se ordenan los resultados por, o si hay una cobertura de índice, pero puede ser más costosa de lo contrario.</span><span class="sxs-lookup"><span data-stu-id="cd319-208">This is a quick operation if there is a clustered index over the column(s) the results are being ordered by, or if there is a covering index, but can be more costly otherwise.</span></span> <span data-ttu-id="cd319-209">Para ayudar a mejorar el rendimiento de consultas lo suficientemente grandes, considere la posibilidad de agregar un índice no agrupado para la columna por la que los resultados se ordenan por.</span><span class="sxs-lookup"><span data-stu-id="cd319-209">To help improve performance for sufficiently large queries, consider adding a non-clustered index for the column by which the results are ordered by.</span></span> <span data-ttu-id="cd319-210">Consulte [funciones de categoría y el rendimiento en SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) para una visión más detallada de las consideraciones de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="cd319-210">See [Ranking Functions and Performance in SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) for a more detailed look at the performance considerations.</span></span>

<span data-ttu-id="cd319-211">La información de clasificación devuelta por `ROW_NUMBER()` no se puede usar directamente en el `WHERE` cláusula.</span><span class="sxs-lookup"><span data-stu-id="cd319-211">The ranking information returned by `ROW_NUMBER()` cannot directly be used in the `WHERE` clause.</span></span> <span data-ttu-id="cd319-212">Sin embargo, se puede usar una tabla derivada para devolver el `ROW_NUMBER()` resultado, que, a continuación, puede aparecer en el `WHERE` cláusula.</span><span class="sxs-lookup"><span data-stu-id="cd319-212">However, a derived table can be used to return the `ROW_NUMBER()` result, which can then appear in the `WHERE` clause.</span></span> <span data-ttu-id="cd319-213">Por ejemplo, la consulta siguiente utiliza una tabla derivada para devolver las columnas ProductName y UnitPrice, junto con el `ROW_NUMBER()` resultado y, a continuación, utiliza un `WHERE` cláusula para devolver únicamente aquellos productos cuyo rango precio es entre 11 y 20:</span><span class="sxs-lookup"><span data-stu-id="cd319-213">For example, the following query uses a derived table to return the ProductName and UnitPrice columns, along with the `ROW_NUMBER()` result, and then uses a `WHERE` clause to only return those products whose price rank is between 11 and 20:</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample5.sql)]

<span data-ttu-id="cd319-214">Ampliar un poco más este concepto, podemos utilizar este enfoque para recuperar una página específica de datos dados los valores de índice de fila inicial y el número máximo de filas deseados:</span><span class="sxs-lookup"><span data-stu-id="cd319-214">Extending this concept a bit further, we can utilize this approach to retrieve a specific page of data given the desired Start Row Index and Maximum Rows values:</span></span>


[!code-html[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample6.html)]

> [!NOTE]
> <span data-ttu-id="cd319-215">Como veremos más adelante en este tutorial, el *`StartRowIndex`* proporcionado por el origen ObjectDataSource se indiza empezando por cero, mientras que la `ROW_NUMBER()` valor devuelto por SQL Server 2005 se indiza empezando por 1.</span><span class="sxs-lookup"><span data-stu-id="cd319-215">As we will see later on in this tutorial, the *`StartRowIndex`* supplied by the ObjectDataSource is indexed starting at zero, whereas the `ROW_NUMBER()` value returned by SQL Server 2005 is indexed starting at 1.</span></span> <span data-ttu-id="cd319-216">Por lo tanto, el `WHERE` cláusula devuelve aquellos registros donde `PriceRank` es estrictamente mayor que *`StartRowIndex`* y menor o igual a *`StartRowIndex`*  +  *`MaximumRows`*.</span><span class="sxs-lookup"><span data-stu-id="cd319-216">Therefore, the `WHERE` clause returns those records where `PriceRank` is strictly greater than *`StartRowIndex`* and less than or equal to *`StartRowIndex`* + *`MaximumRows`*.</span></span>


<span data-ttu-id="cd319-217">Ahora que se ve cómo tratan `ROW_NUMBER()` puede ser utilizado para recuperar una página de datos dados los valores de índice de fila inicial y el número máximo de filas determinada, ahora es necesario implementar esta lógica como métodos en la capa DAL y BLL.</span><span class="sxs-lookup"><span data-stu-id="cd319-217">Now that we ve discussed how `ROW_NUMBER()` can be used to retrieve a particular page of data given the Start Row Index and Maximum Rows values, we now need to implement this logic as methods in the DAL and BLL.</span></span>

<span data-ttu-id="cd319-218">Al crear esta consulta que debemos decidir el orden por el que los resultados tendrán una clasificación; permiten s ordenar los productos por su nombre en orden alfabético.</span><span class="sxs-lookup"><span data-stu-id="cd319-218">When creating this query we must decide the ordering by which the results will be ranked; let s sort the products by their name in alphabetical order.</span></span> <span data-ttu-id="cd319-219">Esto significa que con la implementación de paginación personalizada en este tutorial, no será capaz de crear un informe paginado personalizado que también se pueden ordenar.</span><span class="sxs-lookup"><span data-stu-id="cd319-219">This means that with the custom paging implementation in this tutorial we will not be able to create a custom paged report than can also be sorted.</span></span> <span data-ttu-id="cd319-220">En el siguiente tutorial, sin embargo, veremos cómo se puede proporcionar esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="cd319-220">In the next tutorial, though, we'll see how such functionality can be provided.</span></span>

<span data-ttu-id="cd319-221">En la sección anterior, creamos el método DAL como instrucción SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="cd319-221">In the previous section we created the DAL method as an ad-hoc SQL statement.</span></span> <span data-ttu-id="cd319-222">Lamentablemente, el analizador de Transact-SQL en Visual Studio usando el asistente TableAdapter t como el `OVER` sintaxis utilizada por el `ROW_NUMBER()` función.</span><span class="sxs-lookup"><span data-stu-id="cd319-222">Unfortunately, the T-SQL parser in Visual Studio used by the TableAdapter wizard doesn t like the `OVER` syntax used by the `ROW_NUMBER()` function.</span></span> <span data-ttu-id="cd319-223">Por lo tanto, debemos crear este método DAL como un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="cd319-223">Therefore, we must create this DAL method as a stored procedure.</span></span> <span data-ttu-id="cd319-224">Seleccione el Explorador de servidores en el menú de vista (o Ctrl + Alt + S visitas) y expanda el `NORTHWND.MDF` nodo.</span><span class="sxs-lookup"><span data-stu-id="cd319-224">Select the Server Explorer from the View menu (or hit Ctrl+Alt+S) and expand the `NORTHWND.MDF` node.</span></span> <span data-ttu-id="cd319-225">Para agregar un nuevo procedimiento almacenado, haga doble clic en el nodo procedimientos almacenados y elija Agregar un nuevo procedimiento almacenado (consulte la figura 6).</span><span class="sxs-lookup"><span data-stu-id="cd319-225">To add a new stored procedure, right-click on the Stored Procedures node and choose Add a New Stored Procedure (see Figure 6).</span></span>


![Agregar un nuevo procedimiento almacenado para la paginación a través de los productos](efficiently-paging-through-large-amounts-of-data-vb/_static/image6.png)

<span data-ttu-id="cd319-227">**Figura 6**: Agregar un nuevo procedimiento almacenado para la paginación a través de los productos</span><span class="sxs-lookup"><span data-stu-id="cd319-227">**Figure 6**: Add a New Stored Procedure for Paging Through the Products</span></span>


<span data-ttu-id="cd319-228">Este procedimiento almacenado debe aceptar dos parámetros de entrada enteros - `@startRowIndex` y `@maximumRows` y usar el `ROW_NUMBER()` función ordenados por la `ProductName` campo, y devuelve solo las filas mayor que el especificado `@startRowIndex` y menor que o igual que `@startRowIndex`  +  `@maximumRow` s.</span><span class="sxs-lookup"><span data-stu-id="cd319-228">This stored procedure should accept two integer input parameters - `@startRowIndex` and `@maximumRows` and use the `ROW_NUMBER()` function ordered by the `ProductName` field, returning only those rows greater than the specified `@startRowIndex` and less than or equal to `@startRowIndex` + `@maximumRow` s.</span></span> <span data-ttu-id="cd319-229">Escriba el siguiente script en el nuevo procedimiento almacenado y, a continuación, haga clic en el icono de guardar para agregar el procedimiento almacenado a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd319-229">Enter the following script into the new stored procedure and then click the Save icon to add the stored procedure to the database.</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample7.sql)]

<span data-ttu-id="cd319-230">Después de crear el procedimiento almacenado, dedique un momento para probarlo. Haga doble clic en el `GetProductsPaged` procedimiento almacenado nombre en el Explorador de servidores y elija la opción de ejecución.</span><span class="sxs-lookup"><span data-stu-id="cd319-230">After creating the stored procedure, take a moment to test it out. Right-click on the `GetProductsPaged` stored procedure name in the Server Explorer and choose the Execute option.</span></span> <span data-ttu-id="cd319-231">Visual Studio le pedirá que, a continuación, para los parámetros de entrada, `@startRowIndex` y `@maximumRow` s (consulte la figura 7).</span><span class="sxs-lookup"><span data-stu-id="cd319-231">Visual Studio will then prompt you for the input parameters, `@startRowIndex` and `@maximumRow` s (see Figure 7).</span></span> <span data-ttu-id="cd319-232">Probar valores diferentes y examinar los resultados.</span><span class="sxs-lookup"><span data-stu-id="cd319-232">Try different values and examine the results.</span></span>


![Escriba un valor para el @startRowIndex y @maximumRows parámetros](efficiently-paging-through-large-amounts-of-data-vb/_static/image7.png)

<span data-ttu-id="cd319-234"><strong>Figura 7</strong>: Escriba un valor para el @startRowIndex y @maximumRows parámetros</span><span class="sxs-lookup"><span data-stu-id="cd319-234"><strong>Figure 7</strong>: Enter a Value for the @startRowIndex and @maximumRows Parameters</span></span>


<span data-ttu-id="cd319-235">Después de elegir estos valores de parámetros de entrada, la ventana de salida mostrará los resultados.</span><span class="sxs-lookup"><span data-stu-id="cd319-235">After choosing these input parameters values, the Output window will show the results.</span></span> <span data-ttu-id="cd319-236">Figura 8 se muestran los resultados al pasar de 10 para ambos el `@startRowIndex` y `@maximumRows` parámetros.</span><span class="sxs-lookup"><span data-stu-id="cd319-236">Figure 8 shows the results when passing in 10 for both the `@startRowIndex` and `@maximumRows` parameters.</span></span>


<span data-ttu-id="cd319-237">[![Los registros que podrían aparecer en la segunda página de datos se devuelven.](efficiently-paging-through-large-amounts-of-data-vb/_static/image9.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="cd319-237">[![The Records That Would Appear in the Second Page of Data are Returned](efficiently-paging-through-large-amounts-of-data-vb/_static/image9.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image8.png)</span></span>

<span data-ttu-id="cd319-238">**Figura 8**: Los registros que podrían aparecer en la segunda página de datos se devuelven ([haga clic aquí para ver imagen en tamaño completo](efficiently-paging-through-large-amounts-of-data-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="cd319-238">**Figure 8**: The Records That Would Appear in the Second Page of Data are Returned ([Click to view full-size image](efficiently-paging-through-large-amounts-of-data-vb/_static/image10.png))</span></span>


<span data-ttu-id="cd319-239">Con este procedimiento almacenado creado, que está listo para crear el `ProductsTableAdapter` método.</span><span class="sxs-lookup"><span data-stu-id="cd319-239">With this stored procedure created, we re ready to create the `ProductsTableAdapter` method.</span></span> <span data-ttu-id="cd319-240">Abra el `Northwind.xsd` DataSet con tipo, botón secundario en el `ProductsTableAdapter`y elija la opción Add Query.</span><span class="sxs-lookup"><span data-stu-id="cd319-240">Open the `Northwind.xsd` Typed DataSet, right-click in the `ProductsTableAdapter`, and choose the Add Query option.</span></span> <span data-ttu-id="cd319-241">En lugar de crear la consulta mediante una instrucción SQL ad hoc, créelo mediante un procedimiento almacenado existente.</span><span class="sxs-lookup"><span data-stu-id="cd319-241">Instead of creating the query using an ad-hoc SQL statement, create it using an existing stored procedure.</span></span>


![Crear el método de DAL mediante un procedimiento almacenado existente](efficiently-paging-through-large-amounts-of-data-vb/_static/image11.png)

<span data-ttu-id="cd319-243">**Figura 9**: Crear el método de DAL mediante un procedimiento almacenado existente</span><span class="sxs-lookup"><span data-stu-id="cd319-243">**Figure 9**: Create the DAL Method Using an Existing Stored Procedure</span></span>


<span data-ttu-id="cd319-244">A continuación, se nos pide que seleccione el procedimiento almacenado para invocar.</span><span class="sxs-lookup"><span data-stu-id="cd319-244">Next, we are prompted to select the stored procedure to invoke.</span></span> <span data-ttu-id="cd319-245">Elegir el `GetProductsPaged` procedimiento almacenado desde la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="cd319-245">Pick the `GetProductsPaged` stored procedure from the drop-down list.</span></span>


![Elija la GetProductsPaged procedimiento almacenado desde la lista desplegable](efficiently-paging-through-large-amounts-of-data-vb/_static/image12.png)

<span data-ttu-id="cd319-247">**Figura 10**: Elija la GetProductsPaged procedimiento almacenado desde la lista desplegable</span><span class="sxs-lookup"><span data-stu-id="cd319-247">**Figure 10**: Choose the GetProductsPaged Stored Procedure from the Drop-Down List</span></span>


<span data-ttu-id="cd319-248">La siguiente pantalla, a continuación, le pregunta qué tipo de datos devuelto por el procedimiento almacenado: datos tabulares, un valor único o ningún valor.</span><span class="sxs-lookup"><span data-stu-id="cd319-248">The next screen then asks you what kind of data is returned by the stored procedure: tabular data, a single value, or no value.</span></span> <span data-ttu-id="cd319-249">Puesto que el `GetProductsPaged` procedimiento almacenado puede devolver varios registros, indique que devuelve datos tabulares.</span><span class="sxs-lookup"><span data-stu-id="cd319-249">Since the `GetProductsPaged` stored procedure can return multiple records, indicate that it returns tabular data.</span></span>


![Indicar que el procedimiento almacenado devuelve datos tabulares](efficiently-paging-through-large-amounts-of-data-vb/_static/image13.png)

<span data-ttu-id="cd319-251">**Figura 11**: Indicar que el procedimiento almacenado devuelve datos tabulares</span><span class="sxs-lookup"><span data-stu-id="cd319-251">**Figure 11**: Indicate that the Stored Procedure Returns Tabular Data</span></span>


<span data-ttu-id="cd319-252">Por último, se indican los nombres de los métodos que desee que haya creado.</span><span class="sxs-lookup"><span data-stu-id="cd319-252">Finally, indicate the names of the methods you want to have created.</span></span> <span data-ttu-id="cd319-253">Al igual que con nuestros tutoriales anteriores, siga adelante y crear métodos que utilizan tanto el relleno una DataTable y devolver un DataTable.</span><span class="sxs-lookup"><span data-stu-id="cd319-253">As with our previous tutorials, go ahead and create methods using both the Fill a DataTable and Return a DataTable.</span></span> <span data-ttu-id="cd319-254">Nombre del primer método `FillPaged` y el segundo `GetProductsPaged`.</span><span class="sxs-lookup"><span data-stu-id="cd319-254">Name the first method `FillPaged` and the second `GetProductsPaged`.</span></span>


![Nombre de lo métodos de FillPaged y GetProductsPaged](efficiently-paging-through-large-amounts-of-data-vb/_static/image14.png)

<span data-ttu-id="cd319-256">**Figura 12**: Nombre de lo métodos de FillPaged y GetProductsPaged</span><span class="sxs-lookup"><span data-stu-id="cd319-256">**Figure 12**: Name the Methods FillPaged and GetProductsPaged</span></span>


<span data-ttu-id="cd319-257">Por otra parte que va a crear un método DAL para devolver una página determinada de productos, también es necesario ofrecer esta funcionalidad en la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="cd319-257">In addition to created a DAL method to return a particular page of products, we also need to provide such functionality in the BLL.</span></span> <span data-ttu-id="cd319-258">Como el método DAL, la s BLL GetProductsPaged método debe aceptar dos entradas de entero para especificar el índice de fila inicial y el número máximo de filas y debe devolver solo aquellos registros que se encuentran dentro del intervalo especificado.</span><span class="sxs-lookup"><span data-stu-id="cd319-258">Like the DAL method, the BLL s GetProductsPaged method must accept two integer inputs for specifying the Start Row Index and Maximum Rows, and must return just those records that fall within the specified range.</span></span> <span data-ttu-id="cd319-259">Cree este tipo de método BLL en la clase ProductsBLL que simplemente llamadas hacia abajo en la s DAL método GetProductsPaged, así:</span><span class="sxs-lookup"><span data-stu-id="cd319-259">Create such a BLL method in the ProductsBLL class that merely calls down into the DAL s GetProductsPaged method, like so:</span></span>


[!code-vb[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample8.vb)]

<span data-ttu-id="cd319-260">Puede utilizar cualquier nombre para los parámetros de entrada del método s BLL, pero, como veremos en breve, decide usar `startRowIndex` y `maximumRows` nos evita adicional de un poco de trabajo al configurar un origen ObjectDataSource para usar este método.</span><span class="sxs-lookup"><span data-stu-id="cd319-260">You can use any name for the BLL method s input parameters, but, as we will see shortly, choosing to use `startRowIndex` and `maximumRows` saves us from an extra bit of work when configuring an ObjectDataSource to use this method.</span></span>

## <a name="step-4-configuring-the-objectdatasource-to-use-custom-paging"></a><span data-ttu-id="cd319-261">Paso 4: Configurar el origen ObjectDataSource para utilizar la paginación personalizada</span><span class="sxs-lookup"><span data-stu-id="cd319-261">Step 4: Configuring the ObjectDataSource to Use Custom Paging</span></span>

<span data-ttu-id="cd319-262">Con los métodos para tener acceso a un subconjunto específico de registros completados BLL y DAL, está listo para crear un control GridView controlamos ese páginas a través de sus registros subyacentes mediante la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="cd319-262">With the BLL and DAL methods for accessing a particular subset of records complete, we re ready to create a GridView control that pages through its underlying records using custom paging.</span></span> <span data-ttu-id="cd319-263">Comience abriendo la `EfficientPaging.aspx` página en el `PagingAndSorting` carpeta, agregue un control GridView a la página y configurarlo para usar un nuevo control ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="cd319-263">Start by opening the `EfficientPaging.aspx` page in the `PagingAndSorting` folder, add a GridView to the page, and configure it to use a new ObjectDataSource control.</span></span> <span data-ttu-id="cd319-264">En los tutoriales anteriores, a menudo teníamos ObjectDataSource configurado para usar el `ProductsBLL` clase s `GetProducts` método.</span><span class="sxs-lookup"><span data-stu-id="cd319-264">In our past tutorials, we often had the ObjectDataSource configured to use the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="cd319-265">Esta vez, sin embargo, deseamos usar el `GetProductsPaged` método en su lugar, desde el `GetProducts` devuelve del método *todas* de los productos de la base de datos, mientras que `GetProductsPaged` devuelve solo un subconjunto específico de registros.</span><span class="sxs-lookup"><span data-stu-id="cd319-265">This time, however, we want to use the `GetProductsPaged` method instead, since the `GetProducts` method returns *all* of the products in the database whereas `GetProductsPaged` returns just a particular subset of records.</span></span>


![Configurar el origen ObjectDataSource para usar el método de clase ProductsBLL s GetProductsPaged](efficiently-paging-through-large-amounts-of-data-vb/_static/image15.png)

<span data-ttu-id="cd319-267">**Figura 13**: Configurar el origen ObjectDataSource para usar el método de clase ProductsBLL s GetProductsPaged</span><span class="sxs-lookup"><span data-stu-id="cd319-267">**Figure 13**: Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method</span></span>


<span data-ttu-id="cd319-268">Desde que creamos re de la creación de un control GridView de solo lectura, dedique un momento para establecer la lista desplegable de método en la instrucción INSERT, UPDATE y elimine las pestañas en (None).</span><span class="sxs-lookup"><span data-stu-id="cd319-268">Since we re creating a read-only GridView, take a moment to set the method drop-down list in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>

<span data-ttu-id="cd319-269">A continuación, el ObjectDataSource wizard nos pide los orígenes de la `GetProductsPaged` método s `startRowIndex` y `maximumRows` valores de parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="cd319-269">Next, the ObjectDataSource wizard prompts us for the sources of the `GetProductsPaged` method s `startRowIndex` and `maximumRows` input parameters values.</span></span> <span data-ttu-id="cd319-270">Estos parámetros de entrada realmente que establecerá la GridView automáticamente, así, simplemente deje el código fuente como Ninguno y haga clic en Finalizar.</span><span class="sxs-lookup"><span data-stu-id="cd319-270">These input parameters will actually be set by the GridView automatically, so simply leave the source set to None and click Finish.</span></span>


![Deje los orígenes de parámetro de entrada como ninguno](efficiently-paging-through-large-amounts-of-data-vb/_static/image16.png)

<span data-ttu-id="cd319-272">**Figura 14**: Deje los orígenes de parámetro de entrada como ninguno</span><span class="sxs-lookup"><span data-stu-id="cd319-272">**Figure 14**: Leave the Input Parameter Sources as None</span></span>


<span data-ttu-id="cd319-273">Después de completar al Asistente de ObjectDataSource GridView contendrá un BoundField o CampoCasillaVerificación para cada uno de los campos de datos del producto.</span><span class="sxs-lookup"><span data-stu-id="cd319-273">After completing the ObjectDataSource wizard, the GridView will contain a BoundField or CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="cd319-274">No dude en adaptar la apariencia GridView como considere oportuno.</span><span class="sxs-lookup"><span data-stu-id="cd319-274">Feel free to tailor the GridView s appearance as you see fit.</span></span> <span data-ttu-id="cd319-275">Se ve optó por mostrar solamente el `ProductName`, `CategoryName`, `SupplierName`, `QuantityPerUnit`, y `UnitPrice` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="cd319-275">I ve opted to display only the `ProductName`, `CategoryName`, `SupplierName`, `QuantityPerUnit`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="cd319-276">Además, configurar el control GridView para admitir la paginación activando la casilla Habilitar paginación en su etiqueta inteligente.</span><span class="sxs-lookup"><span data-stu-id="cd319-276">Also, configure the GridView to support paging by checking the Enable Paging checkbox in its smart tag.</span></span> <span data-ttu-id="cd319-277">Después de estos cambios, el marcado declarativo de GridView y ObjectDataSource debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="cd319-277">After these changes, the GridView and ObjectDataSource declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample9.aspx)]

<span data-ttu-id="cd319-278">Si visita la página a través de un explorador, sin embargo, el control GridView es ningún donde va a calcular.</span><span class="sxs-lookup"><span data-stu-id="cd319-278">If you visit the page through a browser, however, the GridView is no where to be found.</span></span>


![El control GridView no es aparece](efficiently-paging-through-large-amounts-of-data-vb/_static/image17.png)

<span data-ttu-id="cd319-280">**Figura 15**: El control GridView no es aparece</span><span class="sxs-lookup"><span data-stu-id="cd319-280">**Figure 15**: The GridView is Not Displayed</span></span>


<span data-ttu-id="cd319-281">Falta el control GridView porque el origen ObjectDataSource utiliza actualmente 0 como los valores para ambas la `GetProductsPaged` `startRowIndex` y `maximumRows` parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="cd319-281">The GridView is missing because the ObjectDataSource is currently using 0 as the values for both of the `GetProductsPaged` `startRowIndex` and `maximumRows` input parameters.</span></span> <span data-ttu-id="cd319-282">Por lo tanto, la consulta SQL resultante devuelve ningún registro y, por tanto, no se muestra el control GridView.</span><span class="sxs-lookup"><span data-stu-id="cd319-282">Hence, the resulting SQL query is returning no records and therefore the GridView is not displayed.</span></span>

<span data-ttu-id="cd319-283">Para solucionar este problema, es necesario configurar el origen ObjectDataSource para utilizar la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="cd319-283">To remedy this, we need to configure the ObjectDataSource to use custom paging.</span></span> <span data-ttu-id="cd319-284">Esto puede realizarse en los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="cd319-284">This can be accomplished in the following steps:</span></span>

1. <span data-ttu-id="cd319-285">**Establezca la s ObjectDataSource `EnablePaging` propiedad `true`**  esto indica al origen ObjectDataSource que debe pasar a la `SelectMethod` dos parámetros adicionales: uno para especificar el índice de fila inicial ([ `StartRowIndexParameterName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.startrowindexparametername.aspx)) y otra para especificar el número máximo de filas ([`MaximumRowsParameterName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.maximumrowsparametername.aspx)).</span><span class="sxs-lookup"><span data-stu-id="cd319-285">**Set the ObjectDataSource s `EnablePaging` property to `true`** this indicates to the ObjectDataSource that it must pass to the `SelectMethod` two additional parameters: one to specify the Start Row Index ([`StartRowIndexParameterName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.startrowindexparametername.aspx)), and one to specify the Maximum Rows ([`MaximumRowsParameterName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.maximumrowsparametername.aspx)).</span></span>
2. <span data-ttu-id="cd319-286">**Establezca la s ObjectDataSource `StartRowIndexParameterName` y `MaximumRowsParameterName` propiedades según corresponda** el `StartRowIndexParameterName` y `MaximumRowsParameterName` propiedades indican los nombres de los parámetros de entrada que se pasó el `SelectMethod` para fines de paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="cd319-286">**Set the ObjectDataSource s `StartRowIndexParameterName` and `MaximumRowsParameterName` Properties Accordingly** the `StartRowIndexParameterName` and `MaximumRowsParameterName` properties indicate the names of the input parameters passed into the `SelectMethod` for custom paging purposes.</span></span> <span data-ttu-id="cd319-287">De forma predeterminada, estos nombres de parámetro son `startIndexRow` y `maximumRows`, que es por eso, al crear el `GetProductsPaged` método en el BLL, utiliza estos valores para los parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="cd319-287">By default, these parameter names are `startIndexRow` and `maximumRows`, which is why, when creating the `GetProductsPaged` method in the BLL, I used these values for the input parameters.</span></span> <span data-ttu-id="cd319-288">Si decide utilizar los nombres de parámetro diferente para la s BLL `GetProductsPaged` método como `startIndex` y `maxRows`, por ejemplo deberá establecer la s ObjectDataSource `StartRowIndexParameterName` y `MaximumRowsParameterName` propiedades según corresponda (por ejemplo, startIndex para `StartRowIndexParameterName` y maxRows para `MaximumRowsParameterName`).</span><span class="sxs-lookup"><span data-stu-id="cd319-288">If you chose to use different parameter names for the BLL s `GetProductsPaged` method such as `startIndex` and `maxRows`, for example you would need to set the ObjectDataSource s `StartRowIndexParameterName` and `MaximumRowsParameterName` properties accordingly (such as startIndex for `StartRowIndexParameterName` and maxRows for `MaximumRowsParameterName`).</span></span>
3. <span data-ttu-id="cd319-289">**Establezca la s ObjectDataSource [ `SelectCountMethod` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selectcountmethod(VS.80).aspx) en el nombre del método que devuelve el Total número de registros que se va a paginar a través de (`TotalNumberOfProducts`)** Recuerde que el `ProductsBLL` clase s `TotalNumberOfProducts`método devuelve el número total de registros que se va a paginar a través de un método DAL que se ejecuta un `SELECT COUNT(*) FROM Products` consulta.</span><span class="sxs-lookup"><span data-stu-id="cd319-289">**Set the ObjectDataSource s [`SelectCountMethod` Property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selectcountmethod(VS.80).aspx) to the Name of the Method that Returns the Total Number of Records Being Paged Through (`TotalNumberOfProducts`)** recall that the `ProductsBLL` class s `TotalNumberOfProducts` method returns the total number of records being paged through using a DAL method that executes a `SELECT COUNT(*) FROM Products` query.</span></span> <span data-ttu-id="cd319-290">Esta información es necesaria por el origen ObjectDataSource para representar correctamente la interfaz de paginación.</span><span class="sxs-lookup"><span data-stu-id="cd319-290">This information is needed by the ObjectDataSource in order to correctly render the paging interface.</span></span>
4. <span data-ttu-id="cd319-291">**Quitar el `startRowIndex` y `maximumRows` `<asp:Parameter>` elementos desde el marcado declarativo de ObjectDataSource s** al configurar el origen ObjectDataSource a través del asistente, Visual Studio agrega automáticamente dos `<asp:Parameter>` elementos para el `GetProductsPaged` método s parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="cd319-291">**Remove the `startRowIndex` and `maximumRows` `<asp:Parameter>` Elements from the ObjectDataSource s Declarative Markup** when configuring the ObjectDataSource through the wizard, Visual Studio automatically added two `<asp:Parameter>` elements for the `GetProductsPaged` method s input parameters.</span></span> <span data-ttu-id="cd319-292">Estableciendo `EnablePaging` a `true`, estos parámetros se pasarán automáticamente; si también aparecen en la sintaxis declarativa, ObjectDataSource intenta pasar *cuatro* parámetros para el `GetProductsPaged` (método) y dos parámetros para el `TotalNumberOfProducts` método.</span><span class="sxs-lookup"><span data-stu-id="cd319-292">By setting `EnablePaging` to `true`, these parameters will be passed automatically; if they also appear in the declarative syntax, the ObjectDataSource will attempt to pass *four* parameters to the `GetProductsPaged` method and two parameters to the `TotalNumberOfProducts` method.</span></span> <span data-ttu-id="cd319-293">Si se olvida de quitar estos `<asp:Parameter>` elementos, al visitar la página a través de un explorador que se obtendrá un mensaje de error como: *ObjectDataSource 'ObjectDataSource1' no encontró un método no genérico 'TotalNumberOfProducts' que tiene parámetros: startRowIndex, maximumRows*.</span><span class="sxs-lookup"><span data-stu-id="cd319-293">If you forget to remove these `<asp:Parameter>` elements, when visiting the page through a browser you'll get an error message like: *ObjectDataSource 'ObjectDataSource1' could not find a non-generic method 'TotalNumberOfProducts' that has parameters: startRowIndex, maximumRows*.</span></span>

<span data-ttu-id="cd319-294">Después de realizar estos cambios, la sintaxis declarativa de ObjectDataSource s debería ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="cd319-294">After making these changes, the ObjectDataSource s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample10.aspx)]

<span data-ttu-id="cd319-295">Tenga en cuenta que el `EnablePaging` y `SelectCountMethod` se han establecido las propiedades y los `<asp:Parameter>` se han quitado elementos.</span><span class="sxs-lookup"><span data-stu-id="cd319-295">Note that the `EnablePaging` and `SelectCountMethod` properties have been set and the `<asp:Parameter>` elements have been removed.</span></span> <span data-ttu-id="cd319-296">Figura 16 se muestra una captura de pantalla de la ventana Propiedades de una vez realizados estos cambios.</span><span class="sxs-lookup"><span data-stu-id="cd319-296">Figure 16 shows a screen shot of the Properties window after these changes have been made.</span></span>


![Para usar la paginación personalizada, Configure el Control ObjectDataSource](efficiently-paging-through-large-amounts-of-data-vb/_static/image18.png)

<span data-ttu-id="cd319-298">**Figura 16**: Para usar la paginación personalizada, Configure el Control ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="cd319-298">**Figure 16**: To Use Custom Paging, Configure the ObjectDataSource Control</span></span>


<span data-ttu-id="cd319-299">Después de realizar estos cambios, visite esta página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="cd319-299">After making these changes, visit this page through a browser.</span></span> <span data-ttu-id="cd319-300">Debería ver 10 productos en la lista, ordenadas alfabéticamente.</span><span class="sxs-lookup"><span data-stu-id="cd319-300">You should see 10 products listed, ordered alphabetically.</span></span> <span data-ttu-id="cd319-301">Tómese un momento para paso a través de la página datos a la vez.</span><span class="sxs-lookup"><span data-stu-id="cd319-301">Take a moment to step through the data one page at a time.</span></span> <span data-ttu-id="cd319-302">Aunque no hay ninguna diferencia visual desde la perspectiva del usuario final s entre la paginación predeterminada y la paginación personalizada, más eficazmente la paginación personalizada páginas a través de grandes cantidades de datos, ya que recupera solo aquellos registros que deben mostrarse de una página determinada.</span><span class="sxs-lookup"><span data-stu-id="cd319-302">While there is no visual difference from the end user s perspective between default paging and custom paging, custom paging more efficiently pages through large amounts of data as it only retrieves those records that need to be displayed for a given page.</span></span>


<span data-ttu-id="cd319-303">[![Los datos, ordenado por el producto, nombre de s es paginado usando paginación personalizada](efficiently-paging-through-large-amounts-of-data-vb/_static/image20.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="cd319-303">[![The Data, Ordered by the Product s Name, is Paged Using Custom Paging](efficiently-paging-through-large-amounts-of-data-vb/_static/image20.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image19.png)</span></span>

<span data-ttu-id="cd319-304">**Figura 17**: Los datos, ordenado por el producto, nombre de s es paginado usando paginación personalizada ([haga clic aquí para ver imagen en tamaño completo](efficiently-paging-through-large-amounts-of-data-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="cd319-304">**Figure 17**: The Data, Ordered by the Product s Name, is Paged Using Custom Paging ([Click to view full-size image](efficiently-paging-through-large-amounts-of-data-vb/_static/image21.png))</span></span>


> [!NOTE]
> <span data-ttu-id="cd319-305">Con la paginación personalizada, la página de recuento de valor devuelto por la s ObjectDataSource `SelectCountMethod` se almacena en el estado de vista GridView s.</span><span class="sxs-lookup"><span data-stu-id="cd319-305">With custom paging, the page count value returned by the ObjectDataSource�s `SelectCountMethod` is stored in the GridView�s view state.</span></span> <span data-ttu-id="cd319-306">Otras variables GridView el `PageIndex`, `EditIndex`, `SelectedIndex`, `DataKeys` colección etc. se almacenan en *controlar el estado de*, que se conserva independientemente del valor de la s GridView `EnableViewState` propiedad.</span><span class="sxs-lookup"><span data-stu-id="cd319-306">Other GridView variables the `PageIndex`, `EditIndex`, `SelectedIndex`, `DataKeys` collection, and so on are stored in *control state*, which is persisted regardless of the value of the GridView�s `EnableViewState` property.</span></span> <span data-ttu-id="cd319-307">Puesto que la `PageCount` valor se conserva entre las devoluciones de datos usando el estado de vista, cuando se usa una interfaz de paginación que incluye un vínculo para ir a la última página, es imperativo que esté habilitado el estado de vista GridView s.</span><span class="sxs-lookup"><span data-stu-id="cd319-307">Since the `PageCount` value is persisted across postbacks using view state, when using a paging interface that includes a link to take you to the last page, it is imperative that the GridView�s view state be enabled.</span></span> <span data-ttu-id="cd319-308">(Si la interfaz de paginación no incluye un vínculo directo a la última página, a continuación, puede deshabilitar el estado de vista).</span><span class="sxs-lookup"><span data-stu-id="cd319-308">(If your paging interface does not include a direct link to the last page, then you may disable view state.)</span></span>


<span data-ttu-id="cd319-309">Al hacer clic en el último vínculo de página hace que una devolución de datos e indica a la GridView para actualizar su `PageIndex` propiedad.</span><span class="sxs-lookup"><span data-stu-id="cd319-309">Clicking the last page link causes a postback and instructs the GridView to update its `PageIndex` property.</span></span> <span data-ttu-id="cd319-310">Si se hace clic en el último vínculo de página, el control GridView asigna su `PageIndex` propiedad con un valor uno menor que su `PageCount` propiedad.</span><span class="sxs-lookup"><span data-stu-id="cd319-310">If the last page link is clicked, the GridView assigns its `PageIndex` property to a value one less than its `PageCount` property.</span></span> <span data-ttu-id="cd319-311">Con el estado de vista deshabilitado, el `PageCount` valor se pierde durante las devoluciones y los `PageIndex` se asigna el valor entero máximo en su lugar.</span><span class="sxs-lookup"><span data-stu-id="cd319-311">With view state disabled, the `PageCount` value is lost across postbacks and the `PageIndex` is assigned the maximum integer value instead.</span></span> <span data-ttu-id="cd319-312">A continuación, el control GridView intenta determinar el índice de fila inicial multiplicando el `PageSize` y `PageCount` propiedades.</span><span class="sxs-lookup"><span data-stu-id="cd319-312">Next, the GridView attempts to determine the starting row index by multiplying the `PageSize` and `PageCount` properties.</span></span> <span data-ttu-id="cd319-313">Esto da como resultado un `OverflowException` puesto que el producto supera el tamaño máximo de enteros permitidos.</span><span class="sxs-lookup"><span data-stu-id="cd319-313">This results in an `OverflowException` since the product exceeds the maximum allowed integer size.</span></span>

## <a name="implement-custom-paging-and-sorting"></a><span data-ttu-id="cd319-314">Implemente la paginación personalizada y ordenación</span><span class="sxs-lookup"><span data-stu-id="cd319-314">Implement Custom Paging and Sorting</span></span>

<span data-ttu-id="cd319-315">Nuestra implementación de paginación personalizada actual requiere que se especifique el orden por el que los datos están paginados a través de forma estática al crear el `GetProductsPaged` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="cd319-315">Our current custom paging implementation requires that the order by which the data is paged through be specified statically when creating the `GetProductsPaged` stored procedure.</span></span> <span data-ttu-id="cd319-316">Sin embargo, es posible que haya anotado que la etiqueta inteligente de GridView s contiene una casilla de verificación Habilitar ordenación además de la opción de habilitar la paginación.</span><span class="sxs-lookup"><span data-stu-id="cd319-316">However, you may have noted that the GridView s smart tag contains an Enable Sorting checkbox in addition to the Enable Paging option.</span></span> <span data-ttu-id="cd319-317">Por desgracia, agregar compatibilidad con la ordenación en el control GridView con nuestra implementación de paginación personalizada actual, solo se ordenarán los registros en la página de datos está viendo actualmente.</span><span class="sxs-lookup"><span data-stu-id="cd319-317">Unfortunately, adding sorting support to the GridView with our current custom paging implementation will only sort the records on the currently viewed page of data.</span></span> <span data-ttu-id="cd319-318">Por ejemplo, si configura el control GridView para admitir la paginación y, a continuación, al ver la primera página de datos, ordenar por nombre de producto en orden descendente, invertirá el orden de los productos en la página 1.</span><span class="sxs-lookup"><span data-stu-id="cd319-318">For example, if you configure the GridView to also support paging and then, when viewing the first page of data, sort by product name in descending order, it will reverse the order of the products on page 1.</span></span> <span data-ttu-id="cd319-319">Como se muestra en la figura 18, como muestra tigre Carnarvon como el primer producto al ordenar en orden alfabético inverso, que omite el 71 otros productos que venga después tigre Carnarvon, por orden alfabético; solo aquellos registros en la primera página se consideran en la ordenación.</span><span class="sxs-lookup"><span data-stu-id="cd319-319">As Figure 18 shows, such shows Carnarvon Tigers as the first product when sorting in reverse alphabetical order, which ignores the 71 other products that come after Carnarvon Tigers, alphabetically; only those records on the first page are considered in the sorting.</span></span>


<span data-ttu-id="cd319-320">[![Solo los datos que se muestra en la página actual se ordena.](efficiently-paging-through-large-amounts-of-data-vb/_static/image23.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="cd319-320">[![Only the Data Shown on the Current Page is Sorted](efficiently-paging-through-large-amounts-of-data-vb/_static/image23.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image22.png)</span></span>

<span data-ttu-id="cd319-321">**Figura 18**: Solo los datos que se muestra en la página actual está ordenada ([haga clic aquí para ver imagen en tamaño completo](efficiently-paging-through-large-amounts-of-data-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="cd319-321">**Figure 18**: Only the Data Shown on the Current Page is Sorted ([Click to view full-size image](efficiently-paging-through-large-amounts-of-data-vb/_static/image24.png))</span></span>


<span data-ttu-id="cd319-322">La ordenación sólo se aplica a la página de datos actual porque la ordenación se está produciendo una vez recuperados los datos del s BLL `GetProductsPaged` , este método y devuelve solo aquellos registros para la página específica.</span><span class="sxs-lookup"><span data-stu-id="cd319-322">The sorting only applies to the current page of data because the sorting is occurring after the data has been retrieved from the BLL s `GetProductsPaged` method, and this method only returns those records for the specific page.</span></span> <span data-ttu-id="cd319-323">Para implementar correctamente una ordenación, necesitamos pasar la expresión de ordenación para el `GetProductsPaged` método para que los datos pueden clasificarse adecuadamente antes de devolver la página específica de datos.</span><span class="sxs-lookup"><span data-stu-id="cd319-323">To implement sorting correctly, we need to pass the sort expression to the `GetProductsPaged` method so that the data can be ranked appropriately before returning the specific page of data.</span></span> <span data-ttu-id="cd319-324">Veremos cómo hacerlo en nuestro tutorial siguiente.</span><span class="sxs-lookup"><span data-stu-id="cd319-324">We'll see how to accomplish this in our next tutorial.</span></span>

## <a name="implementing-custom-paging-and-deleting"></a><span data-ttu-id="cd319-325">Implementación personalizada de paginación y eliminar</span><span class="sxs-lookup"><span data-stu-id="cd319-325">Implementing Custom Paging and Deleting</span></span>

<span data-ttu-id="cd319-326">Si puede habilitar la funcionalidad de eliminación en un control GridView se paginan cuyos datos mediante técnicas de paginación personalizada que encontrará al eliminar el último registro de la última página, GridView desaparece en lugar de disminuir de forma adecuada los s GridView `PageIndex`.</span><span class="sxs-lookup"><span data-stu-id="cd319-326">If you enabling deleting functionality in a GridView whose data is paged using custom paging techniques you will find that when deleting the last record from the last page, the GridView disappears rather than appropriately decrementing the GridView s `PageIndex`.</span></span> <span data-ttu-id="cd319-327">Para reproducir este error, habilitar la eliminación para el tutorial simplemente que acabamos de crear.</span><span class="sxs-lookup"><span data-stu-id="cd319-327">To reproduce this bug, enable deleting for the tutorial just we just created.</span></span> <span data-ttu-id="cd319-328">Vaya a la última página (9), donde debería ver un único producto ya que nos estamos paginar 81 productos, 10 productos a la vez.</span><span class="sxs-lookup"><span data-stu-id="cd319-328">Go to the last page (page 9), where you should see a single product since we are paging through 81 products, 10 products at a time.</span></span> <span data-ttu-id="cd319-329">Eliminar este producto.</span><span class="sxs-lookup"><span data-stu-id="cd319-329">Delete this product.</span></span>

<span data-ttu-id="cd319-330">Tras eliminar el último producto, el control GridView *debe* automáticamente, vaya a la página octava y esta funcionalidad se logran con la paginación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="cd319-330">Upon deleting the last product, the GridView *should* automatically go to the eighth page, and such functionality is exhibited with default paging.</span></span> <span data-ttu-id="cd319-331">Con la paginación personalizada, sin embargo, después de eliminar el último producto en la última página, el control GridView simplemente desaparece de la pantalla por completo.</span><span class="sxs-lookup"><span data-stu-id="cd319-331">With custom paging, however, after deleting that last product on the last page, the GridView simply disappears from the screen altogether.</span></span> <span data-ttu-id="cd319-332">El motivo exacto *¿por qué* esto sucede es un poco más allá del ámbito de este tutorial; vea [eliminar el último registro en la última página de un control GridView con paginación personalizada](http://scottonwriting.net/sowblog/posts/7326.aspx) para obtener los detalles de bajo nivel sobre el origen de Este problema.</span><span class="sxs-lookup"><span data-stu-id="cd319-332">The precise reason *why* this happens is a bit beyond the scope of this tutorial; see [Deleting the Last Record on the Last Page from a GridView with Custom Paging](http://scottonwriting.net/sowblog/posts/7326.aspx) for the low-level details as to the source of this problem.</span></span> <span data-ttu-id="cd319-333">En resumen, s debido a la siguiente secuencia de pasos que se realizan mediante el control GridView cuando se hace clic en el botón Eliminar:</span><span class="sxs-lookup"><span data-stu-id="cd319-333">In summary it s due to the following sequence of steps that are performed by the GridView when the Delete button is clicked:</span></span>

1. <span data-ttu-id="cd319-334">Eliminar el registro</span><span class="sxs-lookup"><span data-stu-id="cd319-334">Delete the record</span></span>
2. <span data-ttu-id="cd319-335">Obtener los registros apropiados para mostrar para el elemento especificado `PageIndex` y `PageSize`</span><span class="sxs-lookup"><span data-stu-id="cd319-335">Get the appropriate records to display for the specified `PageIndex` and `PageSize`</span></span>
3. <span data-ttu-id="cd319-336">Compruebe que la `PageIndex` no supera el número de páginas de datos del origen de datos; si lo automáticamente, disminuir la s GridView `PageIndex` propiedad</span><span class="sxs-lookup"><span data-stu-id="cd319-336">Check to ensure that the `PageIndex` does not exceed the number of pages of data in the data source; if it does, automatically decrement the GridView s `PageIndex` property</span></span>
4. <span data-ttu-id="cd319-337">Enlazar la página adecuada de los datos en GridView con los registros obtenidos en el paso 2</span><span class="sxs-lookup"><span data-stu-id="cd319-337">Bind the appropriate page of data to the GridView using the records obtained in Step 2</span></span>

<span data-ttu-id="cd319-338">El problema proviene del hecho ese paso 2 en el `PageIndex` usa al tomar los registros que se va a mostrar sigue siendo el `PageIndex` de la última página cuyo registro único solo se ha eliminado.</span><span class="sxs-lookup"><span data-stu-id="cd319-338">The problem stems from the fact that in Step 2 the `PageIndex` used when grabbing the records to display is still the `PageIndex` of the last page whose sole record was just deleted.</span></span> <span data-ttu-id="cd319-339">Por lo tanto, en el paso 2, *ningún* se devuelven registros desde esa última página de datos ya no contiene ningún registro.</span><span class="sxs-lookup"><span data-stu-id="cd319-339">Therefore, in Step 2, *no* records are returned since that last page of data no longer contains any records.</span></span> <span data-ttu-id="cd319-340">A continuación, en el paso 3, el control GridView es consciente de que su `PageIndex` propiedad es mayor que el número total de páginas en el origen de datos (desde que se ve eliminado el último registro de la última página) y, por tanto, disminuye su `PageIndex` propiedad.</span><span class="sxs-lookup"><span data-stu-id="cd319-340">Then, in Step 3, the GridView realizes that its `PageIndex` property is greater than the total number of pages in the data source (since we ve deleted the last record in the last page) and therefore decrements its `PageIndex` property.</span></span> <span data-ttu-id="cd319-341">En el paso 4 GridView intenta enlazar a los datos recuperados en el paso 2. Sin embargo, en el paso 2 se han devuelto ningún registro, por lo tanto, lo que en un GridView vacío.</span><span class="sxs-lookup"><span data-stu-id="cd319-341">In Step 4 the GridView attempts to bind itself to the data retrieved in Step 2; however, in Step 2 no records were returned, therefore resulting in an empty GridView.</span></span> <span data-ttu-id="cd319-342">Con la paginación de forma predeterminada, este problema tipo t superficie porque en el paso 2 *todas* se recuperan los registros del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="cd319-342">With default paging, this problem doesn t surface because in Step 2 *all* records are retrieved from the data source.</span></span>

<span data-ttu-id="cd319-343">Para solucionar este problema, tiene dos opciones.</span><span class="sxs-lookup"><span data-stu-id="cd319-343">To fix this we have two options.</span></span> <span data-ttu-id="cd319-344">La primera consiste en crear un controlador de eventos para el s GridView `RowDeleted` controlador de eventos que determina cuántos registros se muestran en la página que acaba de eliminar.</span><span class="sxs-lookup"><span data-stu-id="cd319-344">The first is to create an event handler for the GridView s `RowDeleted` event handler that determines how many records were displayed in the page that was just deleted.</span></span> <span data-ttu-id="cd319-345">Si se ha producido un único registro, a continuación, el registro que acaba de eliminar debe haber sido la última de ellas y necesitamos reducir la s GridView `PageIndex`.</span><span class="sxs-lookup"><span data-stu-id="cd319-345">If there was only one record, then the record just deleted must have been the last one and we need to decrement the GridView s `PageIndex`.</span></span> <span data-ttu-id="cd319-346">Por supuesto, sólo vamos a actualizar el `PageIndex` si la operación de eliminación fue realmente correcta, que se puede determinar si se asegura que el `e.Exception` propiedad es `null`.</span><span class="sxs-lookup"><span data-stu-id="cd319-346">Of course, we only want to update the `PageIndex` if the delete operation was actually successful, which can be determined by ensuring that the `e.Exception` property is `null`.</span></span>

<span data-ttu-id="cd319-347">Este enfoque funciona porque actualiza el `PageIndex` después del paso 1, pero antes del paso 2.</span><span class="sxs-lookup"><span data-stu-id="cd319-347">This approach works because it updates the `PageIndex` after Step 1 but before Step 2.</span></span> <span data-ttu-id="cd319-348">Por lo tanto, en el paso 2, se devuelve el conjunto de registros adecuado.</span><span class="sxs-lookup"><span data-stu-id="cd319-348">Therefore, in Step 2, the appropriate set of records is returned.</span></span> <span data-ttu-id="cd319-349">Para ello, use código similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="cd319-349">To accomplish this, use code like the following:</span></span>


[!code-vb[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample11.vb)]

<span data-ttu-id="cd319-350">Una solución alternativa es crear un controlador de eventos para el s ObjectDataSource `RowDeleted` eventos y establecer el `AffectedRows` propiedad con un valor de 1.</span><span class="sxs-lookup"><span data-stu-id="cd319-350">An alternative workaround is to create an event handler for the ObjectDataSource s `RowDeleted` event and to set the `AffectedRows` property to a value of 1.</span></span> <span data-ttu-id="cd319-351">Después de eliminar el registro en el paso 1 (pero antes de volver a recuperar los datos en el paso 2), el control GridView actualiza su `PageIndex` propiedad si uno o más filas afectadas por la operación.</span><span class="sxs-lookup"><span data-stu-id="cd319-351">After deleting the record in Step 1 (but before re-retrieving the data in Step 2), the GridView updates its `PageIndex` property if one or more rows were affected by the operation.</span></span> <span data-ttu-id="cd319-352">Sin embargo, el `AffectedRows` ObjectDataSource no establece la propiedad y, por tanto, se omite este paso.</span><span class="sxs-lookup"><span data-stu-id="cd319-352">However, the `AffectedRows` property is not set by the ObjectDataSource and therefore this step is omitted.</span></span> <span data-ttu-id="cd319-353">Es una manera de tener este paso ejecuta establecer manualmente el `AffectedRows` propiedad si la operación de eliminación se completa correctamente.</span><span class="sxs-lookup"><span data-stu-id="cd319-353">One way to have this step executed is to manually set the `AffectedRows` property if the delete operation completes successfully.</span></span> <span data-ttu-id="cd319-354">Esto puede lograrse mediante código similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="cd319-354">This can be accomplished using code like the following:</span></span>


[!code-vb[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample12.vb)]

<span data-ttu-id="cd319-355">El código para ambos de estos controladores de eventos puede encontrarse en la clase de código subyacente de la `EfficientPaging.aspx` ejemplo.</span><span class="sxs-lookup"><span data-stu-id="cd319-355">The code for both of these events handlers can be found in code-behind class of the `EfficientPaging.aspx` example.</span></span>

## <a name="comparing-the-performance-of-default-and-custom-paging"></a><span data-ttu-id="cd319-356">Comparar el rendimiento de forma predeterminada y la paginación personalizada</span><span class="sxs-lookup"><span data-stu-id="cd319-356">Comparing the Performance of Default and Custom Paging</span></span>

<span data-ttu-id="cd319-357">Puesto que la paginación personalizada solo recupera los registros necesarios, mientras que la paginación predeterminada devuelve *todas* de los registros de cada página que se está viendo, lo s borrar que es más eficaz que la paginación predeterminada paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="cd319-357">Since custom paging only retrieves the needed records, whereas default paging returns *all* of the records for each page being viewed, it s clear that custom paging is more efficient than default paging.</span></span> <span data-ttu-id="cd319-358">¿Pero el solo hecho mucho más eficaz es la paginación personalizada?</span><span class="sxs-lookup"><span data-stu-id="cd319-358">But just how much more efficient is custom paging?</span></span> <span data-ttu-id="cd319-359">¿Qué tipo de mejoras de rendimiento puede verse moviendo la paginación predeterminada a la paginación personalizada?</span><span class="sxs-lookup"><span data-stu-id="cd319-359">What sort of performance gains can be seen by moving from default paging to custom paging?</span></span>

<span data-ttu-id="cd319-360">Por desgracia, s hay no hay un tamaño se ajusta a todo responder aquí.</span><span class="sxs-lookup"><span data-stu-id="cd319-360">Unfortunately, there s no one size fits all answer here.</span></span> <span data-ttu-id="cd319-361">La ganancia de rendimiento depende de una serie de factores, más destacada dos el número de registros que se va a paginar a través y la carga se colocan en la base de datos servidor y canales de comunicación entre el servidor web y el servidor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cd319-361">The performance gain depends on a number of factors, the most prominent two being the number of records being paged through and the load placed on the database server and communication channels between the web server and database server.</span></span> <span data-ttu-id="cd319-362">Para tablas pequeñas con unos pocos docenas registros, la diferencia de rendimiento puede ser insignificante.</span><span class="sxs-lookup"><span data-stu-id="cd319-362">For small tables with just a few dozen records, the performance difference may be negligible.</span></span> <span data-ttu-id="cd319-363">Sin embargo, para tablas grandes, con miles de cientos de miles de filas, la diferencia de rendimiento es aguda.</span><span class="sxs-lookup"><span data-stu-id="cd319-363">For large tables, with thousands to hundreds of thousands of rows, though, the performance difference is acute.</span></span>

<span data-ttu-id="cd319-364">Un artículo mío, [paginación personalizada en ASP.NET 2.0 con SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx), contiene algunas pruebas de rendimiento se ejecutó para presentar las diferencias de rendimiento entre estas dos técnicas de paginación al paginar a través de una tabla de base de datos con 50.000 registros.</span><span class="sxs-lookup"><span data-stu-id="cd319-364">An article of mine, [Custom Paging in ASP.NET 2.0 with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx), contains some performance tests I ran to exhibit the differences in performance between these two paging techniques when paging through a database table with 50,000 records.</span></span> <span data-ttu-id="cd319-365">En estas pruebas examinar tanto el tiempo para ejecutar la consulta en el nivel de SQL Server (mediante [SQL Profiler](https://msdn.microsoft.com/library/ms173757.aspx)) y en la página ASP.NET mediante [características de seguimiento de ASP.NET s](https://msdn.microsoft.com/library/y13fw6we.aspx).</span><span class="sxs-lookup"><span data-stu-id="cd319-365">In these tests I examined both the time to execute the query at the SQL Server level (using [SQL Profiler](https://msdn.microsoft.com/library/ms173757.aspx)) and at the ASP.NET page using [ASP.NET s tracing features](https://msdn.microsoft.com/library/y13fw6we.aspx).</span></span> <span data-ttu-id="cd319-366">Tenga en cuenta que estas pruebas eran ejecutar en mi cuadro de desarrollo con un solo usuario activo y por lo tanto, son poco científicos y no imitar los patrones de carga del sitio Web típico.</span><span class="sxs-lookup"><span data-stu-id="cd319-366">Keep in mind that these tests were run on my development box with a single active user, and therefore are unscientific and do not mimic typical website load patterns.</span></span> <span data-ttu-id="cd319-367">No obstante, los resultados muestran las diferencias relativas en tiempo de ejecución de forma predeterminada y la paginación personalizada al trabajar con lo suficientemente grandes cantidades de datos.</span><span class="sxs-lookup"><span data-stu-id="cd319-367">Regardless, the results illustrate the relative differences in execution time for default and custom paging when working with sufficiently large amounts of data.</span></span>


|  | <span data-ttu-id="cd319-368">**Promedio Duración (s)**</span><span class="sxs-lookup"><span data-stu-id="cd319-368">**Avg. Duration (sec)**</span></span> | <span data-ttu-id="cd319-369">**Lecturas**</span><span class="sxs-lookup"><span data-stu-id="cd319-369">**Reads**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="cd319-370">**Paginación a SQL Profiler predeterminada**</span><span class="sxs-lookup"><span data-stu-id="cd319-370">**Default Paging SQL Profiler**</span></span> | <span data-ttu-id="cd319-371">1.411</span><span class="sxs-lookup"><span data-stu-id="cd319-371">1.411</span></span> | <span data-ttu-id="cd319-372">383</span><span class="sxs-lookup"><span data-stu-id="cd319-372">383</span></span> |
| <span data-ttu-id="cd319-373">**Profiler SQL de paginación personalizada**</span><span class="sxs-lookup"><span data-stu-id="cd319-373">**Custom Paging SQL Profiler**</span></span> | <span data-ttu-id="cd319-374">0.002</span><span class="sxs-lookup"><span data-stu-id="cd319-374">0.002</span></span> | <span data-ttu-id="cd319-375">29</span><span class="sxs-lookup"><span data-stu-id="cd319-375">29</span></span> |
| <span data-ttu-id="cd319-376">**Seguimiento de ASP.NET de paginación predeterminado**</span><span class="sxs-lookup"><span data-stu-id="cd319-376">**Default Paging ASP.NET Trace**</span></span> | <span data-ttu-id="cd319-377">2.379</span><span class="sxs-lookup"><span data-stu-id="cd319-377">2.379</span></span> | <span data-ttu-id="cd319-378">*N/A*</span><span class="sxs-lookup"><span data-stu-id="cd319-378">*N/A*</span></span> |
| <span data-ttu-id="cd319-379">**Seguimiento de ASP.NET de paginación personalizada**</span><span class="sxs-lookup"><span data-stu-id="cd319-379">**Custom Paging ASP.NET Trace**</span></span> | <span data-ttu-id="cd319-380">0.029</span><span class="sxs-lookup"><span data-stu-id="cd319-380">0.029</span></span> | <span data-ttu-id="cd319-381">*N/A*</span><span class="sxs-lookup"><span data-stu-id="cd319-381">*N/A*</span></span> |


<span data-ttu-id="cd319-382">Como puede ver, recuperar una determinada página de datos requerido por término medio 354 menos lecturas y finalizar en una fracción del tiempo.</span><span class="sxs-lookup"><span data-stu-id="cd319-382">As you can see, retrieving a particular page of data required 354 less reads on average and completed in a fraction of the time.</span></span> <span data-ttu-id="cd319-383">En la página ASP.NET personalizado la página fue capaz de representar en cerca de 1/100<sup>th</sup> del tiempo que tardó la paginación de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="cd319-383">At the ASP.NET page, custom the page was able to render in close to 1/100<sup>th</sup> of the time it took when using default paging.</span></span> <span data-ttu-id="cd319-384">Consulte [mi artículo](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx) para obtener más información sobre estos resultados junto con una base de datos y el código se puede descargar para reproducir estas pruebas en su propio entorno.</span><span class="sxs-lookup"><span data-stu-id="cd319-384">See [my article](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx) for more information on these results along with code and a database you can download to reproduce these tests in your own environment.</span></span>

## <a name="summary"></a><span data-ttu-id="cd319-385">Resumen</span><span class="sxs-lookup"><span data-stu-id="cd319-385">Summary</span></span>

<span data-ttu-id="cd319-386">Paginación predeterminada es muy fácil de implementar sólo comprobación de la casilla de verificación Habilitar paginación en la etiqueta inteligente de datos Web control s pero tal simplicidad proviene a costa del rendimiento.</span><span class="sxs-lookup"><span data-stu-id="cd319-386">Default paging is a cinch to implement just check the Enable Paging checkbox in the data Web control s smart tag but such simplicity comes at the cost of performance.</span></span> <span data-ttu-id="cd319-387">Con la paginación de forma predeterminada, cuando un usuario solicita cualquier página de datos *todas* se devuelven registros, aunque se muestren solamente una pequeña fracción de ellos.</span><span class="sxs-lookup"><span data-stu-id="cd319-387">With default paging, when a user requests any page of data *all* records are returned, even though only a tiny fraction of them may be shown.</span></span> <span data-ttu-id="cd319-388">Para combatir esta sobrecarga de rendimiento, el origen ObjectDataSource ofrece una alternativa paginación personalizada de opción de paginación.</span><span class="sxs-lookup"><span data-stu-id="cd319-388">To combat this performance overhead, the ObjectDataSource offers an alternative paging option custom paging.</span></span>

<span data-ttu-id="cd319-389">Mientras mejora la paginación personalizada predeterminada mediante la recuperación solo aquellos registros que deben mostrarse, problemas de rendimiento de s de paginación s más complicada implementar la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="cd319-389">While custom paging improves upon default paging s performance issues by retrieving only those records that need to be displayed, it s more involved to implement custom paging.</span></span> <span data-ttu-id="cd319-390">En primer lugar, debe escribir una consulta que correctamente (y eficaz) tenga acceso el subconjunto específico de registros solicitados.</span><span class="sxs-lookup"><span data-stu-id="cd319-390">First, a query must be written that correctly (and efficiently) accesses the specific subset of records requested.</span></span> <span data-ttu-id="cd319-391">Esto puede realizarse de varias maneras; lo hemos visto en este tutorial es usar SQL Server 2005 s nuevo `ROW_NUMBER()` da como resultado de la función de rango y, a continuación, para sólo los devolver resultados cuya clasificación se encuentra dentro de un intervalo especificado.</span><span class="sxs-lookup"><span data-stu-id="cd319-391">This can be accomplished in a number of ways; the one we examined in this tutorial is to use SQL Server 2005 s new `ROW_NUMBER()` function to rank results, and then to return just those results whose ranking falls within a specified range.</span></span> <span data-ttu-id="cd319-392">Además, tenemos que agregar una forma de determinar el número total de registros que se va a paginar a través.</span><span class="sxs-lookup"><span data-stu-id="cd319-392">Furthermore, we need to add a means to determine the total number of records being paged through.</span></span> <span data-ttu-id="cd319-393">Después de crear estos métodos DAL y BLL, también es necesario configurar el origen ObjectDataSource para que pueda determinar el número total de registros son que se va a paginar a través y correctamente pueden pasar los valores de índice de fila inicial y el número máximo de filas a la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="cd319-393">After creating these DAL and BLL methods, we also need to configure the ObjectDataSource so that it can determine how many total records are being paged through and can correctly pass the Start Row Index and Maximum Rows values to the BLL.</span></span>

<span data-ttu-id="cd319-394">Mientras que implementar la paginación personalizada requieren una serie de pasos y es casi no es tan sencillo como la paginación predeterminada, la paginación personalizada es una necesidad al paginar a través de lo suficientemente grandes cantidades de datos.</span><span class="sxs-lookup"><span data-stu-id="cd319-394">While implementing custom paging does require a number of steps and is not nearly as simple as default paging, custom paging is a necessity when paging through sufficiently large amounts of data.</span></span> <span data-ttu-id="cd319-395">A medida que examinan los resultados de la paginación personalizada, se demostró puede arrojar a segundos fuera el tiempo de procesamiento de la página ASP.NET y puede aclarar la carga en el servidor de base de datos en uno o más órdenes de magnitud.</span><span class="sxs-lookup"><span data-stu-id="cd319-395">As the results examined showed, custom paging can shed seconds off of the ASP.NET page render time and can lighten the load on the database server by one ore more orders of magnitude.</span></span>

<span data-ttu-id="cd319-396">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="cd319-396">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="cd319-397">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="cd319-397">About the Author</span></span>

<span data-ttu-id="cd319-398">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), trabaja con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="cd319-398">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cd319-399">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="cd319-399">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cd319-400">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="cd319-400">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cd319-401">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cd319-401">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="cd319-402">o a través de su blog, que puede encontrarse en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="cd319-402">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cd319-403">[Anterior](paging-and-sorting-report-data-vb.md)
> [Siguiente](sorting-custom-paged-data-vb.md)</span><span class="sxs-lookup"><span data-stu-id="cd319-403">[Previous](paging-and-sorting-report-data-vb.md)
[Next](sorting-custom-paged-data-vb.md)</span></span>

---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/cs/examining-the-edit-methods-and-edit-view
title: Examinar los métodos de edición y la vista de edición (C#) | Microsoft Docs
author: Rick-Anderson
description: Este tutorial le enseñará los aspectos básicos de la creación de una aplicación Web de ASP.NET MVC mediante Microsoft Visual Web Developer 2010 Express Service Pack 1, que es...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: 1d266bf0-a61e-423b-a3d2-13773d7dafe2
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/cs/examining-the-edit-methods-and-edit-view
msc.type: authoredcontent
ms.openlocfilehash: aacc9132a71fdd6ceb210c97001e1030d978836e
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/17/2019
ms.locfileid: "59393111"
---
# <a name="examining-the-edit-methods-and-edit-view-c"></a><span data-ttu-id="0a09e-103">Examinar los métodos y la vista Edit (C#)</span><span class="sxs-lookup"><span data-stu-id="0a09e-103">Examining the Edit Methods and Edit View (C#)</span></span>

<span data-ttu-id="0a09e-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="0a09e-104">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> > [!NOTE]
> > <span data-ttu-id="0a09e-105">Hay disponible una versión actualizada de este tutorial [aquí](../../../getting-started/introduction/getting-started.md) que usa ASP.NET MVC 5 y Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="0a09e-105">An updated version of this tutorial is available [here](../../../getting-started/introduction/getting-started.md) that uses ASP.NET MVC 5 and Visual Studio 2013.</span></span> <span data-ttu-id="0a09e-106">Es más seguro y mucho más fácil de seguir y se muestran las características más.</span><span class="sxs-lookup"><span data-stu-id="0a09e-106">It's more secure, much simpler to follow and demonstrates more features.</span></span>
> 
> 
> <span data-ttu-id="0a09e-107">Este tutorial le enseñará los aspectos básicos de la creación de una aplicación Web de ASP.NET MVC mediante Microsoft Visual Web Developer 2010 Express Service Pack 1, que es una versión gratuita de Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0a09e-107">This tutorial will teach you the basics of building an ASP.NET MVC Web application using Microsoft Visual Web Developer 2010 Express Service Pack 1, which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="0a09e-108">Antes de empezar, asegúrese de que ha instalado los requisitos previos descritos a continuación.</span><span class="sxs-lookup"><span data-stu-id="0a09e-108">Before you start, make sure you've installed the prerequisites listed below.</span></span> <span data-ttu-id="0a09e-109">Puede instalar todos ellos haciendo clic en el siguiente vínculo: [Instalador de plataforma Web](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="0a09e-109">You can install all of them by clicking the following link: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span></span> <span data-ttu-id="0a09e-110">Como alternativa, puede instalar individualmente los requisitos previos mediante los vínculos siguientes:</span><span class="sxs-lookup"><span data-stu-id="0a09e-110">Alternatively, you can individually install the prerequisites using the following links:</span></span>
> 
> - [<span data-ttu-id="0a09e-111">Requisitos previos de Visual Studio Web Developer Express SP1</span><span class="sxs-lookup"><span data-stu-id="0a09e-111">Visual Studio Web Developer Express SP1 prerequisites</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [<span data-ttu-id="0a09e-112">ASP.NET MVC 3 Tools Update</span><span class="sxs-lookup"><span data-stu-id="0a09e-112">ASP.NET MVC 3 Tools Update</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - <span data-ttu-id="0a09e-113">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(tiempo de ejecución de herramientas de soporte técnico +)</span><span class="sxs-lookup"><span data-stu-id="0a09e-113">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + tools support)</span></span>
> 
> <span data-ttu-id="0a09e-114">Si usa Visual Studio 2010, en lugar de Visual Web Developer 2010, instale los requisitos previos, haga clic en el siguiente vínculo: [Requisitos previos de Visual Studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="0a09e-114">If you're using Visual Studio 2010 instead of Visual Web Developer 2010, install the prerequisites by clicking the following link: [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span></span>
> 
> <span data-ttu-id="0a09e-115">Un proyecto de Visual Web Developer con código fuente de C# está disponible como acompañamiento de este tema.</span><span class="sxs-lookup"><span data-stu-id="0a09e-115">A Visual Web Developer project with C# source code is available to accompany this topic.</span></span> <span data-ttu-id="0a09e-116">[Descargue la versión de C#](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span><span class="sxs-lookup"><span data-stu-id="0a09e-116">[Download the C# version](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span></span> <span data-ttu-id="0a09e-117">Si prefiere Visual Basic, cambie a la [versión de Visual Basic](../vb/intro-to-aspnet-mvc-3.md) de este tutorial.</span><span class="sxs-lookup"><span data-stu-id="0a09e-117">If you prefer Visual Basic, switch to the [Visual Basic version](../vb/intro-to-aspnet-mvc-3.md) of this tutorial.</span></span>


<span data-ttu-id="0a09e-118">En esta sección, podrá examinar los métodos de acción generado y vistas para el controlador de película.</span><span class="sxs-lookup"><span data-stu-id="0a09e-118">In this section, you'll examine the generated action methods and views for the movie controller.</span></span> <span data-ttu-id="0a09e-119">A continuación, agregará una página de búsqueda personalizada.</span><span class="sxs-lookup"><span data-stu-id="0a09e-119">Then you'll add a custom search page.</span></span>

<span data-ttu-id="0a09e-120">Ejecute la aplicación y vaya a la `Movies` controlador anexando */Movies* a la dirección URL en la barra de direcciones del explorador.</span><span class="sxs-lookup"><span data-stu-id="0a09e-120">Run the application and browse to the `Movies` controller by appending */Movies* to the URL in the address bar of your browser.</span></span> <span data-ttu-id="0a09e-121">Mantenga el puntero del mouse sobre un **editar** vínculo para ver la dirección URL que está vinculado.</span><span class="sxs-lookup"><span data-stu-id="0a09e-121">Hold the mouse pointer over an **Edit** link to see the URL that it links to.</span></span>

<span data-ttu-id="0a09e-122">[![EditLink_sm](examining-the-edit-methods-and-edit-view/_static/image2.png)](examining-the-edit-methods-and-edit-view/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-122">[![EditLink_sm](examining-the-edit-methods-and-edit-view/_static/image2.png)](examining-the-edit-methods-and-edit-view/_static/image1.png)</span></span>

<span data-ttu-id="0a09e-123">El **editar** vínculo generado por el `Html.ActionLink` método en el *Views\Movies\Index.cshtml* vista:</span><span class="sxs-lookup"><span data-stu-id="0a09e-123">The **Edit** link was generated by the `Html.ActionLink` method in the *Views\Movies\Index.cshtml* view:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample1.cshtml)]

<span data-ttu-id="0a09e-124">[![Html.ActionLink](examining-the-edit-methods-and-edit-view/_static/image4.png)](examining-the-edit-methods-and-edit-view/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-124">[![Html.ActionLink](examining-the-edit-methods-and-edit-view/_static/image4.png)](examining-the-edit-methods-and-edit-view/_static/image3.png)</span></span>

<span data-ttu-id="0a09e-125">El `Html` objeto es una aplicación auxiliar que se expone mediante una propiedad en el `WebViewPage` clase base.</span><span class="sxs-lookup"><span data-stu-id="0a09e-125">The `Html` object is a helper that's exposed using a property on the `WebViewPage` base class.</span></span> <span data-ttu-id="0a09e-126">El `ActionLink` método de la aplicación auxiliar facilita la tarea generar dinámicamente hipervínculos HTML que se vinculan a los métodos de acción en los controladores.</span><span class="sxs-lookup"><span data-stu-id="0a09e-126">The `ActionLink` method of the helper makes it easy to dynamically generate HTML hyperlinks that link to action methods on controllers.</span></span> <span data-ttu-id="0a09e-127">El primer argumento para el `ActionLink` método es para representar el texto del vínculo (por ejemplo, `<a>Edit Me</a>`).</span><span class="sxs-lookup"><span data-stu-id="0a09e-127">The first argument to the `ActionLink` method is the link text to render (for example, `<a>Edit Me</a>`).</span></span> <span data-ttu-id="0a09e-128">El segundo argumento es el nombre del método de acción para invocar.</span><span class="sxs-lookup"><span data-stu-id="0a09e-128">The second argument is the name of the action method to invoke.</span></span> <span data-ttu-id="0a09e-129">El argumento final es un [objeto anónimo](https://weblogs.asp.net/scottgu/archive/2007/05/15/new-orcas-language-feature-anonymous-types.aspx) que genera los datos de ruta (en este caso, el identificador de 4).</span><span class="sxs-lookup"><span data-stu-id="0a09e-129">The final argument is an [anonymous object](https://weblogs.asp.net/scottgu/archive/2007/05/15/new-orcas-language-feature-anonymous-types.aspx) that generates the route data (in this case, the ID of 4).</span></span>

<span data-ttu-id="0a09e-130">El vínculo generado se muestra en la imagen anterior es `http://localhost:xxxxx/Movies/Edit/4`.</span><span class="sxs-lookup"><span data-stu-id="0a09e-130">The generated link shown in the previous image is `http://localhost:xxxxx/Movies/Edit/4`.</span></span> <span data-ttu-id="0a09e-131">La ruta predeterminada tiene el patrón de URL `{controller}/{action}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="0a09e-131">The default route takes the URL pattern `{controller}/{action}/{id}`.</span></span> <span data-ttu-id="0a09e-132">Por lo tanto, se traduce ASP.NET `http://localhost:xxxxx/Movies/Edit/4` en una solicitud para el `Edit` método de acción de la `Movies` controlador con el parámetro `ID` igual a 4.</span><span class="sxs-lookup"><span data-stu-id="0a09e-132">Therefore, ASP.NET translates `http://localhost:xxxxx/Movies/Edit/4` into a request to the `Edit` action method of the `Movies` controller with the parameter `ID` equal to 4.</span></span>

<span data-ttu-id="0a09e-133">También puede pasar parámetros de método de acción con una cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="0a09e-133">You can also pass action method parameters using a query string.</span></span> <span data-ttu-id="0a09e-134">Por ejemplo, la dirección URL `http://localhost:xxxxx/Movies/Edit?ID=4` también pasa el parámetro `ID` de 4 a la `Edit` método de acción de la `Movies` controlador.</span><span class="sxs-lookup"><span data-stu-id="0a09e-134">For example, the URL `http://localhost:xxxxx/Movies/Edit?ID=4` also passes the parameter `ID` of 4 to the `Edit` action method of the `Movies` controller.</span></span>

<span data-ttu-id="0a09e-135">[![EditQueryString](examining-the-edit-methods-and-edit-view/_static/image6.png)](examining-the-edit-methods-and-edit-view/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-135">[![EditQueryString](examining-the-edit-methods-and-edit-view/_static/image6.png)](examining-the-edit-methods-and-edit-view/_static/image5.png)</span></span>

<span data-ttu-id="0a09e-136">Abra el `Movies` controlador.</span><span class="sxs-lookup"><span data-stu-id="0a09e-136">Open the `Movies` controller.</span></span> <span data-ttu-id="0a09e-137">Los dos `Edit` a continuación se muestran los métodos de acción.</span><span class="sxs-lookup"><span data-stu-id="0a09e-137">The two `Edit` action methods are shown below.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample2.cs)]

<span data-ttu-id="0a09e-138">Observe que el segundo método de acción `Edit` va precedido del atributo `HttpPost`.</span><span class="sxs-lookup"><span data-stu-id="0a09e-138">Notice the second `Edit` action method is preceded by the `HttpPost` attribute.</span></span> <span data-ttu-id="0a09e-139">Este atributo especifica esa sobrecarga de la `Edit` se puede invocar el método solo para las solicitudes POST.</span><span class="sxs-lookup"><span data-stu-id="0a09e-139">This attribute specifies that overload of the `Edit` method can be invoked only for POST requests.</span></span> <span data-ttu-id="0a09e-140">Puede aplicar el `HttpGet` editar de atributo al primer método, pero que no es necesario porque es el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="0a09e-140">You could apply the `HttpGet` attribute to the first edit method, but that's not necessary because it's the default.</span></span> <span data-ttu-id="0a09e-141">(Nos referiremos a métodos de acción que se asignan implícitamente el `HttpGet` atributo como `HttpGet` métodos.)</span><span class="sxs-lookup"><span data-stu-id="0a09e-141">(We'll refer to action methods that are implicitly assigned the `HttpGet` attribute as `HttpGet` methods.)</span></span>

<span data-ttu-id="0a09e-142">El `HttpGet` `Edit` método toma el parámetro de Id. de película, busca la película con Entity Framework `Find` método y devuelve la película seleccionada a la vista de edición.</span><span class="sxs-lookup"><span data-stu-id="0a09e-142">The `HttpGet` `Edit` method takes the movie ID parameter, looks up the movie using the Entity Framework `Find` method, and returns the selected movie to the Edit view.</span></span> <span data-ttu-id="0a09e-143">Cuando el sistema de scaffolding creó la vista de edición, examinó la clase `Movie` y creó código para representar los elementos `<label>` y `<input>` para cada propiedad de la clase.</span><span class="sxs-lookup"><span data-stu-id="0a09e-143">When the scaffolding system created the Edit view, it examined the `Movie` class and created code to render `<label>` and `<input>` elements for each property of the class.</span></span> <span data-ttu-id="0a09e-144">El ejemplo siguiente muestra la vista de edición que se ha generado:</span><span class="sxs-lookup"><span data-stu-id="0a09e-144">The following example shows the Edit view that was generated:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample3.cshtml)]

<span data-ttu-id="0a09e-145">Observe cómo la plantilla de vista tiene un `@model MvcMovie.Models.Movie` instrucción en la parte superior del archivo: Especifica que la vista espera que el modelo para la plantilla de vista del tipo `Movie`.</span><span class="sxs-lookup"><span data-stu-id="0a09e-145">Notice how the view template has a `@model MvcMovie.Models.Movie` statement at the top of the file — this specifies that the view expects the model for the view template to be of type `Movie`.</span></span>

<span data-ttu-id="0a09e-146">El código con scaffolding usa varios *métodos auxiliares* para simplificar el marcado HTML.</span><span class="sxs-lookup"><span data-stu-id="0a09e-146">The scaffolded code uses several *helper methods* to streamline the HTML markup.</span></span> <span data-ttu-id="0a09e-147">El [ `Html.LabelFor` ](https://msdn.microsoft.com/library/gg401864(VS.98).aspx) auxiliar muestra el nombre del campo ("Title", "ReleaseDate", "Género" o "Price").</span><span class="sxs-lookup"><span data-stu-id="0a09e-147">The [`Html.LabelFor`](https://msdn.microsoft.com/library/gg401864(VS.98).aspx) helper displays the name of the field ("Title", "ReleaseDate", "Genre", or "Price").</span></span> <span data-ttu-id="0a09e-148">El [ `Html.EditorFor` ](https://msdn.microsoft.com/library/system.web.mvc.html.editorextensions.editorfor(VS.98).aspx) muestra de aplicación auxiliar HTML `<input>` elemento.</span><span class="sxs-lookup"><span data-stu-id="0a09e-148">The [`Html.EditorFor`](https://msdn.microsoft.com/library/system.web.mvc.html.editorextensions.editorfor(VS.98).aspx) helper displays an HTML `<input>` element.</span></span> <span data-ttu-id="0a09e-149">El [ `Html.ValidationMessageFor` ](https://msdn.microsoft.com/library/system.web.mvc.html.validationextensions.validationmessagefor(VS.98).aspx) auxiliar muestra los mensajes de validación asociados a esa propiedad.</span><span class="sxs-lookup"><span data-stu-id="0a09e-149">The [`Html.ValidationMessageFor`](https://msdn.microsoft.com/library/system.web.mvc.html.validationextensions.validationmessagefor(VS.98).aspx) helper displays any validation messages associated with that property.</span></span>

<span data-ttu-id="0a09e-150">Ejecute la aplicación y vaya a la */Movies* dirección URL.</span><span class="sxs-lookup"><span data-stu-id="0a09e-150">Run the application and navigate to the */Movies* URL.</span></span> <span data-ttu-id="0a09e-151">Haga clic en un vínculo **Edit** (Editar).</span><span class="sxs-lookup"><span data-stu-id="0a09e-151">Click an **Edit** link.</span></span> <span data-ttu-id="0a09e-152">En el explorador, vea el código fuente de la página.</span><span class="sxs-lookup"><span data-stu-id="0a09e-152">In the browser, view the source for the page.</span></span> <span data-ttu-id="0a09e-153">El código HTML en la página es similar al ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="0a09e-153">The HTML in the page looks like the following example.</span></span> <span data-ttu-id="0a09e-154">(El marcado de menú se excluyó para mayor claridad).</span><span class="sxs-lookup"><span data-stu-id="0a09e-154">(The menu markup was excluded for clarity.)</span></span>

[!code-html[Main](examining-the-edit-methods-and-edit-view/samples/sample4.html)]

<span data-ttu-id="0a09e-155">El `<input>` elementos se encuentran en un elemento HTML `<form>` elemento cuyo `action` atributo se establece para publicar en el */Movies/Edit* dirección URL.</span><span class="sxs-lookup"><span data-stu-id="0a09e-155">The `<input>` elements are in an HTML `<form>` element whose `action` attribute is set to post to the */Movies/Edit* URL.</span></span> <span data-ttu-id="0a09e-156">Los datos del formulario se publicarán en el servidor cuando el **editar** se hace clic en el botón.</span><span class="sxs-lookup"><span data-stu-id="0a09e-156">The form data will be posted to the server when the **Edit** button is clicked.</span></span>

## <a name="processing-the-post-request"></a><span data-ttu-id="0a09e-157">Procesamiento de la solicitud POST</span><span class="sxs-lookup"><span data-stu-id="0a09e-157">Processing the POST Request</span></span>

<span data-ttu-id="0a09e-158">En la siguiente lista se muestra la versión `HttpPost` del método de acción `Edit`.</span><span class="sxs-lookup"><span data-stu-id="0a09e-158">The following listing shows the `HttpPost` version of the `Edit` action method.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample5.cs)]

<span data-ttu-id="0a09e-159">El enlazador de modelos ASP.NET framework toma los valores de formulario publicados y crea un `Movie` objeto que se pasa como el `movie` parámetro.</span><span class="sxs-lookup"><span data-stu-id="0a09e-159">The ASP.NET framework model binder takes the posted form values and creates a `Movie` object that's passed as the `movie` parameter.</span></span> <span data-ttu-id="0a09e-160">El `ModelState.IsValid` proceso en el código comprueba que los datos presentados en el formulario se pueden usar para modificar un `Movie` objeto.</span><span class="sxs-lookup"><span data-stu-id="0a09e-160">The `ModelState.IsValid` check in the code verifies that the data submitted in the form can be used to modify a `Movie` object.</span></span> <span data-ttu-id="0a09e-161">Si los datos son válidos, el código guarda los datos de la película a la `Movies` colección de los `MovieDBContext` instancia.</span><span class="sxs-lookup"><span data-stu-id="0a09e-161">If the data is valid, the code saves the movie data to the `Movies` collection of the `MovieDBContext` instance.</span></span> <span data-ttu-id="0a09e-162">El código, a continuación, guarda los nuevos datos de película en la base de datos mediante una llamada a la `SaveChanges` método `MovieDBContext`, que conserva los cambios en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0a09e-162">The code then saves the new movie data to the database by calling the `SaveChanges` method of `MovieDBContext`, which persists changes to the database.</span></span> <span data-ttu-id="0a09e-163">Después de guardar los datos, el código redirige al usuario a la `Index` método de acción de la `MoviesController` (clase), lo que hace que la película actualizada que se mostrará en la lista de películas.</span><span class="sxs-lookup"><span data-stu-id="0a09e-163">After saving the data, the code redirects the user to the `Index` action method of the `MoviesController` class, which causes the updated movie to be displayed in the listing of movies.</span></span>

<span data-ttu-id="0a09e-164">Si los valores expuestos no son válidos, se vuelven a mostrar en el formulario.</span><span class="sxs-lookup"><span data-stu-id="0a09e-164">If the posted values aren't valid, they are redisplayed in the form.</span></span> <span data-ttu-id="0a09e-165">El `Html.ValidationMessageFor` aplicaciones auxiliares en el *Edit.cshtml* vista plantilla tenga cuidado de mostrar mensajes de error adecuado.</span><span class="sxs-lookup"><span data-stu-id="0a09e-165">The `Html.ValidationMessageFor` helpers in the *Edit.cshtml* view template take care of displaying appropriate error messages.</span></span>

<span data-ttu-id="0a09e-166">[![abcNotValid](examining-the-edit-methods-and-edit-view/_static/image8.png)](examining-the-edit-methods-and-edit-view/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-166">[![abcNotValid](examining-the-edit-methods-and-edit-view/_static/image8.png)](examining-the-edit-methods-and-edit-view/_static/image7.png)</span></span>

> <span data-ttu-id="0a09e-167">**Nota sobre las configuraciones regionales** si normalmente trabaja con una configuración regional distinto del inglés, vea [que admiten validación de ASP.NET MVC 3 con configuraciones regionales de inglés.](https://msdn.microsoft.com/library/gg674880(VS.98).aspx)</span><span class="sxs-lookup"><span data-stu-id="0a09e-167">**Note about locales** If you normally work with a locale other than English, see [Supporting ASP.NET MVC 3 Validation with Non-English Locales.](https://msdn.microsoft.com/library/gg674880(VS.98).aspx)</span></span>


## <a name="making-the-edit-method-more-robust"></a><span data-ttu-id="0a09e-168">Hacer que el método de edición más sólido</span><span class="sxs-lookup"><span data-stu-id="0a09e-168">Making the Edit Method More Robust</span></span>

<span data-ttu-id="0a09e-169">El `HttpGet` `Edit` método generado por el sistema de scaffolding no comprueba que el identificador que se pasa es válido.</span><span class="sxs-lookup"><span data-stu-id="0a09e-169">The `HttpGet` `Edit` method generated by the scaffolding system doesn't check that the ID that's passed to it is valid.</span></span> <span data-ttu-id="0a09e-170">Si un usuario elimina el segmento de Id. de la dirección URL (`http://localhost:xxxxx/Movies/Edit`), se muestra el error siguiente:</span><span class="sxs-lookup"><span data-stu-id="0a09e-170">If a user removes the ID segment from the URL (`http://localhost:xxxxx/Movies/Edit`), the following error is displayed:</span></span>

<span data-ttu-id="0a09e-171">[![Null_ID](examining-the-edit-methods-and-edit-view/_static/image10.png)](examining-the-edit-methods-and-edit-view/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-171">[![Null_ID](examining-the-edit-methods-and-edit-view/_static/image10.png)](examining-the-edit-methods-and-edit-view/_static/image9.png)</span></span>

<span data-ttu-id="0a09e-172">Un usuario también podría pasar un identificador que no existe en la base de datos, como `http://localhost:xxxxx/Movies/Edit/1234`.</span><span class="sxs-lookup"><span data-stu-id="0a09e-172">A user could also pass an ID that doesn't exist in the database, such as `http://localhost:xxxxx/Movies/Edit/1234`.</span></span> <span data-ttu-id="0a09e-173">Puede realizar dos cambios a la `HttpGet` `Edit` método de acción para abordar esta limitación.</span><span class="sxs-lookup"><span data-stu-id="0a09e-173">You can make two changes to the `HttpGet` `Edit` action method to address this limitation.</span></span> <span data-ttu-id="0a09e-174">En primer lugar, cambie el `ID` parámetro tenga un valor predeterminado de cero cuando un identificador no se pasa explícitamente.</span><span class="sxs-lookup"><span data-stu-id="0a09e-174">First, change the `ID` parameter to have a default value of zero when an ID isn't explicitly passed.</span></span> <span data-ttu-id="0a09e-175">También puede comprobar que el `Find` método realmente encuentra una película antes de devolver el objeto de película a la plantilla de vista.</span><span class="sxs-lookup"><span data-stu-id="0a09e-175">You can also check that the `Find` method actually found a movie before returning the movie object to the view template.</span></span> <span data-ttu-id="0a09e-176">La actualización `Edit` método se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="0a09e-176">The updated `Edit` method is shown below.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample6.cs)]

<span data-ttu-id="0a09e-177">Si no se encuentra ninguna película, el `HttpNotFound` se llama al método.</span><span class="sxs-lookup"><span data-stu-id="0a09e-177">If no movie is found, the `HttpNotFound` method is called.</span></span>

<span data-ttu-id="0a09e-178">Todas las `HttpGet` métodos siguen un patrón similar.</span><span class="sxs-lookup"><span data-stu-id="0a09e-178">All the `HttpGet` methods follow a similar pattern.</span></span> <span data-ttu-id="0a09e-179">Obtienen un objeto de película (o una lista de objetos, en el caso de `Index`) y pasar el modelo a la vista.</span><span class="sxs-lookup"><span data-stu-id="0a09e-179">They get a movie object (or list of objects, in the case of `Index`), and pass the model to the view.</span></span> <span data-ttu-id="0a09e-180">El `Create` método pasa un objeto de película vacío a la vista de creación.</span><span class="sxs-lookup"><span data-stu-id="0a09e-180">The `Create` method passes an empty movie object to the Create view.</span></span> <span data-ttu-id="0a09e-181">Todos los métodos que crean, editan, eliminan o modifican los datos lo hacen en la sobrecarga `HttpPost` del método.</span><span class="sxs-lookup"><span data-stu-id="0a09e-181">All the methods that create, edit, delete, or otherwise modify data do so in the `HttpPost` overload of the method.</span></span> <span data-ttu-id="0a09e-182">Modificación de datos en un método HTTP GET es un riesgo de seguridad, como se describe en la entrada de blog post [ASP.NET MVC sugerencia #46: no use eliminar vínculos porque crean vulnerabilidades de seguridad](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx).</span><span class="sxs-lookup"><span data-stu-id="0a09e-182">Modifying data in an HTTP GET method is a security risk, as described in the blog post entry [ASP.NET MVC Tip #46 – Don't use Delete Links because they create Security Holes](http://stephenwalther.com/blog/archive/2009/01/21/asp.net-mvc-tip-46-ndash-donrsquot-use-delete-links-because.aspx).</span></span> <span data-ttu-id="0a09e-183">Modificación de datos en un método GET también infringe procedimientos recomendados de HTTP y el patrón de arquitectura REST, que especifica que las solicitudes GET no deben cambiar el estado de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="0a09e-183">Modifying data in a GET method also violates HTTP best practices and the architectural REST pattern, which specifies that GET requests should not change the state of your application.</span></span> <span data-ttu-id="0a09e-184">En otras palabras, realizar una operación GET debería ser una operación segura que no tiene efectos secundarios.</span><span class="sxs-lookup"><span data-stu-id="0a09e-184">In other words, performing a GET operation should be a safe operation that has no side effects.</span></span>

## <a name="adding-a-search-method-and-search-view"></a><span data-ttu-id="0a09e-185">Agregar un método de búsqueda y la vista de búsqueda</span><span class="sxs-lookup"><span data-stu-id="0a09e-185">Adding a Search Method and Search View</span></span>

<span data-ttu-id="0a09e-186">En esta sección agregará un `SearchIndex` método de acción que le permite buscar películas por género o un nombre.</span><span class="sxs-lookup"><span data-stu-id="0a09e-186">In this section you'll add a `SearchIndex` action method that lets you search movies by genre or name.</span></span> <span data-ttu-id="0a09e-187">Esto estará disponible mediante la */Movies/SearchIndex* dirección URL.</span><span class="sxs-lookup"><span data-stu-id="0a09e-187">This will be available using the */Movies/SearchIndex* URL.</span></span> <span data-ttu-id="0a09e-188">La solicitud mostrará un formulario HTML que contiene los elementos de entrada que un usuario puede rellenar con el fin de buscar una película.</span><span class="sxs-lookup"><span data-stu-id="0a09e-188">The request will display an HTML form that contains input elements that a user can fill in in order to search for a movie.</span></span> <span data-ttu-id="0a09e-189">Cuando un usuario envía el formulario, el método de acción obtendrá los valores de búsqueda enviados por el usuario y usar los valores para buscar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0a09e-189">When a user submits the form, the action method will get the search values posted by the user and use the values to search the database.</span></span>

## <a name="displaying-the-searchindex-form"></a><span data-ttu-id="0a09e-190">Mostrando el formulario SearchIndex</span><span class="sxs-lookup"><span data-stu-id="0a09e-190">Displaying the SearchIndex Form</span></span>

<span data-ttu-id="0a09e-191">Empiece agregando un `SearchIndex` método de acción existente `MoviesController` clase.</span><span class="sxs-lookup"><span data-stu-id="0a09e-191">Start by adding a `SearchIndex` action method to the existing `MoviesController` class.</span></span> <span data-ttu-id="0a09e-192">El método devolverá una vista que contiene un formulario HTML.</span><span class="sxs-lookup"><span data-stu-id="0a09e-192">The method will return a view that contains an HTML form.</span></span> <span data-ttu-id="0a09e-193">Este es el código:</span><span class="sxs-lookup"><span data-stu-id="0a09e-193">Here's the code:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample7.cs)]

<span data-ttu-id="0a09e-194">La primera línea de la `SearchIndex` método crea los siguientes [LINQ](https://msdn.microsoft.com/library/bb397926.aspx) consulta para seleccionar las películas:</span><span class="sxs-lookup"><span data-stu-id="0a09e-194">The first line of the `SearchIndex` method creates the following [LINQ](https://msdn.microsoft.com/library/bb397926.aspx) query to select the movies:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample8.cs)]

<span data-ttu-id="0a09e-195">La consulta se define en este momento, pero aún no se ha ejecutado en el almacén de datos.</span><span class="sxs-lookup"><span data-stu-id="0a09e-195">The query is defined at this point, but hasn't yet been run against the data store.</span></span>

<span data-ttu-id="0a09e-196">Si el `searchString` parámetro contiene una cadena, la consulta de películas se modifica para filtrar según el valor de la cadena de búsqueda, utilizando el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="0a09e-196">If the `searchString` parameter contains a string, the movies query is modified to filter on the value of the search string, using the following code:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample9.cs)]

<span data-ttu-id="0a09e-197">Las consultas LINQ no se ejecutan cuando se definen o cuando se modifican mediante una llamada a un método como `Where` o `OrderBy`.</span><span class="sxs-lookup"><span data-stu-id="0a09e-197">LINQ queries are not executed when they are defined or when they are modified by calling a method such as `Where` or `OrderBy`.</span></span> <span data-ttu-id="0a09e-198">En su lugar, se aplaza la ejecución de la consulta, lo que significa que la evaluación de una expresión se retrasa hasta que su valor realizado se repita realmente o [ `ToList` ](https://msdn.microsoft.com/library/bb342261.aspx) se llama al método.</span><span class="sxs-lookup"><span data-stu-id="0a09e-198">Instead, query execution is deferred, which means that the evaluation of an expression is delayed until its realized value is actually iterated over or the [`ToList`](https://msdn.microsoft.com/library/bb342261.aspx) method is called.</span></span> <span data-ttu-id="0a09e-199">En el `SearchIndex` ejemplo, la consulta se ejecuta en la vista SearchIndex.</span><span class="sxs-lookup"><span data-stu-id="0a09e-199">In the `SearchIndex` sample, the query is executed in the SearchIndex view.</span></span> <span data-ttu-id="0a09e-200">Para más información sobre la ejecución de consultas en diferido, vea [Ejecución de la consulta](https://msdn.microsoft.com/library/bb738633.aspx).</span><span class="sxs-lookup"><span data-stu-id="0a09e-200">For more information about deferred query execution, see [Query Execution](https://msdn.microsoft.com/library/bb738633.aspx).</span></span>

<span data-ttu-id="0a09e-201">Ahora puede implementar la `SearchIndex` vista que se mostrará el formulario al usuario.</span><span class="sxs-lookup"><span data-stu-id="0a09e-201">Now you can implement the `SearchIndex` view that will display the form to the user.</span></span> <span data-ttu-id="0a09e-202">Haga clic en el `SearchIndex` método y, a continuación, haga clic en **agregar vista**.</span><span class="sxs-lookup"><span data-stu-id="0a09e-202">Right-click inside the `SearchIndex` method and then click **Add View**.</span></span> <span data-ttu-id="0a09e-203">En el **agregar vista** diálogo cuadro, especifique que va a pasar un `Movie` objeto a la plantilla de vista como su clase de modelo.</span><span class="sxs-lookup"><span data-stu-id="0a09e-203">In the **Add View** dialog box, specify that you're going to pass a `Movie` object to the view template as its model class.</span></span> <span data-ttu-id="0a09e-204">En el **plantilla Scaffold** elija **lista**, a continuación, haga clic en **agregar**.</span><span class="sxs-lookup"><span data-stu-id="0a09e-204">In the **Scaffold template** list, choose **List**, then click **Add**.</span></span>

<span data-ttu-id="0a09e-205">[![AddSearchView](examining-the-edit-methods-and-edit-view/_static/image12.png)](examining-the-edit-methods-and-edit-view/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-205">[![AddSearchView](examining-the-edit-methods-and-edit-view/_static/image12.png)](examining-the-edit-methods-and-edit-view/_static/image11.png)</span></span>

<span data-ttu-id="0a09e-206">Al hacer clic en el **agregar** botón, el *Views\Movies\SearchIndex.cshtml* se crea la plantilla de vista.</span><span class="sxs-lookup"><span data-stu-id="0a09e-206">When you click the **Add** button, the *Views\Movies\SearchIndex.cshtml* view template is created.</span></span> <span data-ttu-id="0a09e-207">Dado que seleccionó **lista** en el **plantilla Scaffold** enumerar, Visual Web Developer genera automáticamente (scaffolding) algún contenido de forma predeterminada en la vista.</span><span class="sxs-lookup"><span data-stu-id="0a09e-207">Because you selected **List** in the **Scaffold template** list, Visual Web Developer automatically generated (scaffolded) some default content in the view.</span></span> <span data-ttu-id="0a09e-208">La técnica de scaffolding crea un formulario HTML.</span><span class="sxs-lookup"><span data-stu-id="0a09e-208">The scaffolding created an HTML form.</span></span> <span data-ttu-id="0a09e-209">También se ha examinado el `Movie` clase y código creado para representar `<label>` elementos para cada propiedad de la clase.</span><span class="sxs-lookup"><span data-stu-id="0a09e-209">It examined the `Movie` class and created code to render `<label>` elements for each property of the class.</span></span> <span data-ttu-id="0a09e-210">La siguiente lista muestra la vista de creación que se ha generado:</span><span class="sxs-lookup"><span data-stu-id="0a09e-210">The listing below shows the Create view that was generated:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample10.cshtml)]

<span data-ttu-id="0a09e-211">Ejecute la aplicación y vaya a */Movies/SearchIndex*.</span><span class="sxs-lookup"><span data-stu-id="0a09e-211">Run the application and navigate to */Movies/SearchIndex*.</span></span> <span data-ttu-id="0a09e-212">Anexe una cadena de consulta como `?searchString=ghost` a la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="0a09e-212">Append a query string such as `?searchString=ghost` to the URL.</span></span> <span data-ttu-id="0a09e-213">Se muestran las películas filtradas.</span><span class="sxs-lookup"><span data-stu-id="0a09e-213">The filtered movies are displayed.</span></span>

<span data-ttu-id="0a09e-214">[![SearchQryStr](examining-the-edit-methods-and-edit-view/_static/image14.png)](examining-the-edit-methods-and-edit-view/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-214">[![SearchQryStr](examining-the-edit-methods-and-edit-view/_static/image14.png)](examining-the-edit-methods-and-edit-view/_static/image13.png)</span></span>

<span data-ttu-id="0a09e-215">Si cambia la firma de la `SearchIndex` método tenga un parámetro denominado `id`, el `id` parámetro coincidirá la `{id}` enruta el marcador de posición para el valor predeterminado establecido en el *Global.asax* archivo.</span><span class="sxs-lookup"><span data-stu-id="0a09e-215">If you change the signature of the `SearchIndex` method to have a parameter named `id`, the `id` parameter will match the `{id}` placeholder for the default routes set in the *Global.asax* file.</span></span>

[!code-json[Main](examining-the-edit-methods-and-edit-view/samples/sample11.json)]

<span data-ttu-id="0a09e-216">Modificado `SearchIndex` método tendría el aspecto siguiente:</span><span class="sxs-lookup"><span data-stu-id="0a09e-216">The modified `SearchIndex` method would look as follows:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample12.cs)]

<span data-ttu-id="0a09e-217">Ahora puede pasar el título de la búsqueda como datos de ruta (un segmento de dirección URL) en lugar de como un valor de cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="0a09e-217">You can now pass the search title as route data (a URL segment) instead of as a query string value.</span></span>

<span data-ttu-id="0a09e-218">[![SearchRouteData](examining-the-edit-methods-and-edit-view/_static/image16.png)](examining-the-edit-methods-and-edit-view/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-218">[![SearchRouteData](examining-the-edit-methods-and-edit-view/_static/image16.png)](examining-the-edit-methods-and-edit-view/_static/image15.png)</span></span>

<span data-ttu-id="0a09e-219">Sin embargo, no se puede esperar que los usuarios modifiquen la dirección URL cada vez que quieran buscar una película.</span><span class="sxs-lookup"><span data-stu-id="0a09e-219">However, you can't expect users to modify the URL every time they want to search for a movie.</span></span> <span data-ttu-id="0a09e-220">Ahora va a agregar la interfaz de usuario para ayudar a ellos filtrar las películas.</span><span class="sxs-lookup"><span data-stu-id="0a09e-220">So now you you'll add UI to help them filter movies.</span></span> <span data-ttu-id="0a09e-221">Si ha cambiado la firma de la `SearchIndex` método para probar cómo pasar el parámetro de identificador enlazado a una ruta, cámbielo para que su `SearchIndex` método toma un parámetro de cadena denominado `searchString`:</span><span class="sxs-lookup"><span data-stu-id="0a09e-221">If you changed the signature of the `SearchIndex` method to test how to pass the route-bound ID parameter, change it back so that your `SearchIndex` method takes a string parameter named `searchString`:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample13.cs)]

<span data-ttu-id="0a09e-222">Abra el *Views\Movies\SearchIndex.cshtml* archivo y, justo después `@Html.ActionLink("Create New", "Create")`, agregue lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="0a09e-222">Open the *Views\Movies\SearchIndex.cshtml* file, and just after `@Html.ActionLink("Create New", "Create")`, add the following:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample14.cshtml)]

<span data-ttu-id="0a09e-223">El ejemplo siguiente muestra una parte de la *Views\Movies\SearchIndex.cshtml* archivo con el marcado de filtrado se ha agregado.</span><span class="sxs-lookup"><span data-stu-id="0a09e-223">The following example shows a portion of the *Views\Movies\SearchIndex.cshtml* file with the added filtering markup.</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample15.cshtml)]

<span data-ttu-id="0a09e-224">El `Html.BeginForm` auxiliar crea una apertura `<form>` etiqueta.</span><span class="sxs-lookup"><span data-stu-id="0a09e-224">The `Html.BeginForm` helper creates an opening `<form>` tag.</span></span> <span data-ttu-id="0a09e-225">El `Html.BeginForm` auxiliar hace que el formulario registrar a sí mismo cuando el usuario envía el formulario, haga clic en el **filtro** botón.</span><span class="sxs-lookup"><span data-stu-id="0a09e-225">The `Html.BeginForm` helper causes the form to post to itself when the user submits the form by clicking the **Filter** button.</span></span>

<span data-ttu-id="0a09e-226">Ejecute la aplicación y pruebe a buscar una película.</span><span class="sxs-lookup"><span data-stu-id="0a09e-226">Run the application and try searching for a movie.</span></span>

<span data-ttu-id="0a09e-227">[![SearchIndxIE9_title](examining-the-edit-methods-and-edit-view/_static/image18.png)](examining-the-edit-methods-and-edit-view/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-227">[![SearchIndxIE9_title](examining-the-edit-methods-and-edit-view/_static/image18.png)](examining-the-edit-methods-and-edit-view/_static/image17.png)</span></span>

<span data-ttu-id="0a09e-228">No hay ningún `HttpPost` sobrecarga de la `SearchIndex` método.</span><span class="sxs-lookup"><span data-stu-id="0a09e-228">There's no `HttpPost` overload of the `SearchIndex` method.</span></span> <span data-ttu-id="0a09e-229">No es necesario, porque el método no cambia el estado de la aplicación, simplemente filtra los datos.</span><span class="sxs-lookup"><span data-stu-id="0a09e-229">You don't need it, because the method isn't changing the state of the application, just filtering data.</span></span>

<span data-ttu-id="0a09e-230">Después, puede agregar el método `HttpPost SearchIndex` siguiente.</span><span class="sxs-lookup"><span data-stu-id="0a09e-230">You could add the following `HttpPost SearchIndex` method.</span></span> <span data-ttu-id="0a09e-231">En ese caso, coincidiría con el invocador de acción el `HttpPost SearchIndex` método y el `HttpPost SearchIndex` método ejecutaría tal como se muestra en la imagen siguiente.</span><span class="sxs-lookup"><span data-stu-id="0a09e-231">In that case, the action invoker would match the `HttpPost SearchIndex` method, and the `HttpPost SearchIndex` method would run as shown in the image below.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample16.cs)]

<span data-ttu-id="0a09e-232">[![SearchPostGhost](examining-the-edit-methods-and-edit-view/_static/image20.png)](examining-the-edit-methods-and-edit-view/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-232">[![SearchPostGhost](examining-the-edit-methods-and-edit-view/_static/image20.png)](examining-the-edit-methods-and-edit-view/_static/image19.png)</span></span>

<span data-ttu-id="0a09e-233">Sin embargo, aunque agregue esta versión de `HttpPost` al método `SearchIndex`, hay una limitación en cómo se ha implementado todo esto.</span><span class="sxs-lookup"><span data-stu-id="0a09e-233">However, even if you add this `HttpPost` version of the `SearchIndex` method, there's a limitation in how this has all been implemented.</span></span> <span data-ttu-id="0a09e-234">Supongamos que quiere marcar una búsqueda en particular o que quiere enviar un vínculo a sus amigos donde puedan hacer clic para ver la misma lista filtrada de películas.</span><span class="sxs-lookup"><span data-stu-id="0a09e-234">Imagine that you want to bookmark a particular search or you want to send a link to friends that they can click in order to see the same filtered list of movies.</span></span> <span data-ttu-id="0a09e-235">Tenga en cuenta que la dirección URL de la solicitud HTTP POST es el mismo que la dirección URL de la solicitud GET (localhost: xxxxx/Movies/SearchIndex), no hay ninguna información de búsqueda en la propia dirección URL.</span><span class="sxs-lookup"><span data-stu-id="0a09e-235">Notice that the URL for the HTTP POST request is the same as the URL for the GET request (localhost:xxxxx/Movies/SearchIndex) -- there's no search information in the URL itself.</span></span> <span data-ttu-id="0a09e-236">Derecha ahora, la información de la cadena de búsqueda se envía al servidor como un valor de campo de formulario.</span><span class="sxs-lookup"><span data-stu-id="0a09e-236">Right now, the search string information is sent to the server as a form field value.</span></span> <span data-ttu-id="0a09e-237">Esto significa que no se puede capturar dicha información para marcar o enviar a amigos en una dirección URL.</span><span class="sxs-lookup"><span data-stu-id="0a09e-237">This means you can't capture that search information to bookmark or send to friends in a URL.</span></span>

<span data-ttu-id="0a09e-238">La solución consiste en utilizar una sobrecarga de `BeginForm` que especifica que la solicitud POST debe agregar la información de búsqueda a la dirección URL y que debe ser un enruta a la versión de HttpGet del `SearchIndex` método.</span><span class="sxs-lookup"><span data-stu-id="0a09e-238">The solution is to use an overload of `BeginForm` that specifies that the POST request should add the search information to the URL and that is should be routed to the HttpGet version of the `SearchIndex` method.</span></span> <span data-ttu-id="0a09e-239">Reemplazar el existente sin parámetros `BeginForm` método con lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="0a09e-239">Replace the existing parameterless `BeginForm` method with the following:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample17.cshtml)]

<span data-ttu-id="0a09e-240">[![BeginFormPost_SM](examining-the-edit-methods-and-edit-view/_static/image22.png)](examining-the-edit-methods-and-edit-view/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-240">[![BeginFormPost_SM](examining-the-edit-methods-and-edit-view/_static/image22.png)](examining-the-edit-methods-and-edit-view/_static/image21.png)</span></span>

<span data-ttu-id="0a09e-241">Ahora cuando se envía una búsqueda, la dirección URL contiene una cadena de consulta de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="0a09e-241">Now when you submit a search, the URL contains a search query string.</span></span> <span data-ttu-id="0a09e-242">La búsqueda también será dirigida al método de acción `HttpGet SearchIndex`, aunque tenga un método `HttpPost SearchIndex`.</span><span class="sxs-lookup"><span data-stu-id="0a09e-242">Searching will also go to the `HttpGet SearchIndex` action method, even if you have a `HttpPost SearchIndex` method.</span></span>

<span data-ttu-id="0a09e-243">[![SearchIndexWithGetURL](examining-the-edit-methods-and-edit-view/_static/image24.png)](examining-the-edit-methods-and-edit-view/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="0a09e-243">[![SearchIndexWithGetURL](examining-the-edit-methods-and-edit-view/_static/image24.png)](examining-the-edit-methods-and-edit-view/_static/image23.png)</span></span>

## <a name="adding-search-by-genre"></a><span data-ttu-id="0a09e-244">Adición de búsqueda por género</span><span class="sxs-lookup"><span data-stu-id="0a09e-244">Adding Search by Genre</span></span>

<span data-ttu-id="0a09e-245">Si ha agregado el `HttpPost` versión de la `SearchIndex` método, elimínelo.</span><span class="sxs-lookup"><span data-stu-id="0a09e-245">If you added the `HttpPost` version of the `SearchIndex` method, delete it now.</span></span>

<span data-ttu-id="0a09e-246">A continuación, agregará una característica para permitir que los usuarios buscar películas por género.</span><span class="sxs-lookup"><span data-stu-id="0a09e-246">Next, you'll add a feature to let users search for movies by genre.</span></span> <span data-ttu-id="0a09e-247">Reemplace el método `SearchIndex` con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="0a09e-247">Replace the `SearchIndex` method with the following code:</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample18.cs)]

<span data-ttu-id="0a09e-248">Esta versión de la `SearchIndex` método toma un parámetro adicional, es decir, `movieGenre`.</span><span class="sxs-lookup"><span data-stu-id="0a09e-248">This version of the `SearchIndex` method takes an additional parameter, namely `movieGenre`.</span></span> <span data-ttu-id="0a09e-249">Las primeras líneas de código crean un `List` objeto para contener los géneros de película de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0a09e-249">The first few lines of code create a `List` object to hold movie genres from the database.</span></span>

<span data-ttu-id="0a09e-250">El código siguiente es una consulta LINQ que recupera todos los géneros de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0a09e-250">The following code is a LINQ query that retrieves all the genres from the database.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample19.cs)]

<span data-ttu-id="0a09e-251">El código usa el `AddRange` método de la clase genérica `List` colección para agregar los distintos géneros a la lista.</span><span class="sxs-lookup"><span data-stu-id="0a09e-251">The code uses the `AddRange` method of the generic `List` collection to add all the distinct genres to the list.</span></span> <span data-ttu-id="0a09e-252">(Sin el `Distinct` modificador, se agregaría géneros duplicados, por ejemplo, Comedia se agregaría dos veces en nuestro ejemplo).</span><span class="sxs-lookup"><span data-stu-id="0a09e-252">(Without the `Distinct` modifier, duplicate genres would be added — for example, comedy would be added twice in our sample).</span></span> <span data-ttu-id="0a09e-253">El código, a continuación, almacena la lista de géneros de la `ViewBag` objeto.</span><span class="sxs-lookup"><span data-stu-id="0a09e-253">The code then stores the list of genres in the `ViewBag` object.</span></span>

<span data-ttu-id="0a09e-254">El código siguiente muestra cómo comprobar el `movieGenre` parámetro.</span><span class="sxs-lookup"><span data-stu-id="0a09e-254">The following code shows how to check the `movieGenre` parameter.</span></span> <span data-ttu-id="0a09e-255">Si no está vacío el código más restringe la consulta de películas para limitar las películas seleccionadas para el género especificado.</span><span class="sxs-lookup"><span data-stu-id="0a09e-255">If it's not empty the code further constrains the movies query to limit the selected movies to the specified genre.</span></span>

[!code-csharp[Main](examining-the-edit-methods-and-edit-view/samples/sample20.cs)]

## <a name="adding-markup-to-the-searchindex-view-to-support-search-by-genre"></a><span data-ttu-id="0a09e-256">Agregar marcas a la vista de SearchIndex para admitir la búsqueda por género</span><span class="sxs-lookup"><span data-stu-id="0a09e-256">Adding Markup to the SearchIndex View to Support Search by Genre</span></span>

<span data-ttu-id="0a09e-257">Agregar un `Html.DropDownList` auxiliar para el *Views\Movies\SearchIndex.cshtml* archivo, justo antes del `TextBox` auxiliar.</span><span class="sxs-lookup"><span data-stu-id="0a09e-257">Add an `Html.DropDownList` helper to the *Views\Movies\SearchIndex.cshtml* file, just before the `TextBox` helper.</span></span> <span data-ttu-id="0a09e-258">A continuación se muestra el marcado completado:</span><span class="sxs-lookup"><span data-stu-id="0a09e-258">The completed markup is shown below:</span></span>

[!code-cshtml[Main](examining-the-edit-methods-and-edit-view/samples/sample21.cshtml)]

<span data-ttu-id="0a09e-259">Ejecute la aplicación y vaya a */Movies/SearchIndex*.</span><span class="sxs-lookup"><span data-stu-id="0a09e-259">Run the application and browse to */Movies/SearchIndex*.</span></span> <span data-ttu-id="0a09e-260">Pruebe una búsqueda por género, nombre de la película y ambos criterios.</span><span class="sxs-lookup"><span data-stu-id="0a09e-260">Try a search by genre, by movie name, and by both criteria.</span></span>

<span data-ttu-id="0a09e-261">En esta sección se examinan los métodos de acción de CRUD y las vistas generadas por el marco de trabajo.</span><span class="sxs-lookup"><span data-stu-id="0a09e-261">In this section you examined the CRUD action methods and views generated by the framework.</span></span> <span data-ttu-id="0a09e-262">Crea un método de acción de búsqueda y la vista que permite a los usuarios buscar por título de la película y género.</span><span class="sxs-lookup"><span data-stu-id="0a09e-262">You created a search action method and view that let users search by movie title and genre.</span></span> <span data-ttu-id="0a09e-263">En la siguiente sección, echaremos un vistazo a cómo agregar una propiedad a la `Movie` modelo y cómo agregar un inicializador que creará automáticamente una base de datos de prueba.</span><span class="sxs-lookup"><span data-stu-id="0a09e-263">In the next section, you'll look at how to add a property to the `Movie` model and how to add an initializer that will automatically create a test database.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0a09e-264">[Anterior](accessing-your-models-data-from-a-controller.md)
> [Siguiente](adding-a-new-field.md)</span><span class="sxs-lookup"><span data-stu-id="0a09e-264">[Previous](accessing-your-models-data-from-a-controller.md)
[Next](adding-a-new-field.md)</span></span>

---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
title: Control de excepciones de nivel BLL y DAL (VB) | Microsoft Docs
author: rick-anderson
description: En este tutorial, veremos cómo controlar las excepciones producidas durante el flujo de trabajo actualización de un DataList editable de manera discreta.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: ca665073-b379-4239-9404-f597663ca65e
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
msc.type: authoredcontent
ms.openlocfilehash: 5108c1f04d73da4ce236fd0a872e0f64b82cbafa
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2019
ms.locfileid: "65119581"
---
# <a name="handling-bll--and-dal-level-exceptions-vb"></a><span data-ttu-id="232cb-103">Controlar las excepciones de nivel BLL y DAL (VB)</span><span class="sxs-lookup"><span data-stu-id="232cb-103">Handling BLL- and DAL-Level Exceptions (VB)</span></span>

<span data-ttu-id="232cb-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="232cb-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="232cb-105">[Descargue la aplicación de ejemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) o [descargar PDF](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="232cb-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span></span>

> <span data-ttu-id="232cb-106">En este tutorial, veremos cómo controlar las excepciones producidas durante el flujo de trabajo actualización de un DataList editable de manera discreta.</span><span class="sxs-lookup"><span data-stu-id="232cb-106">In this tutorial, we'll see how to tactfully handle exceptions raised during an editable DataList's updating workflow.</span></span>

## <a name="introduction"></a><span data-ttu-id="232cb-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="232cb-107">Introduction</span></span>

<span data-ttu-id="232cb-108">En el [información general de la edición y eliminación de datos en el control DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, creamos un control DataList que ofrecen simple de edición y eliminación de recursos.</span><span class="sxs-lookup"><span data-stu-id="232cb-108">In the [Overview of Editing and Deleting Data in the DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, we created a DataList that offered simple editing and deleting capabilities.</span></span> <span data-ttu-id="232cb-109">Aunque es totalmente funcional, estaba apenas fáciles de usar, como cualquier error producido durante la edición o eliminar proceso dieron lugar a una excepción no controlada.</span><span class="sxs-lookup"><span data-stu-id="232cb-109">While fully functional, it was hardly user-friendly, as any error that occurred during the editing or deleting process resulted in an unhandled exception.</span></span> <span data-ttu-id="232cb-110">Por ejemplo, si se omite el nombre del producto s o, al editar un producto, escriba un valor del precio de muy asequible!, produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="232cb-110">For example, omitting the product s name or, when editing a product, entering a price value of Very affordable!, throws an exception.</span></span> <span data-ttu-id="232cb-111">Puesto que no se detecta esta excepción en el código, propaga hasta el tiempo de ejecución ASP.NET, que, a continuación, muestra los detalles de excepción s en la página web.</span><span class="sxs-lookup"><span data-stu-id="232cb-111">Since this exception is not caught in code, it bubbles up to the ASP.NET runtime, which then displays the exception s details in the web page.</span></span>

<span data-ttu-id="232cb-112">Como hemos visto en el [BLL - control y excepciones de nivel DAL en una página ASP.NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, si se produce una excepción desde las profundidades de la lógica de negocios o los niveles de acceso a datos, los detalles de la excepción se devuelven a ObjectDataSource y a continuación, en GridView.</span><span class="sxs-lookup"><span data-stu-id="232cb-112">As we saw in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, if an exception is raised from the depths of the Business Logic or Data Access Layers, the exception details are returned to the ObjectDataSource and then to the GridView.</span></span> <span data-ttu-id="232cb-113">Hemos visto cómo controlar correctamente estas excepciones mediante la creación de `Updated` o `RowUpdated` controladores de eventos para el origen ObjectDataSource o GridView, comprobar si hay una excepción y, a continuación, que indica que se ha controlado la excepción.</span><span class="sxs-lookup"><span data-stu-id="232cb-113">We saw how to gracefully handle these exceptions by creating `Updated` or `RowUpdated` event handlers for the ObjectDataSource or GridView, checking for an exception, and then indicating that the exception was handled.</span></span>

<span data-ttu-id="232cb-114">Nuestros tutoriales DataList, sin embargo, no están usando el origen ObjectDataSource para actualizar y eliminar datos.</span><span class="sxs-lookup"><span data-stu-id="232cb-114">Our DataList tutorials, however, aren't using the ObjectDataSource for updating and deleting data.</span></span> <span data-ttu-id="232cb-115">En su lugar, estamos trabajando directamente en la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="232cb-115">Instead, we are working directly against the BLL.</span></span> <span data-ttu-id="232cb-116">Con el fin de detectar las excepciones que se origina en el nivel de lógica empresarial o DAL, debemos implementar código en el código subyacente de nuestra página ASP.NET de control de excepciones.</span><span class="sxs-lookup"><span data-stu-id="232cb-116">In order to detect exceptions originating from the BLL or DAL, we need to implement exception handling code within the code-behind of our ASP.NET page.</span></span> <span data-ttu-id="232cb-117">En este tutorial, veremos cómo controlar las excepciones iniciadas durante una s DataList editable actualizar el flujo de trabajo de manera más discreta.</span><span class="sxs-lookup"><span data-stu-id="232cb-117">In this tutorial, we'll see how to more tactfully handle exceptions raised during an editable DataList s updating workflow.</span></span>

> [!NOTE]
> <span data-ttu-id="232cb-118">En el *una visión general de edición y eliminación de datos en el control DataList* tutorial analizamos las distintas técnicas para editar y eliminar datos desde el control DataList, algunas técnicas conlleva el uso de un origen ObjectDataSource para actualizar y Eliminando.</span><span class="sxs-lookup"><span data-stu-id="232cb-118">In the *An Overview of Editing and Deleting Data in the DataList* tutorial we discussed different techniques for editing and deleting data from the DataList, Some techniques involved using an ObjectDataSource for updating and deleting.</span></span> <span data-ttu-id="232cb-119">Si emplea estas técnicas, puede controlar las excepciones de la capa BLL o DAL a través de las operaciones de asignación ObjectDataSource `Updated` o `Deleted` controladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="232cb-119">If you employ these techniques, you can handle exceptions from the BLL or DAL through the ObjectDataSource s `Updated` or `Deleted` event handlers.</span></span>

## <a name="step-1-creating-an-editable-datalist"></a><span data-ttu-id="232cb-120">Paso 1: Creación de un control DataList Editable</span><span class="sxs-lookup"><span data-stu-id="232cb-120">Step 1: Creating an Editable DataList</span></span>

<span data-ttu-id="232cb-121">Antes de que nos preocupamos controlar las excepciones que se producen durante el flujo de trabajo de actualización, permiten s en primer lugar cree a un DataList editable.</span><span class="sxs-lookup"><span data-stu-id="232cb-121">Before we worry about handling exceptions that occur during the updating workflow, let s first create an editable DataList.</span></span> <span data-ttu-id="232cb-122">Abrir el `ErrorHandling.aspx` página en el `EditDeleteDataList` carpeta, agregue un control DataList hasta el diseñador, establece su `ID` propiedad a `Products`, y agregue un nuevo origen ObjectDataSource denominado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="232cb-122">Open the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder, add a DataList to the Designer, set its `ID` property to `Products`, and add a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="232cb-123">Configurar el origen ObjectDataSource para usar el `ProductsBLL` clase s `GetProducts()` registra el método para seleccionar; establece las listas desplegables en la instrucción INSERT, UPDATE y eliminar pestañas en (None).</span><span class="sxs-lookup"><span data-stu-id="232cb-123">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>

<span data-ttu-id="232cb-124">[![Devolver la información de producto mediante el método GetProducts()](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="232cb-124">[![Return the Product Information Using the GetProducts() Method](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span></span>

<span data-ttu-id="232cb-125">**Figura 1**: Devolver la información de producto mediante la `GetProducts()` método ([haga clic aquí para ver imagen en tamaño completo](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="232cb-125">**Figure 1**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span></span>

<span data-ttu-id="232cb-126">Después de completar el ObjectDataSource wizard, Visual Studio creará automáticamente un `ItemTemplate` para el control DataList.</span><span class="sxs-lookup"><span data-stu-id="232cb-126">After completing the ObjectDataSource wizard, Visual Studio will automatically create an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="232cb-127">Reemplácelo con un `ItemTemplate` que muestra cada nombre de producto s y el precio y se incluye un botón de edición.</span><span class="sxs-lookup"><span data-stu-id="232cb-127">Replace this with an `ItemTemplate` that displays each product s name and price and includes an Edit button.</span></span> <span data-ttu-id="232cb-128">A continuación, cree un `EditItemTemplate` con un control de cuadro de texto Web para el nombre y el precio y botones Actualizar y Cancelar.</span><span class="sxs-lookup"><span data-stu-id="232cb-128">Next, create an `EditItemTemplate` with a TextBox Web control for name and price and Update and Cancel buttons.</span></span> <span data-ttu-id="232cb-129">Por último, establezca el control DataList s `RepeatColumns` propiedad en 2.</span><span class="sxs-lookup"><span data-stu-id="232cb-129">Finally, set the DataList s `RepeatColumns` property to 2.</span></span>

<span data-ttu-id="232cb-130">Después de estos cambios, el marcado declarativo s de página debe ser similar al siguiente.</span><span class="sxs-lookup"><span data-stu-id="232cb-130">After these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="232cb-131">Vuelva a comprobar para la edición, Cancelar, asegúrese de que y los botones de actualización tienen sus `CommandName` establecer propiedades para editar, Cancelar y actualizar, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="232cb-131">Double-check to make certain that the Edit, Cancel, and Update buttons have their `CommandName` properties set to Edit, Cancel, and Update, respectively.</span></span>

[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="232cb-132">En este tutorial, el control DataList debe habilitarse el estado de vista s.</span><span class="sxs-lookup"><span data-stu-id="232cb-132">For this tutorial the DataList s view state must be enabled.</span></span>

<span data-ttu-id="232cb-133">Dedique unos minutos a ver nuestro progreso a través de un explorador (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="232cb-133">Take a moment to view our progress through a browser (see Figure 2).</span></span>

<span data-ttu-id="232cb-134">[![Cada producto incluye un botón Editar](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="232cb-134">[![Each Product Includes an Edit Button](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span></span>

<span data-ttu-id="232cb-135">**Figura 2**: Cada producto incluye un botón Editar ([haga clic aquí para ver imagen en tamaño completo](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="232cb-135">**Figure 2**: Each Product Includes an Edit Button ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span></span>

<span data-ttu-id="232cb-136">Actualmente, el botón Editar solo produce un postback, t aún hacen que el producto editable.</span><span class="sxs-lookup"><span data-stu-id="232cb-136">Currently, the Edit button only causes a postback it doesn t yet make the product editable.</span></span> <span data-ttu-id="232cb-137">Para habilitar la edición, necesitamos crear controladores de eventos para el control DataList s `EditCommand`, `CancelCommand`, y `UpdateCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="232cb-137">To enable editing, we need to create event handlers for the DataList s `EditCommand`, `CancelCommand`, and `UpdateCommand` events.</span></span> <span data-ttu-id="232cb-138">El `EditCommand` y `CancelCommand` eventos solo tiene que actualizar el control DataList s `EditItemIndex` propiedad y volver a vincular los datos para el control DataList:</span><span class="sxs-lookup"><span data-stu-id="232cb-138">The `EditCommand` and `CancelCommand` events simply update the DataList s `EditItemIndex` property and rebind the data to the DataList:</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample2.vb)]

<span data-ttu-id="232cb-139">El `UpdateCommand` controlador de eventos es un poco más complicado.</span><span class="sxs-lookup"><span data-stu-id="232cb-139">The `UpdateCommand` event handler is a bit more involved.</span></span> <span data-ttu-id="232cb-140">Tiene que leerse en el producto editado s `ProductID` desde el `DataKeys` colección junto con el nombre de producto s y el precio de los cuadros de texto en el `EditItemTemplate`y, a continuación, llame a la `ProductsBLL` clase s `UpdateProduct` antes de devolver el control DataList (método) a su estado de edición previamente.</span><span class="sxs-lookup"><span data-stu-id="232cb-140">It needs to read in the edited product s `ProductID` from the `DataKeys` collection along with the product s name and price from the TextBoxes in the `EditItemTemplate`, and then call the `ProductsBLL` class s `UpdateProduct` method before returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="232cb-141">Por ahora, s permiten usar simplemente exactamente el mismo código de la `UpdateCommand` controlador de eventos en el *información general de la edición y eliminación de datos en el control DataList* tutorial.</span><span class="sxs-lookup"><span data-stu-id="232cb-141">For now, let s just use the exact same code from the `UpdateCommand` event handler in the *Overview of Editing and Deleting Data in the DataList* tutorial.</span></span> <span data-ttu-id="232cb-142">Vamos a agregar el código para controlar correctamente las excepciones en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="232cb-142">We'll add the code to gracefully handle exceptions in step 2.</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample3.vb)]

<span data-ttu-id="232cb-143">En caso de entrada no válida que puede ser en forma de un precio por unidad con formato incorrecto, un valor del precio de unidad no válida, como-$5.00 o la omisión del nombre de s del producto, se generará una excepción.</span><span class="sxs-lookup"><span data-stu-id="232cb-143">In the face of invalid input which can be in the form of an improperly formatted unit price, an illegal unit price value like -$5.00, or the omission of the product s name an exception will be raised.</span></span> <span data-ttu-id="232cb-144">Puesto que el `UpdateCommand` controlador de eventos no incluye ninguna en este momento, el código de control de excepciones, la excepción que se elevará hasta el tiempo de ejecución ASP.NET, donde se mostrarán al usuario final (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="232cb-144">Since the `UpdateCommand` event handler does not include any exception handling code at this point, the exception will bubble up to the ASP.NET runtime, where it will be displayed to the end user (see Figure 3).</span></span>

![Cuando se produce una excepción no controlada, el usuario final ve una página de Error](handling-bll-and-dal-level-exceptions-vb/_static/image7.png)

<span data-ttu-id="232cb-146">**Figura 3**: Cuando se produce una excepción no controlada, el usuario final ve una página de Error</span><span class="sxs-lookup"><span data-stu-id="232cb-146">**Figure 3**: When an Unhandled Exception Occurs, the End User Sees an Error Page</span></span>

## <a name="step-2-gracefully-handling-exceptions-in-the-updatecommand-event-handler"></a><span data-ttu-id="232cb-147">Paso 2: Administrar correctamente las excepciones en el controlador de eventos UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="232cb-147">Step 2: Gracefully Handling Exceptions in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="232cb-148">Durante el flujo de trabajo de actualización, pueden producirse excepciones en el `UpdateCommand` la capa DAL, BLL o controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="232cb-148">During the updating workflow, exceptions can occur in the `UpdateCommand` event handler, the BLL, or the DAL.</span></span> <span data-ttu-id="232cb-149">Por ejemplo, si un usuario escribe un precio de demasiadas costoso, el `Decimal.Parse` instrucción en el `UpdateCommand` controlador de eventos se iniciará un `FormatException` excepción.</span><span class="sxs-lookup"><span data-stu-id="232cb-149">For example, if a user enters a price of Too expensive, the `Decimal.Parse` statement in the `UpdateCommand` event handler will throw a `FormatException` exception.</span></span> <span data-ttu-id="232cb-150">Si el usuario la omita el nombre del producto s o si el precio tiene un valor negativo, la capa DAL, producirá una excepción.</span><span class="sxs-lookup"><span data-stu-id="232cb-150">If the user omits the product s name or if the price has a negative value, the DAL will raise an exception.</span></span>

<span data-ttu-id="232cb-151">Cuando se produce una excepción, queremos mostrar un mensaje informativo en la propia página.</span><span class="sxs-lookup"><span data-stu-id="232cb-151">When an exception occurs, we want to display an informative message within the page itself.</span></span> <span data-ttu-id="232cb-152">Agregar un sitio Web de la etiqueta de control a la página cuya `ID` está establecido en `ExceptionDetails`.</span><span class="sxs-lookup"><span data-stu-id="232cb-152">Add a Label Web control to the page whose `ID` is set to `ExceptionDetails`.</span></span> <span data-ttu-id="232cb-153">Configurar el texto del rótulo s para mostrar en una color rojo, muy grande, la fuente en negrita y cursiva mediante la asignación de su `CssClass` propiedad a la `Warning` clase CSS que se define en el `Styles.css` archivo.</span><span class="sxs-lookup"><span data-stu-id="232cb-153">Configure the Label s text to display in a red, extra-large, bold and italic font by assigning its `CssClass` property to the `Warning` CSS class, which is defined in the `Styles.css` file.</span></span>

<span data-ttu-id="232cb-154">Cuando se produce un error, solamente queremos la etiqueta que se mostrará una vez.</span><span class="sxs-lookup"><span data-stu-id="232cb-154">When an error occurs, we only want the Label to be displayed once.</span></span> <span data-ttu-id="232cb-155">Es decir, en los postbacks subsiguientes, el mensaje de advertencia de etiqueta s debería desaparecer.</span><span class="sxs-lookup"><span data-stu-id="232cb-155">That is, on subsequent postbacks, the Label s warning message should disappear.</span></span> <span data-ttu-id="232cb-156">Esto puede realizarse borrando la etiqueta s `Text` propiedad o la configuración de su `Visible` propiedad `False` en el `Page_Load` controlador de eventos (como hicimos en el [BLL - control y excepciones de nivel DAL en ASP Página .NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial) o si se deshabilita la compatibilidad de estado de vista de la etiqueta s.</span><span class="sxs-lookup"><span data-stu-id="232cb-156">This can be accomplished by either clearing out the Label s `Text` property or settings its `Visible` property to `False` in the `Page_Load` event handler (as we did back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial) or by disabling the Label s view state support.</span></span> <span data-ttu-id="232cb-157">Permitir que s use la última opción.</span><span class="sxs-lookup"><span data-stu-id="232cb-157">Let s use the latter option.</span></span>

[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample4.aspx)]

<span data-ttu-id="232cb-158">Cuando se produce una excepción, asignaremos los detalles de la excepción para el `ExceptionDetails` control s etiqueta `Text` propiedad.</span><span class="sxs-lookup"><span data-stu-id="232cb-158">When an exception is raised, we'll assign the details of the exception to the `ExceptionDetails` Label control s `Text` property.</span></span> <span data-ttu-id="232cb-159">Puesto que su estado de vista está deshabilitado, en los postbacks subsiguientes del `Text` cambios mediante programación la propiedad s se perderán, vuelve a establecerse en el texto predeterminado (una cadena vacía), ocultando de esta manera el mensaje de advertencia.</span><span class="sxs-lookup"><span data-stu-id="232cb-159">Since its view state is disabled, on subsequent postbacks the `Text` property s programmatic changes will be lost, reverting back to the default text (an empty string), thereby hiding the warning message.</span></span>

<span data-ttu-id="232cb-160">Para determinar cuándo se han se produce un error con el fin de mostrar un mensaje útil en la página, necesitamos agregar un `Try ... Catch` bloquear a los `UpdateCommand` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="232cb-160">To determine when an error has been raised in order to display a helpful message on the page, we need to add a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="232cb-161">El `Try` parte contiene el código que puede provocar una excepción, mientras que el `Catch` bloque contiene código que se ejecuta en el caso de una excepción.</span><span class="sxs-lookup"><span data-stu-id="232cb-161">The `Try` portion contains code that may lead to an exception, while the `Catch` block contains code that is executed in the face of an exception.</span></span> <span data-ttu-id="232cb-162">Consulte la [Fundamentos del control de excepciones](https://msdn.microsoft.com/library/2w8f0bss.aspx) sección en la documentación de .NET Framework para obtener más información sobre la `Try ... Catch` bloque.</span><span class="sxs-lookup"><span data-stu-id="232cb-162">Check out the [Exception Handling Fundamentals](https://msdn.microsoft.com/library/2w8f0bss.aspx) section in the .NET Framework documentation for more information on the `Try ... Catch` block.</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample5.vb)]

<span data-ttu-id="232cb-163">Cuando se produce una excepción de cualquier tipo de código dentro de la `Try` bloque, el `Catch` código del bloque s inicia la ejecución.</span><span class="sxs-lookup"><span data-stu-id="232cb-163">When an exception of any type is thrown by code within the `Try` block, the `Catch` block s code will begin executing.</span></span> <span data-ttu-id="232cb-164">El tipo de excepción que se produce `DbException`, `NoNullAllowedException`, `ArgumentException`y así sucesivamente depende de qué, exactamente, en primer lugar a provocado el error.</span><span class="sxs-lookup"><span data-stu-id="232cb-164">The type of exception that is thrown `DbException`, `NoNullAllowedException`, `ArgumentException`, and so on depends on what, exactly, precipitated the error in the first place.</span></span> <span data-ttu-id="232cb-165">Si hay un problema de s en el nivel de base de datos, un `DbException` se iniciará.</span><span class="sxs-lookup"><span data-stu-id="232cb-165">If there s a problem at the database level, a `DbException` will be thrown.</span></span> <span data-ttu-id="232cb-166">Si se especifica un valor no válido para el `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, o `ReorderLevel` campos, un `ArgumentException` se iniciará, tal como se ha agregado código para validar los valores de estos campos en el `ProductsDataTable` clase (vea la [ Crear una capa de lógica empresarial](../introduction/creating-a-business-logic-layer-vb.md) tutorial).</span><span class="sxs-lookup"><span data-stu-id="232cb-166">If an illegal value is entered for the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` fields, an `ArgumentException` will be thrown, as we added code to validate these field values in the `ProductsDataTable` class (see the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial).</span></span>

<span data-ttu-id="232cb-167">Podemos proporcionar una explicación más útil para el usuario final al basar el texto del mensaje en el tipo de excepción detectada.</span><span class="sxs-lookup"><span data-stu-id="232cb-167">We can provide a more helpful explanation to the end user by basing the message text on the type of exception caught.</span></span> <span data-ttu-id="232cb-168">El siguiente código que se usó de forma casi idéntica en el [BLL - control y excepciones de nivel DAL en una página ASP.NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial proporciona este nivel de detalle:</span><span class="sxs-lookup"><span data-stu-id="232cb-168">The following code which was used in a nearly identical form back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial provides this level of detail:</span></span>

[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample6.vb)]

<span data-ttu-id="232cb-169">Para completar este tutorial, simplemente llame a la `DisplayExceptionDetails` método desde el `Catch` bloque pasando detectado `Exception` instancia (`ex`).</span><span class="sxs-lookup"><span data-stu-id="232cb-169">To complete this tutorial, simply call the `DisplayExceptionDetails` method from the `Catch` block passing in the caught `Exception` instance (`ex`).</span></span>

<span data-ttu-id="232cb-170">Con el `Try ... Catch` bloquear en su lugar, los usuarios recibirán un mensaje de error más informativo, como las figuras 4 y 5 show.</span><span class="sxs-lookup"><span data-stu-id="232cb-170">With the `Try ... Catch` block in place, users are presented with a more informative error message, as Figures 4 and 5 show.</span></span> <span data-ttu-id="232cb-171">Tenga en cuenta que, en caso de una excepción, el control DataList, permanece en modo de edición.</span><span class="sxs-lookup"><span data-stu-id="232cb-171">Note that in the face of an exception the DataList remains in edit mode.</span></span> <span data-ttu-id="232cb-172">Esto es porque una vez que se produce la excepción, el flujo de control se redirigirá inmediatamente a la `Catch` bloque, omitiendo el código que devuelve el control DataList a su estado de edición previamente.</span><span class="sxs-lookup"><span data-stu-id="232cb-172">This is because once the exception occurs, the control flow is immediately redirected to the `Catch` block, bypassing the code that returns the DataList to its pre-editing state.</span></span>

<span data-ttu-id="232cb-173">[![Se muestra un mensaje de Error si un usuario la omita un campo necesario](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="232cb-173">[![An Error Message is Displayed if a User Omits a Required Field](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span></span>

<span data-ttu-id="232cb-174">**Figura 4**: Se muestra un mensaje de Error si un usuario la omita los campos opcionales ([haga clic aquí para ver imagen en tamaño completo](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="232cb-174">**Figure 4**: An Error Message is Displayed if a User Omits a Required Field ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span></span>

<span data-ttu-id="232cb-175">[![Es de un mensaje de Error aparece cuando escribe un precio negativo](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="232cb-175">[![An Error Message is Displayed When Entering a Negative Price](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span></span>

<span data-ttu-id="232cb-176">**Figura 5**: Es de un mensaje de Error aparece cuando escribe un precio negativo ([haga clic aquí para ver imagen en tamaño completo](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="232cb-176">**Figure 5**: An Error Message is Displayed When Entering a Negative Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span></span>

## <a name="summary"></a><span data-ttu-id="232cb-177">Resumen</span><span class="sxs-lookup"><span data-stu-id="232cb-177">Summary</span></span>

<span data-ttu-id="232cb-178">El control GridView y ObjectDataSource proporcionan controladores de eventos posteriores al nivel que incluyen información sobre las excepciones que se han producido durante el flujo de trabajo de actualización y eliminación, así como las propiedades que se pueden establecer para indicar si la excepción se ha controla.</span><span class="sxs-lookup"><span data-stu-id="232cb-178">The GridView and ObjectDataSource provide post-level event handlers that include information about any exceptions that were raised during the updating and deleting workflow, as well as properties that can be set to indicate whether or not the exception has been handled.</span></span> <span data-ttu-id="232cb-179">Estas características, sin embargo, no están disponibles al trabajar con el control DataList y uso de la capa BLL directamente.</span><span class="sxs-lookup"><span data-stu-id="232cb-179">These features, however, are unavailable when working with the DataList and using the BLL directly.</span></span> <span data-ttu-id="232cb-180">En su lugar, somos responsables de implementar el control de excepciones.</span><span class="sxs-lookup"><span data-stu-id="232cb-180">Instead, we are responsible for implementing exception handling.</span></span>

<span data-ttu-id="232cb-181">En este tutorial hemos visto cómo agregar el control de excepciones para una s DataList editable actualizar el flujo de trabajo mediante la adición de un `Try ... Catch` bloquear a los `UpdateCommand` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="232cb-181">In this tutorial we saw how to add exception handling to an editable DataList s updating workflow by adding a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="232cb-182">Si se produce una excepción durante el flujo de trabajo de actualización, el `Catch` ejecuta código del bloque s, mostrar información útil en la `ExceptionDetails` etiqueta.</span><span class="sxs-lookup"><span data-stu-id="232cb-182">If an exception is raised during the updating workflow, the `Catch` block s code executes, displaying helpful information in the `ExceptionDetails` Label.</span></span>

<span data-ttu-id="232cb-183">En este momento, el control DataList realiza ningún esfuerzo para evitar excepciones tengan lugar en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="232cb-183">At this point, the DataList makes no effort to prevent exceptions from happening in the first place.</span></span> <span data-ttu-id="232cb-184">Aunque se sabe que un precio negativo se producirá una excepción, aún no hayamos agregado funcionalidad para evitar de forma proactiva un usuario de escribir una entrada no válida.</span><span class="sxs-lookup"><span data-stu-id="232cb-184">Even though we know that a negative price will result in an exception, we haven't yet added any functionality to proactively prevent a user from entering such invalid input.</span></span> <span data-ttu-id="232cb-185">En nuestro siguiente tutorial veremos cómo ayudar a reducir las excepciones causadas por la entrada de usuario no válido mediante la adición de controles de validación en el `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="232cb-185">In our next tutorial we'll see how to help reduce the exceptions caused by invalid user input by adding validation controls in the `EditItemTemplate`.</span></span>

<span data-ttu-id="232cb-186">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="232cb-186">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="232cb-187">Información adicional</span><span class="sxs-lookup"><span data-stu-id="232cb-187">Further Reading</span></span>

<span data-ttu-id="232cb-188">Para obtener más información sobre los temas tratados en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="232cb-188">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="232cb-189">Instrucciones de diseño de excepciones</span><span class="sxs-lookup"><span data-stu-id="232cb-189">Design Guidelines for Exceptions</span></span>](https://msdn.microsoft.com/library/ms298399.aspx)
- <span data-ttu-id="232cb-190">[Módulos de registro de errores y controladores (ELMAH)](http://workspaces.gotdotnet.com/elmah) (una biblioteca de código abierto para el registro de errores)</span><span class="sxs-lookup"><span data-stu-id="232cb-190">[Error Logging Modules and Handlers (ELMAH)](http://workspaces.gotdotnet.com/elmah) (an open-source library for logging errors)</span></span>
- <span data-ttu-id="232cb-191">[Enterprise Library para .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (incluye Exception Management Application Block)</span><span class="sxs-lookup"><span data-stu-id="232cb-191">[Enterprise Library for .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (includes the Exception Management Application Block)</span></span>

## <a name="about-the-author"></a><span data-ttu-id="232cb-192">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="232cb-192">About the Author</span></span>

<span data-ttu-id="232cb-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), trabaja con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="232cb-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="232cb-194">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="232cb-194">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="232cb-195">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="232cb-195">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="232cb-196">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="232cb-196">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="232cb-197">o a través de su blog, que puede encontrarse en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="232cb-197">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="232cb-198">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="232cb-198">Special Thanks To</span></span>

<span data-ttu-id="232cb-199">Esta serie de tutoriales ha sido revisada por muchos revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="232cb-199">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="232cb-200">Revisor de clientes potencial para este tutorial era Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="232cb-200">Lead reviewer for this tutorial was Ken Pespisa.</span></span> <span data-ttu-id="232cb-201">¿Está interesado en leer mi próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="232cb-201">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="232cb-202">Si es así, envíeme una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="232cb-202">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="232cb-203">[Anterior](performing-batch-updates-vb.md)
> [Siguiente](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="232cb-203">[Previous](performing-batch-updates-vb.md)
[Next](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span></span>

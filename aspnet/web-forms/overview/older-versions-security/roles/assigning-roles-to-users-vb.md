---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
title: Asignar Roles a usuarios (VB) | Microsoft Docs
author: rick-anderson
description: En este tutorial crearemos dos páginas ASP.NET para ayudar a administrar qué usuarios pertenecen a qué roles. La primera página incluirá facilidades para ver qué...
ms.author: riande
ms.date: 03/24/2008
ms.assetid: fd208ee9-69cc-4467-9783-b4e039bdd1d3
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
msc.type: authoredcontent
ms.openlocfilehash: 334440f514e94927e428aef8fdba53f0b99e4460
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/01/2019
ms.locfileid: "57056752"
---
<a name="assigning-roles-to-users-vb"></a><span data-ttu-id="1abe2-104">Asignar roles a los usuarios (VB)</span><span class="sxs-lookup"><span data-stu-id="1abe2-104">Assigning Roles to Users (VB)</span></span>
====================
<span data-ttu-id="1abe2-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1abe2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1abe2-106">[Descargar código](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip) o [descargar PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="1abe2-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span></span>

> <span data-ttu-id="1abe2-107">En este tutorial crearemos dos páginas ASP.NET para ayudar a administrar qué usuarios pertenecen a qué roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="1abe2-108">La primera página incluirá facilidades para ver qué usuarios pertenecen a un rol determinado, los roles que pertenece un usuario determinado y la capacidad de asignar o quitar un usuario determinado de un rol determinado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="1abe2-109">En la segunda página aumentaremos el control CreateUserWizard para que incluya un paso para especificar los roles que pertenece el usuario recién creado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="1abe2-110">Esto es útil en escenarios donde es capaz de crear nuevas cuentas de usuario administrador.</span><span class="sxs-lookup"><span data-stu-id="1abe2-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>


## <a name="introduction"></a><span data-ttu-id="1abe2-111">Introducción</span><span class="sxs-lookup"><span data-stu-id="1abe2-111">Introduction</span></span>

<span data-ttu-id="1abe2-112">El <a id="_msoanchor_1"> </a> [tutorial anterior](creating-and-managing-roles-vb.md) examina el marco de trabajo de Roles y la `SqlRoleProvider`; hemos visto cómo usar el `Roles` clase para crear, recuperar y eliminar roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-vb.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="1abe2-113">Además de crear y eliminar roles, se debe ser capaz de asignar o quitar usuarios de un rol.</span><span class="sxs-lookup"><span data-stu-id="1abe2-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="1abe2-114">Lamentablemente, ASP.NET no se distribuye con los controles Web para administrar qué usuarios pertenecen a qué roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="1abe2-115">En su lugar, debemos crear nuestros propio páginas ASP.NET para administrar estas asociaciones.</span><span class="sxs-lookup"><span data-stu-id="1abe2-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="1abe2-116">La buena noticia es que agregar y quitar usuarios a roles es bastante fácil.</span><span class="sxs-lookup"><span data-stu-id="1abe2-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="1abe2-117">La `Roles` clase contiene una serie de métodos para agregar uno o varios usuarios a uno o varios roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="1abe2-118">En este tutorial crearemos dos páginas ASP.NET para ayudar a administrar qué usuarios pertenecen a qué roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="1abe2-119">La primera página incluirá facilidades para ver qué usuarios pertenecen a un rol determinado, los roles que pertenece un usuario determinado y la capacidad de asignar o quitar un usuario determinado de un rol determinado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="1abe2-120">En la segunda página aumentaremos el control CreateUserWizard para que incluya un paso para especificar los roles que pertenece el usuario recién creado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="1abe2-121">Esto es útil en escenarios donde es capaz de crear nuevas cuentas de usuario administrador.</span><span class="sxs-lookup"><span data-stu-id="1abe2-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="1abe2-122">Comencemos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="1abe2-123">Lista de qué usuarios pertenecen a qué Roles</span><span class="sxs-lookup"><span data-stu-id="1abe2-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="1abe2-124">La primera regla de negocio para este tutorial es crear una página web desde el que se pueden asignar usuarios a roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="1abe2-125">Antes de que se refieren a nosotros mismos con la forma de asignar a usuarios a roles, vamos a concentrarse en primer lugar cómo determinar qué usuarios pertenecen a qué roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="1abe2-126">Hay dos maneras de mostrar esta información: "rol" o ""usuario.</span><span class="sxs-lookup"><span data-stu-id="1abe2-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="1abe2-127">Podríamos permitir que el visitante seleccionar un rol y, a continuación, mostrarlos todos los usuarios que pertenecen a la función (la presentación "por el rol") o se puede pedir el visitante para seleccionar un usuario y, a continuación, mostrarles los roles asignados a ese usuario (la presentación "por usuario").</span><span class="sxs-lookup"><span data-stu-id="1abe2-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="1abe2-128">La vista "por"función es útil en circunstancias donde el visitante desea conocer el conjunto de usuarios que pertenecen a una función concreta; la vista "por usuario" es ideal cuando el visitante debe saber los roles de un usuario determinado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="1abe2-129">Vamos a que nuestra página incluya tanto "role" y "usuario" interfaces.</span><span class="sxs-lookup"><span data-stu-id="1abe2-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="1abe2-130">Comenzamos con la creación de la interfaz "por usuario".</span><span class="sxs-lookup"><span data-stu-id="1abe2-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="1abe2-131">Esta interfaz constará de una lista desplegable y una lista de casillas de verificación.</span><span class="sxs-lookup"><span data-stu-id="1abe2-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="1abe2-132">La lista desplegable se rellenará con el conjunto de usuarios en el sistema; las casillas de verificación enumerará los roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="1abe2-133">Al seleccionar un usuario de la lista desplegable comprobará que esos roles que pertenece el usuario.</span><span class="sxs-lookup"><span data-stu-id="1abe2-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="1abe2-134">La persona que visita la página puede, a continuación, active o desactive las casillas de verificación para agregar o quitar el usuario seleccionado de los roles correspondientes.</span><span class="sxs-lookup"><span data-stu-id="1abe2-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="1abe2-135">Uso de una lista desplegable lista a las cuentas de usuario no es una opción ideal para sitios Web que puede haber cientos de cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="1abe2-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="1abe2-136">Una lista desplegable está diseñada para permitir que un usuario seleccionar un elemento de una lista relativamente corta de opciones.</span><span class="sxs-lookup"><span data-stu-id="1abe2-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="1abe2-137">Rápidamente resulta difícil de manejar a medida que crece el número de elementos de lista.</span><span class="sxs-lookup"><span data-stu-id="1abe2-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="1abe2-138">Si está creando un sitio Web que tendrá potencialmente grandes números de cuentas de usuario, es aconsejable considere el uso de una interfaz de usuario alternativa, como un control GridView paginable o una interfaz filtrable que se enumera solicita el visitante para elegir una letra y, a continuación, solo Muestra los usuarios cuyo nombre de usuario comienza por la letra seleccionada.</span><span class="sxs-lookup"><span data-stu-id="1abe2-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>


## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="1abe2-139">Paso 1: Creación de la interfaz de usuario "Por usuario"</span><span class="sxs-lookup"><span data-stu-id="1abe2-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="1abe2-140">Abra el `UsersAndRoles.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="1abe2-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="1abe2-141">En la parte superior de la página, agregue un control de etiqueta Web denominado `ActionStatus` y borre su `Text` propiedad.</span><span class="sxs-lookup"><span data-stu-id="1abe2-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="1abe2-142">Esta etiqueta se usará para proporcionar comentarios sobre las acciones realizadas, mostrar mensajes como, "Tito de usuario se ha agregado a la función Administradores" o "Usuario Jisun se quitó de la función de los supervisores."</span><span class="sxs-lookup"><span data-stu-id="1abe2-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="1abe2-143">Para hacer que estas destacan los mensajes, Establece la etiqueta `CssClass` propiedad a "Importante".</span><span class="sxs-lookup"><span data-stu-id="1abe2-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample1.aspx)]

<span data-ttu-id="1abe2-144">A continuación, agregue la siguiente definición de clase CSS para el `Styles.css` hoja de estilos:</span><span class="sxs-lookup"><span data-stu-id="1abe2-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-vb/samples/sample2.css)]

<span data-ttu-id="1abe2-145">Esta definición CSS indica al explorador para mostrar la etiqueta con una fuente grande, rojo.</span><span class="sxs-lookup"><span data-stu-id="1abe2-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="1abe2-146">Figura 1 muestra este efecto mediante el Diseñador de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1abe2-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>


<span data-ttu-id="1abe2-147">[![Propiedad de la etiqueta CssClass da como resultado una fuente grande, roja](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span></span>

<span data-ttu-id="1abe2-148">**Figura 1**: La etiqueta `CssClass` propiedad da como resultado un gran tamaño, fuente de color rojo ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image3.png))</span></span>


<span data-ttu-id="1abe2-149">A continuación, agregue un DropDownList a la página, establezca su `ID` propiedad `UserList`y establezca su `AutoPostBack` propiedad en True.</span><span class="sxs-lookup"><span data-stu-id="1abe2-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="1abe2-150">Usaremos esta DropDownList para enumerar todos los usuarios en el sistema.</span><span class="sxs-lookup"><span data-stu-id="1abe2-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="1abe2-151">Este DropDownList se enlazará a una colección de objetos de MembershipUser.</span><span class="sxs-lookup"><span data-stu-id="1abe2-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="1abe2-152">Porque queremos DropDownList para mostrar la propiedad UserName del objeto MembershipUser (y usarlo como el valor de los elementos de lista), establezca la DropDownList `DataTextField` y `DataValueField` propiedades en "UserName".</span><span class="sxs-lookup"><span data-stu-id="1abe2-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="1abe2-153">Debajo de la DropDownList, agregue un control Repeater denominado `UsersRoleList`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="1abe2-154">Este control Repeater enumera todos los roles en el sistema como una serie de casillas de verificación.</span><span class="sxs-lookup"><span data-stu-id="1abe2-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="1abe2-155">Definir el repetidor `ItemTemplate` mediante el siguiente marcado declarativo:</span><span class="sxs-lookup"><span data-stu-id="1abe2-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample3.aspx)]

<span data-ttu-id="1abe2-156">El `ItemTemplate` marcado incluye un control de casilla de verificación Web único denominado `RoleCheckBox`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="1abe2-157">La casilla de verificación `AutoPostBack` propiedad está establecida en True y el `Text` propiedad está enlazada a `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="1abe2-158">La razón por la sintaxis de enlace de datos es simplemente `Container.DataItem` es porque el marco de trabajo Roles devuelve la lista de nombres de función como una matriz de cadenas, y es esta matriz de cadenas que realizaremos el enlace para el control Repeater.</span><span class="sxs-lookup"><span data-stu-id="1abe2-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="1abe2-159">Una descripción detallada de por qué esta sintaxis se utiliza para mostrar el contenido de una matriz que se enlaza a un control Web de datos queda fuera del ámbito de este tutorial.</span><span class="sxs-lookup"><span data-stu-id="1abe2-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="1abe2-160">Para obtener más información sobre este asunto, consulte [enlazar una matriz de escalar a un Control de datos Web](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="1abe2-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="1abe2-161">En este punto marcado declarativo de la interfaz de "por usuario" debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="1abe2-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample4.aspx)]

<span data-ttu-id="1abe2-162">Ahora estamos preparados escribir el código para enlazar el conjunto de cuentas de usuario al control DropDownList y el conjunto de roles para el control Repeater.</span><span class="sxs-lookup"><span data-stu-id="1abe2-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="1abe2-163">En la clase de código subyacente de la página, agregue un método denominado `BindUsersToUserList` y otro denominado `BindRolesList`, utilizando el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="1abe2-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample5.vb)]

<span data-ttu-id="1abe2-164">El `BindUsersToUserList` método recupera todas las cuentas de usuario en el sistema a través de la [ `Membership.GetAllUsers` método](https://msdn.microsoft.com/library/dy8swhya.aspx).</span><span class="sxs-lookup"><span data-stu-id="1abe2-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="1abe2-165">Esto devuelve un [ `MembershipUserCollection` objeto](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), que es una colección de [ `MembershipUser` instancias](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="1abe2-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="1abe2-166">Esta colección se enlaza a la `UserList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="1abe2-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="1abe2-167">El `MembershipUser` instancias que utilizan la colección contiene una serie de propiedades, como `UserName`, `Email`, `CreationDate`, y `IsOnline`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="1abe2-168">Con el fin de indicar la DropDownList para mostrar el valor de la `UserName` propiedad, asegúrese de que el `UserList` de DropDownList `DataTextField` y `DataValueField` propiedades se han establecido en "UserName".</span><span class="sxs-lookup"><span data-stu-id="1abe2-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="1abe2-169">El `Membership.GetAllUsers` método tiene dos sobrecargas: uno que no acepta ningún parámetro de entrada y devuelve todos los usuarios y otro que acepta valores enteros para el índice de la página y el tamaño de página y devuelve solo el subconjunto especificado de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="1abe2-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="1abe2-170">Cuando existen grandes cantidades de cuentas de usuario que se muestra en un elemento de interfaz de usuario paginable, la segunda sobrecarga se puede usar para la página de forma más eficaz a través de los usuarios debido a que devuelve solo el subconjunto preciso de las cuentas de usuario en lugar de todos ellos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>


<span data-ttu-id="1abe2-171">El `BindRolesToList` método comienza mediante una llamada a la `Roles` la clase [ `GetAllRoles` método](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), que devuelve una matriz de cadenas que contiene los roles en el sistema.</span><span class="sxs-lookup"><span data-stu-id="1abe2-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="1abe2-172">Esta matriz de cadenas, a continuación, se enlaza a Repeater.</span><span class="sxs-lookup"><span data-stu-id="1abe2-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="1abe2-173">Por último, es necesario llamar a estos dos métodos cuando se carga la página por primera vez.</span><span class="sxs-lookup"><span data-stu-id="1abe2-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="1abe2-174">Agregue el código siguiente al controlador de eventos `Page_Load` :</span><span class="sxs-lookup"><span data-stu-id="1abe2-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample6.vb)]

<span data-ttu-id="1abe2-175">Con este código en su lugar, tómese un momento para visitar la página a través de un explorador; la pantalla debe ser similar a la figura 2.</span><span class="sxs-lookup"><span data-stu-id="1abe2-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="1abe2-176">Todas las cuentas de usuario se rellenan en la lista desplegable y, por debajo de ésta, cada rol aparece como una casilla de verificación.</span><span class="sxs-lookup"><span data-stu-id="1abe2-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="1abe2-177">Dado que establecemos la `AutoPostBack` propiedades de la DropDownList y casillas de verificación en True, cambiar el usuario seleccionado o activando o desactivando una función produce un postback.</span><span class="sxs-lookup"><span data-stu-id="1abe2-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="1abe2-178">Sin embargo, se realiza ninguna acción porque todavía tenemos que escribir código para controlar estas acciones.</span><span class="sxs-lookup"><span data-stu-id="1abe2-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="1abe2-179">Trataremos estas tareas en las dos secciones siguientes.</span><span class="sxs-lookup"><span data-stu-id="1abe2-179">We'll tackle these tasks in the next two sections.</span></span>


<span data-ttu-id="1abe2-180">[![La página muestra los usuarios y Roles](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span></span>

<span data-ttu-id="1abe2-181">**Figura 2**: La página muestra los usuarios y Roles ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image6.png))</span></span>


### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="1abe2-182">Comprobación de los Roles seleccionado pertenece el usuario</span><span class="sxs-lookup"><span data-stu-id="1abe2-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="1abe2-183">Cuando se carga la página por primera vez, o cada vez que el visitante selecciona un nuevo usuario en la lista desplegable, deberá actualizar el `UsersRoleList`de casillas de verificación para que se activa una casilla de rol determinado solo si el usuario seleccionado pertenece a ese rol.</span><span class="sxs-lookup"><span data-stu-id="1abe2-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="1abe2-184">Para ello, cree un método denominado `CheckRolesForSelectedUser` con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="1abe2-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample7.vb)]

<span data-ttu-id="1abe2-185">El código anterior se inicia mediante la determinación de quién es el usuario seleccionado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="1abe2-186">A continuación, se utiliza la clase Roles [ `GetRolesForUser(userName)` método](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) para devolver el conjunto del usuario especificado de funciones como una matriz de cadenas.</span><span class="sxs-lookup"><span data-stu-id="1abe2-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="1abe2-187">A continuación, se enumeran los elementos de Repeater y cada elemento `RoleCheckBox` casilla mediante programación se hace referencia.</span><span class="sxs-lookup"><span data-stu-id="1abe2-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="1abe2-188">Se activa la casilla solo si está dentro de la función se corresponde con el `selectedUsersRoles` matriz de cadenas.</span><span class="sxs-lookup"><span data-stu-id="1abe2-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="1abe2-189">El `Linq.Enumerable.Contains(Of String)(...)` sintaxis no se compilará si usa la versión 2.0 de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="1abe2-189">The `Linq.Enumerable.Contains(Of String)(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="1abe2-190">El `Contains(Of String)` método forma parte de la [biblioteca LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query), que es una novedad de ASP.NET 3.5.</span><span class="sxs-lookup"><span data-stu-id="1abe2-190">The `Contains(Of String)` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="1abe2-191">Si aún utiliza la versión 2.0 de ASP.NET, utilice el [ `Array.IndexOf(Of String)` método](https://msdn.microsoft.com/library/eha9t187.aspx) en su lugar.</span><span class="sxs-lookup"><span data-stu-id="1abe2-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf(Of String)` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>


<span data-ttu-id="1abe2-192">El `CheckRolesForSelectedUser` método debe llamarse en dos casos: cuando se carga la página por primera vez y siempre que el `UserList` se cambia el índice seleccionado de DropDownList.</span><span class="sxs-lookup"><span data-stu-id="1abe2-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="1abe2-193">Por lo tanto, llamar a este método desde el `Page_Load` controlador de eventos (después de las llamadas a `BindUsersToUserList` y `BindRolesToList`).</span><span class="sxs-lookup"><span data-stu-id="1abe2-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="1abe2-194">Además, cree un controlador de eventos para la DropDownList `SelectedIndexChanged` evento y llamar a este método desde allí.</span><span class="sxs-lookup"><span data-stu-id="1abe2-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample8.vb)]

<span data-ttu-id="1abe2-195">Con este código en su lugar, puede probar la página a través del explorador.</span><span class="sxs-lookup"><span data-stu-id="1abe2-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="1abe2-196">Sin embargo, dado que la `UsersAndRoles.aspx` página actualmente carece de la capacidad para asignar usuarios a roles, ningún usuario tiene roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="1abe2-197">Vamos a crear la interfaz para asignar usuarios a roles en un momento, por lo que puede tomar una palabra que este código funciona y compruebe que lo hace más tarde, o puede agregar manualmente usuarios a roles mediante la inserción de registros en el `aspnet_UsersInRoles` tabla con el fin de probar este functi onality ahora.</span><span class="sxs-lookup"><span data-stu-id="1abe2-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="1abe2-198">Asignar y quitar usuarios de Roles</span><span class="sxs-lookup"><span data-stu-id="1abe2-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="1abe2-199">Cuando el visitante comprueba o desactiva una casilla de verificación en la `UsersRoleList` Repeater que necesitamos para agregar o quitar el usuario seleccionado de la función correspondiente.</span><span class="sxs-lookup"><span data-stu-id="1abe2-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="1abe2-200">La casilla de verificación `AutoPostBack` propiedad actualmente está establecida en True, lo que hace que una devolución de datos cada vez que una casilla en el control Repeater está activado o desactivado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="1abe2-201">En resumen, es necesario crear un controlador de eventos de la casilla `CheckChanged` eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="1abe2-202">Puesto que la casilla de verificación está en un control Repeater, tenemos que agregar manualmente la mecánica de controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="1abe2-203">Empiece por agregar el controlador de eventos a la clase de código subyacente, como un `Protected` método, de este modo:</span><span class="sxs-lookup"><span data-stu-id="1abe2-203">Start by adding the event handler to the code-behind class as a `Protected` method, like so:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample9.vb)]

<span data-ttu-id="1abe2-204">Se devolverá para escribir el código para este controlador de eventos en un momento.</span><span class="sxs-lookup"><span data-stu-id="1abe2-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="1abe2-205">Pero primero vamos a finalizar la estructura de control de eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="1abe2-206">En la casilla del control Repeater del `ItemTemplate`, agregar `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="1abe2-207">Esta sintaxis se conecta el `RoleCheckBox_CheckChanged` controlador de eventos para el `RoleCheckBox`del `CheckedChanged` eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample10.aspx)]

<span data-ttu-id="1abe2-208">Nuestra última tarea consiste en completar la `RoleCheckBox_CheckChanged` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="1abe2-209">Debemos comenzar haciendo referencia al control CheckBox que provocó el evento porque esta instancia de la casilla de verificación nos indica qué rol se ha comprobado o a través de su `Text` y `Checked` propiedades.</span><span class="sxs-lookup"><span data-stu-id="1abe2-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="1abe2-210">Con esta información junto con el nombre de usuario del usuario seleccionado, se agregar o quitar el usuario de la función a través de la `Roles` la clase [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) o [ `RemoveUserFromRole` método](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span><span class="sxs-lookup"><span data-stu-id="1abe2-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample11.vb)]

<span data-ttu-id="1abe2-211">El código anterior se inicia haciendo mediante programación la casilla de verificación que generó el evento, que está disponible a través de la `sender` parámetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="1abe2-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="1abe2-212">Si la casilla de verificación está activada, el usuario seleccionado se agrega al rol especificado, en caso contrario, se quitan de la función.</span><span class="sxs-lookup"><span data-stu-id="1abe2-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="1abe2-213">En cualquier caso, el `ActionStatus` etiqueta muestra un mensaje de resumen de la acción que acaba de realizar.</span><span class="sxs-lookup"><span data-stu-id="1abe2-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="1abe2-214">Dedique un momento para probar esta página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="1abe2-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="1abe2-215">Seleccione usuario Tito y, a continuación, agregue a Tito a administradores y los supervisores de roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>


<span data-ttu-id="1abe2-216">[![Se ha agregado Tito a los administradores y los supervisores Roles](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span></span>

<span data-ttu-id="1abe2-217">**Figura 3**: Tito se ha agregado a los administradores y Roles de los supervisores ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image9.png))</span></span>


<span data-ttu-id="1abe2-218">A continuación, seleccione el usuario Bruce en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="1abe2-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="1abe2-219">Hay una devolución de datos y las casillas de verificación de Repeater se actualizan a través de la `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="1abe2-220">Puesto que Bruce aún no pertenecen a ningún rol, se desactivan las dos casillas.</span><span class="sxs-lookup"><span data-stu-id="1abe2-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="1abe2-221">A continuación, agregue a Bruce a la función de los supervisores.</span><span class="sxs-lookup"><span data-stu-id="1abe2-221">Next, add Bruce to the Supervisors role.</span></span>


<span data-ttu-id="1abe2-222">[![Bruce se ha agregado a la función de los supervisores](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span></span>

<span data-ttu-id="1abe2-223">**Figura 4**: Bruce se ha agregado a la función de los supervisores ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image12.png))</span></span>


<span data-ttu-id="1abe2-224">Para comprobar la funcionalidad de la `CheckRolesForSelectedUser` método, seleccione un usuario que no sean Tito o Bruce.</span><span class="sxs-lookup"><span data-stu-id="1abe2-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="1abe2-225">Tenga en cuenta cómo se automáticamente desactivan las casillas de verificación, que indica que no pertenecen a ningún rol.</span><span class="sxs-lookup"><span data-stu-id="1abe2-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="1abe2-226">Volver a Tito.</span><span class="sxs-lookup"><span data-stu-id="1abe2-226">Return to Tito.</span></span> <span data-ttu-id="1abe2-227">Se deben comprobar tanto los administradores y los supervisores de casillas de verificación.</span><span class="sxs-lookup"><span data-stu-id="1abe2-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="1abe2-228">Paso 2: Creación de la interfaz de usuario "Por Roles"</span><span class="sxs-lookup"><span data-stu-id="1abe2-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="1abe2-229">En este momento se ha completado la interfaz "by users" y está listos para comenzar a abordar la interfaz "por roles".</span><span class="sxs-lookup"><span data-stu-id="1abe2-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="1abe2-230">La interfaz "por roles" pide al usuario que seleccione un rol en una lista desplegable y, a continuación, muestra el conjunto de usuarios que pertenecen a ese rol en un control GridView.</span><span class="sxs-lookup"><span data-stu-id="1abe2-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="1abe2-231">Agregue otro control DropDownList para la `UsersAndRoles.aspx page`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-231">Add another DropDownList control to the `UsersAndRoles.aspx page`.</span></span> <span data-ttu-id="1abe2-232">Coloca este uno debajo del control Repeater, asígnele el nombre `RoleList`y establezca su `AutoPostBack` propiedad en True.</span><span class="sxs-lookup"><span data-stu-id="1abe2-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="1abe2-233">Por debajo de ésta, agregue un control GridView y asígnele el nombre `RolesUserList`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="1abe2-234">Este control GridView mostrará los usuarios que pertenecen al rol seleccionado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="1abe2-235">Establezca la GridView `AutoGenerateColumns` propiedad en False, agregue un TemplateField a la cuadrícula `Columns` colección y establezca su `HeaderText` propiedad a "Usuarios".</span><span class="sxs-lookup"><span data-stu-id="1abe2-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="1abe2-236">Definir el TemplateField `ItemTemplate` para que se muestre el valor de la expresión de enlace de datos `Container.DataItem` en el `Text` propiedad de una etiqueta denominada `UserNameLabel`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="1abe2-237">Después de agregar y configurar el control GridView, el marcado declarativo de la interfaz de "por el rol" debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="1abe2-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample12.aspx)]

<span data-ttu-id="1abe2-238">Se debe rellenar el `RoleList` DropDownList con el conjunto de roles en el sistema.</span><span class="sxs-lookup"><span data-stu-id="1abe2-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="1abe2-239">Para lograr esto, actualice el `BindRolesToList` método así que enlaza la matriz de cadena devuelta por la `Roles.GetAllRoles` método a la `RolesList` DropDownList (así como el `UsersRoleList` Repeater).</span><span class="sxs-lookup"><span data-stu-id="1abe2-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample13.vb)]

<span data-ttu-id="1abe2-240">Las dos últimas líneas en el `BindRolesToList` método se han agregado para enlazar el conjunto de roles para el `RoleList` DropDownList (control).</span><span class="sxs-lookup"><span data-stu-id="1abe2-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="1abe2-241">Figura 5 muestra el resultado final cuando se ve mediante un explorador: una lista desplegable se rellena con los roles del sistema.</span><span class="sxs-lookup"><span data-stu-id="1abe2-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>


<span data-ttu-id="1abe2-242">[![Los Roles se muestran en RoleList DropDownList](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span></span>

<span data-ttu-id="1abe2-243">**Figura 5**: Los Roles se muestran en el `RoleList` DropDownList ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image15.png))</span></span>


### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="1abe2-244">Mostrar los usuarios que pertenecen al rol seleccionado</span><span class="sxs-lookup"><span data-stu-id="1abe2-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="1abe2-245">Cuando se carga la página por primera vez o cuando se selecciona un nuevo rol de la `RoleList` DropDownList, es necesario mostrar la lista de usuarios que pertenecen a ese rol en el control GridView.</span><span class="sxs-lookup"><span data-stu-id="1abe2-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="1abe2-246">Cree un método denominado `DisplayUsersBelongingToRole` con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="1abe2-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample14.vb)]

<span data-ttu-id="1abe2-247">Este método comienza mediante la obtención de la función seleccionada desde la `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="1abe2-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="1abe2-248">A continuación, usa el [ `Roles.GetUsersInRole(roleName)` método](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) para recuperar una matriz de cadenas de los nombres de usuario de los usuarios que pertenecen a ese rol.</span><span class="sxs-lookup"><span data-stu-id="1abe2-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="1abe2-249">Esta matriz se enlaza a la `RolesUserList` GridView.</span><span class="sxs-lookup"><span data-stu-id="1abe2-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="1abe2-250">Este método debe llamarse en dos casos: cuando se carga la página por primera vez y cuando el rol seleccionado en el `RoleList` DropDownList cambios.</span><span class="sxs-lookup"><span data-stu-id="1abe2-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="1abe2-251">Por lo tanto, actualizar la `Page_Load` controlador de eventos para que este método se invoca después de llamar a `CheckRolesForSelectedUser`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="1abe2-252">A continuación, cree un controlador de eventos para el `RoleList`del `SelectedIndexChanged` eventos y llamar a este método a partir de ahí, demasiado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample15.vb)]

<span data-ttu-id="1abe2-253">Con este código en su lugar, el `RolesUserList` GridView debe mostrar los usuarios que pertenecen a la función seleccionada.</span><span class="sxs-lookup"><span data-stu-id="1abe2-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="1abe2-254">Como se muestra en la figura 6, la función de los supervisores consta de dos miembros: Bruce y Tito.</span><span class="sxs-lookup"><span data-stu-id="1abe2-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>


<span data-ttu-id="1abe2-255">[![El control GridView enumera los usuarios que pertenecen al rol seleccionado](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span></span>

<span data-ttu-id="1abe2-256">**Figura 6**: La GridView se enumeran los usuarios que pertenecen al rol seleccionado ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image18.png))</span></span>


### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="1abe2-257">Quitar usuarios del rol seleccionado</span><span class="sxs-lookup"><span data-stu-id="1abe2-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="1abe2-258">Vamos a aumentar la `RolesUserList` botones GridView para que incluya una columna de "quitar".</span><span class="sxs-lookup"><span data-stu-id="1abe2-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="1abe2-259">Al hacer clic en el botón "Quitar" para un usuario determinado se quitarán de ese rol.</span><span class="sxs-lookup"><span data-stu-id="1abe2-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="1abe2-260">Empiece agregando un campo de botón de eliminación en el control GridView.</span><span class="sxs-lookup"><span data-stu-id="1abe2-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="1abe2-261">Que este campo aparezca como de la izquierda de archivado más y cambiar su `DeleteText` propiedad de "Delete" (predeterminado) a "Quitar".</span><span class="sxs-lookup"><span data-stu-id="1abe2-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>


<span data-ttu-id="1abe2-262">[![Agregar el](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-262">[![Add the](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span></span>

<span data-ttu-id="1abe2-263">**Figura 7**: Agregar el botón "Quitar" en el control GridView ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image21.png))</span></span>


<span data-ttu-id="1abe2-264">Cuando se hace clic en el botón "Quitar" que habrá trastornos una devolución de datos y la GridView `RowDeleting` provoca el evento.</span><span class="sxs-lookup"><span data-stu-id="1abe2-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="1abe2-265">Es necesario crear un controlador de eventos para este evento y escribir código que se quita al usuario el rol seleccionado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="1abe2-266">Cree el controlador de eventos y, a continuación, agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="1abe2-266">Create the event handler and then add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample16.vb)]

<span data-ttu-id="1abe2-267">El código empieza por determinar el nombre del rol seleccionado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="1abe2-268">A continuación, mediante programación las referencias del `UserNameLabel` control de la fila cuyo botón "Quitar" se hizo clic con el fin de determinar el nombre de usuario del usuario para quitar.</span><span class="sxs-lookup"><span data-stu-id="1abe2-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="1abe2-269">El usuario, a continuación, se quita de la función mediante una llamada a la `Roles.RemoveUserFromRole` método.</span><span class="sxs-lookup"><span data-stu-id="1abe2-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="1abe2-270">El `RolesUserList` GridView, a continuación, se actualiza y se muestra un mensaje a través de la `ActionStatus` control de etiqueta.</span><span class="sxs-lookup"><span data-stu-id="1abe2-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="1abe2-271">El botón "Quitar" no es necesario a algún tipo de confirmación del usuario antes de quitar el usuario de la función.</span><span class="sxs-lookup"><span data-stu-id="1abe2-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="1abe2-272">Le invito a agregar cierto nivel de confirmación del usuario.</span><span class="sxs-lookup"><span data-stu-id="1abe2-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="1abe2-273">Una de las maneras más fáciles para confirmar una acción es a través de un cuadro de diálogo de confirmación del lado cliente.</span><span class="sxs-lookup"><span data-stu-id="1abe2-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="1abe2-274">Para obtener más información sobre esta técnica, consulte [adición del lado cliente confirmación cuando se elimina](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="1abe2-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span></span>


<span data-ttu-id="1abe2-275">Figura 8 muestra la página después de quitar del grupo los supervisores de usuario Tito.</span><span class="sxs-lookup"><span data-stu-id="1abe2-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>


<span data-ttu-id="1abe2-276">[![Lamentablemente, Tito ya No es un Supervisor](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span></span>

<span data-ttu-id="1abe2-277">**Figura 8**: Lamentablemente, Tito ya No es un Supervisor ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image24.png))</span></span>


### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="1abe2-278">Adición de nuevos usuarios al rol seleccionado</span><span class="sxs-lookup"><span data-stu-id="1abe2-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="1abe2-279">Junto con quitando usuarios de la función seleccionada, el visitante a esta página también debe ser capaz de agregar un usuario al rol seleccionado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="1abe2-280">La interfaz de procedimiento para agregar un usuario al rol seleccionado depende del número de cuentas de usuario que espera tener.</span><span class="sxs-lookup"><span data-stu-id="1abe2-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="1abe2-281">Si su sitio Web hospedará pocas cuentas de usuario docenas o menos, podría utilizar DropDownList aquí.</span><span class="sxs-lookup"><span data-stu-id="1abe2-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="1abe2-282">Si puede haber miles de cuentas de usuario, desearía incluyen una interfaz de usuario que permite que el visitante para desplazarse a través de las cuentas, una cuenta determinada, buscar o filtrar las cuentas de usuario de algún otro modo.</span><span class="sxs-lookup"><span data-stu-id="1abe2-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="1abe2-283">Para esta página Vamos a usar una interfaz muy simple que funciona independientemente del número de cuentas de usuario en el sistema.</span><span class="sxs-lookup"><span data-stu-id="1abe2-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="1abe2-284">Es decir, usaremos un cuadro de texto, preguntar el visitante para escribir en el nombre de usuario del usuario que desea agregar al rol seleccionado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="1abe2-285">Si no existe ningún usuario con ese nombre, o si el usuario ya es miembro del rol, se mostrará un mensaje en `ActionStatus` etiqueta.</span><span class="sxs-lookup"><span data-stu-id="1abe2-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="1abe2-286">Pero si el usuario existe y no es un miembro del rol, deberá agregarlos al rol y actualizar la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="1abe2-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="1abe2-287">Agregue un cuadro de texto y un botón debajo del control GridView.</span><span class="sxs-lookup"><span data-stu-id="1abe2-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="1abe2-288">Establezca el cuadro de texto `ID` a `UserNameToAddToRole` y establezca el botón `ID` y `Text` propiedades a `AddUserToRoleButton` y "Agregar al rol de usuario", respectivamente.</span><span class="sxs-lookup"><span data-stu-id="1abe2-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample17.aspx)]

<span data-ttu-id="1abe2-289">A continuación, cree un `Click` controlador de eventos para el `AddUserToRoleButton` y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="1abe2-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample18.vb)]

<span data-ttu-id="1abe2-290">La mayoría del código en el `Click` controlador de eventos realiza varias comprobaciones de validación.</span><span class="sxs-lookup"><span data-stu-id="1abe2-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="1abe2-291">Se asegura de que el visitante especificado un nombre de usuario en el `UserNameToAddToRole` TextBox, que el usuario existe en el sistema y que ya no pertenecen al rol seleccionado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="1abe2-292">Si cualquiera de estas comprobaciones se produce un error, se muestra un mensaje adecuado en `ActionStatus` y se sale del controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="1abe2-293">Si se superan todas las comprobaciones, el usuario se agrega a la función a través de la `Roles.AddUserToRole` método.</span><span class="sxs-lookup"><span data-stu-id="1abe2-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="1abe2-294">A continuación, el cuadro de texto del `Text` propiedad se ha retirado, se actualiza el control GridView y el `ActionStatus` etiqueta muestra un mensaje que indica que el usuario especificado se agregó correctamente a la función seleccionada.</span><span class="sxs-lookup"><span data-stu-id="1abe2-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="1abe2-295">Para asegurarse de que el usuario especificado no pertenece al rol seleccionado, usamos el [ `Roles.IsUserInRole(userName, roleName)` método](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), que devuelve un valor booleano que indica si *userName* es un miembro de *roleName*.</span><span class="sxs-lookup"><span data-stu-id="1abe2-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="1abe2-296">Usamos este método nuevo en el <a id="_msoanchor_2"> </a> [siguiente tutorial](role-based-authorization-vb.md) cuando nos centramos en la autorización basada en roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-vb.md) when we look at role-based authorization.</span></span>


<span data-ttu-id="1abe2-297">Visite la página a través de un explorador y seleccione el rol de los supervisores de la `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="1abe2-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="1abe2-298">Pruebe a escribir un nombre de usuario no válido, verá un mensaje que explica que el usuario no existe en el sistema.</span><span class="sxs-lookup"><span data-stu-id="1abe2-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>


<span data-ttu-id="1abe2-299">[![No se puede agregar un usuario inexistente a un rol](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span></span>

<span data-ttu-id="1abe2-300">**Figura 9**: No se puede agregar un usuario inexistente a una función ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image27.png))</span></span>


<span data-ttu-id="1abe2-301">Ahora intente agregar un usuario válido.</span><span class="sxs-lookup"><span data-stu-id="1abe2-301">Now try adding a valid user.</span></span> <span data-ttu-id="1abe2-302">Siga adelante y volver a agregar a Tito a la función de los supervisores.</span><span class="sxs-lookup"><span data-stu-id="1abe2-302">Go ahead and re-add Tito to the Supervisors role.</span></span>


<span data-ttu-id="1abe2-303">[![¡Una vez más, Tito es un Supervisor!](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span></span>

<span data-ttu-id="1abe2-304">**Figura 10**: ¡Una vez más, Tito es un Supervisor!</span><span class="sxs-lookup"><span data-stu-id="1abe2-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="1abe2-305">([Haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-305">([Click to view full-size image](assigning-roles-to-users-vb/_static/image30.png))</span></span>


## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="1abe2-306">Paso 3: Actualización de entre el "Por usuario" y "rol" Interfaces</span><span class="sxs-lookup"><span data-stu-id="1abe2-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="1abe2-307">El `UsersAndRoles.aspx` página ofrece dos interfaces distintas para administrar usuarios y roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="1abe2-308">Actualmente, estas dos interfaces actúan independientemente entre sí por lo que es posible que un cambio realizado en una interfaz no se reflejará inmediatamente en el otro.</span><span class="sxs-lookup"><span data-stu-id="1abe2-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="1abe2-309">Por ejemplo, imagine que el visitante de la página, selecciona el rol de los supervisores de la `RoleList` DropDownList, donde se muestra Bruce y Tito como miembros.</span><span class="sxs-lookup"><span data-stu-id="1abe2-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="1abe2-310">A continuación, el visitante selecciona Tito desde el `UserList` DropDownList, que comprueba las casillas de los administradores y los supervisores en el `UsersRoleList` Repeater.</span><span class="sxs-lookup"><span data-stu-id="1abe2-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="1abe2-311">Si el visitante, a continuación, desactiva el rol de Supervisor desde el control Repeater, Tito se quita de la función de los supervisores, pero esta modificación no se refleja en la interfaz "por el rol".</span><span class="sxs-lookup"><span data-stu-id="1abe2-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="1abe2-312">El control GridView seguirá mostrando a Tito como un miembro del rol de los supervisores.</span><span class="sxs-lookup"><span data-stu-id="1abe2-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="1abe2-313">Para corregir esto se deba actualizar el control GridView cada vez que un rol está activado o desactivado desde el `UsersRoleList` Repeater.</span><span class="sxs-lookup"><span data-stu-id="1abe2-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="1abe2-314">Del mismo modo, se deba actualizar el control Repeater cada vez que un usuario se quita o se agrega a un rol de la interfaz "por el rol".</span><span class="sxs-lookup"><span data-stu-id="1abe2-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="1abe2-315">El control Repeater en la interfaz "por usuario" se actualiza mediante una llamada a la `CheckRolesForSelectedUser` método.</span><span class="sxs-lookup"><span data-stu-id="1abe2-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="1abe2-316">Se puede modificar la interfaz "por el rol" en el `RolesUserList` de GridView `RowDeleting` controlador de eventos y el `AddUserToRoleButton` del botón `Click` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="1abe2-317">Por lo tanto, es necesario llamar a la `CheckRolesForSelectedUser` método de cada uno de estos métodos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample19.vb)]

<span data-ttu-id="1abe2-318">Del mismo modo, se actualiza el control GridView en la interfaz "por el rol" mediante una llamada a la `DisplayUsersBelongingToRole` se modifica el método y la interfaz "por usuario" a través de la `RoleCheckBox_CheckChanged` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="1abe2-319">Por lo tanto, es necesario llamar a la `DisplayUsersBelongingToRole` método desde este controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample20.vb)]

<span data-ttu-id="1abe2-320">Con estos cambios de código secundario, el "por usuario" y "rol" interfaces ahora correctamente entre la actualización.</span><span class="sxs-lookup"><span data-stu-id="1abe2-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="1abe2-321">Para comprobarlo, visite la página a través de un explorador y seleccione Tito y los supervisores de la `UserList` y `RoleList` DropDownLists, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="1abe2-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="1abe2-322">Tenga en cuenta que como desactive el rol de los supervisores de Tito desde el control Repeater en la interfaz "por usuario", Tito se quita automáticamente del control GridView en la interfaz "por el rol".</span><span class="sxs-lookup"><span data-stu-id="1abe2-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="1abe2-323">Volver a agregar Tito volver a la función de los supervisores de la interfaz "por el rol" automáticamente comprobaciones de la casilla de verificación de los supervisores en la interfaz "por usuario".</span><span class="sxs-lookup"><span data-stu-id="1abe2-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="1abe2-324">Paso 4: Personalizar el control CreateUserWizard para incluir un paso "Especificar Roles"</span><span class="sxs-lookup"><span data-stu-id="1abe2-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="1abe2-325">En el <a id="_msoanchor_3"> </a> [ *crear cuentas de usuario* ](../membership/creating-user-accounts-vb.md) tutorial hemos visto cómo usar el control CreateUserWizard Web para proporcionar una interfaz para crear una nueva cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="1abe2-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-vb.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="1abe2-326">El control CreateUserWizard puede usarse en uno de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="1abe2-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="1abe2-327">Como un medio para que los visitantes crear su propia cuenta de usuario en el sitio, y</span><span class="sxs-lookup"><span data-stu-id="1abe2-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="1abe2-328">Como un medio para que los administradores crear nuevas cuentas</span><span class="sxs-lookup"><span data-stu-id="1abe2-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="1abe2-329">En el primer caso de uso, un visitante entra en el sitio y rellena el control CreateUserWizard, especificación de su información con el fin de registrarse en el sitio.</span><span class="sxs-lookup"><span data-stu-id="1abe2-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="1abe2-330">En el segundo caso, un administrador crea una nueva cuenta de otra persona.</span><span class="sxs-lookup"><span data-stu-id="1abe2-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="1abe2-331">Cuando se crea una cuenta de un administrador para cualquier otra persona, puede resultar útil permitir que el administrador especificar los roles que pertenece la nueva cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="1abe2-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="1abe2-332">En el <a id="_msoanchor_4"> </a> [ *almacenar* *información de usuario adicional* ](../membership/storing-additional-user-information-vb.md) tutorial hemos visto cómo personalizar el control CreateUserWizard agregando adicionales `WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="1abe2-333">Echemos un vistazo a cómo agregar un paso adicional para el control CreateUserWizard con el fin de especificar los nuevos roles del usuario.</span><span class="sxs-lookup"><span data-stu-id="1abe2-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="1abe2-334">Abra el `CreateUserWizardWithRoles.aspx` página y agregue un control CreateUserWizard denominado `RegisterUserWithRoles`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="1abe2-335">Establecer el control `ContinueDestinationPageUrl` propiedad en "~ / Default.aspx".</span><span class="sxs-lookup"><span data-stu-id="1abe2-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="1abe2-336">Dado que la idea aquí es que un administrador va a utilizar este control CreateUserWizard para crear nuevas cuentas de usuario, establezca el control `LoginCreatedUser` propiedad en False.</span><span class="sxs-lookup"><span data-stu-id="1abe2-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="1abe2-337">Esto `LoginCreatedUser` propiedad especifica si el visitante inicia automáticamente la sesión como el usuario que acaba de crear, y el valor predeterminado es True.</span><span class="sxs-lookup"><span data-stu-id="1abe2-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="1abe2-338">Se establece en False porque cuando un administrador crea una nueva cuenta van a conservar en contacto con él iniciado sesión con su propia cuenta.</span><span class="sxs-lookup"><span data-stu-id="1abe2-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="1abe2-339">A continuación, seleccione el "Agregar o quitar `WizardSteps`..." opción de etiqueta inteligente del control CreateUserWizard y agregue un nuevo `WizardStep`, estableciendo su `ID` a `SpecifyRolesStep`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-339">Next, select the "Add/Remove `WizardSteps`…" option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="1abe2-340">Mover el `SpecifyRolesStep WizardStep` para que se trata de después del paso de "Inicio de sesión de nuevo tu cuenta", pero antes del paso "Completado".</span><span class="sxs-lookup"><span data-stu-id="1abe2-340">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="1abe2-341">Establecer el `WizardStep`del `Title` propiedad a "Especificar Roles", su `StepType` propiedad `Step`y su `AllowReturn` propiedad en False.</span><span class="sxs-lookup"><span data-stu-id="1abe2-341">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>


<span data-ttu-id="1abe2-342">[![Agregar el](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-342">[![Add the](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span></span>

<span data-ttu-id="1abe2-343">**Figura 11**: Agregar "Especificar Roles" `WizardStep` a CreateUserWizard ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-343">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image33.png))</span></span>


<span data-ttu-id="1abe2-344">Después de este cambio marcado declarativo de su control CreateUserWizard debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="1abe2-344">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample21.aspx)]

<span data-ttu-id="1abe2-345">"Especificar roles" `WizardStep`, agregue un control CheckBoxList denominado `RoleList.` CheckBoxList este enumerará los roles disponibles, la habilitación de la persona que visite la página comprobar qué roles recién creado que pertenece el usuario.</span><span class="sxs-lookup"><span data-stu-id="1abe2-345">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList.` This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="1abe2-346">Seguimos teniendo las tareas de codificación de dos: primero se debe rellenar el `RoleList` CheckBoxList con los roles en el sistema; en segundo lugar, tenemos que agregar el usuario creado para los roles seleccionados, cuando el usuario se mueve desde el paso "Especificar Roles" con el paso "Complete".</span><span class="sxs-lookup"><span data-stu-id="1abe2-346">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="1abe2-347">Podemos llevar a cabo la primera tarea en el `Page_Load` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="1abe2-347">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="1abe2-348">El siguiente código mediante programación las referencias del `RoleList` casilla de verificación en la primera visita a la página y enlaza los roles en el sistema en él.</span><span class="sxs-lookup"><span data-stu-id="1abe2-348">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample22.vb)]

<span data-ttu-id="1abe2-349">El código anterior le resultará familiar.</span><span class="sxs-lookup"><span data-stu-id="1abe2-349">The above code should look familiar.</span></span> <span data-ttu-id="1abe2-350">En el <a id="_msoanchor_5"> </a> [ *almacenar* *información de usuario adicional* ](../membership/storing-additional-user-information-vb.md) tutorial hemos usado dos `FindControl` instrucciones para hacer referencia a un control Web desde dentro de un personalizado `WizardStep`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-350">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="1abe2-351">Y el código que enlaza los roles a CheckBoxList se haya obtenido anteriormente en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="1abe2-351">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="1abe2-352">Para llevar a cabo la segunda tarea de programación, necesitamos saber cuándo se ha completado el paso "Especificar Roles".</span><span class="sxs-lookup"><span data-stu-id="1abe2-352">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="1abe2-353">Recuerde que el control CreateUserWizard tiene un `ActiveStepChanged` evento, que se desencadena cada vez que el visitante navega desde un paso a otro.</span><span class="sxs-lookup"><span data-stu-id="1abe2-353">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="1abe2-354">Aquí podemos determinar si el usuario ha alcanzado el paso "Completar"; Si es así, necesitamos agregar el usuario a los roles seleccionados.</span><span class="sxs-lookup"><span data-stu-id="1abe2-354">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="1abe2-355">Crear un controlador de eventos para el `ActiveStepChanged` eventos y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="1abe2-355">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample23.vb)]

<span data-ttu-id="1abe2-356">Si el usuario simplemente ha alcanzado el paso "Completado", el controlador de eventos enumera los elementos de la `RoleList` CheckBoxList y el usuario acaba de crear se asigna a los roles seleccionados.</span><span class="sxs-lookup"><span data-stu-id="1abe2-356">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="1abe2-357">Visite esta página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="1abe2-357">Visit this page through a browser.</span></span> <span data-ttu-id="1abe2-358">El primer paso en el control CreateUserWizard es el paso de "Inicio de sesión de nuevo tu cuenta" estándar, que solicita el nuevo nombre de usuario, contraseña, correo electrónico y otra información clave.</span><span class="sxs-lookup"><span data-stu-id="1abe2-358">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="1abe2-359">Escriba la información para crear un nuevo usuario denominado a Wanda.</span><span class="sxs-lookup"><span data-stu-id="1abe2-359">Enter the information to create a new user named Wanda.</span></span>


<span data-ttu-id="1abe2-360">[![Crear un nuevo usuario denominado Wanda](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-360">[![Create a New User Named Wanda](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span></span>

<span data-ttu-id="1abe2-361">**Figura 12**: Crear un nuevo Wanda con nombre de usuario ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-361">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image36.png))</span></span>


<span data-ttu-id="1abe2-362">Haga clic en el botón "Crear usuario".</span><span class="sxs-lookup"><span data-stu-id="1abe2-362">Click the "Create User" button.</span></span> <span data-ttu-id="1abe2-363">El control CreateUserWizard llama internamente a la `Membership.CreateUser` (método), crear la nueva cuenta de usuario y, a continuación, continúa con el paso siguiente, "especifica Roles".</span><span class="sxs-lookup"><span data-stu-id="1abe2-363">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="1abe2-364">Aquí se enumeran los roles de sistema.</span><span class="sxs-lookup"><span data-stu-id="1abe2-364">Here the system roles are listed.</span></span> <span data-ttu-id="1abe2-365">Active la casilla de verificación de los supervisores y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="1abe2-365">Check the Supervisors checkbox and click Next.</span></span>


<span data-ttu-id="1abe2-366">[![Convertir en miembro de la función de los supervisores Wanda](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-366">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span></span>

<span data-ttu-id="1abe2-367">**Figura 13**: Convertir en miembro de la función de los supervisores Wanda ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-367">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image39.png))</span></span>


<span data-ttu-id="1abe2-368">Haga clic en siguiente hace que una devolución de datos y las actualizaciones de la `ActiveStep` con el paso "Complete".</span><span class="sxs-lookup"><span data-stu-id="1abe2-368">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="1abe2-369">En el `ActiveStepChanged` controlador de eventos, la cuenta de usuario recientemente creado se asigna a la función de los supervisores.</span><span class="sxs-lookup"><span data-stu-id="1abe2-369">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="1abe2-370">Para comprobarlo, volver a la `UsersAndRoles.aspx` página y seleccione los supervisores de la `RoleList` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="1abe2-370">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="1abe2-371">Como se muestra en la figura 14, los supervisores son ahora consta de tres usuarios: Bruce, Tito y Wanda.</span><span class="sxs-lookup"><span data-stu-id="1abe2-371">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>


<span data-ttu-id="1abe2-372">[![Bruce, Tito y Wanda son supervisores de todo](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="1abe2-372">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span></span>

<span data-ttu-id="1abe2-373">**Figura 14**: Bruce, Tito y Wanda son todos los supervisores ([haga clic aquí para ver imagen en tamaño completo](assigning-roles-to-users-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="1abe2-373">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image42.png))</span></span>


## <a name="summary"></a><span data-ttu-id="1abe2-374">Resumen</span><span class="sxs-lookup"><span data-stu-id="1abe2-374">Summary</span></span>

<span data-ttu-id="1abe2-375">El marco de Roles ofrece métodos para recuperar información sobre los roles y los métodos para determinar qué usuarios pertenecen a una función especificada de un usuario determinado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-375">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="1abe2-376">Además, existen varios métodos para agregar y quitar uno o varios usuarios a uno o varios roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-376">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="1abe2-377">En este tutorial se centra en sólo dos de estos métodos: `AddUserToRole` y `RemoveUserFromRole`.</span><span class="sxs-lookup"><span data-stu-id="1abe2-377">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="1abe2-378">Hay variantes adicionales diseñadas para agregar varios usuarios a una sola función y asignar varios roles a un único usuario.</span><span class="sxs-lookup"><span data-stu-id="1abe2-378">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="1abe2-379">En este tutorial también incluye un vistazo al extender el control CreateUserWizard para incluir un `WizardStep` para especificar los roles del usuario recién creado.</span><span class="sxs-lookup"><span data-stu-id="1abe2-379">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="1abe2-380">Un paso de este tipo podría ayudar a un administrador a agilizar el proceso de creación de cuentas de usuario para los nuevos usuarios.</span><span class="sxs-lookup"><span data-stu-id="1abe2-380">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="1abe2-381">En este punto hemos visto cómo crear y eliminar roles y cómo agregar y quitar usuarios de roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-381">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="1abe2-382">Pero aún tenemos que mirar al aplicar la autorización basada en roles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-382">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="1abe2-383">En el <a id="_msoanchor_6"> </a> [siguiente tutorial](role-based-authorization-vb.md) veremos definir reglas de autorización de dirección URL según el rol por rol, así como la forma limitar la funcionalidad de nivel de página basado en roles del usuario con sesión iniciada actualmente.</span><span class="sxs-lookup"><span data-stu-id="1abe2-383">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-vb.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="1abe2-384">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="1abe2-384">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="1abe2-385">Información adicional</span><span class="sxs-lookup"><span data-stu-id="1abe2-385">Further Reading</span></span>

<span data-ttu-id="1abe2-386">Para obtener más información sobre los temas tratados en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="1abe2-386">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="1abe2-387">Información general de ASP.NET Web Site Administration Tool</span><span class="sxs-lookup"><span data-stu-id="1abe2-387">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="1abe2-388">Examen de ASP. Perfil, Roles y pertenencia a la red</span><span class="sxs-lookup"><span data-stu-id="1abe2-388">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="1abe2-389">Implementar su propia herramienta de administración del sitio Web</span><span class="sxs-lookup"><span data-stu-id="1abe2-389">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="1abe2-390">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="1abe2-390">About the Author</span></span>

<span data-ttu-id="1abe2-391">Scott Mitchell, autor de varios libros sobre ASP/ASP.NET y fundador de 4GuysFromRolla.com, ha estado trabajando con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="1abe2-391">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1abe2-392">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="1abe2-392">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1abe2-393">Su último libro es *[SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="1abe2-393">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="1abe2-394">Puede ponerse en contacto Scott [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) o a través de su blog en [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="1abe2-394">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="1abe2-395">Agradecimientos especiales a...</span><span class="sxs-lookup"><span data-stu-id="1abe2-395">Special Thanks To…</span></span>

<span data-ttu-id="1abe2-396">Esta serie de tutoriales ha sido revisada por muchos revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="1abe2-396">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1abe2-397">Revisor de clientes potencial para este tutorial era Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="1abe2-397">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="1abe2-398">¿Está interesado en leer mi próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="1abe2-398">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1abe2-399">Si es así, envíeme una línea en [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1abe2-399">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1abe2-400">[Anterior](creating-and-managing-roles-vb.md)
> [Siguiente](role-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1abe2-400">[Previous](creating-and-managing-roles-vb.md)
[Next](role-based-authorization-vb.md)</span></span>

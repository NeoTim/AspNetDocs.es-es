---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
title: Crear clases de modelo con Entity Framework (C#) | Microsoft Docs
author: microsoft
description: En este tutorial, aprenderá a usar ASP.NET MVC con Entity Framework de Microsoft. Aprenda a usar al Asistente para Entity para crear un acelerador de desarrollo de ADO.NET Entity...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 61644169-e8b1-45dd-bf96-9c2301b69879
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
msc.type: authoredcontent
ms.openlocfilehash: 29f7dded2f6fc2e8ce588dab2949b59ddb6f1fc4
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/17/2019
ms.locfileid: "59388912"
---
# <a name="creating-model-classes-with-the-entity-framework-c"></a><span data-ttu-id="cfcd2-104">Crear clases de modelo con Entity Framework (C#)</span><span class="sxs-lookup"><span data-stu-id="cfcd2-104">Creating Model Classes with the Entity Framework (C#)</span></span>

<span data-ttu-id="cfcd2-105">por [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="cfcd2-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="cfcd2-106">En este tutorial, aprenderá a usar ASP.NET MVC con Entity Framework de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="cfcd2-107">Aprenda a usar al Asistente para Entity para crear un Entity Data Model de ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="cfcd2-108">En el transcurso de este tutorial, creamos una aplicación web que se muestra cómo seleccionar, insertar, actualizar y eliminar datos de la base de datos mediante Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>


<span data-ttu-id="cfcd2-109">El objetivo de este tutorial es explicar cómo puede crear clases de acceso a datos mediante Microsoft Entity Framework al compilar una aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="cfcd2-110">Este tutorial asume ningún conocimiento anterior de Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="cfcd2-111">Al final de este tutorial, comprenderá cómo usar Entity Framework para seleccionar, insertar, actualizar y eliminar registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="cfcd2-112">Microsoft Entity Framework es una herramienta de asignación relacional de objetos (O/RM) que le permite generar automáticamente una capa de acceso a datos desde una base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="cfcd2-113">Entity Framework permite evitar el trabajo de una tarea tediosa de crear las clases de acceso de datos a mano.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

<span data-ttu-id="cfcd2-114">Para ilustrar cómo puede usar Microsoft Entity Framework con ASP.NET MVC, vamos a crear una aplicación de ejemplo simple.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-114">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="cfcd2-115">Vamos a crear una aplicación de base de datos de película que permite mostrar y editar registros de base de datos de películas.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-115">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="cfcd2-116">En este tutorial se supone que tiene Visual Studio 2008 o Visual Web Developer 2008 con Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-116">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="cfcd2-117">Necesita el Service Pack 1 para poder usar Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-117">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="cfcd2-118">Puede descargar Visual Studio 2008 Service Pack 1 o Visual Web Developer con Service Pack 1 desde la siguiente dirección:</span><span class="sxs-lookup"><span data-stu-id="cfcd2-118">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [https://www.asp.net/downloads/](https://www.asp.net/downloads)


> [!NOTE] 
> 
> <span data-ttu-id="cfcd2-119">No hay ninguna conexión fundamental entre MVC de ASP.NET y Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-119">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="cfcd2-120">Existen varias alternativas a Entity Framework que puede usar con ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-120">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="cfcd2-121">Por ejemplo, puede crear las clases de modelo de MVC con otras herramientas O/RM como Microsoft LINQ to SQL, NHibernate o SubSonic.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-121">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>


## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="cfcd2-122">Creación de la base de datos de ejemplo de película</span><span class="sxs-lookup"><span data-stu-id="cfcd2-122">Creating the Movie Sample Database</span></span>

<span data-ttu-id="cfcd2-123">La aplicación de base de datos de películas usa una tabla de base de datos denominada películas que contiene las columnas siguientes:</span><span class="sxs-lookup"><span data-stu-id="cfcd2-123">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="cfcd2-124">Nombre de columna</span><span class="sxs-lookup"><span data-stu-id="cfcd2-124">Column Name</span></span> | <span data-ttu-id="cfcd2-125">Tipo de datos</span><span class="sxs-lookup"><span data-stu-id="cfcd2-125">Data Type</span></span> | <span data-ttu-id="cfcd2-126">¿Permitir valores null?</span><span class="sxs-lookup"><span data-stu-id="cfcd2-126">Allow Nulls?</span></span> | <span data-ttu-id="cfcd2-127">¿Es la clave principal?</span><span class="sxs-lookup"><span data-stu-id="cfcd2-127">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="cfcd2-128">Id.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-128">Id</span></span> | <span data-ttu-id="cfcd2-129">int</span><span class="sxs-lookup"><span data-stu-id="cfcd2-129">int</span></span> | <span data-ttu-id="cfcd2-130">False</span><span class="sxs-lookup"><span data-stu-id="cfcd2-130">False</span></span> | <span data-ttu-id="cfcd2-131">True</span><span class="sxs-lookup"><span data-stu-id="cfcd2-131">True</span></span> |
| <span data-ttu-id="cfcd2-132">Título</span><span class="sxs-lookup"><span data-stu-id="cfcd2-132">Title</span></span> | <span data-ttu-id="cfcd2-133">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="cfcd2-133">nvarchar(100)</span></span> | <span data-ttu-id="cfcd2-134">False</span><span class="sxs-lookup"><span data-stu-id="cfcd2-134">False</span></span> | <span data-ttu-id="cfcd2-135">False</span><span class="sxs-lookup"><span data-stu-id="cfcd2-135">False</span></span> |
| <span data-ttu-id="cfcd2-136">Director</span><span class="sxs-lookup"><span data-stu-id="cfcd2-136">Director</span></span> | <span data-ttu-id="cfcd2-137">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="cfcd2-137">nvarchar(100)</span></span> | <span data-ttu-id="cfcd2-138">False</span><span class="sxs-lookup"><span data-stu-id="cfcd2-138">False</span></span> | <span data-ttu-id="cfcd2-139">False</span><span class="sxs-lookup"><span data-stu-id="cfcd2-139">False</span></span> |

<span data-ttu-id="cfcd2-140">Puede agregar esta tabla a un proyecto de ASP.NET MVC, siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="cfcd2-140">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="cfcd2-141">Haga clic en la aplicación\_carpeta de datos en la ventana Explorador de soluciones y seleccione la opción de menú **agregar, elemento nuevo.**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-141">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="cfcd2-142">Desde el **Agregar nuevo elemento** cuadro de diálogo, seleccione **base de datos de SQL Server**, asigne el nombre MoviesDB.mdf a la base de datos y haga clic en el **agregar** botón.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-142">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="cfcd2-143">Haga doble clic en el archivo MoviesDB.mdf para abrir la ventana Server Explorer/Database Explorer.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-143">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="cfcd2-144">Expanda la conexión de base de datos MoviesDB.mdf, haga clic en la carpeta de tablas y seleccione la opción de menú **agregar nueva tabla**.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-144">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="cfcd2-145">En el Diseñador de tablas, agregue las columnas Id, Title y Director.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-145">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="cfcd2-146">Haga clic en el **guardar** botón (tiene el icono del disquete) para guardar la nueva tabla con el nombre de películas.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-146">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="cfcd2-147">Después de crear la tabla de base de datos de películas, debe agregar algunos datos de ejemplo a la tabla.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-147">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="cfcd2-148">Haga clic en la tabla de películas y seleccione la opción de menú **mostrar datos de tabla**.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-148">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="cfcd2-149">Puede escribir datos falsa de película en la cuadrícula que aparece.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-149">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="cfcd2-150">Creación de ADO.NET Entity Data Model</span><span class="sxs-lookup"><span data-stu-id="cfcd2-150">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="cfcd2-151">Para poder usar Entity Framework, deberá crear un Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-151">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="cfcd2-152">Puede sacar partido de Visual Studio *Asistente para Entity Data Model* para generar automáticamente un Entity Data Model de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-152">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="cfcd2-153">Siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="cfcd2-153">Follow these steps:</span></span>

1. <span data-ttu-id="cfcd2-154">Haga clic en la carpeta de modelos en la ventana Explorador de soluciones y seleccione la opción de menú **agregar, nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-154">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="cfcd2-155">En el **Agregar nuevo elemento** cuadro de diálogo, seleccione la categoría de datos (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-155">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="cfcd2-156">Seleccione el **ADO.NET Entity Data Model** plantilla, asigne el nombre MoviesDBModel.edmx de Entity Data Model y haga clic en el **agregar** botón.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-156">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="cfcd2-157">Al hacer clic en el **agregar** botón inicia el Asistente para modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-157">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="cfcd2-158">En el **Elegir contenido de Model** paso, elija la **generar desde una base de datos** opción y haga clic en el **siguiente** botón (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-158">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="cfcd2-159">En el **elegir la conexión de datos** paso, seleccione la conexión de base de datos MoviesDB.mdf, especificar las entidades de configuración de conexión nombre MoviesDBEntities y haga clic en el **siguiente** (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-159">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="cfcd2-160">En el **elija los objetos de base de datos** paso, seleccione la tabla de base de datos de película y haga clic en el **finalizar** (consulte la figura 4).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-160">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="cfcd2-161">Después de completar estos pasos, se abre el ADO.NET Entity Data Model Designer (Entity Designer).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-161">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="cfcd2-162">**Ilustración 1: crear un nuevo Entity Data Model**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-162">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-cs/_static/image1.jpg)

<span data-ttu-id="cfcd2-164">**Ilustración 2: elija el paso del modelo de contenido**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-164">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-cs/_static/image2.jpg)

<span data-ttu-id="cfcd2-166">**Ilustración 3: elegir la conexión de datos**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-166">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-cs/_static/image3.jpg)

<span data-ttu-id="cfcd2-168">**Figura 4: elija los objetos de base de datos**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-168">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-cs/_static/image4.jpg)

#### <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="cfcd2-170">Modificación de ADO.NET Entity Data Model</span><span class="sxs-lookup"><span data-stu-id="cfcd2-170">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="cfcd2-171">Después de crear un Entity Data Model, puede modificar el modelo aprovechando las ventajas de Entity Designer (consulte la figura 5).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-171">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="cfcd2-172">Puede abrir el Diseñador de entidades en cualquier momento haciendo doble clic en el archivo MoviesDBModel.edmx contenido en la carpeta de modelos dentro de la ventana del explorador de soluciones.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-172">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="cfcd2-173">**Figura 5: ADO.NET Entity Data Model Designer**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-173">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-cs/_static/image5.jpg)

<span data-ttu-id="cfcd2-175">Por ejemplo, puede usar Entity Designer para cambiar los nombres de las clases que genera el Asistente para Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-175">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="cfcd2-176">El Asistente para crea una nueva clase de acceso de datos denominada películas.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-176">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="cfcd2-177">En otras palabras, el Asistente asignado a la clase el muy mismo nombre que la tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-177">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="cfcd2-178">Porque se usará esta clase para representar una instancia determinada de la película, nos debemos cambiar el nombre de la clase de películas a Movie.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-178">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="cfcd2-179">Si desea cambiar el nombre de una clase de entidad, puede hacer doble clic en el nombre de clase en el Diseñador de entidades y escriba un nombre nuevo (consulte la figura 6).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-179">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="cfcd2-180">Como alternativa, puede cambiar el nombre de una entidad en la ventana Propiedades después de seleccionar una entidad en Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-180">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="cfcd2-181">**Figura 6: cambiar el nombre de una entidad**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-181">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-cs/_static/image6.jpg)

<span data-ttu-id="cfcd2-183">No olvide guardar su Entity Data Model después de realizar una modificación, haga clic en el botón Guardar (el icono del disquete).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-183">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="cfcd2-184">En segundo plano, el Diseñador de entidades genera un conjunto de clases de C#.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-184">Behind the scenes, the Entity Designer generates a set of C# classes.</span></span> <span data-ttu-id="cfcd2-185">Puede ver estas clases abriendo el archivo MoviesDBModel.Designer.cs desde la ventana Explorador de soluciones.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-185">You can view these classes by opening the MoviesDBModel.Designer.cs file from the Solution Explorer window.</span></span>


<span data-ttu-id="cfcd2-186">No modifique el código en el archivo Designer.cs puesto que los cambios se sobrescribirán la próxima vez que utilice el Diseñador de entidades.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-186">Don't modify the code in the Designer.cs file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="cfcd2-187">Si desea ampliar la funcionalidad de las clases de entidad definido en el archivo Designer.cs, a continuación, puede crear *clases parciales* en archivos independientes.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-187">If you want to extend the functionality of the entity classes defined in the Designer.cs file then you can create *partial classes* in separate files.</span></span>


#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="cfcd2-188">Selección de registros de base de datos con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="cfcd2-188">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="cfcd2-189">Vamos a empezar a crear nuestra aplicación de base de datos de películas mediante la creación de una página que muestra una lista de registros de películas.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-189">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="cfcd2-190">El controlador Home en el listado 1 expone una acción denominada Index().</span><span class="sxs-lookup"><span data-stu-id="cfcd2-190">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="cfcd2-191">La acción de Index() devuelve todos los registros de la película de la tabla de base de datos de película aprovechando las ventajas de Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-191">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="cfcd2-192">**Listing 1 – Controllers\HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-192">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample1.cs)]

<span data-ttu-id="cfcd2-193">Tenga en cuenta que el controlador en el listado 1 incluye un constructor.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-193">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="cfcd2-194">El constructor inicializa un campo de nivel de clase denominado \_db.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-194">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="cfcd2-195">El \_db campo representa las entidades de base de datos generadas por Entity Framework de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-195">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="cfcd2-196">El \_campo de base de datos es una instancia de la clase MoviesDBEntities generado por el Diseñador de entidades.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-196">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>


<span data-ttu-id="cfcd2-197">Para poder usar la clase theMoviesDBEntities en el controlador Home, debe importar el espacio de nombres MovieEntityApp.Models (*MVCProjectName*. Modelos).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-197">In order to use theMoviesDBEntities class in the Home controller, you must import the MovieEntityApp.Models namespace (*MVCProjectName*.Models).</span></span>


<span data-ttu-id="cfcd2-198">El \_campo de base de datos se utiliza dentro de la acción de Index() para recuperar los registros de la tabla de base de datos de películas.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-198">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="cfcd2-199">La expresión \_db. MovieSet representa todos los registros de la tabla de base de datos de películas.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-199">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="cfcd2-200">El método ToList() se utiliza para convertir el conjunto de películas en una colección genérica de objetos de película (lista&lt;Movie&gt;).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-200">The ToList() method is used to convert the set of movies into a generic collection of Movie objects (List&lt;Movie&gt;).</span></span>

<span data-ttu-id="cfcd2-201">Los registros de la película se recuperan con la Ayuda de LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-201">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="cfcd2-202">La acción de Index() en el listado 1 usa LINQ *sintaxis de método* para recuperar el conjunto de registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-202">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="cfcd2-203">Si lo prefiere, puede usar LINQ *sintaxis de consulta* en su lugar.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-203">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="cfcd2-204">Las dos instrucciones siguientes hacer lo mismo:</span><span class="sxs-lookup"><span data-stu-id="cfcd2-204">The following two statements do the very same thing:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample2.cs)]

<span data-ttu-id="cfcd2-205">Usar cualquier sintaxis LINQ, sintaxis de método o sintaxis de consulta, que encontrará más intuitiva.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-205">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="cfcd2-206">No hay ninguna diferencia de rendimiento entre los dos enfoques: la única diferencia es el estilo.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-206">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="cfcd2-207">La vista en el listado 2 se usa para mostrar los registros de la película.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-207">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="cfcd2-208">**Listing 2 – Views\Home\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-208">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample3.aspx)]

<span data-ttu-id="cfcd2-209">La vista en el listado 2 contiene un **foreach** bucle que recorre en iteración cada registro de la película y muestra los valores de propiedades de título y el Director del registro de la película.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-209">The view in Listing 2 contains a **foreach** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="cfcd2-210">Tenga en cuenta que un vínculo de edición y eliminación se muestra al lado de cada registro.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-210">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="cfcd2-211">Además, un vínculo de agregar la película aparece en la parte inferior de la vista (consulte la figura 7).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-211">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="cfcd2-212">**Figura 7: la vista de índice**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-212">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-cs/_static/image7.jpg)

<span data-ttu-id="cfcd2-214">La vista de índice es un *con el tipo de vista*.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-214">The Index view is a *typed view*.</span></span> <span data-ttu-id="cfcd2-215">La vista de índice incluye una &lt;% @ Page %&gt; la directiva con un *Inherits* atributo que proyecta la propiedad del modelo a una colección fuertemente tipada de lista genérica de objetos de película (lista&lt;película).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-215">The Index view includes a &lt;%@ Page %&gt; directive with an *Inherits* attribute that casts the Model property to a strongly typed generic List collection of Movie objects (List&lt;Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="cfcd2-216">Insertar registros de base de datos con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="cfcd2-216">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="cfcd2-217">Puede usar Entity Framework para que sea fácil insertar nuevos registros en una tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-217">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="cfcd2-218">Listado 3 contiene dos nuevas acciones que se agrega a la clase de controlador principal que puede usar para insertar nuevos registros en la tabla de base de datos de la película.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-218">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="cfcd2-219">**Listado 3 – controllers\homecontroller. cs (agregar métodos)**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-219">**Listing 3 – Controllers\HomeController.cs (Add methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample4.cs)]

<span data-ttu-id="cfcd2-220">La primera acción Add() simplemente devuelve una vista.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-220">The first Add() action simply returns a view.</span></span> <span data-ttu-id="cfcd2-221">La vista contiene un formulario para agregar una nueva base de datos de película grabar (consulte la figura 8).</span><span class="sxs-lookup"><span data-stu-id="cfcd2-221">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="cfcd2-222">Cuando se envía el formulario, se invoca la segunda acción Add().</span><span class="sxs-lookup"><span data-stu-id="cfcd2-222">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="cfcd2-223">Tenga en cuenta que la segunda acción Add() está decorada con el atributo AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-223">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="cfcd2-224">Esta acción puede invocarse únicamente al realizar una operación HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-224">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="cfcd2-225">En otras palabras, solo se puede invocar esta acción al registrar un formulario HTML.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-225">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="cfcd2-226">La segunda acción Add() crea una nueva instancia de la clase Movie de Entity Framework con la Ayuda del método TryUpdateModel() de MVC de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-226">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="cfcd2-227">El método TryUpdateModel() toma los campos en el pasado al método Add() de ColecciónFormulario y asigna los valores de estos campos de formulario HTML a la clase de la película.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-227">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>


<span data-ttu-id="cfcd2-228">Al utilizar Entity Framework, debe proporcionar una "lista de permitidos" de propiedades cuando se usan métodos TryUpdateModel o UpdateModel para actualizar las propiedades de una clase de entidad.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-228">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>


<span data-ttu-id="cfcd2-229">A continuación, la acción Add() realiza alguna validación de formulario simple.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-229">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="cfcd2-230">La acción comprueba que el título y el Director de las propiedades tienen valores.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-230">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="cfcd2-231">Si se produce un error de validación, se agrega un mensaje de error de validación para ModelState.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-231">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="cfcd2-232">Si no hay ningún error de validación se agrega un nuevo registro de la película a la tabla de base de datos de películas con la Ayuda de Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-232">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="cfcd2-233">El nuevo registro se agrega a la base de datos con las siguientes dos líneas de código:</span><span class="sxs-lookup"><span data-stu-id="cfcd2-233">The new record is added to the database with the following two lines of code:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample5.cs)]

<span data-ttu-id="cfcd2-234">La primera línea de código agrega la nueva entidad de la película al conjunto de Entity Framework realiza el seguimiento de películas.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-234">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="cfcd2-235">La segunda línea de código guarda los cambios se realizaron en las películas que se realiza un seguimiento a la base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-235">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="cfcd2-236">**Figura 8: la vista de complemento**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-236">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-cs/_static/image8.jpg)

#### <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="cfcd2-238">Actualizar los registros de la base de datos con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="cfcd2-238">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="cfcd2-239">Puede seguir casi el mismo enfoque para editar un registro de base de datos con Entity Framework como el enfoque que simplemente seguimos para insertar un nuevo registro de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-239">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="cfcd2-240">Listado 4 contiene dos nuevas acciones de controlador denominadas Edit().</span><span class="sxs-lookup"><span data-stu-id="cfcd2-240">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="cfcd2-241">La primera acción Edit() devuelve un formulario HTML para editar un registro de la película.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-241">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="cfcd2-242">La segunda acción Edit() intenta actualizar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-242">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="cfcd2-243">**Listado 4 – controllers\homecontroller. cs (métodos)**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-243">**Listing 4 – Controllers\HomeController.cs (Edit methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample6.cs)]

<span data-ttu-id="cfcd2-244">La segunda acción Edit() empieza recuperando el registro de la película de la base de datos que coincide con el identificador de la película que se está editando.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-244">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="cfcd2-245">LINQ siguiente a la instrucción de entidades toma el primer registro de base de datos que coincide con un identificador determinado:</span><span class="sxs-lookup"><span data-stu-id="cfcd2-245">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample7.cs)]

<span data-ttu-id="cfcd2-246">A continuación, el método TryUpdateModel() se usa para asignar los valores de los campos de formulario HTML en las propiedades de la entidad de la película.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-246">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="cfcd2-247">Tenga en cuenta que se proporciona una lista de permitidos para especificar las propiedades exactas para actualizar.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-247">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="cfcd2-248">A continuación, se realiza una validación sencilla para comprobar que el título de la película y el Director de las propiedades tienen valores.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-248">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="cfcd2-249">Si faltan un valor en cualquiera de las propiedades, a continuación, se agrega un mensaje de error de validación para ModelState y ModelState.IsValid devuelve el valor false.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-249">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="cfcd2-250">Por último, si no hay ningún error de validación, se actualiza la tabla de base de datos subyacente de películas con los cambios llamando al método SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="cfcd2-250">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="cfcd2-251">Al editar los registros de la base de datos, deberá pasar el identificador del registro que se está editando la acción de controlador que realiza la actualización de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-251">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="cfcd2-252">En caso contrario, la acción de controlador no sabrá qué registro se actualizará en la base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-252">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="cfcd2-253">La vista de edición, incluida en el listado 5 incluye un campo de formulario oculto que representa el identificador del registro de base de datos que se está editando.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-253">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="cfcd2-254">**Listing 5 – Views\Home\Edit.aspx**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-254">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="cfcd2-255">Eliminación de registros de base de datos con Entity Framework</span><span class="sxs-lookup"><span data-stu-id="cfcd2-255">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="cfcd2-256">La operación de base de datos final, que es necesario abordar en este tutorial, está eliminando registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-256">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="cfcd2-257">Puede usar la acción del controlador en el listado 6 para eliminar un registro de base de datos determinada.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-257">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="cfcd2-258">**Listado 6--\Controllers\HomeController.cs (acción de eliminación)**</span><span class="sxs-lookup"><span data-stu-id="cfcd2-258">**Listing 6 -- \Controllers\HomeController.cs (Delete action)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample9.cs)]

<span data-ttu-id="cfcd2-259">La acción Delete() primero recupera la entidad que coincide con el identificador pasado a la acción de película.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-259">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="cfcd2-260">A continuación, la película se elimina de la base de datos llamando al método DeleteObject() seguido por el método SaveChanges().</span><span class="sxs-lookup"><span data-stu-id="cfcd2-260">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="cfcd2-261">Por último, se redirige al usuario a la vista de índice.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-261">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="cfcd2-262">Resumen</span><span class="sxs-lookup"><span data-stu-id="cfcd2-262">Summary</span></span>

<span data-ttu-id="cfcd2-263">El propósito de este tutorial era demostrar cómo puede crear aplicaciones web controladas por la base de datos aprovechando las ventajas de ASP.NET MVC y Entity Framework de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-263">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="cfcd2-264">Ha aprendido a crear una aplicación que le permite seleccionar, insertar, actualizar y eliminar registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-264">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="cfcd2-265">En primer lugar, se explica cómo puede usar al Asistente para Entity Data Model para generar un Entity Data Model desde dentro de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-265">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="cfcd2-266">A continuación, obtenga información sobre cómo usar LINQ to Entities para recuperar un conjunto de registros de base de datos de una tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-266">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="cfcd2-267">Por último, Entity Framework se usa para insertar, actualizar y eliminar registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cfcd2-267">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="cfcd2-268">Siguiente</span><span class="sxs-lookup"><span data-stu-id="cfcd2-268">Next</span></span>](creating-model-classes-with-linq-to-sql-cs.md)

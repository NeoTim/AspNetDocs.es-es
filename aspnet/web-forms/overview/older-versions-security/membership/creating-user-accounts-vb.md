---
uid: web-forms/overview/older-versions-security/membership/creating-user-accounts-vb
title: Crear cuentas de usuario (VB) | Microsoft Docs
author: rick-anderson
description: En este tutorial, exploraremos el uso del marco de pertenencia (a través de SqlMembershipProvider) para crear nuevas cuentas de usuario. Veremos cómo crear una nueva...
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 9ef3e893-bebe-4b13-9fe5-8b71720dd85e
msc.legacyurl: /web-forms/overview/older-versions-security/membership/creating-user-accounts-vb
msc.type: authoredcontent
ms.openlocfilehash: 01be198c329f372ddcd529ad8a369f2d3426a9fc
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2019
ms.locfileid: "74628193"
---
# <a name="creating-user-accounts-vb"></a><span data-ttu-id="4abdc-104">Crear cuentas de usuario (VB)</span><span class="sxs-lookup"><span data-stu-id="4abdc-104">Creating User Accounts (VB)</span></span>

<span data-ttu-id="4abdc-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4abdc-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4abdc-106">[Descargar código](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_VB.zip) o [Descargar PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="4abdc-106">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_05_VB.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial05_CreatingUsers_vb.pdf)</span></span>

> <span data-ttu-id="4abdc-107">En este tutorial, exploraremos el uso del marco de pertenencia (a través de SqlMembershipProvider) para crear nuevas cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-107">In this tutorial we will explore using the Membership framework (via the SqlMembershipProvider) to create new user accounts.</span></span> <span data-ttu-id="4abdc-108">Veremos cómo crear nuevos usuarios mediante programación y a través de ASP. Control CreateUserWizard integrado de la red.</span><span class="sxs-lookup"><span data-stu-id="4abdc-108">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

## <a name="introduction"></a><span data-ttu-id="4abdc-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="4abdc-109">Introduction</span></span>

<span data-ttu-id="4abdc-110">En el <a id="_msoanchor_1"> </a> [tutorial anterior](creating-the-membership-schema-in-sql-server-vb.md) se instaló el esquema de servicios de aplicación en una base de datos, que agrega las tablas, vistas y procedimientos almacenados necesarios para el `SqlMembershipProvider` y `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-110">In the <a id="_msoanchor_1"></a>[preceding tutorial](creating-the-membership-schema-in-sql-server-vb.md) we installed the application services schema in a database, which added the tables, views, and stored procedures needed by the `SqlMembershipProvider` and `SqlRoleProvider`.</span></span> <span data-ttu-id="4abdc-111">Esto creó la infraestructura que se necesitará para el resto de los tutoriales de esta serie.</span><span class="sxs-lookup"><span data-stu-id="4abdc-111">This created the infrastructure we will need for the remainder of the tutorials in this series.</span></span> <span data-ttu-id="4abdc-112">En este tutorial, exploraremos el uso del marco de pertenencia (a través de la `SqlMembershipProvider`) para crear nuevas cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-112">In this tutorial we will explore using the Membership framework (via the `SqlMembershipProvider`) to create new user accounts.</span></span> <span data-ttu-id="4abdc-113">Veremos cómo crear nuevos usuarios mediante programación y a través de ASP. Control CreateUserWizard integrado de la red.</span><span class="sxs-lookup"><span data-stu-id="4abdc-113">We will see how to create new users programmatically and through ASP.NET's built-in CreateUserWizard control.</span></span>

<span data-ttu-id="4abdc-114">Además de aprender a crear nuevas cuentas de usuario, también tendrá que actualizar el sitio web de demostración que creamos primero en la *<a id="_msoanchor_2"></a>[Introducción al tutorial de autenticación de formularios ](../introduction/an-overview-of-forms-authentication-vb.md)* y, a continuación, mejorado en el tutorial configuración de la *<a id="_msoanchor_3"></a>[autenticación de formularios y temas avanzados](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* .</span><span class="sxs-lookup"><span data-stu-id="4abdc-114">In addition to learning how to create new user accounts, we will also need to update the demo website we first created in the *<a id="_msoanchor_2"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-vb.md)* tutorial and then enhanced in the *<a id="_msoanchor_3"></a>[Forms Authentication Configuration and Advanced Topics](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* tutorial.</span></span> <span data-ttu-id="4abdc-115">Nuestra aplicación Web de demostración tiene una página de inicio de sesión que valida las credenciales de los usuarios con los pares de nombre de usuario y contraseña codificados de forma rígida.</span><span class="sxs-lookup"><span data-stu-id="4abdc-115">Our demo web application has a login page that validates users' credentials against hard-coded username/password pairs.</span></span> <span data-ttu-id="4abdc-116">Además, `Global.asax` incluye código que crea objetos personalizados `IPrincipal` y `IIdentity` para los usuarios autenticados.</span><span class="sxs-lookup"><span data-stu-id="4abdc-116">Moreover, `Global.asax` includes code that creates custom `IPrincipal` and `IIdentity` objects for authenticated users.</span></span> <span data-ttu-id="4abdc-117">Actualizaremos la página de inicio de sesión para validar las credenciales de los usuarios en el marco de pertenencia y quitar la lógica de identidad y entidad de seguridad personalizada.</span><span class="sxs-lookup"><span data-stu-id="4abdc-117">We will update the login page to validate users' credentials against the Membership framework and remove the custom principal and identity logic.</span></span>

<span data-ttu-id="4abdc-118">Comencemos.</span><span class="sxs-lookup"><span data-stu-id="4abdc-118">Let's get started!</span></span>

## <a name="the-forms-authentication-and-membership-checklist"></a><span data-ttu-id="4abdc-119">La lista de comprobación de pertenencia y autenticación de formularios</span><span class="sxs-lookup"><span data-stu-id="4abdc-119">The Forms Authentication and Membership Checklist</span></span>

<span data-ttu-id="4abdc-120">Antes de empezar a trabajar con el marco de pertenencia, dedique un momento a revisar los pasos importantes que hemos tomado para llegar a este punto.</span><span class="sxs-lookup"><span data-stu-id="4abdc-120">Before we begin working with the Membership framework, let's take a moment to review the important steps we have taken to reach this point.</span></span> <span data-ttu-id="4abdc-121">Al usar el marco de pertenencia con el `SqlMembershipProvider` en un escenario de autenticación basada en formularios, es necesario realizar los siguientes pasos antes de implementar la funcionalidad de pertenencia en la aplicación web:</span><span class="sxs-lookup"><span data-stu-id="4abdc-121">When using the Membership framework with the `SqlMembershipProvider` in a forms-based authentication scenario, the following steps need to be performed prior to implementing Membership functionality in your web application:</span></span>

1. <span data-ttu-id="4abdc-122">**Habilitar la autenticación basada en formularios.**</span><span class="sxs-lookup"><span data-stu-id="4abdc-122">**Enable forms-based authentication.**</span></span> <span data-ttu-id="4abdc-123">Como se explicó en *<a id="_msoanchor_4"></a>[Información general sobre la autenticación de formularios](../introduction/an-overview-of-forms-authentication-vb.md)* , la autenticación mediante formularios se habilita editando `Web.config` y estableciendo el atributo `mode` del elemento `<authentication>` en `Forms`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-123">As we discussed in *<a id="_msoanchor_4"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-vb.md)*, forms authentication is enabled by editing `Web.config` and setting the `<authentication>` element's `mode` attribute to `Forms`.</span></span> <span data-ttu-id="4abdc-124">Con la autenticación de formularios habilitada, cada solicitud entrante se examina para un *vale de autenticación de formularios*, que, si está presente, identifica al solicitante.</span><span class="sxs-lookup"><span data-stu-id="4abdc-124">With forms authentication enabled, each incoming request is examined for a *forms authentication ticket*, which, if present, identifies the requestor.</span></span>
2. <span data-ttu-id="4abdc-125">**Agregue el esquema de servicios de aplicación a la base de datos adecuada.**</span><span class="sxs-lookup"><span data-stu-id="4abdc-125">**Add the application services schema to the appropriate database.**</span></span> <span data-ttu-id="4abdc-126">Al usar el `SqlMembershipProvider` es necesario instalar el esquema de servicios de aplicación en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="4abdc-126">When using the `SqlMembershipProvider` we need to install the application services schema to a database.</span></span> <span data-ttu-id="4abdc-127">Normalmente, este esquema se agrega a la misma base de datos que contiene el modelo de datos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4abdc-127">Usually this schema is added to the same database that holds the application's data model.</span></span> <span data-ttu-id="4abdc-128">En el *<a id="_msoanchor_5"></a>[tutorial de creación del esquema de pertenencia en SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* se ha examinado el uso de la herramienta `aspnet_regsql.exe` para lograrlo.</span><span class="sxs-lookup"><span data-stu-id="4abdc-128">The *<a id="_msoanchor_5"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* tutorial looked at using the `aspnet_regsql.exe` tool to accomplish this.</span></span>
3. <span data-ttu-id="4abdc-129">**Personalice la configuración de la aplicación web para hacer referencia a la base de datos del paso 2.**</span><span class="sxs-lookup"><span data-stu-id="4abdc-129">**Customize the Web Application's Settings to reference the database from step 2.**</span></span> <span data-ttu-id="4abdc-130">En el tutorial *crear el esquema de pertenencia en SQL Server* se mostraron dos maneras de configurar la aplicación web para que el `SqlMembershipProvider` use la base de datos seleccionada en el paso 2: modificando el nombre de la cadena de conexión de `LocalSqlServer`; o bien agregando un nuevo proveedor registrado a la lista de proveedores de marcos de pertenencia y personalizando ese nuevo proveedor para usar la base de datos del paso 2.</span><span class="sxs-lookup"><span data-stu-id="4abdc-130">The *Creating the Membership Schema in SQL Server* tutorial showed two ways to configure the web application so that the `SqlMembershipProvider` would use the database selected in step 2: by modifying the `LocalSqlServer` connection string name; or by adding a new registered provider to the list of Membership framework providers and customizing that new provider to use the database from step 2.</span></span>

<span data-ttu-id="4abdc-131">Al compilar una aplicación web que usa la `SqlMembershipProvider` y la autenticación basada en formularios, deberá realizar estos tres pasos antes de usar la clase `Membership` o los controles Web de inicio de sesión ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4abdc-131">When building a web application that uses the `SqlMembershipProvider` and forms-based authentication, you will need to perform these three steps before using the `Membership` class or the ASP.NET Login Web controls.</span></span> <span data-ttu-id="4abdc-132">Dado que ya hemos realizado estos pasos en los tutoriales anteriores, estamos preparados para empezar a usar el marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-132">Since we already performed these steps in previous tutorials, we are ready to start using the Membership framework!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="4abdc-133">Paso 1: Agregar nuevas páginas de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4abdc-133">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="4abdc-134">En este tutorial y en los tres próximos, examinaremos diversas funciones y funcionalidades relacionadas con la pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-134">In this tutorial and the next three we will be examining various Membership-related functions and capabilities.</span></span> <span data-ttu-id="4abdc-135">Se necesitará una serie de páginas de ASP.NET para implementar los temas examinados en estos tutoriales.</span><span class="sxs-lookup"><span data-stu-id="4abdc-135">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="4abdc-136">Vamos a crear esas páginas y, a continuación, un archivo de mapa del sitio `(Web.sitemap)`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-136">Let's create those pages and then a site map file `(Web.sitemap)`.</span></span>

<span data-ttu-id="4abdc-137">Empiece por crear una nueva carpeta en el proyecto denominado `Membership`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-137">Start by creating a new folder in the project named `Membership`.</span></span> <span data-ttu-id="4abdc-138">A continuación, agregue cinco páginas nuevas de ASP.NET a la carpeta `Membership`, vinculando cada página con la página maestra de `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-138">Next, add five new ASP.NET pages to the `Membership` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="4abdc-139">Asigne un nombre a las páginas:</span><span class="sxs-lookup"><span data-stu-id="4abdc-139">Name the pages:</span></span>

- `CreatingUserAccounts.aspx`
- `UserBasedAuthorization.aspx`
- `EnhancedCreateUserWizard.aspx`
- `AdditionalUserInfo.aspx`
- `Guestbook.aspx`

<span data-ttu-id="4abdc-140">En este momento el Explorador de soluciones del proyecto debe ser similar a la captura de pantalla que se muestra en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="4abdc-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>

<span data-ttu-id="4abdc-141">[![se han agregado cinco nuevas páginas a la carpeta de pertenencia](creating-user-accounts-vb/_static/image2.png)](creating-user-accounts-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-141">[![Five New Pages Have Been Added to the Membership Folder](creating-user-accounts-vb/_static/image2.png)](creating-user-accounts-vb/_static/image1.png)</span></span>

<span data-ttu-id="4abdc-142">**Figura 1**: Se han agregado cinco nuevas páginas a la carpeta `Membership` ([haga clic para ver la imagen a tamaño completo](creating-user-accounts-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-142">**Figure 1**: Five New Pages Have Been Added to the `Membership` Folder ([Click to view full-size image](creating-user-accounts-vb/_static/image3.png))</span></span>

<span data-ttu-id="4abdc-143">En este punto, cada página debe tener los dos controles de contenido, uno para cada una de las ContentPlaceHolders: `MainContent` y `LoginContent`de la página maestra.</span><span class="sxs-lookup"><span data-stu-id="4abdc-143">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample1.aspx)]

<span data-ttu-id="4abdc-144">Recuerde que el marcado predeterminado de `LoginContent` ContentPlaceHolder muestra un vínculo para iniciar sesión o cerrar sesión en el sitio, en función de si el usuario está autenticado.</span><span class="sxs-lookup"><span data-stu-id="4abdc-144">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="4abdc-145">La presencia del control de contenido de `Content2`, sin embargo, invalida el marcado predeterminado de la página maestra.</span><span class="sxs-lookup"><span data-stu-id="4abdc-145">The presence of the `Content2` Content control, however, overrides the master page's default markup.</span></span> <span data-ttu-id="4abdc-146">Como se explicó en *<a id="_msoanchor_6"></a>[Información general sobre el tutorial de autenticación de formularios](../introduction/an-overview-of-forms-authentication-vb.md)* , esto resulta útil en las páginas en las que no queremos mostrar opciones relacionadas con el inicio de sesión en la columna izquierda.</span><span class="sxs-lookup"><span data-stu-id="4abdc-146">As we discussed in *<a id="_msoanchor_6"></a>[An Overview of Forms Authentication](../introduction/an-overview-of-forms-authentication-vb.md)* tutorial, this is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="4abdc-147">Sin embargo, para estas cinco páginas, queremos mostrar el marcado predeterminado de la página maestra para el `LoginContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="4abdc-147">For these five pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="4abdc-148">Por lo tanto, quite el marcado declarativo para el control de contenido `Content2`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-148">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="4abdc-149">Después de hacerlo, cada una de las marcas de cinco páginas debe contener solo un control de contenido.</span><span class="sxs-lookup"><span data-stu-id="4abdc-149">After doing so, each of the five page's markup should contain just one Content control.</span></span>

## <a name="step-2-creating-the-site-map"></a><span data-ttu-id="4abdc-150">Paso 2: Crear el mapa del sitio</span><span class="sxs-lookup"><span data-stu-id="4abdc-150">Step 2: Creating the Site Map</span></span>

<span data-ttu-id="4abdc-151">Todos los sitios web, salvo los más triviales, deben implementar alguna forma de interfaz de usuario de navegación.</span><span class="sxs-lookup"><span data-stu-id="4abdc-151">All but the most trivial websites need to implement some form of a navigational user interface.</span></span> <span data-ttu-id="4abdc-152">La interfaz de usuario de navegación puede ser una lista sencilla de vínculos a las distintas secciones del sitio.</span><span class="sxs-lookup"><span data-stu-id="4abdc-152">The navigation user interface may be a simple list of links to the various sections of the site.</span></span> <span data-ttu-id="4abdc-153">Como alternativa, estos vínculos se pueden organizar en menús o vistas de árbol.</span><span class="sxs-lookup"><span data-stu-id="4abdc-153">Alternatively, these links may be arranged into menus or tree views.</span></span> <span data-ttu-id="4abdc-154">Como desarrollador de páginas, la creación de la interfaz de usuario de navegación es solo la mitad de la historia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-154">As page developers, creating the navigational user interface is only half of the story.</span></span> <span data-ttu-id="4abdc-155">También necesitamos algunos medios para definir la estructura lógica del sitio de manera fácil de mantener y actualizable.</span><span class="sxs-lookup"><span data-stu-id="4abdc-155">We also need some means to define the site's logical structure in a maintainable and updateable fashion.</span></span> <span data-ttu-id="4abdc-156">A medida que se agregan nuevas páginas o se quitan páginas existentes, queremos poder actualizar un solo origen: el mapa del sitio y hacer que las modificaciones se reflejen en la interfaz de usuario de navegación del sitio.</span><span class="sxs-lookup"><span data-stu-id="4abdc-156">As new pages are added or existing pages removed, we want to be able to update a single source - the site map - and have those modifications reflected across the site's navigational user interface.</span></span>

<span data-ttu-id="4abdc-157">Estas dos tareas: definir el mapa del sitio e implementar una interfaz de usuario de navegación basada en el mapa del sitio, son fáciles de lograr gracias al marco del mapa del sitio y a los controles Web de navegación agregados en la versión 2,0 de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4abdc-157">These two tasks - defining the site map and implementing a navigational user interface based on the site map - are easy to accomplish thanks to the Site Map framework and the Navigation Web controls added in ASP.NET version 2.0.</span></span> <span data-ttu-id="4abdc-158">El marco de trabajo del mapa del sitio permite a un desarrollador definir un mapa del sitio y, a continuación, acceder a él a través de una API de programación (la [clase`SiteMap`](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span><span class="sxs-lookup"><span data-stu-id="4abdc-158">The Site Map framework allows for a developer to define a site map and then to access it through a programmatic API (the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx)).</span></span> <span data-ttu-id="4abdc-159">Los controles Web de navegación integrados incluyen un [control de menú](https://msdn.microsoft.com/library/bz09dy46.aspx), el [control TreeView](https://msdn.microsoft.com/library/3eafky27.aspx)y el [control SiteMapPath](https://msdn.microsoft.com/library/3eafky27.aspx).</span><span class="sxs-lookup"><span data-stu-id="4abdc-159">The built-in Navigation Web controls include a [Menu control](https://msdn.microsoft.com/library/bz09dy46.aspx), the [TreeView control](https://msdn.microsoft.com/library/3eafky27.aspx), and the [SiteMapPath control](https://msdn.microsoft.com/library/3eafky27.aspx).</span></span>

<span data-ttu-id="4abdc-160">Al igual que los marcos de pertenencia y roles, el marco del mapa del sitio se crea sobre el [modelo de proveedor](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="4abdc-160">Like the Membership and Roles frameworks, the Site Map framework is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx).</span></span> <span data-ttu-id="4abdc-161">El trabajo de la clase del proveedor del mapa del sitio es generar la estructura en memoria utilizada por la clase `SiteMap` desde un almacén de datos persistente, como un archivo XML o una tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="4abdc-161">The job of the Site Map provider class is to generate the in-memory structure used by the `SiteMap` class from a persistent data store, such as an XML file or a database table.</span></span> <span data-ttu-id="4abdc-162">El .NET Framework se suministra con un proveedor del mapa del sitio predeterminado que lee los datos del mapa del sitio desde un archivo XML ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)) y este es el proveedor que se va a usar en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="4abdc-162">The .NET Framework ships with a default Site Map provider that reads the site map data from an XML file ([`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)), and this is the provider we will be using in this tutorial.</span></span> <span data-ttu-id="4abdc-163">Para algunas implementaciones alternativas del proveedor del mapa del sitio, consulte la sección lecturas adicionales al final de este tutorial.</span><span class="sxs-lookup"><span data-stu-id="4abdc-163">For some alternate Site Map provider implementations, refer to the Further Readings section at the end of this tutorial.</span></span>

<span data-ttu-id="4abdc-164">El proveedor del mapa del sitio predeterminado espera que un archivo XML con el formato correcto denominado `Web.sitemap` exista en el directorio raíz.</span><span class="sxs-lookup"><span data-stu-id="4abdc-164">The default Site Map provider expects a properly-formatted XML file named `Web.sitemap` to exist the root directory.</span></span> <span data-ttu-id="4abdc-165">Como usamos este proveedor predeterminado, es necesario agregar este tipo de archivo y definir la estructura del mapa del sitio en el formato XML adecuado.</span><span class="sxs-lookup"><span data-stu-id="4abdc-165">Since we are using this default provider, we need to add such a file and define the site map's structure in the appropriate XML format.</span></span> <span data-ttu-id="4abdc-166">Para agregar el archivo, haga clic con el botón derecho en el nombre del proyecto en Explorador de soluciones y elija Agregar nuevo elemento.</span><span class="sxs-lookup"><span data-stu-id="4abdc-166">To add the file, right-click on the project name in Solution Explorer and choose Add New Item.</span></span> <span data-ttu-id="4abdc-167">En el cuadro de diálogo, opte por agregar un archivo de tipo mapa del sitio denominado `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-167">From the dialog box, opt to add a file of type Site Map named `Web.sitemap`.</span></span>

<span data-ttu-id="4abdc-168">[![agregar un archivo denominado Web. sitemap al directorio raíz del proyecto](creating-user-accounts-vb/_static/image5.png)](creating-user-accounts-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-168">[![Add a File Named Web.sitemap to the Project's Root Directory](creating-user-accounts-vb/_static/image5.png)](creating-user-accounts-vb/_static/image4.png)</span></span>

<span data-ttu-id="4abdc-169">**Figura 2**: Agregue un archivo denominado `Web.sitemap` al directorio raíz del proyecto ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-169">**Figure 2**: Add a File Named `Web.sitemap` to the Project's Root Directory ([Click to view full-size image](creating-user-accounts-vb/_static/image6.png))</span></span>

<span data-ttu-id="4abdc-170">El archivo de mapa del sitio XML define la estructura del sitio web como una jerarquía.</span><span class="sxs-lookup"><span data-stu-id="4abdc-170">The XML site map file defines the website's structure as a hierarchy.</span></span> <span data-ttu-id="4abdc-171">Esta relación jerárquica se modela en el archivo XML a través de la ascendencia de los elementos `<siteMapNode>`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-171">This hierarchical relationship is modeled in the XML file via the ancestry of the `<siteMapNode>` elements.</span></span> <span data-ttu-id="4abdc-172">El `Web.sitemap` debe comenzar con un `<siteMap>` nodo primario que tenga exactamente un `<siteMapNode>` secundario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-172">The `Web.sitemap` must start with a `<siteMap>` parent node that has precisely one `<siteMapNode>` child.</span></span> <span data-ttu-id="4abdc-173">Este elemento `<siteMapNode>` de nivel superior representa la raíz de la jerarquía y puede tener un número arbitrario de nodos descendientes.</span><span class="sxs-lookup"><span data-stu-id="4abdc-173">This top-level `<siteMapNode>` element represents the root of the hierarchy, and may have an arbitrary number of descendent nodes.</span></span> <span data-ttu-id="4abdc-174">Cada `<siteMapNode>` elemento debe incluir un atributo `title` y, opcionalmente, incluir `url` y `description` atributos, entre otros; cada atributo de `url` que no esté vacío debe ser único.</span><span class="sxs-lookup"><span data-stu-id="4abdc-174">Each `<siteMapNode>` element must include a `title` attribute and may optionally include `url` and `description` attributes, among others; each non-empty `url` attribute must be unique.</span></span>

<span data-ttu-id="4abdc-175">Escriba el siguiente código XML en el archivo de `Web.sitemap`:</span><span class="sxs-lookup"><span data-stu-id="4abdc-175">Enter the following XML into the `Web.sitemap` file:</span></span>

[!code-xml[Main](creating-user-accounts-vb/samples/sample2.xml)]

<span data-ttu-id="4abdc-176">El marcado del mapa del sitio anterior define la jerarquía que se muestra en la figura 3.</span><span class="sxs-lookup"><span data-stu-id="4abdc-176">The above site map markup defines the hierarchy shown in Figure 3.</span></span>

<span data-ttu-id="4abdc-177">[![el mapa del sitio representa una estructura jerárquica de navegación](creating-user-accounts-vb/_static/image8.png)](creating-user-accounts-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-177">[![The Site Map Represents a Hierarchical Navigational Structure](creating-user-accounts-vb/_static/image8.png)](creating-user-accounts-vb/_static/image7.png)</span></span>

<span data-ttu-id="4abdc-178">**Figura 3**: El mapa del sitio representa una estructura jerárquica de navegación ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-178">**Figure 3**: The Site Map Represents a Hierarchical Navigational Structure ([Click to view full-size image](creating-user-accounts-vb/_static/image9.png))</span></span>

## <a name="step-3-updating-the-master-page-to-include-a-navigational-user-interface"></a><span data-ttu-id="4abdc-179">Paso 3: Actualización de la página maestra para incluir una interfaz de usuario de navegación</span><span class="sxs-lookup"><span data-stu-id="4abdc-179">Step 3: Updating the Master Page to Include a Navigational User Interface</span></span>

<span data-ttu-id="4abdc-180">ASP.NET incluye una serie de controles Web relacionados con la navegación para diseñar una interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-180">ASP.NET includes a number of navigation-related Web controls for designing a user interface.</span></span> <span data-ttu-id="4abdc-181">Entre ellos se incluyen el menú, la vista de árbol y los controles SiteMapPath.</span><span class="sxs-lookup"><span data-stu-id="4abdc-181">These include the Menu, TreeView, and the SiteMapPath controls.</span></span> <span data-ttu-id="4abdc-182">Los controles de menú y TreeView representan la estructura del mapa del sitio en un menú o árbol, respectivamente, mientras que el control SiteMapPath muestra una ruta de navegación que muestra el nodo actual que se está visitando y sus antecesores.</span><span class="sxs-lookup"><span data-stu-id="4abdc-182">The Menu and TreeView controls render the site map structure in a menu or a tree, respectively, whereas the SiteMapPath displays a breadcrumb that shows the current node being visited as well as its ancestors.</span></span> <span data-ttu-id="4abdc-183">Los datos del mapa del sitio se pueden enlazar a otros controles Web de datos mediante SiteMapDataSource y se puede tener acceso a ellos mediante programación a través de la clase `SiteMap`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-183">The site map data can be bound to other data Web controls using the SiteMapDataSource and can be accessed programmatically via the `SiteMap` class.</span></span>

<span data-ttu-id="4abdc-184">Dado que una explicación detallada del marco del mapa del sitio y de los controles de navegación está fuera del ámbito de esta serie de tutoriales, en lugar de dedicar tiempo a crear nuestra propia interfaz de usuario de navegación, en su lugar, se utiliza un control Repeater para mostrar una lista con varias viñetas de vínculos de navegación, como se muestra en *[2,0](../../data-access/index.md)* la figura 4.</span><span class="sxs-lookup"><span data-stu-id="4abdc-184">Since a thorough discussion of the Site Map framework and the Navigation controls is beyond the scope of this tutorial series, rather than spend time crafting our own navigational user interface let's instead borrow the one used in my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series, which uses a Repeater control to display a two-deep bulleted list of navigation links, as shown in Figure 4.</span></span>

### <a name="adding-a-two-level-list-of-links-in-the-left-column"></a><span data-ttu-id="4abdc-185">Agregar una lista de dos niveles de vínculos en la columna izquierda</span><span class="sxs-lookup"><span data-stu-id="4abdc-185">Adding a Two-Level List of Links in the Left Column</span></span>

<span data-ttu-id="4abdc-186">Para crear esta interfaz, agregue el siguiente marcado declarativo a la columna izquierda de la página maestra de `Site.master` donde el texto TODO: El menú irá aquí... reside actualmente.</span><span class="sxs-lookup"><span data-stu-id="4abdc-186">To create this interface, add the following declarative markup to the `Site.master` master page's left column where the text TODO: Menu will go here... currently resides.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample3.aspx)]

<span data-ttu-id="4abdc-187">El marcado anterior enlaza un control Repeater denominado `menu` a un SiteMapDataSource, que devuelve la jerarquía del mapa del sitio definida en `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-187">The above markup binds a Repeater control named `menu` to a SiteMapDataSource, which returns the site map hierarchy defined in `Web.sitemap`.</span></span> <span data-ttu-id="4abdc-188">Dado que la [propiedad`ShowStartingNode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) del control SiteMapDataSource está establecida en false, comienza a devolver la jerarquía del mapa del sitio a partir de los descendientes del nodo principal.</span><span class="sxs-lookup"><span data-stu-id="4abdc-188">Since the SiteMapDataSource control's [`ShowStartingNode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) is set to False it starts returning the site map's hierarchy starting with the descendents of the Home node.</span></span> <span data-ttu-id="4abdc-189">El repetidor muestra cada uno de estos nodos (actualmente solo pertenencia) en un elemento `<li>`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-189">The Repeater displays each of these nodes (currently just Membership ) in an `<li>` element.</span></span> <span data-ttu-id="4abdc-190">Otro, el repetidor interno, después muestra los elementos secundarios del nodo actual en una lista sin ordenar anidada.</span><span class="sxs-lookup"><span data-stu-id="4abdc-190">Another, inner Repeater then displays the current node's children in a nested unordered list.</span></span>

<span data-ttu-id="4abdc-191">En la figura 4 se muestra la salida representada de la marca anterior con la estructura del mapa del sitio que creamos en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="4abdc-191">Figure 4 shows the above markup's rendered output with the site map structure we created in Step 2.</span></span> <span data-ttu-id="4abdc-192">El repetidor representa el marcado de la lista sin ordenar de vainilla; las reglas de hojas de estilos en cascada definidas en `Styles.css` son responsables del diseño estéticamente agradable.</span><span class="sxs-lookup"><span data-stu-id="4abdc-192">The Repeater renders vanilla unordered list markup; the cascading style sheet rules defined in `Styles.css` are responsible for the aesthetically-pleasing layout.</span></span> <span data-ttu-id="4abdc-193">Para obtener una descripción más detallada de cómo funciona el marcado anterior, consulte las [páginas maestras y](https://asp.net/learn/data-access/tutorial-03-vb.aspx) el tutorial de navegación del sitio.</span><span class="sxs-lookup"><span data-stu-id="4abdc-193">For a more detailed description of how the above markup works, refer to the [Master Pages and Site Navigation](https://asp.net/learn/data-access/tutorial-03-vb.aspx) tutorial.</span></span>

<span data-ttu-id="4abdc-194">[![la interfaz de usuario de navegación se representa utilizando listas no ordenadas anidadas](creating-user-accounts-vb/_static/image11.png)](creating-user-accounts-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-194">[![The Navigational User Interface is Rendered Using Nested Unordered Lists](creating-user-accounts-vb/_static/image11.png)](creating-user-accounts-vb/_static/image10.png)</span></span>

<span data-ttu-id="4abdc-195">**Figura 4**: La interfaz de usuario de navegación se representa mediante listas no ordenadas anidadas ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-195">**Figure 4**: The Navigational User Interface is Rendered Using Nested Unordered Lists ([Click to view full-size image](creating-user-accounts-vb/_static/image12.png))</span></span>

### <a name="adding-breadcrumb-navigation"></a><span data-ttu-id="4abdc-196">Agregar una ruta de navegación</span><span class="sxs-lookup"><span data-stu-id="4abdc-196">Adding Breadcrumb Navigation</span></span>

<span data-ttu-id="4abdc-197">Además de la lista de vínculos de la columna izquierda, cada página también muestra una [ruta de navegación](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span><span class="sxs-lookup"><span data-stu-id="4abdc-197">In addition to the list of links in the left column, let's also have each page display a [breadcrumb](http://en.wikipedia.org/wiki/Breadcrumb_%28navigation%29).</span></span> <span data-ttu-id="4abdc-198">Una ruta de navegación es un elemento de la interfaz de usuario de navegación que muestra rápidamente a los usuarios su posición actual dentro de la jerarquía del sitio.</span><span class="sxs-lookup"><span data-stu-id="4abdc-198">A breadcrumb is a navigational user interface element that quickly shows users their current position within the site hierarchy.</span></span> <span data-ttu-id="4abdc-199">El control SiteMapPath usa el marco del mapa del sitio para determinar la ubicación de la página actual en el mapa del sitio y, a continuación, muestra una ruta de navegación basada en esta información.</span><span class="sxs-lookup"><span data-stu-id="4abdc-199">The SiteMapPath control uses the Site Map framework to determine the current page's location in the site map and then displays a breadcrumb based on this information.</span></span>

<span data-ttu-id="4abdc-200">En concreto, agregue un elemento `<span>` al encabezado `<div>` elemento de la página maestra y establezca el atributo `class` del nuevo elemento `<span>` en la ruta de navegación.</span><span class="sxs-lookup"><span data-stu-id="4abdc-200">Specifically, add a `<span>` element to the master page's header `<div>` element, and set the new `<span>` element's `class` attribute to breadcrumb.</span></span> <span data-ttu-id="4abdc-201">(La clase `Styles.css` contiene una regla para una clase de ruta de navegación). A continuación, agregue un elemento SiteMapPath a este nuevo elemento `<span>`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-201">(The `Styles.css` class contains a rule for a breadcrumb class.) Next, add a SiteMapPath to this new `<span>` element.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample4.aspx)]

<span data-ttu-id="4abdc-202">En la figura 5 se muestra la salida de SiteMapPath al visitar `~/Membership/CreatingUserAccounts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-202">Figure 5 shows the output of the SiteMapPath when visiting `~/Membership/CreatingUserAccounts.aspx`.</span></span>

<span data-ttu-id="4abdc-203">[![la ruta de navegación muestra la página actual y sus antecesores en el mapa del sitio](creating-user-accounts-vb/_static/image14.png)](creating-user-accounts-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-203">[![The Breadcrumb Displays the Current Page and its Ancestors in the Site Map](creating-user-accounts-vb/_static/image14.png)](creating-user-accounts-vb/_static/image13.png)</span></span>

<span data-ttu-id="4abdc-204">**Figura 5**: La ruta de navegación muestra la página actual y sus antecesores en el mapa del sitio ([haga clic para ver la imagen a tamaño completo](creating-user-accounts-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-204">**Figure 5**: The Breadcrumb Displays the Current Page and its Ancestors in the Site Map ([Click to view full-size image](creating-user-accounts-vb/_static/image15.png))</span></span>

## <a name="step-4-removing-the-custom-principal-and-identity-logic"></a><span data-ttu-id="4abdc-205">Paso 4: Quitar la lógica de identidad y entidad de seguridad personalizada</span><span class="sxs-lookup"><span data-stu-id="4abdc-205">Step 4: Removing the Custom Principal and Identity Logic</span></span>

<span data-ttu-id="4abdc-206">En el tutorial configuración de la *<a id="_msoanchor_7"></a>[autenticación de formularios y temas avanzados](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* , vimos cómo asociar objetos principales y de identidad personalizados al usuario autenticado.</span><span class="sxs-lookup"><span data-stu-id="4abdc-206">In the *<a id="_msoanchor_7"></a>[Forms Authentication Configuration and Advanced Topics](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)* tutorial we saw how to associate custom principal and identity objects to the authenticated user.</span></span> <span data-ttu-id="4abdc-207">Para ello, se crea un controlador de eventos en `Global.asax` para el evento de `PostAuthenticateRequest` de la aplicación, que se desencadena después de que el `FormsAuthenticationModule` haya autenticado al usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-207">We accomplished this by creating an event handler in `Global.asax` for the application's `PostAuthenticateRequest` event, which fires after the `FormsAuthenticationModule` has authenticated the user.</span></span> <span data-ttu-id="4abdc-208">En este controlador de eventos se reemplazaron los objetos `GenericPrincipal` y `FormsIdentity` agregados por el `FormsAuthenticationModule` con los objetos `CustomPrincipal` y `CustomIdentity` creados en ese tutorial.</span><span class="sxs-lookup"><span data-stu-id="4abdc-208">In this event handler we replaced the `GenericPrincipal` and `FormsIdentity` objects added by the `FormsAuthenticationModule` with the `CustomPrincipal` and `CustomIdentity` objects we created in that tutorial.</span></span>

<span data-ttu-id="4abdc-209">Aunque los objetos principales y de identidad personalizados son útiles en ciertos escenarios, en la mayoría de los casos los objetos `GenericPrincipal` y `FormsIdentity` son suficientes.</span><span class="sxs-lookup"><span data-stu-id="4abdc-209">While custom principal and identity objects are useful in certain scenarios, in most cases the `GenericPrincipal` and `FormsIdentity` objects are sufficient.</span></span> <span data-ttu-id="4abdc-210">Por lo tanto, creo que sería rentable volver al comportamiento predeterminado.</span><span class="sxs-lookup"><span data-stu-id="4abdc-210">Consequently, I think it would be worthwhile to return to the default behavior.</span></span> <span data-ttu-id="4abdc-211">Realice este cambio quitando o marcando como comentario el controlador de eventos `PostAuthenticateRequest` o eliminando el archivo de `Global.asax` por completo.</span><span class="sxs-lookup"><span data-stu-id="4abdc-211">Make this change by either removing or commenting out the `PostAuthenticateRequest` event handler or by deleting the `Global.asax` file entirely.</span></span>

> [!NOTE]
> <span data-ttu-id="4abdc-212">Una vez que haya comentado o quitado el código en `Global.asax`, tendrá que comentar el código en `Default.aspx's` clase de código subyacente que convierte la propiedad `User.Identity` en una instancia de `CustomIdentity`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-212">Once you've commented or removed the code in `Global.asax`, you will need to comment out the code in `Default.aspx's` code-behind class that casts the `User.Identity` property to a `CustomIdentity` instance.</span></span>

## <a name="step-5-programmatically-creating-a-new-user"></a><span data-ttu-id="4abdc-213">Paso 5: Crear un nuevo usuario mediante programación</span><span class="sxs-lookup"><span data-stu-id="4abdc-213">Step 5: Programmatically Creating a New User</span></span>

<span data-ttu-id="4abdc-214">Para crear una nueva cuenta de usuario a través del marco de pertenencia, use el [método`CreateUser`](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx)de la clase `Membership`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-214">To create a new user account through the Membership framework use the `Membership` class's [`CreateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.createuser.aspx).</span></span> <span data-ttu-id="4abdc-215">Este método tiene parámetros de entrada para el nombre de usuario, la contraseña y otros campos relacionados con el usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-215">This method has input parameters for the username, password, and other user-related fields.</span></span> <span data-ttu-id="4abdc-216">Al invocar, delega la creación de la nueva cuenta de usuario en el proveedor de pertenencia configurado y, a continuación, devuelve un [objeto`MembershipUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) que representa la cuenta de usuario que se acaba de crear.</span><span class="sxs-lookup"><span data-stu-id="4abdc-216">On invocation, it delegates the creation of the new user account to the configured Membership provider and then returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx) representing the just-created user account.</span></span>

<span data-ttu-id="4abdc-217">El método `CreateUser` tiene cuatro sobrecargas, cada una de las cuales acepta un número diferente de parámetros de entrada:</span><span class="sxs-lookup"><span data-stu-id="4abdc-217">The `CreateUser` method has four overloads, each accepting a different number of input parameters:</span></span>

- [`CreateUser(username, password)`](https://msdn.microsoft.com/library/d8t4h2es.aspx)
- [`CreateUser(username, password, email)`](https://msdn.microsoft.com/library/t8yy6w3h.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, MembershipCreateStatus)`](https://msdn.microsoft.com/library/82xx2e62.aspx)
- [`CreateUser(username, password, email, passwordQuestion, passwordAnswer, isApproved, providerUserKey, MembershipCreateStatus)`](https://msdn.microsoft.com/library/ms152012.aspx)

<span data-ttu-id="4abdc-218">Estas cuatro sobrecargas se diferencian en la cantidad de información que se recopila.</span><span class="sxs-lookup"><span data-stu-id="4abdc-218">These four overloads differ on the amount of information that is collected.</span></span> <span data-ttu-id="4abdc-219">La primera sobrecarga, por ejemplo, solo requiere el nombre de usuario y la contraseña de la nueva cuenta de usuario, mientras que la segunda también requiere la dirección de correo electrónico del usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-219">The first overload, for example, requires just the username and password for the new user account, whereas the second one also requires the user's email address.</span></span>

<span data-ttu-id="4abdc-220">Estas sobrecargas existen porque la información necesaria para crear una nueva cuenta de usuario depende de las opciones de configuración del proveedor de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-220">These overloads exist because the information needed to create a new user account depends on the Membership provider's configuration settings.</span></span> <span data-ttu-id="4abdc-221">En el *<a id="_msoanchor_8"></a>[Tutorial crear el esquema de pertenencia en SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* examinamos especificando los valores de configuración del proveedor de pertenencia en `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-221">In the *<a id="_msoanchor_8"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* tutorial we examined specifying Membership provider configuration settings in `Web.config`.</span></span> <span data-ttu-id="4abdc-222">En la tabla 2 se incluye una lista completa de las opciones de configuración.</span><span class="sxs-lookup"><span data-stu-id="4abdc-222">Table 2 included a complete list of the configuration settings.</span></span>

<span data-ttu-id="4abdc-223">Una de estas opciones de configuración del proveedor de pertenencia que afecta a lo que se pueden usar sobrecargas de `CreateUser` es el valor de `requiresQuestionAndAnswer`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-223">One such Membership provider configuration setting that impacts what `CreateUser` overloads may be used is the `requiresQuestionAndAnswer` setting.</span></span> <span data-ttu-id="4abdc-224">Si `requiresQuestionAndAnswer` se establece en `true` (valor predeterminado), al crear una nueva cuenta de usuario se debe especificar una pregunta y respuesta de seguridad.</span><span class="sxs-lookup"><span data-stu-id="4abdc-224">If `requiresQuestionAndAnswer` is set to `true` (the default), then when creating a new user account we must specify a security question and answer.</span></span> <span data-ttu-id="4abdc-225">Esta información se utiliza posteriormente si el usuario necesita restablecer o cambiar su contraseña.</span><span class="sxs-lookup"><span data-stu-id="4abdc-225">This information is later used if the user needs to reset or change their password.</span></span> <span data-ttu-id="4abdc-226">En concreto, en ese momento se muestra la pregunta de seguridad y deben escribir la respuesta correcta para restablecer o cambiar su contraseña.</span><span class="sxs-lookup"><span data-stu-id="4abdc-226">Specifically, at that time they are shown the security question and they must enter the correct answer in order to reset or change their password.</span></span> <span data-ttu-id="4abdc-227">Por lo tanto, si la `requiresQuestionAndAnswer` se establece en `true` después de llamar a cualquiera de las dos primeras sobrecargas de `CreateUser` se produce una excepción porque falta la pregunta y respuesta de seguridad.</span><span class="sxs-lookup"><span data-stu-id="4abdc-227">Consequently, if the `requiresQuestionAndAnswer` is set to `true` then calling either of the first two `CreateUser` overloads results in an exception because the security question and answer are missing.</span></span> <span data-ttu-id="4abdc-228">Dado que nuestra aplicación está configurada actualmente para requerir una pregunta y respuesta de seguridad, tendremos que usar una de las dos últimas sobrecargas al crear el usuario mediante programación.</span><span class="sxs-lookup"><span data-stu-id="4abdc-228">Since our application is currently configured to require a security question and answer, we will need to use one of the latter two overloads when creating user's programmatically.</span></span>

<span data-ttu-id="4abdc-229">Para ilustrar el uso del método `CreateUser`, vamos a crear una interfaz de usuario en la que pedimos al usuario su nombre, contraseña, correo electrónico y una respuesta a una pregunta de seguridad predefinida.</span><span class="sxs-lookup"><span data-stu-id="4abdc-229">To illustrate using the `CreateUser` method, let's create a user interface where we prompt the user for their name, password, email, and an answer to a pre-defined security question.</span></span> <span data-ttu-id="4abdc-230">Abra la página `CreatingUserAccounts.aspx` en la carpeta `Membership` y agregue los siguientes controles Web al control de contenido:</span><span class="sxs-lookup"><span data-stu-id="4abdc-230">Open the `CreatingUserAccounts.aspx` page in the `Membership` folder and add the following Web controls to the Content control:</span></span>

- <span data-ttu-id="4abdc-231">Un cuadro de texto denominado `Username`</span><span class="sxs-lookup"><span data-stu-id="4abdc-231">A TextBox named `Username`</span></span>
- <span data-ttu-id="4abdc-232">Un cuadro de texto denominado `Password`, cuya propiedad `TextMode` está establecida en `Password`</span><span class="sxs-lookup"><span data-stu-id="4abdc-232">A TextBox named `Password`, whose `TextMode` property is set to `Password`</span></span>
- <span data-ttu-id="4abdc-233">Un cuadro de texto denominado `Email`</span><span class="sxs-lookup"><span data-stu-id="4abdc-233">A TextBox named `Email`</span></span>
- <span data-ttu-id="4abdc-234">Una etiqueta llamada `SecurityQuestion` con su propiedad `Text` desactivada</span><span class="sxs-lookup"><span data-stu-id="4abdc-234">A Label named `SecurityQuestion` with its `Text` property cleared out</span></span>
- <span data-ttu-id="4abdc-235">Un cuadro de texto denominado `SecurityAnswer`</span><span class="sxs-lookup"><span data-stu-id="4abdc-235">A TextBox named `SecurityAnswer`</span></span>
- <span data-ttu-id="4abdc-236">Botón denominado `CreateAccountButton` cuya propiedad `Text` se establece para crear la cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-236">A Button named `CreateAccountButton` whose `Text` property is set to Create the User Account</span></span>
- <span data-ttu-id="4abdc-237">Un control etiqueta denominado `CreateAccountResults` con su propiedad `Text` desactivada</span><span class="sxs-lookup"><span data-stu-id="4abdc-237">A Label control named `CreateAccountResults` with its `Text` property cleared out</span></span>

<span data-ttu-id="4abdc-238">En este punto, la pantalla debe ser similar a la captura de pantalla que se muestra en la figura 6.</span><span class="sxs-lookup"><span data-stu-id="4abdc-238">At this point your screen should look similar to the screen shot shown in Figure 6.</span></span>

<span data-ttu-id="4abdc-239">[![agregar los distintos controles Web a la página CreatingUserAccounts. aspx](creating-user-accounts-vb/_static/image17.png)](creating-user-accounts-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-239">[![Add the Various Web Controls to the CreatingUserAccounts.aspx Page](creating-user-accounts-vb/_static/image17.png)](creating-user-accounts-vb/_static/image16.png)</span></span>

<span data-ttu-id="4abdc-240">**Ilustración 6**: Agregue los distintos controles Web al `CreatingUserAccounts.aspx Page` ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-240">**Figure 6**: Add the Various Web Controls to the `CreatingUserAccounts.aspx Page` ([Click to view full-size image](creating-user-accounts-vb/_static/image18.png))</span></span>

<span data-ttu-id="4abdc-241">Los `SecurityQuestion` etiqueta y `SecurityAnswer` cuadro de texto están diseñados para mostrar una pregunta de seguridad predefinida y recopilar la respuesta del usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-241">The `SecurityQuestion` Label and `SecurityAnswer` TextBox are intended to display a pre-defined security question and collect the user's answer.</span></span> <span data-ttu-id="4abdc-242">Tenga en cuenta que la pregunta y la respuesta de seguridad se almacenan de forma individual para cada usuario, por lo que es posible permitir que cada usuario defina su propia pregunta de seguridad.</span><span class="sxs-lookup"><span data-stu-id="4abdc-242">Note that both the security question and answer are stored on a user-by-user basis, so it is possible to allow each user to define their own security question.</span></span> <span data-ttu-id="4abdc-243">Sin embargo, en este ejemplo he decidido usar una pregunta de seguridad universal, a saber: ¿Cuál es su color favorito?</span><span class="sxs-lookup"><span data-stu-id="4abdc-243">However, for this example I have decided to use a universal security question, namely: What is your favorite color?</span></span>

<span data-ttu-id="4abdc-244">Para implementar esta pregunta de seguridad predefinida, agregue una constante a la clase de código subyacente de la página denominada `passwordQuestion`, asignando la pregunta de seguridad.</span><span class="sxs-lookup"><span data-stu-id="4abdc-244">To implement this pre-defined security question, add a constant to the page's code-behind class named `passwordQuestion`, assigning it the security question.</span></span> <span data-ttu-id="4abdc-245">A continuación, en el controlador de eventos `Page_Load`, asigne esta constante a la propiedad `Text` de la etiqueta de `SecurityQuestion`:</span><span class="sxs-lookup"><span data-stu-id="4abdc-245">Then, in the `Page_Load` event handler, assign this constant to the `SecurityQuestion` Label's `Text` property:</span></span>

[!code-vb[Main](creating-user-accounts-vb/samples/sample5.vb)]

<span data-ttu-id="4abdc-246">A continuación, cree un controlador de eventos para el evento `CreateAccountButton'` s `Click` y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="4abdc-246">Next, create an event handler for the `CreateAccountButton'` s `Click` event and add the following code:</span></span>

[!code-vb[Main](creating-user-accounts-vb/samples/sample6.vb)]

<span data-ttu-id="4abdc-247">El controlador de eventos `Click` se inicia definiendo una variable denominada `createStatus` de tipo [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span><span class="sxs-lookup"><span data-stu-id="4abdc-247">The `Click` event handler starts by defining a variable named `createStatus` of type [`MembershipCreateStatus`](https://msdn.microsoft.com/library/system.web.security.membershipcreatestatus.aspx).</span></span> <span data-ttu-id="4abdc-248">`MembershipCreateStatus` es una enumeración que indica el estado de la operación de `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-248">`MembershipCreateStatus` is an enumeration that indicates the status of the `CreateUser` operation.</span></span> <span data-ttu-id="4abdc-249">Por ejemplo, si la cuenta de usuario se crea correctamente, la instancia de `MembershipCreateStatus` resultante se establecerá en un valor de `Success;` por otro lado, si se produce un error en la operación porque ya existe un usuario con el mismo nombre de usuario, se establecerá en un valor de `DuplicateUserName`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-249">For example, if the user account is created successfully, the resulting `MembershipCreateStatus` instance will be set to a value of `Success;` on the other hand, if the operation fails because there already exists a user with the same username, it will be set to a value of `DuplicateUserName`.</span></span> <span data-ttu-id="4abdc-250">En el `CreateUser` sobrecarga que usamos, necesitamos pasar una instancia de `MembershipCreateStatus` al método.</span><span class="sxs-lookup"><span data-stu-id="4abdc-250">In the `CreateUser` overload we use, we need to pass a `MembershipCreateStatus` instance into the method.</span></span> <span data-ttu-id="4abdc-251">Este parámetro se establece en el valor adecuado en el método `CreateUser` y se puede examinar su valor después de la llamada al método para determinar si la cuenta de usuario se ha creado correctamente.</span><span class="sxs-lookup"><span data-stu-id="4abdc-251">This parameter is set to the appropriate value within the `CreateUser` method, and we can examine its value after the method call to determine whether the user account was successfully created.</span></span>

<span data-ttu-id="4abdc-252">Después de llamar a `CreateUser`, pasando `createStatus`, se usa una instrucción `Select Case` para generar un mensaje apropiado según el valor asignado a `createStatus`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-252">After calling `CreateUser`, passing in `createStatus`, a `Select Case` statement is used to output an appropriate message depending on the value assigned to `createStatus`.</span></span> <span data-ttu-id="4abdc-253">En las figuras 7 se muestra el resultado cuando se ha creado un nuevo usuario correctamente.</span><span class="sxs-lookup"><span data-stu-id="4abdc-253">Figures 7 shows the output when a new user has successfully been created.</span></span> <span data-ttu-id="4abdc-254">En las figuras 8 y 9 se muestra el resultado cuando no se crea la cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-254">Figures 8 and 9 show the output when the user account is not created.</span></span> <span data-ttu-id="4abdc-255">En la figura 8, el visitante escribió una contraseña de cinco letras, que no cumple los requisitos de seguridad de la contraseña escritos en los valores de configuración del proveedor de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-255">In Figure 8, the visitor entered a five-letter password, which does not meet the password strength requirements spelled out in the Membership provider's configuration settings.</span></span> <span data-ttu-id="4abdc-256">En la figura 9, el visitante intenta crear una cuenta de usuario con un nombre de usuario existente (el que se creó en la figura 7).</span><span class="sxs-lookup"><span data-stu-id="4abdc-256">In Figure 9, the visitor is attempting to create a user account with an existing username (the one created in Figure 7).</span></span>

<span data-ttu-id="4abdc-257">[![se creó correctamente una nueva cuenta de usuario](creating-user-accounts-vb/_static/image20.png)](creating-user-accounts-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-257">[![A New User Account is Successfully Created](creating-user-accounts-vb/_static/image20.png)](creating-user-accounts-vb/_static/image19.png)</span></span>

<span data-ttu-id="4abdc-258">**Figura 7**: Se creó correctamente una nueva cuenta de usuario ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-258">**Figure 7**: A New User Account is Successfully Created  ([Click to view full-size image](creating-user-accounts-vb/_static/image21.png))</span></span>

<span data-ttu-id="4abdc-259">[![no se creó la cuenta de usuario porque la contraseña proporcionada es demasiado débil](creating-user-accounts-vb/_static/image23.png)](creating-user-accounts-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-259">[![The User Account is Not Created Because the Supplied Password is Too Weak](creating-user-accounts-vb/_static/image23.png)](creating-user-accounts-vb/_static/image22.png)</span></span>

<span data-ttu-id="4abdc-260">**Figura 8**: No se creó la cuenta de usuario porque la contraseña proporcionada es demasiado débil ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-260">**Figure 8**: The User Account is Not Created Because the Supplied Password is Too Weak ([Click to view full-size image](creating-user-accounts-vb/_static/image24.png))</span></span>

<span data-ttu-id="4abdc-261">[![no se creó la cuenta de usuario porque el nombre de usuario ya está en uso](creating-user-accounts-vb/_static/image26.png)](creating-user-accounts-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-261">[![The User Account is Not Created Because the Username is Already in Use](creating-user-accounts-vb/_static/image26.png)](creating-user-accounts-vb/_static/image25.png)</span></span>

<span data-ttu-id="4abdc-262">**Ilustración 9**: No se creó la cuenta de usuario porque el nombre de usuario ya está en uso ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-262">**Figure 9**: The User Account is Not Created Because the Username is Already in Use ([Click to view full-size image](creating-user-accounts-vb/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="4abdc-263">Es posible que se pregunte cómo determinar si se ha realizado correctamente o no cuando se usa una de las dos primeras sobrecargas del método `CreateUser`, ninguno de los cuales tiene un parámetro de tipo `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-263">You may be wondering how to determine success or failure when using one of the first two `CreateUser` method overloads, neither of which has a parameter of type `MembershipCreateStatus`.</span></span> <span data-ttu-id="4abdc-264">Estas dos primeras sobrecargas inician una [excepción`MembershipCreateUserException`](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) ante un error, que incluye una [propiedad`StatusCode`](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) de tipo `MembershipCreateStatus`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-264">These first two overloads throw a [`MembershipCreateUserException` exception](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.aspx) in the face of a failure, which includes a [`StatusCode` property](https://msdn.microsoft.com/library/system.web.security.membershipcreateuserexception.statuscode.aspx) of type `MembershipCreateStatus`.</span></span>

<span data-ttu-id="4abdc-265">Después de crear algunas cuentas de usuario, compruebe que las cuentas se han creado enumerando el contenido de las tablas `aspnet_Users` y `aspnet_Membership` en la base de datos `SecurityTutorials.mdf`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-265">After creating a few user accounts, verify that the accounts have been created by listing the contents of the `aspnet_Users` and `aspnet_Membership` tables in the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="4abdc-266">Como se muestra en la figura 10, he agregado dos usuarios a través de la página `CreatingUserAccounts.aspx`: Tito y Bruce.</span><span class="sxs-lookup"><span data-stu-id="4abdc-266">As Figure 10 shows, I have added two users via the `CreatingUserAccounts.aspx` page: Tito and Bruce.</span></span>

<span data-ttu-id="4abdc-267">[![hay dos usuarios en el almacén de usuarios de pertenencia: Tito y Bruce](creating-user-accounts-vb/_static/image29.png)](creating-user-accounts-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-267">[![There are Two Users in the Membership User Store: Tito and Bruce](creating-user-accounts-vb/_static/image29.png)](creating-user-accounts-vb/_static/image28.png)</span></span>

<span data-ttu-id="4abdc-268">**Figura 10**: Hay dos usuarios en el almacén de usuarios de pertenencia: Tito y Bruce ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-268">**Figure 10**: There are Two Users in the Membership User Store: Tito and Bruce ([Click to view full-size image](creating-user-accounts-vb/_static/image30.png))</span></span>

<span data-ttu-id="4abdc-269">Aunque el almacén de usuarios de pertenencia ahora incluye la información de la cuenta de Bruce y Tito, todavía hemos implementado la funcionalidad que permite que Bruce o Tito inicien sesión en el sitio.</span><span class="sxs-lookup"><span data-stu-id="4abdc-269">While the Membership user store now includes Bruce and Tito's account information, we have yet to implement functionality that allows for Bruce or Tito to log on to the site.</span></span> <span data-ttu-id="4abdc-270">Actualmente, `Login.aspx` valida las credenciales del usuario con un conjunto codificado de pares de nombre de usuario/contraseña, *no* valida las credenciales proporcionadas en el marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-270">Currently, `Login.aspx` validates the user's credentials against a hard-coded set of username/password pairs - it does *not* validate the supplied credentials against the Membership framework.</span></span> <span data-ttu-id="4abdc-271">Por ahora, ver las nuevas cuentas de usuario en el `aspnet_Users` y `aspnet_Membership` tablas tendrán que ser suficientes.</span><span class="sxs-lookup"><span data-stu-id="4abdc-271">For now seeing the new user accounts in the `aspnet_Users` and `aspnet_Membership` tables will have to suffice.</span></span> <span data-ttu-id="4abdc-272">En el siguiente tutorial, *<a id="_msoanchor_9"></a>[validación de las credenciales de usuario en el almacén de usuarios de pertenencia](validating-user-credentials-against-the-membership-user-store-vb.md)* , actualizaremos la página de inicio de sesión para validar con el almacén de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-272">In the next tutorial, *<a id="_msoanchor_9"></a>[Validating User Credentials Against the Membership User Store](validating-user-credentials-against-the-membership-user-store-vb.md)*, we will update the login page to validate against the Membership store.</span></span>

> [!NOTE]
> <span data-ttu-id="4abdc-273">Si no ve ningún usuario en la base de datos de `SecurityTutorials.mdf`, puede deberse a que la aplicación Web usa el proveedor de pertenencia predeterminado, `AspNetSqlMembershipProvider`, que usa la base de datos de `ASPNETDB.mdf` como su almacén de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-273">If you do not see any users in your `SecurityTutorials.mdf` database, it may be because your web application is using the default Membership provider, `AspNetSqlMembershipProvider`, which uses the `ASPNETDB.mdf` database as its user store.</span></span> <span data-ttu-id="4abdc-274">Para determinar si este es el problema, haga clic en el botón actualizar en el Explorador de soluciones.</span><span class="sxs-lookup"><span data-stu-id="4abdc-274">To determine if this is the problem, click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="4abdc-275">Si se ha agregado una base de datos denominada `ASPNETDB.mdf` a la carpeta `App_Data`, este es el problema.</span><span class="sxs-lookup"><span data-stu-id="4abdc-275">If a database named `ASPNETDB.mdf` has been added to the `App_Data` folder, this is the problem.</span></span> <span data-ttu-id="4abdc-276">Vuelva al paso 4 del tutorial *<a id="_msoanchor_10"></a>[Crear el esquema de pertenencia en SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* para obtener instrucciones sobre cómo configurar correctamente el proveedor de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-276">Return to Step 4 of the *<a id="_msoanchor_10"></a>[Creating the Membership Schema in SQL Server](creating-the-membership-schema-in-sql-server-vb.md)* tutorial for instructions on how to properly configure the Membership provider.</span></span>

<span data-ttu-id="4abdc-277">En la mayoría de los escenarios de creación de cuentas de usuario, al visitante se le presenta alguna interfaz para especificar su nombre de usuario, contraseña, correo electrónico y otra información esencial, momento en el que se crea una nueva cuenta.</span><span class="sxs-lookup"><span data-stu-id="4abdc-277">In most create user account scenarios, the visitor is presented with some interface to enter their username, password, email, and other essential information, at which point a new account is created.</span></span> <span data-ttu-id="4abdc-278">En este paso, analizamos la creación de una interfaz de este tipo a mano y, a continuación, vimos cómo usar el método `Membership.CreateUser` para agregar mediante programación la nueva cuenta de usuario basada en las entradas del usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-278">In this step we looked at building such an interface by hand and then saw how to use the `Membership.CreateUser` method to programmatically add the new user account based on the user's inputs.</span></span> <span data-ttu-id="4abdc-279">Sin embargo, nuestro código acaba de crear la nueva cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-279">Our code, however, just created the new user account.</span></span> <span data-ttu-id="4abdc-280">No realizaba ninguna acción de seguimiento, como el inicio de sesión del usuario en el sitio en la cuenta de usuario recién creada o el envío de un correo electrónico de confirmación al usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-280">It did not perform any follow up actions, like logging in the user to the site under the just-created user account, or sending a confirmation email to the user.</span></span> <span data-ttu-id="4abdc-281">Estos pasos adicionales requerirían código adicional en el controlador de eventos `Click` del botón.</span><span class="sxs-lookup"><span data-stu-id="4abdc-281">These additional steps would require additional code in the Button's `Click` event handler.</span></span>

<span data-ttu-id="4abdc-282">ASP.NET se incluye con el control CreateUserWizard, que está diseñado para controlar el proceso de creación de cuentas de usuario, desde la representación de una interfaz de usuario para crear nuevas cuentas de usuario, hasta la creación de la cuenta en el marco de pertenencia y la realización de la cuenta posterior. tareas de creación, como el envío de un correo electrónico de confirmación y el inicio de sesión del usuario que acaba de crear en el sitio.</span><span class="sxs-lookup"><span data-stu-id="4abdc-282">ASP.NET ships with the CreateUserWizard control, which is designed to handle the user account creation process, from rendering a user interface for creating new user accounts, to creating the account in the Membership framework and performing post-account creation tasks, such as sending a confirmation email and logging the just-created user into the site.</span></span> <span data-ttu-id="4abdc-283">El uso del control CreateUserWizard es tan sencillo como arrastrar el control CreateUserWizard desde el cuadro de herramientas a una página y, a continuación, establecer algunas propiedades.</span><span class="sxs-lookup"><span data-stu-id="4abdc-283">Using the CreateUserWizard control is as simple as dragging the CreateUserWizard control from the Toolbox onto a page, and then setting a few properties.</span></span> <span data-ttu-id="4abdc-284">En la mayoría de los casos, no tendrá que escribir una sola línea de código.</span><span class="sxs-lookup"><span data-stu-id="4abdc-284">In most cases, you won't need to write a single line of code.</span></span> <span data-ttu-id="4abdc-285">Analizaremos este ingenioso control en el paso 6.</span><span class="sxs-lookup"><span data-stu-id="4abdc-285">We will explore this nifty control in detail in Step 6.</span></span>

<span data-ttu-id="4abdc-286">Si las cuentas de usuario nuevas solo se crean mediante una típica página web crear cuenta, es poco probable que tenga que escribir código que use el método `CreateUser`, ya que el control CreateUserWizard probablemente satisfaga sus necesidades.</span><span class="sxs-lookup"><span data-stu-id="4abdc-286">If new user accounts are only created through a typical Create Account web page, it is unlikely that you will ever need to write code that uses the `CreateUser` method, as the CreateUserWizard control will likely meet your needs.</span></span> <span data-ttu-id="4abdc-287">Sin embargo, el método `CreateUser` es útil en escenarios en los que se necesita una experiencia de usuario de creación de cuenta muy personalizada o cuando se necesita crear mediante programación nuevas cuentas de usuario a través de una interfaz alternativa.</span><span class="sxs-lookup"><span data-stu-id="4abdc-287">However, the `CreateUser` method is handy in scenarios where you need a highly customized Create Account user experience or when you need to programmatically create new user accounts through an alternative interface.</span></span> <span data-ttu-id="4abdc-288">Por ejemplo, puede tener una página que permita a un usuario cargar un archivo XML que contiene información de usuario de otra aplicación.</span><span class="sxs-lookup"><span data-stu-id="4abdc-288">For example, you might have a page that allows a user to upload an XML file that contains user information from some other application.</span></span> <span data-ttu-id="4abdc-289">La página puede analizar el contenido del archivo XML cargado y crear una nueva cuenta para cada usuario representado en el XML llamando al método `CreateUser`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-289">The page might parses the contents of the uploaded XML file and create a new account for each user represented in the XML by calling the `CreateUser` method.</span></span>

## <a name="step-6-creating-a-new-user-with-the-createuserwizard-control"></a><span data-ttu-id="4abdc-290">Paso 6: Crear un nuevo usuario con el control CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="4abdc-290">Step 6: Creating a New User with the CreateUserWizard Control</span></span>

<span data-ttu-id="4abdc-291">ASP.NET se suministra con varios controles Web de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="4abdc-291">ASP.NET ships with a number of Login Web controls.</span></span> <span data-ttu-id="4abdc-292">Estos controles ayudan en muchos escenarios comunes relacionados con la cuenta de usuario y el inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="4abdc-292">These controls aid in many common user account- and login-related scenarios.</span></span> <span data-ttu-id="4abdc-293">El [control CreateUserWizard](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) es un control de este tipo diseñado para presentar una interfaz de usuario para agregar una nueva cuenta de usuario al marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-293">The [CreateUserWizard control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx) is one such control that is designed to present a user interface for adding a new user account to the Membership framework.</span></span>

<span data-ttu-id="4abdc-294">Al igual que muchos de los demás controles Web relacionados con el inicio de sesión, se puede usar CreateUserWizard sin escribir una sola línea de código.</span><span class="sxs-lookup"><span data-stu-id="4abdc-294">Like many of the other Login-related Web controls, the CreateUserWizard can be used without writing a single line of code.</span></span> <span data-ttu-id="4abdc-295">Proporciona de forma intuitiva una interfaz de usuario basada en la configuración del proveedor de pertenencia y llama internamente al método `CreateUser` de la clase `Membership` después de que el usuario escriba la información necesaria y haga clic en el botón crear usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-295">It intuitively provides a user interface based on the Membership provider's configuration settings and internally calls the `Membership` class's `CreateUser` method after the user enters the necessary information and clicks the Create User button.</span></span> <span data-ttu-id="4abdc-296">El control CreateUserWizard es sumamente personalizable.</span><span class="sxs-lookup"><span data-stu-id="4abdc-296">The CreateUserWizard control is extremely customizable.</span></span> <span data-ttu-id="4abdc-297">Hay un host de eventos que se activan durante varias fases del proceso de creación de la cuenta.</span><span class="sxs-lookup"><span data-stu-id="4abdc-297">There are a host of events that fire during various stages of the account creation process.</span></span> <span data-ttu-id="4abdc-298">Podemos crear controladores de eventos, según sea necesario, para insertar lógica personalizada en el flujo de trabajo de creación de cuentas.</span><span class="sxs-lookup"><span data-stu-id="4abdc-298">We can create event handlers, as needed, to inject custom logic into the account creation workflow.</span></span> <span data-ttu-id="4abdc-299">Además, la apariencia de CreateUserWizard es muy flexible.</span><span class="sxs-lookup"><span data-stu-id="4abdc-299">Furthermore, the CreateUserWizard's appearance is very flexible.</span></span> <span data-ttu-id="4abdc-300">Hay una serie de propiedades que definen la apariencia de la interfaz predeterminada; Si es necesario, el control se puede convertir en una plantilla o se pueden agregar pasos de registro de usuario adicionales.</span><span class="sxs-lookup"><span data-stu-id="4abdc-300">There are a number of properties that define the appearance of the default interface; if necessary, the control can be converted into a template or additional user registration steps may be added.</span></span>

<span data-ttu-id="4abdc-301">Comencemos con un vistazo al uso de la interfaz y el comportamiento predeterminados del control CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="4abdc-301">Let's start with a look at using the CreateUserWizard control's default interface and behavior.</span></span> <span data-ttu-id="4abdc-302">A continuación, exploraremos cómo personalizar la apariencia a través de las propiedades y eventos del control.</span><span class="sxs-lookup"><span data-stu-id="4abdc-302">We'll then explore how to customize the appearance via the control's properties and events.</span></span>

### <a name="examining-the-createuserwizards-default-interface-and-behavior"></a><span data-ttu-id="4abdc-303">Examinar la interfaz y el comportamiento predeterminados de CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="4abdc-303">Examining the CreateUserWizard's Default Interface and Behavior</span></span>

<span data-ttu-id="4abdc-304">Vuelva a la página `CreatingUserAccounts.aspx` de la carpeta `Membership`, cambie al modo de diseño o de división y, a continuación, agregue un control CreateUserWizard a la parte superior de la página.</span><span class="sxs-lookup"><span data-stu-id="4abdc-304">Return to the `CreatingUserAccounts.aspx` page in the `Membership` folder, switch to the Design or Split mode, and then add a CreateUserWizard control to the top of the page.</span></span> <span data-ttu-id="4abdc-305">El control CreateUserWizard se archiva en la sección de controles de inicio de sesión del cuadro de herramientas.</span><span class="sxs-lookup"><span data-stu-id="4abdc-305">The CreateUserWizard control is filed under the Toolbox's Login controls section.</span></span> <span data-ttu-id="4abdc-306">Después de agregar el control, establezca su propiedad `ID` en `RegisterUser`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-306">After adding the control, set its `ID` property to `RegisterUser`.</span></span> <span data-ttu-id="4abdc-307">Como muestra la captura de pantalla de la figura 11, el control CreateUserWizard representa una interfaz con cuadros de texto para el nombre de usuario, la contraseña, la dirección de correo electrónico y la pregunta y respuesta de seguridad.</span><span class="sxs-lookup"><span data-stu-id="4abdc-307">As the screen shot in Figure 11 shows, the CreateUserWizard renders an interface with textboxes for the new user's username, password, email address, and security question and answer.</span></span>

<span data-ttu-id="4abdc-308">[![el control CreateUserWizard representa una interfaz de usuario de creación genérica](creating-user-accounts-vb/_static/image32.png)](creating-user-accounts-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-308">[![The CreateUserWizard Control Renders a Generic Create User Interface](creating-user-accounts-vb/_static/image32.png)](creating-user-accounts-vb/_static/image31.png)</span></span>

<span data-ttu-id="4abdc-309">**Figura 11**: El control CreateUserWizard representa una interfaz de usuario de creación genérica ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-309">**Figure 11**: The CreateUserWizard Control Renders a Generic Create User Interface ([Click to view full-size image](creating-user-accounts-vb/_static/image33.png))</span></span>

<span data-ttu-id="4abdc-310">Dedique un momento a comparar la interfaz de usuario predeterminada generada por el control CreateUserWizard con la interfaz que creamos en el paso 5.</span><span class="sxs-lookup"><span data-stu-id="4abdc-310">Let's take a moment to compare the default user interface generated by the CreateUserWizard control with the interface we created in Step 5.</span></span> <span data-ttu-id="4abdc-311">En el caso de los iniciadores, el control CreateUserWizard permite al visitante especificar la pregunta y la respuesta de seguridad, mientras que nuestra interfaz creada manualmente usó una pregunta de seguridad predefinida.</span><span class="sxs-lookup"><span data-stu-id="4abdc-311">For starters, the CreateUserWizard control allows the visitor to specify both the security question and answer, whereas our manually-created interface used a pre-defined security question.</span></span> <span data-ttu-id="4abdc-312">La interfaz del control CreateUserWizard también incluye controles de validación, mientras que todavía hemos implementado la validación en los campos de formulario de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="4abdc-312">The CreateUserWizard control's interface also includes validation controls, whereas we had yet to implement validation on our interface's form fields.</span></span> <span data-ttu-id="4abdc-313">Y la interfaz del control CreateUserWizard incluye un cuadro de texto Confirm Password (junto con un CompareValidator para asegurarse de que el texto escrito en los cuadros de texto contraseña y comparar contraseña son iguales).</span><span class="sxs-lookup"><span data-stu-id="4abdc-313">And the CreateUserWizard control interface includes a Confirm Password textbox (along with a CompareValidator to ensure that the text entered the Password and Compare Password textboxes are equal).</span></span>

<span data-ttu-id="4abdc-314">Lo interesante es que el control CreateUserWizard consulta las opciones de configuración del proveedor de pertenencia al representar su interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-314">What's interesting is that the CreateUserWizard control consults the Membership provider's configuration settings when rendering its user interface.</span></span> <span data-ttu-id="4abdc-315">Por ejemplo, los cuadros de texto pregunta y respuesta de seguridad solo se muestran si `requiresQuestionAndAnswer` está establecido en true.</span><span class="sxs-lookup"><span data-stu-id="4abdc-315">For example, the security question and answer textboxes are only displayed if `requiresQuestionAndAnswer` is set to True.</span></span> <span data-ttu-id="4abdc-316">Del mismo modo, CreateUserWizard agrega automáticamente un control RegularExpressionValidator para asegurarse de que se cumplen los requisitos de seguridad de la contraseña y establece sus propiedades `ErrorMessage` y `ValidationExpression` basadas en los valores de configuración `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`y `passwordStrengthRegularExpression`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-316">Likewise, CreateUserWizard automatically adds a RegularExpressionValidator control to ensure that the password strength requirements are met, and sets its `ErrorMessage` and `ValidationExpression` properties based on the `minRequiredPasswordLength`, `minRequiredNonalphanumericCharacters`, and `passwordStrengthRegularExpression` configuration settings.</span></span>

<span data-ttu-id="4abdc-317">El control CreateUserWizard, como su nombre implica, se deriva del [control del asistente](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span><span class="sxs-lookup"><span data-stu-id="4abdc-317">The CreateUserWizard control, as its name implies, is derived from the [Wizard control](https://msdn.microsoft.com/library/s2etd1ek.aspx).</span></span> <span data-ttu-id="4abdc-318">Los controles de asistente están diseñados para proporcionar una interfaz para completar las tareas de varios pasos.</span><span class="sxs-lookup"><span data-stu-id="4abdc-318">Wizard controls are designed to provide an interface for completing multi-step tasks.</span></span> <span data-ttu-id="4abdc-319">Un control de asistente puede tener un número arbitrario de `WizardSteps`, cada una de las cuales es una plantilla que define los controles HTML y web para ese paso.</span><span class="sxs-lookup"><span data-stu-id="4abdc-319">A Wizard control may have an arbitrary number of `WizardSteps`, each of which is a template that defines the HTML and Web controls for that step.</span></span> <span data-ttu-id="4abdc-320">El control del asistente muestra inicialmente el primer `WizardStep`, junto con los controles de navegación que permiten al usuario continuar desde un paso hasta el siguiente, o volver a los pasos anteriores.</span><span class="sxs-lookup"><span data-stu-id="4abdc-320">The Wizard control initially displays the first `WizardStep`, along with navigation controls that permit the user to proceed from one step to the next, or to return to previous steps.</span></span>

<span data-ttu-id="4abdc-321">Como se muestra en el marcado declarativo de la figura 11, la interfaz predeterminada del control CreateUserWizard incluye dos `WizardStep` s:</span><span class="sxs-lookup"><span data-stu-id="4abdc-321">As the declarative markup in Figure 11 shows, the CreateUserWizard control's default interface includes two `WizardStep` s:</span></span>

- <span data-ttu-id="4abdc-322">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) ?</span><span class="sxs-lookup"><span data-stu-id="4abdc-322">[`CreateUserWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizardstep.aspx) ?</span></span> <span data-ttu-id="4abdc-323">representa la interfaz para recopilar información para crear la nueva cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-323">renders the interface to collect information for creating the new user account.</span></span> <span data-ttu-id="4abdc-324">Este es el paso que se muestra en la figura 11.</span><span class="sxs-lookup"><span data-stu-id="4abdc-324">This is the step shown in Figure 11.</span></span>
- <span data-ttu-id="4abdc-325">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) ?</span><span class="sxs-lookup"><span data-stu-id="4abdc-325">[`CompleteWizardStep`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.completewizardstep.aspx) ?</span></span> <span data-ttu-id="4abdc-326">representa un mensaje que indica que la cuenta se ha creado correctamente.</span><span class="sxs-lookup"><span data-stu-id="4abdc-326">renders a message indicating that the account has successfully been created.</span></span>

<span data-ttu-id="4abdc-327">La apariencia y el comportamiento de CreateUserWizard se pueden modificar convirtiendo cualquiera de estos pasos en plantillas o agregando sus propios `WizardStep` s.</span><span class="sxs-lookup"><span data-stu-id="4abdc-327">The CreateUserWizard's appearance and behavior can be modified by converting either of these steps to templates, or by adding your own `WizardStep` s.</span></span> <span data-ttu-id="4abdc-328">Veremos cómo agregar una `WizardStep` a la interfaz de registro en el tutorial *almacenamiento de información de usuario adicional* .</span><span class="sxs-lookup"><span data-stu-id="4abdc-328">We will look at adding a `WizardStep` to the registration interface in the *Storing Additional User Information* tutorial.</span></span>

<span data-ttu-id="4abdc-329">Vamos a ver el control CreateUserWizard en acción.</span><span class="sxs-lookup"><span data-stu-id="4abdc-329">Let's see the CreateUserWizard control in action.</span></span> <span data-ttu-id="4abdc-330">Visite la página `CreatingUserAccounts.aspx` a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="4abdc-330">Visit the `CreatingUserAccounts.aspx` page through a browser.</span></span> <span data-ttu-id="4abdc-331">Comience escribiendo algunos valores no válidos en la interfaz de CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="4abdc-331">Start by entering some invalid values into the CreateUserWizard's interface.</span></span> <span data-ttu-id="4abdc-332">Intente escribir una contraseña que no se ajuste a los requisitos de seguridad de la contraseña o dejar el cuadro de texto nombre de usuario vacío.</span><span class="sxs-lookup"><span data-stu-id="4abdc-332">Try entering a password that doesn't conform to the password strength requirements, or leaving the User Name textbox empty.</span></span> <span data-ttu-id="4abdc-333">CreateUserWizard mostrará un mensaje de error adecuado.</span><span class="sxs-lookup"><span data-stu-id="4abdc-333">The CreateUserWizard will display an appropriate error message.</span></span> <span data-ttu-id="4abdc-334">En la ilustración 12 se muestra el resultado cuando se intenta crear un usuario con una contraseña insuficientemente segura.</span><span class="sxs-lookup"><span data-stu-id="4abdc-334">Figure 12 shows the output when attempting to create a user with an insufficiently strong password.</span></span>

<span data-ttu-id="4abdc-335">[![CreateUserWizard inserta automáticamente controles de validación](creating-user-accounts-vb/_static/image35.png)](creating-user-accounts-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-335">[![The CreateUserWizard Automatically Injects Validation Controls](creating-user-accounts-vb/_static/image35.png)](creating-user-accounts-vb/_static/image34.png)</span></span>

<span data-ttu-id="4abdc-336">**Figura 12**: CreateUserWizard inserta automáticamente controles de validación ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-336">**Figure 12**: The CreateUserWizard Automatically Injects Validation Controls ([Click to view full-size image](creating-user-accounts-vb/_static/image36.png))</span></span>

<span data-ttu-id="4abdc-337">A continuación, escriba los valores adecuados en CreateUserWizard y haga clic en el botón crear usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-337">Next, enter appropriate values into the CreateUserWizard and click the Create User button.</span></span> <span data-ttu-id="4abdc-338">Suponiendo que se han especificado los campos obligatorios y que la seguridad de la contraseña es suficiente, CreateUserWizard creará una nueva cuenta de usuario a través del marco de pertenencia y, a continuación, mostrará la interfaz del `CompleteWizardStep`(consulte la figura 13).</span><span class="sxs-lookup"><span data-stu-id="4abdc-338">Assuming the required fields have been entered and the password's strength is sufficient, the CreateUserWizard will create a new user account through the Membership framework and then display the `CompleteWizardStep`'s interface (see Figure 13).</span></span> <span data-ttu-id="4abdc-339">En segundo plano, CreateUserWizard llama al método `Membership.CreateUser`, al igual que hicimos en el paso 5.</span><span class="sxs-lookup"><span data-stu-id="4abdc-339">Behind the scenes, the CreateUserWizard calls the `Membership.CreateUser` method, just like we did in Step 5.</span></span>

<span data-ttu-id="4abdc-340">[![se ha creado correctamente una nueva cuenta de usuario](creating-user-accounts-vb/_static/image38.png)](creating-user-accounts-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-340">[![A New User Account has Successfully Been Created](creating-user-accounts-vb/_static/image38.png)](creating-user-accounts-vb/_static/image37.png)</span></span>

<span data-ttu-id="4abdc-341">**Figura 13**: Se ha creado correctamente una nueva cuenta de usuario ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-341">**Figure 13**: A New User Account has Successfully Been Created ([Click to view full-size image](creating-user-accounts-vb/_static/image39.png))</span></span>

> [!NOTE]
> <span data-ttu-id="4abdc-342">Como se muestra en la figura 13, la interfaz del `CompleteWizardStep`incluye un botón continuar.</span><span class="sxs-lookup"><span data-stu-id="4abdc-342">As Figure 13 shows, the `CompleteWizardStep`'s interface includes a Continue button.</span></span> <span data-ttu-id="4abdc-343">Sin embargo, en este punto, al hacer clic en él solo se realiza un postback, lo que sale del visitante de la misma página.</span><span class="sxs-lookup"><span data-stu-id="4abdc-343">However, at this point clicking it just performs a postback, leaving the visitor on the same page.</span></span> <span data-ttu-id="4abdc-344">En el tema personalización de la apariencia y el comportamiento de CreateUserWizard a través de su sección de propiedades, veremos cómo puede hacer que este botón envíe el visitante a `Default.aspx` (o a alguna otra página).</span><span class="sxs-lookup"><span data-stu-id="4abdc-344">In the Customizing the CreateUserWizard's Appearance and Behavior Through Its Properties section we will look at how you can have this button send the visitor to `Default.aspx` (or some other page).</span></span>

<span data-ttu-id="4abdc-345">Después de crear una nueva cuenta de usuario, vuelva a Visual Studio y examine las tablas `aspnet_Users` y `aspnet_Membership` como hicimos en la figura 10 para comprobar que la cuenta se ha creado correctamente.</span><span class="sxs-lookup"><span data-stu-id="4abdc-345">After creating a new user account, return to Visual Studio and examine the `aspnet_Users` and `aspnet_Membership` tables like we did in Figure 10 to verify that the account was successfully created.</span></span>

### <a name="customizing-the-createuserwizards-behavior-and-appearance-through-its-properties"></a><span data-ttu-id="4abdc-346">Personalizar el comportamiento y la apariencia de CreateUserWizard a través de sus propiedades</span><span class="sxs-lookup"><span data-stu-id="4abdc-346">Customizing the CreateUserWizard's Behavior and Appearance Through Its Properties</span></span>

<span data-ttu-id="4abdc-347">CreateUserWizard puede personalizarse de varias formas, a través de propiedades, `WizardStep` s y controladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="4abdc-347">The CreateUserWizard can be customized in a variety of ways, through properties, `WizardStep` s, and event handlers.</span></span> <span data-ttu-id="4abdc-348">En esta sección, veremos cómo personalizar la apariencia del control a través de sus propiedades. en la siguiente sección se examina la extensión del comportamiento del control a través de los controladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="4abdc-348">In this section we will look at how to customize the control's appearance through its properties; the next section looks at extending the control's behavior through event handlers.</span></span>

<span data-ttu-id="4abdc-349">Prácticamente todo el texto que se muestra en la interfaz de usuario predeterminada del control CreateUserWizard se puede personalizar a través de su gran cantidad de propiedades.</span><span class="sxs-lookup"><span data-stu-id="4abdc-349">Virtually all of the text displayed in the CreateUserWizard control's default user interface can be customized through its plethora of properties.</span></span> <span data-ttu-id="4abdc-350">Por ejemplo, las etiquetas de nombre de usuario, contraseña, Confirmar contraseña, correo electrónico, pregunta de seguridad y respuesta de seguridad que se muestran a la izquierda de los cuadros de texto se pueden personalizar mediante las propiedades [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx)y [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) , respectivamente.</span><span class="sxs-lookup"><span data-stu-id="4abdc-350">For example, the User Name, Password, Confirm Password, E-mail, Security Question, and Security Answer labels displayed to the left of the textboxes can be customized by the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.usernamelabeltext.aspx), [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.passwordlabeltext.aspx), [`ConfirmPasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.confirmpasswordlabeltext.aspx), [`EmailLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.emaillabeltext.aspx), [`QuestionLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.questionlabeltext.aspx), and [`AnswerLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.answerlabeltext.aspx) properties, respectively.</span></span> <span data-ttu-id="4abdc-351">Del mismo modo, hay propiedades para especificar el texto para los botones crear usuario y continuar en el `CreateUserWizardStep` y `CompleteWizardStep`, así como si estos botones se representan como botones, LinkButtons o ImageButtons.</span><span class="sxs-lookup"><span data-stu-id="4abdc-351">Likewise, there are properties for specifying the text for the Create User and Continue buttons in the `CreateUserWizardStep` and `CompleteWizardStep`, as well as if these buttons are rendered as Buttons, LinkButtons, or ImageButtons.</span></span>

<span data-ttu-id="4abdc-352">Los colores, bordes, fuentes y otros elementos visuales se pueden configurar a través de un host de propiedades de estilo.</span><span class="sxs-lookup"><span data-stu-id="4abdc-352">The colors, borders, fonts, and other visual elements are configurable through a host of style properties.</span></span> <span data-ttu-id="4abdc-353">El propio control CreateUserWizard tiene las propiedades de estilo de control Web comunes: `BackColor`, `BorderStyle`, `CssClass`, `Font`, etc., y hay una serie de propiedades de estilo para definir la apariencia de secciones concretas de la interfaz de CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="4abdc-353">The CreateUserWizard control itself has the common Web control style properties - `BackColor`, `BorderStyle`, `CssClass`, `Font`, and so on - and there are a number of style properties for defining the appearance for particular sections of the CreateUserWizard's interface.</span></span> <span data-ttu-id="4abdc-354">La [propiedad`TextBoxStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), por ejemplo, define los estilos para los cuadros de texto en el `CreateUserWizardStep`, mientras que la [propiedad`TitleTextStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) define el estilo del título (Regístrese para obtener la nueva cuenta).</span><span class="sxs-lookup"><span data-stu-id="4abdc-354">The [`TextBoxStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.textboxstyle.aspx), for instance, defines the styles for the textboxes in the `CreateUserWizardStep`, while the [`TitleTextStyle` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.titletextstyle.aspx) defines the style for the title ( Sign Up for Your New Account ).</span></span>

<span data-ttu-id="4abdc-355">Además de las propiedades relacionadas con la apariencia, hay una serie de propiedades que afectan al comportamiento del control CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="4abdc-355">In addition to the appearance-related properties, there are a number of properties that affect the CreateUserWizard control's behavior.</span></span> <span data-ttu-id="4abdc-356">La [propiedad`DisplayCancelButton`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), si se establece en true, muestra un botón Cancelar junto al botón crear usuario (el valor predeterminado es false).</span><span class="sxs-lookup"><span data-stu-id="4abdc-356">The [`DisplayCancelButton` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.wizard.displaycancelbutton.aspx), if set to True, displays a Cancel button next to the Create User button (the default value is False).</span></span> <span data-ttu-id="4abdc-357">Si se muestra el botón Cancelar, asegúrese de establecer también la [propiedad`CancelDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), que especifica la página a la que se envía el usuario después de hacer clic en Cancelar.</span><span class="sxs-lookup"><span data-stu-id="4abdc-357">If you display the Cancel button, be sure to also set the [`CancelDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx), which specifies the page the user is sent to after clicking Cancel.</span></span> <span data-ttu-id="4abdc-358">Como se indicó en la sección anterior, el botón continuar de la interfaz del `CompleteWizardStep`produce un postback, pero deja al visitante en la misma página.</span><span class="sxs-lookup"><span data-stu-id="4abdc-358">As noted in the previous section, the Continue button in the `CompleteWizardStep`'s interface causes a postback, but leaves the visitor on the same page.</span></span> <span data-ttu-id="4abdc-359">Para enviar el visitante a otra página después de hacer clic en el botón continuar, solo tiene que especificar la dirección URL en la [propiedad`ContinueDestinationPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="4abdc-359">To send the visitor to some other page after clicking the Continue button, simply specify the URL in the [`ContinueDestinationPageUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.continuedestinationpageurl.aspx).</span></span>

<span data-ttu-id="4abdc-360">Vamos a actualizar el control CreateUserWizard `RegisterUser` para mostrar un botón Cancelar y enviar el visitante a `Default.aspx` cuando se haga clic en los botones cancelar o continuar.</span><span class="sxs-lookup"><span data-stu-id="4abdc-360">Let's update the `RegisterUser` CreateUserWizard control to show a Cancel button and to send the visitor to `Default.aspx` when the Cancel or Continue buttons are clicked.</span></span> <span data-ttu-id="4abdc-361">Para ello, establezca la propiedad `DisplayCancelButton` en true y las propiedades `CancelDestinationPageUrl` y `ContinueDestinationPageUrl` en ~/default.aspx.</span><span class="sxs-lookup"><span data-stu-id="4abdc-361">To accomplish this, set the `DisplayCancelButton` property to True and both the `CancelDestinationPageUrl` and `ContinueDestinationPageUrl` properties to ~/Default.aspx.</span></span> <span data-ttu-id="4abdc-362">En la figura 14 se muestra el CreateUserWizard actualizado cuando se ve a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="4abdc-362">Figure 14 shows the updated CreateUserWizard when viewed through a browser.</span></span>

<span data-ttu-id="4abdc-363">[![el CreateUserWizardStep incluye un botón Cancelar](creating-user-accounts-vb/_static/image41.png)](creating-user-accounts-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-363">[![The CreateUserWizardStep Includes a Cancel Button](creating-user-accounts-vb/_static/image41.png)](creating-user-accounts-vb/_static/image40.png)</span></span>

<span data-ttu-id="4abdc-364">**Figura 14**: El `CreateUserWizardStep` incluye un botón Cancelar ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-364">**Figure 14**: The `CreateUserWizardStep` Includes a Cancel Button ([Click to view full-size image](creating-user-accounts-vb/_static/image42.png))</span></span>

<span data-ttu-id="4abdc-365">Cuando un visitante escribe un nombre de usuario, una contraseña, una dirección de correo electrónico y una pregunta y respuesta de seguridad, y hace clic en crear usuario, se crea una nueva cuenta de usuario y el visitante inicia sesión como el usuario recién creado.</span><span class="sxs-lookup"><span data-stu-id="4abdc-365">When a visitor enters a username, password, email address, and security question and answer and clicks Create User, a new user account is created and the visitor is logged in as that newly created user.</span></span> <span data-ttu-id="4abdc-366">Suponiendo que la persona que visita la página está creando una cuenta nueva para sí misma, es probable que sea el comportamiento deseado.</span><span class="sxs-lookup"><span data-stu-id="4abdc-366">Assuming that the person visiting the page is creating a new account for themselves, this is likely the desired behavior.</span></span> <span data-ttu-id="4abdc-367">Sin embargo, es posible que desee permitir a los administradores agregar nuevas cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-367">However, you may want to allow Administrators to add new user accounts.</span></span> <span data-ttu-id="4abdc-368">Al hacerlo, se creará la cuenta de usuario, pero el administrador permanecerá conectado como administrador (y no como cuenta recién creada).</span><span class="sxs-lookup"><span data-stu-id="4abdc-368">In doing so, the user account would be created, but the Administrator would remain logged in as an Administrator (and not as the newly created account).</span></span> <span data-ttu-id="4abdc-369">Este comportamiento se puede modificar mediante la [propiedad booleana`LoginCreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span><span class="sxs-lookup"><span data-stu-id="4abdc-369">This behavior can be modified through the Boolean [`LoginCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.logincreateduser.aspx).</span></span>

<span data-ttu-id="4abdc-370">Las cuentas de usuario del marco de pertenencia contienen una marca aprobada; los usuarios que no estén aprobados no podrán iniciar sesión en el sitio.</span><span class="sxs-lookup"><span data-stu-id="4abdc-370">User accounts in the Membership framework contain an approved flag; users who are not approved are unable to log into the site.</span></span> <span data-ttu-id="4abdc-371">De forma predeterminada, una cuenta recién creada se marca como aprobada, lo que permite al usuario iniciar sesión en el sitio inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="4abdc-371">By default, a newly created account is marked as approved, allowing the user to log into the site immediately.</span></span> <span data-ttu-id="4abdc-372">No obstante, es posible que las cuentas de usuario nuevas estén marcadas como no aprobadas.</span><span class="sxs-lookup"><span data-stu-id="4abdc-372">It is possible, however, to have new user accounts marked as unapproved.</span></span> <span data-ttu-id="4abdc-373">Quizás quiera que un administrador apruebe manualmente los nuevos usuarios antes de que puedan iniciar sesión. o quizás quiera comprobar que la dirección de correo electrónico especificada en la suscripción es válida antes de permitir que un usuario inicie sesión.</span><span class="sxs-lookup"><span data-stu-id="4abdc-373">Perhaps you want an Administrator to manually approve new users before they can log in; or maybe you want to verify that the email address entered at signup is valid before permitting a user to log on.</span></span> <span data-ttu-id="4abdc-374">Sea cual sea el caso, puede hacer que la cuenta de usuario recién creada esté marcada como no aprobada estableciendo la [propiedad`DisableCreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) del control CreateUserWizard en true (el valor predeterminado es false).</span><span class="sxs-lookup"><span data-stu-id="4abdc-374">Whatever the case may be, you can have the newly created user account marked as unapproved by setting the CreateUserWizard control's [`DisableCreatedUser` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.disablecreateduser.aspx) to True (the default is False).</span></span>

<span data-ttu-id="4abdc-375">Otras propiedades relacionadas con el comportamiento de Note incluyen `AutoGeneratePassword` y `MailDefinition`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-375">Other behavior-related properties of note include `AutoGeneratePassword` and `MailDefinition`.</span></span> <span data-ttu-id="4abdc-376">Si la [propiedad`AutoGeneratePassword`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) está establecida en true, el `CreateUserWizardStep` no muestra los cuadros de texto contraseña y Confirmar contraseña. en su lugar, la contraseña del usuario recién creada se genera automáticamente mediante el [método`GeneratePassword`](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx)de la clase `Membership`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-376">If the [`AutoGeneratePassword` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.autogeneratepassword.aspx) is set to True, the `CreateUserWizardStep` does not display the Password and Confirm Password textboxes; instead, the newly-created user's password is automatically generated using the `Membership` class's [`GeneratePassword` method](https://msdn.microsoft.com/library/system.web.security.membership.generatepassword.aspx).</span></span> <span data-ttu-id="4abdc-377">El método `GeneratePassword` crea una contraseña de una longitud especificada y con un número suficiente de caracteres no alfanuméricos para satisfacer los requisitos de seguridad de contraseña configurados.</span><span class="sxs-lookup"><span data-stu-id="4abdc-377">The `GeneratePassword` method constructs a password of a specified length and with a sufficient number of non-alphanumeric characters to satisfy the configured password strength requirements.</span></span>

<span data-ttu-id="4abdc-378">La [propiedad`MailDefinition`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) es útil si desea enviar un correo electrónico a la dirección de correo electrónico especificada durante el proceso de creación de la cuenta.</span><span class="sxs-lookup"><span data-stu-id="4abdc-378">The [`MailDefinition` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.maildefinition.aspx) is useful if you want to send an email to the email address specified during the account creation process.</span></span> <span data-ttu-id="4abdc-379">La propiedad `MailDefinition` incluye una serie de subpropiedades para definir información sobre el mensaje de correo electrónico construido.</span><span class="sxs-lookup"><span data-stu-id="4abdc-379">The `MailDefinition` property includes a series of subproperties for defining information about the constructed email message.</span></span> <span data-ttu-id="4abdc-380">Estas subpropiedades incluyen opciones como `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`y `BodyFileName`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-380">These subproperties include options like `Subject`, `Priority`, `IsBodyHtml`, `From`, `CC`, and `BodyFileName`.</span></span> <span data-ttu-id="4abdc-381">La [propiedad`BodyFileName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) apunta a un archivo de texto o HTML que contiene el cuerpo del mensaje de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="4abdc-381">The [`BodyFileName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.maildefinition.bodyfilename.aspx) points to a text or HTML file that contains the body for the email message.</span></span> <span data-ttu-id="4abdc-382">El cuerpo admite dos marcadores de posición predefinidos: `<%UserName%>` y `<%Password%>`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-382">The body supports two pre-defined placeholders: `<%UserName%>` and `<%Password%>`.</span></span> <span data-ttu-id="4abdc-383">Estos marcadores de posición, si están presentes en el archivo `BodyFileName`, se reemplazarán por el nombre y la contraseña del usuario que se acaba de crear.</span><span class="sxs-lookup"><span data-stu-id="4abdc-383">These placeholders, if present in the `BodyFileName` file, will be replaced with the just-created user's name and password.</span></span>

> [!NOTE]
> <span data-ttu-id="4abdc-384">La propiedad `MailDefinition` del control `CreateUserWizard` solo especifica detalles sobre el mensaje de correo electrónico que se envía cuando se crea una nueva cuenta.</span><span class="sxs-lookup"><span data-stu-id="4abdc-384">The `CreateUserWizard` control's `MailDefinition` property just specifies details about the email message that is sent when a new account is created.</span></span> <span data-ttu-id="4abdc-385">No incluye detalles sobre cómo se envía realmente el mensaje de correo electrónico (es decir, si se usa un servidor SMTP o un directorio de almacenamiento de correo, cualquier información de autenticación, etc.).</span><span class="sxs-lookup"><span data-stu-id="4abdc-385">It does not include any details on how the email message is actually sent (that is, whether an SMTP server or mail drop directory is used, any authentication information, and so on).</span></span> <span data-ttu-id="4abdc-386">Estos detalles de bajo nivel deben definirse en la sección `<system.net>` en `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-386">These low-level details need to be defined in the `<system.net>` section in `Web.config`.</span></span> <span data-ttu-id="4abdc-387">Para obtener más información sobre estas opciones de configuración y sobre el envío de correo electrónico desde ASP.NET 2,0 en general, consulte las [preguntas más frecuentes en SystemNetMail.com](http://www.systemnetmail.com/) y mi artículo, [envío de correo electrónico en ASP.net 2,0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="4abdc-387">For more information on these configuration settings and on sending email from ASP.NET 2.0 in general, refer to the [FAQs at SystemNetMail.com](http://www.systemnetmail.com/) and my article, [Sending Email in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx).</span></span>

### <a name="extending-the-createuserwizards-behavior-using-event-handlers"></a><span data-ttu-id="4abdc-388">Extender el comportamiento de CreateUserWizard mediante controladores de eventos</span><span class="sxs-lookup"><span data-stu-id="4abdc-388">Extending the CreateUserWizard's Behavior Using Event Handlers</span></span>

<span data-ttu-id="4abdc-389">El control CreateUserWizard genera una serie de eventos durante su flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="4abdc-389">The CreateUserWizard control raises a number of events during its workflow.</span></span> <span data-ttu-id="4abdc-390">Por ejemplo, después de que un visitante escriba su nombre de usuario, contraseña y otra información pertinente y haga clic en el botón crear usuario, el control CreateUserWizard genera su [evento`CreatingUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span><span class="sxs-lookup"><span data-stu-id="4abdc-390">For example, after a visitor enters their username, password, and other pertinent information and clicks the Create User button, the CreateUserWizard control raises its [`CreatingUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.creatinguser.aspx).</span></span> <span data-ttu-id="4abdc-391">Si se produce un problema durante el proceso de creación, se desencadena el [evento`CreateUserError`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) . sin embargo, si el usuario se crea correctamente, se genera el [evento`CreatedUser`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) .</span><span class="sxs-lookup"><span data-stu-id="4abdc-391">If there is a problem during the create process, the [`CreateUserError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createusererror.aspx) is fired; however, if the user is successfully created, then the [`CreatedUser` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.createduser.aspx) is raised.</span></span> <span data-ttu-id="4abdc-392">Hay eventos de control CreateUserWizard adicionales que se generan, pero estos son los tres más alemanes.</span><span class="sxs-lookup"><span data-stu-id="4abdc-392">There are additional CreateUserWizard control events that get raised, but these are the three most germane ones.</span></span>

<span data-ttu-id="4abdc-393">En algunos escenarios, es posible que quieramos pulsar en el flujo de trabajo de CreateUserWizard, que podemos hacer mediante la creación de un controlador de eventos para el evento adecuado.</span><span class="sxs-lookup"><span data-stu-id="4abdc-393">In certain scenarios we may want to tap into the CreateUserWizard workflow, which we can do by creating an event handler for the appropriate event.</span></span> <span data-ttu-id="4abdc-394">Para ilustrar esto, vamos a mejorar el `RegisterUser` control CreateUserWizard para incluir una validación personalizada en el nombre de usuario y la contraseña.</span><span class="sxs-lookup"><span data-stu-id="4abdc-394">To illustrate this, let's enhance the `RegisterUser` CreateUserWizard control to include some custom validation on the username and password.</span></span> <span data-ttu-id="4abdc-395">En concreto, vamos a mejorar nuestro CreateUserWizard para que los nombres de usuario no puedan contener espacios iniciales o finales y el nombre de usuario no pueda aparecer en ninguna parte de la contraseña.</span><span class="sxs-lookup"><span data-stu-id="4abdc-395">In particular, let's enhance our CreateUserWizard so that usernames cannot contain leading or trailing spaces and the username cannot appear anywhere in the password.</span></span> <span data-ttu-id="4abdc-396">En Resumen, queremos impedir que alguien cree un nombre de usuario como "Scott", o que tenga una combinación de nombre de usuario/contraseña como Scott y Scott. 1234.</span><span class="sxs-lookup"><span data-stu-id="4abdc-396">In short, we want to prevent someone from creating a username like "Scott ", or having a username/password combination like Scott and Scott.1234 .</span></span>

<span data-ttu-id="4abdc-397">Para ello, crearemos un controlador de eventos para el evento `CreatingUser` con el fin de realizar las comprobaciones de validación adicionales.</span><span class="sxs-lookup"><span data-stu-id="4abdc-397">To accomplish this we will create an event handler for the `CreatingUser` event to perform our extra validation checks.</span></span> <span data-ttu-id="4abdc-398">Si los datos proporcionados no son válidos, es necesario cancelar el proceso de creación.</span><span class="sxs-lookup"><span data-stu-id="4abdc-398">If the supplied data is not valid we need to cancel the creation process.</span></span> <span data-ttu-id="4abdc-399">También es necesario agregar un control Web de etiqueta a la página para mostrar un mensaje que explica que el nombre de usuario o la contraseña no son válidos.</span><span class="sxs-lookup"><span data-stu-id="4abdc-399">We also need to add a Label Web control to the page to display a message explaining that the username or password is invalid.</span></span> <span data-ttu-id="4abdc-400">Comience agregando un control etiqueta debajo del control CreateUserWizard, estableciendo su propiedad `ID` en `InvalidUserNameOrPasswordMessage` y su propiedad `ForeColor` en `Red`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-400">Start by adding a Label control beneath the CreateUserWizard control, setting its `ID` property to `InvalidUserNameOrPasswordMessage` and its `ForeColor` property to `Red`.</span></span> <span data-ttu-id="4abdc-401">Desactive su propiedad `Text` y establezca sus propiedades `EnableViewState` y `Visible` en false.</span><span class="sxs-lookup"><span data-stu-id="4abdc-401">Clear out its `Text` property and set its `EnableViewState` and `Visible` properties to False.</span></span>

[!code-aspx[Main](creating-user-accounts-vb/samples/sample7.aspx)]

<span data-ttu-id="4abdc-402">A continuación, cree un controlador de eventos para el evento `CreatingUser` del control CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="4abdc-402">Next, create an event handler for the CreateUserWizard control's `CreatingUser` event.</span></span> <span data-ttu-id="4abdc-403">Para crear un controlador de eventos, seleccione el control en el diseñador y, a continuación, vaya a la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="4abdc-403">To create an event handler, select the control in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="4abdc-404">Desde allí, haga clic en el icono de rayo y, a continuación, haga doble clic en el evento adecuado para crear el controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="4abdc-404">From there, click on the lightning bolt icon and then double-click the appropriate event to create the event handler.</span></span>

<span data-ttu-id="4abdc-405">Agregue el código siguiente al controlador de eventos `CreatingUser` :</span><span class="sxs-lookup"><span data-stu-id="4abdc-405">Add the following code to the `CreatingUser` event handler:</span></span>

[!code-vb[Main](creating-user-accounts-vb/samples/sample8.vb)]

<span data-ttu-id="4abdc-406">Tenga en cuenta que el nombre de usuario y la contraseña especificados en el control CreateUserWizard están disponibles a través de sus propiedades [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) y [`Password`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx), respectivamente.</span><span class="sxs-lookup"><span data-stu-id="4abdc-406">Note that the username and password entered into the CreateUserWizard control are available through its [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.createuserwizard.password.aspx), respectively.</span></span> <span data-ttu-id="4abdc-407">Usamos estas propiedades en el controlador de eventos anterior para determinar si el nombre de usuario proporcionado contiene espacios iniciales o finales y si el nombre de usuario se encuentra dentro de la contraseña.</span><span class="sxs-lookup"><span data-stu-id="4abdc-407">We use these properties in the above event handler to determine whether the supplied username contains leading or trailing spaces and whether the username is found within the password.</span></span> <span data-ttu-id="4abdc-408">Si se cumple alguna de estas condiciones, se muestra un mensaje de error en la etiqueta de `InvalidUserNameOrPasswordMessage` y la propiedad `e.Cancel` del controlador de eventos se establece en `True`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-408">If either of these conditions is met, an error message is displayed in the `InvalidUserNameOrPasswordMessage` Label and the event handler's `e.Cancel` property is set to `True`.</span></span> <span data-ttu-id="4abdc-409">Si `e.Cancel` se establece en `True`, el valor de CreateUserWizard reduce el flujo de trabajo, con lo que se cancela el proceso de creación de la cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-409">If `e.Cancel` is set to `True`, the CreateUserWizard short-circuits its workflow, effectively cancelling the user account creation process.</span></span>

<span data-ttu-id="4abdc-410">En la figura 15 se muestra una captura de pantalla de `CreatingUserAccounts.aspx` cuando el usuario escribe un nombre de usuario con espacios iniciales.</span><span class="sxs-lookup"><span data-stu-id="4abdc-410">Figure 15 shows a screen shot of `CreatingUserAccounts.aspx` when the user enters a username with leading spaces.</span></span>

<span data-ttu-id="4abdc-411">[no se permiten los nombres de usuario ![con espacios iniciales o finales.](creating-user-accounts-vb/_static/image44.png)](creating-user-accounts-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="4abdc-411">[![Usernames with Leading or Trailing Spaces are not Permitted](creating-user-accounts-vb/_static/image44.png)](creating-user-accounts-vb/_static/image43.png)</span></span>

<span data-ttu-id="4abdc-412">**Figura 15**: No se permiten los nombres de usuario con espacios iniciales o finales ([haga clic para ver la imagen de tamaño completo](creating-user-accounts-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="4abdc-412">**Figure 15**: Usernames with Leading or Trailing Spaces are not Permitted ([Click to view full-size image](creating-user-accounts-vb/_static/image45.png))</span></span>

> [!NOTE]
> <span data-ttu-id="4abdc-413">Veremos un ejemplo del uso del evento `CreatedUser` del control CreateUserWizard en el *<a id="_msoanchor_11"></a>[tutorial sobre el almacenamiento de información de usuario adicional](storing-additional-user-information-vb.md)* .</span><span class="sxs-lookup"><span data-stu-id="4abdc-413">We will see an example of using the CreateUserWizard control's `CreatedUser` event in the *<a id="_msoanchor_11"></a>[Storing Additional User Information](storing-additional-user-information-vb.md)* tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="4abdc-414">Resumen</span><span class="sxs-lookup"><span data-stu-id="4abdc-414">Summary</span></span>

<span data-ttu-id="4abdc-415">El método `CreateUser` de la clase `Membership` crea una nueva cuenta de usuario en el marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-415">The `Membership` class's `CreateUser` method creates a new user account in the Membership framework.</span></span> <span data-ttu-id="4abdc-416">Para ello, delega la llamada al proveedor de pertenencia configurado.</span><span class="sxs-lookup"><span data-stu-id="4abdc-416">It does so by delegating the call to the configured Membership provider.</span></span> <span data-ttu-id="4abdc-417">En el caso del `SqlMembershipProvider`, el método `CreateUser` agrega un registro a las tablas de base de datos `aspnet_Users` y `aspnet_Membership`.</span><span class="sxs-lookup"><span data-stu-id="4abdc-417">In the case of the `SqlMembershipProvider`, the `CreateUser` method adds a record to the `aspnet_Users` and `aspnet_Membership` database tables.</span></span>

<span data-ttu-id="4abdc-418">Aunque se pueden crear nuevas cuentas de usuario mediante programación (como vimos en el paso 5), un enfoque más rápido y sencillo es usar el control CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="4abdc-418">While new user accounts can be created programmatically (as we saw in Step 5), a faster and easier approach is to use the CreateUserWizard control.</span></span> <span data-ttu-id="4abdc-419">Este control representa una interfaz de usuario de varios pasos para recopilar información de usuario y crear un nuevo usuario en el marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-419">This control renders a multi-step user interface for collecting user information and creating a new user in the Membership framework.</span></span> <span data-ttu-id="4abdc-420">En segundo plano, este control usa el mismo método `Membership.CreateUser` que se ha examinado en el paso 5, pero el control crea la interfaz de usuario, los controles de validación y responde a los errores de creación de cuentas de usuario sin tener que escribir una y después de código.</span><span class="sxs-lookup"><span data-stu-id="4abdc-420">Underneath the covers, this control uses the same `Membership.CreateUser` method as examined in Step 5, but the control creates the user interface, validation controls, and responds to user account creation errors without having to write a lick of code.</span></span>

<span data-ttu-id="4abdc-421">En este momento, tenemos la funcionalidad para crear nuevas cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="4abdc-421">At this point we have the functionality in place to create new user accounts.</span></span> <span data-ttu-id="4abdc-422">Sin embargo, la página de inicio de sesión todavía se está validando con las credenciales codificadas de forma rígida que hemos especificado de nuevo en el segundo tutorial.</span><span class="sxs-lookup"><span data-stu-id="4abdc-422">However, the login page still is validating against those hard-coded credentials we specified back in the second tutorial.</span></span> <span data-ttu-id="4abdc-423">En el <a id="_msoanchor_12"> </a> [siguiente tutorial](validating-user-credentials-against-the-membership-user-store-vb.md) , actualizaremos `Login.aspx` para validar las credenciales proporcionadas por el usuario en el marco de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="4abdc-423">In the <a id="_msoanchor_12"></a>[next tutorial](validating-user-credentials-against-the-membership-user-store-vb.md) we will update `Login.aspx` to validate the user's supplied credentials against the Membership framework.</span></span>

<span data-ttu-id="4abdc-424">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="4abdc-424">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="4abdc-425">Información adicional</span><span class="sxs-lookup"><span data-stu-id="4abdc-425">Further Reading</span></span>

<span data-ttu-id="4abdc-426">Para obtener más información sobre los temas descritos en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="4abdc-426">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="4abdc-427">`CreateUser` documentación técnica</span><span class="sxs-lookup"><span data-stu-id="4abdc-427">`CreateUser` Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.security.membershipprovider.createuser.aspx)
- [<span data-ttu-id="4abdc-428">Información general sobre el control CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="4abdc-428">CreateUserWizard Control Overview</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/login/createuserwizard.aspx)
- [<span data-ttu-id="4abdc-429">Crear un proveedor de mapa del sitio basado en el sistema de archivos</span><span class="sxs-lookup"><span data-stu-id="4abdc-429">Creating a File System-Based Site Map Provider</span></span>](http://aspnet.4guysfromrolla.com/articles/020106-1.aspx)
- [<span data-ttu-id="4abdc-430">Creación de una interfaz de usuario paso a paso con el control del asistente de ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="4abdc-430">Creating a Step-by-Step User Interface with the ASP.NET 2.0 Wizard Control</span></span>](http://aspnet.4guysfromrolla.com/articles/061406-1.aspx)
- [<span data-ttu-id="4abdc-431">Examinar la navegación del sitio de ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="4abdc-431">Examining ASP.NET 2.0's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="4abdc-432">Páginas maestras y navegación del sitio</span><span class="sxs-lookup"><span data-stu-id="4abdc-432">Master Pages and Site Navigation</span></span>](https://asp.net/learn/data-access/tutorial-03-vb.aspx)
- [<span data-ttu-id="4abdc-433">El proveedor del mapa del sitio de SQL que ha estado esperando</span><span class="sxs-lookup"><span data-stu-id="4abdc-433">The SQL Site Map Provider You've Been Waiting For</span></span>](https://msdn.microsoft.com/msdnmag/issues/06/02/WickedCode/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="4abdc-434">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="4abdc-434">About the Author</span></span>

<span data-ttu-id="4abdc-435">Scott Mitchell, autor de varios libros de ASP/ASP. NET y fundador de 4GuysFromRolla.com, ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="4abdc-435">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4abdc-436">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="4abdc-436">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4abdc-437">Su último libro es *[SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="4abdc-437">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="4abdc-438">Se puede acceder a Scott en [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) o a través de su blog en [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="4abdc-438">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="4abdc-439">Agradecimiento especial a</span><span class="sxs-lookup"><span data-stu-id="4abdc-439">Special Thanks To</span></span>

<span data-ttu-id="4abdc-440">Muchos revisores útiles revisaron esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="4abdc-440">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="4abdc-441">El revisor responsable de este tutorial era Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="4abdc-441">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="4abdc-442">¿Está interesado en revisar los próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="4abdc-442">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4abdc-443">En caso afirmativo, suéltelo en [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span><span class="sxs-lookup"><span data-stu-id="4abdc-443">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4abdc-444">[Anterior](creating-the-membership-schema-in-sql-server-vb.md)
> [Siguiente](validating-user-credentials-against-the-membership-user-store-vb.md)</span><span class="sxs-lookup"><span data-stu-id="4abdc-444">[Previous](creating-the-membership-schema-in-sql-server-vb.md)
[Next](validating-user-credentials-against-the-membership-user-store-vb.md)</span></span>

---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments
title: Implementar bases de datos de pertenencia en entornos empresariales | Microsoft Docs
author: jrjlee
description: En este tema se explican las consideraciones y los desafíos clave que debe superar al aprovisionar las bases de datos de servicios de aplicaciones de ASP.NET (más comunes...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 3cf765df-d311-4f68-a295-c9685ceea830
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments
msc.type: authoredcontent
ms.openlocfilehash: 50f49af502b75aa5ad52756a76a5e7340aca53f7
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78422161"
---
# <a name="deploying-membership-databases-to-enterprise-environments"></a><span data-ttu-id="c8f54-103">Implementar bases de datos de pertenencia en entornos empresariales</span><span class="sxs-lookup"><span data-stu-id="c8f54-103">Deploying Membership Databases to Enterprise Environments</span></span>

<span data-ttu-id="c8f54-104">por [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="c8f54-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="c8f54-105">Descargar PDF</span><span class="sxs-lookup"><span data-stu-id="c8f54-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="c8f54-106">En este tema se explican las consideraciones y los desafíos clave que debe superar al aprovisionar las bases de datos de servicios de aplicaciones de ASP.NET (más conocidas como bases de datos de pertenencia) en entornos de prueba, ensayo o producción.</span><span class="sxs-lookup"><span data-stu-id="c8f54-106">This topic explains the key considerations and challenges you'll need to overcome when you provision ASP.NET application services databases (more commonly referred to as membership databases) in test, staging, or production environments.</span></span> <span data-ttu-id="c8f54-107">También se describen los métodos que puede usar para cumplir estos desafíos.</span><span class="sxs-lookup"><span data-stu-id="c8f54-107">It also describes approaches you can use to meet these challenges.</span></span>

<span data-ttu-id="c8f54-108">Este tema forma parte de una serie de tutoriales basados en los requisitos de implementación empresarial de una empresa ficticia denominada Fabrikam, Inc. En esta serie de tutoriales se&#x2014;usa una solución de ejemplo de la&#x2014; [solución Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)para representar una aplicación web con un nivel de complejidad realista, como una aplicación ASP.NET MVC 3, un servicio Windows Communication Foundation (WCF) y un proyecto de base de datos.</span><span class="sxs-lookup"><span data-stu-id="c8f54-108">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="c8f54-109">El método de implementación que se encuentra en el corazón de estos tutoriales se basa en el enfoque de archivo de proyecto dividido que se describe en [Descripción del archivo de proyecto](../web-deployment-in-the-enterprise/understanding-the-project-file.md), en el&#x2014;que el proceso de compilación se controla mediante dos archivos de proyecto que contiene instrucciones de compilación que se aplican a cada entorno de destino y uno que contiene la configuración de compilación e implementación específica del entorno.</span><span class="sxs-lookup"><span data-stu-id="c8f54-109">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="c8f54-110">En tiempo de compilación, el archivo de proyecto específico del entorno se combina en el archivo de proyecto independiente del entorno para formar un conjunto completo de instrucciones de compilación.</span><span class="sxs-lookup"><span data-stu-id="c8f54-110">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="what-are-the-issues-when-you-deploy-a-membership-database"></a><span data-ttu-id="c8f54-111">¿Cuáles son los problemas que se producen al implementar una base de datos de pertenencia?</span><span class="sxs-lookup"><span data-stu-id="c8f54-111">What Are the Issues When You Deploy a Membership Database?</span></span>

<span data-ttu-id="c8f54-112">En la mayoría de los casos, al diseñar una estrategia de implementación para una base de datos, lo primero que debe tener en cuenta es qué datos desea implementar.</span><span class="sxs-lookup"><span data-stu-id="c8f54-112">In most cases, when you devise a deployment strategy for a database, the first thing you need to consider is what data you want to deploy.</span></span> <span data-ttu-id="c8f54-113">En un entorno de desarrollo o de prueba, es posible que desee implementar datos de cuentas de usuario para facilitar las pruebas rápidas y sencillas.</span><span class="sxs-lookup"><span data-stu-id="c8f54-113">In a development or test environment, you might want to deploy user account data to facilitate quick and easy testing.</span></span> <span data-ttu-id="c8f54-114">En un entorno de ensayo o de producción, es muy poco probable que desee implementar datos de cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="c8f54-114">In a staging or production environment, it's very unlikely that you'd want to deploy user account data.</span></span>

<span data-ttu-id="c8f54-115">Desafortunadamente, las bases de datos de pertenencia a ASP.NET presentan algunos desafíos específicos que hacen que esta decisión sea mucho más compleja:</span><span class="sxs-lookup"><span data-stu-id="c8f54-115">Unfortunately, ASP.NET membership databases introduce some specific challenges that make this decision a lot more complex:</span></span>

- <span data-ttu-id="c8f54-116">Una implementación de solo esquema dejará la base de datos de pertenencia en un estado no operativo.</span><span class="sxs-lookup"><span data-stu-id="c8f54-116">A schema-only deployment will leave the membership database in a non-operational state.</span></span> <span data-ttu-id="c8f54-117">Esto se debe a que la base de datos de pertenencia incluye algunos datos de configuración (en la tabla **SchemaVersions de aspnet\_** ) que la base de datos necesita para funcionar.</span><span class="sxs-lookup"><span data-stu-id="c8f54-117">This is because the membership database includes some configuration data (in the **aspnet\_SchemaVersions** table) that the database requires in order to function.</span></span> <span data-ttu-id="c8f54-118">Como tal, si realiza una implementación solo de esquema de la base de datos de pertenencia para excluir los datos de la cuenta de usuario, deberá ejecutar un script posterior a la implementación para agregar los datos de configuración esenciales.</span><span class="sxs-lookup"><span data-stu-id="c8f54-118">As such, if you perform a schema-only deployment of your membership database in order to exclude user account data, you'll need to run a post-deployment script to add the essential configuration data.</span></span>
- <span data-ttu-id="c8f54-119">En función de cómo esté configurada la base de datos de pertenencia, el proveedor de pertenencia puede usar la clave de equipo para cifrar las contraseñas y almacenarlas en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="c8f54-119">Depending on how your membership database is configured, the membership provider may use the machine key to encrypt passwords and store them in the database.</span></span> <span data-ttu-id="c8f54-120">En este caso, cualquier dato de cuenta de usuario que implemente con la base de datos dejará de ser utilizable en el servidor de destino.</span><span class="sxs-lookup"><span data-stu-id="c8f54-120">In this case, any user account data you deploy with the database will become unusable on the destination server.</span></span> <span data-ttu-id="c8f54-121">Por esta razón, la implementación de datos de cuentas de usuario no es un escenario admitido.</span><span class="sxs-lookup"><span data-stu-id="c8f54-121">For this reason, deploying user account data is not a supported scenario.</span></span>

## <a name="choosing-a-membership-database-strategy"></a><span data-ttu-id="c8f54-122">Elegir una estrategia de base de datos de pertenencia</span><span class="sxs-lookup"><span data-stu-id="c8f54-122">Choosing a Membership Database Strategy</span></span>

<span data-ttu-id="c8f54-123">Siga estas instrucciones cuando elija cómo aprovisionar una base de datos de pertenencia en un entorno de servidor empresarial:</span><span class="sxs-lookup"><span data-stu-id="c8f54-123">Use these guidelines when you choose how to provision a membership database in an enterprise server environment:</span></span>

- <span data-ttu-id="c8f54-124">Siempre que sea posible, no implemente las bases de datos de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="c8f54-124">Wherever possible, do not deploy membership databases.</span></span> <span data-ttu-id="c8f54-125">En su lugar, cree la base de datos de pertenencia manualmente en el servidor de base de datos de destino.</span><span class="sxs-lookup"><span data-stu-id="c8f54-125">Instead, create the membership database manually on the target database server.</span></span> <span data-ttu-id="c8f54-126">Si no ha personalizado el esquema de la base de datos de pertenencia, puede crear simplemente uno en situ en el destino mediante la [herramienta de registro de SQL Server ASP.net (aspnet\_regsql. exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="c8f54-126">If you haven't customized your membership database schema, you can simply create a new one in situ at the destination using the [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span></span>
- <span data-ttu-id="c8f54-127">Si no tiene ninguna opción, pero para implementar una base&#x2014;de datos de pertenencia por ejemplo, si ha realizado modificaciones extensas en el esquema&#x2014;de la base de datos, debe realizar una implementación solo de esquema de la base de datos de pertenencia, excluir los datos de la cuenta de usuario y, a continuación, ejecutar un script posterior a la implementación para agregar los datos de configuración necesarios.</span><span class="sxs-lookup"><span data-stu-id="c8f54-127">If you have no option but to deploy a membership database&#x2014;for example, if you've made extensive modifications to the database schema&#x2014;you should perform a schema-only deployment of the membership database, to exclude user account data, and then run a post-deployment script to add any required configuration data.</span></span> <span data-ttu-id="c8f54-128">Puede encontrar una amplia orientación sobre estos enfoques en [Cómo: implementar la base de datos de pertenencia de ASP.net sin incluir cuentas de usuario](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="c8f54-128">You can find broad guidance on these approaches in [How to: Deploy the ASP.NET Membership Database Without Including User Accounts](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span></span>

<span data-ttu-id="c8f54-129">Es importante recordar que *es probable que el esquema de la base de datos de pertenencia sea bastante estático*.</span><span class="sxs-lookup"><span data-stu-id="c8f54-129">It's important to remember that *the schema of your membership database is likely to be fairly static*.</span></span> <span data-ttu-id="c8f54-130">Incluso si ha personalizado la base de datos de pertenencia, no es probable que necesite actualizar el esquema de forma periódica&#x2014;, por lo que no va a cambiar con la misma frecuencia que el código en una aplicación web o un proyecto de base de datos.</span><span class="sxs-lookup"><span data-stu-id="c8f54-130">Even if you've customized the membership database, it's unlikely that you'll need to update the schema on a regular basis&#x2014;it's not going to change with the same frequency as the code in a web application or a database project.</span></span> <span data-ttu-id="c8f54-131">Como tal, no es necesario incluir la base de datos de pertenencia en ningún proceso de implementación automatizado o de un solo paso.</span><span class="sxs-lookup"><span data-stu-id="c8f54-131">As such, you shouldn't need to include the membership database in any automated or single-step deployment processes.</span></span>

## <a name="using-vsdbcmd-to-update-a-membership-database-schema"></a><span data-ttu-id="c8f54-132">Usar VSDBCMD para actualizar un esquema de la base de datos de pertenencia</span><span class="sxs-lookup"><span data-stu-id="c8f54-132">Using VSDBCMD to Update a Membership Database Schema</span></span>

<span data-ttu-id="c8f54-133">Si modifica la estructura de la base de datos de pertenencia después de la primera implementación, es posible que no desee usar la herramienta de implementación web (Web Deploy) de Internet Information Services (IIS) para volver a implementar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="c8f54-133">If you modify the structure of your membership database after your first deployment, you may not want to use the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to redeploy the database.</span></span> <span data-ttu-id="c8f54-134">La funcionalidad de implementación de base de datos de Web Deploy no incluye la capacidad de realizar actualizaciones diferenciales en una base de datos&#x2014;de destino, Web deploy debe quitar y volver a crear la base de datos.</span><span class="sxs-lookup"><span data-stu-id="c8f54-134">The database deployment functionality in Web Deploy doesn't include the capability to make differential updates to a destination database&#x2014;instead, Web Deploy must drop and re-create the database.</span></span> <span data-ttu-id="c8f54-135">Esto significa que se pierden los datos de cuentas de usuario existentes, lo que normalmente no es deseable en entornos de ensayo o de producción.</span><span class="sxs-lookup"><span data-stu-id="c8f54-135">This means that you lose any existing user account data, which is typically undesirable in staging or production environments.</span></span>

<span data-ttu-id="c8f54-136">La alternativa es usar la utilidad VSDBCMD para actualizar el esquema de la base de datos de destino.</span><span class="sxs-lookup"><span data-stu-id="c8f54-136">The alternative is to use the VSDBCMD utility to update the schema of your destination database.</span></span> <span data-ttu-id="c8f54-137">VSDBCMD incluye dos capacidades importantes.</span><span class="sxs-lookup"><span data-stu-id="c8f54-137">VSDBCMD includes two important capabilities.</span></span> <span data-ttu-id="c8f54-138">En primer lugar, puede importar el esquema de una base de datos existente en un archivo. dbschema.</span><span class="sxs-lookup"><span data-stu-id="c8f54-138">First, it can import the schema of an existing database into a .dbschema file.</span></span> <span data-ttu-id="c8f54-139">En segundo lugar, puede implementar un archivo. dbschema en una base de datos existente como una actualización diferencial, lo que significa que solo realiza los cambios necesarios para actualizar la base de datos de destino y no pierde ningún dato.</span><span class="sxs-lookup"><span data-stu-id="c8f54-139">Second, it can deploy a .dbschema file to an existing database as a differential update, which means that it only makes the changes required to bring the target database up to date and you don't lose any data.</span></span>

<span data-ttu-id="c8f54-140">Puede usar estos pasos de alto nivel para actualizar un esquema de la base de datos de pertenencia:</span><span class="sxs-lookup"><span data-stu-id="c8f54-140">You can use these high-level steps to update a membership database schema:</span></span>

1. <span data-ttu-id="c8f54-141">Use la acción de **importación** de VSDBCMD para generar un archivo. dbschema para la base de datos de pertenencia de origen.</span><span class="sxs-lookup"><span data-stu-id="c8f54-141">Use the VSDBCMD **Import** action to generate a .dbschema file for your source membership database.</span></span> <span data-ttu-id="c8f54-142">Este procedimiento se describe en [Cómo: importar un esquema desde un símbolo del sistema](https://msdn.microsoft.com/library/dd172135.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8f54-142">This procedure is described in [How to: Import a Schema from a Command Prompt](https://msdn.microsoft.com/library/dd172135.aspx).</span></span>
2. <span data-ttu-id="c8f54-143">Use la acción de **implementación** de VSDBCMD para implementar el archivo. dbschema en la base de datos de pertenencia de destino.</span><span class="sxs-lookup"><span data-stu-id="c8f54-143">Use the VSDBCMD **Deploy** action to deploy the .dbschema file to your destination membership database.</span></span> <span data-ttu-id="c8f54-144">Este procedimiento se describe en [referencia de línea de comandos para VSDBCMD. EXE (implementación y importación de esquema)](https://msdn.microsoft.com/library/dd193283.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8f54-144">This procedure is described in [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx).</span></span>

## <a name="conclusion"></a><span data-ttu-id="c8f54-145">Conclusión</span><span class="sxs-lookup"><span data-stu-id="c8f54-145">Conclusion</span></span>

<span data-ttu-id="c8f54-146">En este tema se describen algunos de los desafíos a los que puede enfrentarse cuando necesita aprovisionar bases de datos de pertenencia a ASP.NET en varios entornos de destino.</span><span class="sxs-lookup"><span data-stu-id="c8f54-146">This topic described some of the challenges you may face when you need to provision ASP.NET membership databases in various target environments.</span></span> <span data-ttu-id="c8f54-147">En concreto, se explica por qué las implementaciones solo de esquema dejarán la base de datos de pertenencia en un estado no operativo y por qué no se admite la implementación de datos de cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="c8f54-147">In particular, it explained why schema-only deployments will leave the membership database in a non-operational state and why deploying user account data is not supported.</span></span> <span data-ttu-id="c8f54-148">En el tema también se presentan instrucciones para aprovisionar, implementar y actualizar bases de datos de pertenencia en diferentes escenarios.</span><span class="sxs-lookup"><span data-stu-id="c8f54-148">The topic also presented guidance on how to provision, deploy, and update membership databases in different scenarios.</span></span>

## <a name="further-reading"></a><span data-ttu-id="c8f54-149">Información adicional</span><span class="sxs-lookup"><span data-stu-id="c8f54-149">Further Reading</span></span>

<span data-ttu-id="c8f54-150">Para obtener más instrucciones y ejemplos de cómo usar VSDBCMD, vea [referencia de la línea de comandos para VSDBCMD. EXE (implementación y importación de esquema)](https://msdn.microsoft.com/library/dd193283.aspx) y [Cómo: importar un esquema desde un símbolo del sistema](https://msdn.microsoft.com/library/dd172135.aspx).</span><span class="sxs-lookup"><span data-stu-id="c8f54-150">For more guidance and examples of how to use VSDBCMD, see [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx) and [How to: Import a Schema from a Command Prompt](https://msdn.microsoft.com/library/dd172135.aspx).</span></span> <span data-ttu-id="c8f54-151">Para obtener más información sobre el uso de ASPNET\_regsql. exe para crear bases de datos de pertenencia, vea [ASP.NET SQL Server registration Tool (aspnet\_regsql. exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="c8f54-151">For more information on using aspnet\_regsql.exe to create membership databases, see [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span></span> <span data-ttu-id="c8f54-152">Para obtener instrucciones generales sobre la implementación de bases de datos de pertenencia, consulte [Cómo: implementar la base de datos de pertenencia de ASP.net sin incluir cuentas de usuario](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="c8f54-152">For more general guidance on deploying membership databases, see [How to: Deploy the ASP.NET Membership Database Without Including User Accounts](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c8f54-153">[Anterior](deploying-database-role-memberships-to-test-environments.md)
> [Siguiente](excluding-files-and-folders-from-deployment.md)</span><span class="sxs-lookup"><span data-stu-id="c8f54-153">[Previous](deploying-database-role-memberships-to-test-environments.md)
[Next](excluding-files-and-folders-from-deployment.md)</span></span>

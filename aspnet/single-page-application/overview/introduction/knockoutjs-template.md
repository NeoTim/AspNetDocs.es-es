---
uid: single-page-application/overview/introduction/knockoutjs-template
title: 'Aplicación de una sola página: plantilla KnockoutJS | Microsoft Docs'
author: MikeWasson
description: Plantilla de cobertura
ms.author: riande
ms.date: 01/30/2013
ms.assetid: f9c07af0-4b20-4b08-af8f-47fc3df169a2
msc.legacyurl: /single-page-application/overview/introduction/knockoutjs-template
msc.type: authoredcontent
ms.openlocfilehash: 3a551db1caa9636eb7f2e04c287d3ef371263584
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78467323"
---
# <a name="single-page-application-knockoutjs-template"></a><span data-ttu-id="a5cf7-103">Aplicación de una sola página: plantilla KnockoutJS</span><span class="sxs-lookup"><span data-stu-id="a5cf7-103">Single Page Application: KnockoutJS template</span></span>

<span data-ttu-id="a5cf7-104">por [Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="a5cf7-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

> <span data-ttu-id="a5cf7-105">La plantilla de MVC de cobertura es parte de ASP.NET and Web Tools 2012,2</span><span class="sxs-lookup"><span data-stu-id="a5cf7-105">The Knockout MVC Template is part of ASP.NET and Web Tools 2012.2</span></span>
> 
> [<span data-ttu-id="a5cf7-106">Descargar ASP.NET and Web Tools 2012,2</span><span class="sxs-lookup"><span data-stu-id="a5cf7-106">Download ASP.NET and Web Tools 2012.2</span></span>](https://go.microsoft.com/fwlink/?LinkId=282650)

<span data-ttu-id="a5cf7-107">La actualización ASP.NET and Web Tools 2012,2 incluye una plantilla de aplicación de una sola página (SPA) para ASP.NET MVC 4.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-107">The ASP.NET and Web Tools 2012.2 update includes a Single-Page Application (SPA) template for ASP.NET MVC 4.</span></span> <span data-ttu-id="a5cf7-108">Esta plantilla está diseñada para empezar a crear rápidamente aplicaciones Web interactivas del lado cliente.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-108">This template is designed to get you started quickly building interactive client-side web apps.</span></span>

<span data-ttu-id="a5cf7-109">"Aplicación de una sola página" (SPA) es el término general para una aplicación web que carga una sola página HTML y, a continuación, actualiza la página dinámicamente, en lugar de cargar nuevas páginas.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-109">"Single-page application" (SPA) is the general term for a web application that loads a single HTML page and then updates the page dynamically, instead of loading new pages.</span></span> <span data-ttu-id="a5cf7-110">Después de la carga inicial de la página, el SPA se comunica con el servidor a través de solicitudes AJAX.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-110">After the initial page load, the SPA talks with the server through AJAX requests.</span></span>

![](knockoutjs-template/_static/image1.png)

<span data-ttu-id="a5cf7-111">AJAX no es nuevo, pero hoy en día hay marcos de JavaScript que facilitan la compilación y el mantenimiento de una aplicación de SPA sofisticada.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-111">AJAX is nothing new, but today there are JavaScript frameworks that make it easier to build and maintain a large sophisticated SPA application.</span></span> <span data-ttu-id="a5cf7-112">Además, HTML 5 y CSS3 facilitan la creación de interfaces de IU enriquecidas.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-112">Also, HTML 5 and CSS3 are making it easier to create rich UIs.</span></span>

<span data-ttu-id="a5cf7-113">Para empezar, la plantilla de SPA crea una aplicación de ejemplo "lista de tareas pendientes".</span><span class="sxs-lookup"><span data-stu-id="a5cf7-113">To get you started, the SPA template creates a sample "To-do list" application.</span></span> <span data-ttu-id="a5cf7-114">En este tutorial, realizaremos una visita guiada por la plantilla.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-114">In this tutorial, we'll take a guided tour of the template.</span></span> <span data-ttu-id="a5cf7-115">En primer lugar, veremos la aplicación de lista de tareas pendientes y luego examinamos los elementos tecnológicos que lo hacen.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-115">First we'll look at the To-do list application itself, then examine the technology pieces that make it work.</span></span>

## <a name="create-a-new-spa-template-project"></a><span data-ttu-id="a5cf7-116">Crear un nuevo proyecto de plantilla de SPA</span><span class="sxs-lookup"><span data-stu-id="a5cf7-116">Create a New SPA Template Project</span></span>

<span data-ttu-id="a5cf7-117">Requisitos:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-117">Requirements:</span></span>

- <span data-ttu-id="a5cf7-118">Visual Studio 2012 o Visual Studio Express 2012 para Web</span><span class="sxs-lookup"><span data-stu-id="a5cf7-118">Visual Studio 2012 or Visual Studio Express 2012 for Web</span></span>
- <span data-ttu-id="a5cf7-119">ASP.NET Web Tools 2012,2 Update.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-119">ASP.NET Web Tools 2012.2 update.</span></span> <span data-ttu-id="a5cf7-120">Puede instalar la actualización [aquí](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-120">You can install the update [here](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span></span>

<span data-ttu-id="a5cf7-121">Inicie Visual Studio y seleccione **nuevo proyecto** en la página de inicio.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-121">Start Visual Studio and select **New Project** from the Start page.</span></span> <span data-ttu-id="a5cf7-122">O bien, en el menú **archivo** , seleccione **nuevo** y luego **proyecto**.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-122">Or, from the **File** menu, select **New** and then **Project**.</span></span>

<span data-ttu-id="a5cf7-123">En el panel **plantillas** , seleccione **plantillas instaladas** y expanda el nodo **Visual C#**  .</span><span class="sxs-lookup"><span data-stu-id="a5cf7-123">In the **Templates** pane, select **Installed Templates** and expand the **Visual C#** node.</span></span> <span data-ttu-id="a5cf7-124">En **Visual C#** , seleccione **Web**.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-124">Under **Visual C#**, select **Web**.</span></span> <span data-ttu-id="a5cf7-125">En la lista de plantillas de proyecto, seleccione **aplicación Web de ASP.NET MVC 4**.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-125">In the list of project templates, select **ASP.NET MVC 4 Web Application**.</span></span> <span data-ttu-id="a5cf7-126">Proporcione un nombre al proyecto y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-126">Name the project and click **OK**.</span></span>

![](knockoutjs-template/_static/image2.png)

<span data-ttu-id="a5cf7-127">En el Asistente para **nuevo proyecto** , seleccione **aplicación de una sola página**.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-127">In the **New Project** wizard, select **Single Page Application**.</span></span>

![](knockoutjs-template/_static/image3.png)

<span data-ttu-id="a5cf7-128">Presione F5 para compilar y ejecutar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-128">Press F5 to build and run the application.</span></span> <span data-ttu-id="a5cf7-129">Cuando la aplicación se ejecuta por primera vez, se muestra una pantalla de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-129">When the application first runs, it displays a login screen.</span></span>

![](knockoutjs-template/_static/image4.png)

<span data-ttu-id="a5cf7-130">Haga clic en el vínculo &quot;registrarse&quot; y crear un nuevo usuario.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-130">Click the &quot;Sign up&quot; link and create a new user.</span></span>

![](knockoutjs-template/_static/image5.png)

<span data-ttu-id="a5cf7-131">Después de iniciar sesión, la aplicación crea una lista de tareas predeterminada con dos elementos.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-131">After you log in, the application creates a default Todo list with two items.</span></span> <span data-ttu-id="a5cf7-132">Puede hacer clic en "Agregar lista de tareas" para agregar una nueva lista.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-132">You can click "Add Todo list" to add a new list.</span></span>

![](knockoutjs-template/_static/image6.png)

<span data-ttu-id="a5cf7-133">Cambiar el nombre de la lista, agregar elementos a la lista y desactivarla.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-133">Rename the list, add items to the list, and check them off.</span></span> <span data-ttu-id="a5cf7-134">También puede eliminar elementos o eliminar una lista completa.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-134">You can also delete items or delete an entire list.</span></span> <span data-ttu-id="a5cf7-135">Los cambios se conservan automáticamente en una base de datos del servidor (en realidad LocalDB, ya que se está ejecutando la aplicación localmente).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-135">The changes are automatically persisted to a database on the server (actually LocalDB at this point, because you are running the application locally).</span></span>

![](knockoutjs-template/_static/image7.png)

## <a name="architecture-of-the-spa-template"></a><span data-ttu-id="a5cf7-136">Arquitectura de la plantilla de SPA</span><span class="sxs-lookup"><span data-stu-id="a5cf7-136">Architecture of the SPA Template</span></span>

<span data-ttu-id="a5cf7-137">Este diagrama muestra los principales bloques de creación de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-137">This diagram shows the main building blocks for the application.</span></span>

![](knockoutjs-template/_static/image8.png)

<span data-ttu-id="a5cf7-138">En el lado del servidor, ASP.NET MVC sirve al código HTML y también controla la autenticación basada en formularios.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-138">On the server side, ASP.NET MVC serves the HTML and also handles forms-based authentication.</span></span>

<span data-ttu-id="a5cf7-139">ASP.NET Web API controla todas las solicitudes relacionadas con ToDoLists y ToDoItems, como obtener, crear, actualizar y eliminar.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-139">ASP.NET Web API handles all requests that relate to the ToDoLists and ToDoItems, including getting, creating, updating and deleting.</span></span> <span data-ttu-id="a5cf7-140">El cliente intercambia datos con la API Web en formato JSON.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-140">The client exchanges data with Web API in JSON format.</span></span>

<span data-ttu-id="a5cf7-141">Entity Framework (EF) es la capa O/RM.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-141">Entity Framework (EF) is the O/RM layer.</span></span> <span data-ttu-id="a5cf7-142">Media entre el mundo orientado a objetos de ASP.NET y la base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-142">It mediates between the object-oriented world of ASP.NET and the underlying database.</span></span> <span data-ttu-id="a5cf7-143">La base de datos utiliza LocalDB, pero puede cambiarla en el archivo Web. config.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-143">The database uses LocalDB but you can change this in the Web.config file.</span></span> <span data-ttu-id="a5cf7-144">Normalmente, se usaría LocalDB para el desarrollo local y, a continuación, se implementaría en una base de datos SQL en el servidor mediante la migración de EF Code-First.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-144">Typically you would use LocalDB for local development and then deploy to a SQL database on the server, using EF code-first migration.</span></span>

<span data-ttu-id="a5cf7-145">En el lado del cliente, la biblioteca Knockout. js controla las actualizaciones de página de las solicitudes AJAX.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-145">On the client side, the Knockout.js library handles page updates from AJAX requests.</span></span> <span data-ttu-id="a5cf7-146">El knockout usa el enlace de datos para sincronizar la página con los datos más recientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-146">Knockout uses data binding to synchronize the page with the latest data.</span></span> <span data-ttu-id="a5cf7-147">De este modo, no tiene que escribir ningún código que recorra los datos JSON y actualice el DOM.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-147">That way, you don't have to write any of the code that walks through the JSON data and updates the DOM.</span></span> <span data-ttu-id="a5cf7-148">En su lugar, se colocan atributos declarativos en el código HTML que indican cómo presentar los datos.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-148">Instead, you put declarative attributes in the HTML that tell Knockout how to present the data.</span></span>

<span data-ttu-id="a5cf7-149">Una gran ventaja de esta arquitectura es que separa el nivel de presentación de la lógica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-149">A big advantage of this architecture is that it separates the presentation layer from the application logic.</span></span> <span data-ttu-id="a5cf7-150">Puede crear la parte de la API Web sin saber nada sobre el aspecto que tendrá la Página Web.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-150">You can create the Web API portion without knowing anything about how your web page will look.</span></span> <span data-ttu-id="a5cf7-151">En el lado cliente, se crea un "modelo de vista" para representar los datos y el modelo de vista utiliza el knockout para enlazar con el código HTML.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-151">On the client side, you create a "view model" to represent that data, and the view model uses Knockout to bind to the HTML.</span></span> <span data-ttu-id="a5cf7-152">Esto le permite cambiar fácilmente el código HTML sin cambiar el modelo de vista.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-152">That lets you easily change the HTML without changing the view model.</span></span> <span data-ttu-id="a5cf7-153">(Veremos un poco más adelante).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-153">(We'll look at Knockout a bit later.)</span></span>

## <a name="models"></a><span data-ttu-id="a5cf7-154">Modelos</span><span class="sxs-lookup"><span data-stu-id="a5cf7-154">Models</span></span>

<span data-ttu-id="a5cf7-155">En el proyecto de Visual Studio, la carpeta modelos contiene los modelos que se usan en el lado servidor.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-155">In the Visual Studio project, the Models folder contains the models that are used on the server side.</span></span> <span data-ttu-id="a5cf7-156">(También hay modelos en el lado cliente; los vamos a obtener).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-156">(There are also models on the client side; we'll get to those.)</span></span>

![](knockoutjs-template/_static/image9.png)

<span data-ttu-id="a5cf7-157">**TodoItem, TodoList**</span><span class="sxs-lookup"><span data-stu-id="a5cf7-157">**TodoItem, TodoList**</span></span>

<span data-ttu-id="a5cf7-158">Estos son los modelos de base de datos para Entity Framework Code First.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-158">These are the database models for Entity Framework Code First.</span></span> <span data-ttu-id="a5cf7-159">Tenga en cuenta que estos modelos tienen propiedades que apuntan entre sí.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-159">Notice that these models have properties that point to each other.</span></span> <span data-ttu-id="a5cf7-160">`ToDoList` contiene una colección de ToDoItems y cada `ToDoItem` tiene una referencia a su ToDoList primario.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-160">`ToDoList` contains a collection of ToDoItems, and each `ToDoItem` has a reference back to its parent ToDoList.</span></span> <span data-ttu-id="a5cf7-161">Estas propiedades se denominan propiedades de navegación y representan la relación de uno a varios con una lista de tareas pendientes y sus elementos pendientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-161">These properties are called navigation properties, and they represent the one-to-many relation a to-do list and its to-do items.</span></span>

<span data-ttu-id="a5cf7-162">La clase `ToDoItem` también utiliza el atributo **[ForeignKey]** para especificar que `ToDoListId` es una clave externa en la tabla `ToDoList`.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-162">The `ToDoItem` class also uses the **[ForeignKey]** attribute to specify that `ToDoListId` is a foreign key into the `ToDoList` table.</span></span> <span data-ttu-id="a5cf7-163">Esto indica a EF que agregue una restricción de clave externa a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-163">This tells EF to add a foreign-key constraint to the database.</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample1.cs)]

<span data-ttu-id="a5cf7-164">**TodoItemDto, TodoListDto**</span><span class="sxs-lookup"><span data-stu-id="a5cf7-164">**TodoItemDto, TodoListDto**</span></span>

<span data-ttu-id="a5cf7-165">Estas clases definen los datos que se enviarán al cliente.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-165">These classes define the data that will be sent to the client.</span></span> <span data-ttu-id="a5cf7-166">"DTO" significa "objeto de transferencia de datos".</span><span class="sxs-lookup"><span data-stu-id="a5cf7-166">"DTO" stands for "data transfer object."</span></span> <span data-ttu-id="a5cf7-167">El DTO define cómo se serializarán las entidades en JSON.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-167">The DTO defines how the entities will be serialized into JSON.</span></span> <span data-ttu-id="a5cf7-168">En general, hay varias razones para usar DTO:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-168">In general, there are several reasons to use DTOs:</span></span>

- <span data-ttu-id="a5cf7-169">Para controlar qué propiedades se serializan.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-169">To control which properties are serialized.</span></span> <span data-ttu-id="a5cf7-170">DTO puede contener un subconjunto de las propiedades del modelo de dominio.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-170">The DTO can contain a subset of the properties from the domain model.</span></span> <span data-ttu-id="a5cf7-171">Podría hacerlo por razones de seguridad (para ocultar información confidencial) o simplemente para reducir la cantidad de datos que envía.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-171">You might do this for security reasons (to hide sensitive data) or simply to reduce the amount of data that you send.</span></span>
- <span data-ttu-id="a5cf7-172">Para cambiar la forma de los datos, por ejemplo, para aplanar una estructura de datos más compleja.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-172">To change the shape of the data – e.g. to flatten a more complex data structure.</span></span>
- <span data-ttu-id="a5cf7-173">Para mantener la lógica de negocios fuera del DTO (separación de preocupaciones).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-173">To keep any business logic out of the DTO (separation of concerns).</span></span>
- <span data-ttu-id="a5cf7-174">Si por algún motivo no se pueden serializar los modelos de dominio.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-174">If your domain models cannot be serialized for some reason.</span></span> <span data-ttu-id="a5cf7-175">Por ejemplo, las referencias circulares pueden causar problemas al serializar un objeto. existen maneras de controlar este problema en Web API (consulte [control de referencias circulares de objetos](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); pero usar un DTO simplemente evita el problema por completo.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-175">For example, circular references can cause problems when you serialize an object There are ways to handle this problem in Web API (see [Handling Circular Object References](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); but using a DTO simply avoids the problem altogether.</span></span>

<span data-ttu-id="a5cf7-176">En la plantilla SPA, dto contiene los mismos datos que los modelos de dominio.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-176">In the SPA template, the DTOs contains the same data as the domain models.</span></span> <span data-ttu-id="a5cf7-177">Sin embargo, siguen siendo útiles porque evitan referencias circulares de las propiedades de navegación y muestran el patrón DTO general.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-177">However, they are still useful because they avoid circular references from the navigation properties, and they demonstrate the general DTO pattern.</span></span>

<span data-ttu-id="a5cf7-178">**AccountModels.cs**</span><span class="sxs-lookup"><span data-stu-id="a5cf7-178">**AccountModels.cs**</span></span>

<span data-ttu-id="a5cf7-179">Este archivo contiene modelos para la pertenencia al sitio.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-179">This file contains models for site membership.</span></span> <span data-ttu-id="a5cf7-180">La clase `UserProfile` define el esquema de los perfiles de usuario en la base de la pertenencia.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-180">The `UserProfile` class defines the schema for user profiles in the membership DB.</span></span> <span data-ttu-id="a5cf7-181">(En este caso, la única información es el identificador de usuario y el nombre de usuario). Las otras clases de modelo de este archivo se utilizan para crear el registro de usuario y los formularios de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-181">(In this case, the only information is the user ID and the user name.) The other model classes in this file are used to create the user registration and login forms.</span></span>

## <a name="entity-framework"></a><span data-ttu-id="a5cf7-182">Entity Framework</span><span class="sxs-lookup"><span data-stu-id="a5cf7-182">Entity Framework</span></span>

<span data-ttu-id="a5cf7-183">La plantilla SPA usa EF Code First.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-183">The SPA template uses EF Code First.</span></span> <span data-ttu-id="a5cf7-184">En el desarrollo de Code First, primero se definen los modelos en el código y, a continuación, EF usa el modelo para crear la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-184">In Code First development, you define the models first in code, and then EF uses the model to create the database.</span></span> <span data-ttu-id="a5cf7-185">También puede usar EF con una base de datos existente ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-185">You can also use EF with an existing database ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span></span>

<span data-ttu-id="a5cf7-186">La clase `TodoItemContext` de la carpeta models se deriva de **DbContext**.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-186">The `TodoItemContext` class in the Models folder derives from **DbContext**.</span></span> <span data-ttu-id="a5cf7-187">Esta clase proporciona la "adherencia" entre los modelos y EF.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-187">This class provides the "glue" between the models and EF.</span></span> <span data-ttu-id="a5cf7-188">El `TodoItemContext` contiene una colección de `ToDoItem` y una colección de `TodoList`.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-188">The `TodoItemContext` holds a `ToDoItem` collection and a `TodoList` collection.</span></span> <span data-ttu-id="a5cf7-189">Para consultar la base de datos, basta con escribir una consulta LINQ en estas colecciones.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-189">To query the database, you simply write a LINQ query against these collections.</span></span> <span data-ttu-id="a5cf7-190">Por ejemplo, aquí se muestra cómo puede seleccionar todas las listas de tareas pendientes para el usuario "Alice":</span><span class="sxs-lookup"><span data-stu-id="a5cf7-190">For example, here is how you can select all of the to-do lists for user "Alice":</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample2.cs)]

<span data-ttu-id="a5cf7-191">También puede agregar nuevos elementos a la colección, actualizar elementos o eliminar elementos de la colección y conservar los cambios en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-191">You can also add new items to the collection, update items, or delete items from the collection, and persist the changes to the database.</span></span>

## <a name="aspnet-web-api-controllers"></a><span data-ttu-id="a5cf7-192">Controladores de ASP.NET Web API</span><span class="sxs-lookup"><span data-stu-id="a5cf7-192">ASP.NET Web API Controllers</span></span>

<span data-ttu-id="a5cf7-193">En ASP.NET Web API, los controladores son objetos que controlan las solicitudes HTTP.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-193">In ASP.NET Web API, controllers are objects that handle HTTP requests.</span></span> <span data-ttu-id="a5cf7-194">Como se mencionó, la plantilla de SPA usa la API Web para habilitar las operaciones CRUD en instancias de `ToDoList` y `ToDoItem`.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-194">As mentioned, the SPA template uses Web API to enable CRUD operations on `ToDoList` and `ToDoItem` instances.</span></span> <span data-ttu-id="a5cf7-195">Los controladores se encuentran en la carpeta Controllers de la solución.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-195">The controllers are located in the Controllers folder of the solution.</span></span>

![](knockoutjs-template/_static/image10.png)

- <span data-ttu-id="a5cf7-196">`TodoController`: controla las solicitudes HTTP para los elementos de tareas pendientes</span><span class="sxs-lookup"><span data-stu-id="a5cf7-196">`TodoController`: Handles HTTP requests for to-do items</span></span>
- <span data-ttu-id="a5cf7-197">`TodoListController`: controla las solicitudes HTTP para las listas de tareas pendientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-197">`TodoListController`: Handles HTTP requests for to-do lists.</span></span>

<span data-ttu-id="a5cf7-198">Estos nombres son significativos, ya que la API Web coincide con la ruta de acceso del URI al nombre del controlador.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-198">These names are significant, because Web API matches the URI path to the controller name.</span></span> <span data-ttu-id="a5cf7-199">(Para obtener información sobre cómo la API Web enruta las solicitudes HTTP a los controladores, consulte [enrutamiento en ASP.net web API](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md)).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-199">(To learn how Web API routes HTTP requests to controllers, see [Routing in ASP.NET Web API](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span></span>

<span data-ttu-id="a5cf7-200">Echemos un vistazo a la clase `ToDoListController`.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-200">Let's look at the `ToDoListController` class.</span></span> <span data-ttu-id="a5cf7-201">Contiene un solo miembro de datos:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-201">It contains a single data member:</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample3.cs)]

<span data-ttu-id="a5cf7-202">El `TodoItemContext` se usa para comunicarse con EF, como se describió anteriormente.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-202">The `TodoItemContext` is used to communicate with EF, as described earlier.</span></span> <span data-ttu-id="a5cf7-203">Los métodos del controlador implementan las operaciones CRUD.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-203">The methods on the controller implement the CRUD operations.</span></span> <span data-ttu-id="a5cf7-204">La API Web asigna solicitudes HTTP desde el cliente a métodos de controlador, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-204">Web API maps HTTP requests from the client to controller methods, as follows:</span></span>

| <span data-ttu-id="a5cf7-205">Solicitud HTTP</span><span class="sxs-lookup"><span data-stu-id="a5cf7-205">HTTP Request</span></span> | <span data-ttu-id="a5cf7-206">Método de controlador</span><span class="sxs-lookup"><span data-stu-id="a5cf7-206">Controller Method</span></span> | <span data-ttu-id="a5cf7-207">Description</span><span class="sxs-lookup"><span data-stu-id="a5cf7-207">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="a5cf7-208">GET /api/todo</span><span class="sxs-lookup"><span data-stu-id="a5cf7-208">GET /api/todo</span></span> | `GetTodoLists` | <span data-ttu-id="a5cf7-209">Obtiene una colección de listas de tareas pendientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-209">Gets a collection of to-do lists.</span></span> |
| <span data-ttu-id="a5cf7-210">OBTENER el*identificador* de/API/todo/</span><span class="sxs-lookup"><span data-stu-id="a5cf7-210">GET /api/todo/*id*</span></span> | `GetTodoList` | <span data-ttu-id="a5cf7-211">Obtiene una lista de tareas pendientes por identificador.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-211">Gets a to-do list by ID</span></span> |
| <span data-ttu-id="a5cf7-212">PUT/API/todo/*ID*</span><span class="sxs-lookup"><span data-stu-id="a5cf7-212">PUT /api/todo/*id*</span></span> | `PutTodoList` | <span data-ttu-id="a5cf7-213">Actualiza una lista de tareas pendientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-213">Updates a to-do list.</span></span> |
| <span data-ttu-id="a5cf7-214">POST /api/todo</span><span class="sxs-lookup"><span data-stu-id="a5cf7-214">POST /api/todo</span></span> | `PostTodoList` | <span data-ttu-id="a5cf7-215">Crea una nueva lista de tareas pendientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-215">Creates a new to-do list.</span></span> |
| <span data-ttu-id="a5cf7-216">ELIMINAR el*ID.* de/API/todo/</span><span class="sxs-lookup"><span data-stu-id="a5cf7-216">DELETE /api/todo/*id*</span></span> | `DeleteTodoList` | <span data-ttu-id="a5cf7-217">Elimina una lista de tareas pendientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-217">Deletes a TODO list.</span></span> |

<span data-ttu-id="a5cf7-218">Observe que los URI de algunas operaciones contienen marcadores de posición para el valor de identificador.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-218">Notice that the URIs for some operations contain placeholders for the ID value.</span></span> <span data-ttu-id="a5cf7-219">Por ejemplo, para eliminar una lista de para con un identificador de 42, el URI se `/api/todo/42`.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-219">For example, to delete a to-list with an ID of 42, the URI is `/api/todo/42`.</span></span>

<span data-ttu-id="a5cf7-220">Para obtener más información sobre el uso de la API Web para las operaciones CRUD, consulte [creación de una API Web que admita operaciones CRUD](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-220">To learn more about using Web API for CRUD operations, see [Creating a Web API that Supports CRUD Operations](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span></span> <span data-ttu-id="a5cf7-221">El código de este controlador es bastante sencillo.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-221">The code for this controller is fairly straightforward.</span></span> <span data-ttu-id="a5cf7-222">Estos son algunos puntos interesantes:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-222">Here are some interesting points:</span></span>

- <span data-ttu-id="a5cf7-223">El método `GetTodoLists` usa una consulta LINQ para filtrar los resultados por el identificador del usuario que ha iniciado sesión.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-223">The `GetTodoLists` method uses a LINQ query to filter the results by the ID of the logged-in user.</span></span> <span data-ttu-id="a5cf7-224">De este modo, un usuario solo verá los datos que le pertenecen.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-224">That way, a user only sees the data that belongs to him or her.</span></span> <span data-ttu-id="a5cf7-225">Además, observe que se usa una instrucción SELECT para convertir las instancias de `ToDoList` en instancias de `TodoListDto`.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-225">Also, notice that a Select statement is used to convert the `ToDoList` instances into `TodoListDto` instances.</span></span>
- <span data-ttu-id="a5cf7-226">Los métodos PUT y POST comprueban el estado del modelo antes de modificar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-226">The PUT and POST methods check the model state before modifying the database.</span></span> <span data-ttu-id="a5cf7-227">Si **ModelState. IsValid** es false, estos métodos devuelven http 400, solicitud incorrecta.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-227">If **ModelState.IsValid** is false, these methods return HTTP 400, Bad Request.</span></span> <span data-ttu-id="a5cf7-228">Obtenga más información sobre la validación de modelos en Web API en la [validación del modelo](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-228">Read more about model validation in Web API at [Model Validation](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span></span>
- <span data-ttu-id="a5cf7-229">La clase de controlador también se decora con el atributo **[Authorize]** .</span><span class="sxs-lookup"><span data-stu-id="a5cf7-229">The controller class is also decorated with the **[Authorize]** attribute.</span></span> <span data-ttu-id="a5cf7-230">Este atributo comprueba si se ha autenticado la solicitud HTTP.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-230">This attribute checks whether the HTTP request is authenticated.</span></span> <span data-ttu-id="a5cf7-231">Si la solicitud no está autenticada, el cliente recibe HTTP 401, no autorizado.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-231">If the request is not authenticated, the client receives HTTP 401, Unauthorized.</span></span> <span data-ttu-id="a5cf7-232">Obtenga más información sobre la autenticación en la [autenticación y la autorización en ASP.net web API](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-232">Read more about authentication at [Authentication and Authorization in ASP.NET Web API](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span></span>

<span data-ttu-id="a5cf7-233">La clase `TodoController` es muy similar a `TodoListController`.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-233">The `TodoController` class is very similar to `TodoListController`.</span></span> <span data-ttu-id="a5cf7-234">La diferencia más importante es que no define ningún método GET, ya que el cliente obtendrá los elementos de tareas pendientes junto con cada lista de tareas pendientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-234">The biggest difference is that it does not define any GET methods, because the client will get the to-do items along with each to-do list.</span></span>

## <a name="mvc-controllers-and-views"></a><span data-ttu-id="a5cf7-235">Controladores y vistas de MVC</span><span class="sxs-lookup"><span data-stu-id="a5cf7-235">MVC Controllers and Views</span></span>

<span data-ttu-id="a5cf7-236">Los controladores de MVC también se encuentran en la carpeta Controllers de la solución.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-236">The MVC controllers are also located in the Controllers folder of the solution.</span></span> <span data-ttu-id="a5cf7-237">`HomeController` representa el HTML principal de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-237">`HomeController` renders the main HTML for the application.</span></span> <span data-ttu-id="a5cf7-238">La vista del controlador Home se define en views/home/index. cshtml.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-238">The view for the Home controller is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="a5cf7-239">La vista Inicio representa contenido diferente en función de si el usuario ha iniciado sesión:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-239">The Home view renders different content depending on whether the user is logged in:</span></span>

[!code-cshtml[Main](knockoutjs-template/samples/sample4.cshtml)]

<span data-ttu-id="a5cf7-240">Cuando los usuarios inician sesión, ven la interfaz de usuario principal.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-240">When users are logged in, they see the main UI.</span></span> <span data-ttu-id="a5cf7-241">De lo contrario, verán el panel de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-241">Otherwise, they see the login panel.</span></span> <span data-ttu-id="a5cf7-242">Tenga en cuenta que esta representación condicional se produce en el lado servidor.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-242">Note that this conditional rendering happens on the server side.</span></span> <span data-ttu-id="a5cf7-243">No intente ocultar contenido confidencial en el lado&#8212;del cliente. todo lo que envíe en una respuesta HTTP es visible para alguien que esté viendo los mensajes HTTP sin formato.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-243">Never try to hide sensitive content on the client side&#8212;anything that you send in an HTTP response is visible to someone who is watching the raw HTTP messages.</span></span>

## <a name="client-side-javascript-and-knockoutjs"></a><span data-ttu-id="a5cf7-244">JavaScript del lado cliente y Knockout. js</span><span class="sxs-lookup"><span data-stu-id="a5cf7-244">Client-Side JavaScript and Knockout.js</span></span>

<span data-ttu-id="a5cf7-245">Ahora vamos a pasar del lado servidor de la aplicación al cliente.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-245">Now let's turn from the server side of the application to the client.</span></span> <span data-ttu-id="a5cf7-246">La plantilla SPA usa una combinación de jQuery y Knockout. js para crear una interfaz de usuario fluida e interactiva.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-246">The SPA template uses a combination of jQuery and Knockout.js to create a smooth, interactive UI.</span></span> <span data-ttu-id="a5cf7-247">Knockout. js es una biblioteca de JavaScript que facilita el enlace de HTML a los datos.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-247">Knockout.js is a JavaScript library that makes it easy to bind HTML to data.</span></span> <span data-ttu-id="a5cf7-248">Knockout. js usa un patrón denominado "Model-View-ViewModel".</span><span class="sxs-lookup"><span data-stu-id="a5cf7-248">Knockout.js uses a pattern called "Model-View-ViewModel."</span></span>

- <span data-ttu-id="a5cf7-249">El modelo son los datos de dominio (listas de tareas pendientes y elementos de la lista de tareas).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-249">The model is the domain data (ToDo lists and ToDo items).</span></span>
- <span data-ttu-id="a5cf7-250">La vista es el documento HTML.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-250">The view is the HTML document.</span></span>
- <span data-ttu-id="a5cf7-251">El modelo de vista es un objeto de JavaScript que contiene los datos del modelo.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-251">The view-model is a JavaScript object that holds the model data.</span></span> <span data-ttu-id="a5cf7-252">El modelo de vista es una abstracción de código de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-252">The view-model is a code abstraction of the UI.</span></span> <span data-ttu-id="a5cf7-253">No tiene ningún conocimiento de la representación en HTML.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-253">It has no knowledge of the HTML representation.</span></span> <span data-ttu-id="a5cf7-254">En su lugar, representa características abstractas de la vista, como "una lista de elementos pendientes".</span><span class="sxs-lookup"><span data-stu-id="a5cf7-254">Instead, it represents abstract features of the view, such as "a list of ToDo items".</span></span>

<span data-ttu-id="a5cf7-255">La vista está enlazada a datos con el modelo de vista.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-255">The view is data-bound to the view-model.</span></span> <span data-ttu-id="a5cf7-256">Las actualizaciones del modelo de vista se reflejan automáticamente en la vista.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-256">Updates to the view-model are automatically reflected in the view.</span></span> <span data-ttu-id="a5cf7-257">Los enlaces también funcionan con la otra dirección.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-257">Bindings work the other direction as well.</span></span> <span data-ttu-id="a5cf7-258">Los eventos del DOM (como los clics) están enlazados a datos en las funciones del modelo de vista, que desencadenan llamadas AJAX.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-258">Events in the DOM (such as clicks) are data-bound to functions on the view model, which trigger AJAX calls.</span></span>

<span data-ttu-id="a5cf7-259">La plantilla SPA organiza el código JavaScript del lado cliente en tres capas:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-259">The SPA template organizes the client-side JavaScript into three layers:</span></span>

- <span data-ttu-id="a5cf7-260">todo. DataContext. js: envía solicitudes AJAX.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-260">todo.datacontext.js: Sends AJAX requests.</span></span>
- <span data-ttu-id="a5cf7-261">todo. Model. js: define los modelos.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-261">todo.model.js: Defines the models.</span></span>
- <span data-ttu-id="a5cf7-262">todo. ViewModel. js: define el modelo de vista.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-262">todo.viewmodel.js: Defines the view model.</span></span>

![](knockoutjs-template/_static/image11.png)

<span data-ttu-id="a5cf7-263">Estos archivos de script se encuentran en la carpeta scripts/aplicación de la solución.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-263">These script files are located in the Scripts/app folder of the solution.</span></span>

![](knockoutjs-template/_static/image12.png)

<span data-ttu-id="a5cf7-264">**todo. DataContext** controla todas las llamadas Ajax a los controladores de la API Web.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-264">**todo.datacontext** handles all AJAX calls to the Web API controllers.</span></span> <span data-ttu-id="a5cf7-265">(Las llamadas AJAX para el inicio de sesión se definen en otro lugar, en ajaxLogin. js).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-265">(The AJAX calls for logging in are defined elsewhere, in ajaxlogin.js.)</span></span>

<span data-ttu-id="a5cf7-266">**todo. Model. js** define los modelos del lado cliente (explorador) de las listas de tareas pendientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-266">**todo.model.js** defines the client-side (browser) models for the to-do lists.</span></span> <span data-ttu-id="a5cf7-267">Hay dos clases de modelo: todoItem y todoList.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-267">There are two model classes: todoItem and todoList.</span></span>

<span data-ttu-id="a5cf7-268">Muchas de las propiedades de las clases de modelo son del tipo "KO. observable".</span><span class="sxs-lookup"><span data-stu-id="a5cf7-268">Many of the properties in the model classes are of type "ko.observable".</span></span> <span data-ttu-id="a5cf7-269">Los Observabless son la forma en que el Knockout es su magia.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-269">Observables are how Knockout does its magic.</span></span> <span data-ttu-id="a5cf7-270">En la [documentación](http://knockoutjs.com/documentation/introduction.html)de la cobertura: un objeto observable es un "objeto de JavaScript que puede notificar los cambios a los suscriptores".</span><span class="sxs-lookup"><span data-stu-id="a5cf7-270">From the [Knockout documentation](http://knockoutjs.com/documentation/introduction.html): An observable is a "JavaScript object that can notify subscribers about changes."</span></span> <span data-ttu-id="a5cf7-271">Cuando el valor de un objeto observable cambia, el knockout actualiza cualquier elemento HTML que esté enlazado a esos observables.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-271">When the value of an observable changes, Knockout updates any HTML elements that are bound to those observables.</span></span> <span data-ttu-id="a5cf7-272">Por ejemplo, todoItem tiene observables para las propiedades title y hace:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-272">For example, todoItem has observables for the title and isDone properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample5.js)]

<span data-ttu-id="a5cf7-273">También puede suscribirse a un objeto observable en el código.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-273">You can also subscribe to an observable in code.</span></span> <span data-ttu-id="a5cf7-274">Por ejemplo, la clase todoItem se suscribe a los cambios en las propiedades "hace" y "title":</span><span class="sxs-lookup"><span data-stu-id="a5cf7-274">For example, the todoItem class subscribes to changes in the "isDone" and "title" properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample6.js)]

<span data-ttu-id="a5cf7-275">**Modelo de vista**</span><span class="sxs-lookup"><span data-stu-id="a5cf7-275">**View Model**</span></span>

<span data-ttu-id="a5cf7-276">El modelo de vista se define en todo. ViewModel. js.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-276">The view model is defined in todo.viewmodel.js.</span></span> <span data-ttu-id="a5cf7-277">El modelo de vista es el punto central en el que la aplicación enlaza los elementos de la página HTML con los datos del dominio.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-277">The view model is the central point where the application binds the HTML page elements to the domain data.</span></span> <span data-ttu-id="a5cf7-278">En la plantilla SPA, el modelo de vista contiene una matriz observable de todoLists.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-278">In the SPA template, the view model contains an observable array of todoLists.</span></span> <span data-ttu-id="a5cf7-279">En el siguiente código del modelo de vista se indica la cobertura para aplicar los enlaces:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-279">The following code in the view model tells Knockout to apply the bindings:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample7.js)]

## <a name="html-and-data-binding"></a><span data-ttu-id="a5cf7-280">HTML y enlace de datos</span><span class="sxs-lookup"><span data-stu-id="a5cf7-280">HTML and Data Binding</span></span>

<span data-ttu-id="a5cf7-281">El HTML principal de la página se define en views/home/index. cshtml.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-281">The main HTML for the page is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="a5cf7-282">Dado que estamos usando el enlace de datos, el código HTML es solo una plantilla para lo que realmente se representa.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-282">Because we are using data-binding, the HTML is only a template for what actually gets rendered.</span></span> <span data-ttu-id="a5cf7-283">El knockout usa enlaces *declarativos* .</span><span class="sxs-lookup"><span data-stu-id="a5cf7-283">Knockout uses *declarative* bindings.</span></span> <span data-ttu-id="a5cf7-284">Los elementos de página se enlazan a los datos agregando un atributo "enlace de datos" al elemento.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-284">You bind page elements to data by adding a "data-bind" attribute to the element.</span></span> <span data-ttu-id="a5cf7-285">Este es un ejemplo muy sencillo, tomado de la documentación de la cobertura:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-285">Here is a very simple example, taken from the Knockout documentation:</span></span>

[!code-html[Main](knockoutjs-template/samples/sample8.html)]

<span data-ttu-id="a5cf7-286">En este ejemplo, el knockout actualiza el contenido de la **&lt;intervalo&gt;** elemento con el valor de `myItems.count()`.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-286">In this example, Knockout updates the contents of the **&lt;span&gt;** element with the value of `myItems.count()`.</span></span> <span data-ttu-id="a5cf7-287">Cada vez que este valor cambia, el knockout actualiza el documento.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-287">Whenever this value changes, Knockout updates the document.</span></span>

<span data-ttu-id="a5cf7-288">El knockout proporciona varios tipos de enlace diferentes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-288">Knockout provides a number of different binding types.</span></span> <span data-ttu-id="a5cf7-289">Estos son algunos de los enlaces que se usan en la plantilla de SPA:</span><span class="sxs-lookup"><span data-stu-id="a5cf7-289">Here are some of the bindings used in the SPA template:</span></span>

- <span data-ttu-id="a5cf7-290">**foreach**: permite recorrer en iteración un bucle y aplicar el mismo marcado a cada elemento de la lista.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-290">**foreach**: Lets you iterate through a loop and apply the same markup to each item in the list.</span></span> <span data-ttu-id="a5cf7-291">Se usa para representar las listas de tareas pendientes y los elementos pendientes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-291">This is used to render the to-do lists and to-do items.</span></span> <span data-ttu-id="a5cf7-292">Dentro de la **instrucción foreach**, los enlaces se aplican a los elementos de la lista.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-292">Within the **foreach**, the bindings are applied to the elements of the list.</span></span>
- <span data-ttu-id="a5cf7-293">**visible**: se usa para alternar la visibilidad.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-293">**visible**: Used to toggle visibility.</span></span> <span data-ttu-id="a5cf7-294">Oculte el marcado cuando una colección esté vacía o haga que el mensaje de error esté visible.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-294">Hide markup when a collection is empty, or make the error message visible.</span></span>
- <span data-ttu-id="a5cf7-295">**valor**: se usa para rellenar los valores de formulario.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-295">**value**: Used to populate form values.</span></span>
- <span data-ttu-id="a5cf7-296">**click**: enlaza un evento click a una función en el modelo de vista.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-296">**click**: Binds a click event to a function on the view model.</span></span>

## <a name="anti-csrf-protection"></a><span data-ttu-id="a5cf7-297">Protección contra CSRF</span><span class="sxs-lookup"><span data-stu-id="a5cf7-297">Anti-CSRF Protection</span></span>

<span data-ttu-id="a5cf7-298">La falsificación de solicitudes entre sitios (CSRF) es un ataque en el que un sitio malintencionado envía una solicitud a un sitio vulnerable en el que el usuario ha iniciado sesión actualmente.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-298">Cross-Site Request Forgery (CSRF) is an attack where a malicious site sends a request to a vulnerable site where the user is currently logged in.</span></span> <span data-ttu-id="a5cf7-299">Para ayudar a evitar ataques CSRF, ASP.NET MVC usa *tokens antifalsificación*, también denominados tokens de comprobación de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-299">To help prevent CSRF attacks, ASP.NET MVC uses *anti-forgery tokens*, also called request verification tokens.</span></span> <span data-ttu-id="a5cf7-300">La idea es que el servidor coloca un token generado aleatoriamente en una página web.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-300">The idea is that the server puts a randomly generated token into a web page.</span></span> <span data-ttu-id="a5cf7-301">Cuando el cliente envía datos al servidor, debe incluir este valor en el mensaje de solicitud.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-301">When the client submits data to the server, it must include this value in the request message.</span></span>

<span data-ttu-id="a5cf7-302">Los tokens antifalsificación funcionan porque la página malintencionada no puede leer los tokens del usuario debido a las directivas del mismo origen.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-302">Anti-forgery tokens work because the malicious page cannot read the user's tokens, due to same-origin policies.</span></span> <span data-ttu-id="a5cf7-303">(Las directivas del mismo origen impiden que los documentos hospedados en dos sitios diferentes accedan al contenido de los demás).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-303">(Same-origin policies prevent documents hosted on two different sites from accessing each other's content.)</span></span>

<span data-ttu-id="a5cf7-304">ASP.NET MVC proporciona compatibilidad integrada para tokens antifalsificación, a través de la clase [antifalsificación](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) y el atributo [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) .</span><span class="sxs-lookup"><span data-stu-id="a5cf7-304">ASP.NET MVC provides built-in support for anti-forgery tokens, through the [AntiForgery](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) class and the [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) attribute.</span></span> <span data-ttu-id="a5cf7-305">Actualmente, esta funcionalidad no está integrada en la API Web.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-305">Currently, this functionality is not built into Web API.</span></span> <span data-ttu-id="a5cf7-306">Sin embargo, la plantilla de SPA incluye una implementación personalizada para la API Web.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-306">However, the SPA template includes a custom implementation for Web API.</span></span> <span data-ttu-id="a5cf7-307">Este código se define en la clase `ValidateHttpAntiForgeryTokenAttribute`, que se encuentra en la carpeta filtros de la solución.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-307">This code is defined in the `ValidateHttpAntiForgeryTokenAttribute` class, which is located in the Filters folder of the solution.</span></span> <span data-ttu-id="a5cf7-308">Para obtener más información acerca de anti-CSRF en Web API, consulte [prevención de ataques de falsificación de solicitud entre sitios (CSRF)](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-308">To learn more about anti-CSRF in Web API, see [Preventing Cross-Site Request Forgery (CSRF) Attacks](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="a5cf7-309">Conclusión</span><span class="sxs-lookup"><span data-stu-id="a5cf7-309">Conclusion</span></span>

<span data-ttu-id="a5cf7-310">La plantilla de SPA está diseñada para ayudarle a empezar a escribir rápidamente aplicaciones web modernas e interactivas.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-310">The SPA template is designed to get you started quickly writing modern, interactive web applications.</span></span> <span data-ttu-id="a5cf7-311">Usa la biblioteca Knockout. js para separar la presentación (marcado HTML) de los datos y la lógica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-311">It uses the Knockout.js library to separate presentation (HTML markup) from the data and application logic.</span></span> <span data-ttu-id="a5cf7-312">Pero el knockout no es la única biblioteca de JavaScript que puede usar para crear un SPA.</span><span class="sxs-lookup"><span data-stu-id="a5cf7-312">But Knockout is not the only JavaScript library you can use to create a SPA.</span></span> <span data-ttu-id="a5cf7-313">Si desea explorar otras opciones, eche un vistazo a las [plantillas de spa creadas por la comunidad](../templates/index.md).</span><span class="sxs-lookup"><span data-stu-id="a5cf7-313">If you want to explore some other options, take a look at the [community-created SPA templates](../templates/index.md).</span></span>

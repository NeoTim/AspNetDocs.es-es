---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: Insertar un nuevo registro desde el pie de página de GridView (VB) | Microsoft Docs
author: rick-anderson
description: Aunque el control GridView no proporciona compatibilidad integrada para insertar un nuevo registro de datos, en este tutorial se muestra cómo aumentar el GridView para incluir un...
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 67ef370a90bc843f5c2da80bb43c8ef8de216b51
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2019
ms.locfileid: "74631750"
---
# <a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="2f9c1-103">Insertar un nuevo registro desde el pie de página de GridView (VB)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-103">Inserting a New Record from the GridView's Footer (VB)</span></span>

<span data-ttu-id="2f9c1-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2f9c1-105">[Descarga](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) de la aplicación de ejemplo o [descarga de PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="2f9c1-106">Aunque el control GridView no proporciona compatibilidad integrada para insertar un nuevo registro de datos, en este tutorial se muestra cómo aumentar el GridView para incluir una interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="2f9c1-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="2f9c1-107">Introduction</span></span>

<span data-ttu-id="2f9c1-108">Como se describe en [información general sobre la inserción, actualización y eliminación de datos](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) , los controles Web GridView, DetailsView y FormView incluyen funciones de modificación de datos integradas.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="2f9c1-109">Cuando se usa con controles de origen de datos declarativos, estos tres controles Web se pueden configurar de forma rápida y sencilla para modificar los datos y en escenarios sin necesidad de escribir una sola línea de código.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="2f9c1-110">Desafortunadamente, solo los controles DetailsView y FormView proporcionan capacidades integradas de inserción, edición y eliminación.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="2f9c1-111">GridView solo ofrece compatibilidad para editar y eliminar.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="2f9c1-112">Sin embargo, con un pequeño grasa angular, podemos aumentar el GridView para incluir una interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="2f9c1-113">Al agregar funcionalidades de inserción a GridView, somos responsables de decidir cómo se agregarán los nuevos registros, crear la interfaz de inserción y escribir el código para insertar el nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="2f9c1-114">En este tutorial, veremos cómo agregar la interfaz de inserción a la fila de pie de página de GridView (vea la ilustración 1).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="2f9c1-115">La celda de pie de página de cada columna incluye el elemento de interfaz de usuario de recopilación de datos adecuado (un cuadro de texto para el nombre del producto, un DropDownList para el proveedor, etc.).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="2f9c1-116">También se necesita una columna para un botón Agregar que, al hacer clic en él, producirá un postback e insertará un nuevo registro en la tabla de `Products` con los valores proporcionados en la fila de pie de página.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>

<span data-ttu-id="2f9c1-117">[![la fila de pie de página proporciona una interfaz para agregar nuevos productos](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="2f9c1-118">**Figura 1**: la fila de pie de página proporciona una interfaz para agregar nuevos productos ([haga clic para ver la imagen de tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>

## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="2f9c1-119">Paso 1: Mostrar información del producto en un control GridView</span><span class="sxs-lookup"><span data-stu-id="2f9c1-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="2f9c1-120">Antes de preocuparnos por la creación de la interfaz de inserción en el pie de página de GridView, vamos a centrarse primero en agregar un control GridView a la página que muestra los productos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="2f9c1-121">Comience abriendo la página `InsertThroughFooter.aspx` en la carpeta `EnhancedGridView` y arrastre un control GridView desde el cuadro de herramientas hasta el diseñador, estableciendo la propiedad GridView s `ID` en `Products`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="2f9c1-122">A continuación, use la etiqueta inteligente de GridView s para enlazarla a un nuevo ObjectDataSource denominado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>

<span data-ttu-id="2f9c1-123">[![crear un nuevo ObjectDataSource denominado ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="2f9c1-124">**Figura 2**: creación de un nuevo ObjectDataSource denominado `ProductsDataSource` ([haga clic para ver la imagen de tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>

<span data-ttu-id="2f9c1-125">Configure ObjectDataSource para usar el método `ProductsBLL` Class s `GetProducts()` para recuperar la información del producto.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="2f9c1-126">En este tutorial, vamos a centrarse estrictamente en agregar funcionalidades de inserción y no preocuparse por la edición y la eliminación.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="2f9c1-127">Por lo tanto, asegúrese de que la lista desplegable de la pestaña insertar esté establecida en `AddProduct()` y que las listas desplegables de las pestañas actualizar y eliminar estén establecidas en (ninguno).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>

<span data-ttu-id="2f9c1-128">[![asignar el método AddProduct al método ObjectDataSource Insert ()](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="2f9c1-129">**Figura 3**: asignación del método `AddProduct` al método ObjectDataSource s `Insert()` ([haga clic para ver la imagen de tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>

<span data-ttu-id="2f9c1-130">[![establecer las listas desplegables de las pestañas actualizar y eliminar en (ninguna)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="2f9c1-131">**Figura 4**: establecimiento de las listas desplegables de las pestañas actualizar y eliminar en (ninguna) ([haga clic para ver la imagen a tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>

<span data-ttu-id="2f9c1-132">Después de completar el Asistente para configurar origen de datos de ObjectDataSource, Visual Studio agregará automáticamente campos a GridView para cada uno de los campos de datos correspondientes.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="2f9c1-133">Por ahora, deje todos los campos agregados por Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="2f9c1-134">Más adelante en este tutorial, volveremos a quitar algunos de los campos cuyos valores no se deben especificar al agregar un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="2f9c1-135">Puesto que hay cerca de 80 productos en la base de datos, el usuario tendrá que desplazarse hasta la parte inferior de la página web para agregar un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="2f9c1-136">Por lo tanto, permita que la paginación permita que la interfaz de inserción sea más visible y accesible.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="2f9c1-137">Para activar la paginación, active la casilla habilitar paginación en la etiqueta inteligente de GridView s.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="2f9c1-138">En este momento, el marcado declarativo de GridView y ObjectDataSource s debería tener un aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]

<span data-ttu-id="2f9c1-139">[![todos los campos de datos del producto se muestran en un control GridView paginado](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="2f9c1-140">**Figura 5**: todos los campos de datos de producto se muestran en un control GridView paginado ([haga clic para ver la imagen de tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="2f9c1-141">Paso 2: agregar una fila de pie de página</span><span class="sxs-lookup"><span data-stu-id="2f9c1-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="2f9c1-142">Junto con el encabezado y las filas de datos, GridView incluye una fila de pie de página.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="2f9c1-143">Las filas de encabezado y de pie de página se muestran en función de los valores de las propiedades [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) y [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) de GridView.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="2f9c1-144">Para mostrar la fila de pie de página, basta con establecer la propiedad `ShowFooter` en `True`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="2f9c1-145">Como se muestra en la figura 6, al establecer la propiedad `ShowFooter` en `True` se agrega una fila de pie de página a la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>

<span data-ttu-id="2f9c1-146">[![para mostrar la fila de pie de página, establezca ShowFooter en true.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="2f9c1-147">**Figura 6**: para mostrar la fila de pie de página, establezca `ShowFooter` en `True` ([haga clic para ver la imagen de tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>

<span data-ttu-id="2f9c1-148">Tenga en cuenta que la fila de pie de página tiene un color de fondo rojo oscuro.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="2f9c1-149">Esto se debe al tema DataWebControls que hemos creado y aplicado a todas las páginas en el tutorial de [visualización de datos con el diseño ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="2f9c1-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="2f9c1-150">En concreto, el archivo `GridView.skin` configura la propiedad `FooterStyle` de modo que utiliza la clase `FooterStyle` CSS.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="2f9c1-151">La clase `FooterStyle` se define en `Styles.css` de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>

[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="2f9c1-152">Hemos explorado el uso de la fila de pie de página de GridView en los tutoriales anteriores.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="2f9c1-153">Si es necesario, consulte la [información de resumen que se muestra en el](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial de pie de página de GridView para obtener un actualizador.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>

<span data-ttu-id="2f9c1-154">Después de establecer la propiedad `ShowFooter` en `True`, dedique un momento a ver el resultado en un explorador.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="2f9c1-155">Actualmente, la fila de pie de página no contiene ningún texto o control Web.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="2f9c1-156">En el paso 3 modificaremos el pie de página de cada campo de GridView para que incluya la interfaz de inserción adecuada.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>

<span data-ttu-id="2f9c1-157">[![se muestra la fila de pie de página vacía encima de los controles de la interfaz de paginación](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="2f9c1-158">**Figura 7**: se muestra la fila de pie de página vacía encima de los controles de la interfaz de paginación ([haga clic para ver la imagen de tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>

## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="2f9c1-159">Paso 3: personalización de la fila de pie de página</span><span class="sxs-lookup"><span data-stu-id="2f9c1-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="2f9c1-160">De nuevo en el tutorial [uso de TemplateFields en el control GridView](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) , vimos cómo personalizar en gran medida la presentación de una columna de GridView determinada con TemplateFields (en lugar de BoundFields o CheckBoxFields). en [la personalización de la interfaz de modificación de datos](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) , hemos examinado el uso de TemplateFields para personalizar la interfaz de edición en un control GridView.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="2f9c1-161">Recuerde que un TemplateField se compone de un número de plantillas que define la combinación de marcado, controles Web y sintaxis de enlace de los tipos de filas que se usan para determinados tipos de filas.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="2f9c1-162">El `ItemTemplate`, por ejemplo, especifica la plantilla que se utiliza para las filas de solo lectura, mientras que la `EditItemTemplate` define la plantilla para la fila modificable.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="2f9c1-163">Junto con los `ItemTemplate` y `EditItemTemplate`, TemplateField también incluye un `FooterTemplate` que especifica el contenido de la fila de pie de página.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="2f9c1-164">Por lo tanto, podemos agregar los controles Web necesarios para cada campo que inserte la interfaz en el `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="2f9c1-165">Para empezar, convierta todos los campos de GridView a TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="2f9c1-166">Para ello, haga clic en el vínculo editar columnas de la etiqueta inteligente de GridView s, seleccione cada campo en la esquina inferior izquierda y haga clic en el vínculo convertir este campo en un TemplateField.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>

![Convertir cada campo en TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="2f9c1-168">**Figura 8**: conversión de cada campo en TemplateField</span><span class="sxs-lookup"><span data-stu-id="2f9c1-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>

<span data-ttu-id="2f9c1-169">Al hacer clic en la conversión de este campo en TemplateField, el tipo de campo actual se convierte en un TemplateField equivalente.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="2f9c1-170">Por ejemplo, cada BoundField se reemplaza por TemplateField con una `ItemTemplate` que contiene una etiqueta que muestra el campo de datos correspondiente y una `EditItemTemplate` que muestra el campo de datos en un cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="2f9c1-171">El `ProductName` BoundField se ha convertido en el siguiente marcado de TemplateField:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="2f9c1-172">Del mismo modo, el `Discontinued` CheckBoxField se ha convertido en TemplateField, cuyos `ItemTemplate` y `EditItemTemplate` contienen un control Web CheckBox (con la casilla `ItemTemplate` s deshabilitada).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="2f9c1-173">El `ProductID` de solo lectura que se ha convertido en TemplateField con un control etiqueta en el `ItemTemplate` y `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="2f9c1-174">En Resumen, convertir un campo de GridView existente en un TemplateField es una forma rápida y sencilla de cambiar a TemplateField más personalizable sin perder ninguna de las funciones de campo existentes.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="2f9c1-175">Dado que el control GridView con el que trabajamos no admite la edición, no dude en quitar el `EditItemTemplate` de cada TemplateField, lo que solo se mantiene el `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="2f9c1-176">Después de hacerlo, el marcado declarativo de GridView debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-176">After doing this, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="2f9c1-177">Ahora que cada campo de GridView se ha convertido en TemplateField, podemos especificar la interfaz de inserción adecuada en cada campo `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="2f9c1-178">Algunos de los campos no tendrán una interfaz de inserción (`ProductID`, por ejemplo); otros variarán en los controles Web que se usan para recopilar la nueva información del producto.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="2f9c1-179">Para crear la interfaz de edición, elija el vínculo editar plantillas de la etiqueta inteligente de GridView s.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="2f9c1-180">A continuación, en la lista desplegable, seleccione el campo apropiado `FooterTemplate` y arrastre el control correspondiente desde el cuadro de herramientas hasta el diseñador.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>

<span data-ttu-id="2f9c1-181">[![agregar la interfaz de inserción adecuada a cada campo FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="2f9c1-182">**Figura 9**: agregar la interfaz de inserción adecuada a cada campo `FooterTemplate` ([haga clic para ver la imagen de tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>

<span data-ttu-id="2f9c1-183">La siguiente lista con viñetas enumera los campos de GridView, especificando la interfaz de inserción que se va a agregar:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="2f9c1-184">`ProductID` ninguno.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-184">`ProductID` none.</span></span>
- <span data-ttu-id="2f9c1-185">`ProductName` agregue un cuadro de texto y establezca su `ID` en `NewProductName`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="2f9c1-186">Agregue también un control RequiredFieldValidator para asegurarse de que el usuario escribe un valor para el nuevo nombre del producto.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="2f9c1-187">`SupplierID` ninguno.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-187">`SupplierID` none.</span></span>
- <span data-ttu-id="2f9c1-188">`CategoryID` ninguno.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-188">`CategoryID` none.</span></span>
- <span data-ttu-id="2f9c1-189">`QuantityPerUnit` agregar un cuadro de texto y establecer su `ID` en `NewQuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="2f9c1-190">`UnitPrice` agregar un cuadro de texto denominado `NewUnitPrice` y un control CompareValidator que garantice que el valor especificado es un valor de moneda mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="2f9c1-191">`UnitsInStock` usar un cuadro de texto cuyo `ID` está establecido en `NewUnitsInStock`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="2f9c1-192">Incluya un CompareValidator que garantice que el valor especificado es un valor entero mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="2f9c1-193">`UnitsOnOrder` usar un cuadro de texto cuyo `ID` está establecido en `NewUnitsOnOrder`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="2f9c1-194">Incluya un CompareValidator que garantice que el valor especificado es un valor entero mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="2f9c1-195">`ReorderLevel` usar un cuadro de texto cuyo `ID` está establecido en `NewReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="2f9c1-196">Incluya un CompareValidator que garantice que el valor especificado es un valor entero mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="2f9c1-197">`Discontinued` agregar una casilla y establecer su `ID` en `NewDiscontinued`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="2f9c1-198">`CategoryName` agregue un DropDownList y establezca su `ID` en `NewCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="2f9c1-199">Enlácelo a un nuevo ObjectDataSource denominado `CategoriesDataSource` y configúrelo para que use el método de `GetCategories()` de `CategoriesBLL` Class s.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="2f9c1-200">Haga que los `ListItem` de DropDownList muestren el campo de datos `CategoryName`, mediante el campo de datos `CategoryID` como sus valores.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="2f9c1-201">`SupplierName` agregue un DropDownList y establezca su `ID` en `NewSupplierID`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="2f9c1-202">Enlácelo a un nuevo ObjectDataSource denominado `SuppliersDataSource` y configúrelo para que use el método de `GetSuppliers()` de `SuppliersBLL` Class s.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="2f9c1-203">Haga que los `ListItem` de DropDownList muestren el campo de datos `CompanyName`, mediante el campo de datos `SupplierID` como sus valores.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="2f9c1-204">Para cada uno de los controles de validación, desactive la propiedad `ForeColor` de modo que se use el color de primer plano blanco de la clase CSS del `FooterStyle` en lugar del rojo predeterminado.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="2f9c1-205">Utilice también la propiedad `ErrorMessage` para obtener una descripción detallada, pero establezca la propiedad `Text` en un asterisco.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="2f9c1-206">Para evitar que el texto del control de validación provoque que la interfaz de inserción se ajuste a dos líneas, establezca la propiedad `FooterStyle` s `Wrap` en false para cada una de las `FooterTemplate` que usan un control de validación.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="2f9c1-207">Por último, agregue un control ValidationSummary debajo de GridView y establezca su propiedad `ShowMessageBox` en `True` y su propiedad `ShowSummary` en `False`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="2f9c1-208">Al agregar un nuevo producto, es necesario proporcionar el `CategoryID` y `SupplierID`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="2f9c1-209">Esta información se captura a través de DropDownLists en las celdas de pie de página de los campos `CategoryName` y `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="2f9c1-210">Elegí usar estos campos en lugar de los `CategoryID` y `SupplierID` TemplateFields porque, en las filas de datos de la cuadrícula, es probable que el usuario le interese ver la categoría y los nombres de proveedor en lugar de sus valores de identificador.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="2f9c1-211">Puesto que los valores de `CategoryID` y `SupplierID` se están capturando en las interfaces `CategoryName` y `SupplierName` Field s Inserting, podemos quitar el `CategoryID` y `SupplierID` TemplateFields de GridView.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="2f9c1-212">Del mismo modo, el `ProductID` no se usa al agregar un nuevo producto, por lo que también se puede quitar el `ProductID` TemplateField.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="2f9c1-213">Sin embargo, deje el campo `ProductID` en la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="2f9c1-214">Además de los cuadros de texto, DropDownLists, casillas y controles de validación que componen la interfaz de inserción, también necesitaremos un botón Agregar que, al hacer clic en él, realice la lógica para agregar el nuevo producto a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="2f9c1-215">En el paso 4 incluiremos un botón Agregar en la interfaz de inserción en el `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="2f9c1-216">No dude en mejorar la apariencia de los distintos campos de GridView.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="2f9c1-217">Por ejemplo, puede que desee dar formato de moneda a los valores `UnitPrice`, alinear a la derecha los campos `UnitsInStock`, `UnitsOnOrder`y `ReorderLevel`, y actualizar los valores `HeaderText` para TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="2f9c1-218">Después de crear el paso de insertar interfaces en el `FooterTemplate`, quitar el `SupplierID`y `CategoryID` TemplateFields y mejorar la estética de la cuadrícula mediante el formato y la alineación del TemplateFields, el marcado declarativo de GridView debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="2f9c1-219">Cuando se ve a través de un explorador, la fila de pie de página de GridView ahora incluye la interfaz de inserción completada (vea la figura 10).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="2f9c1-220">En este momento, la interfaz de inserción no incluye un medio para que el usuario indique que ha introducido los datos para el nuevo producto y desea insertar un nuevo registro en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="2f9c1-221">Además, todavía vamos a abordar cómo se traducirán los datos introducidos en el pie de página en un nuevo registro en la base de datos de `Products`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="2f9c1-222">En el paso 4 veremos cómo incluir un botón Agregar en la interfaz de inserción y cómo ejecutar el código en el PostBack cuando se hace clic en él.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="2f9c1-223">En el paso 5 se muestra cómo insertar un nuevo registro con los datos del pie de página.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>

<span data-ttu-id="2f9c1-224">[![el pie de página de GridView proporciona una interfaz para agregar un nuevo registro](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="2f9c1-225">**Figura 10**: el pie de página de GridView proporciona una interfaz para agregar un nuevo registro ([haga clic para ver la imagen de tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>

## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="2f9c1-226">Paso 4: incluir un botón Agregar en la interfaz de inserción</span><span class="sxs-lookup"><span data-stu-id="2f9c1-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="2f9c1-227">Necesitamos incluir un botón Agregar en algún lugar de la interfaz de inserción, ya que la interfaz de pie de página de la fila de pie de página no tiene los medios para que el usuario indique que ha completado la entrada de la nueva información de productos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="2f9c1-228">Esto podría colocarse en uno de los `FooterTemplate` existentes o podríamos agregar una columna nueva a la cuadrícula para este propósito.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="2f9c1-229">En este tutorial, vamos a colocar el botón Agregar en el `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="2f9c1-230">En el diseñador, haga clic en el vínculo editar plantillas de la etiqueta inteligente de GridView s y, a continuación, elija el `ProductID` campo s `FooterTemplate` en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="2f9c1-231">Agregue un control Web Button (o LinkButton o ImageButton, si lo prefiere) a la plantilla, estableciendo su identificador en `AddProduct`, su `CommandName` para insertar y su propiedad `Text` para agregar como se muestra en la figura 11.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>

<span data-ttu-id="2f9c1-232">[![Coloque el botón Agregar en el ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="2f9c1-233">**Figura 11**: Coloque el botón Agregar en el `ProductID` TemplateField s `FooterTemplate` ([haga clic para ver la imagen a tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>

<span data-ttu-id="2f9c1-234">Una vez que haya incluido el botón Agregar, pruebe la página en un explorador.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="2f9c1-235">Tenga en cuenta que al hacer clic en el botón Agregar con datos no válidos en la interfaz de inserción, el PostBack se cortocircuita y el control ValidationSummary indica los datos no válidos (vea la figura 12).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="2f9c1-236">Con los datos adecuados especificados, al hacer clic en el botón Agregar se produce un postback.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="2f9c1-237">Sin embargo, no se agrega ningún registro a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-237">No record is added to the database, however.</span></span> <span data-ttu-id="2f9c1-238">Tendremos que escribir un poco de código para realizar realmente la inserción.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-238">We will need to write a bit of code to actually perform the insert.</span></span>

<span data-ttu-id="2f9c1-239">[![se cortocircuita el PostBack del botón Agregar en caso de que haya datos no válidos en la interfaz de inserción](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="2f9c1-240">**Figura 12**: el PostBack del botón Agregar se cortocircuita si hay datos no válidos en la interfaz de inserción ([haga clic para ver la imagen de tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="2f9c1-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="2f9c1-241">Los controles de validación de la interfaz de inserción no se asignaron a un grupo de validación.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="2f9c1-242">Esto funciona bien siempre y cuando la interfaz de inserción sea el único conjunto de controles de validación de la página.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="2f9c1-243">Sin embargo, si hay otros controles de validación en la página (por ejemplo, los controles de validación en la interfaz de edición de la cuadrícula), se debe asignar el mismo valor a los controles de validación de la interfaz de inserción y agregar el botón `ValidationGroup` propiedades para asociar estos controles a un grupo de validaciones determinado.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="2f9c1-244">Vea [dessección de los controles de validación en ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) para obtener más información sobre la creación de particiones de los controles de validación y los botones de una página en los grupos de validación.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>

## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="2f9c1-245">Paso 5: insertar un nuevo registro en la tabla`Products`</span><span class="sxs-lookup"><span data-stu-id="2f9c1-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="2f9c1-246">Al usar las características de edición integradas de GridView, GridView controla automáticamente todo el trabajo necesario para realizar la actualización.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="2f9c1-247">En concreto, cuando se hace clic en el botón actualizar, copia los valores especificados desde la interfaz de edición a los parámetros de la colección de `UpdateParameters` de origen de datos de origen e inicia la actualización mediante la invocación del método ObjectDataSource s `Update()`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="2f9c1-248">Dado que GridView no proporciona la funcionalidad integrada para la inserción, debemos implementar código que llame al método de `Insert()` ObjectDataSource s y copie los valores de la interfaz de inserción en la colección de `InsertParameters` de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="2f9c1-249">Esta lógica de inserción se debe ejecutar después de hacer clic en el botón Agregar.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="2f9c1-250">Tal y como se describe en los [botones agregar y responder a un tutorial de GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) , cada vez que se hace clic en un botón, LinkButton o ImageButton en un control GridView, se desencadena el evento gridview s `RowCommand` en el PostBack.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="2f9c1-251">Este evento se desencadena si el botón, el control LinkButton o el control ImageButton se agregaron explícitamente, como el botón Agregar de la fila de pie de página o si el control GridView lo agregó automáticamente (por ejemplo, el LinkButtons en la parte superior de cada columna cuando se selecciona habilitar ordenación, o bien el LinkButtons en la interfaz de paginación cuando está seleccionada la opción Habilitar paginación).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="2f9c1-252">Por lo tanto, para responder al usuario haciendo clic en el botón Agregar, es necesario crear un controlador de eventos para el evento GridView s `RowCommand`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="2f9c1-253">Dado que este evento se activa siempre que se hace clic en *un* botón, LinkButton o ImageButton en GridView, es vital que solo avancemos con la lógica de inserción si la `CommandName` propiedad que se pasa al controlador de eventos se asigna al valor `CommandName` del botón Agregar (Insert).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="2f9c1-254">Además, también deberíamos continuar si los controles de validación notifican datos válidos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="2f9c1-255">Para ello, cree un controlador de eventos para el evento `RowCommand` con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="2f9c1-256">Es posible que se pregunte por qué el controlador de eventos comprueba la propiedad `Page.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="2f9c1-257">Después de All, no se suprimirá el PostBack si se proporcionan datos no válidos en la interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-257">After all, won't the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="2f9c1-258">Esta suposición es correcta siempre que el usuario no haya deshabilitado JavaScript o haya realizado pasos para eludir la lógica de validación del lado cliente.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="2f9c1-259">En Resumen, nunca debe confiar estrictamente en la validación del lado cliente; siempre debe realizarse una comprobación del lado del servidor para comprobar la validez antes de trabajar con los datos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>

<span data-ttu-id="2f9c1-260">En el paso 1, creamos el `ProductsDataSource` ObjectDataSource de tal forma que su método de `Insert()` está asignado al método de la clase `ProductsBLL` `AddProduct`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="2f9c1-261">Para insertar el nuevo registro en la tabla `Products`, simplemente se puede invocar el método ObjectDataSource s `Insert()`:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="2f9c1-262">Ahora que se ha invocado el método de `Insert()`, lo único que queda es copiar los valores de la interfaz de inserción en los parámetros pasados al método `AddProduct` de la clase `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="2f9c1-263">Como hemos visto en el tutorial [examen de los eventos asociados con la inserción, actualización y eliminación](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) , esto se puede realizar a través del evento de `Inserting` de datos de origen de datos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="2f9c1-264">En el evento `Inserting` es necesario hacer referencia mediante programación a los controles de la fila de pie de página de `Products` GridView s y asignar sus valores a la colección de `e.InputParameters`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="2f9c1-265">Si el usuario omite un valor como dejar el cuadro de texto `ReorderLevel` en blanco, es necesario especificar que el valor insertado en la base de datos debe ser `NULL`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="2f9c1-266">Dado que el método `AddProducts` acepta tipos que aceptan valores NULL para los campos de base de datos que aceptan valores NULL, basta con usar un tipo que acepta valores NULL y establecer su valor en `Nothing` en el caso de que se omita la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="2f9c1-267">Con el controlador de eventos `Inserting` completado, se pueden agregar nuevos registros a la tabla de base de datos de `Products` a través de la fila de pie de página de GridView.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="2f9c1-268">Continúe y pruebe a agregar varios productos nuevos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="2f9c1-269">Mejorar y personalizar la operación de agregar</span><span class="sxs-lookup"><span data-stu-id="2f9c1-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="2f9c1-270">Actualmente, al hacer clic en el botón Agregar se agrega un nuevo registro a la tabla de base de datos, pero no se proporciona ningún tipo de comentario visual de que el registro se haya agregado correctamente.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="2f9c1-271">Lo ideal es que un cuadro de alerta del lado cliente o un control Web de etiqueta informe al usuario de que su inserción se ha completado correctamente.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="2f9c1-272">Dejo esto como un ejercicio para el lector.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="2f9c1-273">El GridView usado en este tutorial no aplica ningún criterio de ordenación a los productos de la lista, ni permite al usuario final ordenar los datos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="2f9c1-274">Por lo tanto, los registros se ordenan tal como están en la base de datos por su campo de clave principal.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="2f9c1-275">Puesto que cada nuevo registro tiene un valor `ProductID` mayor que el último, cada vez que se agrega un nuevo producto, se agrega al final de la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="2f9c1-276">Por lo tanto, puede que desee enviar automáticamente el usuario a la última página de GridView después de agregar un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="2f9c1-277">Esto se puede lograr agregando la siguiente línea de código después de la llamada a `ProductsDataSource.Insert()` en el controlador de eventos `RowCommand` para indicar que el usuario debe enviarse a la última página después de enlazar los datos a GridView:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="2f9c1-278">`SendUserToLastPage` es una variable booleana de nivel de página a la que se asigna inicialmente un valor de `False`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="2f9c1-279">En el controlador de eventos GridView s `DataBound`, si `SendUserToLastPage` es false, se actualiza la propiedad `PageIndex` para enviar al usuario a la última página.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="2f9c1-280">La razón por la que se establece la propiedad `PageIndex` en el controlador de eventos `DataBound` (en lugar del controlador de eventos `RowCommand`) es porque cuando el controlador de eventos `RowCommand` se activa, todavía se agrega el nuevo registro a la tabla de base de datos `Products`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="2f9c1-281">Por lo tanto, en el controlador de eventos `RowCommand` el índice de la última página (`PageCount - 1`) representa el último índice de la página *antes* de que se haya agregado el nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="2f9c1-282">Para la mayoría de los productos que se van a agregar, el índice de la última página es el mismo después de agregar el nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="2f9c1-283">Pero cuando el producto agregado da como resultado un nuevo índice de última página, si actualizamos incorrectamente el `PageIndex` en el controlador de eventos de `RowCommand`, se le dirigirá a la página de la segunda a la última (el índice de la última página antes de agregar el nuevo producto) en lugar de al nuevo índice de la página anterior.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="2f9c1-284">Puesto que el controlador de eventos `DataBound` se activa después de agregar el nuevo producto y de volver a enlazar los datos a la cuadrícula, al establecer la propiedad `PageIndex`, sabemos que se va a obtener el índice de la última página correcto.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="2f9c1-285">Por último, la GridView usada en este tutorial es bastante extensa debido al número de campos que se deben recopilar para agregar un nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="2f9c1-286">Debido a este ancho, podría ser preferible un diseño vertical de DetailsView.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="2f9c1-287">El ancho total de GridView se puede reducir mediante la recopilación de menos entradas.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="2f9c1-288">Es posible que no necesitemos recopilar los campos `UnitsOnOrder`, `UnitsInStock`y `ReorderLevel` al agregar un nuevo producto, en cuyo caso estos campos podrían quitarse de GridView.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="2f9c1-289">Para ajustar los datos recopilados, podemos usar uno de estos dos enfoques:</span><span class="sxs-lookup"><span data-stu-id="2f9c1-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="2f9c1-290">Siga usando el método `AddProduct` que espera valores para los campos `UnitsOnOrder`, `UnitsInStock`y `ReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="2f9c1-291">En el controlador de eventos `Inserting`, proporcione valores predeterminados codificados de forma rígida para usarlos con estas entradas que se han quitado de la interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="2f9c1-292">Cree una nueva sobrecarga del método `AddProduct` en la clase `ProductsBLL` que no acepte entradas para los campos `UnitsOnOrder`, `UnitsInStock`y `ReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="2f9c1-293">A continuación, en la página ASP.NET, configure ObjectDataSource para usar esta nueva sobrecarga.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="2f9c1-294">Ambas opciones también funcionarán de forma similar.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-294">Either option will work equally as well.</span></span> <span data-ttu-id="2f9c1-295">En los tutoriales anteriores usamos la última opción, creando varias sobrecargas para el método de `UpdateProduct` de clase `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="2f9c1-296">Resumen</span><span class="sxs-lookup"><span data-stu-id="2f9c1-296">Summary</span></span>

<span data-ttu-id="2f9c1-297">GridView carece de las funciones de inserción integradas que se encuentran en DetailsView y FormView, pero con un poco de esfuerzo se puede Agregar una interfaz de inserción a la fila de pie de página.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="2f9c1-298">Para mostrar la fila de pie de página en un control GridView, simplemente establezca su propiedad `ShowFooter` en `True`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="2f9c1-299">El contenido de la fila de pie de página se puede personalizar para cada campo convirtiendo el campo en TemplateField y agregando la interfaz de inserción a la `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="2f9c1-300">Como vimos en este tutorial, el `FooterTemplate` puede contener botones, cuadros de texto, DropDownLists, casillas, controles de origen de datos para rellenar controles Web controlados por datos (como DropDownLists) y controles de validación.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="2f9c1-301">Junto con los controles para recopilar la entrada del usuario, se necesita un botón Agregar, LinkButton o ImageButton.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="2f9c1-302">Cuando se hace clic en el botón Agregar, se invoca el método de `Insert()` ObjectDataSource s para iniciar el flujo de trabajo de inserción.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="2f9c1-303">A continuación, ObjectDataSource llamará al método de inserción configurado (el método `ProductsBLL` Class s `AddProduct`, en este tutorial).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="2f9c1-304">Debemos copiar los valores de la interfaz de inserción de GridView en la colección de `InsertParameters` de ObjectDataSource antes de que se invoque el método INSERT.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="2f9c1-305">Esto puede realizarse mediante programación para hacer referencia a los controles Web de la interfaz de inserción en el controlador de eventos ObjectDataSource s `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="2f9c1-306">En este tutorial se completan las técnicas para mejorar la apariencia de GridView.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="2f9c1-307">En el siguiente conjunto de tutoriales se examinará cómo trabajar con datos binarios como imágenes, archivos PDF, documentos de Word, etc. y los controles Web de datos.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="2f9c1-308">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="2f9c1-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2f9c1-309">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="2f9c1-309">About the Author</span></span>

<span data-ttu-id="2f9c1-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros de ASP/ASP. net y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2f9c1-311">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2f9c1-312">Su último libro se [*enseña a ASP.NET 2,0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2f9c1-313">Puede ponerse en contacto con usted en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2f9c1-314">o a través de su blog, que encontrará en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2f9c1-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2f9c1-315">Agradecimiento especial a</span><span class="sxs-lookup"><span data-stu-id="2f9c1-315">Special Thanks To</span></span>

<span data-ttu-id="2f9c1-316">Muchos revisores útiles revisaron esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2f9c1-317">El revisor de clientes potenciales de este tutorial era de Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="2f9c1-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="2f9c1-318">¿Está interesado en revisar los próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="2f9c1-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2f9c1-319">En caso afirmativo, suéltelo en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2f9c1-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="2f9c1-320">Anterior</span><span class="sxs-lookup"><span data-stu-id="2f9c1-320">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)

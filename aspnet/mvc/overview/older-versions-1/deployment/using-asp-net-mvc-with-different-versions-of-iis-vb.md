---
uid: mvc/overview/older-versions-1/deployment/using-asp-net-mvc-with-different-versions-of-iis-vb
title: Usar ASP.NET MVC con distintas versiones de IIS (VB) | Microsoft Docs
author: microsoft
description: En este tutorial, aprenderá a usar ASP.NET MVC y el enrutamiento de direcciones URL con diferentes versiones de Internet Information Services. Aprenderá distintas estrategias...
ms.author: riande
ms.date: 08/19/2008
ms.assetid: 1c1283b2-6956-4937-b568-d30de432ce23
msc.legacyurl: /mvc/overview/older-versions-1/deployment/using-asp-net-mvc-with-different-versions-of-iis-vb
msc.type: authoredcontent
ms.openlocfilehash: b754175c853c20eec6be3521376b62d62f33106d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78470017"
---
# <a name="using-aspnet-mvc-with-different-versions-of-iis-vb"></a><span data-ttu-id="a4343-104">Usar ASP.NET MVC con distintas versiones de IIS (VB)</span><span class="sxs-lookup"><span data-stu-id="a4343-104">Using ASP.NET MVC with Different Versions of IIS (VB)</span></span>

<span data-ttu-id="a4343-105">por [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="a4343-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="a4343-106">En este tutorial, aprenderá a usar ASP.NET MVC y el enrutamiento de direcciones URL con diferentes versiones de Internet Information Services.</span><span class="sxs-lookup"><span data-stu-id="a4343-106">In this tutorial, you learn how to use ASP.NET MVC, and URL Routing, with different versions of Internet Information Services.</span></span> <span data-ttu-id="a4343-107">Aprenderá diferentes estrategias para usar ASP.NET MVC con IIS 7,0 (modo clásico), IIS 6,0 y versiones anteriores de IIS.</span><span class="sxs-lookup"><span data-stu-id="a4343-107">You learn different strategies for using ASP.NET MVC with IIS 7.0 (classic mode), IIS 6.0, and earlier versions of IIS.</span></span>

<span data-ttu-id="a4343-108">El marco de MVC de ASP.NET depende del enrutamiento de ASP.NET para enrutar las solicitudes del explorador a las acciones de controlador.</span><span class="sxs-lookup"><span data-stu-id="a4343-108">The ASP.NET MVC framework depends on ASP.NET Routing to route browser requests to controller actions.</span></span> <span data-ttu-id="a4343-109">Con el fin de aprovechar el enrutamiento de ASP.NET, es posible que tenga que realizar pasos de configuración adicionales en el servidor Web.</span><span class="sxs-lookup"><span data-stu-id="a4343-109">In order to take advantage of ASP.NET Routing, you might have to perform additional configuration steps on your web server.</span></span> <span data-ttu-id="a4343-110">Todo depende de la versión de Internet Information Services (IIS) y el modo de procesamiento de solicitudes de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4343-110">It all depends on the version of Internet Information Services (IIS) and the request processing mode for your application.</span></span>

<span data-ttu-id="a4343-111">A continuación se muestra un resumen de las distintas versiones de IIS:</span><span class="sxs-lookup"><span data-stu-id="a4343-111">Here's a summary of the different versions of IIS:</span></span>

- <span data-ttu-id="a4343-112">IIS 7,0 (modo integrado): no se necesita ninguna configuración especial para usar el enrutamiento ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-112">IIS 7.0 (integrated mode) - No special configuration necessary to use ASP.NET Routing.</span></span>
- <span data-ttu-id="a4343-113">IIS 7,0 (modo clásico): debe realizar una configuración especial para usar el enrutamiento ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-113">IIS 7.0 (classic mode) - You need to perform special configuration to use ASP.NET Routing.</span></span>
- <span data-ttu-id="a4343-114">IIS 6,0 o inferior: debe realizar una configuración especial para usar el enrutamiento ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-114">IIS 6.0 or below - You need to perform special configuration to use ASP.NET Routing.</span></span>

<span data-ttu-id="a4343-115">La versión más reciente de IIS es la versión 7,5 (en Win7).</span><span class="sxs-lookup"><span data-stu-id="a4343-115">The latest version of IIS is version 7.5 (on Win7).</span></span> <span data-ttu-id="a4343-116">IIS 7 de IIS se incluye con Windows Server 2008 y VISTA/SP1 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="a4343-116">IIS 7 of IIS is included with Windows Server 2008 AND VISTA/SP1 and higher.</span></span> <span data-ttu-id="a4343-117">También puede instalar IIS 7,0 en cualquier versión del sistema operativo de vista excepto Home Basic (consulte [https://technet.microsoft.com/library/cc731179%28WS.10%29.aspx](https://technet.microsoft.com/library/cc731179%28WS.10%29.aspx)).</span><span class="sxs-lookup"><span data-stu-id="a4343-117">You also can install IIS 7.0 on any version of the Vista operating system except Home Basic (see [https://technet.microsoft.com/library/cc731179%28WS.10%29.aspx](https://technet.microsoft.com/library/cc731179%28WS.10%29.aspx)).</span></span>

<span data-ttu-id="a4343-118">IIS 7,0 admite dos modos de procesamiento de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="a4343-118">IIS 7.0 supports two modes for processing requests.</span></span> <span data-ttu-id="a4343-119">Puede usar el modo integrado o el modo clásico.</span><span class="sxs-lookup"><span data-stu-id="a4343-119">You can use integrated mode or classic mode.</span></span> <span data-ttu-id="a4343-120">No es necesario realizar ningún paso de configuración especial al usar IIS 7,0 en el modo integrado.</span><span class="sxs-lookup"><span data-stu-id="a4343-120">You don't need to perform any special configuration steps when using IIS 7.0 in integrated mode.</span></span> <span data-ttu-id="a4343-121">Sin embargo, es necesario realizar una configuración adicional cuando se usa IIS 7,0 en modo clásico.</span><span class="sxs-lookup"><span data-stu-id="a4343-121">However, you do need to perform additional configuration when using IIS 7.0 in classic mode.</span></span>

<span data-ttu-id="a4343-122">Microsoft Windows Server 2003 incluye IIS 6,0.</span><span class="sxs-lookup"><span data-stu-id="a4343-122">Microsoft Windows Server 2003 includes IIS 6.0.</span></span> <span data-ttu-id="a4343-123">No se puede actualizar IIS 6,0 a IIS 7,0 cuando se usa el sistema operativo Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="a4343-123">You cannot upgrade IIS 6.0 to IIS 7.0 when using the Windows Server 2003 operating system.</span></span> <span data-ttu-id="a4343-124">Debe realizar pasos de configuración adicionales al usar IIS 6,0.</span><span class="sxs-lookup"><span data-stu-id="a4343-124">You must perform additional configuration steps when using IIS 6.0.</span></span>

<span data-ttu-id="a4343-125">Microsoft Windows XP Professional incluye IIS 5,1.</span><span class="sxs-lookup"><span data-stu-id="a4343-125">Microsoft Windows XP Professional includes IIS 5.1.</span></span> <span data-ttu-id="a4343-126">Debe realizar pasos de configuración adicionales al usar IIS 5,1.</span><span class="sxs-lookup"><span data-stu-id="a4343-126">You must perform additional configuration steps when using IIS 5.1.</span></span>

<span data-ttu-id="a4343-127">Por último, Microsoft Windows 2000 y Microsoft Windows 2000 Professional incluyen IIS 5,0.</span><span class="sxs-lookup"><span data-stu-id="a4343-127">Finally, Microsoft Windows 2000 and Microsoft Windows 2000 Professional includes IIS 5.0.</span></span> <span data-ttu-id="a4343-128">Debe realizar pasos de configuración adicionales al usar IIS 5,0.</span><span class="sxs-lookup"><span data-stu-id="a4343-128">You must perform additional configuration steps when using IIS 5.0.</span></span>

## <a name="integrated-versus-classic-mode"></a><span data-ttu-id="a4343-129">Modo integrado frente al modo clásico</span><span class="sxs-lookup"><span data-stu-id="a4343-129">Integrated versus Classic Mode</span></span>

<span data-ttu-id="a4343-130">IIS 7,0 puede procesar solicitudes con dos modos de procesamiento de solicitudes diferentes: integrado y clásico.</span><span class="sxs-lookup"><span data-stu-id="a4343-130">IIS 7.0 can process requests using two different request processing modes: integrated and classic.</span></span> <span data-ttu-id="a4343-131">El modo integrado proporciona un mejor rendimiento y más características.</span><span class="sxs-lookup"><span data-stu-id="a4343-131">Integrated mode provides better performance and more features.</span></span> <span data-ttu-id="a4343-132">El modo clásico se incluye para la compatibilidad con versiones anteriores de IIS.</span><span class="sxs-lookup"><span data-stu-id="a4343-132">Classic mode is included for backwards compatibility with earlier versions of IIS.</span></span>

<span data-ttu-id="a4343-133">El modo de procesamiento de solicitudes viene determinado por el grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="a4343-133">The request processing mode is determined by the application pool.</span></span> <span data-ttu-id="a4343-134">Puede determinar qué modo de procesamiento utiliza una aplicación web determinada determinando el grupo de aplicaciones asociado a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4343-134">You can determine which processing mode is being used by a particular web application by determining the application pool associated with the application.</span></span> <span data-ttu-id="a4343-135">Siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="a4343-135">Follow these steps:</span></span>

1. <span data-ttu-id="a4343-136">Iniciar el administrador de Internet Information Services</span><span class="sxs-lookup"><span data-stu-id="a4343-136">Launch the Internet Information Services Manager</span></span>
2. <span data-ttu-id="a4343-137">En la ventana conexiones, seleccione una aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4343-137">In the Connections window, select an application</span></span>
3. <span data-ttu-id="a4343-138">En la ventana acciones, haga clic en el vínculo **configuración básica** para abrir el cuadro de diálogo Editar aplicación (vea la ilustración 1).</span><span class="sxs-lookup"><span data-stu-id="a4343-138">In the Actions window, click the **Basic Settings** link to open the Edit Application dialog box (see Figure 1)</span></span>
4. <span data-ttu-id="a4343-139">Tome nota del grupo de aplicaciones seleccionado.</span><span class="sxs-lookup"><span data-stu-id="a4343-139">Take note of the Application pool selected.</span></span>

<span data-ttu-id="a4343-140">De forma predeterminada, IIS está configurado para admitir dos grupos de aplicaciones: **DefaultAppPool** y **clásico .net AppPool**.</span><span class="sxs-lookup"><span data-stu-id="a4343-140">By default, IIS is configured to support two application pools: **DefaultAppPool** and **Classic .NET AppPool**.</span></span> <span data-ttu-id="a4343-141">Si DefaultAppPool está seleccionado, la aplicación se ejecuta en modo de procesamiento de solicitudes integrado.</span><span class="sxs-lookup"><span data-stu-id="a4343-141">If DefaultAppPool is selected, then your application is running in integrated request processing mode.</span></span> <span data-ttu-id="a4343-142">Si se selecciona clásico .NET AppPool, la aplicación se ejecuta en modo de procesamiento de solicitudes clásico.</span><span class="sxs-lookup"><span data-stu-id="a4343-142">If Classic .NET AppPool is selected, your application is running in classic request processing mode.</span></span>

<span data-ttu-id="a4343-143">[![el cuadro de diálogo nuevo proyecto](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image1.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a4343-143">[![The New Project dialog box](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image1.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image1.png)</span></span>

<span data-ttu-id="a4343-144">**Figura 1**: detección del modo de procesamiento de solicitudes ([haga clic para ver la imagen de tamaño completo](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="a4343-144">**Figure 1**: Detecting the request processing mode([Click to view full-size image](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image2.png))</span></span>

<span data-ttu-id="a4343-145">Tenga en cuenta que puede modificar el modo de procesamiento de solicitudes en el cuadro de diálogo Editar aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4343-145">Notice that you can modify the request processing mode within the Edit Application dialog box.</span></span> <span data-ttu-id="a4343-146">Haga clic en el botón seleccionar y cambie el grupo de aplicaciones asociado a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4343-146">Click the Select button and change the application pool associated with the application.</span></span> <span data-ttu-id="a4343-147">Observe que hay problemas de compatibilidad al cambiar una aplicación de ASP.NET del modo clásico al modo integrado.</span><span class="sxs-lookup"><span data-stu-id="a4343-147">Realize that there are compatibility issues when changing an ASP.NET application from classic to integrated mode.</span></span> <span data-ttu-id="a4343-148">Para obtener más información, vea los artículos siguientes:</span><span class="sxs-lookup"><span data-stu-id="a4343-148">For more information, see the following articles:</span></span>

- <span data-ttu-id="a4343-149">Actualización de ASP.NET 1,1 a IIS 7,0 en Windows Vista y Windows Server 2008: [https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/upgrading-aspnet-11-to-iis-on-windows-vista-and-windows-server-2008](https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/upgrading-aspnet-11-to-iis-on-windows-vista-and-windows-server-2008)</span><span class="sxs-lookup"><span data-stu-id="a4343-149">Upgrading ASP.NET 1.1 to IIS 7.0 on Windows Vista and Windows Server 2008 -- [https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/upgrading-aspnet-11-to-iis-on-windows-vista-and-windows-server-2008](https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/upgrading-aspnet-11-to-iis-on-windows-vista-and-windows-server-2008)</span></span>

- <span data-ttu-id="a4343-150">Integración de ASP.NET con IIS 7,0- [https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/aspnet-integration-with-iis](https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/aspnet-integration-with-iis)</span><span class="sxs-lookup"><span data-stu-id="a4343-150">ASP.NET Integration With IIS 7.0 - [https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/aspnet-integration-with-iis](https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/aspnet-integration-with-iis)</span></span>

<span data-ttu-id="a4343-151">Si una aplicación de ASP.NET usa DefaultAppPool, no es necesario realizar ningún paso adicional para que el enrutamiento de ASP.NET (y, por lo tanto, ASP.NET MVC) funcione.</span><span class="sxs-lookup"><span data-stu-id="a4343-151">If an ASP.NET application is using the DefaultAppPool, then you don't need to perform any additional steps to get ASP.NET Routing (and therefore ASP.NET MVC) to work.</span></span> <span data-ttu-id="a4343-152">Sin embargo, si la aplicación ASP.NET está configurada para usar el .NET AppPool clásico, siga leyendo y tendrá más trabajo que hacer.</span><span class="sxs-lookup"><span data-stu-id="a4343-152">However, if the ASP.NET application is configured to use the Classic .NET AppPool then keep reading, you have more work to do.</span></span>

## <a name="using-aspnet-mvc-with-older-versions-of-iis"></a><span data-ttu-id="a4343-153">Usar ASP.NET MVC con versiones anteriores de IIS</span><span class="sxs-lookup"><span data-stu-id="a4343-153">Using ASP.NET MVC with Older Versions of IIS</span></span>

<span data-ttu-id="a4343-154">Si necesita usar ASP.NET MVC con una versión anterior de IIS que IIS 7,0 o necesita usar IIS 7,0 en modo clásico, tiene dos opciones.</span><span class="sxs-lookup"><span data-stu-id="a4343-154">If you need to use ASP.NET MVC with an older version of IIS than IIS 7.0, or you need to use IIS 7.0 in classic mode, then you have two options.</span></span> <span data-ttu-id="a4343-155">En primer lugar, puede modificar la tabla de rutas para usar las extensiones de archivo.</span><span class="sxs-lookup"><span data-stu-id="a4343-155">First, you can modify the route table to use file extensions.</span></span> <span data-ttu-id="a4343-156">Por ejemplo, en lugar de solicitar una dirección URL como/Store/Details, solicitaría una dirección URL como/Store.aspx/Details.</span><span class="sxs-lookup"><span data-stu-id="a4343-156">For example, instead of requesting a URL like /Store/Details, you would request a URL like /Store.aspx/Details.</span></span>

<span data-ttu-id="a4343-157">La segunda opción consiste en crear algo denominado *mapa de script comodín*.</span><span class="sxs-lookup"><span data-stu-id="a4343-157">The second option is to create something called a *wildcard script map*.</span></span> <span data-ttu-id="a4343-158">Una asignación de script comodín permite asignar cada solicitud al marco ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-158">A wildcard script map enables you to map every request into the ASP.NET framework.</span></span>

<span data-ttu-id="a4343-159">Si no tiene acceso al servidor Web (por ejemplo, la aplicación ASP.NET MVC se hospeda en un proveedor de servicios de Internet), deberá usar la primera opción.</span><span class="sxs-lookup"><span data-stu-id="a4343-159">If you don't have access to your web server (for example, your ASP.NET MVC application is being hosted by an Internet Service Provider) then you'll need to use the first option.</span></span> <span data-ttu-id="a4343-160">Si no desea modificar la apariencia de las direcciones URL y tiene acceso al servidor Web, puede usar la segunda opción.</span><span class="sxs-lookup"><span data-stu-id="a4343-160">If you don't want to modify the appearance of your URLs, and you have access to your web server, then you can use the second option.</span></span>

<span data-ttu-id="a4343-161">En las secciones siguientes se explora cada opción en detalle.</span><span class="sxs-lookup"><span data-stu-id="a4343-161">We explore each option in detail in the following sections.</span></span>

## <a name="adding-extensions-to-the-route-table"></a><span data-ttu-id="a4343-162">Agregar extensiones a la tabla de rutas</span><span class="sxs-lookup"><span data-stu-id="a4343-162">Adding Extensions to the Route Table</span></span>

<span data-ttu-id="a4343-163">La forma más fácil de conseguir que el enrutamiento de ASP.NET funcione con versiones anteriores de IIS es modificar la tabla de rutas en el archivo global. asax.</span><span class="sxs-lookup"><span data-stu-id="a4343-163">The easiest way to get ASP.NET Routing to work with older versions of IIS is to modify your route table in the Global.asax file.</span></span> <span data-ttu-id="a4343-164">El archivo global. asax predeterminado y sin modificar de la lista 1 configura una ruta denominada ruta predeterminada.</span><span class="sxs-lookup"><span data-stu-id="a4343-164">The default and unmodified Global.asax file in Listing 1 configures one route named the Default route.</span></span>

<span data-ttu-id="a4343-165">**Lista 1: global. asax (sin modificar)**</span><span class="sxs-lookup"><span data-stu-id="a4343-165">**Listing 1 - Global.asax (unmodified)**</span></span>

[!code-vb[Main](using-asp-net-mvc-with-different-versions-of-iis-vb/samples/sample1.vb)]

<span data-ttu-id="a4343-166">La ruta predeterminada configurada en la lista 1 le permite enrutar las direcciones URL que tienen el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="a4343-166">The Default route configured in Listing 1 enables you to route URLs that look like this:</span></span>

<span data-ttu-id="a4343-167">/Home/Index</span><span class="sxs-lookup"><span data-stu-id="a4343-167">/Home/Index</span></span>

<span data-ttu-id="a4343-168">/Product/Details/3</span><span class="sxs-lookup"><span data-stu-id="a4343-168">/Product/Details/3</span></span>

<span data-ttu-id="a4343-169">/Product</span><span class="sxs-lookup"><span data-stu-id="a4343-169">/Product</span></span>

<span data-ttu-id="a4343-170">Desafortunadamente, las versiones anteriores de IIS no pasarán estas solicitudes al marco ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-170">Unfortunately, older versions of IIS won't pass these requests to the ASP.NET framework.</span></span> <span data-ttu-id="a4343-171">Por lo tanto, estas solicitudes no se enrutarán a un controlador.</span><span class="sxs-lookup"><span data-stu-id="a4343-171">Therefore, these requests won't get routed to a controller.</span></span> <span data-ttu-id="a4343-172">Por ejemplo, si realiza una solicitud de explorador para la dirección URL/Home/Index, obtendrá la página de error en la figura 2.</span><span class="sxs-lookup"><span data-stu-id="a4343-172">For example, if you make a browser request for the URL /Home/Index then you'll get the error page in Figure 2.</span></span>

<span data-ttu-id="a4343-173">[![el cuadro de diálogo nuevo proyecto](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image2.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="a4343-173">[![The New Project dialog box](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image2.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image3.png)</span></span>

<span data-ttu-id="a4343-174">**Figura 2**: recepción de un error 404 no encontrado ([haga clic para ver la imagen de tamaño completo](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="a4343-174">**Figure 2**: Receiving a 404 Not Found error([Click to view full-size image](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image4.png))</span></span>

<span data-ttu-id="a4343-175">Las versiones anteriores de IIS solo asignan determinadas solicitudes al marco ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-175">Older versions of IIS only map certain requests to the ASP.NET framework.</span></span> <span data-ttu-id="a4343-176">La solicitud debe ser para una dirección URL con la extensión de archivo correcta.</span><span class="sxs-lookup"><span data-stu-id="a4343-176">The request must be for a URL with the right file extension.</span></span> <span data-ttu-id="a4343-177">Por ejemplo, una solicitud de/SomePage.aspx se asigna al marco de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-177">For example, a request for /SomePage.aspx gets mapped to the ASP.NET framework.</span></span> <span data-ttu-id="a4343-178">Sin embargo, una solicitud para/SomePage.htm no lo hace.</span><span class="sxs-lookup"><span data-stu-id="a4343-178">However, a request for /SomePage.htm does not.</span></span>

<span data-ttu-id="a4343-179">Por lo tanto, para que el enrutamiento de ASP.NET funcione, es necesario modificar la ruta predeterminada para que incluya una extensión de archivo que esté asignada al marco de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-179">Therefore, to get ASP.NET Routing to work, we must modify the Default route so that it includes a file extension that is mapped to the ASP.NET framework.</span></span>

<span data-ttu-id="a4343-180">Esto se hace mediante un script denominado `registermvc.wsf`.</span><span class="sxs-lookup"><span data-stu-id="a4343-180">This is done using a script named `registermvc.wsf`.</span></span> <span data-ttu-id="a4343-181">Se incluyó con la versión ASP.NET MVC 1 en `C:\Program Files\Microsoft ASP.NET\ASP.NET MVC\Scripts`, pero a partir de ASP.NET 2 este script se ha pasado a los futuros ASP.NET, disponible en [http://aspnet.codeplex.com/releases/view/39978](http://aspnet.codeplex.com/releases/view/39978).</span><span class="sxs-lookup"><span data-stu-id="a4343-181">It was included with the ASP.NET MVC 1 release in `C:\Program Files\Microsoft ASP.NET\ASP.NET MVC\Scripts`, but as of ASP.NET 2 this script has been moved to the ASP.NET Futures, available at [http://aspnet.codeplex.com/releases/view/39978](http://aspnet.codeplex.com/releases/view/39978).</span></span>

<span data-ttu-id="a4343-182">Al ejecutar este script, se registra una nueva extensión. MVC con IIS.</span><span class="sxs-lookup"><span data-stu-id="a4343-182">Executing this script registers a new .mvc extension with IIS.</span></span> <span data-ttu-id="a4343-183">Después de registrar la extensión. MVC, puede modificar las rutas en el archivo global. asax para que las rutas usen la extensión. Mvc.</span><span class="sxs-lookup"><span data-stu-id="a4343-183">After you register the .mvc extension, you can modify your routes in the Global.asax file so that the routes use the .mvc extension.</span></span>

<span data-ttu-id="a4343-184">El archivo global. asax modificado de la lista 2 funciona con versiones anteriores de IIS.</span><span class="sxs-lookup"><span data-stu-id="a4343-184">The modified Global.asax file in Listing 2 works with older versions of IIS.</span></span>

<span data-ttu-id="a4343-185">**Lista 2-global. asax (modificado con extensiones)**</span><span class="sxs-lookup"><span data-stu-id="a4343-185">**Listing 2 - Global.asax (modified with extensions)**</span></span>

[!code-vb[Main](using-asp-net-mvc-with-different-versions-of-iis-vb/samples/sample2.vb)]

<span data-ttu-id="a4343-186">Importante: Recuerde volver a compilar la aplicación ASP.NET MVC después de cambiar el archivo global. asax.</span><span class="sxs-lookup"><span data-stu-id="a4343-186">Important: remember to build your ASP.NET MVC Application again after changing the Global.asax file.</span></span>

<span data-ttu-id="a4343-187">Hay dos cambios importantes en el archivo global. asax en la lista 2.</span><span class="sxs-lookup"><span data-stu-id="a4343-187">There are two important changes to the Global.asax file in Listing 2.</span></span> <span data-ttu-id="a4343-188">Ahora hay dos rutas definidas en global. asax.</span><span class="sxs-lookup"><span data-stu-id="a4343-188">There are now two routes defined in the Global.asax.</span></span> <span data-ttu-id="a4343-189">El patrón de dirección URL para la ruta predeterminada, la primera ruta, ahora tiene el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="a4343-189">The URL pattern for the Default route, the first route, now looks like:</span></span>

<span data-ttu-id="a4343-190">{controller}.mvc/{action}/{id}</span><span class="sxs-lookup"><span data-stu-id="a4343-190">{controller}.mvc/{action}/{id}</span></span>

<span data-ttu-id="a4343-191">La adición de la extensión. Mvc cambia el tipo de archivos que intercepta el módulo de enrutamiento ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-191">The addition of the .mvc extension changes the type of files that the ASP.NET Routing module intercepts.</span></span> <span data-ttu-id="a4343-192">Con este cambio, la aplicación ASP.NET MVC ahora enruta solicitudes como las siguientes:</span><span class="sxs-lookup"><span data-stu-id="a4343-192">With this change, the ASP.NET MVC application now routes requests like the following:</span></span>

<span data-ttu-id="a4343-193">/Home.mvc/Index/</span><span class="sxs-lookup"><span data-stu-id="a4343-193">/Home.mvc/Index/</span></span>

<span data-ttu-id="a4343-194">/Product.mvc/Details/3</span><span class="sxs-lookup"><span data-stu-id="a4343-194">/Product.mvc/Details/3</span></span>

<span data-ttu-id="a4343-195">/Product.mvc/</span><span class="sxs-lookup"><span data-stu-id="a4343-195">/Product.mvc/</span></span>

<span data-ttu-id="a4343-196">La segunda ruta, la ruta raíz, es nueva.</span><span class="sxs-lookup"><span data-stu-id="a4343-196">The second route, the Root route, is new.</span></span> <span data-ttu-id="a4343-197">Este patrón de dirección URL para la ruta raíz es una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="a4343-197">This URL pattern for the Root route is an empty string.</span></span> <span data-ttu-id="a4343-198">Esta ruta es necesaria para hacer coincidir las solicitudes realizadas con la raíz de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4343-198">This route is necessary for matching requests made against the root of your application.</span></span> <span data-ttu-id="a4343-199">Por ejemplo, la ruta raíz coincidirá con una solicitud similar a la siguiente:</span><span class="sxs-lookup"><span data-stu-id="a4343-199">For example, the Root route will match a request that looks like this:</span></span>

[http://www.YourApplication.com/](http://www.YourApplication.com/)

<span data-ttu-id="a4343-200">Después de realizar estas modificaciones en la tabla de rutas, deberá asegurarse de que todos los vínculos de la aplicación sean compatibles con estos nuevos patrones de direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="a4343-200">After making these modifications to your route table, you'll need to make sure that all of the links in your application are compatible with these new URL patterns.</span></span> <span data-ttu-id="a4343-201">En otras palabras, asegúrese de que todos los vínculos incluyen la extensión. Mvc.</span><span class="sxs-lookup"><span data-stu-id="a4343-201">In other words, make sure that all of your links include the .mvc extension.</span></span> <span data-ttu-id="a4343-202">Si usa el método auxiliar HTML. ActionLink () para generar los vínculos, no debería ser necesario realizar ningún cambio.</span><span class="sxs-lookup"><span data-stu-id="a4343-202">If you use the Html.ActionLink() helper method to generate your links, then you should not need to make any changes.</span></span>

<span data-ttu-id="a4343-203">En lugar de usar el script registermvc. WCF, puede Agregar una nueva extensión a IIS que esté asignada a ASP.NET Framework manualmente.</span><span class="sxs-lookup"><span data-stu-id="a4343-203">Instead of using the registermvc.wcf script, you can add a new extension to IIS that is mapped to the ASP.NET framework by hand.</span></span> <span data-ttu-id="a4343-204">Cuando agregue una nueva extensión, asegúrese de que la casilla **comprobar que el archivo existe** no está activada.</span><span class="sxs-lookup"><span data-stu-id="a4343-204">When adding a new extension yourself, make sure that the checkbox labeled **Verify that file exists** is not checked.</span></span>

## <a name="hosted-server"></a><span data-ttu-id="a4343-205">Servidor hospedado</span><span class="sxs-lookup"><span data-stu-id="a4343-205">Hosted Server</span></span>

<span data-ttu-id="a4343-206">No siempre tiene acceso al servidor Web.</span><span class="sxs-lookup"><span data-stu-id="a4343-206">You don't always have access to your web server.</span></span> <span data-ttu-id="a4343-207">Por ejemplo, si hospeda la aplicación ASP.NET MVC mediante un proveedor de hospedaje de Internet, no tendrá necesariamente acceso a IIS.</span><span class="sxs-lookup"><span data-stu-id="a4343-207">For example, if you are hosting your ASP.NET MVC application using an Internet Hosting Provider, then you won't necessarily have access to IIS.</span></span>

<span data-ttu-id="a4343-208">En ese caso, debe usar una de las extensiones de archivo existentes que se asignan al marco ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-208">In that case, you should use one of the existing file extensions that are mapped to the ASP.NET framework.</span></span> <span data-ttu-id="a4343-209">Entre los ejemplos de extensiones de archivo asignadas a ASP.NET se incluyen las extensiones. aspx,. axd y. ashx.</span><span class="sxs-lookup"><span data-stu-id="a4343-209">Examples of file extensions mapped to ASP.NET include the .aspx, .axd, and .ashx extensions.</span></span>

<span data-ttu-id="a4343-210">Por ejemplo, el archivo global. asax modificado de la lista 3 utiliza la extensión. aspx en lugar de la extensión. Mvc.</span><span class="sxs-lookup"><span data-stu-id="a4343-210">For example, the modified Global.asax file in Listing 3 uses the .aspx extension instead of the .mvc extension.</span></span>

<span data-ttu-id="a4343-211">**Lista 3-global. asax (modificado con extensiones. aspx)**</span><span class="sxs-lookup"><span data-stu-id="a4343-211">**Listing 3 - Global.asax (modified with .aspx extensions)**</span></span>

[!code-vb[Main](using-asp-net-mvc-with-different-versions-of-iis-vb/samples/sample3.vb)]

<span data-ttu-id="a4343-212">El archivo global. asax de la lista 3 es exactamente el mismo que el archivo global. asax anterior, excepto por el hecho de que usa la extensión. aspx en lugar de la extensión. Mvc.</span><span class="sxs-lookup"><span data-stu-id="a4343-212">The Global.asax file in Listing 3 is exactly the same as the previous Global.asax file except for the fact that it uses the .aspx extension instead of the .mvc extension.</span></span> <span data-ttu-id="a4343-213">No es necesario realizar ninguna configuración en el servidor Web remoto para utilizar la extensión. aspx.</span><span class="sxs-lookup"><span data-stu-id="a4343-213">You don't have to perform any setup on your remote web server to use the .aspx extension.</span></span>

## <a name="creating-a-wildcard-script-map"></a><span data-ttu-id="a4343-214">Creación de una asignación de script comodín</span><span class="sxs-lookup"><span data-stu-id="a4343-214">Creating a Wildcard Script Map</span></span>

<span data-ttu-id="a4343-215">Si no desea modificar las direcciones URL de la aplicación ASP.NET MVC y tiene acceso al servidor Web, tiene una opción adicional.</span><span class="sxs-lookup"><span data-stu-id="a4343-215">If you don't want to modify the URLs for your ASP.NET MVC application, and you have access to your web server, then you have an additional option.</span></span> <span data-ttu-id="a4343-216">Puede crear una asignación de script comodín que asigne todas las solicitudes al servidor Web al marco ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4343-216">You can create a wildcard script map that maps all requests to the web server to the ASP.NET framework.</span></span> <span data-ttu-id="a4343-217">De este modo, puede usar la tabla de ruta predeterminada de ASP.NET MVC con IIS 7,0 (en modo clásico) o IIS 6,0.</span><span class="sxs-lookup"><span data-stu-id="a4343-217">That way, you can use the default ASP.NET MVC route table with IIS 7.0 (in classic mode) or IIS 6.0.</span></span>

<span data-ttu-id="a4343-218">Tenga en cuenta que esta opción hace que IIS intercepte todas las solicitudes realizadas en el servidor Web.</span><span class="sxs-lookup"><span data-stu-id="a4343-218">Be aware that this option causes IIS to intercept every request made against the web server.</span></span> <span data-ttu-id="a4343-219">Esto incluye las solicitudes de imágenes, páginas ASP clásicas y páginas HTML.</span><span class="sxs-lookup"><span data-stu-id="a4343-219">This includes requests for images, classic ASP pages, and HTML pages.</span></span> <span data-ttu-id="a4343-220">Por lo tanto, la habilitación de una asignación de script comodín a ASP.NET tiene implicaciones de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="a4343-220">Therefore, enabling a wildcard script map to ASP.NET does have performance implications.</span></span>

<span data-ttu-id="a4343-221">Aquí se muestra cómo habilitar una asignación de script comodín para IIS 7,0:</span><span class="sxs-lookup"><span data-stu-id="a4343-221">Here's how you enable a wildcard script map for IIS 7.0:</span></span>

1. <span data-ttu-id="a4343-222">Seleccione la aplicación en la ventana conexiones</span><span class="sxs-lookup"><span data-stu-id="a4343-222">Select your application in the Connections window</span></span>
2. <span data-ttu-id="a4343-223">Asegúrese de que está seleccionada la vista **características** .</span><span class="sxs-lookup"><span data-stu-id="a4343-223">Make sure that the **Features** view is selected</span></span>
3. <span data-ttu-id="a4343-224">Haga doble clic en el botón **asignaciones de controlador**</span><span class="sxs-lookup"><span data-stu-id="a4343-224">Double-click the **Handler Mappings** button</span></span>
4. <span data-ttu-id="a4343-225">Haga clic en el vínculo **Agregar asignación de script comodín** (vea la figura 3).</span><span class="sxs-lookup"><span data-stu-id="a4343-225">Click the **Add Wildcard Script Map** link (see Figure 3)</span></span>
5. <span data-ttu-id="a4343-226">Escriba la ruta de acceso al archivo Aspnet\_ISAPI. dll (puede copiar esta ruta de acceso desde la asignación de script PageHandlerFactory)</span><span class="sxs-lookup"><span data-stu-id="a4343-226">Enter the path to the aspnet\_isapi.dll file (You can copy this path from the PageHandlerFactory script map)</span></span>
6. <span data-ttu-id="a4343-227">Escriba el nombre MVC</span><span class="sxs-lookup"><span data-stu-id="a4343-227">Enter the name MVC</span></span>
7. <span data-ttu-id="a4343-228">Haga clic en el botón **Aceptar**</span><span class="sxs-lookup"><span data-stu-id="a4343-228">Click the **OK** button</span></span>

<span data-ttu-id="a4343-229">[![el cuadro de diálogo nuevo proyecto](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image3.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="a4343-229">[![The New Project dialog box](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image3.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image5.png)</span></span>

<span data-ttu-id="a4343-230">**Figura 3**: creación de una asignación de script comodín con IIS 7,0 ([haga clic para ver la imagen de tamaño completo](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a4343-230">**Figure 3**: Creating a wildcard script map with IIS 7.0([Click to view full-size image](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image6.png))</span></span>

<span data-ttu-id="a4343-231">Siga estos pasos para crear un mapa de scripts comodín con IIS 6,0:</span><span class="sxs-lookup"><span data-stu-id="a4343-231">Follow these steps to create a wildcard script map with IIS 6.0:</span></span>

1. <span data-ttu-id="a4343-232">Haga clic con el botón secundario en un sitio web y seleccione Propiedades.</span><span class="sxs-lookup"><span data-stu-id="a4343-232">Right-click a website and select Properties</span></span>
2. <span data-ttu-id="a4343-233">Seleccione la pestaña **directorio principal** .</span><span class="sxs-lookup"><span data-stu-id="a4343-233">Select the **Home Directory** tab</span></span>
3. <span data-ttu-id="a4343-234">Haga clic en el botón **configuración**</span><span class="sxs-lookup"><span data-stu-id="a4343-234">Click the **Configuration** button</span></span>
4. <span data-ttu-id="a4343-235">Seleccione la pestaña **asignaciones**</span><span class="sxs-lookup"><span data-stu-id="a4343-235">Select the **Mappings** tab</span></span>
5. <span data-ttu-id="a4343-236">Haga clic en el botón **Insertar** (consulte la figura 4).</span><span class="sxs-lookup"><span data-stu-id="a4343-236">Click the **Insert** button (see Figure 4)</span></span>
6. <span data-ttu-id="a4343-237">Pegue la ruta de acceso al archivo Aspnet\_ISAPI. dll en el campo ejecutable (puede copiar esta ruta de acceso de la asignación de scripts para los archivos. aspx).</span><span class="sxs-lookup"><span data-stu-id="a4343-237">Paste the path to the aspnet\_isapi.dll into the Executable field (you can copy this path from the script map for .aspx files)</span></span>
7. <span data-ttu-id="a4343-238">Desactive la casilla **comprobar que el archivo existe**</span><span class="sxs-lookup"><span data-stu-id="a4343-238">Uncheck the checkbox labeled **Verify that file exists**</span></span>
8. <span data-ttu-id="a4343-239">Haga clic en el botón **Aceptar**</span><span class="sxs-lookup"><span data-stu-id="a4343-239">Click the **OK** button</span></span>

<span data-ttu-id="a4343-240">[![el cuadro de diálogo nuevo proyecto](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image4.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a4343-240">[![The New Project dialog box](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image4.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image7.png)</span></span>

<span data-ttu-id="a4343-241">**Figura 4**: creación de una asignación de script comodín con IIS 6,0 ([haga clic para ver la imagen de tamaño completo](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="a4343-241">**Figure 4**: Creating a wildcard script map with IIS 6.0([Click to view full-size image](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image8.png))</span></span>

<span data-ttu-id="a4343-242">Después de habilitar las asignaciones de scripts comodín, debe modificar la tabla de rutas en el archivo global. asax para que incluya una ruta raíz.</span><span class="sxs-lookup"><span data-stu-id="a4343-242">After you enable wildcard script maps, you need to modify the route table in the Global.asax file so that it includes a Root route.</span></span> <span data-ttu-id="a4343-243">De lo contrario, obtendrá la página de error en la figura 5 cuando realice una solicitud para la página raíz de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a4343-243">Otherwise, you'll get the error page in Figure 5 when you make a request for the root page of your application.</span></span> <span data-ttu-id="a4343-244">Puede usar el archivo global. asax modificado en la lista 4.</span><span class="sxs-lookup"><span data-stu-id="a4343-244">You can use the modified Global.asax file in Listing 4.</span></span>

<span data-ttu-id="a4343-245">[![el cuadro de diálogo nuevo proyecto](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image5.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="a4343-245">[![The New Project dialog box](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image5.jpg)](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image9.png)</span></span>

<span data-ttu-id="a4343-246">**Figura 5**: falta un error en la ruta raíz ([haga clic para ver la imagen de tamaño completo](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="a4343-246">**Figure 5**: Missing Root route error([Click to view full-size image](using-asp-net-mvc-with-different-versions-of-iis-vb/_static/image10.png))</span></span>

<span data-ttu-id="a4343-247">**Lista 4: global. asax (modificado con ruta raíz)**</span><span class="sxs-lookup"><span data-stu-id="a4343-247">**Listing 4 - Global.asax (modified with Root route)**</span></span>

[!code-vb[Main](using-asp-net-mvc-with-different-versions-of-iis-vb/samples/sample4.vb)]

<span data-ttu-id="a4343-248">Después de habilitar una asignación de script comodín para IIS 7,0 o IIS 6,0, puede hacer que las solicitudes que funcionan con la tabla de rutas predeterminada tengan el aspecto siguiente:</span><span class="sxs-lookup"><span data-stu-id="a4343-248">After you enable a wildcard script map for either IIS 7.0 or IIS 6.0, you can make requests that work with the default route table that look like this:</span></span>

/

<span data-ttu-id="a4343-249">/Home/Index</span><span class="sxs-lookup"><span data-stu-id="a4343-249">/Home/Index</span></span>

<span data-ttu-id="a4343-250">/Product/Details/3</span><span class="sxs-lookup"><span data-stu-id="a4343-250">/Product/Details/3</span></span>

<span data-ttu-id="a4343-251">/Product</span><span class="sxs-lookup"><span data-stu-id="a4343-251">/Product</span></span>

## <a name="summary"></a><span data-ttu-id="a4343-252">Resumen</span><span class="sxs-lookup"><span data-stu-id="a4343-252">Summary</span></span>

<span data-ttu-id="a4343-253">El objetivo de este tutorial era explicar cómo se puede usar ASP.NET MVC cuando se usa una versión anterior de IIS (o IIS 7,0 en modo clásico).</span><span class="sxs-lookup"><span data-stu-id="a4343-253">The goal of this tutorial was to explain how you can use ASP.NET MVC when using an older version of IIS (or IIS 7.0 in classic mode).</span></span> <span data-ttu-id="a4343-254">Analizamos dos métodos para que el enrutamiento de ASP.NET funcione con versiones anteriores de IIS: modificar la tabla de rutas predeterminada o crear una asignación de script comodín.</span><span class="sxs-lookup"><span data-stu-id="a4343-254">We discussed two methods of getting ASP.NET Routing to work with older versions of IIS: Modify the default route table or create a wildcard script map.</span></span>

<span data-ttu-id="a4343-255">La primera opción requiere que modifique las direcciones URL usadas en la aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="a4343-255">The first option requires you to modify the URLs used in your ASP.NET MVC application.</span></span> <span data-ttu-id="a4343-256">Una ventaja muy importante de esta primera opción es que no necesita acceso a un servidor web para modificar la tabla de rutas.</span><span class="sxs-lookup"><span data-stu-id="a4343-256">One very significant advantage of this first option is that you do not need access to a web server in order to modify the route table.</span></span> <span data-ttu-id="a4343-257">Esto significa que puede usar esta primera opción incluso al hospedar su aplicación ASP.NET MVC con una empresa de hospedaje de Internet.</span><span class="sxs-lookup"><span data-stu-id="a4343-257">That means that you can use this first option even when hosting your ASP.NET MVC application with an Internet hosting company.</span></span>

<span data-ttu-id="a4343-258">La segunda opción consiste en crear una asignación de script comodín.</span><span class="sxs-lookup"><span data-stu-id="a4343-258">The second option is to create a wildcard script map.</span></span> <span data-ttu-id="a4343-259">La ventaja de esta segunda opción es que no es necesario modificar las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="a4343-259">The advantage of this second option is that you do not need to modify your URLs.</span></span> <span data-ttu-id="a4343-260">El inconveniente de esta segunda opción es que puede afectar al rendimiento de la aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="a4343-260">The disadvantage of this second option is that it can impact the performance of your ASP.NET MVC application.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="a4343-261">Anterior</span><span class="sxs-lookup"><span data-stu-id="a4343-261">Previous</span></span>](using-asp-net-mvc-with-different-versions-of-iis-cs.md)

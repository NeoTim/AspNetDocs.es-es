---
uid: web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
title: Mostrar datos binarios en la Web de datos controla (VB) | Microsoft Docs
author: rick-anderson
description: En este tutorial, nos centramos en las opciones para presentar datos binarios en una página Web, incluida la visualización de un archivo de imagen y el aprovisionamiento de un vínculo 'Descargar' f...
ms.author: riande
ms.date: 03/27/2007
ms.assetid: 9201656a-e1c2-4020-824b-18fb632d2925
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/displaying-binary-data-in-the-data-web-controls-vb
msc.type: authoredcontent
ms.openlocfilehash: 19c377e0f0cd9b27ac7c05af0ab050d8e213fe69
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/25/2019
ms.locfileid: "58424656"
---
<a name="displaying-binary-data-in-the-data-web-controls-vb"></a><span data-ttu-id="d842f-103">Mostrar datos binarios en los controles web de datos (VB)</span><span class="sxs-lookup"><span data-stu-id="d842f-103">Displaying Binary Data in the Data Web Controls (VB)</span></span>
====================
<span data-ttu-id="d842f-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d842f-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d842f-105">[Descargue la aplicación de ejemplo](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) o [descargar PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d842f-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_55_VB.exe) or [Download PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/datatutorial55vb1.pdf)</span></span>

> <span data-ttu-id="d842f-106">En este tutorial, nos centramos en las opciones para presentar datos binarios en una página Web, incluida la visualización de un archivo de imagen y el aprovisionamiento de un vínculo "Descargar" para un archivo PDF.</span><span class="sxs-lookup"><span data-stu-id="d842f-106">In this tutorial we look at the options to present binary data on a Web page, including the display of an image file and the provision of a 'Download' link for a PDF file.</span></span>


## <a name="introduction"></a><span data-ttu-id="d842f-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="d842f-107">Introduction</span></span>

<span data-ttu-id="d842f-108">En el tutorial anterior hemos explorado las dos técnicas para asociar datos binarios con un modelo de datos de aplicación s subyacente y usa el control FileUpload para cargar archivos desde un explorador en el sistema de archivos de s de servidor web.</span><span class="sxs-lookup"><span data-stu-id="d842f-108">In the preceding tutorial we explored the two techniques for associating binary data with an application s underlying data model and used the FileUpload control to upload files from a browser to the web server s file system.</span></span> <span data-ttu-id="d842f-109">Se ve aún para ver cómo asociar los datos binarios cargados con el modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="d842f-109">We ve yet to see how to associate the uploaded binary data with the data model.</span></span> <span data-ttu-id="d842f-110">Es decir, después de un archivo se ha cargado y guardado en el sistema de archivos, una ruta de acceso al archivo debe almacenarse en el registro de base de datos adecuada.</span><span class="sxs-lookup"><span data-stu-id="d842f-110">That is, after a file has been uploaded and saved to the file system, a path to the file must be stored in the appropriate database record.</span></span> <span data-ttu-id="d842f-111">Si se va a almacenar los datos directamente en la base de datos, a continuación, los datos binarios cargados no se deben guardar en el sistema de archivos, pero deben insertarse en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d842f-111">If the data is being stored directly in the database, then the uploaded binary data need not be saved to the file system, but must be injected into the database.</span></span>

<span data-ttu-id="d842f-112">Antes de adentrarnos en asociar los datos con el modelo de datos, sin embargo, permiten s primer vistazo a cómo proporcionar los datos binarios para el usuario final.</span><span class="sxs-lookup"><span data-stu-id="d842f-112">Before we look at associating the data with the data model, though, let s first look at how to provide the binary data to the end user.</span></span> <span data-ttu-id="d842f-113">Presentar los datos de texto es bastante sencillo, pero ¿cómo se deben presentar datos binarios?</span><span class="sxs-lookup"><span data-stu-id="d842f-113">Presenting text data is simple enough, but how should binary data be presented?</span></span> <span data-ttu-id="d842f-114">Depende, por supuesto, el tipo de datos binarios.</span><span class="sxs-lookup"><span data-stu-id="d842f-114">It depends, of course, on the type of binary data.</span></span> <span data-ttu-id="d842f-115">Para las imágenes, que es probable que queremos mostrar la imagen. para archivos PDF, documentos de Microsoft Word, archivos ZIP y otros tipos de datos binarios, que proporciona un vínculo de descarga es probablemente más apropiado.</span><span class="sxs-lookup"><span data-stu-id="d842f-115">For images, we likely want to display the image; for PDFs, Microsoft Word documents, ZIP files, and other types of binary data, providing a Download link is probably more appropriate.</span></span>

<span data-ttu-id="d842f-116">En este tutorial de que veremos cómo presentar los datos binarios junto con sus datos de texto asociado con los datos controles Web como GridView y DetailsView.</span><span class="sxs-lookup"><span data-stu-id="d842f-116">In this tutorial we will look at how to present the binary data alongside its associated text data using data Web controls like the GridView and DetailsView.</span></span> <span data-ttu-id="d842f-117">En el siguiente tutorial, centraremos nuestra atención para asociar un archivo cargado a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d842f-117">In the next tutorial we'll turn our attention to associating an uploaded file with the database.</span></span>

## <a name="step-1-providingbrochurepathvalues"></a><span data-ttu-id="d842f-118">Paso 1: Proporcionar`BrochurePath`valores</span><span class="sxs-lookup"><span data-stu-id="d842f-118">Step 1: Providing`BrochurePath`Values</span></span>

<span data-ttu-id="d842f-119">El `Picture` columna en el `Categories` tabla ya contiene datos binarios para las distintas imágenes de categoría.</span><span class="sxs-lookup"><span data-stu-id="d842f-119">The `Picture` column in the `Categories` table already contains binary data for the various category images.</span></span> <span data-ttu-id="d842f-120">En concreto, la `Picture` columna para cada registro contiene el contenido binario de una imagen de mapa de bits granuladas, baja calidad, 16 colores.</span><span class="sxs-lookup"><span data-stu-id="d842f-120">Specifically, the `Picture` column for each record holds the binary contents of a grainy, low-quality, 16-color bitmap image.</span></span> <span data-ttu-id="d842f-121">Cada imagen de la categoría es 172 píxeles de anchos y 120 píxeles de alto y consume aproximadamente 11 KB.</span><span class="sxs-lookup"><span data-stu-id="d842f-121">Each category image is 172 pixels wide and 120 pixels tall and consumes roughly 11 KB.</span></span> <span data-ttu-id="d842f-122">Novedades más, el contenido binario en el `Picture` columna incluye un 78 bytes [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) encabezado que debe eliminarse antes de mostrar la imagen.</span><span class="sxs-lookup"><span data-stu-id="d842f-122">What s more, the binary content in the `Picture` column includes a 78-byte [OLE](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding) header that must be stripped before displaying the image.</span></span> <span data-ttu-id="d842f-123">Esta información de encabezado está presente porque la base de datos Northwind tiene sus raíces en Microsoft Access.</span><span class="sxs-lookup"><span data-stu-id="d842f-123">This header information is present because the Northwind database has its roots in Microsoft Access.</span></span> <span data-ttu-id="d842f-124">En el acceso, los datos binarios se almacenan con el tipo de datos del objeto OLE, que agrega este encabezado.</span><span class="sxs-lookup"><span data-stu-id="d842f-124">In Access, binary data is stored using the OLE Object data type, which tacks on this header.</span></span> <span data-ttu-id="d842f-125">Por ahora, veremos cómo retirar los encabezados de estas imágenes de baja calidad con el fin de mostrar la imagen.</span><span class="sxs-lookup"><span data-stu-id="d842f-125">For now, we'll see how to strip the headers from these low-quality images in order to display the picture.</span></span> <span data-ttu-id="d842f-126">En un futuro tutorial crearemos una interfaz para actualizar una categoría s `Picture` columna y reemplazar estas imágenes de mapa de bits que usan encabezados OLE con las imágenes JPG equivalente sin los encabezados OLE innecesarios.</span><span class="sxs-lookup"><span data-stu-id="d842f-126">In a future tutorial we'll build an interface for updating a category s `Picture` column and replace these bitmap images that use OLE headers with equivalent JPG images without the unnecessary OLE headers.</span></span>

<span data-ttu-id="d842f-127">En el tutorial anterior, vimos cómo usar el control FileUpload.</span><span class="sxs-lookup"><span data-stu-id="d842f-127">In the preceding tutorial we saw how to use the FileUpload control.</span></span> <span data-ttu-id="d842f-128">Por lo tanto, puede continuar y agregar los archivos de catálogo para el sistema de archivos de s de servidor web.</span><span class="sxs-lookup"><span data-stu-id="d842f-128">Therefore, you can go ahead and add brochure files to the web server s file system.</span></span> <span data-ttu-id="d842f-129">Al hacerlo, sin embargo, no se actualiza el `BrochurePath` columna en el `Categories` tabla.</span><span class="sxs-lookup"><span data-stu-id="d842f-129">Doing so, however, does not update the `BrochurePath` column in the `Categories` table.</span></span> <span data-ttu-id="d842f-130">En el siguiente tutorial veremos cómo lograr esto, pero por ahora necesitamos proporcionar manualmente los valores de esta columna.</span><span class="sxs-lookup"><span data-stu-id="d842f-130">In the next tutorial we'll see how to accomplish this, but for now we need to manually provide values for this column.</span></span>

<span data-ttu-id="d842f-131">En esta descarga tutorial s encontrará siete archivos de folleto PDF en el `~/Brochures` carpeta, uno para cada una de las categorías, excepto los Mariscos.</span><span class="sxs-lookup"><span data-stu-id="d842f-131">In this tutorial s download you'll find seven PDF brochure files in the `~/Brochures` folder, one for each of the categories except Seafood.</span></span> <span data-ttu-id="d842f-132">Omití intencionadamente agregando un folleto mariscos para ilustrar cómo tratar escenarios donde no todos los registros tienen datos binarios asociados.</span><span class="sxs-lookup"><span data-stu-id="d842f-132">I purposefully omitted adding a Seafood brochure to illustrate how to handle scenarios where not all records have associated binary data.</span></span> <span data-ttu-id="d842f-133">Para actualizar el `Categories` con estos valores de tabla, haga doble clic en el `Categories` nodo del explorador de servidores y elija Mostrar datos de tabla.</span><span class="sxs-lookup"><span data-stu-id="d842f-133">To update the `Categories` table with these values, right-click on the `Categories` node from Server Explorer and choose Show Table Data.</span></span> <span data-ttu-id="d842f-134">A continuación, escriba las rutas de acceso virtuales a los archivos de catálogo para cada categoría que tiene un folleto, como se muestra en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="d842f-134">Then, enter the virtual paths to the brochure files for each category that has a brochure, as Figure 1 shows.</span></span> <span data-ttu-id="d842f-135">Dado que no hay ningún catálogo para la categoría mariscos, deje su `BrochurePath` valor de columna s como `NULL`.</span><span class="sxs-lookup"><span data-stu-id="d842f-135">Since there is no brochure for the Seafood category, leave its `BrochurePath` column s value as `NULL`.</span></span>


<span data-ttu-id="d842f-136">[![Especifique manualmente los valores para la columna de categorías tabla s BrochurePath](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-136">[![Manually Enter the Values for the Categories Table s BrochurePath Column](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image1.png)</span></span>

<span data-ttu-id="d842f-137">**Figura 1**: Especifique manualmente los valores para el `Categories` tabla s `BrochurePath` columna ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-137">**Figure 1**: Manually Enter the Values for the `Categories` Table s `BrochurePath` Column ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.png))</span></span>


## <a name="step-2-providing-a-download-link-for-the-brochures-in-a-gridview"></a><span data-ttu-id="d842f-138">Paso 2: Proporcionar un vínculo de descarga para los folletos en un control GridView</span><span class="sxs-lookup"><span data-stu-id="d842f-138">Step 2: Providing a Download Link for the Brochures in a GridView</span></span>

<span data-ttu-id="d842f-139">Con el `BrochurePath` valores proporcionados para el `Categories` tabla, que está listo para crear un control GridView que muestra cada categoría junto con un vínculo para descargar el folleto categoría s.</span><span class="sxs-lookup"><span data-stu-id="d842f-139">With the `BrochurePath` values provided for the `Categories` table, we re ready to create a GridView that lists each category along with a link to download the category s brochure.</span></span> <span data-ttu-id="d842f-140">En el paso 4, ampliaremos esta GridView para mostrar también la imagen de la categoría s.</span><span class="sxs-lookup"><span data-stu-id="d842f-140">In Step 4 we'll extend this GridView to also display the category s image.</span></span>

<span data-ttu-id="d842f-141">Iniciar, arrastre un control GridView en el cuadro de herramientas hasta el Diseñador de la `DisplayOrDownloadData.aspx` página en el `BinaryData` carpeta.</span><span class="sxs-lookup"><span data-stu-id="d842f-141">Start by dragging a GridView from the Toolbox onto the Designer of the `DisplayOrDownloadData.aspx` page in the `BinaryData` folder.</span></span> <span data-ttu-id="d842f-142">Establezca la s GridView `ID` a `Categories` y a través de la etiqueta inteligente de GridView s, elija para enlazarla a un nuevo origen de datos.</span><span class="sxs-lookup"><span data-stu-id="d842f-142">Set the GridView s `ID` to `Categories` and through the GridView s smart tag, choose to bind it to a new data source.</span></span> <span data-ttu-id="d842f-143">En concreto, enlazarlo a un origen ObjectDataSource denominado `CategoriesDataSource` que recupera datos mediante el `CategoriesBLL` objeto s `GetCategories()` método.</span><span class="sxs-lookup"><span data-stu-id="d842f-143">Specifically, bind it to an ObjectDataSource named `CategoriesDataSource` that retrieves data using the `CategoriesBLL` object s `GetCategories()` method.</span></span>


<span data-ttu-id="d842f-144">[![Crear un nuevo origen ObjectDataSource denominado CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-144">[![Create a New ObjectDataSource Named CategoriesDataSource](displaying-binary-data-in-the-data-web-controls-vb/_static/image2.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.png)</span></span>

<span data-ttu-id="d842f-145">**Figura 2**: Crear un nuevo origen ObjectDataSource denominado `CategoriesDataSource` ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-145">**Figure 2**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.png))</span></span>


<span data-ttu-id="d842f-146">[![Configurar el origen ObjectDataSource para usar la clase CategoriesBLL](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-146">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](displaying-binary-data-in-the-data-web-controls-vb/_static/image3.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.png)</span></span>

<span data-ttu-id="d842f-147">**Figura 3**: Configurar el origen ObjectDataSource que se usarán el `CategoriesBLL` clase ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-147">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.png))</span></span>


<span data-ttu-id="d842f-148">[![Recuperar la lista de categorías mediante el método GetCategories()](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-148">[![Retrieve the List of Categories Using the GetCategories() Method](displaying-binary-data-in-the-data-web-controls-vb/_static/image4.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.png)</span></span>

<span data-ttu-id="d842f-149">**Figura 4**: Recuperar la lista de categorías mediante el `GetCategories()` método ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-149">**Figure 4**: Retrieve the List of Categories Using the `GetCategories()` Method ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.png))</span></span>


<span data-ttu-id="d842f-150">Después de completar el Asistente para configurar orígenes de datos, Visual Studio agregará automáticamente un BoundField a la `Categories` GridView para la `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, y `BrochurePath` `DataColumn` s.</span><span class="sxs-lookup"><span data-stu-id="d842f-150">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField to the `Categories` GridView for the `CategoryID`, `CategoryName`, `Description`, `NumberOfProducts`, and `BrochurePath` `DataColumn` s.</span></span> <span data-ttu-id="d842f-151">Continuar y eliminar el `NumberOfProducts` BoundField desde el `GetCategories()` consulta método s no recuperar esta información.</span><span class="sxs-lookup"><span data-stu-id="d842f-151">Go ahead and remove the `NumberOfProducts` BoundField since the `GetCategories()` method s query does not retrieve this information.</span></span> <span data-ttu-id="d842f-152">Quitar también el `CategoryID` BoundField y cambiar el nombre de la `CategoryName` y `BrochurePath` BoundFields `HeaderText` propiedades a la categoría y el folleto, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="d842f-152">Also remove the `CategoryID` BoundField and rename the `CategoryName` and `BrochurePath` BoundFields `HeaderText` properties to Category and Brochure, respectively.</span></span> <span data-ttu-id="d842f-153">Después de realizar estos cambios, el marcado declarativo de s GridView y ObjectDataSource debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="d842f-153">After making these changes, your GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample1.aspx)]

<span data-ttu-id="d842f-154">Ver esta página a través de un explorador (consulte la figura 5).</span><span class="sxs-lookup"><span data-stu-id="d842f-154">View this page through a browser (see Figure 5).</span></span> <span data-ttu-id="d842f-155">Se muestra cada una de las ocho categorías.</span><span class="sxs-lookup"><span data-stu-id="d842f-155">Each of the eight categories is listed.</span></span> <span data-ttu-id="d842f-156">Las siete categorías con `BrochurePath` valores tienen la `BrochurePath` valor mostrado en el BoundField respectivo.</span><span class="sxs-lookup"><span data-stu-id="d842f-156">The seven categories with `BrochurePath` values have the `BrochurePath` value displayed in the respective BoundField.</span></span> <span data-ttu-id="d842f-157">Mariscos, que tiene un `NULL` valor para su `BrochurePath`, muestra una celda vacía.</span><span class="sxs-lookup"><span data-stu-id="d842f-157">Seafood, which has a `NULL` value for its `BrochurePath`, displays an empty cell.</span></span>


<span data-ttu-id="d842f-158">[![Se muestra cada categoría s nombre, descripción y valor BrochurePath](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-158">[![Each Category s Name, Description, and BrochurePath Value is Listed](displaying-binary-data-in-the-data-web-controls-vb/_static/image5.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.png)</span></span>

<span data-ttu-id="d842f-159">**Figura 5**: Cada categoría s nombre, descripción, y `BrochurePath` valor aparece ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-159">**Figure 5**: Each Category s Name, Description, and `BrochurePath` Value is Listed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.png))</span></span>


<span data-ttu-id="d842f-160">En lugar de mostrar el texto de la `BrochurePath` columna, desea crear un vínculo al folleto.</span><span class="sxs-lookup"><span data-stu-id="d842f-160">Rather than displaying the text of the `BrochurePath` column, we want to create a link to the brochure.</span></span> <span data-ttu-id="d842f-161">Para lograr esto, quite el `BrochurePath` BoundField y reemplazarlo por un campo Hyperlink.</span><span class="sxs-lookup"><span data-stu-id="d842f-161">To accomplish this, remove the `BrochurePath` BoundField and replace it with a HyperLinkField.</span></span> <span data-ttu-id="d842f-162">Establecer la nueva s campo HYPERLINK `HeaderText` propiedad folleto, su `Text` propiedad a la vista de catálogo y su `DataNavigateUrlFields` propiedad `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="d842f-162">Set the new HyperLinkField s `HeaderText` property to Brochure, its `Text` property to View Brochure, and its `DataNavigateUrlFields` property to `BrochurePath`.</span></span>


![Agregar un campo HYPERLINK para BrochurePath](displaying-binary-data-in-the-data-web-controls-vb/_static/image6.gif)

<span data-ttu-id="d842f-164">**Figura 6**: Agregar un campo HYPERLINK para `BrochurePath`</span><span class="sxs-lookup"><span data-stu-id="d842f-164">**Figure 6**: Add a HyperLinkField for `BrochurePath`</span></span>


<span data-ttu-id="d842f-165">Esto agregará una columna de vínculos en el control GridView, como se muestra en la figura 7.</span><span class="sxs-lookup"><span data-stu-id="d842f-165">This will add a column of links to the GridView, as Figure 7 shows.</span></span> <span data-ttu-id="d842f-166">Al hacer clic en un vínculo de vista folleto se mostrar el PDF directamente en el explorador o pedir al usuario que descargue el archivo, dependiendo de si está instalado un lector de PDF y la configuración del explorador s.</span><span class="sxs-lookup"><span data-stu-id="d842f-166">Clicking a View Brochure link will either display the PDF directly in the browser or prompt the user to download the file, depending on whether a PDF reader is installed and the browser s settings.</span></span>


<span data-ttu-id="d842f-167">[![Una categoría s folleto puede verse haciendo clic en el vínculo de folleto de vista](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-167">[![A Category s Brochure Can Be Viewed by Clicking the View Brochure Link](displaying-binary-data-in-the-data-web-controls-vb/_static/image7.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.png)</span></span>

<span data-ttu-id="d842f-168">**Figura 7**: Una categoría s folleto pueden verse haciendo clic en el vínculo de folleto de vista ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-168">**Figure 7**: A Category s Brochure Can Be Viewed by Clicking the View Brochure Link ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.png))</span></span>


<span data-ttu-id="d842f-169">[![Se muestra la categoría s folleto PDF](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-169">[![The Category s Brochure PDF is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image8.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.png)</span></span>

<span data-ttu-id="d842f-170">**Figura 8**: Se muestra la categoría s folleto PDF ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-170">**Figure 8**: The Category s Brochure PDF is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image14.png))</span></span>


## <a name="hiding-the-view-brochure-text-for-categories-without-a-brochure"></a><span data-ttu-id="d842f-171">Ocultar el texto del folleto de vista de categorías sin un folleto</span><span class="sxs-lookup"><span data-stu-id="d842f-171">Hiding the View Brochure Text for Categories Without a Brochure</span></span>

<span data-ttu-id="d842f-172">Como se muestra en la figura 7, el `BrochurePath` campo HYPERLINK muestra su `Text` el valor de propiedad (vista de catálogo) para todos los registros, independientemente de si allí s que no es`NULL` valor `BrochurePath`.</span><span class="sxs-lookup"><span data-stu-id="d842f-172">As Figure 7 shows, the `BrochurePath` HyperLinkField displays its `Text` property value ( View Brochure ) for all records, regardless of whether there s a non-`NULL` value for `BrochurePath`.</span></span> <span data-ttu-id="d842f-173">Por supuesto, si `BrochurePath` es `NULL`, a continuación, se muestra el vínculo como de sólo texto, como sucede con la categoría mariscos (consulte la vuelta a la figura 7).</span><span class="sxs-lookup"><span data-stu-id="d842f-173">Of course, if `BrochurePath` is `NULL`, then the link is displayed as text only, as is the case with the Seafood category (refer back to Figure 7).</span></span> <span data-ttu-id="d842f-174">En lugar de mostrar el texto de la vista de catálogo, sería bueno tener esas categorías sin un `BrochurePath` valor muestran algún texto alternativo, como No disponible de folleto.</span><span class="sxs-lookup"><span data-stu-id="d842f-174">Rather than displaying the text View Brochure, it might be nice to have those categories without a `BrochurePath` value display some alternate text, like No Brochure Available.</span></span>

<span data-ttu-id="d842f-175">Para proporcionar este comportamiento, debemos usar TemplateField cuyo contenido se genera mediante una llamada a un método de página que emite el resultado adecuado según la `BrochurePath` valor.</span><span class="sxs-lookup"><span data-stu-id="d842f-175">In order to provide this behavior, we need to use a TemplateField whose content is generated via a call to a page method that emits the appropriate output based on the `BrochurePath` value.</span></span> <span data-ttu-id="d842f-176">En primer lugar exploramos esta técnica de formato en el [uso de TemplateFields en el GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="d842f-176">We first explored this formatting technique back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial.</span></span>

<span data-ttu-id="d842f-177">Convertir el campo HYPERLINK en TemplateField seleccionando el `BrochurePath` campo Hyperlink y, a continuación, haga clic en la función Convert este campo en TemplateField vinculan en el cuadro de diálogo Editar columnas.</span><span class="sxs-lookup"><span data-stu-id="d842f-177">Turn the HyperLinkField into a TemplateField by selecting the `BrochurePath` HyperLinkField and then clicking on the Convert this field into a TemplateField link in the Edit Columns dialog box.</span></span>


![Convertir el campo HYPERLINK en TemplateField](displaying-binary-data-in-the-data-web-controls-vb/_static/image9.gif)

<span data-ttu-id="d842f-179">**Figura 9**: Convertir el campo HYPERLINK en TemplateField</span><span class="sxs-lookup"><span data-stu-id="d842f-179">**Figure 9**: Convert the HyperLinkField into a TemplateField</span></span>


<span data-ttu-id="d842f-180">Esto creará un TemplateField con un `ItemTemplate` que contiene un hipervínculo de Web control cuya `NavigateUrl` propiedad está enlazada a la `BrochurePath` valor.</span><span class="sxs-lookup"><span data-stu-id="d842f-180">This will create a TemplateField with an `ItemTemplate` that contains a HyperLink Web control whose `NavigateUrl` property is bound to the `BrochurePath` value.</span></span> <span data-ttu-id="d842f-181">Reemplace este marcado con una llamada al método `GenerateBrochureLink`, pasando el valor de `BrochurePath`:</span><span class="sxs-lookup"><span data-stu-id="d842f-181">Replace this markup with a call to the method `GenerateBrochureLink`, passing in the value of `BrochurePath`:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample2.aspx)]

<span data-ttu-id="d842f-182">A continuación, cree un `Protected` método ASP.NET página clase de código subyacente de s denominada `GenerateBrochureLink` que devuelve un `String` y acepta un `Object` como un parámetro de entrada.</span><span class="sxs-lookup"><span data-stu-id="d842f-182">Next, create a `Protected` method in the ASP.NET page s code-behind class named `GenerateBrochureLink` that returns a `String` and accepts an `Object` as an input parameter.</span></span>


[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample3.vb)]

<span data-ttu-id="d842f-183">Este método determina si en el pasado `Object` valor es una base de datos `NULL` y, si es así, devuelve un mensaje que indica que la categoría carece de un folleto.</span><span class="sxs-lookup"><span data-stu-id="d842f-183">This method determines if the passed-in `Object` value is a database `NULL` and, if so, returns a message indicating that the category lacks a brochure.</span></span> <span data-ttu-id="d842f-184">En caso contrario, si hay un `BrochurePath` valor, se muestra en un hipervínculo.</span><span class="sxs-lookup"><span data-stu-id="d842f-184">Otherwise, if there is a `BrochurePath` value, it s displayed in a hyperlink.</span></span> <span data-ttu-id="d842f-185">Observe que si el `BrochurePath` valor es presentarlos s pasado el [ `ResolveUrl(url)` método](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span><span class="sxs-lookup"><span data-stu-id="d842f-185">Note that if the `BrochurePath` value is present it s passed into the [`ResolveUrl(url)` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveurl.aspx).</span></span> <span data-ttu-id="d842f-186">Este método resuelve en el pasado *url*, reemplazando el `~` carácter con la ruta de acceso virtual adecuada.</span><span class="sxs-lookup"><span data-stu-id="d842f-186">This method resolves the passed-in *url*, replacing the `~` character with the appropriate virtual path.</span></span> <span data-ttu-id="d842f-187">Por ejemplo, si la aplicación se ha modificado en `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` devolverá `/Tutorial55/Brochures/Meat.pdf`.</span><span class="sxs-lookup"><span data-stu-id="d842f-187">For example, if the application is rooted at `/Tutorial55`, `ResolveUrl("~/Brochures/Meats.pdf")` will return `/Tutorial55/Brochures/Meat.pdf`.</span></span>

<span data-ttu-id="d842f-188">Figura 10 muestra la página después de aplicar estos cambios.</span><span class="sxs-lookup"><span data-stu-id="d842f-188">Figure 10 shows the page after these changes have been applied.</span></span> <span data-ttu-id="d842f-189">Tenga en cuenta que la categoría mariscos s `BrochurePath` campo ahora muestra el texto No folleto disponibles.</span><span class="sxs-lookup"><span data-stu-id="d842f-189">Note that the Seafood category s `BrochurePath` field now displays the text No Brochure Available .</span></span>


<span data-ttu-id="d842f-190">[![Los contadores de folleto de texto No se muestra para las categorías sin un folleto](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-190">[![The Text No Brochure Available is Displayed for Those Categories Without a Brochure](displaying-binary-data-in-the-data-web-controls-vb/_static/image10.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image15.png)</span></span>

<span data-ttu-id="d842f-191">**Figura 10**: Los contadores de folleto de texto No se muestra para las categorías sin un folleto ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-191">**Figure 10**: The Text No Brochure Available is Displayed for Those Categories Without a Brochure ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image16.png))</span></span>


## <a name="step-3-adding-a-web-page-to-display-a-category-s-picture"></a><span data-ttu-id="d842f-192">Paso 3: Adición de una página Web para mostrar una imagen de s de categoría</span><span class="sxs-lookup"><span data-stu-id="d842f-192">Step 3: Adding a Web Page to Display a Category s Picture</span></span>

<span data-ttu-id="d842f-193">Cuando un usuario visita una página ASP.NET, que reciben la s HTML de la página de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d842f-193">When a user visits an ASP.NET page, they receive the ASP.NET page s HTML.</span></span> <span data-ttu-id="d842f-194">La HTML recibida es simplemente texto y no contener cualquier dato binario.</span><span class="sxs-lookup"><span data-stu-id="d842f-194">The received HTML is just text and does not contain any binary data.</span></span> <span data-ttu-id="d842f-195">Cualquier dato binario adicional, como imágenes, archivos de sonido, las aplicaciones de Macromedia Flash, vídeos de Windows Media Player incrustado y así sucesivamente, existe como recursos independientes en el servidor web.</span><span class="sxs-lookup"><span data-stu-id="d842f-195">Any additional binary data, such as images, sound files, Macromedia Flash applications, embedded Windows Media Player videos, and so forth, exist as separate resources on the web server.</span></span> <span data-ttu-id="d842f-196">El código HTML contiene referencias a estos archivos, pero no incluye el contenido real de los archivos.</span><span class="sxs-lookup"><span data-stu-id="d842f-196">The HTML contains references to these files, but does not include the actual contents of the files.</span></span>

<span data-ttu-id="d842f-197">Por ejemplo, en HTML el `<img>` elemento se usa para hacer referencia a una imagen, con el `src` atributo al que apunta al archivo de imagen de este modo:</span><span class="sxs-lookup"><span data-stu-id="d842f-197">For example, in HTML the `<img>` element is used to reference a picture, with the `src` attribute pointing to the image file like so:</span></span>


[!code-html[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample4.html)]

<span data-ttu-id="d842f-198">Cuando un explorador recibe este código HTML, realiza otra solicitud al servidor web para recuperar el contenido binario del archivo de imagen, que muestra a continuación, en el explorador.</span><span class="sxs-lookup"><span data-stu-id="d842f-198">When a browser receives this HTML, it makes another request to the web server to retrieve the binary contents of the image file, which it then displays in the browser.</span></span> <span data-ttu-id="d842f-199">El mismo concepto se aplica a cualquier dato binario.</span><span class="sxs-lookup"><span data-stu-id="d842f-199">The same concept applies to any binary data.</span></span> <span data-ttu-id="d842f-200">En el paso 2, no se envió el folleto hacia abajo en el explorador como parte del marcado de página s HTML.</span><span class="sxs-lookup"><span data-stu-id="d842f-200">In Step 2, the brochure was not sent down to the browser as part of the page s HTML markup.</span></span> <span data-ttu-id="d842f-201">En su lugar, el HTML representado proporciona hipervínculos que, al hacer clic, provocaba que el explorador solicitar el documento PDF directamente.</span><span class="sxs-lookup"><span data-stu-id="d842f-201">Rather, the rendered HTML provided hyperlinks that, when clicked, caused the browser to request the PDF document directly.</span></span>

<span data-ttu-id="d842f-202">Para mostrar o permitir que los usuarios descargar datos binarios que se encuentra en la base de datos, es necesario crear una página web independiente que devuelve los datos.</span><span class="sxs-lookup"><span data-stu-id="d842f-202">To display or allow users to download binary data that resides within the database, we need to create a separate web page that returns the data.</span></span> <span data-ttu-id="d842f-203">Para nuestra aplicación, solo un campo de datos binarios allí s almacenado directamente en la imagen de la base de datos la s de categoría.</span><span class="sxs-lookup"><span data-stu-id="d842f-203">For our application, there s only one binary data field stored directly in the database the category s picture.</span></span> <span data-ttu-id="d842f-204">Por lo tanto, necesitamos una página que, cuando se llama, devuelve los datos de imagen para una categoría determinada.</span><span class="sxs-lookup"><span data-stu-id="d842f-204">Therefore, we need a page that, when called, returns the image data for a particular category.</span></span>

<span data-ttu-id="d842f-205">Agregue una nueva página ASP.NET para la `BinaryData` carpeta denominada `DisplayCategoryPicture.aspx`.</span><span class="sxs-lookup"><span data-stu-id="d842f-205">Add a new ASP.NET page to the `BinaryData` folder named `DisplayCategoryPicture.aspx`.</span></span> <span data-ttu-id="d842f-206">Al hacerlo, deje desactivada la casilla de verificación Seleccionar la página maestra.</span><span class="sxs-lookup"><span data-stu-id="d842f-206">When doing so, leave the Select master page checkbox unchecked.</span></span> <span data-ttu-id="d842f-207">Esta página se espera un `CategoryID` valor en la cadena de consulta y devuelve los datos binarios de esa categoría s `Picture` columna.</span><span class="sxs-lookup"><span data-stu-id="d842f-207">This page expects a `CategoryID` value in the querystring and returns the binary data of that category s `Picture` column.</span></span> <span data-ttu-id="d842f-208">Puesto que esta página devuelve datos binarios y nada más, no es necesario ningún marcado en la sección HTML.</span><span class="sxs-lookup"><span data-stu-id="d842f-208">Since this page returns binary data and nothing else, it does not need any markup in the HTML section.</span></span> <span data-ttu-id="d842f-209">Por lo tanto, haga clic en la pestaña de origen en la esquina inferior izquierda y quitar todas las revisiones de página s, excepto para el `<%@ Page %>` directiva.</span><span class="sxs-lookup"><span data-stu-id="d842f-209">Therefore, click on the Source tab in the lower left corner and remove all of the page s markup except for the `<%@ Page %>` directive.</span></span> <span data-ttu-id="d842f-210">Es decir, `DisplayCategoryPicture.aspx` marcado declarativo s debe constar de una sola línea:</span><span class="sxs-lookup"><span data-stu-id="d842f-210">That is, `DisplayCategoryPicture.aspx` s declarative markup should consist of a single line:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample5.aspx)]

<span data-ttu-id="d842f-211">Si ve el `MasterPageFile` atributo la `<%@ Page %>` directiva, quítela.</span><span class="sxs-lookup"><span data-stu-id="d842f-211">If you see the `MasterPageFile` attribute in the `<%@ Page %>` directive, remove it.</span></span>

<span data-ttu-id="d842f-212">En la clase de código subyacente de la página s, agregue el código siguiente a la `Page_Load` controlador de eventos:</span><span class="sxs-lookup"><span data-stu-id="d842f-212">In the page s code-behind class, add the following code to the `Page_Load` event handler:</span></span>


[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample6.vb)]

<span data-ttu-id="d842f-213">Este código se inicia mediante la lectura de la `CategoryID` valor de cadena de consulta en una variable denominada `categoryID`.</span><span class="sxs-lookup"><span data-stu-id="d842f-213">This code starts by reading in the `CategoryID` querystring value into a variable named `categoryID`.</span></span> <span data-ttu-id="d842f-214">A continuación, se recuperan los datos de la imagen mediante una llamada a la `CategoriesBLL` clase s `GetCategoryWithBinaryDataByCategoryID(categoryID)` método.</span><span class="sxs-lookup"><span data-stu-id="d842f-214">Next, the picture data is retrieved via a call to the `CategoriesBLL` class s `GetCategoryWithBinaryDataByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="d842f-215">Estos datos se devuelven al cliente mediante el uso de la `Response.BinaryWrite(data)` método, pero antes de llama a esto, el `Picture` se debe quitar el encabezado de columna valor s OLE.</span><span class="sxs-lookup"><span data-stu-id="d842f-215">This data is returned to the client by using the `Response.BinaryWrite(data)` method, but before this is called, the `Picture` column value s OLE header must be removed.</span></span> <span data-ttu-id="d842f-216">Esto se logra creando un `Byte` matriz denominada `strippedImageData` que va a contener precisamente 78 caracteres menor que lo que está en la `Picture` columna.</span><span class="sxs-lookup"><span data-stu-id="d842f-216">This is accomplished by creating a `Byte` array named `strippedImageData` that will hold precisely 78 characters less than what is in the `Picture` column.</span></span> <span data-ttu-id="d842f-217">El [ `Array.Copy` método](https://msdn.microsoft.com/library/z50k9bft.aspx) se usa para copiar los datos de `category.Picture` empezar en posición 78 a `strippedImageData`.</span><span class="sxs-lookup"><span data-stu-id="d842f-217">The [`Array.Copy` method](https://msdn.microsoft.com/library/z50k9bft.aspx) is used to copy the data from `category.Picture` starting at position 78 over to `strippedImageData`.</span></span>

<span data-ttu-id="d842f-218">El `Response.ContentType` propiedad especifica el [tipo MIME](http://en.wikipedia.org/wiki/MIME) del contenido que se devuelve para que el explorador sabe cómo se representan.</span><span class="sxs-lookup"><span data-stu-id="d842f-218">The `Response.ContentType` property specifies the [MIME type](http://en.wikipedia.org/wiki/MIME) of the content being returned so that the browser knows how to render it.</span></span> <span data-ttu-id="d842f-219">Puesto que la `Categories` tabla s `Picture` la columna es una imagen de mapa de bits, el tipo MIME del mapa de bits se usa aquí (image/bmp).</span><span class="sxs-lookup"><span data-stu-id="d842f-219">Since the `Categories` table s `Picture` column is a bitmap image, the bitmap MIME type is used here (image/bmp).</span></span> <span data-ttu-id="d842f-220">Si se omite el tipo MIME, la mayoría de los exploradores se seguirá mostrando la imagen correctamente porque puede deducir el tipo según el contenido de los datos en la s de archivo de imagen binarios.</span><span class="sxs-lookup"><span data-stu-id="d842f-220">If you omit the MIME type, most browsers will still display the image correctly because they can infer the type based on the contents of the image file s binary data.</span></span> <span data-ttu-id="d842f-221">Sin embargo, lo recomendable incluir el MIME de s escribir cuando sea posible.</span><span class="sxs-lookup"><span data-stu-id="d842f-221">However, it s prudent to include the MIME type when possible.</span></span> <span data-ttu-id="d842f-222">Consulte la [sitio Web de Internet Assigned Numbers Authority s](http://www.iana.org/) para obtener una lista completa de [tipos de medio MIME](http://www.iana.org/assignments/media-types/).</span><span class="sxs-lookup"><span data-stu-id="d842f-222">See the [Internet Assigned Numbers Authority s website](http://www.iana.org/) for a complete listing of [MIME media types](http://www.iana.org/assignments/media-types/).</span></span>

<span data-ttu-id="d842f-223">Con esta página creada, se puede ver la imagen de una determinada categoría s visitando `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="d842f-223">With this page created, a particular category s picture can be viewed by visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="d842f-224">Figura 11 muestra la imagen de s de la categoría Bebidas, que puede verse desde `DisplayCategoryPicture.aspx?CategoryID=1`.</span><span class="sxs-lookup"><span data-stu-id="d842f-224">Figure 11 shows the Beverages category s picture, which can be viewed from `DisplayCategoryPicture.aspx?CategoryID=1`.</span></span>


<span data-ttu-id="d842f-225">[![La s de la categoría bebidas que se muestra la imagen](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-225">[![The Beverages Category s Picture is Displayed](displaying-binary-data-in-the-data-web-controls-vb/_static/image11.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image17.png)</span></span>

<span data-ttu-id="d842f-226">**Figura 11**: La s de la categoría Bebidas se muestra la imagen ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-226">**Figure 11**: The Beverages Category s Picture is Displayed ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image18.png))</span></span>


<span data-ttu-id="d842f-227">If, cuando se visita `DisplayCategoryPicture.aspx?CategoryID=categoryID`, obtendrá una excepción que se lee no se puede convertir el objeto de tipo "System.DBNull" al tipo 'System.Byte []', hay dos cosas que puedan estar causando esto.</span><span class="sxs-lookup"><span data-stu-id="d842f-227">If, when visiting `DisplayCategoryPicture.aspx?CategoryID=categoryID`, you get an exception that reads Unable to cast object of type 'System.DBNull' to type 'System.Byte[]', there are two things that may be causing this.</span></span> <span data-ttu-id="d842f-228">En primer lugar, el `Categories` tabla s `Picture` columna Permitir `NULL` valores.</span><span class="sxs-lookup"><span data-stu-id="d842f-228">First, the `Categories` table s `Picture` column does allow `NULL` values.</span></span> <span data-ttu-id="d842f-229">El `DisplayCategoryPicture.aspx` página, sin embargo, se supone que hay que no es`NULL` valor presente.</span><span class="sxs-lookup"><span data-stu-id="d842f-229">The `DisplayCategoryPicture.aspx` page, however, assumes there is a non-`NULL` value present.</span></span> <span data-ttu-id="d842f-230">El `Picture` propiedad de la `CategoriesDataTable` no se puede acceder directamente si tiene un `NULL` valor.</span><span class="sxs-lookup"><span data-stu-id="d842f-230">The `Picture` property of the `CategoriesDataTable` cannot be directly accessed if it has a `NULL` value.</span></span> <span data-ttu-id="d842f-231">Si desea permitir `NULL` valores para la `Picture` columna, d puede incluir la siguiente condición:</span><span class="sxs-lookup"><span data-stu-id="d842f-231">If you do want to allow `NULL` values for the `Picture` column, you d want to include the following condition:</span></span>


[!code-vb[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample7.vb)]

<span data-ttu-id="d842f-232">El código anterior supone que existen algunos con nombre de archivo de imagen de s `NoPictureAvailable.gif` en el `Images` carpeta que desea mostrar para esas categorías sin una imagen.</span><span class="sxs-lookup"><span data-stu-id="d842f-232">The above code assumes that there s some image file named `NoPictureAvailable.gif` in the `Images` folder that you want to display for those categories without a picture.</span></span>

<span data-ttu-id="d842f-233">También se podría producir esta excepción si el `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` método s `SELECT` instrucción ha vuelto a la lista de columnas de la consulta principal s, lo que puede suceder si usa instrucciones SQL ad hoc y ve vuelva a ejecuta el Asistente para la s de TableAdapter consulta principal.</span><span class="sxs-lookup"><span data-stu-id="d842f-233">This exception could also be caused if the `CategoriesTableAdapter` s `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement has reverted back to the main query s column list, which can happen if you are using ad-hoc SQL statements and you ve re-run the wizard for the TableAdapter s main query.</span></span> <span data-ttu-id="d842f-234">Compruebe que `GetCategoryWithBinaryDataByCategoryID` método s `SELECT` instrucción todavía incluye la `Picture` columna.</span><span class="sxs-lookup"><span data-stu-id="d842f-234">Check to ensure that `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement still includes the `Picture` column.</span></span>

> [!NOTE]
> <span data-ttu-id="d842f-235">Cada vez que el `DisplayCategoryPicture.aspx` es visitadas, la base de datos se accede y se devuelven los datos de imagen de la categoría especificada s.</span><span class="sxs-lookup"><span data-stu-id="d842f-235">Every time the `DisplayCategoryPicture.aspx` is visited, the database is accessed and the specified category s picture data is returned.</span></span> <span data-ttu-id="d842f-236">Si la imagen de categoría s no ha cambiado desde que el usuario lo haya visto por última vez, sin embargo, esto es de esfuerzo en vano.</span><span class="sxs-lookup"><span data-stu-id="d842f-236">If the category s picture hasn't changed since the user has last viewed it, though, this is wasted effort.</span></span> <span data-ttu-id="d842f-237">Afortunadamente, HTTP permite *condicional Obtiene*.</span><span class="sxs-lookup"><span data-stu-id="d842f-237">Fortunately, HTTP allows for *conditional GETs*.</span></span> <span data-ttu-id="d842f-238">Con una operación GET condicional, el cliente que realiza la solicitud HTTP se envía a lo largo de un [ `If-Modified-Since` encabezado HTTP](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) que proporciona la fecha y hora que el cliente recuperó por última vez este recurso desde el servidor web.</span><span class="sxs-lookup"><span data-stu-id="d842f-238">With a conditional GET, the client making the HTTP request sends along an [`If-Modified-Since` HTTP header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) that provides the date and time the client last retrieved this resource from the web server.</span></span> <span data-ttu-id="d842f-239">Si no ha cambiado el contenido ya que esto especifica la fecha, el servidor web puede responder con un [código de estado no modificado (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) y renuncian a devolver el contenido del recurso solicitado.</span><span class="sxs-lookup"><span data-stu-id="d842f-239">If the content has not changed since this specified date, the web server may respond with a [Not Modified status code (304)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) and forgo sending back the requested resource s content.</span></span> <span data-ttu-id="d842f-240">En resumen, esta técnica evita tener que enviar el contenido de un recurso si no se ha modificado desde que el cliente tiene acceso por última vez el servidor web.</span><span class="sxs-lookup"><span data-stu-id="d842f-240">In short, this technique relieves the web server from having to send back content for a resource if it has not been modified since the client last accessed it.</span></span>


<span data-ttu-id="d842f-241">Para implementar este comportamiento, sin embargo, requiere que se agregue un `PictureLastModified` columna a la `Categories` tabla para capturar cuando el `Picture` columna se actualizó por última vez, así como código para comprobar la `If-Modified-Since` encabezado.</span><span class="sxs-lookup"><span data-stu-id="d842f-241">To implement this behavior, however, requires that you add a `PictureLastModified` column to the `Categories` table to capture when the `Picture` column was last updated as well as code to check for the `If-Modified-Since` header.</span></span> <span data-ttu-id="d842f-242">Para obtener más información sobre la `If-Modified-Since` encabezado y el flujo de trabajo GET condicional, consulte [HTTP GET condicional para los Hackers RSS](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) y [A Look más profunda al realizar solicitudes HTTP en una página ASP.NET](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="d842f-242">For more information on the `If-Modified-Since` header and the conditional GET workflow, see [HTTP Conditional GET for RSS Hackers](http://fishbowl.pastiche.org/2002/10/21/http_conditional_get_for_rss_hackers) and [A Deeper Look at Performing HTTP Requests in an ASP.NET Page](http://aspnet.4guysfromrolla.com/articles/122204-1.aspx).</span></span>

## <a name="step-4-displaying-the-category-pictures-in-a-gridview"></a><span data-ttu-id="d842f-243">Paso 4: Mostrar las imágenes de categoría en un control GridView</span><span class="sxs-lookup"><span data-stu-id="d842f-243">Step 4: Displaying the Category Pictures in a GridView</span></span>

<span data-ttu-id="d842f-244">Ahora que tenemos una página web para mostrar la imagen de una determinada categoría s, podemos mostrar mediante el [control imagen Web](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) o HTML `<img>` elemento al que apunta a `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span><span class="sxs-lookup"><span data-stu-id="d842f-244">Now that we have a web page to display a particular category s picture, we can display it using the [Image Web control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/image.aspx) or an HTML `<img>` element pointing to `DisplayCategoryPicture.aspx?CategoryID=categoryID`.</span></span> <span data-ttu-id="d842f-245">Imágenes cuya dirección URL viene determinada por la base de datos se pueden mostrar en el control GridView o DetailsView mediante ImageField.</span><span class="sxs-lookup"><span data-stu-id="d842f-245">Images whose URL is determined by database data can be displayed in the GridView or DetailsView using the ImageField.</span></span> <span data-ttu-id="d842f-246">Contiene ImageField `DataImageUrlField` y `DataImageUrlFormatString` propiedades que funcionan como las operaciones de asignación campo HYPERLINK `DataNavigateUrlFields` y `DataNavigateUrlFormatString` propiedades.</span><span class="sxs-lookup"><span data-stu-id="d842f-246">The ImageField contains `DataImageUrlField` and `DataImageUrlFormatString` properties that work like the HyperLinkField s `DataNavigateUrlFields` and `DataNavigateUrlFormatString` properties.</span></span>

<span data-ttu-id="d842f-247">Permiten s aumentar la `Categories` GridView en `DisplayOrDownloadData.aspx` agregando un ImageField para mostrar cada imagen de la categoría s.</span><span class="sxs-lookup"><span data-stu-id="d842f-247">Let s augment the `Categories` GridView in `DisplayOrDownloadData.aspx` by adding an ImageField to show each category s picture.</span></span> <span data-ttu-id="d842f-248">Simplemente agregue ImageField y establezca su `DataImageUrlField` y `DataImageUrlFormatString` propiedades a `CategoryID` y `DisplayCategoryPicture.aspx?CategoryID={0}`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="d842f-248">Simply add the ImageField and set its `DataImageUrlField` and `DataImageUrlFormatString` properties to `CategoryID` and `DisplayCategoryPicture.aspx?CategoryID={0}`, respectively.</span></span> <span data-ttu-id="d842f-249">Esto creará una columna de GridView que presenta un `<img>` elemento cuyo `src` las referencias de atributo `DisplayCategoryPicture.aspx?CategoryID={0}`, donde {0} se reemplaza por la fila GridView s `CategoryID` valor.</span><span class="sxs-lookup"><span data-stu-id="d842f-249">This will create a GridView column that renders an `<img>` element whose `src` attribute references `DisplayCategoryPicture.aspx?CategoryID={0}`, where {0} is replaced with the GridView row s `CategoryID` value.</span></span>


![Agregar un ImageField en GridView](displaying-binary-data-in-the-data-web-controls-vb/_static/image12.gif)

<span data-ttu-id="d842f-251">**Figura 12**: Agregar un ImageField en GridView</span><span class="sxs-lookup"><span data-stu-id="d842f-251">**Figure 12**: Add an ImageField to the GridView</span></span>


<span data-ttu-id="d842f-252">Después de agregar ImageField, su sintaxis declarativa del control GridView s debería parezca aliviar siguientes:</span><span class="sxs-lookup"><span data-stu-id="d842f-252">After adding the ImageField, your GridView s declarative syntax should look like soothe following:</span></span>


[!code-aspx[Main](displaying-binary-data-in-the-data-web-controls-vb/samples/sample8.aspx)]

<span data-ttu-id="d842f-253">Dedique un momento para ver esta página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="d842f-253">Take a moment to view this page through a browser.</span></span> <span data-ttu-id="d842f-254">Tenga en cuenta cómo cada registro ahora incluye una imagen de la categoría.</span><span class="sxs-lookup"><span data-stu-id="d842f-254">Note how each record now includes a picture for the category.</span></span>


<span data-ttu-id="d842f-255">[![La categoría s imagen se muestra para cada fila](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d842f-255">[![The Category s Picture is Displayed for Each Row](displaying-binary-data-in-the-data-web-controls-vb/_static/image13.gif)](displaying-binary-data-in-the-data-web-controls-vb/_static/image19.png)</span></span>

<span data-ttu-id="d842f-256">**Figura 13**: La categoría s imagen se muestra para cada fila ([haga clic aquí para ver imagen en tamaño completo](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="d842f-256">**Figure 13**: The Category s Picture is Displayed for Each Row ([Click to view full-size image](displaying-binary-data-in-the-data-web-controls-vb/_static/image20.png))</span></span>


## <a name="summary"></a><span data-ttu-id="d842f-257">Resumen</span><span class="sxs-lookup"><span data-stu-id="d842f-257">Summary</span></span>

<span data-ttu-id="d842f-258">En este tutorial hemos visto cómo presentar los datos binarios.</span><span class="sxs-lookup"><span data-stu-id="d842f-258">In this tutorial we examined how to present binary data.</span></span> <span data-ttu-id="d842f-259">¿Cómo se presentan los datos depende del tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="d842f-259">How the data is presented depends on the type of data.</span></span> <span data-ttu-id="d842f-260">Para los archivos de folleto PDF, se ofrece al usuario un folleto de vista de vínculo que, al hacer clic, tardó el usuario directamente en el archivo PDF.</span><span class="sxs-lookup"><span data-stu-id="d842f-260">For the PDF brochure files, we offered the user a View Brochure link that, when clicked, took the user directly to the PDF file.</span></span> <span data-ttu-id="d842f-261">Para la imagen de s categoría, se crea por primera vez una página para recuperar y devolver los datos binarios de la base de datos y, a continuación, utiliza esa página para mostrar cada imagen de s de categoría en un control GridView.</span><span class="sxs-lookup"><span data-stu-id="d842f-261">For the category s picture, we first created a page to retrieve and return the binary data from the database and then used that page to display each category s picture in a GridView.</span></span>

<span data-ttu-id="d842f-262">Ahora que hemos examinado ve cómo mostrar datos binarios, que está listo para examinar cómo realizar la inserción, actualizaciones y eliminaciones en la base de datos con los datos binarios.</span><span class="sxs-lookup"><span data-stu-id="d842f-262">Now that we ve looked at how to display binary data, we re ready to examine how to perform insert, updates, and deletes against the database with the binary data.</span></span> <span data-ttu-id="d842f-263">En el siguiente tutorial daremos un vistazo a cómo asociar un archivo cargado a su registro de base de datos correspondiente.</span><span class="sxs-lookup"><span data-stu-id="d842f-263">In the next tutorial we'll look at how to associate an uploaded file with its corresponding database record.</span></span> <span data-ttu-id="d842f-264">En el tutorial después de eso, veremos cómo actualizar los datos binarios existentes, así como la eliminación de los datos binarios cuando se quita su registro asociado.</span><span class="sxs-lookup"><span data-stu-id="d842f-264">In the tutorial after that, we'll see how to update existing binary data as well as how to delete the binary data when its associated record is removed.</span></span>

<span data-ttu-id="d842f-265">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="d842f-265">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d842f-266">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="d842f-266">About the Author</span></span>

<span data-ttu-id="d842f-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), trabaja con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="d842f-267">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d842f-268">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="d842f-268">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d842f-269">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d842f-269">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d842f-270">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d842f-270">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d842f-271">o a través de su blog, que puede encontrarse en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d842f-271">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d842f-272">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="d842f-272">Special Thanks To</span></span>

<span data-ttu-id="d842f-273">Esta serie de tutoriales ha sido revisada por muchos revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="d842f-273">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d842f-274">Los revisores para este tutorial fueron Teresa Murphy y Dave Gardner.</span><span class="sxs-lookup"><span data-stu-id="d842f-274">Lead reviewers for this tutorial were Teresa Murphy and Dave Gardner.</span></span> <span data-ttu-id="d842f-275">¿Está interesado en leer mi próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="d842f-275">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d842f-276">Si es así, envíeme una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d842f-276">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d842f-277">[Anterior](uploading-files-vb.md)
> [Siguiente](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d842f-277">[Previous](uploading-files-vb.md)
[Next](including-a-file-upload-option-when-adding-a-new-record-vb.md)</span></span>

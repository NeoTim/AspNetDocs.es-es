---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-2
title: Introducción con Entity Framework 4,0 Database First y ASP.NET 4 formularios Web Forms, parte 2 | Microsoft Docs
author: tdykstra
description: En la aplicación Web de ejemplo contoso University se muestra cómo crear aplicaciones de formularios Web Forms de ASP.NET mediante el Entity Framework. La aplicación de ejemplo es...
ms.author: riande
ms.date: 12/03/2010
ms.assetid: fb63a326-a4ae-4b0c-a4f5-412327197216
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-2
msc.type: authoredcontent
ms.openlocfilehash: bd6a2e29e6f0df04e39be29160e2e08cc99c4706
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78456451"
---
# <a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-2"></a><span data-ttu-id="7b3c9-104">Introducción con Entity Framework 4,0 Database First y ASP.NET 4 formularios Web Forms, parte 2</span><span class="sxs-lookup"><span data-stu-id="7b3c9-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 2</span></span>

<span data-ttu-id="7b3c9-105">por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="7b3c9-106">En la aplicación Web de ejemplo contoso University se muestra cómo crear aplicaciones de formularios Web Forms de ASP.NET mediante el Entity Framework 4,0 y Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="7b3c9-107">Para obtener información sobre la serie de tutoriales, consulte [el primer tutorial de la serie](the-entity-framework-and-aspnet-getting-started-part-1.md) .</span><span class="sxs-lookup"><span data-stu-id="7b3c9-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>

## <a name="the-entitydatasource-control"></a><span data-ttu-id="7b3c9-108">Control EntityDataSource</span><span class="sxs-lookup"><span data-stu-id="7b3c9-108">The EntityDataSource Control</span></span>

<span data-ttu-id="7b3c9-109">En el tutorial anterior, creó un sitio web, una base de datos y un modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-109">In the previous tutorial you created a web site, a database, and a data model.</span></span> <span data-ttu-id="7b3c9-110">En este tutorial, trabajará con el control de `EntityDataSource` que ASP.NET proporciona para facilitar el trabajo con un modelo de datos Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-110">In this tutorial you work with the `EntityDataSource` control that ASP.NET provides in order to make it easy to work with an Entity Framework data model.</span></span> <span data-ttu-id="7b3c9-111">Creará un control de `GridView` para mostrar y editar los datos de los estudiantes, un `DetailsView` control para agregar nuevos estudiantes y un control de `DropDownList` para seleccionar un departamento (que usará más adelante para mostrar los cursos asociados).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-111">You'll create a `GridView` control for displaying and editing student data, a `DetailsView` control for adding new students, and a `DropDownList` control for selecting a department (which you'll use later for displaying associated courses).</span></span>

<span data-ttu-id="7b3c9-112">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-112">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image1.png)</span></span>

<span data-ttu-id="7b3c9-113">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-113">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image3.png)</span></span>

<span data-ttu-id="7b3c9-114">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-114">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image5.png)</span></span>

<span data-ttu-id="7b3c9-115">Tenga en cuenta que en esta aplicación no agregará la validación de entradas a páginas que actualicen la base de datos, y algunos de los errores de control no serán tan sólidos como serían necesarios en una aplicación de producción.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-115">Note that in this application you won't be adding input validation to pages that update the database, and some of the error handling will not be as robust as would be required in a production application.</span></span> <span data-ttu-id="7b3c9-116">Esto mantiene el tutorial centrado en el Entity Framework y evita que sea demasiado largo.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-116">That keeps the tutorial focused on the Entity Framework and keeps it from getting too long.</span></span> <span data-ttu-id="7b3c9-117">Para obtener más información sobre cómo agregar estas características a la aplicación, consulte [validación de entradas de usuario en ASP.NET Web pages](https://msdn.microsoft.com/library/7kh55542.aspx) y [control de errores en páginas y aplicaciones de ASP.net](https://msdn.microsoft.com/library/w16865z6.aspx).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-117">For details about how to add these features to your application, see [Validating User Input in ASP.NET Web Pages](https://msdn.microsoft.com/library/7kh55542.aspx) and [Error Handling in ASP.NET Pages and Applications](https://msdn.microsoft.com/library/w16865z6.aspx).</span></span>

## <a name="adding-and-configuring-the-entitydatasource-control"></a><span data-ttu-id="7b3c9-118">Agregar y configurar el control EntityDataSource</span><span class="sxs-lookup"><span data-stu-id="7b3c9-118">Adding and Configuring the EntityDataSource Control</span></span>

<span data-ttu-id="7b3c9-119">Comenzará configurando un control de `EntityDataSource` para leer `Person` entidades del conjunto de entidades `People`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-119">You'll begin by configuring an `EntityDataSource` control to read `Person` entities from the `People` entity set.</span></span>

<span data-ttu-id="7b3c9-120">Asegúrese de que tiene Visual Studio abierto y de que está trabajando con el proyecto que creó en la parte 1.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-120">Make sure you have Visual Studio open and that you're working with the project you created in part 1.</span></span> <span data-ttu-id="7b3c9-121">Si no ha compilado el proyecto desde que creó el modelo de datos o desde el último cambio realizado en él, compile el proyecto ahora.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-121">If you haven't built the project since you created the data model or since the last change you made to it, build the project now.</span></span> <span data-ttu-id="7b3c9-122">Los cambios en el modelo de datos no se ponen a disposición del diseñador hasta que se compile el proyecto.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-122">Changes to the data model are not made available to the designer until the project is built.</span></span>

<span data-ttu-id="7b3c9-123">Cree una nueva página web mediante el **formulario Web Forms con** la plantilla de página maestra y asígnele el nombre *Students. aspx*.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-123">Create a new web page using the **Web Form using Master Page** template, and name it *Students.aspx*.</span></span>

<span data-ttu-id="7b3c9-124">[![Image23](the-entity-framework-and-aspnet-getting-started-part-2/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-124">[![Image23](the-entity-framework-and-aspnet-getting-started-part-2/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image7.png)</span></span>

<span data-ttu-id="7b3c9-125">Especifique *site. Master* como la página maestra.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-125">Specify *Site.Master* as the master page.</span></span> <span data-ttu-id="7b3c9-126">Todas las páginas que cree para estos tutoriales usarán esta página maestra.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-126">All of the pages you create for these tutorials will use this master page.</span></span>

<span data-ttu-id="7b3c9-127">[![Image24](the-entity-framework-and-aspnet-getting-started-part-2/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-127">[![Image24](the-entity-framework-and-aspnet-getting-started-part-2/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image9.png)</span></span>

<span data-ttu-id="7b3c9-128">En la vista **código fuente** , agregue un encabezado `h2` al control `Content` denominado `Content2`, como se muestra en el ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="7b3c9-128">In **Source** view, add an `h2` heading to the `Content` control named `Content2`, as shown in the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample1.aspx)]

<span data-ttu-id="7b3c9-129">En la pestaña **datos** del **cuadro de herramientas**, arrastre un control `EntityDataSource` a la página, colóquelo debajo del encabezado y cambie el identificador a `StudentsEntityDataSource`:</span><span class="sxs-lookup"><span data-stu-id="7b3c9-129">From the **Data** tab of the **Toolbox**, drag an `EntityDataSource` control to the page, drop it below the heading, and change the ID to `StudentsEntityDataSource`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample2.aspx)]

<span data-ttu-id="7b3c9-130">Cambie a la vista **diseño** , haga clic en la etiqueta inteligente del control de origen de datos y, a continuación, haga clic en **Configurar origen de datos** para iniciar el Asistente para **Configurar origen de datos** .</span><span class="sxs-lookup"><span data-stu-id="7b3c9-130">Switch to **Design** view, click the data source control's smart tag, and then click **Configure Data Source** to launch the **Configure Data Source** wizard.</span></span>

<span data-ttu-id="7b3c9-131">[![Image01](the-entity-framework-and-aspnet-getting-started-part-2/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-131">[![Image01](the-entity-framework-and-aspnet-getting-started-part-2/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image11.png)</span></span>

<span data-ttu-id="7b3c9-132">En el paso del Asistente para **configurar el ObjectContext** , seleccione **SchoolEntities** como el valor de **conexión con nombre**y seleccione **SchoolEntities** como el valor **DefaultContainerName** .</span><span class="sxs-lookup"><span data-stu-id="7b3c9-132">In the **Configure ObjectContext** wizard step, select **SchoolEntities** as the value for **Named Connection**, and select **SchoolEntities** as the **DefaultContainerName** value.</span></span> <span data-ttu-id="7b3c9-133">Después, haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-133">Then click **Next**.</span></span>

<span data-ttu-id="7b3c9-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-2/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-134">[![Image02](the-entity-framework-and-aspnet-getting-started-part-2/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image13.png)</span></span>

<span data-ttu-id="7b3c9-135">Nota: Si obtiene el siguiente cuadro de diálogo en este punto, debe compilar el proyecto antes de continuar.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-135">Note: If you get the following dialog box at this point, you have to build the project before proceeding.</span></span>

<span data-ttu-id="7b3c9-136">[![Image25](the-entity-framework-and-aspnet-getting-started-part-2/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-136">[![Image25](the-entity-framework-and-aspnet-getting-started-part-2/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image15.png)</span></span>

<span data-ttu-id="7b3c9-137">En el paso **Configurar selección de datos** , seleccione **People** como valor para **entitySetName**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-137">In the **Configure Data Selection** step, select **People** as the value for **EntitySetName**.</span></span> <span data-ttu-id="7b3c9-138">En **seleccionar**, asegúrese de que la casilla de verificación **seleccionar un** ll está activada.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-138">Under **Select**, make sure the **Select A** ll check box is selected.</span></span> <span data-ttu-id="7b3c9-139">A continuación, seleccione las opciones para habilitar Update y DELETE.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-139">Then select the options to enable update and delete.</span></span> <span data-ttu-id="7b3c9-140">Cuando haya terminado, haga clic en **Finalizar**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-140">When you're done, click **Finish**.</span></span>

<span data-ttu-id="7b3c9-141">[![Image03](the-entity-framework-and-aspnet-getting-started-part-2/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-141">[![Image03](the-entity-framework-and-aspnet-getting-started-part-2/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image17.png)</span></span>

## <a name="configuring-database-rules-to-allow-deletion"></a><span data-ttu-id="7b3c9-142">Configuración de reglas de base de datos para permitir la eliminación</span><span class="sxs-lookup"><span data-stu-id="7b3c9-142">Configuring Database Rules to Allow Deletion</span></span>

<span data-ttu-id="7b3c9-143">Creará una página que permite a los usuarios eliminar estudiantes de la tabla `Person`, que tiene tres relaciones con otras tablas (`Course`, `StudentGrade`y `OfficeAssignment`).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-143">You'll be creating a page that lets users delete students from the `Person` table, which has three relationships with other tables (`Course`, `StudentGrade`, and `OfficeAssignment`).</span></span> <span data-ttu-id="7b3c9-144">De forma predeterminada, la base de datos impedirá que elimine una fila en `Person` si hay filas relacionadas en una de las otras tablas.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-144">By default, the database will prevent you from deleting a row in `Person` if there are related rows in one of the other tables.</span></span> <span data-ttu-id="7b3c9-145">Puede eliminar las filas relacionadas de forma manual en primer lugar o puede configurar la base de datos para eliminarlas automáticamente al eliminar una fila de `Person`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-145">You can manually delete the related rows first, or you can configure the database to delete them automatically when you delete a `Person` row.</span></span> <span data-ttu-id="7b3c9-146">En el caso de los registros de estudiante de este tutorial, configurará la base de datos para eliminar automáticamente los datos relacionados.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-146">For student records in this tutorial, you'll configure the database to delete the related data automatically.</span></span> <span data-ttu-id="7b3c9-147">Dado que los alumnos solo pueden tener filas relacionadas en la tabla `StudentGrade`, solo tiene que configurar una de las tres relaciones.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-147">Because students can have related rows only in the `StudentGrade` table, you need to configure only one of the three relationships.</span></span>

<span data-ttu-id="7b3c9-148">Si utiliza el archivo *School. MDF* que descargó del proyecto que se incluye en este tutorial, puede omitir esta sección porque ya se han realizado estos cambios de configuración.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-148">If you're using the *School.mdf* file that you downloaded from the project that goes with this tutorial, you can skip this section because these configuration changes have already been done.</span></span> <span data-ttu-id="7b3c9-149">Si creó la base de datos mediante la ejecución de un script, configure la base de datos mediante los procedimientos siguientes.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-149">If you created the database by running a script, configure the database by performing the following procedures.</span></span>

<span data-ttu-id="7b3c9-150">En **Explorador de servidores**, abra el diagrama de base de datos que creó en la parte 1.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-150">In **Server Explorer**, open the database diagram that you created in part 1.</span></span> <span data-ttu-id="7b3c9-151">Haga clic con el botón secundario en la relación entre `Person` y `StudentGrade` (la línea entre las tablas) y, a continuación, seleccione **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-151">Right-click the relationship between `Person` and `StudentGrade` (the line between tables), and then select **Properties**.</span></span>

<span data-ttu-id="7b3c9-152">[![Image04](the-entity-framework-and-aspnet-getting-started-part-2/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-152">[![Image04](the-entity-framework-and-aspnet-getting-started-part-2/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image19.png)</span></span>

<span data-ttu-id="7b3c9-153">En la ventana **propiedades** , expanda la **especificación de INSERT y Update** y establezca la propiedad **DeleteRule** en **Cascade**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-153">In the **Properties** window, expand **INSERT and UPDATE Specification** and set the **DeleteRule** property to **Cascade**.</span></span>

<span data-ttu-id="7b3c9-154">[![Image05](the-entity-framework-and-aspnet-getting-started-part-2/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-154">[![Image05](the-entity-framework-and-aspnet-getting-started-part-2/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image21.png)</span></span>

<span data-ttu-id="7b3c9-155">Guarde y cierre el diagrama.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-155">Save and close the diagram.</span></span> <span data-ttu-id="7b3c9-156">Si se le pregunta si desea actualizar la base de datos, haga clic en **sí**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-156">If you're asked whether you want to update the database, click **Yes**.</span></span>

<span data-ttu-id="7b3c9-157">Para asegurarse de que el modelo mantiene las entidades que están en la memoria sincronizadas con lo que hace la base de datos, debe establecer las reglas correspondientes en el modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-157">To make sure that the model keeps entities that are in memory in sync with what the database is doing, you must set corresponding rules in the data model.</span></span> <span data-ttu-id="7b3c9-158">Abra *SchoolModel. edmx*, haga clic con el botón secundario en la línea de asociación entre `Person` y `StudentGrade`y, a continuación, seleccione **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-158">Open *SchoolModel.edmx*, right-click the association line between `Person` and `StudentGrade`, and then select **Properties**.</span></span>

<span data-ttu-id="7b3c9-159">[![Image21](the-entity-framework-and-aspnet-getting-started-part-2/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-159">[![Image21](the-entity-framework-and-aspnet-getting-started-part-2/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image23.png)</span></span>

<span data-ttu-id="7b3c9-160">En la ventana **propiedades** , establezca **End1** en **Cascade**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-160">In the **Properties** window, set **End1 OnDelete** to **Cascade**.</span></span>

<span data-ttu-id="7b3c9-161">[![Image22](the-entity-framework-and-aspnet-getting-started-part-2/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-161">[![Image22](the-entity-framework-and-aspnet-getting-started-part-2/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image25.png)</span></span>

<span data-ttu-id="7b3c9-162">Guarde y cierre el archivo *SchoolModel. edmx* y, a continuación, recompile el proyecto.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-162">Save and close the *SchoolModel.edmx* file, and then rebuild the project.</span></span>

<span data-ttu-id="7b3c9-163">En general, cuando la base de datos cambia, tiene varias opciones para sincronizar el modelo:</span><span class="sxs-lookup"><span data-stu-id="7b3c9-163">In general, when the database changes, you have several choices for how to sync up the model:</span></span>

- <span data-ttu-id="7b3c9-164">Para determinados tipos de cambios (como agregar o actualizar tablas, vistas o procedimientos almacenados), haga clic con el botón derecho en el diseñador y seleccione **Actualizar modelo desde base de datos** para que el diseñador realice los cambios automáticamente.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-164">For certain kinds of changes (such as adding or refreshing tables, views, or stored procedures), right-click in the designer and select **Update Model from Database** to have the designer make the changes automatically.</span></span>
- <span data-ttu-id="7b3c9-165">Vuelva a generar el modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-165">Regenerate the data model.</span></span>
- <span data-ttu-id="7b3c9-166">Realice actualizaciones manuales como esta.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-166">Make manual updates like this one.</span></span>

<span data-ttu-id="7b3c9-167">En este caso, podría haber regenerado el modelo o actualizado las tablas afectadas por el cambio de relación, pero tendría que volver a realizar el cambio de nombre de campo (de `FirstName` a `FirstMidName`).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-167">In this case, you could have regenerated the model or refreshed the tables affected by the relationship change, but then you'd have to make the field-name change again (from `FirstName` to `FirstMidName`).</span></span>

## <a name="using-a-gridview-control-to-read-and-update-entities"></a><span data-ttu-id="7b3c9-168">Usar un control GridView para leer y actualizar entidades</span><span class="sxs-lookup"><span data-stu-id="7b3c9-168">Using a GridView Control to Read and Update Entities</span></span>

<span data-ttu-id="7b3c9-169">En esta sección, usará un control de `GridView` para mostrar, actualizar o eliminar alumnos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-169">In this section you'll use a `GridView` control to display, update, or delete students.</span></span>

<span data-ttu-id="7b3c9-170">Abra o cambie a *Students. aspx* y cambie a la vista **diseño** .</span><span class="sxs-lookup"><span data-stu-id="7b3c9-170">Open or switch to *Students.aspx* and switch to **Design** view.</span></span> <span data-ttu-id="7b3c9-171">En la pestaña **datos** del **cuadro de herramientas**, arrastre un control `GridView` a la derecha del control `EntityDataSource`, asígnele el nombre `StudentsGridView`, haga clic en la etiqueta inteligente y seleccione **StudentsEntityDataSource** como origen de datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-171">From the **Data** tab of the **Toolbox**, drag a `GridView` control to the right of the `EntityDataSource` control, name it `StudentsGridView`, click the smart tag, and then select **StudentsEntityDataSource** as the data source.</span></span>

<span data-ttu-id="7b3c9-172">[![Image06](the-entity-framework-and-aspnet-getting-started-part-2/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-172">[![Image06](the-entity-framework-and-aspnet-getting-started-part-2/_static/image28.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image27.png)</span></span>

<span data-ttu-id="7b3c9-173">Haga clic en **actualizar esquema** (haga clic en **sí** si se le pide confirmación) y, a continuación, haga clic en **Habilitar paginación**, **Habilitar ordenación**, **Habilitar edición**y **Habilitar eliminación**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-173">Click **Refresh Schema** (click **Yes** if you're prompted to confirm), then click **Enable Paging**, **Enable Sorting**, **Enable Editing**, and **Enable Deleting**.</span></span>

<span data-ttu-id="7b3c9-174">Haga clic en **Editar columnas**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-174">Click **Edit Columns**.</span></span>

<span data-ttu-id="7b3c9-175">[![Image10](the-entity-framework-and-aspnet-getting-started-part-2/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-175">[![Image10](the-entity-framework-and-aspnet-getting-started-part-2/_static/image30.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image29.png)</span></span>

<span data-ttu-id="7b3c9-176">En el cuadro **campos seleccionados** , elimine **PersonID**, **LastName**y **HireDate**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-176">In the **Selected fields** box, delete **PersonID**, **LastName**, and **HireDate**.</span></span> <span data-ttu-id="7b3c9-177">Normalmente, no se muestra una clave de registro a los usuarios, la fecha de contratación no es relevante para los estudiantes y se colocan ambas partes del nombre en un campo, por lo que solo necesita uno de los campos de nombre).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-177">You typically don't display a record key to users, hire date is not relevant to students, and you'll put both parts of the name in one field, so you only need one of the name fields.)</span></span>

<span data-ttu-id="7b3c9-178">[![Image11](the-entity-framework-and-aspnet-getting-started-part-2/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-178">[![Image11](the-entity-framework-and-aspnet-getting-started-part-2/_static/image32.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image31.png)</span></span>

<span data-ttu-id="7b3c9-179">Seleccione el campo **FirstMidName** y, a continuación, haga clic en **convertir este campo en TemplateField**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-179">Select the **FirstMidName** field and then click **Convert this field into a TemplateField**.</span></span>

<span data-ttu-id="7b3c9-180">Haga lo mismo para **EnrollmentDate**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-180">Do the same for **EnrollmentDate**.</span></span>

<span data-ttu-id="7b3c9-181">[![Image13](the-entity-framework-and-aspnet-getting-started-part-2/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-181">[![Image13](the-entity-framework-and-aspnet-getting-started-part-2/_static/image34.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image33.png)</span></span>

<span data-ttu-id="7b3c9-182">Haga clic en **Aceptar** y, a continuación, cambie a la vista **código fuente** .</span><span class="sxs-lookup"><span data-stu-id="7b3c9-182">Click **OK** and then switch to **Source** view.</span></span> <span data-ttu-id="7b3c9-183">Los cambios restantes serán más fáciles de realizar directamente en el marcado.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-183">The remaining changes will be easier to do directly in markup.</span></span> <span data-ttu-id="7b3c9-184">El marcado del control `GridView` ahora es similar al ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-184">The `GridView` control markup now looks like the following example.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample3.aspx)]

<span data-ttu-id="7b3c9-185">La primera columna después del campo de comando es un campo de plantilla que actualmente muestra el nombre.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-185">The first column after the command field is a template field that currently displays the first name.</span></span> <span data-ttu-id="7b3c9-186">Cambie el marcado de este campo de plantilla para que sea similar al ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="7b3c9-186">Change the markup for this template field to look like the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample4.aspx)]

<span data-ttu-id="7b3c9-187">En el modo de presentación, dos controles `Label` muestran el nombre y el apellido.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-187">In display mode, two `Label` controls display the first and last name.</span></span> <span data-ttu-id="7b3c9-188">En el modo de edición, se proporcionan dos cuadros de texto para que pueda cambiar el nombre y el apellido.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-188">In edit mode, two text boxes are provided so you can change the first and last name.</span></span> <span data-ttu-id="7b3c9-189">Al igual que con los controles `Label` en el modo de presentación, se usan las expresiones `Bind` y `Eval` exactamente como lo haría con los controles de origen de datos ASP.NET que se conectan directamente a las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-189">As with the `Label` controls in display mode, you use `Bind` and `Eval` expressions exactly as you would with ASP.NET data source controls that connect directly to databases.</span></span> <span data-ttu-id="7b3c9-190">La única diferencia es que está especificando las propiedades de la entidad en lugar de las columnas de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-190">The only difference is that you're specifying entity properties instead of database columns.</span></span>

<span data-ttu-id="7b3c9-191">La última columna es un campo de plantilla que muestra la fecha de inscripción.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-191">The last column is a template field that displays the enrollment date.</span></span> <span data-ttu-id="7b3c9-192">Cambie el marcado de este campo para que sea similar al ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="7b3c9-192">Change the markup for this field to look like the following example:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample5.aspx)]

<span data-ttu-id="7b3c9-193">En el modo de presentación y de edición, la cadena de formato "{0, d}" hace que la fecha se muestre en el formato "fecha corta".</span><span class="sxs-lookup"><span data-stu-id="7b3c9-193">In both display and edit mode, the format string "{0,d}" causes the date to be displayed in the "short date" format.</span></span> <span data-ttu-id="7b3c9-194">(Es posible que el equipo esté configurado para mostrar este formato de forma diferente a las imágenes de pantalla que se muestran en este tutorial).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-194">(Your computer might be configured to display this format differently from the screen images shown in this tutorial.)</span></span>

<span data-ttu-id="7b3c9-195">Observe que en cada uno de estos campos de plantilla, el diseñador utilizó una expresión `Bind` de forma predeterminada, pero se ha cambiado a una expresión `Eval` en los elementos `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-195">Notice that in each of these template fields, the designer used a `Bind` expression by default, but you've changed that to an `Eval` expression in the `ItemTemplate` elements.</span></span> <span data-ttu-id="7b3c9-196">La expresión `Bind` hace que los datos estén disponibles en `GridView` propiedades del control en caso de que necesite tener acceso a los datos en el código.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-196">The `Bind` expression makes the data available in `GridView` control properties in case you need to access the data in code.</span></span> <span data-ttu-id="7b3c9-197">En esta página no es necesario tener acceso a estos datos en el código, por lo que puede usar `Eval`, que es más eficaz.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-197">In this page you don't need to access this data in code, so you can use `Eval`, which is more efficient.</span></span> <span data-ttu-id="7b3c9-198">Para obtener más información, consulte [obtención de los datos de los controles de datos](https://weblogs.asp.net/davidfowler/archive/2008/12/12/getting-your-data-out-of-the-data-controls.aspx).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-198">For more information, see [Getting your data out of the data controls](https://weblogs.asp.net/davidfowler/archive/2008/12/12/getting-your-data-out-of-the-data-controls.aspx).</span></span>

## <a name="revising-entitydatasource-control-markup-to-improve-performance"></a><span data-ttu-id="7b3c9-199">Revisar el marcado del control EntityDataSource para mejorar el rendimiento</span><span class="sxs-lookup"><span data-stu-id="7b3c9-199">Revising EntityDataSource Control Markup to Improve Performance</span></span>

<span data-ttu-id="7b3c9-200">En el marcado del control `EntityDataSource`, quite los atributos `ConnectionString` y `DefaultContainerName` y reemplácelos por un atributo `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-200">In the markup for the `EntityDataSource` control, remove the `ConnectionString` and `DefaultContainerName` attributes and replace them with a `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="7b3c9-201">Este es un cambio que debe tomar cada vez que cree un control de `EntityDataSource`, a menos que necesite usar una conexión diferente de la que está codificada de forma rígida en la clase de contexto del objeto.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-201">This is a change you should make every time you create an `EntityDataSource` control, unless you need to use a connection that is different from the one that's hard-coded in the object context class.</span></span> <span data-ttu-id="7b3c9-202">El uso del atributo `ContextTypeName` proporciona las siguientes ventajas:</span><span class="sxs-lookup"><span data-stu-id="7b3c9-202">Using the `ContextTypeName` attribute provides the following benefits:</span></span>

- <span data-ttu-id="7b3c9-203">Mejor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-203">Better performance.</span></span> <span data-ttu-id="7b3c9-204">Cuando el control `EntityDataSource` inicializa el modelo de datos mediante los atributos `ConnectionString` y `DefaultContainerName`, realiza un trabajo adicional para cargar los metadatos en cada solicitud.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-204">When the `EntityDataSource` control initializes the data model using the `ConnectionString` and `DefaultContainerName` attributes, it performs additional work to load metadata on every request.</span></span> <span data-ttu-id="7b3c9-205">Esto no es necesario si se especifica el atributo `ContextTypeName`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-205">This isn't necessary if you specify the `ContextTypeName` attribute.</span></span>
- <span data-ttu-id="7b3c9-206">La carga diferida está activada de forma predeterminada en las clases de contexto de objetos generados (como `SchoolEntities` en este tutorial) en Entity Framework 4,0.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-206">Lazy loading is turned on by default in generated object context classes (such as `SchoolEntities` in this tutorial) in Entity Framework 4.0.</span></span> <span data-ttu-id="7b3c9-207">Esto significa que las propiedades de navegación se cargan con datos relacionados automáticamente justo cuando se necesitan.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-207">This means that navigation properties are loaded with related data automatically right when you need it.</span></span> <span data-ttu-id="7b3c9-208">La carga diferida se explica con más detalle más adelante en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-208">Lazy loading is explained in more detail later in this tutorial.</span></span>
- <span data-ttu-id="7b3c9-209">Cualquier personalización que haya aplicado a la clase de contexto de objeto (en este caso, la clase `SchoolEntities`) estará disponible para los controles que utilicen el control `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-209">Any customizations that you've applied to the object context class (in this case, the `SchoolEntities` class) will be available to controls that use the `EntityDataSource` control.</span></span> <span data-ttu-id="7b3c9-210">La personalización de la clase de contexto del objeto es un tema avanzado que no se trata en esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-210">Customizing the object context class is an advanced topic that is not covered in this tutorial series.</span></span> <span data-ttu-id="7b3c9-211">Para obtener más información, vea [extender Entity Framework tipos generados](https://msdn.microsoft.com/library/dd456844.aspx).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-211">For more information, see [Extending Entity Framework Generated Types](https://msdn.microsoft.com/library/dd456844.aspx).</span></span>

<span data-ttu-id="7b3c9-212">El marcado ahora será similar al ejemplo siguiente (el orden de las propiedades podría ser diferente):</span><span class="sxs-lookup"><span data-stu-id="7b3c9-212">The markup will now resemble the following example (the order of the properties might be different):</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample6.aspx)]

<span data-ttu-id="7b3c9-213">El atributo `EnableFlattening` hace referencia a una característica que se necesitaba en versiones anteriores del Entity Framework porque las columnas de clave externa no se exponían como propiedades de entidad.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-213">The `EnableFlattening` attribute refers to a feature that was needed in earlier versions of the Entity Framework because foreign key columns were not exposed as entity properties.</span></span> <span data-ttu-id="7b3c9-214">La versión actual hace posible el uso de *asociaciones de clave externa*, lo que significa que las propiedades de clave externa se exponen para todas las asociaciones de menos de varios a varios.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-214">The current version makes it possible to use *foreign key associations*, which means foreign key properties are exposed for all but many-to-many associations.</span></span> <span data-ttu-id="7b3c9-215">Si las entidades tienen propiedades de clave externa y no hay [tipos complejos](https://msdn.microsoft.com/library/bb738472.aspx), puede dejar este atributo establecido en `False`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-215">If your entities have foreign key properties and no [complex types](https://msdn.microsoft.com/library/bb738472.aspx), you can leave this attribute set to `False`.</span></span> <span data-ttu-id="7b3c9-216">No quite el atributo del marcado, ya que el valor predeterminado es `True`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-216">Don't remove the attribute from the markup, because the default value is `True`.</span></span> <span data-ttu-id="7b3c9-217">Para obtener más información, vea [Flatten (objetos) (EntityDataSource)](https://msdn.microsoft.com/library/ee404746.aspx).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-217">For more information, see [Flattening Objects (EntityDataSource)](https://msdn.microsoft.com/library/ee404746.aspx).</span></span>

<span data-ttu-id="7b3c9-218">Ejecute la página y verá una lista de estudiantes y empleados (va a filtrar solo para estudiantes en el siguiente tutorial).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-218">Run the page and you see a list of students and employees (you'll filter for just students in the next tutorial).</span></span> <span data-ttu-id="7b3c9-219">El nombre y los apellidos se muestran juntos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-219">The first name and last name are displayed together.</span></span>

<span data-ttu-id="7b3c9-220">[![Image07](the-entity-framework-and-aspnet-getting-started-part-2/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-220">[![Image07](the-entity-framework-and-aspnet-getting-started-part-2/_static/image36.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image35.png)</span></span>

<span data-ttu-id="7b3c9-221">Para ordenar la presentación, haga clic en el nombre de una columna.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-221">To sort the display, click a column name.</span></span>

<span data-ttu-id="7b3c9-222">Haga clic en **Editar** en cualquier fila.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-222">Click **Edit** in any row.</span></span> <span data-ttu-id="7b3c9-223">Se muestran cuadros de texto donde puede cambiar el nombre y el apellido.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-223">Text boxes are displayed where you can change the first and last name.</span></span>

<span data-ttu-id="7b3c9-224">[![Image08](the-entity-framework-and-aspnet-getting-started-part-2/_static/image38.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-224">[![Image08](the-entity-framework-and-aspnet-getting-started-part-2/_static/image38.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image37.png)</span></span>

<span data-ttu-id="7b3c9-225">El botón **eliminar** también funciona.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-225">The **Delete** button also works.</span></span> <span data-ttu-id="7b3c9-226">Haga clic en eliminar para una fila que tenga una fecha de inscripción y la fila desaparezca.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-226">Click delete for a row that has an enrollment date and the row disappears.</span></span> <span data-ttu-id="7b3c9-227">(Las filas sin una fecha de inscripción representan a los instructores y es posible que obtenga un error de integridad referencial.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-227">(Rows without an enrollment date represent instructors and you may get a referential integrity error.</span></span> <span data-ttu-id="7b3c9-228">En el siguiente tutorial, filtrará esta lista para incluir solo a los estudiantes).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-228">In the next tutorial you'll filter this list to include just students.)</span></span>

## <a name="displaying-data-from-a-navigation-property"></a><span data-ttu-id="7b3c9-229">Mostrar datos de una propiedad de navegación</span><span class="sxs-lookup"><span data-stu-id="7b3c9-229">Displaying Data from a Navigation Property</span></span>

<span data-ttu-id="7b3c9-230">Supongamos ahora que desea saber cuántos cursos está inscrito cada estudiante en.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-230">Now suppose you want to know how many courses each student is enrolled in.</span></span> <span data-ttu-id="7b3c9-231">El Entity Framework proporciona esa información en la propiedad de navegación `StudentGrades` de la entidad `Person`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-231">The Entity Framework provides that information in the `StudentGrades` navigation property of the `Person` entity.</span></span> <span data-ttu-id="7b3c9-232">Dado que el diseño de la base de datos no permite que un estudiante se inscriba en un curso sin tener una categoría asignada, en este tutorial puede suponer que tener una fila en la `StudentGrade` fila de la tabla asociada a un curso es la misma que la inscripción en el curso.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-232">Because the database design does not allow a student to be enrolled in a course without having a grade assigned, for this tutorial you can assume that having a row in the `StudentGrade` table row that is associated with a course is the same as being enrolled in the course.</span></span> <span data-ttu-id="7b3c9-233">(La propiedad de navegación `Courses` es solo para los instructores).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-233">(The `Courses` navigation property is only for instructors.)</span></span>

<span data-ttu-id="7b3c9-234">Cuando se usa el atributo `ContextTypeName` del control `EntityDataSource`, el Entity Framework recupera automáticamente la información de una propiedad de navegación cuando se obtiene acceso a esa propiedad.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-234">When you use the `ContextTypeName` attribute of the `EntityDataSource` control, the Entity Framework automatically retrieves information for a navigation property when you access that property.</span></span> <span data-ttu-id="7b3c9-235">Esto se denomina *carga diferida*.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-235">This is called *lazy loading*.</span></span> <span data-ttu-id="7b3c9-236">Sin embargo, esto puede ser ineficaz, ya que resulta en una llamada independiente a la base de datos cada vez que se necesita información adicional.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-236">However, this can be inefficient, because it results in a separate call to the database each time additional information is needed.</span></span> <span data-ttu-id="7b3c9-237">Si necesita datos de la propiedad de navegación para cada entidad devuelta por el control `EntityDataSource`, resulta más eficaz recuperar los datos relacionados junto con la propia entidad en una única llamada a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-237">If you need data from the navigation property for every entity returned by the `EntityDataSource` control, it's more efficient to retrieve the related data along with the entity itself in a single call to the database.</span></span> <span data-ttu-id="7b3c9-238">Esto se denomina *carga diligente*y se especifica la carga diligente para una propiedad de navegación estableciendo la propiedad `Include` del control `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-238">This is called *eager loading*, and you specify eager loading for a navigation property by setting the `Include` property of the `EntityDataSource` control.</span></span>

<span data-ttu-id="7b3c9-239">En *Students. aspx*, desea mostrar el número de cursos de cada estudiante, por lo que la carga diligente es la mejor opción.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-239">In *Students.aspx*, you want to show the number of courses for every student, so eager loading is the best choice.</span></span> <span data-ttu-id="7b3c9-240">Si estuviera mostrando todos los estudiantes pero mostrando el número de cursos solo para algunos de ellos (lo que requeriría escribir código adicional al marcado), la carga diferida podría ser una opción mejor.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-240">If you were displaying all students but showing the number of courses only for a few of them (which would require writing some code in addition to the markup), lazy loading might be a better choice.</span></span>

<span data-ttu-id="7b3c9-241">Abra o cambie a *Students. aspx*, cambie a la vista **diseño** , seleccione `StudentsEntityDataSource`y, en la ventana **propiedades** , establezca la propiedad **include** en **StudentGrades**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-241">Open or switch to *Students.aspx*, switch to **Design** view, select `StudentsEntityDataSource`, and in the **Properties** window set the **Include** property to **StudentGrades**.</span></span> <span data-ttu-id="7b3c9-242">(Si desea obtener varias propiedades de navegación, puede especificar sus nombres separados por comas, por ejemplo, **StudentGrades, Courses**).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-242">(If you wanted to get multiple navigation properties, you could specify their names separated by commas — for example, **StudentGrades, Courses**.)</span></span>

<span data-ttu-id="7b3c9-243">[![Image19](the-entity-framework-and-aspnet-getting-started-part-2/_static/image40.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-243">[![Image19](the-entity-framework-and-aspnet-getting-started-part-2/_static/image40.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image39.png)</span></span>

<span data-ttu-id="7b3c9-244">Cambie a la vista **código fuente** .</span><span class="sxs-lookup"><span data-stu-id="7b3c9-244">Switch to **Source** view.</span></span> <span data-ttu-id="7b3c9-245">En el control `StudentsGridView`, después del último elemento `asp:TemplateField`, agregue el siguiente campo de plantilla nuevo:</span><span class="sxs-lookup"><span data-stu-id="7b3c9-245">In the `StudentsGridView` control, after the last `asp:TemplateField` element, add the following new template field:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample7.aspx)]

<span data-ttu-id="7b3c9-246">En la expresión `Eval`, puede hacer referencia a la propiedad de navegación `StudentGrades`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-246">In the `Eval` expression, you can reference the navigation property `StudentGrades`.</span></span> <span data-ttu-id="7b3c9-247">Dado que esta propiedad contiene una colección, tiene una `Count` propiedad que puede usar para mostrar el número de cursos en los que se inscribe el estudiante.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-247">Because this property contains a collection, it has a `Count` property that you can use to display the number of courses in which the student is enrolled.</span></span> <span data-ttu-id="7b3c9-248">En un tutorial posterior, verá cómo mostrar los datos de las propiedades de navegación que contienen entidades individuales en lugar de colecciones.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-248">In a later tutorial you'll see how to display data from navigation properties that contain single entities instead of collections.</span></span> <span data-ttu-id="7b3c9-249">(Tenga en cuenta que no puede usar `BoundField` elementos para Mostrar datos de las propiedades de navegación).</span><span class="sxs-lookup"><span data-stu-id="7b3c9-249">(Note that you cannot use `BoundField` elements to display data from navigation properties.)</span></span>

<span data-ttu-id="7b3c9-250">Ejecute la página y ahora verá Cuántos cursos están inscritos en cada estudiante.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-250">Run the page and you now see how many courses each student is enrolled in.</span></span>

<span data-ttu-id="7b3c9-251">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image42.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-251">[![Image20](the-entity-framework-and-aspnet-getting-started-part-2/_static/image42.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image41.png)</span></span>

## <a name="using-a-detailsview-control-to-insert-entities"></a><span data-ttu-id="7b3c9-252">Usar un control DetailsView para insertar entidades</span><span class="sxs-lookup"><span data-stu-id="7b3c9-252">Using a DetailsView Control to Insert Entities</span></span>

<span data-ttu-id="7b3c9-253">El siguiente paso es crear una página que tenga un control `DetailsView` que le permita agregar nuevos alumnos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-253">The next step is to create a page that has a `DetailsView` control that will let you add new students.</span></span> <span data-ttu-id="7b3c9-254">Cierre el explorador y, a continuación, cree una nueva página web mediante la página maestra *site. Master* .</span><span class="sxs-lookup"><span data-stu-id="7b3c9-254">Close the browser and then create a new web page using the *Site.Master* master page.</span></span> <span data-ttu-id="7b3c9-255">Asigne a la página el nombre *StudentsAdd. aspx*y cambie a la vista **código fuente** .</span><span class="sxs-lookup"><span data-stu-id="7b3c9-255">Name the page *StudentsAdd.aspx*, and then switch to **Source** view.</span></span>

<span data-ttu-id="7b3c9-256">Agregue el marcado siguiente para reemplazar el marcado existente para el control `Content` denominado `Content2`:</span><span class="sxs-lookup"><span data-stu-id="7b3c9-256">Add the following markup to replace the existing markup for the `Content` control named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample8.aspx)]

<span data-ttu-id="7b3c9-257">Este marcado crea un control `EntityDataSource` que es similar a la que creó en *Students. aspx*, salvo que habilita la inserción.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-257">This markup creates an `EntityDataSource` control that is similar to the one you created in *Students.aspx*, except it enables insertion.</span></span> <span data-ttu-id="7b3c9-258">Al igual que con el control de `GridView`, los campos enlazados del control de `DetailsView` se codifican exactamente como serían para un control de datos que se conecta directamente a una base de datos, salvo que hacen referencia a las propiedades de la entidad.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-258">As with the `GridView` control, the bound fields of the `DetailsView` control are coded exactly as they would be for a data control that connects directly to a database, except that they reference entity properties.</span></span> <span data-ttu-id="7b3c9-259">En este caso, el control de `DetailsView` solo se usa para insertar filas, por lo que se ha establecido el modo predeterminado en `Insert`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-259">In this case, the `DetailsView` control is used only for inserting rows, so you have set the default mode to `Insert`.</span></span>

<span data-ttu-id="7b3c9-260">Ejecute la página y agregue un estudiante nuevo.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-260">Run the page and add a new student.</span></span>

<span data-ttu-id="7b3c9-261">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image44.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-261">[![Image09](the-entity-framework-and-aspnet-getting-started-part-2/_static/image44.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image43.png)</span></span>

<span data-ttu-id="7b3c9-262">No se producirá nada después de insertar un estudiante nuevo, pero si ahora ejecuta Student *. aspx*, verá la nueva información de estudiante.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-262">Nothing will happen after you insert a new student, but if you now run *Students.aspx*, you'll see the new student information.</span></span>

## <a name="displaying-data-in-a-drop-down-list"></a><span data-ttu-id="7b3c9-263">Mostrar datos en una lista desplegable</span><span class="sxs-lookup"><span data-stu-id="7b3c9-263">Displaying Data in a Drop-Down List</span></span>

<span data-ttu-id="7b3c9-264">En los pasos siguientes se enlazará un control `DropDownList` a un conjunto de entidades mediante un control `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-264">In the following steps you'll databind a `DropDownList` control to an entity set using an `EntityDataSource` control.</span></span> <span data-ttu-id="7b3c9-265">En esta parte del tutorial, no hará mucho con esta lista.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-265">In this part of the tutorial, you won't do much with this list.</span></span> <span data-ttu-id="7b3c9-266">Sin embargo, en los elementos siguientes, usará la lista para permitir que los usuarios seleccionen un departamento para mostrar los cursos asociados al Departamento.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-266">In subsequent parts, though, you'll use the list to let users select a department to display courses associated with the department.</span></span>

<span data-ttu-id="7b3c9-267">Cree una nueva página web denominada *Courses. aspx*.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-267">Create a new web page named *Courses.aspx*.</span></span> <span data-ttu-id="7b3c9-268">En la vista **código fuente** , agregue un encabezado al control `Content` denominado `Content2`:</span><span class="sxs-lookup"><span data-stu-id="7b3c9-268">In **Source** view, add a heading to the `Content` control that's named `Content2`:</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample9.aspx)]

<span data-ttu-id="7b3c9-269">En la vista **diseño** , agregue un control `EntityDataSource` a la página como hizo antes, con la excepción de que en este momento se le denomina `DepartmentsEntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-269">In **Design** view, add an `EntityDataSource` control to the page as you did before, except this time name it `DepartmentsEntityDataSource`.</span></span> <span data-ttu-id="7b3c9-270">Seleccione **departments (departamentos** ) como el valor de **entitySetName** y seleccione solo las propiedades **departmentId** y **Name** .</span><span class="sxs-lookup"><span data-stu-id="7b3c9-270">Select **Departments** as the **EntitySetName** value, and select only the **DepartmentID** and **Name** properties.</span></span>

<span data-ttu-id="7b3c9-271">[![Image15](the-entity-framework-and-aspnet-getting-started-part-2/_static/image46.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-271">[![Image15](the-entity-framework-and-aspnet-getting-started-part-2/_static/image46.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image45.png)</span></span>

<span data-ttu-id="7b3c9-272">En la pestaña **estándar** del **cuadro de herramientas**, arrastre un control `DropDownList` a la página, asígnele el nombre `DepartmentsDropDownList`, haga clic en la etiqueta inteligente y seleccione **elegir origen de datos** para iniciar el Asistente para configuración de **origen**de datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-272">From the **Standard** tab of the **Toolbox**, drag a `DropDownList` control to the page, name it `DepartmentsDropDownList`, click the smart tag, and select **Choose Data Source** to start the **DataSource Configuration Wizard**.</span></span>

<span data-ttu-id="7b3c9-273">[![Image16](the-entity-framework-and-aspnet-getting-started-part-2/_static/image48.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-273">[![Image16](the-entity-framework-and-aspnet-getting-started-part-2/_static/image48.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image47.png)</span></span>

<span data-ttu-id="7b3c9-274">En el paso **elegir un origen de datos** , seleccione **DepartmentsEntityDataSource** como origen de datos, haga clic en **actualizar esquema**y, a continuación, seleccione **nombre** como el campo de datos que se va a mostrar y **departmentId** como el campo de datos del valor.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-274">In the **Choose a Data Source** step, select **DepartmentsEntityDataSource** as the data source, click **Refresh Schema**, and then select **Name** as the data field to display and **DepartmentID** as the value data field.</span></span> <span data-ttu-id="7b3c9-275">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-275">Click **OK**.</span></span>

<span data-ttu-id="7b3c9-276">[![Image17](the-entity-framework-and-aspnet-getting-started-part-2/_static/image50.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-276">[![Image17](the-entity-framework-and-aspnet-getting-started-part-2/_static/image50.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image49.png)</span></span>

<span data-ttu-id="7b3c9-277">El método que se usa para enlazar el control mediante el Entity Framework es el mismo que con otros controles de origen de datos de ASP.NET, excepto que se especifican las entidades y las propiedades de la entidad.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-277">The method you use to databind the control using the Entity Framework is the same as with other ASP.NET data source controls except you're specifying entities and entity properties.</span></span>

<span data-ttu-id="7b3c9-278">Cambie a la vista **código fuente** y agregue "seleccionar un departamento:" inmediatamente antes del control `DropDownList`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-278">Switch to **Source** view and add "Select a department:" immediately before the `DropDownList` control.</span></span>

[!code-aspx[Main](the-entity-framework-and-aspnet-getting-started-part-2/samples/sample10.aspx)]

<span data-ttu-id="7b3c9-279">Como recordatorio, cambie el marcado del control `EntityDataSource` en este punto reemplazando los atributos `ConnectionString` y `DefaultContainerName` por un atributo `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-279">As a reminder, change the markup for the `EntityDataSource` control at this point by replacing the `ConnectionString` and `DefaultContainerName` attributes with a `ContextTypeName="ContosoUniversity.DAL.SchoolEntities"` attribute.</span></span> <span data-ttu-id="7b3c9-280">A menudo es mejor esperar hasta que haya creado el control enlazado a datos que está vinculado al control de origen de datos antes de cambiar el marcado de control de `EntityDataSource`, porque después de realizar el cambio, el diseñador no le proporcionará una opción **actualizar esquema** en el control enlazado a datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-280">It's often best to wait until after you've created the data-bound control that is linked to the data source control before you change the `EntityDataSource` control markup, because after you make the change, the designer will not provide you with a **Refresh Schema** option in the data-bound control.</span></span>

<span data-ttu-id="7b3c9-281">Ejecute la página y seleccione un departamento en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-281">Run the page and you can select a department from the drop-down list.</span></span>

<span data-ttu-id="7b3c9-282">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image52.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-282">[![Image18](the-entity-framework-and-aspnet-getting-started-part-2/_static/image52.png)](the-entity-framework-and-aspnet-getting-started-part-2/_static/image51.png)</span></span>

<span data-ttu-id="7b3c9-283">Esto completa la introducción al uso del control `EntityDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-283">This completes the introduction to using the `EntityDataSource` control.</span></span> <span data-ttu-id="7b3c9-284">Trabajar con este control no suele ser diferente de trabajar con otros controles de origen de datos de ASP.NET, salvo que se hace referencia a las entidades y propiedades en lugar de a las tablas y columnas.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-284">Working with this control is generally no different from working with other ASP.NET data source controls, except that you reference entities and properties instead of tables and columns.</span></span> <span data-ttu-id="7b3c9-285">La única excepción es cuando se desea tener acceso a las propiedades de navegación.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-285">The only exception is when you want to access navigation properties.</span></span> <span data-ttu-id="7b3c9-286">En el siguiente tutorial, verá que la sintaxis que se usa con `EntityDataSource` control también podría diferir de otros controles de origen de datos al filtrar, agrupar y ordenar los datos.</span><span class="sxs-lookup"><span data-stu-id="7b3c9-286">In the next tutorial you'll see that the syntax you use with `EntityDataSource` control might also differ from other data source controls when you filter, group, and order data.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7b3c9-287">[Anterior](the-entity-framework-and-aspnet-getting-started-part-1.md)
> [Siguiente](the-entity-framework-and-aspnet-getting-started-part-3.md)</span><span class="sxs-lookup"><span data-stu-id="7b3c9-287">[Previous](the-entity-framework-and-aspnet-getting-started-part-1.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-3.md)</span></span>

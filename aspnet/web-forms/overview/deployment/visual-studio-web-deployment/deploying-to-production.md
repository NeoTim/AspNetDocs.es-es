---
uid: web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
title: 'ASP.NET Web Deployment Using Visual Studio: Deploying to Production | Microsoft Docs'
author: tdykstra
description: En esta serie de tutoriales se muestra cómo implementar (publicar) una aplicación Web de ASP.NET en Azure App Service Web Apps o en un proveedor de hospedaje de terceros, por usa...
ms.author: riande
ms.date: 02/15/2013
ms.assetid: 416438a1-3b2f-4d27-bf53-6b76223c33bf
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
msc.type: authoredcontent
ms.openlocfilehash: ddc3d15f0436c4c3a24491cf0377111768da67df
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2019
ms.locfileid: "74617642"
---
# <a name="aspnet-web-deployment-using-visual-studio-deploying-to-production"></a><span data-ttu-id="06b42-103">Implementación web de ASP.NET con Visual Studio: implementación en producción</span><span class="sxs-lookup"><span data-stu-id="06b42-103">ASP.NET Web Deployment using Visual Studio: Deploying to Production</span></span>

<span data-ttu-id="06b42-104">por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="06b42-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="06b42-105">Descargar el proyecto de inicio</span><span class="sxs-lookup"><span data-stu-id="06b42-105">Download Starter Project</span></span>](https://go.microsoft.com/fwlink/p/?LinkId=282627)

> <span data-ttu-id="06b42-106">En esta serie de tutoriales se muestra cómo implementar (publicar) una aplicación Web de ASP.NET en Azure App Service Web Apps o en un proveedor de hospedaje de terceros mediante Visual Studio 2012 o Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="06b42-106">This tutorial series shows you how to deploy (publish) an ASP.NET web application to Azure App Service Web Apps or to a third-party hosting provider, by using Visual Studio 2012 or Visual Studio 2010.</span></span> <span data-ttu-id="06b42-107">Para obtener información sobre la serie, vea [el primer tutorial de la serie](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="06b42-107">For information about the series, see [the first tutorial in the series](introduction.md).</span></span>

## <a name="overview"></a><span data-ttu-id="06b42-108">Información general del</span><span class="sxs-lookup"><span data-stu-id="06b42-108">Overview</span></span>

<span data-ttu-id="06b42-109">En este tutorial, configurará una cuenta de Microsoft Azure, creará entornos de ensayo y producción e implementará la aplicación Web de ASP.NET en los entornos de ensayo y producción mediante la característica de publicación con un solo clic de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="06b42-109">In this tutorial, you set up a Microsoft Azure account, create staging and production environments, and deploy your ASP.NET web application to the staging and production environments by using the Visual Studio one-click publish feature.</span></span>

<span data-ttu-id="06b42-110">Si lo prefiere, puede realizar la implementación en un proveedor de hospedaje de terceros.</span><span class="sxs-lookup"><span data-stu-id="06b42-110">If you prefer, you can deploy to a third-party hosting provider.</span></span> <span data-ttu-id="06b42-111">La mayoría de los procedimientos descritos en este tutorial son los mismos para un proveedor de hospedaje o para Azure, salvo que cada proveedor tiene su propia interfaz de usuario para la administración de cuentas y sitios Web.</span><span class="sxs-lookup"><span data-stu-id="06b42-111">Most of the procedures described in this tutorial are the same for a hosting provider or for Azure, except that each provider has its own user interface for account and web site management.</span></span> <span data-ttu-id="06b42-112">Puede encontrar un proveedor de hospedaje en la [Galería de proveedores](https://www.microsoft.com/web/hosting) en el sitio web de Microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="06b42-112">You can find a hosting provider in the [gallery of providers](https://www.microsoft.com/web/hosting) on the Microsoft.com web site.</span></span>

<span data-ttu-id="06b42-113">Aviso: Si recibe un mensaje de error o algo no funciona a medida que avanza en el tutorial, asegúrese de consultar la página de solución de problemas de esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="06b42-113">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the Troubleshooting page in this tutorial series.</span></span>

## <a name="get-a-microsoft-azure-account"></a><span data-ttu-id="06b42-114">Obtener una cuenta de Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="06b42-114">Get a Microsoft Azure account</span></span>

<span data-ttu-id="06b42-115">Si aún no tiene una cuenta de Azure, puede crear una cuenta de evaluación gratuita en un par de minutos.</span><span class="sxs-lookup"><span data-stu-id="06b42-115">If you don't already have an Azure account, you can create a free trial account in just a couple of minutes.</span></span> <span data-ttu-id="06b42-116">Para obtener más información, consulte [evaluación gratuita de Azure](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span><span class="sxs-lookup"><span data-stu-id="06b42-116">For details, see [Azure Free Trial](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span></span>

## <a name="create-a-staging-environment"></a><span data-ttu-id="06b42-117">Crear un entorno de ensayo</span><span class="sxs-lookup"><span data-stu-id="06b42-117">Create a staging environment</span></span>

> [!NOTE]
> <span data-ttu-id="06b42-118">Dado que se ha escrito este tutorial, Azure App Service agregado una nueva característica para automatizar muchos de los procesos para crear entornos de ensayo y producción.</span><span class="sxs-lookup"><span data-stu-id="06b42-118">Since this tutorial was written, Azure App Service added a new feature to automate many of the processes for creating staging and production environments.</span></span> <span data-ttu-id="06b42-119">Consulte [configuración de entornos de ensayo para aplicaciones web en Azure App Service](https://azure.microsoft.com/documentation/articles/web-sites-staged-publishing/).</span><span class="sxs-lookup"><span data-stu-id="06b42-119">See [Set up staging environments for web apps in Azure App Service](https://azure.microsoft.com/documentation/articles/web-sites-staged-publishing/).</span></span>

<span data-ttu-id="06b42-120">Como se explica en el [tutorial implementar en el entorno de prueba](deploying-to-iis.md), el entorno de prueba más confiable es un sitio web en el proveedor de hospedaje que es como el sitio web de producción.</span><span class="sxs-lookup"><span data-stu-id="06b42-120">As explained in the [Deploy to the Test Environment tutorial](deploying-to-iis.md), the most reliable test environment is a web site at the hosting provider that's just like the production web site.</span></span> <span data-ttu-id="06b42-121">En muchos proveedores de hospedaje tendría que sopesar las ventajas de esto con un costo adicional importante, pero en Azure puede crear una aplicación web gratuita adicional como aplicación de ensayo.</span><span class="sxs-lookup"><span data-stu-id="06b42-121">At many hosting providers you would have to weigh the benefits of this against significant additional cost, but in Azure you can create an additional free web app as your staging app.</span></span> <span data-ttu-id="06b42-122">También necesita una base de datos, y los gastos adicionales por el gasto de su base de datos de producción serán ninguno o mínimo.</span><span class="sxs-lookup"><span data-stu-id="06b42-122">You also need a database, and the additional expense for that over the expense of your production database will be either none or minimal.</span></span> <span data-ttu-id="06b42-123">En Azure, se paga por la cantidad de almacenamiento de base de datos que se usa en lugar de para cada base de datos, y la cantidad de almacenamiento adicional que se va a usar en el almacenamiento provisional será mínima.</span><span class="sxs-lookup"><span data-stu-id="06b42-123">In Azure you pay for the amount of database storage you use rather than for each database, and the amount of additional storage you'll use in staging will be minimal.</span></span>

<span data-ttu-id="06b42-124">Como se explica en el [tutorial implementar en el entorno de prueba](deploying-to-iis.md), en ensayo y producción, va a implementar las dos bases de datos en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="06b42-124">As explained in the [Deploy to the Test Environment tutorial](deploying-to-iis.md), in staging and production you're going to deploy your two databases into one database.</span></span> <span data-ttu-id="06b42-125">Si desea mantenerlos separados, el proceso sería el mismo, salvo que crearía una base de datos adicional para cada entorno y seleccionaría la cadena de destino correcta para cada base de datos al crear el perfil de publicación.</span><span class="sxs-lookup"><span data-stu-id="06b42-125">If you wanted to keep them separate, the process would be the same except that you'd create an additional database for each environment and you would select the correct destination string for each database when you create the publish profile.</span></span>

<span data-ttu-id="06b42-126">En esta sección del tutorial, creará una aplicación web y una base de datos que se usarán para el entorno de ensayo y realizará la implementación en ensayo y pruebas antes de crear e implementar en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="06b42-126">In this section of the tutorial you'll create a web app and database to use for the staging environment, and you'll deploy to staging and test there before creating and deploying to the production environment.</span></span>

> [!NOTE]
> <span data-ttu-id="06b42-127">En los pasos siguientes se muestra cómo crear una aplicación web en Azure App Service mediante el portal de administración de Azure.</span><span class="sxs-lookup"><span data-stu-id="06b42-127">The following steps show how to create a web app in Azure App Service by using the Azure management portal.</span></span> <span data-ttu-id="06b42-128">En la versión más reciente del SDK de Azure, también puede hacerlo sin tener que cerrar Visual Studio, mediante el uso de Explorador de servidores.</span><span class="sxs-lookup"><span data-stu-id="06b42-128">In the latest version of the Azure SDK, you can also do this without leaving Visual Studio, by using Server Explorer.</span></span> <span data-ttu-id="06b42-129">En Visual Studio 2013, también puede crear una aplicación web directamente desde el cuadro de diálogo publicar.</span><span class="sxs-lookup"><span data-stu-id="06b42-129">In Visual Studio 2013, you can also create a web app directly from the Publish dialog.</span></span> <span data-ttu-id="06b42-130">Para obtener más información, consulte [creación de una aplicación Web de ASP.net en Azure App Service.](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)</span><span class="sxs-lookup"><span data-stu-id="06b42-130">For more information, see [Create an ASP.NET web app in Azure App Service.](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)</span></span>

1. <span data-ttu-id="06b42-131">En [Azure portal de administración](https://manage.windowsazure.com/), haga clic en **sitios web**y, a continuación, haga clic en **nuevo**.</span><span class="sxs-lookup"><span data-stu-id="06b42-131">In the [Azure Management Portal](https://manage.windowsazure.com/), click **Websites**, and then click **New**.</span></span>
2. <span data-ttu-id="06b42-132">Haga clic en **sitio web**y, a continuación, en **creación personalizada**.</span><span class="sxs-lookup"><span data-stu-id="06b42-132">Click **Website**, and then click **Custom Create**.</span></span>

    <span data-ttu-id="06b42-133">Se abre el Asistente para **crear nuevo sitio web** .</span><span class="sxs-lookup"><span data-stu-id="06b42-133">The **New Website - Custom Create** wizard opens.</span></span> <span data-ttu-id="06b42-134">El Asistente para **creación personalizada** le permite crear un sitio web y una base de datos al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="06b42-134">The **Custom Create** wizard enables you to create a web site and a database at the same time.</span></span>
3. <span data-ttu-id="06b42-135">En el paso **crear sitio web** del asistente, escriba una cadena en el cuadro **dirección URL** que se usará como dirección URL única para el entorno de ensayo de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="06b42-135">In the **Create Website** step of the wizard, enter a string in the **URL** box to use as the unique URL for your application's staging environment.</span></span> <span data-ttu-id="06b42-136">Por ejemplo, escriba ContosoUniversity-staging123 (incluidos los números aleatorios al final para que sea único en caso de que se realice ContosoUniversity-staging).</span><span class="sxs-lookup"><span data-stu-id="06b42-136">For example, enter ContosoUniversity-staging123 (including random numbers at the end to make it unique in case ContosoUniversity-staging is taken).</span></span>

    <span data-ttu-id="06b42-137">La dirección URL completa consistirá en lo que escriba aquí y el sufijo que aparece junto al cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="06b42-137">The complete URL will consist of what you enter here plus the suffix that you see next to the text box.</span></span>
4. <span data-ttu-id="06b42-138">En la lista desplegable **región** , elija la región más cercana a usted.</span><span class="sxs-lookup"><span data-stu-id="06b42-138">In the **Region** drop-down list, choose the region that is closest to you.</span></span>

    <span data-ttu-id="06b42-139">Esta configuración especifica en qué centro de datos se ejecutará la aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="06b42-139">This setting specifies which data center your web app will run in.</span></span>
5. <span data-ttu-id="06b42-140">En la lista desplegable **base de datos** , elija **crear una nueva base de datos SQL**.</span><span class="sxs-lookup"><span data-stu-id="06b42-140">In the **Database** drop-down list, choose **Create a new SQL database**.</span></span>
6. <span data-ttu-id="06b42-141">En el cuadro **nombre de cadena de conexión de base de BD** , deje el valor predeterminado, *DefaultConnection*.</span><span class="sxs-lookup"><span data-stu-id="06b42-141">In the **DB Connection String Name** box, leave the default value, *DefaultConnection*.</span></span>
7. <span data-ttu-id="06b42-142">Haga clic en la flecha que apunta a la derecha en la parte inferior del cuadro.</span><span class="sxs-lookup"><span data-stu-id="06b42-142">Click the arrow that points to the right at the bottom of the box.</span></span>

    <span data-ttu-id="06b42-143">En la ilustración siguiente se muestra el cuadro de diálogo **crear sitio web** con valores de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="06b42-143">The following illustration shows the **Create Website** dialog with sample values in it.</span></span> <span data-ttu-id="06b42-144">La dirección URL y la región que ha escrito serán diferentes.</span><span class="sxs-lookup"><span data-stu-id="06b42-144">The URL and Region that you have entered will be different.</span></span>

    ![Paso crear sitio web](deploying-to-production/_static/image1.png)

    <span data-ttu-id="06b42-146">El asistente avanza al paso **especificar configuración de base de datos** .</span><span class="sxs-lookup"><span data-stu-id="06b42-146">The wizard advances to the **Specify database settings** step.</span></span>
8. <span data-ttu-id="06b42-147">En el cuadro **nombre** , escriba *ContosoUniversity* más un número aleatorio para que sea único, por ejemplo, *ContosoUniversity123*.</span><span class="sxs-lookup"><span data-stu-id="06b42-147">In the **Name** box, enter *ContosoUniversity* plus a random number to make it unique, for example *ContosoUniversity123*.</span></span>
9. <span data-ttu-id="06b42-148">En el cuadro **servidor** , seleccione **nuevo SQL Database servidor**.</span><span class="sxs-lookup"><span data-stu-id="06b42-148">In the **Server** box, select **New SQL Database Server**.</span></span>
10. <span data-ttu-id="06b42-149">Escriba un nombre de administrador y una contraseña.</span><span class="sxs-lookup"><span data-stu-id="06b42-149">Enter an administrator name and password.</span></span>

    <span data-ttu-id="06b42-150">Aquí no escribe un nombre y una contraseña existentes.</span><span class="sxs-lookup"><span data-stu-id="06b42-150">You aren't entering an existing name and password here.</span></span> <span data-ttu-id="06b42-151">Va a escribir un nombre y una contraseña nuevos que está definiendo ahora para usarlos más adelante al obtener acceso a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="06b42-151">You're entering a new name and password that you're defining now to use later when you access the database.</span></span>
11. <span data-ttu-id="06b42-152">En el cuadro **región** , elija la misma región que eligió para la aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="06b42-152">In the **Region** box, choose the same region that you chose for the web app.</span></span>

    <span data-ttu-id="06b42-153">Mantener el servidor Web y el servidor de base de datos en la misma región le ofrece el mejor rendimiento y minimiza los gastos.</span><span class="sxs-lookup"><span data-stu-id="06b42-153">Keeping the web server and the database server in the same region gives you the best performance and minimizes expenses.</span></span>
12. <span data-ttu-id="06b42-154">Haga clic en la marca de verificación situada en la parte inferior del cuadro para indicar que ha terminado.</span><span class="sxs-lookup"><span data-stu-id="06b42-154">Click the check mark at the bottom of the box to indicate that you're finished.</span></span>

    <span data-ttu-id="06b42-155">En la ilustración siguiente se muestra el cuadro de diálogo **especificar configuración de base de datos** con valores de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="06b42-155">The following illustration shows the **Specify database settings** dialog with sample values in it.</span></span> <span data-ttu-id="06b42-156">Los valores especificados pueden ser diferentes.</span><span class="sxs-lookup"><span data-stu-id="06b42-156">The values you have entered may be different.</span></span>

    ![Paso de configuración de base de datos nuevo sitio web: Asistente crear con base de datos](deploying-to-production/_static/image2.png)

    <span data-ttu-id="06b42-158">El Portal de administración vuelve a la página websites y la columna **status** muestra que se está creando la aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="06b42-158">The Management Portal returns to the Websites page, and the **Status** column shows that the web app is being created.</span></span> <span data-ttu-id="06b42-159">Después de un tiempo (normalmente menos de un minuto), la columna **Estado** muestra que la aplicación web se ha creado correctamente.</span><span class="sxs-lookup"><span data-stu-id="06b42-159">After a while (typically less than a minute), the **Status** column shows that the web app was successfully created.</span></span> <span data-ttu-id="06b42-160">En la barra de navegación de la izquierda, el número de aplicaciones web que tiene en su cuenta aparece junto al icono de **websites** y el número de bases de datos aparece al lado del icono de **SQL Database** .</span><span class="sxs-lookup"><span data-stu-id="06b42-160">In the navigation bar at the left, the number of web apps you have in your account appears next to the **Websites** icon, and the number of databases appears next to the **SQL Databases** icon.</span></span>

    ![Página sitios web de Portal de administración, sitio web creado](deploying-to-production/_static/image3.png)

    <span data-ttu-id="06b42-162">El nombre de la aplicación web será diferente de la aplicación de ejemplo en la ilustración.</span><span class="sxs-lookup"><span data-stu-id="06b42-162">Your web app name will be different from the example app in the illustration.</span></span>

## <a name="deploy-the-application-to-staging"></a><span data-ttu-id="06b42-163">Implementar la aplicación en el almacenamiento provisional</span><span class="sxs-lookup"><span data-stu-id="06b42-163">Deploy the application to staging</span></span>

<span data-ttu-id="06b42-164">Ahora que ha creado una aplicación web y una base de datos para el entorno de ensayo, puede implementar el proyecto en ella.</span><span class="sxs-lookup"><span data-stu-id="06b42-164">Now that you have created a web app and database for the staging environment, you can deploy the project to it.</span></span>

> [!NOTE]
> <span data-ttu-id="06b42-165">Estas instrucciones muestran cómo crear un perfil de publicación descargando un archivo *. publishsettings* , que funciona no solo en Azure, sino también para proveedores de hospedaje de terceros.</span><span class="sxs-lookup"><span data-stu-id="06b42-165">These instructions show how to create a publish profile by downloading a *.publishsettings* file, which works not only for Azure but also for third-party hosting providers.</span></span> <span data-ttu-id="06b42-166">El último SDK de Azure también le permite conectarse directamente a Azure desde Visual Studio y elegir en una lista de aplicaciones web que tenga en su cuenta de Azure.</span><span class="sxs-lookup"><span data-stu-id="06b42-166">The latest Azure SDK also enables you to connect directly to Azure from Visual Studio, and choose from a list of web apps that you have in your Azure account.</span></span> <span data-ttu-id="06b42-167">En Visual Studio 2013, puede iniciar sesión en Azure desde el cuadro de diálogo **publicación web** o desde la ventana **Explorador de servidores** .</span><span class="sxs-lookup"><span data-stu-id="06b42-167">In Visual Studio 2013, you can sign in to Azure from the **Web Publish** dialog or from the **Server Explorer** window.</span></span> <span data-ttu-id="06b42-168">Para obtener más información, consulte [creación de una aplicación Web de ASP.net en Azure App Service](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span><span class="sxs-lookup"><span data-stu-id="06b42-168">For more information, see [Create an ASP.NET web app in Azure App Service](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span></span>

### <a name="download-the-publishsettings-file"></a><span data-ttu-id="06b42-169">Descargar el archivo. publishsettings</span><span class="sxs-lookup"><span data-stu-id="06b42-169">Download the .publishsettings file</span></span>

1. <span data-ttu-id="06b42-170">Haga clic en el nombre de la aplicación web que acaba de crear.</span><span class="sxs-lookup"><span data-stu-id="06b42-170">Click the name of the web app that you just created.</span></span>

    ![Haga clic en el sitio para ir al panel](deploying-to-production/_static/image4.png)
2. <span data-ttu-id="06b42-172">En **vista rápida** en la pestaña **Panel** , haga clic en **Descargar Perfil de publicación**.</span><span class="sxs-lookup"><span data-stu-id="06b42-172">Under **Quick glance** in the **Dashboard** tab, click **Download publish profile**.</span></span>

    ![Vínculo Descargar Perfil de publicación](deploying-to-production/_static/image5.png)

    <span data-ttu-id="06b42-174">En este paso se descarga un archivo que contiene toda la configuración que necesita para implementar una aplicación en la aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="06b42-174">This step downloads a file that contains all of the settings that you need in order to deploy an application to your web app.</span></span> <span data-ttu-id="06b42-175">Importará este archivo en Visual Studio para que no tenga que escribir esta información manualmente.</span><span class="sxs-lookup"><span data-stu-id="06b42-175">You'll import this file into Visual Studio so you don't have to enter this information manually.</span></span>
3. <span data-ttu-id="06b42-176">Guarde el archivo *. publishsettings* en una carpeta a la que pueda acceder desde Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="06b42-176">Save the *.publishsettings* file in a folder that you can access from Visual Studio.</span></span>

    ![guardar el archivo. publishsettings](deploying-to-production/_static/image6.png)

    > [!WARNING]
    > <span data-ttu-id="06b42-178">Seguridad: el archivo *. publishsettings* contiene sus credenciales (sin codificar) que se usan para administrar sus servicios y suscripciones de Azure.</span><span class="sxs-lookup"><span data-stu-id="06b42-178">Security - The *.publishsettings* file contains your credentials (unencoded) that are used to administer your Azure subscriptions and services.</span></span> <span data-ttu-id="06b42-179">El procedimiento recomendado de seguridad para este archivo consiste en almacenarlo temporalmente fuera de los directorios de origen (por ejemplo, en la carpeta Bibliotecas\documentos) y, a continuación, eliminarlo una vez completada la importación.</span><span class="sxs-lookup"><span data-stu-id="06b42-179">The security best practice for this file is to store it temporarily outside your source directories (for example in the Libraries\Documents folder), and then delete it once the import has completed.</span></span> <span data-ttu-id="06b42-180">Un usuario malintencionado que obtenga acceso al archivo *. publishsettings* puede editar, crear y eliminar sus servicios de Azure.</span><span class="sxs-lookup"><span data-stu-id="06b42-180">A malicious user who gains access to the *.publishsettings* file can edit, create, and delete your Azure services.</span></span>

### <a name="create-a-publish-profile"></a><span data-ttu-id="06b42-181">Crear un perfil de publicación</span><span class="sxs-lookup"><span data-stu-id="06b42-181">Create a publish profile</span></span>

1. <span data-ttu-id="06b42-182">En Visual Studio, haga clic con el botón derecho en el proyecto ContosoUniversity en **Explorador de soluciones** y seleccione **publicar** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="06b42-182">In Visual Studio, right-click the ContosoUniversity project in **Solution Explorer** and select **Publish** from the context menu.</span></span>

    <span data-ttu-id="06b42-183">Se abre el Asistente para **publicación web** .</span><span class="sxs-lookup"><span data-stu-id="06b42-183">The **Publish Web** wizard opens.</span></span>
2. <span data-ttu-id="06b42-184">Haga clic en la pestaña **perfil** .</span><span class="sxs-lookup"><span data-stu-id="06b42-184">Click the **Profile** tab.</span></span>
3. <span data-ttu-id="06b42-185">Haga clic en **importar**.</span><span class="sxs-lookup"><span data-stu-id="06b42-185">Click **Import**.</span></span>
4. <span data-ttu-id="06b42-186">Navegue hasta el archivo *. publishsettings* que descargó anteriormente y, a continuación, haga clic en **abrir**.</span><span class="sxs-lookup"><span data-stu-id="06b42-186">Navigate to the *.publishsettings* file you downloaded earlier, and then click **Open**.</span></span>

    ![Importar configuración de publicación (cuadro de diálogo)](deploying-to-production/_static/image7.png)
5. <span data-ttu-id="06b42-188">En la pestaña **conexión** , haga clic en **validar conexión** para asegurarse de que la configuración sea correcta.</span><span class="sxs-lookup"><span data-stu-id="06b42-188">In the **Connection** tab, click **Validate Connection** to make sure that the settings are correct.</span></span>

    <span data-ttu-id="06b42-189">Cuando se ha validado la conexión, se muestra una marca de verificación verde junto al botón **validar conexión** .</span><span class="sxs-lookup"><span data-stu-id="06b42-189">When the connection has been validated, a green check mark is shown next to the **Validate Connection** button.</span></span>

    <span data-ttu-id="06b42-190">En el caso de algunos proveedores de hospedaje, al hacer clic en **validar conexión**, es posible que aparezca un cuadro de diálogo de **error de certificado** .</span><span class="sxs-lookup"><span data-stu-id="06b42-190">For some hosting providers, when you click **Validate Connection**, you might see a **Certificate Error** dialog box.</span></span> <span data-ttu-id="06b42-191">Si lo hace, compruebe que el nombre del servidor es el esperado.</span><span class="sxs-lookup"><span data-stu-id="06b42-191">If you do, verify that the server name is what you expect.</span></span> <span data-ttu-id="06b42-192">Si el nombre del servidor es correcto, seleccione **guardar este certificado para sesiones futuras de Visual Studio** y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="06b42-192">If the server name is correct, select **Save this certificate for future sessions of Visual Studio** and click **Accept**.</span></span> <span data-ttu-id="06b42-193">(Este error significa que el proveedor de hospedaje ha elegido evitar el gasto de comprar un certificado SSL para la dirección URL en la que se está implementando.</span><span class="sxs-lookup"><span data-stu-id="06b42-193">(This error means that the hosting provider has chosen to avoid the expense of purchasing an SSL certificate for the URL that you are deploying to.</span></span> <span data-ttu-id="06b42-194">Si prefiere establecer una conexión segura con un certificado válido, póngase en contacto con el proveedor de hospedaje).</span><span class="sxs-lookup"><span data-stu-id="06b42-194">If you prefer to establish a secure connection by using a valid certificate, contact your hosting provider.)</span></span>
6. <span data-ttu-id="06b42-195">Haga clic en **Siguiente**.</span><span class="sxs-lookup"><span data-stu-id="06b42-195">Click **Next**.</span></span>

    ![icono conexión correcta y botón siguiente en la pestaña conexión](deploying-to-production/_static/image8.png)
7. <span data-ttu-id="06b42-197">En la pestaña **configuración** , expanda **Opciones de publicación de archivos**y, a continuación, seleccione **excluir archivos en la carpeta app\_Data**.</span><span class="sxs-lookup"><span data-stu-id="06b42-197">In the **Settings** tab, expand **File Publish Options**, and then select **Exclude files from the App\_Data folder**.</span></span>

    <span data-ttu-id="06b42-198">Para obtener información acerca de las demás opciones de **Opciones de publicación de archivos**, consulte el tutorial [implementación de IIS](deploying-to-iis.md) .</span><span class="sxs-lookup"><span data-stu-id="06b42-198">For information about the other options under **File Publish Options**, see the [deploying to IIS](deploying-to-iis.md) tutorial.</span></span> <span data-ttu-id="06b42-199">La captura de pantalla que muestra el resultado de este paso y los siguientes pasos de configuración de la base de datos se encuentra al final de los pasos de configuración de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="06b42-199">The screen shot that shows the result of this step and the following database configuration steps is at the end of the database configuration steps.</span></span>
8. <span data-ttu-id="06b42-200">En **DefaultConnection** , en la sección **bases** de datos, configure la implementación de bases de datos para la base de datos de pertenencia.</span><span class="sxs-lookup"><span data-stu-id="06b42-200">Under **DefaultConnection** in the **Databases** section, configure database deployment for the membership database.</span></span>
9. 1. <span data-ttu-id="06b42-201">Seleccione **Actualizar base de datos**.</span><span class="sxs-lookup"><span data-stu-id="06b42-201">Select **Update database**.</span></span>

        <span data-ttu-id="06b42-202">El cuadro **cadena de conexión remota** que se encuentra justo debajo de **DefaultConnection** se rellena con la cadena de conexión del archivo. publishsettings. La cadena de conexión incluye SQL Server credenciales, que se almacenan en texto sin formato en el archivo *. pubxml* .</span><span class="sxs-lookup"><span data-stu-id="06b42-202">The **Remote connection string** box directly below **DefaultConnection** is filled in with the connection string from the .publishsettings file.The connection string includes SQL Server credentials, which are stored in plain text in the *.pubxml* file.</span></span> <span data-ttu-id="06b42-203">Si prefiere no almacenarlas de forma permanente, puede quitarlas del perfil de publicación después de implementar la base de datos y almacenarlas en Azure en su lugar.</span><span class="sxs-lookup"><span data-stu-id="06b42-203">If you prefer not to store them permanently there, you can remove them from the publish profile after the database is deployed and store them in Azure instead.</span></span> <span data-ttu-id="06b42-204">Para obtener más información, consulte [Cómo mantener la seguridad de las cadenas de conexión de la base de datos de ASP.net al realizar la implementación en Azure desde el](http://www.hanselman.com/blog/HowToKeepYourASPNETDatabaseConnectionStringsSecureWhenDeployingToAzureFromSource.aspx) blog de Scott Hanselman.</span><span class="sxs-lookup"><span data-stu-id="06b42-204">For more information, see [How to keep your ASP.NET database connection strings secure when deploying to Azure from Source](http://www.hanselman.com/blog/HowToKeepYourASPNETDatabaseConnectionStringsSecureWhenDeployingToAzureFromSource.aspx) on Scott Hanselman's blog.</span></span>
      2. <span data-ttu-id="06b42-205">Haga clic en **configurar actualizaciones de base de datos**.</span><span class="sxs-lookup"><span data-stu-id="06b42-205">Click **Configure database updates**.</span></span>
      3. <span data-ttu-id="06b42-206">En el cuadro de diálogo **configurar actualizaciones de base de datos** , haga clic en **Agregar script SQL**.</span><span class="sxs-lookup"><span data-stu-id="06b42-206">In the **Configure Database Updates** dialog box, click **Add SQL Script**.</span></span>
      4. <span data-ttu-id="06b42-207">En el cuadro **Agregar script SQL** , navegue hasta el script *ASPNET-Data-Prod. SQL* que guardó anteriormente en la carpeta de la solución y, a continuación, haga clic en **abrir**.</span><span class="sxs-lookup"><span data-stu-id="06b42-207">In the **Add SQL Script** box, navigate to the *aspnet-data-prod.sql* script that you saved earlier in the solution folder, and then click **Open**.</span></span>
      5. <span data-ttu-id="06b42-208">Cierre el cuadro de diálogo **configurar actualizaciones de base de datos** .</span><span class="sxs-lookup"><span data-stu-id="06b42-208">Close the **Configure Database Updates** dialog box.</span></span>
10. <span data-ttu-id="06b42-209">En **SchoolContext** en la sección **bases de datos** , seleccione **Ejecutar migraciones de Code First (se ejecuta al iniciar la aplicación)** .</span><span class="sxs-lookup"><span data-stu-id="06b42-209">Under **SchoolContext** in the **Databases** section, select **Execute Code First Migrations (runs on application start)**.</span></span>

    <span data-ttu-id="06b42-210">Visual Studio muestra **ejecutar migraciones de Code First** en lugar de **Actualizar base de datos** para las clases de `DbContext`.</span><span class="sxs-lookup"><span data-stu-id="06b42-210">Visual Studio displays **Execute Code First Migrations** instead of **Update Database** for `DbContext` classes.</span></span> <span data-ttu-id="06b42-211">Si desea usar el proveedor de dbDacFx en lugar de las migraciones para implementar una base de datos a la que tiene acceso mediante una clase `DbContext`, consulte [cómo implementar una base de datos de Code First sin migraciones](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) . en las preguntas más frecuentes sobre la implementación web para Visual Studio y ASP.net en MSDN, vea.</span><span class="sxs-lookup"><span data-stu-id="06b42-211">If you want to use the dbDacFx provider instead of Migrations to deploy a database that you access by using a `DbContext` class, see [How do I deploy a Code First database without Migrations?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) in the Web Deployment FAQ for Visual Studio and ASP.NET on MSDN.</span></span>

    <span data-ttu-id="06b42-212">La pestaña **configuración** ahora es similar al ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="06b42-212">The **Settings** tab now looks like the following example:</span></span>

    ![Pestaña Configuración del almacenamiento provisional](deploying-to-production/_static/image9.png)
11. <span data-ttu-id="06b42-214">Realice los pasos siguientes para guardar el perfil y cambiarle el nombre a *almacenamiento provisional*:</span><span class="sxs-lookup"><span data-stu-id="06b42-214">Perform the following steps to save the profile and rename it to *Staging*:</span></span>

    1. <span data-ttu-id="06b42-215">Haga clic en la pestaña **perfil** y, a continuación, haga clic en **administrar perfiles**.</span><span class="sxs-lookup"><span data-stu-id="06b42-215">Click the **Profile** tab, and then click **Manage Profiles**.</span></span>
    2. <span data-ttu-id="06b42-216">La importación creó dos nuevos perfiles, uno para FTP y otro para Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="06b42-216">The import created two new profiles, one for FTP and one for Web Deploy.</span></span> <span data-ttu-id="06b42-217">Configuró el perfil de Web Deploy: cambie el nombre de este perfil a *ensayo*.</span><span class="sxs-lookup"><span data-stu-id="06b42-217">You configured the Web Deploy profile: rename this profile to *Staging*.</span></span>

        ![Cambiar el nombre del perfil a ensayo](deploying-to-production/_static/image10.png)
    3. <span data-ttu-id="06b42-219">Cierre el cuadro de diálogo **Editar perfiles de publicación web** .</span><span class="sxs-lookup"><span data-stu-id="06b42-219">Close the **Edit Web Publish Profiles** dialog box.</span></span>
    4. <span data-ttu-id="06b42-220">Cierre el Asistente para **publicación web** .</span><span class="sxs-lookup"><span data-stu-id="06b42-220">Close the **Publish Web** wizard.</span></span>

### <a name="configure-a-publish-profile-transform-for-the-environment-indicator"></a><span data-ttu-id="06b42-221">Configurar una transformación de Perfil de publicación para el indicador de entorno</span><span class="sxs-lookup"><span data-stu-id="06b42-221">Configure a publish profile transform for the environment indicator</span></span>

> [!NOTE]
> <span data-ttu-id="06b42-222">En esta sección se muestra cómo configurar una transformación de Web. config para el indicador de entorno.</span><span class="sxs-lookup"><span data-stu-id="06b42-222">This section shows how to set up a Web.config transform for the environment indicator.</span></span> <span data-ttu-id="06b42-223">Dado que el indicador está en el elemento `<appSettings>`, tiene otra alternativa para especificar la transformación cuando está implementando en Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="06b42-223">Because the indicator is in the `<appSettings>` element, you have another alternative for specifying the transformation when you're deploying to Azure App Service.</span></span> <span data-ttu-id="06b42-224">Para obtener más información, vea [especificar la configuración de Web. config en Azure](web-config-transformations.md#watransforms).</span><span class="sxs-lookup"><span data-stu-id="06b42-224">For more information, see [Specifying Web.config settings in Azure](web-config-transformations.md#watransforms).</span></span>

1. <span data-ttu-id="06b42-225">En **Explorador de soluciones**, expanda **propiedades**y, a continuación, expanda **PublishProfiles**.</span><span class="sxs-lookup"><span data-stu-id="06b42-225">In **Solution Explorer**, expand **Properties**, and then expand **PublishProfiles**.</span></span>
2. <span data-ttu-id="06b42-226">Haga clic con el botón secundario en *staging. pubxml*y, a continuación, haga clic en **Agregar transformación de configuración**.</span><span class="sxs-lookup"><span data-stu-id="06b42-226">Right-click *Staging.pubxml*, and then click **Add Config Transform**.</span></span>

    ![Agregar transformación de configuración para el almacenamiento provisional](deploying-to-production/_static/image11.png)

    <span data-ttu-id="06b42-228">Visual Studio crea el archivo de transformación *Web. staging. config* y lo abre.</span><span class="sxs-lookup"><span data-stu-id="06b42-228">Visual Studio creates the *Web.Staging.config* transform file and opens it.</span></span>
3. <span data-ttu-id="06b42-229">En el archivo de transformación *Web. staging. config* , inserte el siguiente código inmediatamente después de la etiqueta de apertura `configuration`.</span><span class="sxs-lookup"><span data-stu-id="06b42-229">In the *Web.Staging.config* transform file, insert the following code immediately after the opening `configuration` tag.</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample1.xml)]

    <span data-ttu-id="06b42-230">Cuando se usa el perfil de publicación de almacenamiento provisional, esta transformación establece el indicador de entorno en "Prod".</span><span class="sxs-lookup"><span data-stu-id="06b42-230">When you use the Staging publish profile, this transform sets the environment indicator to "Prod".</span></span> <span data-ttu-id="06b42-231">En la aplicación web implementada, no verá ningún sufijo como "(dev)" o "(test)" después del encabezado H1 "Contoso University".</span><span class="sxs-lookup"><span data-stu-id="06b42-231">In the deployed web app, you won't see any suffix such as "(Dev)" or "(Test)" after the "Contoso University" H1 heading.</span></span>
4. <span data-ttu-id="06b42-232">Haga clic con el botón secundario en el archivo *Web. staging. config* y haga clic en **vista previa de transformación** para asegurarse de que la transformación codificada genera los cambios esperados.</span><span class="sxs-lookup"><span data-stu-id="06b42-232">Right-click the *Web.Staging.config* file and click **Preview Transform** to make sure that the transform you coded produces the expected changes.</span></span>

    <span data-ttu-id="06b42-233">En la ventana de **vista previa de Web. config** se muestra el resultado de aplicar las transformaciones *Web. Release. config* y las transformaciones *Web. staging. config* .</span><span class="sxs-lookup"><span data-stu-id="06b42-233">The **Web.config Preview** window shows the result of applying both the *Web.Release.config* transforms and the *Web.Staging.config* transforms.</span></span>

### <a name="prevent-public-use-of-the-test-app"></a><span data-ttu-id="06b42-234">Impedir el uso público de la aplicación de prueba</span><span class="sxs-lookup"><span data-stu-id="06b42-234">Prevent public use of the test app</span></span>

<span data-ttu-id="06b42-235">Una consideración importante para la aplicación de ensayo es que estará activa en Internet, pero no desea que el público la use.</span><span class="sxs-lookup"><span data-stu-id="06b42-235">An important consideration for the staging app is that it will be live on the Internet, but you don't want the public to use it.</span></span> <span data-ttu-id="06b42-236">Para minimizar la probabilidad de que la gente la encuentre y la use, puede usar uno o varios de los métodos siguientes:</span><span class="sxs-lookup"><span data-stu-id="06b42-236">To minimize the likelihood that people will find and use it, you can use one or more of the following methods:</span></span>

- <span data-ttu-id="06b42-237">Establezca las reglas de firewall que permiten el acceso a la aplicación de ensayo solo desde las direcciones IP que se usan para probar el almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="06b42-237">Set firewall rules that allow access to the staging app only from IP addresses that you use to test staging.</span></span>
- <span data-ttu-id="06b42-238">Use una dirección URL ofuscada que sería imposible de adivinar.</span><span class="sxs-lookup"><span data-stu-id="06b42-238">Use an obfuscated URL that would be impossible to guess.</span></span>
- <span data-ttu-id="06b42-239">Cree un archivo *robots. txt* para asegurarse de que los motores de búsqueda no rastrearán la aplicación de prueba y los vínculos de informe a él en los resultados de la búsqueda.</span><span class="sxs-lookup"><span data-stu-id="06b42-239">Create a *robots.txt* file to ensure that search engines will not crawl the test app and report links to it in search results.</span></span>

<span data-ttu-id="06b42-240">El primero de estos métodos es el más eficaz, pero no se trata en este tutorial porque requeriría la implementación en un servicio en la nube de Azure en lugar de Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="06b42-240">The first of these methods is the most effective but is not covered in this tutorial because it would require that you deploy to an Azure Cloud Service instead of Azure App Service.</span></span> <span data-ttu-id="06b42-241">Para obtener más información acerca de las restricciones de Cloud Services y IP en Azure, consulte [Opciones de hospedaje de proceso proporcionadas por Azure](https://docs.microsoft.com/azure/cloud-services/cloud-services-choose-me) y [bloquear el acceso de direcciones IP específicas a un rol Web](https://msdn.microsoft.com/library/windowsazure/jj154098.aspx).</span><span class="sxs-lookup"><span data-stu-id="06b42-241">For more information about Cloud Services and IP restrictions in Azure, see [Compute Hosting Options Provided by Azure](https://docs.microsoft.com/azure/cloud-services/cloud-services-choose-me) and [Block Specific IP Addresses from Accessing a Web Role](https://msdn.microsoft.com/library/windowsazure/jj154098.aspx).</span></span> <span data-ttu-id="06b42-242">Si va a realizar la implementación en un proveedor de hospedaje de terceros, póngase en contacto con el proveedor para averiguar cómo implementar las restricciones de IP.</span><span class="sxs-lookup"><span data-stu-id="06b42-242">If you are deploying to a third-party hosting provider, contact the provider to find out how to implement IP restrictions.</span></span>

<span data-ttu-id="06b42-243">En este tutorial, creará un archivo *robots. txt* .</span><span class="sxs-lookup"><span data-stu-id="06b42-243">For this tutorial, you'll create a *robots.txt* file.</span></span>

1. <span data-ttu-id="06b42-244">En **Explorador de soluciones**, haga clic con el botón secundario en el proyecto ContosoUniversity y haga clic en **Agregar nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="06b42-244">In **Solution Explorer**, right-click the ContosoUniversity project and click **Add New Item**.</span></span>
2. <span data-ttu-id="06b42-245">Cree un nuevo **archivo de texto** llamado *robots. txt*y escriba el texto siguiente:</span><span class="sxs-lookup"><span data-stu-id="06b42-245">Create a new **Text File** named *robots.txt*, and put the following text in it:</span></span>

    [!code-console[Main](deploying-to-production/samples/sample2.cmd)]

    <span data-ttu-id="06b42-246">La línea de `User-agent` indica a los motores de búsqueda que las reglas del archivo se aplican a todos los rastreadores web (robots) del motor de búsqueda, y la línea `Disallow` especifica que no se debe rastrear ninguna página en el sitio.</span><span class="sxs-lookup"><span data-stu-id="06b42-246">The `User-agent` line tells search engines that the rules in the file apply to all search engine web crawlers (robots), and the `Disallow` line specifies that no pages on the site should be crawled.</span></span>

    <span data-ttu-id="06b42-247">Quiere que los motores de búsqueda cataloguen su aplicación de producción, por lo que debe excluir este archivo de la implementación de producción.</span><span class="sxs-lookup"><span data-stu-id="06b42-247">You do want search engines to catalog your production app, so you need to exclude this file from production deployment.</span></span> <span data-ttu-id="06b42-248">Para ello, configurará un valor en el perfil de publicación de producción al crearlo.</span><span class="sxs-lookup"><span data-stu-id="06b42-248">To do that, you'll configure a setting in the Production publish profile when you create it.</span></span>

### <a name="deploy-to-staging"></a><span data-ttu-id="06b42-249">Implementar en el almacenamiento provisional</span><span class="sxs-lookup"><span data-stu-id="06b42-249">Deploy to staging</span></span>

1. <span data-ttu-id="06b42-250">Abra el Asistente para **publicación web** haciendo clic con el botón secundario en el proyecto contoso University y haciendo clic en **publicar**.</span><span class="sxs-lookup"><span data-stu-id="06b42-250">Open the **Publish Web** wizard by right-clicking the Contoso University project and clicking **Publish**.</span></span>
2. <span data-ttu-id="06b42-251">Asegúrese de que está seleccionado el perfil de **almacenamiento provisional** .</span><span class="sxs-lookup"><span data-stu-id="06b42-251">Make sure that the **Staging** profile is selected.</span></span>
3. <span data-ttu-id="06b42-252">Haga clic en **Publicar**.</span><span class="sxs-lookup"><span data-stu-id="06b42-252">Click **Publish**.</span></span>

    <span data-ttu-id="06b42-253">La ventana **salida** muestra las acciones de implementación que se realizaron e informa de la finalización correcta de la implementación.</span><span class="sxs-lookup"><span data-stu-id="06b42-253">The **Output** window shows what deployment actions were taken and reports successful completion of the deployment.</span></span> <span data-ttu-id="06b42-254">El explorador predeterminado se abre automáticamente en la dirección URL de la aplicación web implementada.</span><span class="sxs-lookup"><span data-stu-id="06b42-254">The default browser automatically opens to the URL of the deployed web app.</span></span>

## <a name="test-in-the-staging-environment"></a><span data-ttu-id="06b42-255">Prueba en el entorno de ensayo</span><span class="sxs-lookup"><span data-stu-id="06b42-255">Test in the staging environment</span></span>

<span data-ttu-id="06b42-256">Observe que el indicador de entorno está ausente (no hay "(test)" o "(dev)" después del encabezado H1, lo que muestra que la transformación de *Web. config* para el indicador de entorno se ha realizado correctamente.</span><span class="sxs-lookup"><span data-stu-id="06b42-256">Notice that the environment indicator is absent (there is no "(Test)" or "(Dev)" after the H1 heading, which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

![Almacenamiento provisional de página principal](deploying-to-production/_static/image12.png)

<span data-ttu-id="06b42-258">Ejecute la página **Students** para comprobar que la base de datos implementada no tiene estudiantes.</span><span class="sxs-lookup"><span data-stu-id="06b42-258">Run the **Students** page to verify that the deployed database has no students.</span></span>

<span data-ttu-id="06b42-259">Ejecute la página **instructores** para comprobar que Code First ha inicializado la base de datos con datos del instructor:</span><span class="sxs-lookup"><span data-stu-id="06b42-259">Run the **Instructors** page to verify that Code First seeded the database with instructor data:</span></span>

<span data-ttu-id="06b42-260">Seleccione **Agregar estudiantes** en el menú **estudiantes** , agregue un estudiante y, a continuación, vea el nuevo estudiante en **la página** Students para comprobar que puede escribir correctamente en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="06b42-260">Select **Add Students** from the **Students** menu, add a student, and then view the new student in the **Students** page to verify that you can successfully write to the database.</span></span>

<span data-ttu-id="06b42-261">En la página **cursos** , haga clic en **Actualizar créditos**.</span><span class="sxs-lookup"><span data-stu-id="06b42-261">From the **Courses** page, click **Update Credits**.</span></span> <span data-ttu-id="06b42-262">La página **Actualizar créditos** requiere permisos de administrador, por lo que se muestra la página **de inicio de sesión** .</span><span class="sxs-lookup"><span data-stu-id="06b42-262">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="06b42-263">Escriba las credenciales de la cuenta de administrador que creó anteriormente ("admin" y "prodpwd").</span><span class="sxs-lookup"><span data-stu-id="06b42-263">Enter the administrator account credentials that you created earlier ("admin" and "prodpwd").</span></span> <span data-ttu-id="06b42-264">Se muestra la página **Actualizar créditos** , que comprueba que la cuenta de administrador que creó en el tutorial anterior se ha implementado correctamente en el entorno de prueba.</span><span class="sxs-lookup"><span data-stu-id="06b42-264">The **Update Credits** page is displayed, which verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="06b42-265">Solicite una dirección URL no válida para producir un error en el que se realizará ELMAH y, a continuación, solicite el informe de errores ELMAH.</span><span class="sxs-lookup"><span data-stu-id="06b42-265">Request an invalid URL to cause an error that ELMAH will track, and then request the ELMAH error report.</span></span> <span data-ttu-id="06b42-266">Si va a realizar la implementación en un proveedor de hospedaje de terceros, probablemente encontrará que el informe está vacío por el mismo motivo que estaba vacío en el tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="06b42-266">If you are deploying to a third-party hosting provider, you will probably find that the report is empty for the same reason that it was empty in the previous tutorial.</span></span> <span data-ttu-id="06b42-267">Tendrá que usar las herramientas de administración de cuentas del proveedor de hospedaje para configurar los permisos de carpeta a fin de permitir que ELMAH escriba en la carpeta de registro.</span><span class="sxs-lookup"><span data-stu-id="06b42-267">You will have to use the hosting provider's account management tools to configure folder permissions to enable ELMAH to write to the log folder.</span></span>

<span data-ttu-id="06b42-268">La aplicación que ha creado se ejecuta ahora en la nube en una aplicación web que es similar a la que va a usar para producción.</span><span class="sxs-lookup"><span data-stu-id="06b42-268">The application that you created is now running in the cloud in a web app that is just like what you will use for production.</span></span> <span data-ttu-id="06b42-269">Dado que todo funciona correctamente, el siguiente paso es implementar en producción.</span><span class="sxs-lookup"><span data-stu-id="06b42-269">Since everything is working correctly, the next step is to deploy to production.</span></span>

## <a name="deploy-to-production"></a><span data-ttu-id="06b42-270">Implementación en producción</span><span class="sxs-lookup"><span data-stu-id="06b42-270">Deploy to production</span></span>

<span data-ttu-id="06b42-271">El proceso de creación de una aplicación Web de producción y la implementación en producción es el mismo que para el almacenamiento provisional, salvo que debe excluir el archivo *robots. txt* de la implementación.</span><span class="sxs-lookup"><span data-stu-id="06b42-271">The process for creating a production web app and deploying to production is the same as for staging, except that you need to exclude the *robots.txt* from deployment.</span></span> <span data-ttu-id="06b42-272">Para ello, edite el archivo de Perfil de publicación.</span><span class="sxs-lookup"><span data-stu-id="06b42-272">To do that you'll edit the publish profile file.</span></span>

### <a name="create-the-production-environment-and-the-production-publish-profile"></a><span data-ttu-id="06b42-273">Crear el entorno de producción y el perfil de publicación de producción</span><span class="sxs-lookup"><span data-stu-id="06b42-273">Create the production environment and the production publish profile</span></span>

1. <span data-ttu-id="06b42-274">Cree la aplicación web y la base de datos de producción en Azure siguiendo el mismo procedimiento que usó para el almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="06b42-274">Create the production web app and database in Azure, following the same procedure that you used for staging.</span></span>

    <span data-ttu-id="06b42-275">Al crear la base de datos, puede elegir colocarla en el mismo servidor que creó anteriormente, o crear un nuevo servidor.</span><span class="sxs-lookup"><span data-stu-id="06b42-275">When you create the database, you can choose to put it on the same server you created earlier, or create a new server.</span></span>
2. <span data-ttu-id="06b42-276">Descargue el archivo *. publishsettings* .</span><span class="sxs-lookup"><span data-stu-id="06b42-276">Download the *.publishsettings* file.</span></span>
3. <span data-ttu-id="06b42-277">Cree el perfil de publicación importando el archivo Production *. publishsettings* siguiendo el mismo procedimiento que usó para el almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="06b42-277">Create the publish profile by importing the production *.publishsettings* file, following the same procedure that you used for staging.</span></span>

    <span data-ttu-id="06b42-278">No olvide configurar el script de implementación de datos en **DefaultConnection** en la sección **bases** de datos de la pestaña **configuración** .</span><span class="sxs-lookup"><span data-stu-id="06b42-278">Don't forget to configure the data deployment script under **DefaultConnection** in the **Databases** section of the **Settings** tab.</span></span>
4. <span data-ttu-id="06b42-279">Cambie el nombre del perfil de publicación a *producción*.</span><span class="sxs-lookup"><span data-stu-id="06b42-279">Rename the publish profile to *Production*.</span></span>
5. <span data-ttu-id="06b42-280">Configure una transformación de Perfil de publicación para el indicador de entorno, siguiendo el mismo procedimiento que usó para el almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="06b42-280">Configure a publish profile transform for the environment indicator, following the same procedure that you used for staging..</span></span>

### <a name="edit-the-pubxml-file-to-exclude-robotstxt"></a><span data-ttu-id="06b42-281">Edite el archivo. pubxml para excluir robots. txt</span><span class="sxs-lookup"><span data-stu-id="06b42-281">Edit the .pubxml file to exclude robots.txt</span></span>

<span data-ttu-id="06b42-282">Los archivos de Perfil de publicación se denominan &lt;ProfileName&gt; *. pubxml* y se encuentran en la carpeta *PublishProfiles* .</span><span class="sxs-lookup"><span data-stu-id="06b42-282">Publish profile files are named &lt;profilename&gt;*.pubxml* and are located in the *PublishProfiles* folder.</span></span> <span data-ttu-id="06b42-283">La carpeta *PublishProfiles* se encuentra en la carpeta *propiedades* de C# un proyecto de aplicación Web, en la carpeta *mi proyecto* de un proyecto de aplicación web VB, o en la carpeta *App\_Data* de un proyecto de aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="06b42-283">The *PublishProfiles* folder is under the *Properties* folder in a C# web application project, under the *My Project* folder in a VB web application project, or under the *App\_Data* folder in a web app project.</span></span> <span data-ttu-id="06b42-284">Cada archivo *. pubxml* contiene los valores que se aplican a un perfil de publicación.</span><span class="sxs-lookup"><span data-stu-id="06b42-284">Each *.pubxml* file contains settings that apply to one publish profile.</span></span> <span data-ttu-id="06b42-285">Los valores que escriba en el Asistente para publicación web se almacenan en estos archivos, y puede modificarlos para crear o cambiar la configuración que no está disponible en la interfaz de usuario de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="06b42-285">The values you enter in the Publish Web wizard are stored in these files, and you can edit them to create or change settings that aren't made available in the Visual Studio UI.</span></span>

<span data-ttu-id="06b42-286">De forma predeterminada, los archivos *. pubxml* se incluyen en el proyecto al crear un perfil de publicación, pero puede excluirlos del proyecto y Visual Studio los usará.</span><span class="sxs-lookup"><span data-stu-id="06b42-286">By default, *.pubxml* files are included in the project when you create a publish profile, but you can exclude them from the project and Visual Studio will still use them.</span></span> <span data-ttu-id="06b42-287">Visual Studio busca en la carpeta *PublishProfiles* los archivos *. pubxml* , independientemente de si están incluidos en el proyecto.</span><span class="sxs-lookup"><span data-stu-id="06b42-287">Visual Studio looks in the *PublishProfiles* folder for *.pubxml* files, regardless of whether they are included in the project.</span></span>

<span data-ttu-id="06b42-288">Para cada archivo *. pubxml* hay un archivo *. pubxml. User* .</span><span class="sxs-lookup"><span data-stu-id="06b42-288">For each *.pubxml* file there is a *.pubxml.user* file.</span></span> <span data-ttu-id="06b42-289">El archivo *. pubxml. User* contiene la contraseña cifrada si seleccionó la opción **guardar contraseña** y, de forma predeterminada, se excluye del proyecto.</span><span class="sxs-lookup"><span data-stu-id="06b42-289">The *.pubxml.user* file contains the encrypted password if you selected the **Save password** option, and by default it is excluded from the project.</span></span>

<span data-ttu-id="06b42-290">Un archivo *. pubxml* contiene la configuración que pertenece a un perfil de publicación específico.</span><span class="sxs-lookup"><span data-stu-id="06b42-290">A *.pubxml* file contains the settings that pertain to a specific publish profile.</span></span> <span data-ttu-id="06b42-291">Si desea configurar las opciones que se aplican a todos los perfiles, puede crear un archivo *. WPP. targets* .</span><span class="sxs-lookup"><span data-stu-id="06b42-291">If you want to configure settings that apply to all profiles, you can create a *.wpp.targets* file.</span></span> <span data-ttu-id="06b42-292">El proceso de compilación importa estos archivos en el archivo de proyecto *. csproj* o *. vbproj* , por lo que la mayoría de las opciones que se pueden configurar en el archivo de proyecto se pueden configurar en estos archivos.</span><span class="sxs-lookup"><span data-stu-id="06b42-292">The build process imports these files into the *.csproj* or *.vbproj* project file, so most settings that you can configure in the project file can be configured in these files.</span></span> <span data-ttu-id="06b42-293">Para obtener más información sobre los archivos *. pubxml* y los archivos. *WPP. targets* , vea [Cómo: editar la configuración de implementación en archivos de Perfil de publicación (. pubxml) y el archivo. WPP. targets en proyectos Web de Visual Studio](https://msdn.microsoft.com/library/ff398069.aspx).</span><span class="sxs-lookup"><span data-stu-id="06b42-293">For more information about *.pubxml* files and *.wpp.targets* files, see [How to: Edit Deployment Settings in Publish Profile (.pubxml) Files and the .wpp.targets File in Visual Studio Web Projects](https://msdn.microsoft.com/library/ff398069.aspx).</span></span>

1. <span data-ttu-id="06b42-294">En **Explorador de soluciones**, expanda **propiedades** y expanda **PublishProfiles**.</span><span class="sxs-lookup"><span data-stu-id="06b42-294">In **Solution Explorer**, expand **Properties** and expand **PublishProfiles**.</span></span>
2. <span data-ttu-id="06b42-295">Haga clic con el botón secundario en *Production. pubxml* y haga clic en **abrir**.</span><span class="sxs-lookup"><span data-stu-id="06b42-295">Right-click *Production.pubxml* and click **Open**.</span></span>

    ![Abra el archivo. pubxml](deploying-to-production/_static/image13.png)
3. <span data-ttu-id="06b42-297">Haga clic con el botón secundario en *Production. pubxml* y haga clic en **abrir**.</span><span class="sxs-lookup"><span data-stu-id="06b42-297">Right-click *Production.pubxml* and click **Open**.</span></span>
4. <span data-ttu-id="06b42-298">Agregue las líneas siguientes inmediatamente antes del elemento de `PropertyGroup` de cierre:</span><span class="sxs-lookup"><span data-stu-id="06b42-298">Add the following lines immediately before the closing `PropertyGroup` element:</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample3.xml)]

    <span data-ttu-id="06b42-299">El archivo. pubxml ahora es similar al ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="06b42-299">The .pubxml file now looks like the following example:</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample4.xml?highlight=18-20)]

    <span data-ttu-id="06b42-300">Para obtener más información sobre cómo excluir archivos y carpetas, vea ¿puedo [excluir archivos o carpetas específicos de la implementación?](https://msdn.microsoft.com/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment) en las **preguntas más frecuentes sobre la implementación web para Visual Studio y ASP.net** en MSDN.</span><span class="sxs-lookup"><span data-stu-id="06b42-300">For more information about how to exclude files and folders, see [Can I exclude specific files or folders from deployment?](https://msdn.microsoft.com/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment) in the **Web Deployment FAQ for Visual Studio and ASP.NET** on MSDN.</span></span>

### <a name="deploy-to-production"></a><span data-ttu-id="06b42-301">Implementación en producción</span><span class="sxs-lookup"><span data-stu-id="06b42-301">Deploy to production</span></span>

1. <span data-ttu-id="06b42-302">Abra el Asistente para **publicación web** Asegúrese de que el perfil de publicación de **producción** está seleccionado y, a continuación, haga clic en **iniciar vista previa** en la pestaña **vista previa** para comprobar que el archivo *robots. txt* no se copiará en la aplicación de producción.</span><span class="sxs-lookup"><span data-stu-id="06b42-302">Open the **Publish Web** wizard make sure that the **Production** publish profile is selected, and then click **Start Preview** on the **Preview** tab to verify that the *robots.txt* file will not be copied to the production app.</span></span>

    ![Vista previa de los archivos que se van a publicar en producción](deploying-to-production/_static/image14.png)

    <span data-ttu-id="06b42-304">Revise la lista de archivos que se copiarán.</span><span class="sxs-lookup"><span data-stu-id="06b42-304">Review the list of files that will be copied.</span></span> <span data-ttu-id="06b42-305">Verá que se omiten todos los archivos *. CS* , incluidos los archivos *. aspx.cs*, *. aspx.Designer.CS*, *Master.CS*y *Master.Designer.CS* .</span><span class="sxs-lookup"><span data-stu-id="06b42-305">You'll see that all of the *.cs* files, including *.aspx.cs*, *.aspx.designer.cs*, *Master.cs*, and *Master.designer.cs* files are omitted.</span></span> <span data-ttu-id="06b42-306">Todo este código se ha compilado en los archivos *ContosoUniversity. dll* y *ContosoUniversity. pdb* que encontrará en la carpeta *bin* .</span><span class="sxs-lookup"><span data-stu-id="06b42-306">All of this code has been compiled into the *ContosoUniversity.dll* and *ContosoUniversity.pdb* files that you'll find in the *bin* folder.</span></span> <span data-ttu-id="06b42-307">Dado que solo se necesita el *archivo. dll* para ejecutar la aplicación y ha especificado anteriormente que solo se deben implementar los archivos necesarios para ejecutar la aplicación, no se copiaron los archivos *. CS* en el entorno de destino.</span><span class="sxs-lookup"><span data-stu-id="06b42-307">Because only the *.dll* is needed to run the application, and you specified earlier that only files needed to run the application should be deployed, no *.cs* files were copied to the destination environment.</span></span> <span data-ttu-id="06b42-308">La carpeta *obj* y los archivos *ContosoUniversity. csproj* y *. csproj. User* se omiten por la misma razón.</span><span class="sxs-lookup"><span data-stu-id="06b42-308">The *obj* folder and the *ContosoUniversity.csproj* and *.csproj.user* files are omitted for the same reason.</span></span>

    <span data-ttu-id="06b42-309">Haga clic en **publicar** para implementar en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="06b42-309">Click **Publish** to deploy to the production environment.</span></span>
2. <span data-ttu-id="06b42-310">Pruebe en producción siguiendo el mismo procedimiento que usó para el almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="06b42-310">Test in production, following the same procedure you used for staging.</span></span>

    <span data-ttu-id="06b42-311">Todo es idéntico al almacenamiento provisional excepto la dirección URL y la ausencia del archivo *robots. txt* .</span><span class="sxs-lookup"><span data-stu-id="06b42-311">Everything is identical to staging except for the URL and the absence of the *robots.txt* file.</span></span>

## <a name="summary"></a><span data-ttu-id="06b42-312">Resumen</span><span class="sxs-lookup"><span data-stu-id="06b42-312">Summary</span></span>

<span data-ttu-id="06b42-313">Ahora ha implementado y probado correctamente su aplicación web y está disponible públicamente a través de Internet.</span><span class="sxs-lookup"><span data-stu-id="06b42-313">You have now successfully deployed and tested your web app and it is available publicly over the Internet.</span></span>

![Página principal de producción](deploying-to-production/_static/image15.png)

<span data-ttu-id="06b42-315">En el siguiente tutorial, actualizará el código de la aplicación e implementará el cambio en los entornos de prueba, ensayo y producción.</span><span class="sxs-lookup"><span data-stu-id="06b42-315">In the next tutorial, you'll update application code and deploy the change to the test, staging, and production environments.</span></span>

> [!NOTE]
> <span data-ttu-id="06b42-316">Mientras la aplicación está en uso en el entorno de producción, debe implementar un plan de recuperación.</span><span class="sxs-lookup"><span data-stu-id="06b42-316">While your application is in use in the production environment you should be implementing a recovery plan.</span></span> <span data-ttu-id="06b42-317">Es decir, debe realizar copias de seguridad periódicas de las bases de datos de la aplicación de producción en una ubicación de almacenamiento segura y debe mantener varias generaciones de dichas copias de seguridad.</span><span class="sxs-lookup"><span data-stu-id="06b42-317">That is, you should be periodically backing up your databases from the production app to a secure storage location, and you should be keeping several generations of such backups.</span></span> <span data-ttu-id="06b42-318">Al actualizar la base de datos, debe realizar una copia de seguridad inmediatamente antes del cambio.</span><span class="sxs-lookup"><span data-stu-id="06b42-318">When you update the database, you should make a backup copy from immediately before the change.</span></span> <span data-ttu-id="06b42-319">Después, si comete un error y no lo detecta hasta después de implementarlo en producción, podrá recuperar la base de datos al estado en que se encontraba antes de que se dañara.</span><span class="sxs-lookup"><span data-stu-id="06b42-319">Then, if you make a mistake and don't discover it until after you have deployed it to production, you will still be able to recover the database to the state it was in before it became corrupted.</span></span> <span data-ttu-id="06b42-320">Para obtener más información, vea [Azure SQL Database copias de seguridad y restauración](https://msdn.microsoft.com/library/windowsazure/jj650016.aspx).</span><span class="sxs-lookup"><span data-stu-id="06b42-320">For more information, see [Azure SQL Database Backup and Restore](https://msdn.microsoft.com/library/windowsazure/jj650016.aspx).</span></span>
> 
> 
> [!NOTE]
> <span data-ttu-id="06b42-321">En este tutorial, se Azure SQL Database la edición de SQL Server que está implementando.</span><span class="sxs-lookup"><span data-stu-id="06b42-321">In this tutorial the SQL Server edition that you are deploying to is Azure SQL Database.</span></span> <span data-ttu-id="06b42-322">Aunque el proceso de implementación es similar a otras ediciones de SQL Server, una aplicación de producción real podría requerir código especial para Azure SQL Database en algunos escenarios.</span><span class="sxs-lookup"><span data-stu-id="06b42-322">While the deployment process is similar to other editions of SQL Server, a real production application might require special code for Azure SQL Database in some scenarios.</span></span> <span data-ttu-id="06b42-323">Para obtener más información, vea [trabajar con Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdb) y [elegir entre SQL Server y Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdbchoosing).</span><span class="sxs-lookup"><span data-stu-id="06b42-323">For more information, see [Working with Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdb) and [Choosing between SQL Server and Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdbchoosing).</span></span>
> 
> [!div class="step-by-step"]
> <span data-ttu-id="06b42-324">[Anterior](setting-folder-permissions.md)
> [Siguiente](deploying-a-code-update.md)</span><span class="sxs-lookup"><span data-stu-id="06b42-324">[Previous](setting-folder-permissions.md)
[Next](deploying-a-code-update.md)</span></span>

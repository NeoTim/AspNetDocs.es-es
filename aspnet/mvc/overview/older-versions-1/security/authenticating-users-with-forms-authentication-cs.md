---
uid: mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-cs
title: Autenticar a los usuarios con formularios de autenticación (C#) | Microsoft Docs
author: microsoft
description: Obtenga información sobre cómo usar el atributo [Authorize] a contraseña proteger determinadas páginas en la aplicación MVC. Aprenda a usar el sitio Web de administración demasiado...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 239fd3ca-5630-4b8d-bc4b-2f906b1d3504
msc.legacyurl: /mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-cs
msc.type: authoredcontent
ms.openlocfilehash: bed2eafa47fec25ac04cb07e0037f596494bb7d9
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2019
ms.locfileid: "65128189"
---
# <a name="authenticating-users-with-forms-authentication-c"></a><span data-ttu-id="5fd1f-104">Autenticar a los usuarios con la autenticación de formularios (C#)</span><span class="sxs-lookup"><span data-stu-id="5fd1f-104">Authenticating Users with Forms Authentication (C#)</span></span>

<span data-ttu-id="5fd1f-105">por [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="5fd1f-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="5fd1f-106">Obtenga información sobre cómo usar el atributo [Authorize] a contraseña proteger determinadas páginas en la aplicación MVC.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-106">Learn how to use the [Authorize] attribute to password protect particular pages in your MVC application.</span></span> <span data-ttu-id="5fd1f-107">Aprenda a usar la herramienta de administración de sitios Web para crear y administrar usuarios y roles.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-107">You learn how to use the Web Site Administration Tool to create and manage users and roles.</span></span> <span data-ttu-id="5fd1f-108">También aprenderá a configurar dónde se almacena la información de cuenta y el rol de usuario.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-108">You also learn how to configure where user account and role information is stored.</span></span>

<span data-ttu-id="5fd1f-109">El objetivo de este tutorial es explicar cómo puede usar formularios de autenticación de contraseña de proteger las vistas en las aplicaciones de ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-109">The goal of this tutorial is to explain how you can use Forms authentication to password protect the views in your ASP.NET MVC applications.</span></span> <span data-ttu-id="5fd1f-110">Aprenda a usar la herramienta de administración de sitios Web para crear usuarios y roles.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-110">You learn how to use the Web Site Administration Tool to create users and roles.</span></span> <span data-ttu-id="5fd1f-111">También aprenderá cómo impedir que los usuarios no autorizados de invocar acciones de controlador.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-111">You also learn how to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="5fd1f-112">Por último, aprenderá a configurar dónde se almacenan los nombres de usuario y contraseñas.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-112">Finally, you learn how to configure where user names and passwords are stored.</span></span>

#### <a name="using-the-web-site-administration-tool"></a><span data-ttu-id="5fd1f-113">Con la herramienta de administración del sitio Web</span><span class="sxs-lookup"><span data-stu-id="5fd1f-113">Using the Web Site Administration Tool</span></span>

<span data-ttu-id="5fd1f-114">Antes de hacer nada más, debemos empezar vamos a crear algunos usuarios y roles.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-114">Before we do anything else, we should start by creating some users and roles.</span></span> <span data-ttu-id="5fd1f-115">La manera más fácil de crear nuevos usuarios y roles es aprovechar las ventajas de la herramienta de administración de sitios Web de Visual Studio 2008.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-115">The easiest way to create new users and roles is to take advantage of the Visual Studio 2008 Web Site Administration Tool.</span></span> <span data-ttu-id="5fd1f-116">Puede iniciar esta herramienta seleccionando la opción de menú **proyecto, la configuración de ASP.NET**.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-116">You can launch this tool by selecting the menu option **Project, ASP.NET Configuration**.</span></span> <span data-ttu-id="5fd1f-117">Como alternativa, puede iniciar la herramienta de administración de sitios Web, haga clic en el icono del martillo alcanzando el mundo que aparece en la parte superior de la ventana del explorador de soluciones (un poco de miedo) (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-117">Alternatively, you can launch the Web Site Administration Tool by clicking the (somewhat scary) icon of the hammer hitting the world that appears at the top of the Solution Explorer window (see Figure 1).</span></span>

<span data-ttu-id="5fd1f-118">**Ilustración 1: iniciar la herramienta de administración de sitios Web**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-118">**Figure 1 – Launching the Web Site Administration Tool**</span></span>

![clip_image002](authenticating-users-with-forms-authentication-cs/_static/image1.jpg)

<span data-ttu-id="5fd1f-120">Dentro de la herramienta de administración de sitios Web, crear nuevos usuarios y roles, seleccione la pestaña seguridad. Haga clic en el **crear usuario** vínculo para crear un nuevo usuario denominado Stephen (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-120">Within the Web Site Administration Tool, you create new users and roles by selecting the Security tab. Click the **Create user** link to create a new user named Stephen (see Figure 2).</span></span> <span data-ttu-id="5fd1f-121">Proporcione al usuario Stephen cualquier contraseña que desee (por ejemplo, *secreto*).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-121">Provide the Stephen user with any password that you want (for example, *secret*).</span></span>

<span data-ttu-id="5fd1f-122">**Ilustración 2: crear un nuevo usuario**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-122">**Figure 2 – Creating a new user**</span></span>

![clip_image004](authenticating-users-with-forms-authentication-cs/_static/image2.jpg)

<span data-ttu-id="5fd1f-124">Crear nuevos roles de habilitación de funciones y definir uno o varios roles.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-124">You create new roles by first enabling roles and defining one or more roles.</span></span> <span data-ttu-id="5fd1f-125">Habilitar los roles haciendo clic en el **habilitar roles** vínculo.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-125">Enable roles by clicking the **Enable roles** link.</span></span> <span data-ttu-id="5fd1f-126">A continuación, cree un rol denominado *administradores* haciendo clic en el **crear o administrar roles** vincular (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-126">Next, create a role named *Administrators* by clicking the **Create or Manage roles** link (see Figure 3).</span></span>

<span data-ttu-id="5fd1f-127">**Ilustración 3: crear un nuevo rol**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-127">**Figure 3 – Creating a new role**</span></span>

![clip_image006](authenticating-users-with-forms-authentication-cs/_static/image3.jpg)

<span data-ttu-id="5fd1f-129">Por último, cree un nuevo usuario denominado Sally y asociar Sally con la función administradores haciendo clic en el vínculo Create User y seleccionar los administradores al crear Sally (consulte la figura 4).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-129">Finally, create a new user named Sally and associate Sally with the Administrators role by clicking the Create User link and selecting Administrators when creating Sally (see Figure 4).</span></span>

<span data-ttu-id="5fd1f-130">**Figura 4: agregar un usuario a un rol**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-130">**Figure 4 – Adding a user to a role**</span></span>

![clip_image008](authenticating-users-with-forms-authentication-cs/_static/image4.jpg)

<span data-ttu-id="5fd1f-132">Cuando todo está listo, debe tener dos nuevos usuarios denominados Stephen y Sally.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-132">When all is said and done, you should have two new users named Stephen and Sally.</span></span> <span data-ttu-id="5fd1f-133">También debe tener un nuevo rol denominado Administradores.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-133">You should also have a new role named Administrators.</span></span> <span data-ttu-id="5fd1f-134">Sally es un miembro del rol de administradores y Stephen no es.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-134">Sally is a member of the Administrators role and Stephen is not.</span></span>

#### <a name="requiring-authorization"></a><span data-ttu-id="5fd1f-135">Requerir autorización</span><span class="sxs-lookup"><span data-stu-id="5fd1f-135">Requiring Authorization</span></span>

<span data-ttu-id="5fd1f-136">Puede requerir un usuario se autentique antes de que el usuario invoque una acción de controlador agregando el atributo [Authorize] a la acción.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-136">You can require a user to be authenticated before the user invokes a controller action by adding the [Authorize] attribute to the action.</span></span> <span data-ttu-id="5fd1f-137">Puede aplicar el atributo [Authorize] a una acción de controlador individuales o puede aplicar este atributo a una clase de controlador completo.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-137">You can apply the [Authorize] attribute to an individual controller action or you can apply this attribute to an entire controller class.</span></span>

<span data-ttu-id="5fd1f-138">Por ejemplo, el controlador en el listado 1 expone una acción denominada CompanySecrets().</span><span class="sxs-lookup"><span data-stu-id="5fd1f-138">For example, the controller in Listing 1 exposes an action named CompanySecrets().</span></span> <span data-ttu-id="5fd1f-139">Dado que esta acción se decora con el atributo [Authorize], esta acción no se puede invocar a menos que un usuario está autenticado.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-139">Because this action is decorated with the [Authorize] attribute, this action cannot be invoked unless a user is authenticated.</span></span>

<span data-ttu-id="5fd1f-140">**Listing 1 – Controllers\HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-140">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](authenticating-users-with-forms-authentication-cs/samples/sample1.cs)]

<span data-ttu-id="5fd1f-141">Si invocar la acción CompanySecrets() escribiendo el CompanySecrets / / Home de dirección URL en la barra de direcciones del explorador y no es un usuario autenticado, entonces se le redirigirá a la vista de inicio de sesión automáticamente (consulte la figura 5).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-141">If you invoke the CompanySecrets() action by entering the URL /Home/CompanySecrets in the address bar of your browser, and you are not an authenticated user, then you will be redirected to the Login view automatically (see Figure 5).</span></span>

<span data-ttu-id="5fd1f-142">**Figura 5: la vista de inicio de sesión**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-142">**Figure 5 – The Login view**</span></span>

![clip_image010](authenticating-users-with-forms-authentication-cs/_static/image5.jpg)

<span data-ttu-id="5fd1f-144">Puede usar la vista de inicio de sesión que escriba su nombre de usuario y contraseña.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-144">You can use the Login view to enter your user name and password.</span></span> <span data-ttu-id="5fd1f-145">Si no es un usuario registrado, puede hacer clic en el **registrar** vínculo para navegar al registro ver (consulte la figura 6).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-145">If you are not a registered user then you can click the **register** link to navigate to the Register view (see Figure 6).</span></span> <span data-ttu-id="5fd1f-146">Puede usar la vista Register para crear una nueva cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-146">You can use the Register view to create a new user account.</span></span>

<span data-ttu-id="5fd1f-147">**Figura 6: la vista Register**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-147">**Figure 6 – The Register view**</span></span>

![clip_image012](authenticating-users-with-forms-authentication-cs/_static/image6.jpg)

<span data-ttu-id="5fd1f-149">Una vez que inicie sesión correctamente, puede ver el CompanySecrets ver (consulte la figura 7).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-149">After you successfully log in, you can see the CompanySecrets view (see Figure 7).</span></span> <span data-ttu-id="5fd1f-150">De forma predeterminada, aún iniciar sesión hasta que cierre la ventana del explorador.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-150">By default, you will continue to be logged in until you close your browser window.</span></span>

<span data-ttu-id="5fd1f-151">**Figura 7: la vista CompanySecrets**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-151">**Figure 7 – The CompanySecrets view**</span></span>

![clip_image014](authenticating-users-with-forms-authentication-cs/_static/image7.jpg)

#### <a name="authorizing-by-user-name-or-user-role"></a><span data-ttu-id="5fd1f-153">Autorizar por nombre de usuario o rol de usuario</span><span class="sxs-lookup"><span data-stu-id="5fd1f-153">Authorizing by User Name or User Role</span></span>

<span data-ttu-id="5fd1f-154">Puede usar el atributo [Authorize] a restringir el acceso a una acción de controlador a un conjunto determinado de usuarios o un conjunto determinado de roles de usuario.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-154">You can use the [Authorize] attribute to restrict access to a controller action to a particular set of users or a particular set of user roles.</span></span> <span data-ttu-id="5fd1f-155">Por ejemplo, el controlador Home modificado en el listado 2 contiene dos nuevas acciones denominadas StephenSecrets() y AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="5fd1f-155">For example, the modified Home controller in Listing 2 contains two new actions named StephenSecrets() and AdministratorSecrets().</span></span>

<span data-ttu-id="5fd1f-156">**Listing 2 – Controllers\HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-156">**Listing 2 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](authenticating-users-with-forms-authentication-cs/samples/sample2.cs)]

<span data-ttu-id="5fd1f-157">Solo un usuario con el nombre de usuario Stephen puede invocar la acción StephenSecrets().</span><span class="sxs-lookup"><span data-stu-id="5fd1f-157">Only a user with the user name Stephen can invoke the StephenSecrets() action.</span></span> <span data-ttu-id="5fd1f-158">Todos los demás usuarios accedas a la vista de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-158">All other users get redirected to the Login view.</span></span> <span data-ttu-id="5fd1f-159">La propiedad de los usuarios acepta una lista separada por comas de nombres de cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-159">The Users property accepts a comma separated list of user account names.</span></span>

<span data-ttu-id="5fd1f-160">Solo los usuarios del rol administradores pueden invocar la acción AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="5fd1f-160">Only users in the Administrators role can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="5fd1f-161">Por ejemplo, dado que Sally es un miembro del grupo Administradores, puede invocar la acción de AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="5fd1f-161">For example, because Sally is a member of the Administrators group, she can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="5fd1f-162">Todos los demás usuarios accedas a la vista de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-162">All other users get redirected to the Login view.</span></span> <span data-ttu-id="5fd1f-163">La propiedad Roles acepta una lista separada por comas de nombres de función.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-163">The Roles property accepts a comma separated list of role names.</span></span>

#### <a name="configuring-authentication"></a><span data-ttu-id="5fd1f-164">Configurar la autenticación</span><span class="sxs-lookup"><span data-stu-id="5fd1f-164">Configuring Authentication</span></span>

<span data-ttu-id="5fd1f-165">En este momento, tal vez se pregunte dónde se almacenan la información de cuenta y el rol de usuario.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-165">At this point, you might be wondering where the user account and role information is being stored.</span></span> <span data-ttu-id="5fd1f-166">De forma predeterminada, la información se almacena en una base de datos (RANU) de SQL Express ASPNETDB.mdf con nombre se encuentra en la aplicación de la aplicación MVC\_carpeta de datos.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-166">By default, the information is stored in a (RANU) SQL Express database named ASPNETDB.mdf located in your MVC application's App\_Data folder.</span></span> <span data-ttu-id="5fd1f-167">Esta base de datos se genera automáticamente el marco de ASP.NET cuando se inicia mediante la suscripción.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-167">This database is generated by the ASP.NET framework automatically when you start using membership.</span></span>

<span data-ttu-id="5fd1f-168">Para ver la base de datos ASPNETDB.mdf en la ventana Explorador de soluciones, primero deberá seleccionar la opción de menú proyecto, mostrar todos los archivos.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-168">In order to see the ASPNETDB.mdf database in the Solution Explorer window, you first need to select the menu option Project, Show All Files.</span></span>

<span data-ttu-id="5fd1f-169">Uso de la base de datos de SQL Express de forma predeterminada está bien, al desarrollar una aplicación.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-169">Using the default SQL Express database is fine when developing an application.</span></span> <span data-ttu-id="5fd1f-170">Probablemente, sin embargo, no desea utilizar la base de datos ASPNETDB.mdf para una aplicación de producción.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-170">Most likely, however, you won't want to use the default ASPNETDB.mdf database for a production application.</span></span> <span data-ttu-id="5fd1f-171">En ese caso, puede cambiar de donde se almacena la información de la cuenta de usuario siguiendo los dos pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="5fd1f-171">In that case, you can change where user account information is stored by completing the following two steps:</span></span>

1. <span data-ttu-id="5fd1f-172">Agregar los objetos de base de datos de servicios de aplicación a la base de datos de producción: cambiar la cadena de conexión de la aplicación para que apunte a la base de datos de producción</span><span class="sxs-lookup"><span data-stu-id="5fd1f-172">Add the Application Services database objects to your production database - Change your application connection string to point to your production database</span></span>

<span data-ttu-id="5fd1f-173">El primer paso es agregar todos los objetos de base de datos necesarios (tablas y procedimientos almacenados) a la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-173">The first step is to add all of the necessary database objects (tables and stored procedures) to your production database.</span></span> <span data-ttu-id="5fd1f-174">Es la manera más fácil de agregar estos objetos a una base de datos aprovechar las ventajas del Asistente para la instalación de ASP.NET SQL Server (consulte la figura 8).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-174">The easiest way to add these objects to a new database is to take advantage of the ASP.NET SQL Server Setup Wizard (see Figure 8).</span></span> <span data-ttu-id="5fd1f-175">Puede iniciar esta herramienta, abra el símbolo del sistema de Visual Studio 2008 desde el grupo de programas de Microsoft Visual Studio 2008 y ejecutando el siguiente comando desde el símbolo del sistema:</span><span class="sxs-lookup"><span data-stu-id="5fd1f-175">You can launch this tool by opening the Visual Studio 2008 Command Prompt from the Microsoft Visual Studio 2008 program group and executing the following command from the command prompt:</span></span>

<span data-ttu-id="5fd1f-176">aspnet\_regsql</span><span class="sxs-lookup"><span data-stu-id="5fd1f-176">aspnet\_regsql</span></span>

<span data-ttu-id="5fd1f-177">**Figura 8: el Asistente para la instalación del servidor de SQL de ASP.NET**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-177">**Figure 8 – The ASP.NET SQL Server Setup Wizard**</span></span>

![clip_image016](authenticating-users-with-forms-authentication-cs/_static/image8.jpg)

<span data-ttu-id="5fd1f-179">El Asistente para instalación de servidor SQL de ASP.NET le permite seleccionar una base de datos de SQL Server en la red e instalar todos los objetos de base de datos necesarios para los servicios de aplicación de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-179">The ASP.NET SQL Server Setup Wizard enables you to select a SQL Server database on your network and install all of the database objects required by the ASP.NET application services.</span></span> <span data-ttu-id="5fd1f-180">El servidor de base de datos no es necesario estar ubicado en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-180">The database server is not required to be located on your local machine.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="5fd1f-181">Si no desea usar al Asistente para la instalación de ASP.NET SQL Server, puede encontrar scripts SQL para agregar los objetos de base de datos de servicios de aplicaciones en la siguiente carpeta:</span><span class="sxs-lookup"><span data-stu-id="5fd1f-181">If you don't want to use the ASP.NET SQL Server Setup Wizard, then you can find SQL scripts for adding the application services database objects in the following folder:</span></span>
> 
> > <span data-ttu-id="5fd1f-182">C:\Windows\Microsoft.NET\Framework\v2.0.50727</span><span class="sxs-lookup"><span data-stu-id="5fd1f-182">C:\Windows\Microsoft.NET\Framework\v2.0.50727</span></span>

<span data-ttu-id="5fd1f-183">Después de crear los objetos de base de datos necesarios, deberá modificar la conexión de base de datos utilizada por la aplicación de MVC.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-183">After you create the necessary database objects, you need to modify the database connection used by your MVC application.</span></span> <span data-ttu-id="5fd1f-184">Modifique la cadena de conexión de ApplicationServices en el archivo de configuración (web.config) web para que apunte a la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-184">Modify the ApplicationServices connection string in your web configuration (web.config) file so that it points to the production database.</span></span> <span data-ttu-id="5fd1f-185">Por ejemplo, la conexión modificada en el listado 3 apunta a una base de datos denominada MyProductionDB (la cadena de conexión de ApplicationServices original se ha comentado con).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-185">For example, the modified connection in Listing 3 points to a database named MyProductionDB (the original ApplicationServices connection string has been commented out).</span></span>

<span data-ttu-id="5fd1f-186">**Listado 3 – Web.config**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-186">**Listing 3 – Web.config**</span></span>

[!code-xml[Main](authenticating-users-with-forms-authentication-cs/samples/sample3.xml)]

#### <a name="configuring-database-permissions"></a><span data-ttu-id="5fd1f-187">Configuración de permisos de base de datos</span><span class="sxs-lookup"><span data-stu-id="5fd1f-187">Configuring Database Permissions</span></span>

<span data-ttu-id="5fd1f-188">Si usa seguridad integrada para conectarse a la base de datos, a continuación, deberá agregar la cuenta de usuario de Windows correcta como un inicio de sesión a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-188">If you use Integrated Security to connect to your database then you will need to add the correct Windows user account as a login to your database.</span></span> <span data-ttu-id="5fd1f-189">La cuenta correcta depende de si usas el servidor de desarrollo de ASP.NET o Internet Information Services como servidor web.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-189">The correct account depends on whether you are using the ASP.NET Development Server or Internet Information Services as your web server.</span></span> <span data-ttu-id="5fd1f-190">También depende de la cuenta de usuario correctos en el sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-190">The correct user account also depends on your operating system.</span></span>

<span data-ttu-id="5fd1f-191">Si usa el servidor de desarrollo de ASP.NET (el servidor de web predeterminado utilizado por Visual Studio), a continuación, la aplicación se ejecuta dentro del contexto de su cuenta de usuario de Windows.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-191">If you are using the ASP.NET Development Server (the default web server used by Visual Studio) then your application executes within the context of your Windows user account.</span></span> <span data-ttu-id="5fd1f-192">En ese caso, deberá agregar su cuenta de usuario de Windows como un inicio de sesión del servidor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-192">In that case, you need to add your Windows user account as a database server login.</span></span>

<span data-ttu-id="5fd1f-193">Como alternativa, si está utilizando Internet Information Services, a continuación, deberá agregar la cuenta ASPNET o la cuenta NT AUTHORITY o NETWORK SERVICE como un inicio de sesión del servidor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-193">Alternatively, if you are using Internet Information Services then you need to add either the ASPNET account or the NT AUTHORITY/NETWORK SERVICE account as a database server login.</span></span> <span data-ttu-id="5fd1f-194">Si está utilizando Windows XP, a continuación, agregue la cuenta ASPNET como inicio de sesión a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-194">If you are using Windows XP then add the ASPNET account as a login to your database.</span></span> <span data-ttu-id="5fd1f-195">Si usa un sistema operativo más reciente, como Windows Vista o Windows Server 2008, a continuación, agregue la cuenta NT AUTHORITY o NETWORK SERVICE como el inicio de sesión de base de datos.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-195">If you are using a more recent operating system, such as Windows Vista or Windows Server 2008, then add the NT AUTHORITY/NETWORK SERVICE account as the database login.</span></span>

<span data-ttu-id="5fd1f-196">Puede agregar una nueva cuenta de usuario a la base de datos mediante el uso de Microsoft SQL Server Management Studio (consulte la figura 9).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-196">You can add a new user account to your database by using Microsoft SQL Server Management Studio (see Figure 9).</span></span>

<span data-ttu-id="5fd1f-197">**Figura 9: crear un nuevo inicio de sesión de Microsoft SQL Server**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-197">**Figure 9 – Creating a new Microsoft SQL Server login**</span></span>

![clip_image018](authenticating-users-with-forms-authentication-cs/_static/image9.jpg)

<span data-ttu-id="5fd1f-199">Después de crear el inicio de sesión necesario, deberá asignar el inicio de sesión a un usuario de base de datos con los roles de base de datos correcta.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-199">After you create the required login, you need to map the login to a database user with the right database roles.</span></span> <span data-ttu-id="5fd1f-200">Haga doble clic en el inicio de sesión y seleccione la pestaña asignación de usuario. Seleccione uno o varios roles de base de datos de servicios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-200">Double-click the login and select the User Mapping tab. Select one or more application services database roles.</span></span> <span data-ttu-id="5fd1f-201">Por ejemplo, con el fin de autenticar a los usuarios, deberá habilitar aspnet\_pertenencia\_BasicAccess rol de base de datos.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-201">For example, in order to authenticate users, you need to enable the aspnet\_Membership\_BasicAccess database role.</span></span> <span data-ttu-id="5fd1f-202">Para crear nuevos usuarios, deberá habilitar aspnet\_pertenencia\_FullAccess rol de base de datos (consulte la figura 10).</span><span class="sxs-lookup"><span data-stu-id="5fd1f-202">In order to create new users, you need to enable the aspnet\_Membership\_FullAccess database role (see Figure 10).</span></span>

<span data-ttu-id="5fd1f-203">**Ilustración 10: agregar roles de base de datos de servicios de aplicación**</span><span class="sxs-lookup"><span data-stu-id="5fd1f-203">**Figure 10 – Adding Application Services database roles**</span></span>

![clip_image020](authenticating-users-with-forms-authentication-cs/_static/image10.jpg)

#### <a name="summary"></a><span data-ttu-id="5fd1f-205">Resumen</span><span class="sxs-lookup"><span data-stu-id="5fd1f-205">Summary</span></span>

<span data-ttu-id="5fd1f-206">En este tutorial, aprendió a usar autenticación de formularios al compilar una aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-206">In this tutorial, you learned how to use Forms authentication when building an ASP.NET MVC application.</span></span> <span data-ttu-id="5fd1f-207">En primer lugar, ha aprendido a crear nuevos usuarios y roles aprovechando las ventajas de la herramienta de administración de sitios Web.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-207">First, you learned how to create new users and roles by taking advantage of the Web Site Administration Tool.</span></span> <span data-ttu-id="5fd1f-208">A continuación, ha aprendido a usar el atributo [Authorize] para impedir que los usuarios no autorizados invocar acciones de controlador.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-208">Next, you learned how to use the [Authorize] attribute to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="5fd1f-209">Por último, ha aprendido a configurar la aplicación de MVC para almacenar información de usuario y rol en una base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="5fd1f-209">Finally, you learned how to configure your MVC application to store user and role information in a production database.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="5fd1f-210">Siguiente</span><span class="sxs-lookup"><span data-stu-id="5fd1f-210">Next</span></span>](authenticating-users-with-windows-authentication-cs.md)

---
uid: web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
title: Actualización (VB) por lotes | Microsoft Docs
author: rick-anderson
description: Obtenga información sobre cómo actualizar varios registros de base de datos en una sola operación. En la capa de interfaz de usuario, creamos un GridView donde cada fila es editable. En los datos...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: d191a204-d7ea-458d-b81c-0b9049ecb55f
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-updating-vb
msc.type: authoredcontent
ms.openlocfilehash: 94e432815d5c597f7e98a0059e2b1cf9add2953b
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2019
ms.locfileid: "65134651"
---
# <a name="batch-updating-vb"></a><span data-ttu-id="00b3d-105">Actualización por lotes (VB)</span><span class="sxs-lookup"><span data-stu-id="00b3d-105">Batch Updating (VB)</span></span>

<span data-ttu-id="00b3d-106">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="00b3d-106">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="00b3d-107">[Descargar código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) o [descargar PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="00b3d-107">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_64_VB.zip) or [Download PDF](batch-updating-vb/_static/datatutorial64vb1.pdf)</span></span>

> <span data-ttu-id="00b3d-108">Obtenga información sobre cómo actualizar varios registros de base de datos en una sola operación.</span><span class="sxs-lookup"><span data-stu-id="00b3d-108">Learn how to update multiple database records in a single operation.</span></span> <span data-ttu-id="00b3d-109">En la capa de interfaz de usuario, creamos un GridView donde cada fila es editable.</span><span class="sxs-lookup"><span data-stu-id="00b3d-109">In the User Interface Layer we build a GridView where each row is editable.</span></span> <span data-ttu-id="00b3d-110">En la capa de acceso a datos se encapsulan las varias operaciones de actualización dentro de una transacción para garantizar que todas las actualizaciones se realizan correctamente o se revierten todas las actualizaciones.</span><span class="sxs-lookup"><span data-stu-id="00b3d-110">In the Data Access Layer we wrap the multiple Update operations within a transaction to ensure that all updates succeed or all updates are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="00b3d-111">Introducción</span><span class="sxs-lookup"><span data-stu-id="00b3d-111">Introduction</span></span>

<span data-ttu-id="00b3d-112">En el [tutorial anterior](wrapping-database-modifications-within-a-transaction-vb.md) vimos cómo ampliar la capa de acceso a datos para agregar compatibilidad con transacciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-112">In the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md) we saw how to extend the Data Access Layer to add support for database transactions.</span></span> <span data-ttu-id="00b3d-113">Las transacciones de base de datos garantizan que una serie de instrucciones de modificación de datos se tratará como una operación atómica, lo que garantiza que todas las modificaciones se producirá un error o todos se realizará correctamente.</span><span class="sxs-lookup"><span data-stu-id="00b3d-113">Database transactions guarantee that a series of data modification statements will be treated as one atomic operation, which ensures that all modifications will fail or all will succeed.</span></span> <span data-ttu-id="00b3d-114">Con esta funcionalidad bajo nivel DAL fuera de la vista, estamos re preparados para prestar atención a la creación de interfaces de modificación de datos de batch.</span><span class="sxs-lookup"><span data-stu-id="00b3d-114">With this low-level DAL functionality out of the way, we re ready to turn our attention to creating batch data modification interfaces.</span></span>

<span data-ttu-id="00b3d-115">En este tutorial crearemos un GridView donde cada fila es editable (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="00b3d-115">In this tutorial we'll build a GridView where each row is editable (see Figure 1).</span></span> <span data-ttu-id="00b3d-116">Puesto que cada fila no se representa en la interfaz de edición, allí s necesidad de una columna de edición, actualizar y cancelar los botones.</span><span class="sxs-lookup"><span data-stu-id="00b3d-116">Since each row is rendered in its editing interface, there s no need for a column of Edit, Update, and Cancel buttons.</span></span> <span data-ttu-id="00b3d-117">En su lugar, hay dos botones Actualizar productos en la página que, al hacer clic, enumerar las filas con GridView y actualizar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-117">Instead, there are two Update Products buttons on the page that, when clicked, enumerate the GridView rows and update the database.</span></span>

<span data-ttu-id="00b3d-118">[![Cada fila en el control GridView es modificable](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-118">[![Each Row in the GridView is Editable](batch-updating-vb/_static/image1.gif)](batch-updating-vb/_static/image1.png)</span></span>

<span data-ttu-id="00b3d-119">**Figura 1**: Cada fila en el control GridView es Editable ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-119">**Figure 1**: Each Row in the GridView is Editable ([Click to view full-size image](batch-updating-vb/_static/image2.png))</span></span>

<span data-ttu-id="00b3d-120">Introducción s Let!</span><span class="sxs-lookup"><span data-stu-id="00b3d-120">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="00b3d-121">En el [realizar actualizaciones por lotes](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial, creamos una edición por lotes de la interfaz mediante el control DataList.</span><span class="sxs-lookup"><span data-stu-id="00b3d-121">In the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we created a batch editing interface using the DataList control.</span></span> <span data-ttu-id="00b3d-122">Este tutorial difiere el anterior en el que está usa un control GridView y la actualización por lotes se realiza dentro del ámbito de una transacción.</span><span class="sxs-lookup"><span data-stu-id="00b3d-122">This tutorial differs from the previous one in that is uses a GridView and the batch update is performed within the scope of a transaction.</span></span> <span data-ttu-id="00b3d-123">Después de completar este tutorial le sugiero que vuelva al tutorial anterior y actualícelo para utilizar la funcionalidad relacionada con la transacción de base de datos agregada en el tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="00b3d-123">After completing this tutorial I encourage you to return to the earlier tutorial and update it to use the database transaction-related functionality added in the preceding tutorial.</span></span>

## <a name="examining-the-steps-for-making-all-gridview-rows-editable"></a><span data-ttu-id="00b3d-124">Examen de los pasos para realizar todas las filas del control GridView Editable</span><span class="sxs-lookup"><span data-stu-id="00b3d-124">Examining the Steps for Making All GridView Rows Editable</span></span>

<span data-ttu-id="00b3d-125">Como se describe en el [una visión general de insertar, actualizar y eliminar datos](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, el control GridView ofrece compatibilidad integrada para editar sus datos subyacentes por fila.</span><span class="sxs-lookup"><span data-stu-id="00b3d-125">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView offers built-in support for editing its underlying data on a per-row basis.</span></span> <span data-ttu-id="00b3d-126">Internamente, el control GridView notas qué fila es editable a través de su [ `EditIndex` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="00b3d-126">Internally, the GridView notes what row is editable through its [`EditIndex` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.editindex(VS.80).aspx).</span></span> <span data-ttu-id="00b3d-127">Como el control GridView se está enlazando a su origen de datos, comprueba cada fila para ver si el índice de la fila es igual al valor de `EditIndex`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-127">As the GridView is being bound to its data source, it checks each row to see if the index of the row equals the value of `EditIndex`.</span></span> <span data-ttu-id="00b3d-128">Si es así, las interfaces de esa fila s campos se representan mediante su edición.</span><span class="sxs-lookup"><span data-stu-id="00b3d-128">If so, that row s fields are rendered using their editing interfaces.</span></span> <span data-ttu-id="00b3d-129">Para BoundFields, la interfaz de edición es un cuadro de texto cuyo `Text` propiedad se asigna el valor del campo de datos especificado por la s BoundField `DataField` propiedad.</span><span class="sxs-lookup"><span data-stu-id="00b3d-129">For BoundFields, the editing interface is a TextBox whose `Text` property is assigned the value of the data field specified by the BoundField s `DataField` property.</span></span> <span data-ttu-id="00b3d-130">Para TemplateFields, el `EditItemTemplate` se utiliza en lugar de la `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-130">For TemplateFields, the `EditItemTemplate` is used in place of the `ItemTemplate`.</span></span>

<span data-ttu-id="00b3d-131">Recuerde que el flujo de trabajo de edición comienza cuando un usuario hace clic en un botón de edición de fila s.</span><span class="sxs-lookup"><span data-stu-id="00b3d-131">Recall that the editing workflow starts when a user clicks a row s Edit button.</span></span> <span data-ttu-id="00b3d-132">Esto produce un postback, Establece la s GridView `EditIndex` propiedad en el índice de fila donde ha hecho clic s y Reenlaces los datos a la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="00b3d-132">This causes a postback, sets the GridView s `EditIndex` property to the clicked row s index, and rebinds the data to the grid.</span></span> <span data-ttu-id="00b3d-133">Cuando se hace clic un botón de cancelación de la fila s, en el postback el `EditIndex` está establecido en un valor de `-1` antes de volver a enlazar los datos a la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="00b3d-133">When a row s Cancel button is clicked, on postback the `EditIndex` is set to a value of `-1` before rebinding the data to the grid.</span></span> <span data-ttu-id="00b3d-134">Puesto que las filas de GridView s inicia la indexación a cero, establecer `EditIndex` a `-1` tiene el efecto de mostrar el control GridView en modo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="00b3d-134">Since the GridView s rows start indexing at zero, setting `EditIndex` to `-1` has the effect of displaying the GridView in read-only mode.</span></span>

<span data-ttu-id="00b3d-135">El `EditIndex` propiedad funciona bien para cada fila de edición, pero no está diseñado para su edición por lotes.</span><span class="sxs-lookup"><span data-stu-id="00b3d-135">The `EditIndex` property works well for per-row editing, but is not designed for batch editing.</span></span> <span data-ttu-id="00b3d-136">Para hacer todo GridView editable, necesitamos que cada fila representar mediante su interfaz de edición.</span><span class="sxs-lookup"><span data-stu-id="00b3d-136">To make the entire GridView editable, we need to have each row render using its editing interface.</span></span> <span data-ttu-id="00b3d-137">La manera más fácil de hacerlo es crear donde cada campo editable se implementa como se define un TemplateField con su interfaz de edición en el `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-137">The easiest way to accomplish this is to create where each editable field is implemented as a TemplateField with its editing interface defined in the `ItemTemplate`.</span></span>

<span data-ttu-id="00b3d-138">En los próximos pasos varias vamos a crear un control GridView editable por completo.</span><span class="sxs-lookup"><span data-stu-id="00b3d-138">Over the next several steps we'll create a completely editable GridView.</span></span> <span data-ttu-id="00b3d-139">En el paso 1 Comenzaremos creando GridView y su origen ObjectDataSource y convertir sus BoundFields y CampoCasillaVerificación TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="00b3d-139">In Step 1 we'll start by creating the GridView and its ObjectDataSource and convert its BoundFields and CheckBoxField into TemplateFields.</span></span> <span data-ttu-id="00b3d-140">En los pasos 2 y 3 se moverá las interfaces de edición desde la TemplateFields `EditItemTemplate` s para sus `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="00b3d-140">In Steps 2 and 3 we'll move the editing interfaces from the TemplateFields `EditItemTemplate` s to their `ItemTemplate` s.</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="00b3d-141">Paso 1: Muestra información del producto</span><span class="sxs-lookup"><span data-stu-id="00b3d-141">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="00b3d-142">Antes de que preocuparse por crear un control GridView donde están las filas es editables, permiten s comience por mostrar simplemente la información del producto.</span><span class="sxs-lookup"><span data-stu-id="00b3d-142">Before we worry about creating a GridView where are rows are editable, let s start by simply displaying the product information.</span></span> <span data-ttu-id="00b3d-143">Abra el `BatchUpdate.aspx` página en el `BatchData` carpetas y arrastre un control GridView del cuadro de herramientas hasta el diseñador.</span><span class="sxs-lookup"><span data-stu-id="00b3d-143">Open the `BatchUpdate.aspx` page in the `BatchData` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="00b3d-144">Establezca la s GridView `ID` a `ProductsGrid` y, en su etiqueta inteligente, elija para enlazarla a un nuevo origen ObjectDataSource denominado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-144">Set the GridView s `ID` to `ProductsGrid` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="00b3d-145">Configurar el origen ObjectDataSource para recuperar sus datos desde el `ProductsBLL` clase s `GetProducts` método.</span><span class="sxs-lookup"><span data-stu-id="00b3d-145">Configure the ObjectDataSource to retrieve its data from the `ProductsBLL` class s `GetProducts` method.</span></span>

<span data-ttu-id="00b3d-146">[![Configurar el origen ObjectDataSource para usar la clase ProductsBLL](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-146">[![Configure the ObjectDataSource to Use the ProductsBLL Class](batch-updating-vb/_static/image2.gif)](batch-updating-vb/_static/image3.png)</span></span>

<span data-ttu-id="00b3d-147">**Figura 2**: Configurar el origen ObjectDataSource que se usarán el `ProductsBLL` clase ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-147">**Figure 2**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image4.png))</span></span>

<span data-ttu-id="00b3d-148">[![Recuperar los datos de producto mediante el método GetProducts](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-148">[![Retrieve the Product Data Using the GetProducts Method](batch-updating-vb/_static/image3.gif)](batch-updating-vb/_static/image5.png)</span></span>

<span data-ttu-id="00b3d-149">**Figura 3**: Recuperar los datos de producto mediante la `GetProducts` método ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-149">**Figure 3**: Retrieve the Product Data Using the `GetProducts` Method ([Click to view full-size image](batch-updating-vb/_static/image6.png))</span></span>

<span data-ttu-id="00b3d-150">Como GridView, las características de modificación de ObjectDataSource s están diseñadas para trabajar por fila.</span><span class="sxs-lookup"><span data-stu-id="00b3d-150">Like the GridView, the ObjectDataSource s modification features are designed to work on a per-row basis.</span></span> <span data-ttu-id="00b3d-151">Para actualizar un conjunto de registros, debemos escribir algo de código en la clase de código subyacente de s de la página ASP.NET que procesa por lotes los datos y lo pasa a la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="00b3d-151">In order to update a set of records, we'll need to write a bit of code in the ASP.NET page s code-behind class that batches the data and passes it to the BLL.</span></span> <span data-ttu-id="00b3d-152">Por consiguiente, establecer las listas desplegables en las operaciones de asignación ObjectDataSource pestañas UPDATE, INSERT y DELETE en (None).</span><span class="sxs-lookup"><span data-stu-id="00b3d-152">Therefore, set the drop-down lists in the ObjectDataSource s UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="00b3d-153">Haga clic en Finalizar para completar al asistente.</span><span class="sxs-lookup"><span data-stu-id="00b3d-153">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="00b3d-154">[![Establecer las listas desplegables en la actualización, INSERCIÓN y eliminar las fichas en (None)](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-154">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-updating-vb/_static/image4.gif)](batch-updating-vb/_static/image7.png)</span></span>

<span data-ttu-id="00b3d-155">**Figura 4**: Establecer la lista desplegable se enumeran en la actualización, INSERCIÓN y eliminar pestañas en (None) ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-155">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image8.png))</span></span>

<span data-ttu-id="00b3d-156">Después de completar al Asistente para configurar orígenes de datos, el marcado declarativo de ObjectDataSource s debería ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="00b3d-156">After completing the Configure Data Source wizard, the ObjectDataSource s declarative markup should look like the following:</span></span>

[!code-aspx[Main](batch-updating-vb/samples/sample1.aspx)]

<span data-ttu-id="00b3d-157">Completar al Asistente para configurar orígenes de datos también hace que Visual Studio crear BoundFields y un CampoCasillaVerificación para los campos de datos de producto en el control GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-157">Completing the Configure Data Source wizard also causes Visual Studio to create BoundFields and a CheckBoxField for the product data fields in the GridView.</span></span> <span data-ttu-id="00b3d-158">Para este tutorial, deje que s solo permite al usuario ver y editar el nombre del producto, categoría, precios y estado no incluida.</span><span class="sxs-lookup"><span data-stu-id="00b3d-158">For this tutorial, let s only allow the user to view and edit the product s name, category, price, and discontinued status.</span></span> <span data-ttu-id="00b3d-159">Quite todos menos a los `ProductName`, `CategoryName`, `UnitPrice`, y `Discontinued` campos y cambie el nombre el `HeaderText` las propiedades de los tres primeros campos de producto, categoría y el precio, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="00b3d-159">Remove all but the `ProductName`, `CategoryName`, `UnitPrice`, and `Discontinued` fields and rename the `HeaderText` properties of the first three fields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="00b3d-160">Por último, active las casillas de habilitar la paginación y habilitar la ordenación en la etiqueta inteligente de s GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-160">Lastly, check the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="00b3d-161">En este momento la GridView tiene tres BoundFields (`ProductName`, `CategoryName`, y `UnitPrice`) y un CampoCasillaVerificación (`Discontinued`).</span><span class="sxs-lookup"><span data-stu-id="00b3d-161">At this point the GridView has three BoundFields (`ProductName`, `CategoryName`, and `UnitPrice`) and a CheckBoxField (`Discontinued`).</span></span> <span data-ttu-id="00b3d-162">Necesitamos convertir estos cuatro campos en TemplateFields y, a continuación, mueva la interfaz de edición de s TemplateField `EditItemTemplate` a su `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-162">We need to convert these four fields into TemplateFields and then move the editing interface from the TemplateField s `EditItemTemplate` to its `ItemTemplate`.</span></span>

> [!NOTE]
> <span data-ttu-id="00b3d-163">Exploramos la creación y personalización de TemplateFields en el [personalizar la interfaz de modificación de datos](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="00b3d-163">We explored creating and customizing TemplateFields in the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span> <span data-ttu-id="00b3d-164">Le guiaremos a través de los pasos necesarios para convertir el BoundFields y CampoCasillaVerificación en TemplateFields y definir su edición de las interfaces en sus `ItemTemplate` s, pero si se bloquea o necesita un actualizador, don t dude para hacer referencia a este tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="00b3d-164">We'll walk through the steps of converting the BoundFields and CheckBoxField into TemplateFields and defining their editing interfaces in their `ItemTemplate` s, but if you get stuck or need a refresher, don t hesitate to refer back to this earlier tutorial.</span></span>

<span data-ttu-id="00b3d-165">En la etiqueta inteligente de GridView s, haga clic en el vínculo Edit Columns para abrir el cuadro de diálogo campos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-165">From the GridView s smart tag, click the Edit Columns link to open the Fields dialog box.</span></span> <span data-ttu-id="00b3d-166">A continuación, seleccione cada campo y haga clic en la función Convert este campo en un vínculo TemplateField.</span><span class="sxs-lookup"><span data-stu-id="00b3d-166">Next, select each field and click the Convert this field into a TemplateField link.</span></span>

![Convertir el BoundFields existente y CampoCasillaVerificación TemplateFields](batch-updating-vb/_static/image5.gif)

<span data-ttu-id="00b3d-168">**Figura 5**: Convertir el BoundFields existente y CampoCasillaVerificación TemplateFields</span><span class="sxs-lookup"><span data-stu-id="00b3d-168">**Figure 5**: Convert the Existing BoundFields and CheckBoxField Into TemplateFields</span></span>

<span data-ttu-id="00b3d-169">Ahora que cada campo está TemplateField, que está listo para mover la edición de la interfaz desde el `EditItemTemplate` s para el `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="00b3d-169">Now that each field is a TemplateField, we re ready to move the editing interface from the `EditItemTemplate` s to the `ItemTemplate` s.</span></span>

## <a name="step-2-creating-theproductnameunitprice-anddiscontinuedediting-interfaces"></a><span data-ttu-id="00b3d-170">Paso 2: Crear el`ProductName`,`UnitPrice`, y`Discontinued`Interfaces de edición</span><span class="sxs-lookup"><span data-stu-id="00b3d-170">Step 2: Creating the`ProductName`,`UnitPrice`, and`Discontinued`Editing Interfaces</span></span>

<span data-ttu-id="00b3d-171">Crear el `ProductName`, `UnitPrice`, y `Discontinued` interfaces de edición son el tema de este paso y son bastante sencillo, como cada interfaz ya está definida en la s TemplateField `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-171">Creating the `ProductName`, `UnitPrice`, and `Discontinued` editing interfaces are the topic of this step and are pretty straightforward, as each interface is already defined in the TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="00b3d-172">Creación de la `CategoryName` interfaz de edición es un poco más complicado, ya que es necesario crear un DropDownList de las categorías aplicables.</span><span class="sxs-lookup"><span data-stu-id="00b3d-172">Creating the `CategoryName` editing interface is a bit more involved since we need to create a DropDownList of the applicable categories.</span></span> <span data-ttu-id="00b3d-173">Esto `CategoryName` se aborda la interfaz de edición en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="00b3d-173">This `CategoryName` editing interface is tackled in Step 3.</span></span>

<span data-ttu-id="00b3d-174">Permiten s comenzar con la `ProductName` TemplateField.</span><span class="sxs-lookup"><span data-stu-id="00b3d-174">Let s start with the `ProductName` TemplateField.</span></span> <span data-ttu-id="00b3d-175">Haga clic en el vínculo Editar plantillas de la etiqueta inteligente de GridView s y profundice para el `ProductName` TemplateField s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-175">Click on the Edit Templates link from the GridView s smart tag and drill down to the `ProductName` TemplateField s `EditItemTemplate`.</span></span> <span data-ttu-id="00b3d-176">Seleccione el cuadro de texto, cópielo en el Portapapeles y, a continuación, péguelo en el `ProductName` TemplateField s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-176">Select the TextBox, copy it to the clipboard, and then paste it to the `ProductName` TemplateField s `ItemTemplate`.</span></span> <span data-ttu-id="00b3d-177">Cambiar la s de cuadro de texto `ID` propiedad `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-177">Change the TextBox s `ID` property to `ProductName`.</span></span>

<span data-ttu-id="00b3d-178">A continuación, agregue un control RequiredFieldValidator a la `ItemTemplate` para asegurarse de que el usuario proporcione un valor para cada nombre de producto s.</span><span class="sxs-lookup"><span data-stu-id="00b3d-178">Next, add a RequiredFieldValidator to the `ItemTemplate` to ensure that the user provides a value for each product s name.</span></span> <span data-ttu-id="00b3d-179">Establecer el `ControlToValidate` propiedad ProductName, el `ErrorMessage` la propiedad a la debe proporcionar el nombre del producto.</span><span class="sxs-lookup"><span data-stu-id="00b3d-179">Set the `ControlToValidate` property to ProductName, the `ErrorMessage` property to You must provide the product's name.</span></span> <span data-ttu-id="00b3d-180">y el `Text` propiedad \*.</span><span class="sxs-lookup"><span data-stu-id="00b3d-180">and the `Text` property to \*.</span></span> <span data-ttu-id="00b3d-181">Después de realizar estas adiciones a la `ItemTemplate`, la pantalla debe ser similar a la figura 6.</span><span class="sxs-lookup"><span data-stu-id="00b3d-181">After making these additions to the `ItemTemplate`, your screen should look similar to Figure 6.</span></span>

<span data-ttu-id="00b3d-182">[![ProductName TemplateField ahora incluye un cuadro de texto y un control RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-182">[![The ProductName TemplateField Now Includes a TextBox and a RequiredFieldValidator](batch-updating-vb/_static/image6.gif)](batch-updating-vb/_static/image9.png)</span></span>

<span data-ttu-id="00b3d-183">**Figura 6**: El `ProductName` TemplateField ahora incluye un cuadro de texto y un control RequiredFieldValidator ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-183">**Figure 6**: The `ProductName` TemplateField Now Includes a TextBox and a RequiredFieldValidator ([Click to view full-size image](batch-updating-vb/_static/image10.png))</span></span>

<span data-ttu-id="00b3d-184">Para el `UnitPrice` interfaz de edición, empiece por copiar en el cuadro de texto de la `EditItemTemplate` a la `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-184">For the `UnitPrice` editing interface, start by copying the TextBox from the `EditItemTemplate` to the `ItemTemplate`.</span></span> <span data-ttu-id="00b3d-185">A continuación, coloque un carácter $ delante el cuadro de texto y establezca su `ID` propiedad UnitPrice y su `Columns` propiedad a 8.</span><span class="sxs-lookup"><span data-stu-id="00b3d-185">Next, place a $ in front of the TextBox and set its `ID` property to UnitPrice and its `Columns` property to 8 .</span></span>

<span data-ttu-id="00b3d-186">Agregue también un CompareValidator para los `UnitPrice` s `ItemTemplate` para asegurarse de que el valor especificado por el usuario es un valor de moneda válido mayor que o igual a 0,00 USD.</span><span class="sxs-lookup"><span data-stu-id="00b3d-186">Also add a CompareValidator to the `UnitPrice` s `ItemTemplate` to ensure that the value entered by the user is a valid currency value greater than or equal to $0.00.</span></span> <span data-ttu-id="00b3d-187">Establece el validador s `ControlToValidate` propiedad UnitPrice, su `ErrorMessage` propiedad a la debe especificar un valor de moneda válidos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-187">Set the validator s `ControlToValidate` property to UnitPrice, its `ErrorMessage` property to You must enter a valid currency value.</span></span> <span data-ttu-id="00b3d-188">Por favor, omita cualquier moneda símbolos., su `Text` propiedad a \*, sus `Type` propiedad a `Currency`, sus `Operator` propiedad a `GreaterThanEqual`y su `ValueToCompare` propiedad en 0.</span><span class="sxs-lookup"><span data-stu-id="00b3d-188">Please omit any currency symbols., its `Text` property to \*, its `Type` property to `Currency`, its `Operator` property to `GreaterThanEqual`, and its `ValueToCompare` property to 0 .</span></span>

<span data-ttu-id="00b3d-189">[![Agregar un control CompareValidator para asegurarse de que el precio especificado es un valor de moneda no negativo](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-189">[![Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value](batch-updating-vb/_static/image7.gif)](batch-updating-vb/_static/image11.png)</span></span>

<span data-ttu-id="00b3d-190">**Figura 7**: Agregar un control CompareValidator para asegurarse de que el precio especificado es un valor de moneda no negativo ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-190">**Figure 7**: Add a CompareValidator to Ensure the Price Entered is a Non-Negative Currency Value ([Click to view full-size image](batch-updating-vb/_static/image12.png))</span></span>

<span data-ttu-id="00b3d-191">Para el `Discontinued` TemplateField puede utilizar la casilla de verificación ya definido en el `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-191">For the `Discontinued` TemplateField you can use the CheckBox already defined in the `ItemTemplate`.</span></span> <span data-ttu-id="00b3d-192">Basta con establecer su `ID` a suspendido y su `Enabled` propiedad `True`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-192">Simply set its `ID` to Discontinued and its `Enabled` property to `True`.</span></span>

## <a name="step-3-creating-thecategorynameediting-interface"></a><span data-ttu-id="00b3d-193">Paso 3: Creación de la`CategoryName`interfaz de edición</span><span class="sxs-lookup"><span data-stu-id="00b3d-193">Step 3: Creating the`CategoryName`Editing Interface</span></span>

<span data-ttu-id="00b3d-194">La interfaz de edición en el `CategoryName` TemplateField s `EditItemTemplate` contiene un cuadro de texto que muestra el valor de la `CategoryName` campo de datos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-194">The editing interface in the `CategoryName` TemplateField s `EditItemTemplate` contains a TextBox that displays the value of the `CategoryName` data field.</span></span> <span data-ttu-id="00b3d-195">Es necesario reemplazar esto con un DropDownList que enumera las categorías posibles.</span><span class="sxs-lookup"><span data-stu-id="00b3d-195">We need to replace this with a DropDownList that lists the possible categories.</span></span>

> [!NOTE]
> <span data-ttu-id="00b3d-196">El [personalizar la interfaz de modificación de datos](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial contiene una explicación más exhaustiva y completa acerca de cómo personalizar una plantilla para incluir un DropDownList en lugar de un cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="00b3d-196">The [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial contains a more thorough and complete discussion on customizing a template to include a DropDownList as opposed to a TextBox.</span></span> <span data-ttu-id="00b3d-197">Mientras que finalizan los pasos siguientes, se presentan lacónicamente.</span><span class="sxs-lookup"><span data-stu-id="00b3d-197">While the steps here are complete, they are presented tersely.</span></span> <span data-ttu-id="00b3d-198">Para una información más detallada sobre creación y configuración de las categorías de DropDownList, vuelva a consultar el [personalizar la interfaz de modificación de datos](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="00b3d-198">For a more in-depth look at creating and configuring the categories DropDownList, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>

<span data-ttu-id="00b3d-199">Arrastre DropDownList desde el cuadro de herramientas hasta la `CategoryName` TemplateField s `ItemTemplate`, estableciendo su `ID` a `Categories`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-199">Drag a DropDownList from the Toolbox onto the `CategoryName` TemplateField s `ItemTemplate`, setting its `ID` to `Categories`.</span></span> <span data-ttu-id="00b3d-200">En este momento se suele definiría el origen de datos de listas desplegables s a través de su etiqueta inteligente, crear un nuevo origen ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00b3d-200">At this point we would usually define the DropDownLists s data source through its smart tag, creating a new ObjectDataSource.</span></span> <span data-ttu-id="00b3d-201">Sin embargo, esta acción agregará ObjectDataSource dentro de la `ItemTemplate`, lo que producirá una instancia de origen ObjectDataSource creada para cada fila de GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-201">However, this will add the ObjectDataSource within the `ItemTemplate`, which will result in an ObjectDataSource instance created for each GridView row.</span></span> <span data-ttu-id="00b3d-202">En su lugar, permiten s crear fuera de la s GridView TemplateFields ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00b3d-202">Instead, let s create the ObjectDataSource outside of the GridView s TemplateFields.</span></span> <span data-ttu-id="00b3d-203">Finalizar la edición de plantillas y arrastre un origen ObjectDataSource desde el cuadro de herramientas hasta el diseñador debajo el `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00b3d-203">End the template editing and drag an ObjectDataSource from the Toolbox onto the Designer beneath the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="00b3d-204">Nombre del nuevo origen ObjectDataSource `CategoriesDataSource` y configúrelo para utilizar el `CategoriesBLL` clase s `GetCategories` método.</span><span class="sxs-lookup"><span data-stu-id="00b3d-204">Name the new ObjectDataSource `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories` method.</span></span>

<span data-ttu-id="00b3d-205">[![Configurar el origen ObjectDataSource para usar la clase CategoriesBLL](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-205">[![Configure the ObjectDataSource to Use the CategoriesBLL Class](batch-updating-vb/_static/image8.gif)](batch-updating-vb/_static/image13.png)</span></span>

<span data-ttu-id="00b3d-206">**Figura 8**: Configurar el origen ObjectDataSource que se usarán el `CategoriesBLL` clase ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-206">**Figure 8**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class ([Click to view full-size image](batch-updating-vb/_static/image14.png))</span></span>

<span data-ttu-id="00b3d-207">[![Recuperar los datos de categoría mediante el método GetCategories](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-207">[![Retrieve the Category Data Using the GetCategories Method](batch-updating-vb/_static/image9.gif)](batch-updating-vb/_static/image15.png)</span></span>

<span data-ttu-id="00b3d-208">**Figura 9**: Recuperar los datos de categoría mediante la `GetCategories` método ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-208">**Figure 9**: Retrieve the Category Data Using the `GetCategories` Method ([Click to view full-size image](batch-updating-vb/_static/image16.png))</span></span>

<span data-ttu-id="00b3d-209">Puesto que este origen ObjectDataSource se usa simplemente para recuperar los datos, establezca las listas desplegables en las fichas de UPDATE y DELETE en (None).</span><span class="sxs-lookup"><span data-stu-id="00b3d-209">Since this ObjectDataSource is used merely to retrieve data, set the drop-down lists in the UPDATE and DELETE tabs to (None).</span></span> <span data-ttu-id="00b3d-210">Haga clic en Finalizar para completar al asistente.</span><span class="sxs-lookup"><span data-stu-id="00b3d-210">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="00b3d-211">[![Conjunto de las listas desplegables en la actualización y eliminación pestañas en (None)](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-211">[![Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None)](batch-updating-vb/_static/image10.gif)](batch-updating-vb/_static/image17.png)</span></span>

<span data-ttu-id="00b3d-212">**Figura 10**: Establecer la lista desplegable se enumeran en las fichas de DELETE y UPDATE (ninguna) ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-212">**Figure 10**: Set the Drop-Down Lists in the UPDATE and DELETE Tabs to (None) ([Click to view full-size image](batch-updating-vb/_static/image18.png))</span></span>

<span data-ttu-id="00b3d-213">Después de completar el asistente, la `CategoriesDataSource` marcado declarativo s debería ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="00b3d-213">After completing the wizard, the `CategoriesDataSource` s declarative markup should look like the following:</span></span>

[!code-aspx[Main](batch-updating-vb/samples/sample2.aspx)]

<span data-ttu-id="00b3d-214">Con el `CategoriesDataSource` creada y configurada, volver a la `CategoryName` TemplateField s `ItemTemplate` y, en la etiqueta inteligente de DropDownList s, haga clic en el vínculo Elegir origen de datos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-214">With the `CategoriesDataSource` created and configured, return to the `CategoryName` TemplateField s `ItemTemplate` and, from the DropDownList s smart tag, click on the Choose Data Source link.</span></span> <span data-ttu-id="00b3d-215">En el Asistente para configuración de orígenes de datos, seleccione el `CategoriesDataSource` opción en la primera lista desplegable y elija `CategoryName` utilizan para mostrar y `CategoryID` como valor.</span><span class="sxs-lookup"><span data-stu-id="00b3d-215">In the Data Source Configuration wizard, select the `CategoriesDataSource` option from the first drop-down list and choose to have `CategoryName` used for the display and `CategoryID` as the value.</span></span>

<span data-ttu-id="00b3d-216">[![Enlazar el CategoriesDataSource DropDownList](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-216">[![Bind the DropDownList to the CategoriesDataSource](batch-updating-vb/_static/image11.gif)](batch-updating-vb/_static/image19.png)</span></span>

<span data-ttu-id="00b3d-217">**Figura 11**: Enlazar la DropDownList para la `CategoriesDataSource` ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-217">**Figure 11**: Bind the DropDownList to the `CategoriesDataSource` ([Click to view full-size image](batch-updating-vb/_static/image20.png))</span></span>

<span data-ttu-id="00b3d-218">En este momento el `Categories` DropDownList enumera todas las categorías, pero no aún automáticamente y seleccione la categoría apropiada para el producto enlazado a la fila GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-218">At this point the `Categories` DropDownList lists all of the categories, but it does not yet automatically select the appropriate category for the product bound to the GridView row.</span></span> <span data-ttu-id="00b3d-219">Para lograr esto es necesario establecer la `Categories` DropDownList s `SelectedValue` al producto s `CategoryID` valor.</span><span class="sxs-lookup"><span data-stu-id="00b3d-219">To accomplish this we need to set the `Categories` DropDownList s `SelectedValue` to the product s `CategoryID` value.</span></span> <span data-ttu-id="00b3d-220">Haga clic en el vínculo Editar DataBindings de la etiqueta inteligente de DropDownList s y asociar el `SelectedValue` propiedad con el `CategoryID` del campo de datos tal como se muestra en la figura 12.</span><span class="sxs-lookup"><span data-stu-id="00b3d-220">Click on the Edit DataBindings link from the DropDownList s smart tag and associate the `SelectedValue` property with the `CategoryID` data field as shown in Figure 12.</span></span>

![Enlazar el valor de Id. de categoría de producto s a la propiedad SelectedValue de s de DropDownList](batch-updating-vb/_static/image12.gif)

<span data-ttu-id="00b3d-222">**Figura 12**: Enlazar el producto s `CategoryID` valor para el s DropDownList `SelectedValue` propiedad</span><span class="sxs-lookup"><span data-stu-id="00b3d-222">**Figure 12**: Bind the Product s `CategoryID` Value to the DropDownList s `SelectedValue` Property</span></span>

<span data-ttu-id="00b3d-223">Una última sigue siendo de problema: si el producto tiene un `CategoryID` valor especificado, a continuación, la instrucción de enlace de datos en `SelectedValue` dará como resultado una excepción.</span><span class="sxs-lookup"><span data-stu-id="00b3d-223">One last problem remains: if the product doesn t have a `CategoryID` value specified then the databinding statement on `SelectedValue` will result in an exception.</span></span> <span data-ttu-id="00b3d-224">Esto es porque la DropDownList contiene solo los elementos de las categorías y no ofrece una opción para aquellos productos que tienen un `NULL` valor para la base de datos `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-224">This is because the DropDownList contains only items for the categories and does not offer an option for those products that have a `NULL` database value for `CategoryID`.</span></span> <span data-ttu-id="00b3d-225">Para solucionar este problema, establezca la s DropDownList `AppendDataBoundItems` propiedad `True` y agregue un nuevo elemento al control DropDownList, omitiendo la `Value` propiedad de la sintaxis declarativa.</span><span class="sxs-lookup"><span data-stu-id="00b3d-225">To remedy this, set the DropDownList s `AppendDataBoundItems` property to `True` and add a new item to the DropDownList, omitting the `Value` property from the declarative syntax.</span></span> <span data-ttu-id="00b3d-226">Es decir, asegúrese de que el `Categories` sintaxis declarativa de DropDownList s es similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="00b3d-226">That is, make sure that the `Categories` DropDownList s declarative syntax looks like the following:</span></span>

[!code-aspx[Main](batch-updating-vb/samples/sample3.aspx)]

<span data-ttu-id="00b3d-227">Tenga en cuenta cómo el `<asp:ListItem Value="">` : seleccione uno--tiene su `Value` atributo se establece explícitamente en una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="00b3d-227">Note how the `<asp:ListItem Value="">` -- Select One -- has its `Value` attribute explicitly set to an empty string.</span></span> <span data-ttu-id="00b3d-228">Vuelva a consultar el [personalizar la interfaz de modificación de datos](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial para obtener una explicación más exhaustiva sobre por qué se necesita este elemento DropDownList adicional para controlar la `NULL` caso y por qué la asignación de la `Value` propiedad en una cadena vacía es esencial.</span><span class="sxs-lookup"><span data-stu-id="00b3d-228">Refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial for a more thorough discussion on why this additional DropDownList item is needed to handle the `NULL` case and why assignment of the `Value` property to an empty string is essential.</span></span>

> [!NOTE]
> <span data-ttu-id="00b3d-229">Hay un rendimiento y escalabilidad problema potencial aquí que vale la pena mencionar.</span><span class="sxs-lookup"><span data-stu-id="00b3d-229">There is a potential performance and scalability issue here that is worth mentioning.</span></span> <span data-ttu-id="00b3d-230">Puesto que cada fila tiene un DropDownList que usa el `CategoriesDataSource` como origen de datos, el `CategoriesBLL` clase s `GetCategories` se llamará al método *n* visitan veces por página, donde *n* es el número de filas en GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-230">Since each row has a DropDownList that uses the `CategoriesDataSource` as its data source, the `CategoriesBLL` class s `GetCategories` method will be called *n* times per page visit, where *n* is the number of rows in the GridView.</span></span> <span data-ttu-id="00b3d-231">Estos *n* las llamadas a `GetCategories` dar lugar a *n* consultas a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-231">These *n* calls to `GetCategories` result in *n* queries to the database.</span></span> <span data-ttu-id="00b3d-232">Este impacto en la base de datos podría reducirse al almacenar en caché las categorías devueltas en una caché de cada solicitud o a través de la capa de almacenamiento en caché con una dependencia o una expiración de muy corta duración definida de almacenamiento en caché de SQL.</span><span class="sxs-lookup"><span data-stu-id="00b3d-232">This impact on the database could be lessened by caching the returned categories either in a per-request cache or through the Caching Layer using a SQL caching dependency or a very short time-based expiry.</span></span> <span data-ttu-id="00b3d-233">Para obtener más información sobre la solicitud por opción, consulte [ `HttpContext.Items` un Store de la memoria caché por solicitud](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="00b3d-233">For more information on the per-request caching option, see [`HttpContext.Items` a Per-Request Cache Store](http://aspnet.4guysfromrolla.com/articles/060904-1.aspx).</span></span>

## <a name="step-4-completing-the-editing-interface"></a><span data-ttu-id="00b3d-234">Paso 4: Finalización de la interfaz de edición</span><span class="sxs-lookup"><span data-stu-id="00b3d-234">Step 4: Completing the Editing Interface</span></span>

<span data-ttu-id="00b3d-235">Hemos llegado una serie de cambios en las plantillas de GridView s sin poner en pausa para ver nuestro progreso.</span><span class="sxs-lookup"><span data-stu-id="00b3d-235">We ve made a number of changes to the GridView s templates without pausing to view our progress.</span></span> <span data-ttu-id="00b3d-236">Dedique un momento para ver nuestro progreso a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="00b3d-236">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="00b3d-237">Como se muestra en la figura 13, cada fila se representa mediante su `ItemTemplate`, que contiene la celda interfaz de edición.</span><span class="sxs-lookup"><span data-stu-id="00b3d-237">As Figure 13 shows, each row is rendered using its `ItemTemplate`, which contains the cell s editing interface.</span></span>

<span data-ttu-id="00b3d-238">[![Cada fila GridView es modificable](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-238">[![Each GridView Row is Editable](batch-updating-vb/_static/image13.gif)](batch-updating-vb/_static/image21.png)</span></span>

<span data-ttu-id="00b3d-239">**Figura 13**: Cada fila GridView es Editable ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-239">**Figure 13**: Each GridView Row is Editable ([Click to view full-size image](batch-updating-vb/_static/image22.png))</span></span>

<span data-ttu-id="00b3d-240">Hay algunos problemas menores de formato que nosotros nos debemos encargamos de en este momento.</span><span class="sxs-lookup"><span data-stu-id="00b3d-240">There are a few minor formatting issues that we should take care of at this point.</span></span> <span data-ttu-id="00b3d-241">En primer lugar, tenga en cuenta que el `UnitPrice` valor contiene cuatro espacios decimales.</span><span class="sxs-lookup"><span data-stu-id="00b3d-241">First, note that the `UnitPrice` value contains four decimal points.</span></span> <span data-ttu-id="00b3d-242">Para solucionar este problema, vuelva a la `UnitPrice` TemplateField s `ItemTemplate` y, en la etiqueta inteligente s de cuadro de texto, haga clic en el vínculo Editar DataBindings.</span><span class="sxs-lookup"><span data-stu-id="00b3d-242">To fix this, return to the `UnitPrice` TemplateField s `ItemTemplate` and, from the TextBox s smart tag, click on the Edit DataBindings link.</span></span> <span data-ttu-id="00b3d-243">A continuación, especifique que la `Text` propiedad se debe dar formato como un número.</span><span class="sxs-lookup"><span data-stu-id="00b3d-243">Next, specify that the `Text` property should be formatted as a number.</span></span>

![Dar formato a la propiedad de texto como un número](batch-updating-vb/_static/image14.gif)

<span data-ttu-id="00b3d-245">**Figura 14**: Formato del `Text` propiedad como un número</span><span class="sxs-lookup"><span data-stu-id="00b3d-245">**Figure 14**: Format the `Text` Property as a Number</span></span>

<span data-ttu-id="00b3d-246">En segundo lugar, s permiten centrar la casilla de verificación en la `Discontinued` columna (en lugar de tener que alinea a la izquierda).</span><span class="sxs-lookup"><span data-stu-id="00b3d-246">Second, let s center the checkbox in the `Discontinued` column (rather than having it left-aligned).</span></span> <span data-ttu-id="00b3d-247">Haga clic en Editar columnas de la etiqueta inteligente de GridView s y seleccione el `Discontinued` TemplateField en la lista de campos en la esquina inferior izquierda.</span><span class="sxs-lookup"><span data-stu-id="00b3d-247">Click on Edit Columns from the GridView s smart tag and select the `Discontinued` TemplateField from the list of fields in the bottom left corner.</span></span> <span data-ttu-id="00b3d-248">Explorar en profundidad `ItemStyle` y establezca el `HorizontalAlign` propiedad al centro, como se muestra en la figura 15.</span><span class="sxs-lookup"><span data-stu-id="00b3d-248">Drill down into `ItemStyle` and set the `HorizontalAlign` property to Center as shown in Figure 15.</span></span>

![Centro de la casilla de verificación no incluida](batch-updating-vb/_static/image15.gif)

<span data-ttu-id="00b3d-250">**Figura 15**: Centro de la `Discontinued` casilla de verificación</span><span class="sxs-lookup"><span data-stu-id="00b3d-250">**Figure 15**: Center the `Discontinued` CheckBox</span></span>

<span data-ttu-id="00b3d-251">A continuación, agregue un control ValidationSummary a la página y establezca su `ShowMessageBox` propiedad `True` y su `ShowSummary` propiedad `False`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-251">Next, add a ValidationSummary control to the page and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span> <span data-ttu-id="00b3d-252">Agregar también que controles de botón Web que, al hacer clic en, se actualizará el usuario cambia de s.</span><span class="sxs-lookup"><span data-stu-id="00b3d-252">Also add the Button Web controls that, when clicked, will update the user s changes.</span></span> <span data-ttu-id="00b3d-253">En concreto, agregue dos controles de botón Web, uno por encima del control GridView y otro después de ella, establecer ambos controles `Text` propiedades a los productos de actualización.</span><span class="sxs-lookup"><span data-stu-id="00b3d-253">Specifically, add two Button Web controls, one above the GridView and one below it, setting both controls `Text` properties to Update Products .</span></span>

<span data-ttu-id="00b3d-254">Desde la s GridView la interfaz de edición se define en su TemplateFields `ItemTemplate` s, la `EditItemTemplate` s no son necesarios y pueden eliminarse.</span><span class="sxs-lookup"><span data-stu-id="00b3d-254">Since the GridView s editing interface is defined in its TemplateFields `ItemTemplate` s, the `EditItemTemplate` s are superfluous and may be deleted.</span></span>

<span data-ttu-id="00b3d-255">Después de realizar los pasos anteriores, los cambios de formato mencionó, los controles de botón de agregar y quitar el innecesarios `EditItemTemplate` s, su sintaxis declarativa de la página s debería ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="00b3d-255">After making the above mentioned formatting changes, adding the Button controls, and removing the unnecessary `EditItemTemplate` s, your page s declarative syntax should look like the following:</span></span>

[!code-aspx[Main](batch-updating-vb/samples/sample4.aspx)]

<span data-ttu-id="00b3d-256">Figura 16 se muestra esta página cuando se ve mediante un explorador después de han agregado los controles Web de botón y realizados los cambios de formato.</span><span class="sxs-lookup"><span data-stu-id="00b3d-256">Figure 16 shows this page when viewed through a browser after the Button Web controls have been added and the formatting changes made.</span></span>

<span data-ttu-id="00b3d-257">[![Página ahora incluye dos botones de productos de actualización](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="00b3d-257">[![The Page Now Includes Two Update Products Buttons](batch-updating-vb/_static/image16.gif)](batch-updating-vb/_static/image23.png)</span></span>

<span data-ttu-id="00b3d-258">**Figura 16**: La página ahora incluye dos actualización productos botones ([haga clic aquí para ver imagen en tamaño completo](batch-updating-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="00b3d-258">**Figure 16**: The Page Now Includes Two Update Products Buttons ([Click to view full-size image](batch-updating-vb/_static/image24.png))</span></span>

## <a name="step-5-updating-the-products"></a><span data-ttu-id="00b3d-259">Paso 5: Actualización de los productos</span><span class="sxs-lookup"><span data-stu-id="00b3d-259">Step 5: Updating the Products</span></span>

<span data-ttu-id="00b3d-260">Cuando un usuario visita esta página que se realicen modificaciones y, a continuación, haga clic en uno de los dos botones de productos de actualización.</span><span class="sxs-lookup"><span data-stu-id="00b3d-260">When a user visits this page they will make their modifications and then click one of the two Update Products buttons.</span></span> <span data-ttu-id="00b3d-261">En ese momento se necesita alguna manera guardar los valores introducidos por el usuario para cada fila en un `ProductsDataTable` de instancia y luego se pasa a un método BLL que, a continuación, pasará que `ProductsDataTable` instancia para el s DAL `UpdateWithTransaction` método.</span><span class="sxs-lookup"><span data-stu-id="00b3d-261">At that point we need to somehow save the user-entered values for each row into a `ProductsDataTable` instance and then pass that to a BLL method that will then pass that `ProductsDataTable` instance to the DAL s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="00b3d-262">El `UpdateWithTransaction` método, que hemos creado en el [tutorial anterior](wrapping-database-modifications-within-a-transaction-vb.md), garantiza que el lote de cambios se actualizarán como una operación atómica.</span><span class="sxs-lookup"><span data-stu-id="00b3d-262">The `UpdateWithTransaction` method, which we created in the [preceding tutorial](wrapping-database-modifications-within-a-transaction-vb.md), ensures that the batch of changes will be updated as an atomic operation.</span></span>

<span data-ttu-id="00b3d-263">Cree un método denominado `BatchUpdate` en `BatchUpdate.aspx.vb` y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="00b3d-263">Create a method named `BatchUpdate` in `BatchUpdate.aspx.vb` and add the following code:</span></span>

[!code-vb[Main](batch-updating-vb/samples/sample5.vb)]

<span data-ttu-id="00b3d-264">Este método comienza mediante la obtención de todos los productos en un `ProductsDataTable` mediante una llamada a la s BLL `GetProducts` método.</span><span class="sxs-lookup"><span data-stu-id="00b3d-264">This method starts out by getting all of the products back in a `ProductsDataTable` via a call to the BLL s `GetProducts` method.</span></span> <span data-ttu-id="00b3d-265">A continuación, enumera el `ProductGrid` GridView s [ `Rows` colección](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="00b3d-265">It then enumerates the `ProductGrid` GridView s [`Rows` collection](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows(VS.80).aspx).</span></span> <span data-ttu-id="00b3d-266">El `Rows` colección contiene un [ `GridViewRow` instancia](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) para cada fila que se muestra en el control GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-266">The `Rows` collection contains a [`GridViewRow` instance](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewrow.aspx) for each row displayed in the GridView.</span></span> <span data-ttu-id="00b3d-267">Puesto que vamos a presentar como máximo diez filas por página, la s GridView `Rows` colección contará con no más de diez elementos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-267">Since we are showing at most ten rows per page, the GridView s `Rows` collection will have no more than ten items.</span></span>

<span data-ttu-id="00b3d-268">Para cada fila del `ProductID` se obtiene de la `DataKeys` adecuado y colección `ProductsRow` está seleccionado en el `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-268">For each row the `ProductID` is grabbed from the `DataKeys` collection and the appropriate `ProductsRow` is selected from the `ProductsDataTable`.</span></span> <span data-ttu-id="00b3d-269">Los cuatro controles de entrada TemplateField mediante programación se hace referencia y sus valores se asignan a la `ProductsRow` s propiedades de la instancia.</span><span class="sxs-lookup"><span data-stu-id="00b3d-269">The four TemplateField input controls are programmatically referenced and their values assigned to the `ProductsRow` instance s properties.</span></span> <span data-ttu-id="00b3d-270">Después de cada control GridView se usaron los valores de fila s para actualizar la `ProductsDataTable`, se han pasado a la s BLL `UpdateWithTransaction` método que, como hemos visto en el tutorial anterior, simplemente llama a hacia abajo en la s DAL `UpdateWithTransaction` método.</span><span class="sxs-lookup"><span data-stu-id="00b3d-270">After each GridView row s values have been used to update the `ProductsDataTable`, it s passed to the BLL s `UpdateWithTransaction` method which, as we saw in the preceding tutorial, simply calls down into the DAL s `UpdateWithTransaction` method.</span></span>

<span data-ttu-id="00b3d-271">El algoritmo de actualización por lotes utilizado para este tutorial actualiza cada fila de la `ProductsDataTable` que corresponde a una fila en el control GridView, independientemente de si ha cambiado la información del producto s.</span><span class="sxs-lookup"><span data-stu-id="00b3d-271">The batch update algorithm used for this tutorial updates each row in the `ProductsDataTable` that corresponds to a row in the GridView, regardless of whether the product s information has been changed.</span></span> <span data-ttu-id="00b3d-272">Aunque estas actualizaciones ocultas no supone un problema de rendimiento, puede provocar registros superfluo si se van a auditar los cambios en la tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-272">While such blind updates aren't usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="00b3d-273">En el [realizar actualizaciones por lotes](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial hemos explorado una actualización por lotes interfaz con el control DataList y agregado código que va a actualizar solo aquellos registros que realmente se han modificado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="00b3d-273">Back in the [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) tutorial we explored a batch updating interface with the DataList and added code that would only update those records that were actually modified by the user.</span></span> <span data-ttu-id="00b3d-274">No dude en usar las técnicas de [realizar actualizaciones por lotes](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) para actualizar el código en este tutorial, si lo desea.</span><span class="sxs-lookup"><span data-stu-id="00b3d-274">Feel free to use the techniques from [Performing Batch Updates](../editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb.md) to update the code in this tutorial, if desired.</span></span>

> [!NOTE]
> <span data-ttu-id="00b3d-275">Al enlazar el origen de datos en el control GridView a través de su etiqueta inteligente, Visual Studio asigna automáticamente los valores de clave principal de s de origen de datos para el s GridView `DataKeyNames` propiedad.</span><span class="sxs-lookup"><span data-stu-id="00b3d-275">When binding the data source to the GridView through its smart tag, Visual Studio automatically assigns the data source s primary key value(s) to the GridView s `DataKeyNames` property.</span></span> <span data-ttu-id="00b3d-276">Si no se enlazó ObjectDataSource en GridView a través de la etiqueta inteligente de GridView s tal como se describe en el paso 1, entonces deberá establecer manualmente la s GridView `DataKeyNames` propiedad ProductID para tener acceso a la `ProductID` valor para cada fila a través de la `DataKeys` colección.</span><span class="sxs-lookup"><span data-stu-id="00b3d-276">If you did not bind the ObjectDataSource to the GridView through the GridView s smart tag as outlined in Step 1, then you will need to manually set the GridView s `DataKeyNames` property to ProductID in order to access the `ProductID` value for each row through the `DataKeys` collection.</span></span>

<span data-ttu-id="00b3d-277">El código usado en `BatchUpdate` es similar al usado en las operaciones de asignación BLL `UpdateProduct` métodos, la principal diferencia es que en el `UpdateProduct` métodos una sola `ProductRow` se recupera la instancia de la arquitectura.</span><span class="sxs-lookup"><span data-stu-id="00b3d-277">The code used in `BatchUpdate` is similar to that used in the BLL s `UpdateProduct` methods, the main difference being that in the `UpdateProduct` methods only a single `ProductRow` instance is retrieved from the architecture.</span></span> <span data-ttu-id="00b3d-278">El código que asigna las propiedades de la `ProductRow` es el mismo entre el `UpdateProducts` métodos y el código dentro de la `For Each` bucle en `BatchUpdate`, tal y como es el patrón general.</span><span class="sxs-lookup"><span data-stu-id="00b3d-278">The code that assigns the properties of the `ProductRow` is the same between the `UpdateProducts` methods and the code within the `For Each` loop in `BatchUpdate`, as is the overall pattern.</span></span>

<span data-ttu-id="00b3d-279">Para completar este tutorial, necesitamos tener la `BatchUpdate` método invoca cuando se hace clic en cualquiera de los botones de productos de actualización.</span><span class="sxs-lookup"><span data-stu-id="00b3d-279">To complete this tutorial, we need to have the `BatchUpdate` method invoked when either of the Update Products buttons is clicked.</span></span> <span data-ttu-id="00b3d-280">Crear controladores de eventos para el `Click` eventos de estos dos controles de botón y agregue el código siguiente en los controladores de eventos:</span><span class="sxs-lookup"><span data-stu-id="00b3d-280">Create event handlers for the `Click` events of these two Button controls and add the following code in the event handlers:</span></span>

[!code-vb[Main](batch-updating-vb/samples/sample6.vb)]

<span data-ttu-id="00b3d-281">En primer lugar se realiza una llamada a `BatchUpdate`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-281">First a call is made to `BatchUpdate`.</span></span> <span data-ttu-id="00b3d-282">A continuación, el [ `ClientScript` propiedad](https://msdn.microsoft.com/library/system.web.ui.page.clientscript(VS.80).aspx) se usa para inyectar código JavaScript que se mostrará un cuadro de mensajes que lee los productos se han actualizado.</span><span class="sxs-lookup"><span data-stu-id="00b3d-282">Next, the [`ClientScript` property](https://msdn.microsoft.com/library/system.web.ui.page.clientscript(VS.80).aspx) is used to inject JavaScript that will display a messagebox that reads The products have been updated.</span></span>

<span data-ttu-id="00b3d-283">Tómese un minuto para probar este código.</span><span class="sxs-lookup"><span data-stu-id="00b3d-283">Take a minute to test out this code.</span></span> <span data-ttu-id="00b3d-284">Visite `BatchUpdate.aspx` a través de un explorador, editar un número de filas y haga clic en uno de los botones de productos de actualización.</span><span class="sxs-lookup"><span data-stu-id="00b3d-284">Visit `BatchUpdate.aspx` through a browser, edit a number of rows, and click one of the Update Products buttons.</span></span> <span data-ttu-id="00b3d-285">Suponiendo que no haya ningún error de validación de entrada, debería ver un cuadro de mensajes que lee que los productos se han actualizado.</span><span class="sxs-lookup"><span data-stu-id="00b3d-285">Assuming there are no input validation errors, you should see a messagebox that reads The products have been updated.</span></span> <span data-ttu-id="00b3d-286">Para comprobar la atomicidad de la actualización, considere la posibilidad de agregar uno aleatorio `CHECK` restricción, al igual que uno que no admita `UnitPrice` valores de 1234,56.</span><span class="sxs-lookup"><span data-stu-id="00b3d-286">To verify the atomicity of the update, consider adding a random `CHECK` constraint, like one that disallows `UnitPrice` values of 1234.56.</span></span> <span data-ttu-id="00b3d-287">A continuación, en `BatchUpdate.aspx`, editar un número de registros, procurando establecer uno de los productos s `UnitPrice` valor para el valor prohibido (1234,56).</span><span class="sxs-lookup"><span data-stu-id="00b3d-287">Then from `BatchUpdate.aspx`, edit a number of records, making sure to set one of the product s `UnitPrice` value to the forbidden value ( 1234.56 ).</span></span> <span data-ttu-id="00b3d-288">Esto debería producir un error cuando haga clic en productos de actualización con los otros cambios durante esa operación por lotes revierte a sus valores originales.</span><span class="sxs-lookup"><span data-stu-id="00b3d-288">This should result in an error when clicking Update Products with the other changes during that batch operation rolled back to their original values.</span></span>

## <a name="an-alternativebatchupdatemethod"></a><span data-ttu-id="00b3d-289">Una alternativa`BatchUpdate`(método)</span><span class="sxs-lookup"><span data-stu-id="00b3d-289">An Alternative`BatchUpdate`Method</span></span>

<span data-ttu-id="00b3d-290">El `BatchUpdate` método simplemente examina recupera *todas* de los productos de BLL s `GetProducts` método y, a continuación, actualiza los registros que aparecen en el control GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-290">The `BatchUpdate` method we just examined retrieves *all* of the products from the BLL s `GetProducts` method and then updates just those records that appear in the GridView.</span></span> <span data-ttu-id="00b3d-291">Este enfoque es ideal si el control GridView no utiliza la paginación, pero si lo hace, puede haber cientos, miles o decenas de miles de productos, pero sólo diez filas en GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-291">This approach is ideal if the GridView does not use paging, but if it does, there may be hundreds, thousands, or tens of thousands of products, but only ten rows in the GridView.</span></span> <span data-ttu-id="00b3d-292">En tal caso, la obtención de todos los productos de la base de datos solo para modificar el 10 de ellas es ideal.</span><span class="sxs-lookup"><span data-stu-id="00b3d-292">In such a case, getting all of the products from the database only to modify 10 of them is less than ideal.</span></span>

<span data-ttu-id="00b3d-293">Para esos tipos de situaciones, considere el uso de los siguientes `BatchUpdateAlternate` método en su lugar:</span><span class="sxs-lookup"><span data-stu-id="00b3d-293">For those types of situations, consider using the following `BatchUpdateAlternate` method instead:</span></span>

[!code-vb[Main](batch-updating-vb/samples/sample7.vb)]

<span data-ttu-id="00b3d-294">`BatchMethodAlternate` se inicia mediante la creación de una nueva y vacía `ProductsDataTable` denominado `products`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-294">`BatchMethodAlternate` starts by creating a new empty `ProductsDataTable` named `products`.</span></span> <span data-ttu-id="00b3d-295">A continuación, se recorre la s GridView `Rows` colección y para cada fila Obtiene la información de producto en particular utilizando la s BLL `GetProductByProductID(productID)` método.</span><span class="sxs-lookup"><span data-stu-id="00b3d-295">It then steps through the GridView s `Rows` collection and for each row gets the particular product information using the BLL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="00b3d-296">El objeto recuperado `ProductsRow` instancia tiene sus propiedades actualizados en la misma manera que `BatchUpdate`, pero después de actualizar la fila que se importan los `products` `ProductsDataTable` a través de las operaciones de asignación DataTable [ `ImportRow(DataRow)` método](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="00b3d-296">The retrieved `ProductsRow` instance has its properties updated in the same fashion as `BatchUpdate`, but after updating the row it is imported into the `products` `ProductsDataTable` via the DataTable s [`ImportRow(DataRow)` method](https://msdn.microsoft.com/library/system.data.datatable.importrow(VS.80).aspx).</span></span>

<span data-ttu-id="00b3d-297">Después de la `For Each` bucle se completa, `products` contiene uno `ProductsRow` instancia para cada fila en el control GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-297">After the `For Each` loop completes, `products` contains one `ProductsRow` instance for each row in the GridView.</span></span> <span data-ttu-id="00b3d-298">Desde cada uno de los `ProductsRow` instancias se han agregado a la `products` (en lugar de actualización), si se pasa a ciegas la `UpdateWithTransaction` método la `ProductsTableAdapter` intentará insertar cada uno de los registros en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="00b3d-298">Since each of the `ProductsRow` instances have been added to the `products` (instead of updated), if we blindly pass it to the `UpdateWithTransaction` method the `ProductsTableAdapter` will try to insert each of the records into the database.</span></span> <span data-ttu-id="00b3d-299">En su lugar, necesitamos especificar que cada una de estas filas se se ha modificado (no agregado).</span><span class="sxs-lookup"><span data-stu-id="00b3d-299">Instead, we need to specify that each of these rows has been modified (not added).</span></span>

<span data-ttu-id="00b3d-300">Esto puede realizarse mediante la adición de un nuevo método a la capa BLL denominada `UpdateProductsWithTransaction`.</span><span class="sxs-lookup"><span data-stu-id="00b3d-300">This can be accomplished by adding a new method to the BLL named `UpdateProductsWithTransaction`.</span></span> <span data-ttu-id="00b3d-301">`UpdateProductsWithTransaction`, conjuntos se muestra a continuación, el `RowState` de cada uno de los `ProductsRow` instancias en el `ProductsDataTable` a `Modified` y, a continuación, pasa el `ProductsDataTable` al s DAL `UpdateWithTransaction` método.</span><span class="sxs-lookup"><span data-stu-id="00b3d-301">`UpdateProductsWithTransaction`, shown below, sets the `RowState` of each of the `ProductsRow` instances in the `ProductsDataTable` to `Modified` and then passes the `ProductsDataTable` to the DAL s `UpdateWithTransaction` method.</span></span>

[!code-vb[Main](batch-updating-vb/samples/sample8.vb)]

## <a name="summary"></a><span data-ttu-id="00b3d-302">Resumen</span><span class="sxs-lookup"><span data-stu-id="00b3d-302">Summary</span></span>

<span data-ttu-id="00b3d-303">El control GridView proporciona capacidades de edición integrada por fila, pero no es compatible con la creación de interfaces puede modificables por completo.</span><span class="sxs-lookup"><span data-stu-id="00b3d-303">The GridView provides built-in per-row editing capabilities, but lacks support for creating fully editable interfaces.</span></span> <span data-ttu-id="00b3d-304">Como hemos visto en este tutorial, estas interfaces son posibles, pero requieren un poco de trabajo.</span><span class="sxs-lookup"><span data-stu-id="00b3d-304">As we saw in this tutorial, such interfaces are possible, but require a bit of work.</span></span> <span data-ttu-id="00b3d-305">Para crear un control GridView donde cada fila es editable, es necesario convertir los campos de s GridView TemplateFields y definir la interfaz de edición dentro de la `ItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="00b3d-305">To create a GridView where every row is editable, we need to convert the GridView s fields into TemplateFields and define the editing interface within the `ItemTemplate` s.</span></span> <span data-ttu-id="00b3d-306">Además, actualice todos los - tipo de controles Web de botón debe agregarse a la página, independiente de GridView.</span><span class="sxs-lookup"><span data-stu-id="00b3d-306">Additionally, Update All -type Button Web controls must be added to the page, separate from the GridView.</span></span> <span data-ttu-id="00b3d-307">Estos botones `Click` necesitan controladores de eventos enumerar las operaciones de asignación GridView `Rows` colección, almacenar los cambios en un `ProductsDataTable`y pasar la información actualizada en el método BLL adecuado.</span><span class="sxs-lookup"><span data-stu-id="00b3d-307">These Buttons `Click` event handlers need to enumerate the GridView s `Rows` collection, store the changes in a `ProductsDataTable`, and pass the updated information into the appropriate BLL method.</span></span>

<span data-ttu-id="00b3d-308">En el siguiente tutorial veremos cómo crear una interfaz para la eliminación de un lote.</span><span class="sxs-lookup"><span data-stu-id="00b3d-308">In the next tutorial we'll see how to create an interface for batch deleting.</span></span> <span data-ttu-id="00b3d-309">En concreto, cada fila GridView incluirá una casilla de verificación y, en lugar de actualizar todos-tipo de botones, tendremos los botones eliminar las filas seleccionadas.</span><span class="sxs-lookup"><span data-stu-id="00b3d-309">In particular, each GridView row will include a checkbox and instead of Update All -type buttons, we'll have Delete Selected Rows buttons.</span></span>

<span data-ttu-id="00b3d-310">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="00b3d-310">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="00b3d-311">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="00b3d-311">About the Author</span></span>

<span data-ttu-id="00b3d-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), trabaja con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="00b3d-312">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="00b3d-313">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="00b3d-313">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="00b3d-314">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="00b3d-314">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="00b3d-315">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="00b3d-315">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="00b3d-316">o a través de su blog, que puede encontrarse en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="00b3d-316">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="00b3d-317">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="00b3d-317">Special Thanks To</span></span>

<span data-ttu-id="00b3d-318">Esta serie de tutoriales ha sido revisada por muchos revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="00b3d-318">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="00b3d-319">Los revisores para este tutorial fueron Teresa Murphy y David Suru.</span><span class="sxs-lookup"><span data-stu-id="00b3d-319">Lead reviewers for this tutorial were Teresa Murphy and David Suru.</span></span> <span data-ttu-id="00b3d-320">¿Está interesado en leer mi próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="00b3d-320">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="00b3d-321">Si es así, envíeme una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="00b3d-321">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="00b3d-322">[Anterior](wrapping-database-modifications-within-a-transaction-vb.md)
> [Siguiente](batch-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="00b3d-322">[Previous](wrapping-database-modifications-within-a-transaction-vb.md)
[Next](batch-deleting-vb.md)</span></span>

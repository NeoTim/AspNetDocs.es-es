---
uid: signalr/overview/performance/signalr-connection-density-testing-with-crank
title: Densidad de la conexión de SignalR las pruebas con Crank | Microsoft Docs
author: bradygaster
description: Pruebas de densidad de la conexión de SignalR con Crank
ms.author: bradyg
ms.date: 02/22/2015
ms.assetid: 148d9ca7-1af1-44b6-a9fb-91e261b9b463
msc.legacyurl: /signalr/overview/performance/signalr-connection-density-testing-with-crank
msc.type: authoredcontent
ms.openlocfilehash: 40c9764f0c47b83df8300553b4b290429937345c
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/01/2019
ms.locfileid: "57058032"
---
<a name="signalr-connection-density-testing-with-crank"></a><span data-ttu-id="6fcbb-103">Pruebas de densidad de la conexión de SignalR con Crank</span><span class="sxs-lookup"><span data-stu-id="6fcbb-103">SignalR Connection Density Testing with Crank</span></span>
====================
<span data-ttu-id="6fcbb-104">por [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="6fcbb-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

> <span data-ttu-id="6fcbb-105">En este artículo se describe cómo usar la herramienta manivela para probar una aplicación con varios clientes simulados.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-105">This article describes how to use the Crank tool to test an application with multiple simulated clients.</span></span>


<span data-ttu-id="6fcbb-106">Una vez que la aplicación se ejecuta en su entorno de hospedaje (Azure un rol, IIS, web o autohospedan mediante Owin), puede probar la respuesta de la aplicación a un alto nivel de densidad de la conexión con la herramienta manivela.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-106">Once your application is running in its hosting environment (either an Azure web role, IIS, or self-hosted using Owin), you can test application's response to a high level of connection density using the Crank tool.</span></span> <span data-ttu-id="6fcbb-107">El entorno de hospedaje puede ser un servidor de Internet Information Services (IIS), un host Owin o un rol web de Azure.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-107">The hosting environment can be an Internet Information Services (IIS) server, an Owin host, or an Azure web role.</span></span> <span data-ttu-id="6fcbb-108">(Nota: Contadores de rendimiento no están disponibles en Azure App Service Web Apps, por lo que no podrá obtener datos de rendimiento de una prueba de densidad de la conexión.)</span><span class="sxs-lookup"><span data-stu-id="6fcbb-108">(Note: Performance counters are not available on Azure App Service Web Apps, so you will not be able to get performance data from a connection density test.)</span></span>

<span data-ttu-id="6fcbb-109">Densidad de la conexión se refiere al número de conexiones TCP simultáneas que pueden establecerse en un servidor.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-109">Connection Density refers to the number of simultaneous TCP connections that can be established on a server.</span></span> <span data-ttu-id="6fcbb-110">Cada conexión TCP implica su propia sobrecarga y abre un gran número de conexiones inactivas para crear un cuello de botella de memoria.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-110">Each TCP connection incurs its own overhead, and opening a large number of idle connections will eventually create a memory bottleneck.</span></span>

<span data-ttu-id="6fcbb-111">[SignalR codebase](https://github.com/signalr/signalr) incluye una herramienta de prueba de carga denominada **manivela**.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-111">[The SignalR codebase](https://github.com/signalr/signalr) includes a load-testing tool called **Crank**.</span></span> <span data-ttu-id="6fcbb-112">La versión más reciente de manivela puede encontrarse en [la bifurcación Dev](https://github.com/SignalR/signalr/tree/dev) en GitHub.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-112">The latest version of Crank can be found in [the Dev branch](https://github.com/SignalR/signalr/tree/dev) on GitHub.</span></span> <span data-ttu-id="6fcbb-113">Puede descargar un archivo Zip archive de la rama de desarrollo de SignalR codebase [aquí](https://github.com/SignalR/SignalR/archive/dev.zip).</span><span class="sxs-lookup"><span data-stu-id="6fcbb-113">You can download a Zip archive of the Dev branch of the SignalR codebase [here](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span>

<span data-ttu-id="6fcbb-114">Manivela puede utilizarse para saturar totalmente la memoria del servidor con el fin de calcular el número total de conexiones inactivas posibles en el hardware del servidor.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-114">Crank may be used to fully saturate the server's memory in order to calculate the total number of idle connections possible on the server hardware.</span></span> <span data-ttu-id="6fcbb-115">Como alternativa, también puede usar manivela para prueba de carga del servidor en una determinada cantidad de presión de memoria, por refuerza las conexiones hasta que se alcanza un umbral de memoria específica o de un número concreto.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-115">Alternatively, you may also use Crank to load test the server under a certain amount of memory pressure, by ramping up connections until a specific count or a specific memory threshold is reached.</span></span>

<span data-ttu-id="6fcbb-116">Al realizar pruebas, es importante usar clientes remotos para evitar cualquier competición por los recursos (es decir, las conexiones TCP y memoria).</span><span class="sxs-lookup"><span data-stu-id="6fcbb-116">When testing, it is important to use remote client(s) to avoid any competition for resources (i.e., TCP connections and memory).</span></span> <span data-ttu-id="6fcbb-117">Supervisar los clientes para asegurarse de que no supera los cuellos de botella que pueden impedir que el servidor de alcanzar su capacidad máxima (memoria o CPU).</span><span class="sxs-lookup"><span data-stu-id="6fcbb-117">Monitor the client(s) to ensure that they are not hitting any bottlenecks that may prevent the server from reaching its full capacity (memory or CPU).</span></span> <span data-ttu-id="6fcbb-118">Es posible que deba aumentar el número de clientes con el fin de cargar totalmente el servidor.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-118">You may need to increase the number of clients in order to fully load the server.</span></span>

### <a name="running-a-connection-density-test"></a><span data-ttu-id="6fcbb-119">Ejecutar una prueba de densidad de la conexión</span><span class="sxs-lookup"><span data-stu-id="6fcbb-119">Running a Connection Density Test</span></span>

<span data-ttu-id="6fcbb-120">Esta sección describen los pasos necesarios para ejecutar una prueba de densidad de la conexión en una aplicación de SignalR.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-120">This section describes the steps needed to run a connection density test on a SignalR application.</span></span>

1. <span data-ttu-id="6fcbb-121">Descargue y compile el [codebase de la rama de desarrollo de SignalR](https://github.com/SignalR/SignalR/archive/dev.zip).</span><span class="sxs-lookup"><span data-stu-id="6fcbb-121">Download and build the [Dev branch of the SignalR codebase](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span> <span data-ttu-id="6fcbb-122">En un símbolo del sistema, vaya a &lt;directorio del proyecto&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-122">In a command prompt, navigate to &lt;project directory&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.</span></span>
2. <span data-ttu-id="6fcbb-123">Implementar la aplicación en su entorno de hospedaje deseado.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-123">Deploy your application to its intended hosting environment.</span></span> <span data-ttu-id="6fcbb-124">Tome nota del punto de conexión que usa su aplicación; Por ejemplo, en la aplicación creada en el [tutorial de introducción](../getting-started/tutorial-getting-started-with-signalr.md), es el punto de conexión `http://<yourhost>:8080/signalr`.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-124">Make a note of the endpoint that your application uses; for example, in the application created in the [Getting Started tutorial](../getting-started/tutorial-getting-started-with-signalr.md), the endpoint is `http://<yourhost>:8080/signalr`.</span></span>
3. <span data-ttu-id="6fcbb-125">Instalar [los contadores de rendimiento de SignalR](signalr-performance.md#perfcounters) en el servidor.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-125">Install [SignalR performance counters](signalr-performance.md#perfcounters) on the server.</span></span> <span data-ttu-id="6fcbb-126">Si la aplicación se ejecuta en Azure, consulte [utilizando los contadores de rendimiento de SignalR en un rol Web de Azure](using-signalr-performance-counters-in-an-azure-web-role.md).</span><span class="sxs-lookup"><span data-stu-id="6fcbb-126">If your application is running on Azure, see [Using SignalR Performance Counters in an Azure Web Role](using-signalr-performance-counters-in-an-azure-web-role.md).</span></span>

<span data-ttu-id="6fcbb-127">Una vez haya descargado y compilado el código base e instala los contadores de rendimiento en el host, la herramienta de línea de comandos de manivela puede encontrarse en el `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` carpeta.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-127">Once you've downloaded and built the codebase, and installed performance counters on your host, the Crank command-line tool can be found in the `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` folder.</span></span>

<span data-ttu-id="6fcbb-128">Las opciones disponibles para la herramienta manivela incluyen:</span><span class="sxs-lookup"><span data-stu-id="6fcbb-128">Available options for the Crank tool include:</span></span>

- <span data-ttu-id="6fcbb-129">**/?**: Muestra la pantalla de ayuda.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-129">**/?**: Shows the help screen.</span></span> <span data-ttu-id="6fcbb-130">También se muestran las opciones disponibles si el **Url** se omite el parámetro.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-130">The available options are also displayed if the **Url** parameter is omitted.</span></span>
- <span data-ttu-id="6fcbb-131">**/Url**: La dirección URL para las conexiones SignalR.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-131">**/Url**: The URL for SignalR connections.</span></span> <span data-ttu-id="6fcbb-132">Este parámetro es necesario.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-132">This parameter is required.</span></span> <span data-ttu-id="6fcbb-133">Para una aplicación de SignalR mediante la asignación predeterminada, se finalizará la ruta de acceso en "/ signalr".</span><span class="sxs-lookup"><span data-stu-id="6fcbb-133">For a SignalR application using the default mapping, the path will end in "/signalr".</span></span>
- <span data-ttu-id="6fcbb-134">**/Transport**: El nombre del transporte utilizado.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-134">**/Transport**: The name of the transport used.</span></span> <span data-ttu-id="6fcbb-135">El valor predeterminado es `auto`, lo que seleccionará el mejor protocolo disponible.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-135">The default is `auto`, which will select the best available protocol.</span></span> <span data-ttu-id="6fcbb-136">Las opciones incluyen `WebSockets`, `ServerSentEvents`, y `LongPolling` (`ForeverFrame` no es una opción para manivela, desde el cliente de .NET en lugar de Internet Explorer se usa).</span><span class="sxs-lookup"><span data-stu-id="6fcbb-136">Options include `WebSockets`, `ServerSentEvents`, and `LongPolling` (`ForeverFrame` is not an option for Crank, since the .NET client rather than Internet Explorer is used).</span></span> <span data-ttu-id="6fcbb-137">Para obtener más información sobre cómo SignalR selecciona los transportes, consulte [transportes y reservas](../getting-started/introduction-to-signalr.md#transports).</span><span class="sxs-lookup"><span data-stu-id="6fcbb-137">For more information on how SignalR selects transports, see [Transports and Fallbacks](../getting-started/introduction-to-signalr.md#transports).</span></span>
- <span data-ttu-id="6fcbb-138">**/BatchSize**: El número de clientes que se agregan en cada lote.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-138">**/BatchSize**: The number of clients added in each batch.</span></span> <span data-ttu-id="6fcbb-139">El valor predeterminado es 50.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-139">The default is 50.</span></span>
- <span data-ttu-id="6fcbb-140">**/ConnectInterval**: El intervalo en milisegundos entre la adición de conexiones.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-140">**/ConnectInterval**: The interval in milliseconds between adding connections.</span></span> <span data-ttu-id="6fcbb-141">El valor predeterminado es 500.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-141">The default is 500.</span></span>
- <span data-ttu-id="6fcbb-142">**/ Conexiones**: El número de conexiones que se usa para la aplicación de prueba de carga.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-142">**/Connections**: The number of connections used to load-test the application.</span></span> <span data-ttu-id="6fcbb-143">El valor predeterminado es 100.000.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-143">The default is 100,000.</span></span>
- <span data-ttu-id="6fcbb-144">**/ConnectTimeout**: El tiempo de espera en segundos antes de anular la prueba.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-144">**/ConnectTimeout**: The timeout in seconds before aborting the test.</span></span> <span data-ttu-id="6fcbb-145">El valor predeterminado es 300.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-145">The default is 300.</span></span>
- <span data-ttu-id="6fcbb-146">**MinServerMBytes**: El número de megabytes de servidor mínima para llegar a.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-146">**MinServerMBytes**: The minimum server megabytes to reach.</span></span> <span data-ttu-id="6fcbb-147">El valor predeterminado es 500.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-147">The default is 500.</span></span>
- <span data-ttu-id="6fcbb-148">**SendBytes**: El tamaño de la carga enviada al servidor en bytes.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-148">**SendBytes**: The size of the payload sent to the server in bytes.</span></span> <span data-ttu-id="6fcbb-149">El valor predeterminado es 0.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-149">The default is 0.</span></span>
- <span data-ttu-id="6fcbb-150">**SendInterval**: El retraso en milisegundos entre los mensajes al servidor.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-150">**SendInterval**: The delay in milliseconds between messages to the server.</span></span> <span data-ttu-id="6fcbb-151">El valor predeterminado es 500.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-151">The default is 500.</span></span>
- <span data-ttu-id="6fcbb-152">**SendTimeout**: El tiempo de espera en milisegundos para los mensajes en el servidor.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-152">**SendTimeout**: The timeout in milliseconds for messages to the server.</span></span> <span data-ttu-id="6fcbb-153">El valor predeterminado es 300.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-153">The default is 300.</span></span>
- <span data-ttu-id="6fcbb-154">**ControllerUrl**: La dirección Url donde va a hospedar un concentrador de controladores de un cliente.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-154">**ControllerUrl**: The Url where one client will host a controller hub.</span></span> <span data-ttu-id="6fcbb-155">El valor predeterminado es null (ningún centro de controlador).</span><span class="sxs-lookup"><span data-stu-id="6fcbb-155">The default is null (no controller hub).</span></span> <span data-ttu-id="6fcbb-156">El concentrador se inicia cuando se inicia la sesión de manivela; ninguna otra contacto entre el concentrador y manivela se realiza.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-156">The controller hub is started when the Crank session starts; no further contact between the controller hub and Crank is made.</span></span>
- <span data-ttu-id="6fcbb-157">**NumClients**: El número de clientes simulados para conectarse a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-157">**NumClients**: The number of simulated clients to connect to the application.</span></span> <span data-ttu-id="6fcbb-158">El valor predeterminado es uno.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-158">The default is one.</span></span>
- <span data-ttu-id="6fcbb-159">**Archivo de registro**: El nombre de archivo para el archivo de registro para la ejecución de pruebas.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-159">**Logfile**: The filename for the logfile for the test run.</span></span> <span data-ttu-id="6fcbb-160">De manera predeterminada, es `crank.csv`.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-160">The default is `crank.csv`.</span></span>
- <span data-ttu-id="6fcbb-161">**SampleInterval**: El tiempo en milisegundos entre muestras del contador de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-161">**SampleInterval**: The time in milliseconds between performance counter samples.</span></span> <span data-ttu-id="6fcbb-162">El valor predeterminado es 1000.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-162">The default is 1000.</span></span>
- <span data-ttu-id="6fcbb-163">**SignalRInstance**: El nombre de instancia para los contadores de rendimiento en el servidor.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-163">**SignalRInstance**: The instance name for the performance counters on the server.</span></span> <span data-ttu-id="6fcbb-164">El valor predeterminado es usar el estado de conexión de cliente.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-164">The default is to use the client connection state.</span></span>

### <a name="example"></a><span data-ttu-id="6fcbb-165">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="6fcbb-165">Example</span></span>

<span data-ttu-id="6fcbb-166">El siguiente comando probará un sitio denominado `pfsignalr` en Azure que hospeda una aplicación en el puerto 8080 con un concentrador denominado "ControllerHub", usando 100 conexiones.</span><span class="sxs-lookup"><span data-stu-id="6fcbb-166">The following command will test a site called `pfsignalr` on Azure that hosts an application on port 8080 with a hub named "ControllerHub", using 100 connections.</span></span>

`crank /Connections:100 /Url:http://pfsignalr.cloudapp.net:8080/signalr`

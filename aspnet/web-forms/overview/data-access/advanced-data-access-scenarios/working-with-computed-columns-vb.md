---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
title: Trabajar con columnas calculadas (VB) | Microsoft Docs
author: rick-anderson
description: Al crear una tabla de base de datos, Microsoft SQL Server le permite definir una columna calculada cuyo valor se calcula a partir de una expresión que normalmente referencia...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 5811b8ff-ed56-40fc-9397-6b69ae09a8f6
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: 136e4a07422d9f71ed56ac132d93f5eade273ca2
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/25/2019
ms.locfileid: "58423174"
---
<a name="working-with-computed-columns-vb"></a><span data-ttu-id="2673c-103">Trabajar con columnas calculadas (VB)</span><span class="sxs-lookup"><span data-stu-id="2673c-103">Working with Computed Columns (VB)</span></span>
====================
<span data-ttu-id="2673c-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2673c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2673c-105">[Descargar código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) o [descargar PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2673c-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) or [Download PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span></span>

> <span data-ttu-id="2673c-106">Al crear una tabla de base de datos, Microsoft SQL Server permite definir una columna calculada cuyo valor se calcula a partir de una expresión que normalmente hace referencia a otros valores en el mismo registro de base de datos.</span><span class="sxs-lookup"><span data-stu-id="2673c-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="2673c-107">Estos valores son de solo lectura en la base de datos, lo que requiere consideraciones especiales cuando se trabaja con los TableAdapters.</span><span class="sxs-lookup"><span data-stu-id="2673c-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="2673c-108">En este tutorial se aprenderá cómo afrontar los desafíos que suponen las columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="2673c-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="2673c-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="2673c-109">Introduction</span></span>

<span data-ttu-id="2673c-110">Microsoft SQL Server permite  *[columnas calculadas](https://msdn.microsoft.com/library/ms191250.aspx)*, que son columnas cuyos valores se calculan a partir de una expresión que normalmente hace referencia a los valores de otras columnas de la misma tabla.</span><span class="sxs-lookup"><span data-stu-id="2673c-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="2673c-111">Por ejemplo, un modelo de datos de seguimiento de tiempo podría tener una tabla denominada `ServiceLog` con columnas incluidas `ServicePerformed`, `EmployeeID`, `Rate`, y `Duration`, entre otros.</span><span class="sxs-lookup"><span data-stu-id="2673c-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="2673c-112">Mientras que la cantidad de vencimiento por servicio (que se va a la tasa de multiplicado por la duración) podría calcularse a través de una página web o de otra interfaz programática, podría ser útil para incluir una columna en la `ServiceLog` tabla denominada `AmountDue` que notifica esto información.</span><span class="sxs-lookup"><span data-stu-id="2673c-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="2673c-113">Esta columna podría crearse como una columna normal, pero deberá actualizarse en cualquier momento el `Rate` o `Duration` les cambiados los valores de columna.</span><span class="sxs-lookup"><span data-stu-id="2673c-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="2673c-114">Un mejor enfoque sería realizar la `AmountDue` una columna calculada mediante la expresión de columna `Rate * Duration`.</span><span class="sxs-lookup"><span data-stu-id="2673c-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="2673c-115">Hacerlo podría causar SQL Server calcular automáticamente el `AmountDue` valor de la columna cada vez que se hizo referencia a una consulta.</span><span class="sxs-lookup"><span data-stu-id="2673c-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="2673c-116">Puesto que un valor de columna calculada s viene determinada por una expresión, estas columnas son de solo lectura y, por tanto, no pueden tener los valores asignados a ellos en `INSERT` o `UPDATE` instrucciones.</span><span class="sxs-lookup"><span data-stu-id="2673c-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="2673c-117">Sin embargo, cuando las columnas calculadas forman parte de la consulta principal de un TableAdapter utiliza instrucciones SQL ad hoc, se incluyen automáticamente en el autogenerado `INSERT` y `UPDATE` instrucciones.</span><span class="sxs-lookup"><span data-stu-id="2673c-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="2673c-118">Por lo tanto, los TableAdapter s `INSERT` y `UPDATE` consultas y `InsertCommand` y `UpdateCommand` propiedades deben actualizarse para quitar las referencias a las columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="2673c-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="2673c-119">Uno de los retos del uso de calcula las columnas con un TableAdapter utiliza instrucciones SQL ad hoc es que los TableAdapter s `INSERT` y `UPDATE` automáticamente las consultas se vuelven a generar siempre que se complete el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2673c-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="2673c-120">Por lo tanto, las columnas calculadas quitan manualmente desde el `INSERT` y `UPDATE` consultas volverá a aparecer si se vuelve a ejecutar el asistente.</span><span class="sxs-lookup"><span data-stu-id="2673c-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="2673c-121">Aunque los TableAdapters que utilizan procedimientos almacenados don t sufren este fragilidad, tienen sus propias peculiaridades que abordaremos en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="2673c-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="2673c-122">En este tutorial se agregará una columna calculada a la `Suppliers` de tabla en la base de datos Northwind y, a continuación, creará un TableAdapter correspondiente para que funcione con esta tabla y su columna calculada.</span><span class="sxs-lookup"><span data-stu-id="2673c-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="2673c-123">Tendremos nuestro TableAdapter utilizar procedimientos almacenados en lugar de instrucciones SQL ad hoc para que nuestro personalizaciones no se pierden cuando se usa el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2673c-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="2673c-124">Introducción s Let!</span><span class="sxs-lookup"><span data-stu-id="2673c-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="2673c-125">Paso 1: Agregar una columna calculada a la`Suppliers`tabla</span><span class="sxs-lookup"><span data-stu-id="2673c-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="2673c-126">La base de datos Northwind no tiene ninguna columna calculada por lo que necesitamos agregar una nosotros mismos.</span><span class="sxs-lookup"><span data-stu-id="2673c-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="2673c-127">Para este tutorial permite s Agregar una columna calculada a la `Suppliers` tabla denominada `FullContactName` que devuelve el nombre de contacto s, título y la compañía que trabajan para el siguiente formato: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="2673c-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="2673c-128">Esto calcula la columna podría utilizarse en los informes al mostrar información sobre los proveedores.</span><span class="sxs-lookup"><span data-stu-id="2673c-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="2673c-129">Comience abriendo la `Suppliers` definición de tabla con el botón secundario en el `Suppliers` de tabla en el Explorador de servidores y elija Abrir definición de tabla en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="2673c-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="2673c-130">Esto mostrará las columnas de la tabla y sus propiedades, como su tipo de datos, si permiten `NULL` s y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="2673c-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="2673c-131">Para agregar una columna calculada, empiece escribiendo el nombre de la columna en la definición de tabla.</span><span class="sxs-lookup"><span data-stu-id="2673c-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="2673c-132">A continuación, escriba la expresión en el cuadro de texto (fórmula) en la sección de la especificación de columna calculada en la ventana Propiedades de columna (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="2673c-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="2673c-133">Nombre de la columna calculada `FullContactName` y utilice la siguiente expresión:</span><span class="sxs-lookup"><span data-stu-id="2673c-133">Name the computed column `FullContactName` and use the following expression:</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample1.sql)]

<span data-ttu-id="2673c-134">Tenga en cuenta que se pueden concatenar cadenas en SQL mediante el `+` operador.</span><span class="sxs-lookup"><span data-stu-id="2673c-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="2673c-135">El `CASE` instrucción se puede usar como una instrucción condicional en un lenguaje de programación tradicional.</span><span class="sxs-lookup"><span data-stu-id="2673c-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="2673c-136">En la expresión anterior el `CASE` instrucción se puede leer como: Si `ContactTitle` no `NULL` de salida, a continuación, el `ContactTitle` valor concatenado con una coma, en caso contrario, emitir nada.</span><span class="sxs-lookup"><span data-stu-id="2673c-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="2673c-137">Para obtener más información sobre la utilidad de la `CASE` instrucción, consulte [la potencia de SQL `CASE` instrucciones](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="2673c-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="2673c-138">En lugar de usar un `CASE` instrucción aquí, podríamos haber también usado `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="2673c-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="2673c-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) Devuelve *checkExpression* si es distinto de NULL, de lo contrario devuelve *replacementValue*.</span><span class="sxs-lookup"><span data-stu-id="2673c-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="2673c-140">Aunque cualquiera `ISNULL` o `CASE` funcionará en este caso, existen escenarios más complejos donde la flexibilidad de la `CASE` instrucción no puede coincidir con `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="2673c-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>


<span data-ttu-id="2673c-141">Después de agregar esta columna calculada, la pantalla debería parecerse a la pantalla en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="2673c-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>


<span data-ttu-id="2673c-142">[![Agregar una columna calculada denominada FullContactName a la tabla Suppliers](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="2673c-143">**Figura 1**: Agregar una columna calculada denominada `FullContactName` a la `Suppliers` tabla ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-vb/_static/image3.png))</span></span>


<span data-ttu-id="2673c-144">Después de la columna calculada de nomenclatura y especificar su expresión, guardar los cambios en la tabla haciendo clic en el icono Guardar en la barra de herramientas, presionando Ctrl + S o, en el menú archivo y elija Guardar `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="2673c-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="2673c-145">Guardar la tabla debe actualizar el Explorador de servidores, incluida la columna recién agregados en el `Suppliers` lista de columnas de la tabla s.</span><span class="sxs-lookup"><span data-stu-id="2673c-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="2673c-146">Además, se ajustará automáticamente la expresión escrita en el cuadro de texto (fórmula) en una expresión equivalente que elimina espacios en blanco innecesarios, rodea los nombres de columna entre corchetes (`[]`) e incluye los paréntesis para mostrar más explícitamente el orden de operaciones:</span><span class="sxs-lookup"><span data-stu-id="2673c-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample2.sql)]

<span data-ttu-id="2673c-147">Para obtener más información sobre las columnas calculadas de Microsoft SQL Server, consulte el [documentación técnica](https://msdn.microsoft.com/library/ms191250.aspx).</span><span class="sxs-lookup"><span data-stu-id="2673c-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="2673c-148">Consulte también el [Cómo: Especificar columnas calculadas](https://msdn.microsoft.com/library/ms188300.aspx) para ver un tutorial paso a paso de creación de columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="2673c-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="2673c-149">De forma predeterminada, las columnas calculadas no se almacenan físicamente en la tabla, pero en su lugar, se vuelven a calcular cada vez que se hace referencia a una consulta.</span><span class="sxs-lookup"><span data-stu-id="2673c-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="2673c-150">Activando la casilla de verificación se conserva, sin embargo, puede indicar a SQL Server para almacenar físicamente la columna calculada en la tabla.</span><span class="sxs-lookup"><span data-stu-id="2673c-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="2673c-151">Esto permite que un índice que se crearán en la columna calculada, lo que puede mejorar el rendimiento de las consultas que utilizan el valor de columna calculada en sus `WHERE` cláusulas.</span><span class="sxs-lookup"><span data-stu-id="2673c-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="2673c-152">Consulte [crear índices en columnas calculadas](https://msdn.microsoft.com/library/ms189292.aspx) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="2673c-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>


## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="2673c-153">Paso 2: Visualización de los valores de columna calculada s</span><span class="sxs-lookup"><span data-stu-id="2673c-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="2673c-154">Antes de que se inicia el trabajo en la capa de acceso a datos, permiten s Tómese un minuto para ver el `FullContactName` valores.</span><span class="sxs-lookup"><span data-stu-id="2673c-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="2673c-155">Desde el Explorador de servidores, haga doble clic en el `Suppliers` nombre de la tabla y elija la nueva consulta en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="2673c-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="2673c-156">Se abrirá una ventana de consulta que nos pedirá que elija qué tablas se deben incluir en la consulta.</span><span class="sxs-lookup"><span data-stu-id="2673c-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="2673c-157">Agregue el `Suppliers` de tabla y haga clic en Cerrar.</span><span class="sxs-lookup"><span data-stu-id="2673c-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="2673c-158">A continuación, compruebe el `CompanyName`, `ContactName`, `ContactTitle`, y `FullContactName` las columnas de la tabla Suppliers.</span><span class="sxs-lookup"><span data-stu-id="2673c-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="2673c-159">Por último, haga clic en el icono de exclamación rojo en la barra de herramientas para ejecutar la consulta y ver los resultados.</span><span class="sxs-lookup"><span data-stu-id="2673c-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="2673c-160">Como se muestra en la figura 2, los resultados incluyen `FullContactName`, que muestra la `CompanyName`, `ContactName`, y `ContactTitle` columnas con el formato `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="2673c-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>


<span data-ttu-id="2673c-161">[![El FullContactName utiliza formato ContactName (título de contacto, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="2673c-162">**Figura 2**: El `FullContactName` utiliza el formato `ContactName` (`ContactTitle`, `CompanyName`) ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-vb/_static/image6.png))</span></span>


## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="2673c-163">Paso 3: Agregar el`SuppliersTableAdapter`a la capa de acceso a datos</span><span class="sxs-lookup"><span data-stu-id="2673c-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="2673c-164">Para trabajar con la información del proveedor en nuestra aplicación es necesario crear primero un TableAdapter y DataTable en nuestro DAL.</span><span class="sxs-lookup"><span data-stu-id="2673c-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="2673c-165">Idealmente, esto se logra utilizando los mismos pasos sencillo examinados en los tutoriales anteriores.</span><span class="sxs-lookup"><span data-stu-id="2673c-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="2673c-166">Sin embargo, trabajar con columnas calculadas presenta unas arrugas que merecen explicación.</span><span class="sxs-lookup"><span data-stu-id="2673c-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="2673c-167">Si utiliza un TableAdapter utiliza instrucciones SQL ad hoc, simplemente puede incluir la columna calculada en la consulta principal de TableAdapter s mediante el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2673c-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="2673c-168">Esto, sin embargo, generará automáticamente `INSERT` y `UPDATE` las instrucciones que incluyan la columna calculada.</span><span class="sxs-lookup"><span data-stu-id="2673c-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="2673c-169">Si intenta ejecutar uno de estos métodos, un `SqlException` con el mensaje de la columna *ColumnName* no se puede modificar porque es una columna calculada o se producirá el resultado de un operador UNION.</span><span class="sxs-lookup"><span data-stu-id="2673c-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="2673c-170">Mientras el `INSERT` y `UPDATE` instrucción se puede ajustar manualmente a través de los TableAdapters `InsertCommand` y `UpdateCommand` propiedades, estas personalizaciones se perderán cuando se vuelve a ejecutar el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2673c-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="2673c-171">Debido a la fragilidad de los TableAdapter utiliza instrucciones SQL ad hoc, se recomienda que usamos los procedimientos almacenados cuando se trabaja con columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="2673c-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="2673c-172">Si utiliza procedimientos almacenados existentes, simplemente configure TableAdapter como se describe en el [utilizando procedimientos almacenados existentes para la s de conjunto de datos con tipo TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="2673c-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="2673c-173">Sin embargo, si tiene el Asistente de TableAdapter para crear los procedimientos almacenados para usted, es importante inicialmente omitir las columnas calculadas de la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="2673c-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="2673c-174">Si incluye una columna calculada en la consulta principal, el Asistente para configuración de TableAdapter le informará, tras la finalización, que no puede crear los procedimientos almacenados correspondientes.</span><span class="sxs-lookup"><span data-stu-id="2673c-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="2673c-175">En resumen, es necesario configurar inicialmente el TableAdapter utilizando una consulta principal libre de columnas calculada y, a continuación, actualice manualmente el procedimiento almacenado correspondiente y los TableAdapters `SelectCommand` para incluir la columna calculada.</span><span class="sxs-lookup"><span data-stu-id="2673c-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="2673c-176">Este enfoque es similar al utilizado en el [actualizar TableAdapter para usar](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span><span class="sxs-lookup"><span data-stu-id="2673c-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="2673c-177">Para este tutorial, permiten s Agregar un nuevo TableAdapter y hacer que se cree automáticamente los procedimientos almacenados para nosotros.</span><span class="sxs-lookup"><span data-stu-id="2673c-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="2673c-178">Por lo tanto, tendremos que inicialmente se omite la `FullContactName` columna calculada de la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="2673c-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="2673c-179">Comience abriendo la `NorthwindWithSprocs` conjunto de datos en el `~/App_Code/DAL` carpeta.</span><span class="sxs-lookup"><span data-stu-id="2673c-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="2673c-180">Haga clic en el diseñador y, en el menú contextual, elija Agregar un nuevo TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2673c-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="2673c-181">Esto iniciará al Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2673c-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="2673c-182">Especificar la base de datos para consultar datos desde (`NORTHWNDConnectionString` desde `Web.config`) y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="2673c-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="2673c-183">Dado que no hemos creado todavía ningún procedimiento almacenado para consultar o modificar el `Suppliers` tabla, seleccione el crear nuevos procedimientos almacenados de opción para que el asistente crea para nosotros y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="2673c-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>


<span data-ttu-id="2673c-184">[![Elija los procedimientos almacenados nueva opción de crear](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="2673c-185">**Figura 3**: Elija los procedimientos almacenados nueva opción de crear ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image9.png))</span></span>


<span data-ttu-id="2673c-186">El paso posterior nos pide la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="2673c-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="2673c-187">Escriba la siguiente consulta, que devuelve el `SupplierID`, `CompanyName`, `ContactName`, y `ContactTitle` columnas para cada proveedor.</span><span class="sxs-lookup"><span data-stu-id="2673c-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="2673c-188">Tenga en cuenta que esta consulta intencionadamente omite la columna calculada (`FullContactName`); se actualizará el procedimiento almacenado correspondiente para incluir esta columna en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="2673c-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample3.sql)]

<span data-ttu-id="2673c-189">Después de escribir la consulta principal y hacer clic en siguiente, el Asistente nos permite nombrar los cuatro procedimientos almacenados que generará.</span><span class="sxs-lookup"><span data-stu-id="2673c-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="2673c-190">Nombre de estos procedimientos almacenados `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, y `Suppliers_Delete`, como se muestra en la figura 4.</span><span class="sxs-lookup"><span data-stu-id="2673c-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>


<span data-ttu-id="2673c-191">[![Personalizar los nombres de los procedimientos almacenados generados automáticamente](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="2673c-192">**Figura 4**: Personalizar los nombres de los procedimientos almacenados de Auto-Generated ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-vb/_static/image12.png))</span></span>


<span data-ttu-id="2673c-193">El siguiente paso del asistente nos permite a los métodos de TableAdapter s el nombre y especifique los patrones que se usa para obtener acceso y actualizar los datos.</span><span class="sxs-lookup"><span data-stu-id="2673c-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="2673c-194">Deje todas las tres casillas de verificación activadas, pero cambie el nombre de la `GetData` método `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="2673c-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="2673c-195">Haga clic en Finalizar para completar al asistente.</span><span class="sxs-lookup"><span data-stu-id="2673c-195">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="2673c-196">[![Cambie el nombre del método GetData a GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="2673c-197">**Figura 5**: Cambiar el nombre de la `GetData` método `GetSuppliers` ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-vb/_static/image15.png))</span></span>


<span data-ttu-id="2673c-198">Al hacer clic en Finalizar, el asistente creará los cuatro procedimientos almacenados y agregar el TableAdapter y la correspondiente DataTable al conjunto de datos con tipo.</span><span class="sxs-lookup"><span data-stu-id="2673c-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="2673c-199">Paso 4: Incluir la columna calculada en la consulta principal de TableAdapter s</span><span class="sxs-lookup"><span data-stu-id="2673c-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="2673c-200">Ahora necesitamos actualizar TableAdapter y DataTable que creó en el paso 3 para incluir la `FullContactName` columna calculada.</span><span class="sxs-lookup"><span data-stu-id="2673c-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="2673c-201">Esto implica dos pasos:</span><span class="sxs-lookup"><span data-stu-id="2673c-201">This involves two steps:</span></span>

1. <span data-ttu-id="2673c-202">Actualizando el `Suppliers_Select` procedimiento almacenado para devolver el `FullContactName` columna calculada, y</span><span class="sxs-lookup"><span data-stu-id="2673c-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="2673c-203">Actualizar para incluir la correspondiente DataTable `FullContactName` columna.</span><span class="sxs-lookup"><span data-stu-id="2673c-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="2673c-204">Comience por navegar en el Explorador de servidores y explore en profundidad la carpeta procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="2673c-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="2673c-205">Abra el `Suppliers_Select` procedimiento almacenado y actualización de la `SELECT` consulta incluya el `FullContactName` columna calculada:</span><span class="sxs-lookup"><span data-stu-id="2673c-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample4.sql)]

<span data-ttu-id="2673c-206">Guardar los cambios en el procedimiento almacenado, haga clic en el icono Guardar en la barra de herramientas, presionando Ctrl + S o eligiendo el guardar `Suppliers_Select` opción en el menú archivo.</span><span class="sxs-lookup"><span data-stu-id="2673c-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="2673c-207">A continuación, vuelva al diseñador de DataSet, haga doble clic en el `SuppliersTableAdapter`y elija Configurar en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="2673c-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="2673c-208">Tenga en cuenta que el `Suppliers_Select` columna ahora incluye la `FullContactName` columna en su colección de columnas de datos.</span><span class="sxs-lookup"><span data-stu-id="2673c-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>


<span data-ttu-id="2673c-209">[![Ejecute el Asistente para configuración de TableAdapter s para actualizar las columnas de DataTable s](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="2673c-210">**Figura 6**: Ejecute el Asistente para configuración para actualizar las columnas de DataTable s s de TableAdapter ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-vb/_static/image18.png))</span></span>


<span data-ttu-id="2673c-211">Haga clic en Finalizar para completar al asistente.</span><span class="sxs-lookup"><span data-stu-id="2673c-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="2673c-212">Esto agregará automáticamente una columna correspondiente a la `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="2673c-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="2673c-213">El Asistente de TableAdapter es lo suficientemente inteligente como para detectar que la `FullContactName` columna es una columna calculada y, por tanto, de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="2673c-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="2673c-214">Por lo tanto, Establece la columna s `ReadOnly` propiedad `true`.</span><span class="sxs-lookup"><span data-stu-id="2673c-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="2673c-215">Para comprobarlo, seleccione la columna de la `SuppliersDataTable` y, a continuación, vaya a la ventana Propiedades (consulte la figura 7).</span><span class="sxs-lookup"><span data-stu-id="2673c-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="2673c-216">Tenga en cuenta que el `FullContactName` columna s `DataType` y `MaxLength` propiedades también se establecen en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="2673c-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>


<span data-ttu-id="2673c-217">[![La columna FullContactName está marcada como de solo lectura](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span></span>

<span data-ttu-id="2673c-218">**Figura 7**: El `FullContactName` columna está marcada como de solo lectura ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-vb/_static/image21.png))</span></span>


## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="2673c-219">Paso 5: Agregar un`GetSupplierBySupplierID`método a TableAdapter</span><span class="sxs-lookup"><span data-stu-id="2673c-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="2673c-220">En este tutorial crearemos una página ASP.NET que muestra los proveedores en una cuadrícula actualizable.</span><span class="sxs-lookup"><span data-stu-id="2673c-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="2673c-221">En más allá de los tutoriales hemos actualizado un único registro de la capa de lógica empresarial mediante la recuperación que realizar una copia en la capa DAL para propagar los cambios en registro concreto de la capa DAL como DataTable fuertemente tipado, actualizar sus propiedades y, a continuación, enviar la DataTable actualizada la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2673c-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="2673c-222">Para lograr este primer paso - recuperar del registro que se va a actualizar desde la capa DAL: tenemos que agregar primero un `GetSupplierBySupplierID(supplierID)` método a la capa DAL.</span><span class="sxs-lookup"><span data-stu-id="2673c-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="2673c-223">Haga doble clic en el `SuppliersTableAdapter` en el diseño de conjunto de datos y elija la opción de Agregar consulta en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="2673c-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="2673c-224">Como hicimos en el paso 3, permiten el Asistente para generar un nuevo procedimiento almacenado para que podamos seleccionando la opción de crear nuevo procedimiento almacenado (consulte la vuelta a la figura 3 para captura de pantalla de este paso del asistente).</span><span class="sxs-lookup"><span data-stu-id="2673c-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="2673c-225">Puesto que este método devolverá un registro con varias columnas, indican que desea usar una consulta SQL que es una instrucción SELECT que devuelve filas y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="2673c-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>


<span data-ttu-id="2673c-226">[![Elija la selección que devuelve filas, opción](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span></span>

<span data-ttu-id="2673c-227">**Figura 8**: Elija la selección que devuelve filas opción ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image24.png))</span></span>


<span data-ttu-id="2673c-228">El paso posterior nos pedirá para la consulta que se utilizará para este método.</span><span class="sxs-lookup"><span data-stu-id="2673c-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="2673c-229">Escriba lo siguiente, que devuelve los mismos campos de datos como la consulta principal, pero de un determinado proveedor.</span><span class="sxs-lookup"><span data-stu-id="2673c-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>


[!code-sql[Main](working-with-computed-columns-vb/samples/sample5.sql)]

<span data-ttu-id="2673c-230">La siguiente pantalla nos pide el nombre del procedimiento almacenado que se generarán automáticamente.</span><span class="sxs-lookup"><span data-stu-id="2673c-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="2673c-231">Nombre de este procedimiento almacenado `Suppliers_SelectBySupplierID` y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="2673c-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>


<span data-ttu-id="2673c-232">[![Nombre del procedimiento almacenado de Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span></span>

<span data-ttu-id="2673c-233">**Figura 9**: Nombre del procedimiento almacenado `Suppliers_SelectBySupplierID` ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image27.png))</span></span>


<span data-ttu-id="2673c-234">Por último, las instrucciones del asistente nos para los datos de acceso a patrones y los nombres de método que se usará para el TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2673c-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="2673c-235">Deje ambas casillas seleccionadas, pero cambie el nombre de la `FillBy` y `GetDataBy` métodos para `FillBySupplierID` y `GetSupplierBySupplierID`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="2673c-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>


<span data-ttu-id="2673c-236">[![Nombre de la FillBySupplierID de métodos de TableAdapter y GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span></span>

<span data-ttu-id="2673c-237">**Figura 10**: Nombre de los métodos de TableAdapter `FillBySupplierID` y `GetSupplierBySupplierID` ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image30.png))</span></span>


<span data-ttu-id="2673c-238">Haga clic en Finalizar para completar al asistente.</span><span class="sxs-lookup"><span data-stu-id="2673c-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="2673c-239">Paso 6: Creación de la capa de lógica de negocios</span><span class="sxs-lookup"><span data-stu-id="2673c-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="2673c-240">Antes de crear una página ASP.NET que usa la columna calculada que creó en el paso 1, primero es necesario agregar los métodos correspondientes en la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="2673c-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="2673c-241">Nuestra página ASP.NET, que creamos en el paso 7, permitirá a los usuarios ver y editar los proveedores.</span><span class="sxs-lookup"><span data-stu-id="2673c-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="2673c-242">Por lo tanto, tenemos nuestro BLL proporcionar, como mínimo, un método para obtener todos los proveedores y otro para actualizar un proveedor determinado.</span><span class="sxs-lookup"><span data-stu-id="2673c-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="2673c-243">Crear un nuevo archivo de clase denominado `SuppliersBLLWithSprocs` en el `~/App_Code/BLL` carpeta y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="2673c-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>


[!code-vb[Main](working-with-computed-columns-vb/samples/sample6.vb)]

<span data-ttu-id="2673c-244">Al igual que las clases BLL, `SuppliersBLLWithSprocs` tiene un `Protected` `Adapter` propiedad que devuelve una instancia de la `SuppliersTableAdapter` clase junto con dos `Public` métodos: `GetSuppliers` y `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="2673c-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `Protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `Public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="2673c-245">El `GetSuppliers` método llama y devuelve el `SuppliersDataTable` devuelto por la correspondiente `GetSupplier` método en la capa de acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="2673c-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="2673c-246">El `UpdateSupplier` método recupera información sobre el proveedor particular está actualizando mediante una llamada a la s DAL `GetSupplierBySupplierID(supplierID)` método.</span><span class="sxs-lookup"><span data-stu-id="2673c-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="2673c-247">A continuación, actualiza el `CategoryName`, `ContactName`, y `ContactTitle` propiedades y confirma estos cambios en la base de datos mediante una llamada a la capa de acceso a datos de s `Update` método, pasando el modificado `SuppliersRow` objeto.</span><span class="sxs-lookup"><span data-stu-id="2673c-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="2673c-248">Excepto para `SupplierID` y `CompanyName`, permitir que todas las columnas de la tabla Suppliers `NULL` valores.</span><span class="sxs-lookup"><span data-stu-id="2673c-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="2673c-249">Por lo tanto, si en el pasado `contactName` o `contactTitle` parámetros son `Nothing` es necesario establecer la correspondiente `ContactName` y `ContactTitle` propiedades para un `NULL` valor de base de datos mediante el `SetContactNameNull` y `SetContactTitleNull`métodos, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="2673c-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `Nothing` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>


## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="2673c-250">Paso 7: Trabajar con la columna calculada de la capa de presentación</span><span class="sxs-lookup"><span data-stu-id="2673c-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="2673c-251">Con la columna calculada que se agrega a la `Suppliers` tabla y DAL y BLL se actualizan en consecuencia, estamos preparados crear una página ASP.NET que funciona con la `FullContactName` columna calculada.</span><span class="sxs-lookup"><span data-stu-id="2673c-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="2673c-252">Comience abriendo la `ComputedColumns.aspx` página en el `AdvancedDAL` carpetas y arrastre un control GridView del cuadro de herramientas hasta el diseñador.</span><span class="sxs-lookup"><span data-stu-id="2673c-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="2673c-253">Establezca la s GridView `ID` propiedad `Suppliers` y, en la etiqueta inteligente, de enlazarla a un nuevo origen ObjectDataSource denominado `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="2673c-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="2673c-254">Configurar el origen ObjectDataSource para usar el `SuppliersBLLWithSprocs` clase agregamos copia en el paso 6 y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="2673c-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>


<span data-ttu-id="2673c-255">[![Configurar el origen ObjectDataSource para usar la clase SuppliersBLLWithSprocs](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span></span>

<span data-ttu-id="2673c-256">**Figura 11**: Configurar el origen ObjectDataSource que se usarán el `SuppliersBLLWithSprocs` clase ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-vb/_static/image33.png))</span></span>


<span data-ttu-id="2673c-257">Hay solo dos métodos definidos en el `SuppliersBLLWithSprocs` clase: `GetSuppliers` y `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="2673c-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="2673c-258">Asegúrese de que estos dos métodos se especifican en la instrucción SELECT y UPDATE fichas, respectivamente y haga clic en Finalizar para completar la configuración del origen ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2673c-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="2673c-259">Tras la finalización del Asistente para configuración de orígenes de datos, Visual Studio agregará BoundField para cada uno de los campos de datos devueltos.</span><span class="sxs-lookup"><span data-stu-id="2673c-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="2673c-260">Quitar el `SupplierID` BoundField y cambie el `HeaderText` propiedades de la `CompanyName`, `ContactName`, `ContactTitle`, y `FullContactName` BoundFields para la empresa, póngase en contacto con nombre, título y póngase en contacto con el nombre completo, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="2673c-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="2673c-261">En la etiqueta inteligente, active la casilla Habilitar edición para activar las capacidades de edición de GridView s integradas.</span><span class="sxs-lookup"><span data-stu-id="2673c-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="2673c-262">Además de agregar BoundFields a GridView, finalizar el Asistente de origen de datos también hace que Visual Studio establecer la s ObjectDataSource `OldValuesParameterFormatString` propiedad original\_{0}.</span><span class="sxs-lookup"><span data-stu-id="2673c-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="2673c-263">Revertir esta configuración en su valor predeterminado, {0} .</span><span class="sxs-lookup"><span data-stu-id="2673c-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="2673c-264">Después de realizar estas modificaciones en el control GridView y ObjectDataSource, su marcado declarativo debe tener un aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="2673c-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](working-with-computed-columns-vb/samples/sample7.aspx)]

<span data-ttu-id="2673c-265">A continuación, visite esta página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="2673c-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="2673c-266">Como se muestra en la figura 12, cada proveedor se muestra en una cuadrícula que incluye el `FullContactName` formato de columna, cuyo valor es simplemente la concatenación de las tres columnas `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="2673c-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>


<span data-ttu-id="2673c-267">[![Cada proveedor se muestra en la cuadrícula](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span></span>

<span data-ttu-id="2673c-268">**Figura 12**: Cada proveedor se muestra en la cuadrícula ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-vb/_static/image36.png))</span></span>


<span data-ttu-id="2673c-269">Al hacer clic en el botón Editar para un determinado proveedor produce un postback y presenta esa fila en su edición de la interfaz (consulte la figura 13).</span><span class="sxs-lookup"><span data-stu-id="2673c-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="2673c-270">Las tres primeras columnas se representan en su interfaz de edición de predeterminado: control de un cuadro de texto cuya `Text` propiedad está establecida en el valor del campo de datos.</span><span class="sxs-lookup"><span data-stu-id="2673c-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="2673c-271">La `FullContactName` columna, sin embargo, permanece como texto.</span><span class="sxs-lookup"><span data-stu-id="2673c-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="2673c-272">Cuando el BoundFields se agregaron en el control GridView en la finalización del Asistente para configuración de orígenes de datos, el `FullContactName` BoundField s `ReadOnly` propiedad se estableció en `True` porque correspondiente `FullContactName` columna en el `SuppliersDataTable` tiene su `ReadOnly` propiedad establecida en `True`.</span><span class="sxs-lookup"><span data-stu-id="2673c-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `True` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `True`.</span></span> <span data-ttu-id="2673c-273">Como se indicó en el paso 4, el `FullContactName` s `ReadOnly` propiedad se estableció en `True` porque el TableAdapter detectó que la columna es una columna calculada.</span><span class="sxs-lookup"><span data-stu-id="2673c-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `True` because the TableAdapter detected that the column was a computed column.</span></span>


<span data-ttu-id="2673c-274">[![La columna FullContactName no es modificable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="2673c-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span></span>

<span data-ttu-id="2673c-275">**Figura 13**: El `FullContactName` columna no es modificable ([haga clic aquí para ver imagen en tamaño completo](working-with-computed-columns-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="2673c-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-vb/_static/image39.png))</span></span>


<span data-ttu-id="2673c-276">Siga adelante y actualizar el valor de una o varias de las columnas que se puede editables y haga clic en actualizar.</span><span class="sxs-lookup"><span data-stu-id="2673c-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="2673c-277">Tenga en cuenta cómo el `FullContactName` valor s se actualiza automáticamente para reflejar el cambio.</span><span class="sxs-lookup"><span data-stu-id="2673c-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="2673c-278">GridView actualmente usa BoundFields para los campos editables, lo que en la interfaz de edición de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="2673c-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="2673c-279">Puesto que el `CompanyName` campo es obligatorio, se debe convertir en TemplateField que incluye un control RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="2673c-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="2673c-280">Dejar como un ejercicio para el lector interesado.</span><span class="sxs-lookup"><span data-stu-id="2673c-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="2673c-281">Consulte la [agregar controles de validación a las Interfaces de inserción y edición](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial para obtener instrucciones paso a paso sobre convertir BoundField en TemplateField y agregar controles de validación.</span><span class="sxs-lookup"><span data-stu-id="2673c-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>


## <a name="summary"></a><span data-ttu-id="2673c-282">Resumen</span><span class="sxs-lookup"><span data-stu-id="2673c-282">Summary</span></span>

<span data-ttu-id="2673c-283">Al definir el esquema para una tabla, Microsoft SQL Server permite la inclusión de columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="2673c-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="2673c-284">Estas son columnas cuyos valores se calculan a partir de una expresión que normalmente hace referencia a los valores de otras columnas en el mismo registro.</span><span class="sxs-lookup"><span data-stu-id="2673c-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="2673c-285">Desde los valores para las columnas calculadas se basan en una expresión, que son de solo lectura y no se puede asignar un valor en un `INSERT` o `UPDATE` instrucción.</span><span class="sxs-lookup"><span data-stu-id="2673c-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="2673c-286">Esto presenta desafíos cuando se usa una columna calculada en la consulta principal de un TableAdapter que intenta generar automáticamente correspondiente `INSERT`, `UPDATE`, y `DELETE` instrucciones.</span><span class="sxs-lookup"><span data-stu-id="2673c-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="2673c-287">En este tutorial se describen técnicas para sortear los desafíos que suponen las columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="2673c-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="2673c-288">En concreto, hemos usado los procedimientos almacenados en nuestra TableAdapter para superar la fragilidad inherente en los TableAdapter utiliza instrucciones SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="2673c-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="2673c-289">Al tener el Asistente de TableAdapter para crear nuevos procedimientos almacenados, es importante que tenemos la consulta principal inicialmente omitir ninguna columna calculada porque su presencia impide que los procedimientos almacenados de modificación de datos que se está generando.</span><span class="sxs-lookup"><span data-stu-id="2673c-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="2673c-290">Después de que el TableAdapter se ha configurado inicialmente, su `SelectCommand` procedimiento almacenado puede ser reformó para incluir las columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="2673c-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="2673c-291">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="2673c-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2673c-292">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="2673c-292">About the Author</span></span>

<span data-ttu-id="2673c-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), trabaja con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="2673c-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2673c-294">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="2673c-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2673c-295">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2673c-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2673c-296">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2673c-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2673c-297">o a través de su blog, que puede encontrarse en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2673c-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2673c-298">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="2673c-298">Special Thanks To</span></span>

<span data-ttu-id="2673c-299">Esta serie de tutoriales ha sido revisada por muchos revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="2673c-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2673c-300">Los revisores para este tutorial fueron Hilton Geisenow y Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="2673c-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="2673c-301">¿Está interesado en leer mi próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="2673c-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2673c-302">Si es así, envíeme una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2673c-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2673c-303">[Anterior](adding-additional-datatable-columns-vb.md)
> [Siguiente](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2673c-303">[Previous](adding-additional-datatable-columns-vb.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span></span>

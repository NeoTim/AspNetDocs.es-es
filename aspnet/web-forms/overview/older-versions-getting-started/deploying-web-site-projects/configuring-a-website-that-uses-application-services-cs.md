---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-cs
title: Configurar un sitio Web que usa servicios de aplicaciones (C#) | Microsoft Docs
author: rick-anderson
description: Versión ASP.NET 2.0 incorporó una serie de servicios de aplicación, que forman parte de .NET Framework y servir como un conjunto de bloques de creación de servicios que yo...
ms.author: riande
ms.date: 04/23/2009
ms.assetid: 1e33d1c6-3f9f-4c26-81e2-2a8f8907bb05
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-cs
msc.type: authoredcontent
ms.openlocfilehash: fe6097c32e4584fd4c577fb8d2afee9b3483c22f
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/17/2019
ms.locfileid: "59418422"
---
# <a name="configuring-a-website-that-uses-application-services-c"></a><span data-ttu-id="a5f6b-103">Configurar un sitio web que usa servicios de aplicaciones (C#)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-103">Configuring a Website that Uses Application Services (C#)</span></span>

<span data-ttu-id="a5f6b-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a5f6b-105">[Descargar código](http://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_CS.zip) o [descargar PDF](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-105">[Download Code](http://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_CS.zip) or [Download PDF](http://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_cs.pdf)</span></span>

> <span data-ttu-id="a5f6b-106">Versión ASP.NET 2.0 incorporó una serie de servicios de aplicación, que forman parte de .NET Framework y actuar como un conjunto de servicios de bloques de creación que puede usar para agregarle funciones enriquecidas para la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-106">ASP.NET version 2.0 introduced a series of application services, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="a5f6b-107">Este tutorial explora cómo configurar un sitio Web en el entorno de producción para usar servicios de aplicaciones y trata los problemas comunes con la administración de cuentas de usuario y funciones en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-107">This tutorial explores how to configure a website in the production environment to use application services and addresses common issues with managing user accounts and roles on the production environment.</span></span>


## <a name="introduction"></a><span data-ttu-id="a5f6b-108">Introducción</span><span class="sxs-lookup"><span data-stu-id="a5f6b-108">Introduction</span></span>

<span data-ttu-id="a5f6b-109">Versión ASP.NET 2.0 incorporó una serie de *servicios de aplicación*, que forman parte de .NET Framework y servir como un conjunto de bloques de creación de servicios que se puede usar para agregar funciones enriquecidas para la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-109">ASP.NET version 2.0 introduced a series of *application services*, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="a5f6b-110">Los servicios de aplicación incluyen:</span><span class="sxs-lookup"><span data-stu-id="a5f6b-110">The application services include:</span></span>

- <span data-ttu-id="a5f6b-111">**Pertenencia** : una API para crear y administrar cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-111">**Membership** - an API for creating and managing user accounts.</span></span>
- <span data-ttu-id="a5f6b-112">**Roles** : una API para clasificar a los usuarios en grupos.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-112">**Roles** - an API for categorizing users into groups.</span></span>
- <span data-ttu-id="a5f6b-113">**Perfil** : una API para almacenar el contenido personalizado, específicos del usuario.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-113">**Profile** - an API for storing custom, user-specific content.</span></span>
- <span data-ttu-id="a5f6b-114">**Mapa del sitio** : una API para definir una estructura lógica del sitio s en forma de una jerarquía, lo que, a continuación, se puede mostrar a través de los controles de navegación, como menús y las rutas de navegación.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-114">**Site Map** - an API for defining a site s logical structure in the form of a hierarchy, which can then be displayed via navigation controls, such as menus and breadcrumbs.</span></span>
- <span data-ttu-id="a5f6b-115">**Personalización** : una API para el mantenimiento de las preferencias de personalización, se utiliza frecuentemente con [ *WebParts*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-115">**Personalization** - an API for maintaining customization preferences, most often used with [*WebParts*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span></span>
- <span data-ttu-id="a5f6b-116">**Seguimiento de estado** : una API para la supervisión de rendimiento, seguridad, errores y otras métricas de mantenimiento del sistema para una aplicación web en ejecución.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-116">**Health Monitoring** - an API for monitoring performance, security, errors, and other system health metrics for a running web application.</span></span>
  

<span data-ttu-id="a5f6b-117">Las API de servicios de aplicación no están asociadas a una implementación específica.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-117">The application services APIs are not tied to a specific implementation.</span></span> <span data-ttu-id="a5f6b-118">En su lugar, indicar a los servicios de aplicación para usar un determinado *proveedor*, y dicho proveedor implementa el servicio mediante una tecnología determinada.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-118">Instead, you instruct the application services to use a particular *provider*, and that provider implements the service using a particular technology.</span></span> <span data-ttu-id="a5f6b-119">Los proveedores más populares para aplicaciones web basadas en Internet hospedadas en una empresa de hospedaje web son los proveedores que utilizan una implementación de la base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-119">The most commonly used providers for Internet-based web applications hosted at a web hosting company are those providers that use a SQL Server database implementation.</span></span> <span data-ttu-id="a5f6b-120">Por ejemplo, el `SqlMembershipProvider` es un proveedor para la API de pertenencia que almacena información de la cuenta de usuario en una base de datos de Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-120">For example, the `SqlMembershipProvider` is a provider for the Membership API that stores user account information in a Microsoft SQL Server database.</span></span>

<span data-ttu-id="a5f6b-121">Mediante los servicios de aplicación y los proveedores de SQL Server agrega algunas dificultades al implementar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-121">Using the application services and SQL Server providers adds some challenges when deploying the application.</span></span> <span data-ttu-id="a5f6b-122">Para empezar, los objetos de base de datos de servicios de aplicación deben crearse correctamente en el desarrollo y producción de bases de datos e inicializó correctamente.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-122">For starters, the application services database objects must be properly created on both the development and production databases and appropriately initialized.</span></span> <span data-ttu-id="a5f6b-123">También hay opciones de configuración importantes que deben realizarse.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-123">There are also important configuration settings that need to be made.</span></span>

> [!NOTE]
> <span data-ttu-id="a5f6b-124">Los servicios de aplicaciones API se han diseñado mediante el [ *modelo de proveedor*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), un patrón de diseño que permite a los detalles de implementación debe proporcionarse en tiempo de ejecución de una API s.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-124">The application services APIs were designed using the [*provider model*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), a design pattern that allows for an API s implementation details to be provided at runtime.</span></span> <span data-ttu-id="a5f6b-125">.NET Framework se distribuye con un número de proveedores de servicios de aplicación que se pueden usar, como la `SqlMembershipProvider` y `SqlRoleProvider`, que son proveedores de pertenencia y de implementación de base de datos de las API de Roles que usan un servidor SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-125">The .NET Framework ships with a number of application service providers that can be used, such as the `SqlMembershipProvider` and `SqlRoleProvider`, which are providers for the Membership and Roles APIs that use a SQL Server database implementation.</span></span> <span data-ttu-id="a5f6b-126">También puede crear y complemento un proveedor personalizado.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-126">You can also create and plug-in a custom provider.</span></span> <span data-ttu-id="a5f6b-127">De hecho, la aplicación de web reseñas de libros ya contiene un proveedor personalizado para la API de mapa del sitio (`ReviewSiteMapProvider`), que construye el mapa del sitio de los datos en el `Genres` y `Books` tablas en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-127">In fact, the Book Reviews web application already contains a custom provider for the Site Map API (`ReviewSiteMapProvider`), which constructs the site map from the data in the `Genres` and `Books` tables in the database.</span></span>


<span data-ttu-id="a5f6b-128">Este tutorial comienza con un vistazo a cómo ampliar la aplicación web de reseñas de libros para usar las API de Roles y pertenencia.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-128">This tutorial starts with a look at how I extended the Book Reviews web application to use the Membership and Roles APIs.</span></span> <span data-ttu-id="a5f6b-129">A continuación, le guía a través de la implementación de una aplicación web que usa servicios de aplicaciones con una implementación de la base de datos de SQL Server y concluye con la solución de problemas comunes con la administración de cuentas de usuario y funciones en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-129">It then walks through deploying a web application that uses application services with a SQL Server database implementation, and concludes by addressing common issues with managing user accounts and roles on the production environment.</span></span>

## <a name="updates-to-the-book-reviews-application"></a><span data-ttu-id="a5f6b-130">Actualizaciones de la aplicación de revisiones de libro</span><span class="sxs-lookup"><span data-stu-id="a5f6b-130">Updates to the Book Reviews Application</span></span>

<span data-ttu-id="a5f6b-131">En los últimos tutoriales de que la aplicación web revisa el libro se ha actualizado de un sitio Web estático a una aplicación web dinámica controlada por datos se complete con un conjunto de páginas de administración para la administración de revisiones y géneros.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-131">Over the past couple tutorials the Book Reviews web application was updated from a static website to a dynamic, data-driven web application complete with a set of administration pages for managing genres and reviews.</span></span> <span data-ttu-id="a5f6b-132">Sin embargo, esta sección de administración no está protegida actualmente, cualquier usuario que sepa (o averiguará) la dirección URL de página de administración puede moverse alegremente en y crear, editar o eliminar las revisiones en nuestro sitio.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-132">However, this administration section is currently not protected - any user who knows (or guesses) the administration page URL can waltz in and create, edit, or delete reviews on our site.</span></span> <span data-ttu-id="a5f6b-133">Una forma habitual de proteger determinadas partes de un sitio Web es implementar cuentas de usuario y, a continuación, utilizar las reglas de autorización de dirección URL para restringir el acceso a determinados usuarios o roles.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-133">A common way to protect certain portions of a website is to implement user accounts and then use URL authorization rules to restrict access to certain users or roles.</span></span> <span data-ttu-id="a5f6b-134">La aplicación web de reseñas de libros disponible para su descarga con este tutorial es compatible con cuentas de usuario y funciones.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-134">The Book Reviews web application available for download with this tutorial supports user accounts and roles.</span></span> <span data-ttu-id="a5f6b-135">Tiene un solo rol definido denominado administrador y solo los usuarios de este rol pueden tener acceso a las páginas de administración.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-135">It has a single role defined named Admin and only users in this role can access the administration pages.</span></span>

> [!NOTE]
> <span data-ttu-id="a5f6b-136">Se ve crea tres cuentas de usuario en la aplicación web de reseñas de libros: Scott, Jisun y Alice.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-136">I ve created three user accounts in the Book Reviews web application: Scott, Jisun, and Alice.</span></span> <span data-ttu-id="a5f6b-137">Tres todos los usuarios tienen la misma contraseña: **contraseña!**</span><span class="sxs-lookup"><span data-stu-id="a5f6b-137">All three users have the same password: **password!**</span></span> <span data-ttu-id="a5f6b-138">Scott y Jisun están en el rol de administrador, no es de Alice.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-138">Scott and Jisun are in the Admin role, Alice is not.</span></span> <span data-ttu-id="a5f6b-139">Las páginas de administración que no son s sitio siguen siendo accesibles a los usuarios anónimos.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-139">The site s non-administration pages are still accessible to anonymous users.</span></span> <span data-ttu-id="a5f6b-140">Es decir, no es necesario iniciar sesión en el sitio, a menos que desee administrar, en cuyo caso debe iniciar sesión como un usuario en el rol de administrador.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-140">That is, you do not need to sign in to visit the site, unless you want to administer it, in which case you must sign in as a user in the Admin role.</span></span>


<span data-ttu-id="a5f6b-141">La página principal de reseñas de libros aplicación s se ha actualizado para incluir una interfaz de usuario diferente para los usuarios autenticados y anónimos.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-141">The Book Reviews application s master page has been updated to include a different user interface for authenticated and anonymous users.</span></span> <span data-ttu-id="a5f6b-142">Si un usuario anónimo visita el sitio ve un vínculo de inicio de sesión en la esquina superior derecha.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-142">If an anonymous user visits the site she sees a Login link in the upper right corner.</span></span> <span data-ttu-id="a5f6b-143">Un usuario autenticado ve el mensaje, "Bienvenido de nuevo, *username*!"</span><span class="sxs-lookup"><span data-stu-id="a5f6b-143">An authenticated user sees the message, "Welcome back, *username*!"</span></span> <span data-ttu-id="a5f6b-144">y un vínculo para cerrar sesión. Allí s también una página de inicio de sesión (`~/Login.aspx`), que contiene un control Web de inicio de sesión que proporciona la interfaz de usuario y la lógica para autenticar un visitante.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-144">and a link to log out. There s also a login page (`~/Login.aspx`), which contains a Login Web control that provides the user interface and logic for authenticating a visitor.</span></span> <span data-ttu-id="a5f6b-145">Solo los administradores pueden crear nuevas cuentas.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-145">Only administrators can create new accounts.</span></span> <span data-ttu-id="a5f6b-146">(Hay páginas para crear y administrar cuentas de usuario en el `~/Admin` carpeta.)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-146">(There are pages for creating and managing user accounts in the `~/Admin` folder.)</span></span>

### <a name="configuring-the-membership-and-roles-apis"></a><span data-ttu-id="a5f6b-147">Configuración de las API de Roles y pertenencia</span><span class="sxs-lookup"><span data-stu-id="a5f6b-147">Configuring the Membership and Roles APIs</span></span>

<span data-ttu-id="a5f6b-148">La aplicación web de reseñas de libros usa las API de Roles y pertenencia para admitir cuentas de usuario y para agrupar esos usuarios en roles (es decir, el rol de administrador).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-148">The Book Reviews web application uses the Membership and Roles APIs to support user accounts and to group those users into roles (namely, the Admin role).</span></span> <span data-ttu-id="a5f6b-149">El `SqlMembershipProvider` y `SqlRoleProvider` se utilizan las clases de proveedor porque queremos almacenar información de cuenta y el rol en una base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-149">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes are used because we want to store account and role information in a SQL Server database.</span></span>

> [!NOTE]
> <span data-ttu-id="a5f6b-150">En este tutorial no pretende ser un examen detallado en la configuración de una aplicación web para admitir la pertenencia y funciones de API.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-150">This tutorial is not intended to be a detailed examination at configuring a web application to support the Membership and Roles APIs.</span></span> <span data-ttu-id="a5f6b-151">Para una mirada exhaustiva a estas API y los pasos que debe seguir para configurar un sitio Web para poder utilizarlos, lea mi [ *tutoriales de seguridad del sitio Web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-151">For a thorough look at these APIs and the steps you need to take to configure a website to use them, please read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>


<span data-ttu-id="a5f6b-152">Para usar los servicios de aplicación con una base de datos de SQL Server debe agregar primero los objetos de base de datos utilizados por estos proveedores para la base de datos donde desea que la cuenta de usuario y la información de rol almacenada.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-152">To use the application services with a SQL Server database you must first add the database objects used by these providers to the database where you want the user account and role information stored.</span></span> <span data-ttu-id="a5f6b-153">Estos objetos de base de datos necesarios incluyen una serie de tablas, vistas y procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-153">These requisite database objects include a variety of tables, views, and stored procedures.</span></span> <span data-ttu-id="a5f6b-154">A menos que se especifique lo contrario, el `SqlMembershipProvider` y `SqlRoleProvider` clases de proveedor utilizan una base de datos de SQL Server Express Edition denominada `ASPNETDB` ubicado en la aplicación s `App_Data` carpeta; si no existe una base de datos, se crea automáticamente con los objetos de base de datos necesarios por estos proveedores en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-154">Unless specified otherwise, the `SqlMembershipProvider` and `SqlRoleProvider` provider classes use a SQL Server Express Edition database named `ASPNETDB` located in the application s `App_Data` folder; if such a database does not exist, it is automatically created with the necessary database objects by these providers at runtime.</span></span>

<span data-ttu-id="a5f6b-155">Es posible, y servicios de la aplicación normalmente ideal, para crear objetos de base de datos en la misma base de datos donde se almacenan los datos de sitio Web s específicos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-155">It is possible, and usually ideal, to create the application services database objects in the same database where the website s application-specific data is stored.</span></span> <span data-ttu-id="a5f6b-156">.NET Framework incluye una herramienta denominada `aspnet_regsql.exe` que instala los objetos de base de datos en una base de datos especificado.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-156">The .NET Framework ships with a tool named `aspnet_regsql.exe` that installs the database objects on a specified database.</span></span> <span data-ttu-id="a5f6b-157">He continué y usar esta herramienta para agregar estos objetos a la `Reviews.mdf` en la base de datos la `App_Data` carpeta (la base de datos de desarrollo).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-157">I have gone ahead and used this tool to add these objects to the `Reviews.mdf` database in the `App_Data` folder (the development database).</span></span> <span data-ttu-id="a5f6b-158">Veremos cómo usar esta herramienta más adelante en este tutorial, cuando se agregan estos objetos a la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-158">We'll see how to use this tool later in this tutorial when we add these objects to the production database.</span></span>

<span data-ttu-id="a5f6b-159">Si agrega los objetos de base de datos a una base de datos distinto de la aplicación servicios `ASPNETDB` necesite personalizar la `SqlMembershipProvider` y `SqlRoleProvider` configuraciones de clases de proveedor para que usen la base de datos adecuado.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-159">If you add the application services database objects to a database other than `ASPNETDB` you will need to customize the `SqlMembershipProvider` and `SqlRoleProvider` provider classes configurations so that they use the appropriate database.</span></span> <span data-ttu-id="a5f6b-160">Para personalizar agregar el proveedor de pertenencia un [  *&lt;pertenencia&gt; elemento* ](https://msdn.microsoft.com/library/1b9hw62f.aspx) dentro de la `<system.web>` sección `Web.config`; utilice la [  *&lt;roleManager&gt; elemento* ](https://msdn.microsoft.com/library/ms164660.aspx) para configurar el proveedor de Roles.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-160">To customize the Membership provider add a [*&lt;membership&gt; element*](https://msdn.microsoft.com/library/1b9hw62f.aspx) within the `<system.web>` section in `Web.config`; use the [*&lt;roleManager&gt; element*](https://msdn.microsoft.com/library/ms164660.aspx) to configure the Roles provider.</span></span> <span data-ttu-id="a5f6b-161">El fragmento de código siguiente se toma del s aplicación reseñas de libros `Web.config` y muestra las opciones de configuración para la pertenencia y funciones de API.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-161">The following snippet is taken from the Book Reviews application s `Web.config` and shows the configure settings for the Membership and Roles APIs.</span></span> <span data-ttu-id="a5f6b-162">Tenga en cuenta que ambos registren un nuevo proveedor - `ReviewMembership` y `ReviewRole` -que usan el `SqlMembershipProvider` y `SqlRoleProvider` proveedores, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-162">Note that both register a new provider - `ReviewMembership` and `ReviewRole` - that use the `SqlMembershipProvider` and `SqlRoleProvider` providers, respectively.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample1.xml)]

<span data-ttu-id="a5f6b-163">El `Web.config` archivo s `<authentication>` elemento también se ha configurado para admitir la autenticación basada en formularios.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-163">The `Web.config` file s `<authentication>` element has also been configured to support forms-based authentication.</span></span>
  

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample2.xml)]

### <a name="limiting-access-to-the-administration-pages"></a><span data-ttu-id="a5f6b-164">Limitar el acceso a las páginas de administración</span><span class="sxs-lookup"><span data-stu-id="a5f6b-164">Limiting Access to the Administration Pages</span></span>

<span data-ttu-id="a5f6b-165">ASP.NET facilita la tarea conceder o denegar el acceso a un archivo o carpeta determinado usuario o rol a través de su *autorización de URL* característica.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-165">ASP.NET makes it easy to grant or deny access to a particular file or folder by user or by role via its *URL authorization* feature.</span></span> <span data-ttu-id="a5f6b-166">(Hemos explicado brevemente la autorización de URL en el *diferencias principales entre IIS y el servidor de desarrollo de ASP.NET* tutorial y se ha explicado cómo IIS y el servidor de desarrollo de ASP.NET aplican las reglas de autorización de dirección URL diferente para estático en comparación con contenido dinámico.) Puesto que deseamos prohibir el acceso a la `~/Admin` carpeta excepto los usuarios de la función Admin, tenemos que agregar reglas de autorización de dirección URL para esta carpeta.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-166">(We briefly discussed URL authorization in the *Core Differences Between IIS and the ASP.NET Development Server* tutorial and showed how IIS and the ASP.NET Development Server apply URL authorization rules differently for static versus dynamic content.) Because we want to prohibit access to the `~/Admin` folder except for those users in the Admin role, we need to add URL authorization rules to this folder.</span></span> <span data-ttu-id="a5f6b-167">En concreto, las reglas de autorización de dirección URL deben permitir que a los usuarios en el rol de administrador y denegar a todos los otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-167">Specifically, the URL authorization rules need to allow users in the Admin role and deny all other users.</span></span> <span data-ttu-id="a5f6b-168">Esto se logra agregando una `Web.config` del archivo a la `~/Admin` carpeta con el siguiente contenido:</span><span class="sxs-lookup"><span data-stu-id="a5f6b-168">This is accomplished by adding a `Web.config` file to the `~/Admin` folder with the following contents:</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample3.xml)]

<span data-ttu-id="a5f6b-169">Para obtener más información sobre la característica de autorización de URL de ASP.NET s y cómo usarlo para explicar las reglas de autorización para usuarios y roles, no olvide leer el [ *autorización basada en usuario* ](../../older-versions-security/membership/user-based-authorization-cs.md) y [ *Autorización basada en roles* ](../../older-versions-security/roles/role-based-authorization-cs.md) tutoriales desde mi [ *tutoriales de seguridad del sitio Web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-169">For more information on ASP.NET s URL authorization feature and how to use it to spell out authorization rules for users and for roles, be sure to read the [*User-Based Authorization*](../../older-versions-security/membership/user-based-authorization-cs.md) and [*Role-Based Authorization*](../../older-versions-security/roles/role-based-authorization-cs.md) tutorials from my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

## <a name="deploying-a-web-application-that-uses-application-services"></a><span data-ttu-id="a5f6b-170">Implementar una aplicación Web que usa servicios de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="a5f6b-170">Deploying a Web Application That Uses Application Services</span></span>

<span data-ttu-id="a5f6b-171">Al implementar un sitio Web que usa servicios de aplicación y un proveedor que almacena la información de servicios de aplicación en una base de datos, es imperativo que se crean los objetos de base de datos necesarios por los servicios de aplicación en la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-171">When deploying a website that uses application services and a provider that stores the application services information in a database, it is imperative that the database objects needed by the application services be created on the production database.</span></span> <span data-ttu-id="a5f6b-172">Inicialmente la base de datos de producción no contiene estos objetos, lo cuando la aplicación se implementó por primera vez (o cuando se implementa por primera vez después de han agregado los servicios de aplicación), debe seguir pasos adicionales para que estos objetos de base de datos necesarios el base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-172">Initially the production database does not contain these objects, so when the application is first deployed (or when it is deployed for the first time after application services have been added), you must take extra steps to get these requisite database objects on the production database.</span></span>

<span data-ttu-id="a5f6b-173">Otro desafío puede surgir al implementar un sitio Web que usa servicios de aplicaciones si va a replicar las cuentas de usuario creadas en el entorno de desarrollo al entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-173">Another challenge can arise when deploying a website that uses application services if you intend to replicate the user accounts created in the development environment to the production environment.</span></span> <span data-ttu-id="a5f6b-174">Según la configuración de pertenencia y funciones, es posible que incluso si copia correctamente las cuentas de usuario que se crearon en el entorno de desarrollo para la base de datos de producción, estos usuarios no pueden iniciar sesión en la aplicación web en producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-174">Depending on the Membership and Roles configuration, it is possible that even if you successfully copy the user accounts that were created in the development environment to the production database, these users cannot sign into the web application in production.</span></span> <span data-ttu-id="a5f6b-175">Se examinará la causa de este problema y se describe cómo evitar que suceda.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-175">We'll look at the cause of this issue and discuss how to prevent it from happening.</span></span>

<span data-ttu-id="a5f6b-176">ASP.NET incluye una agradable [ *herramienta de administración del sitio Web (WSAT)* ](https://msdn.microsoft.com/library/yy40ytx0.aspx) que pueden iniciarse desde Visual Studio y permite al usuario de cuenta, roles, reglas de autorización y administrarse a través de basada en web interfaz.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-176">ASP.NET ships with a nice [*Web Site Administration Tool (WSAT)*](https://msdn.microsoft.com/library/yy40ytx0.aspx) that can be launched from Visual Studio and allows the user account, roles, and authorization rules to be managed through a web-based interface.</span></span> <span data-ttu-id="a5f6b-177">Lamentablemente, el WSAT solo funciona para los sitios Web locales, lo que significa que no puede utilizarse para administrar las cuentas de usuario, roles y las reglas de autorización para la aplicación web en el entorno de producción de forma remota.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-177">Unfortunately, the WSAT only works for local websites, meaning that it cannot be used to remotely manage user accounts, roles, and authorization rules for the web application in the production environment.</span></span> <span data-ttu-id="a5f6b-178">Veremos diferentes formas de implementar un comportamiento similar a WSAT desde su sitio Web de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-178">We'll look at different ways to implement WSAT-like behavior from your production website.</span></span>

### <a name="adding-the-database-objects-using-aspnetregsqlexe"></a><span data-ttu-id="a5f6b-179">Adición de objetos de base de datos mediante aspnet\_regsql.exe</span><span class="sxs-lookup"><span data-stu-id="a5f6b-179">Adding the Database Objects Using aspnet\_regsql.exe</span></span>

<span data-ttu-id="a5f6b-180">El *implementar una base de datos* tutorial le ha mostrado cómo copiar las tablas y datos de la base de datos de desarrollo para la base de datos de producción, y estas técnicas sin duda pueden utilizarse para copiar los objetos de base de datos de servicios de aplicación del base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-180">The *Deploying a Database* tutorial showed how to copy the tables and data from the development database to the production database, and these techniques can certainly be used to copy the application services database objects to the production database.</span></span> <span data-ttu-id="a5f6b-181">Otra opción es la `aspnet_regsql.exe` herramienta, que agrega o quita los objetos de base de datos de servicios de aplicación de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-181">Another option is the `aspnet_regsql.exe` tool, which adds or removes the application services database objects from a database.</span></span>

> [!NOTE]
> <span data-ttu-id="a5f6b-182">El `aspnet_regsql.exe` herramienta crea los objetos de base de datos en una base de datos especificado.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-182">The `aspnet_regsql.exe` tool creates the database objects on a specified database.</span></span> <span data-ttu-id="a5f6b-183">No migra los datos en los objetos de base de datos de la base de datos de desarrollo para la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-183">It does not migrate data in those database objects from the development database to the production database.</span></span> <span data-ttu-id="a5f6b-184">Si desea copiar la información de cuenta y el rol de usuario de la base de datos de desarrollo en la base de datos de producción, use las técnicas descritas en la *implementar una base de datos* tutorial.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-184">If you mean to copy the user account and role information in the development database to the production database use the techniques covered in the *Deploying a Database* tutorial.</span></span>


<span data-ttu-id="a5f6b-185">Permiten s veamos cómo agregar los objetos de base de datos a la base de datos de producción mediante el `aspnet_regsql.exe` herramienta.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-185">Let s look at how to add the database objects to the production database using the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="a5f6b-186">Iniciar, abrir el Explorador de Windows y navegue hasta el directorio de la versión 2.0 de .NET Framework en el equipo, %WINDIR%\ Microsoft.NET\Framework\v2.0.50727.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-186">Start by opening Windows Explorer and navigating to the .NET Framework version 2.0 directory on your computer, %WINDIR%\ Microsoft.NET\Framework\v2.0.50727.</span></span> <span data-ttu-id="a5f6b-187">Debería encontrar la `aspnet_regsql.exe` herramienta.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-187">There you should find the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="a5f6b-188">Esta herramienta puede usarse desde la línea de comandos, pero también incluye una interfaz gráfica de usuario; Haga doble clic en el `aspnet_regsql.exe` archivo para iniciar el componente de gráficos.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-188">This tool can be used from the command-line, but it also includes a graphical user interface; double-click the `aspnet_regsql.exe` file to launch its graphical component.</span></span>

<span data-ttu-id="a5f6b-189">La herramienta se inicia al mostrar una pantalla de presentación que explica su propósito.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-189">The tool starts by displaying a splash screen explaining its purpose.</span></span> <span data-ttu-id="a5f6b-190">Haga clic en siguiente para pasar a la pantalla "Seleccionar una opción de configuración", que se muestra en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-190">Click Next to advance to the "Select a Setup Option" screen, which is shown in Figure 1.</span></span> <span data-ttu-id="a5f6b-191">Desde aquí puede agregar objetos de base de datos de los servicios de aplicación o quitarlos de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-191">From here you can choose to add the application services database objects or remove them from a database.</span></span> <span data-ttu-id="a5f6b-192">Puesto que deseamos agregar estos objetos a la base de datos de producción, seleccione la opción "Configurar SQL Server para servicios de aplicación" y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-192">Because we want to add these objects to the production database, select the "Configure SQL Server for application services" option and click Next.</span></span>


<span data-ttu-id="a5f6b-193">[![Elija configurar SQL Server para servicios de aplicación](configuring-a-website-that-uses-application-services-cs/_static/image2.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-193">[![Choose to Configure SQL Server for Application Services](configuring-a-website-that-uses-application-services-cs/_static/image2.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image1.jpg)</span></span>

<span data-ttu-id="a5f6b-194">**Figura 1**: Optar por configurar SQL Server para servicios de aplicación ([haga clic aquí para ver imagen en tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image3.jpg))</span><span class="sxs-lookup"><span data-stu-id="a5f6b-194">**Figure 1**: Choose to Configure SQL Server for Application Services ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image3.jpg))</span></span>


<span data-ttu-id="a5f6b-195">En "Seleccionar el servidor y base de datos" pantalla pide información para conectarse a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-195">In "Select the Server and Database" screen prompts for information to connect to the database.</span></span> <span data-ttu-id="a5f6b-196">Escriba el nombre de la base de datos proporcionado por su empresa de hospedaje web, las credenciales de seguridad y el servidor de base de datos y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-196">Enter the database server, the security credentials, and the database name supplied to you by your web hosting company and click Next.</span></span>

> [!NOTE]
> <span data-ttu-id="a5f6b-197">Después de escribir el servidor de base de datos y las credenciales puede obtener un error al expandir la lista desplegable de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-197">After entering your database server and credentials you may get an error when expanding the database drop-down list.</span></span> <span data-ttu-id="a5f6b-198">El `aspnet_regsql.exe` herramienta consultas el `sysdatabases` tabla del sistema para recuperar una lista de bases de datos en el servidor, pero algunos web que hospeda los servidores de base de datos de bloqueo de las empresas para que esta información no está disponible públicamente.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-198">The `aspnet_regsql.exe` tool queries the `sysdatabases` system table to retrieve a list of databases on the server, but some web hosting companies lock down their database servers so that this information is not publicly available.</span></span> <span data-ttu-id="a5f6b-199">Si recibe este error puede escribir el nombre de base de datos directamente en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-199">If you get this error you can type the database name directly into the drop-down list.</span></span>


<span data-ttu-id="a5f6b-200">[![Proporcionar a la herramienta con la información de conexión de base de datos s](configuring-a-website-that-uses-application-services-cs/_static/image5.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-200">[![Supply the Tool With Your Database s Connection Information](configuring-a-website-that-uses-application-services-cs/_static/image5.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image4.jpg)</span></span>

<span data-ttu-id="a5f6b-201">**Figura 2**: Proporcione la información de conexión de herramienta con la base de datos s ([haga clic aquí para ver imagen en tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image6.jpg))</span><span class="sxs-lookup"><span data-stu-id="a5f6b-201">**Figure 2**: Supply the Tool With Your Database s Connection Information ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image6.jpg))</span></span>


<span data-ttu-id="a5f6b-202">La pantalla posterior resume las acciones que se va a tener lugar, es decir que los objetos de base de datos de servicios de aplicación se van a agregar a la base de datos especificado.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-202">The subsequent screen summarizes the actions that are about to take place, namely that the application services database objects are going to be added to the specified database.</span></span> <span data-ttu-id="a5f6b-203">Haga clic en siguiente para completar esta acción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-203">Click Next to complete this action.</span></span> <span data-ttu-id="a5f6b-204">Transcurridos unos instantes, se muestra la última pantalla, teniendo en cuenta que se han agregado los objetos de base de datos (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-204">After a few moments, the final screen is displayed, noting that the database objects have been added (see Figure 3).</span></span>


<span data-ttu-id="a5f6b-205">[![¡Success! Los objetos de base de datos de servicios de aplicación se agregaron a la base de datos de producción](configuring-a-website-that-uses-application-services-cs/_static/image8.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-205">[![Success! The Application Services Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-cs/_static/image8.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image7.jpg)</span></span>

<span data-ttu-id="a5f6b-206">**Figura 3**: Correcto</span><span class="sxs-lookup"><span data-stu-id="a5f6b-206">**Figure 3**: Success!</span></span> <span data-ttu-id="a5f6b-207">La aplicación Servicios de base de datos de objetos se agregaron a la base de datos de producción ([haga clic aquí para ver imagen en tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image9.jpg))</span><span class="sxs-lookup"><span data-stu-id="a5f6b-207">The Application Services Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image9.jpg))</span></span>


<span data-ttu-id="a5f6b-208">Para comprobar que los objetos de base de datos de servicios de aplicación se agregaron correctamente a la base de datos de producción, abra SQL Server Management Studio y conéctese a la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-208">To verify that the application services database objects were successfully added to the production database, open SQL Server Management Studio and connect to your production database.</span></span> <span data-ttu-id="a5f6b-209">Como se muestra en la figura 4, ahora debería ver las tablas de base de datos de servicios de aplicación en la base de datos `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`, y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-209">As Figure 4 shows, you should now see the application services database tables in your database, `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`, and so forth.</span></span>


<span data-ttu-id="a5f6b-210">[![Confirme que los objetos de base de datos se agregaron a la base de datos de producción](configuring-a-website-that-uses-application-services-cs/_static/image11.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image10.jpg)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-210">[![Confirm That the Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-cs/_static/image11.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image10.jpg)</span></span>

<span data-ttu-id="a5f6b-211">**Figura 4**: Confirme que los objetos de base de datos se agregaron a la base de datos de producción ([haga clic aquí para ver imagen en tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image12.jpg))</span><span class="sxs-lookup"><span data-stu-id="a5f6b-211">**Figure 4**: Confirm That the Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image12.jpg))</span></span>


<span data-ttu-id="a5f6b-212">Sólo deberá usar el `aspnet_regsql.exe` herramienta al implementar la aplicación web por primera vez o por primera vez después de haber iniciado mediante los servicios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-212">You will only need to use the `aspnet_regsql.exe` tool when deploying your web application for the first time or for the first time after you have started using the application services.</span></span> <span data-ttu-id="a5f6b-213">Una vez que estos objetos de base de datos están en la base de datos de producción que no tendrán que volver a added o modified.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-213">Once these database objects are on the production database they won't need to be re-added or modified.</span></span>

### <a name="copying-user-accounts-from-development-to-production"></a><span data-ttu-id="a5f6b-214">Copiar cuentas de usuario de desarrollo a producción</span><span class="sxs-lookup"><span data-stu-id="a5f6b-214">Copying User Accounts from Development to Production</span></span>

<span data-ttu-id="a5f6b-215">Cuando se usa el `SqlMembershipProvider` y `SqlRoleProvider` clases de proveedor para almacenar la información de servicios de aplicación en una base de datos de SQL Server, la información de cuenta y el rol de usuario se almacena en una variedad de las tablas de base de datos, incluidas `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`, y `aspnet_UsersInRoles`, entre otros.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-215">When using the `SqlMembershipProvider` and `SqlRoleProvider` provider classes to store the application services information in a SQL Server database, the user account and role information is stored in a variety of database tables, including `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`, and `aspnet_UsersInRoles`, among others.</span></span> <span data-ttu-id="a5f6b-216">Si durante el desarrollo de crea cuentas de usuario en el entorno de desarrollo puede replicar esas cuentas de usuario en producción mediante la copia de los registros correspondientes de las tablas de base de datos aplicable.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-216">If during development you create user accounts in the development environment you can replicate those user accounts in production by copying the corresponding records from the applicable database tables.</span></span> <span data-ttu-id="a5f6b-217">Si usa al Asistente para publicación de base de datos para implementar los objetos de base de datos de servicios de aplicación es posible que también decidió copiar los registros, lo que daría lugar a las cuentas de usuario que creó en el desarrollo para estar también en producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-217">If you used the Database Publishing Wizard to deploy the application services database objects you may have also elected to copy the records, which would result in the user accounts created in development to also be on production.</span></span> <span data-ttu-id="a5f6b-218">Sin embargo, dependiendo de las opciones de configuración, es posible que los usuarios cuyas cuentas se crearon en el desarrollo y copian en producción están posible iniciar sesión desde el sitio Web de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-218">But, depending on your configuration settings, you may find that those users whose accounts were created in development and copied to production are unable to login from the production website.</span></span> <span data-ttu-id="a5f6b-219">¿Qué ventajas aporta?</span><span class="sxs-lookup"><span data-stu-id="a5f6b-219">What gives?</span></span>

<span data-ttu-id="a5f6b-220">El `SqlMembershipProvider` y `SqlRoleProvider` clases de proveedor se ha diseñado para que una sola base de datos podría servir como un almacén de usuario para varias aplicaciones, donde cada aplicación podría, en teoría, tienen usuarios con los nombres de usuario que se superponen y funciones con el mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-220">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes were designed such that a single database could serve as a user store for multiple applications, where each application could, in theory, have users with overlapping usernames and roles with the same name.</span></span> <span data-ttu-id="a5f6b-221">Para permitir esta flexibilidad, la base de datos mantiene una lista de aplicaciones en la `aspnet_Applications` tabla y cada usuario está asociado a una de estas aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-221">To allow for this flexibility, the database maintains a list of applications in the `aspnet_Applications` table, and each user is associated with one of these applications.</span></span> <span data-ttu-id="a5f6b-222">En concreto, el `aspnet_Users` tabla tiene un `ApplicationId` columna que vincula a un registro en cada usuario el `aspnet_Applications` tabla.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-222">Specifically, the `aspnet_Users` table has an `ApplicationId` column that ties each user to a record in the `aspnet_Applications` table.</span></span>

<span data-ttu-id="a5f6b-223">Además el `ApplicationId` columna, el `aspnet_Applications` tabla también incluye un `ApplicationName` columna, que proporciona un nombre más fácil de usar para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-223">In addition to the `ApplicationId` column, the `aspnet_Applications` table also includes an `ApplicationName` column, which provides a more human-friendly name for the application.</span></span> <span data-ttu-id="a5f6b-224">Cuando un sitio Web intenta trabajar con una cuenta de usuario, como la validación de un credenciales de usuario s en la página de inicio de sesión, debe indicar el `SqlMembershipProvider` qué aplicación para que funcione con la clase.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-224">When a website attempts to work with a user account, such as validating a user s credentials from the login page, it must tell the `SqlMembershipProvider` class what application to work with.</span></span> <span data-ttu-id="a5f6b-225">Lo normal esto proporcionando el nombre de la aplicación y este valor procede de la configuración del proveedor s en `Web.config` : específicamente a través de la `applicationName` atributo.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-225">It usually does this by supplying the application name, and the this value comes from the provider s configuration in `Web.config` - specifically via the `applicationName` attribute.</span></span>

<span data-ttu-id="a5f6b-226">¿Pero qué sucede si el `applicationName` no se especifica el atributo en `Web.config`?</span><span class="sxs-lookup"><span data-stu-id="a5f6b-226">But what happens if the `applicationName` attribute is not specified in `Web.config`?</span></span> <span data-ttu-id="a5f6b-227">En tal caso, la pertenencia a un sistema usa la ruta de acceso raíz de aplicación como el `applicationName` valor.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-227">In such a case the Membership system uses the application root path as the `applicationName` value.</span></span> <span data-ttu-id="a5f6b-228">Si el `applicationName` atributo no se establece explícitamente `Web.config`, a continuación, es posible que el entorno de desarrollo y el entorno de producción use una raíz de aplicación diferentes y, por tanto, se asociarán con otra aplicación nombres de los servicios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-228">If the `applicationName` attribute is not explicitly set in `Web.config`, then, there is the possibility that the development environment and production environment use a different application root and therefore will be associated with different application names in the application services.</span></span> <span data-ttu-id="a5f6b-229">Si se produce una discrepancia de este tipo, a continuación, los usuarios creados en el entorno de desarrollo tendrán un `ApplicationId` valor que no coincide con el `ApplicationId` valor para el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-229">If such a mismatch occurs then those users created in the development environment will have an `ApplicationId` value that does not match with the `ApplicationId` value for the production environment.</span></span> <span data-ttu-id="a5f6b-230">El resultado neto es que los usuarios no podrán iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-230">The net result is that those users won't be able to login.</span></span>

> [!NOTE]
> <span data-ttu-id="a5f6b-231">Si se encuentra en esta situación - con cuentas de usuario que se copian en producción con una que no coinciden `ApplicationId` valor - podría escribir una consulta para actualizar estos incorrecto `ApplicationId` valores para el `ApplicationId` utilizado en producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-231">If you find yourself in this situation - with user accounts copied to production with a mismatched `ApplicationId` value - you could write a query to update these incorrect `ApplicationId` values to the `ApplicationId` used on production.</span></span> <span data-ttu-id="a5f6b-232">Una vez actualizado, los usuarios cuyas cuentas se crearon en el entorno de desarrollo ahora podrán iniciar sesión en la aplicación web en producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-232">Once updated, the users whose accounts were created on the development environment would now be able to sign into the web application on production.</span></span>


<span data-ttu-id="a5f6b-233">La buena noticia es que hay un paso simple que puede seguir para garantizar que los dos entornos usan el mismo `ApplicationId` : establece explícitamente el `applicationName` atributo `Web.config` para todos los proveedores de servicios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-233">The good news is that there is a simple step you can take to ensure that the two environments use the same `ApplicationId` - explicitly set the `applicationName` attribute in `Web.config` for all of your application services providers.</span></span> <span data-ttu-id="a5f6b-234">Establezca explícitamente la `applicationName` atributo para "BookReviews" en el `<membership>` y `<roleManager>` elementos como este fragmento de código `Web.config` muestra.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-234">I explicitly set the `applicationName` attribute to "BookReviews" in the `<membership>` and `<roleManager>` elements as this snippet from `Web.config` shows.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample4.xml)]

<span data-ttu-id="a5f6b-235">Para obtener más información sobre cómo el `applicationName` atributo y el razonamiento subyacente a, hacen referencia a [ *Scott Guthrie* ](https://weblogs.asp.net/scottgu/) entrada de blog s [ *siempre establece el nombre de aplicación propiedad al configurar la pertenencia a ASP.NET y otros proveedores*](https://weblogs.asp.net/scottgu/443634).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-235">For more discussion on setting the `applicationName` attribute and the rationale behind it, refer to [*Scott Guthrie*](https://weblogs.asp.net/scottgu/) s blog post, [*Always set the applicationName property when configuring ASP.NET Membership and other Providers*](https://weblogs.asp.net/scottgu/443634).</span></span>

### <a name="managing-user-accounts-in-the-production-environment"></a><span data-ttu-id="a5f6b-236">Administrar cuentas de usuario en el entorno de producción</span><span class="sxs-lookup"><span data-stu-id="a5f6b-236">Managing User Accounts in the Production Environment</span></span>

<span data-ttu-id="a5f6b-237">La herramienta de administración del sitio Web de ASP.NET (WSAT) facilita las tareas de crear y administrar cuentas de usuario, definir y aplicar funciones y explicar las reglas de autorización basada en roles y usuarios.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-237">The ASP.NET Web Site Administration Tool (WSAT) makes it easy to create and manage user accounts, define and apply roles, and spell out user- and role-based authorization rules.</span></span> <span data-ttu-id="a5f6b-238">Puede iniciar el WSAT desde Visual Studio, vaya al explorador de soluciones y haciendo clic en el icono de configuración de ASP.NET, o bien, vaya a los menús del sitio Web o proyecto y seleccione el elemento de menú de configuración de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-238">You can launch the WSAT from Visual Studio by going to the Solution Explorer and clicking the ASP.NET Configuration icon or by going to the Website or Project menus and selecting the ASP.NET Configuration menu item.</span></span> <span data-ttu-id="a5f6b-239">Lamentablemente, el WSAT sólo puede trabajar con sitios Web locales.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-239">Unfortunately, the WSAT can only work with local websites.</span></span> <span data-ttu-id="a5f6b-240">Por lo tanto, no puede usar el WSAT desde su estación de trabajo para administrar el sitio Web en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-240">Therefore, you cannot use the WSAT from your workstation to manage the website in the production environment.</span></span>

<span data-ttu-id="a5f6b-241">La buena noticia es que toda la funcionalidad expuesta proporcionada por el WSAT está disponible mediante programación a través de la pertenencia y funciones de API; Además, muchas de las pantallas WSAT usan los controles relacionados con el inicio de sesión de ASP.NET estándar.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-241">The good news is that all of the functionality exposed provided by the WSAT is available programmatically through the Membership and Roles APIs; furthermore, many of the WSAT screens use the standard ASP.NET Login-related controls.</span></span> <span data-ttu-id="a5f6b-242">En resumen, puede agregar páginas ASP.NET al sitio Web que ofrecen las funcionalidades de administración necesarios.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-242">In short, you can add ASP.NET pages to your website that offer the necessary management capabilities.</span></span>

<span data-ttu-id="a5f6b-243">Recuerde que un tutorial anterior actualiza la aplicación web de reseñas de libros para incluir un `~/Admin` y esta carpeta se ha configurado para permitir solo a los usuarios en el rol de administrador.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-243">Recall that an earlier tutorial updated the Book Reviews web application to include an `~/Admin` folder, and this folder has been configured to only allow users in the Admin role.</span></span> <span data-ttu-id="a5f6b-244">He agregado una página a la carpeta denominada `CreateAccount.aspx` desde que un administrador puede crear una nueva cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-244">I added a page to that folder named `CreateAccount.aspx` from which an administrator can create a new user account.</span></span> <span data-ttu-id="a5f6b-245">Esta página usa el control CreateUserWizard para mostrar la lógica de back-end y de interfaz de usuario para crear una nueva cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-245">This page uses the CreateUserWizard control to display the user interface and backend logic for creating a new user account.</span></span> <span data-ttu-id="a5f6b-246">Novedades más, personalizar el control para incluir un control CheckBox que pregunta si también se debe agregar al nuevo usuario al rol de administrador (consulte la figura 5).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-246">What s more, I customized the control to include a CheckBox that prompts whether the new user should also be added to the Admin role (see Figure 5).</span></span> <span data-ttu-id="a5f6b-247">Con un poco de trabajo puede crear un conjunto de páginas personalizado que implementa las tareas relacionadas con la administración usuarios y roles que el WSAT proporcionaría en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-247">With a little bit of work you can build a custom set of pages that implements the user and role management-related tasks that would otherwise be provided by the WSAT.</span></span>

> [!NOTE]
> <span data-ttu-id="a5f6b-248">Para obtener más información sobre el uso de la pertenencia y funciones de API junto con los controles Web relacionados con el inicio de sesión de ASP.NET, no olvide leer mi [ *tutoriales de seguridad del sitio Web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-248">For more information on using the Membership and Roles APIs along with the Login-related ASP.NET Web controls, be sure to read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span> <span data-ttu-id="a5f6b-249">Para obtener más información sobre la personalización del control CreateUserWizard, consulte el [ *crear cuentas de usuario* ](../../older-versions-security/membership/creating-user-accounts-cs.md) y [ *almacenar información de usuario adicional* ](../../older-versions-security/membership/storing-additional-user-information-cs.md) tutoriales o desproteger [ *Erich Peterson* ](http://www.erichpeterson.com/) artículo, [ *personalizar el CreateUserWizard Control* ](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5f6b-249">For more on customizing the CreateUserWizard control refer to the [*Creating User Accounts*](../../older-versions-security/membership/creating-user-accounts-cs.md) and [*Storing Additional User Information*](../../older-versions-security/membership/storing-additional-user-information-cs.md) tutorials, or check out [*Erich Peterson*](http://www.erichpeterson.com/) s article, [*Customizing the CreateUserWizard Control*](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span></span>


<span data-ttu-id="a5f6b-250">[![Los administradores pueden crear nuevas cuentas de usuario](configuring-a-website-that-uses-application-services-cs/_static/image14.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image13.jpg)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-250">[![Administrators Can Create New User Accounts](configuring-a-website-that-uses-application-services-cs/_static/image14.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image13.jpg)</span></span>

<span data-ttu-id="a5f6b-251">**Figura 5**: Los administradores pueden crear nuevas cuentas de usuario ([haga clic aquí para ver imagen en tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image15.jpg))</span><span class="sxs-lookup"><span data-stu-id="a5f6b-251">**Figure 5**: Administrators Can Create New User Accounts ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image15.jpg))</span></span>


<span data-ttu-id="a5f6b-252">Si necesita la funcionalidad completa de la desprotección WSAT [ *gradual su propio sitio Web de herramienta de administración*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx), en que el autor Dan Clem le guía a través del proceso de creación de una herramienta similar a WSAT personalizada.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-252">If you need the full functionality of the WSAT check out [*Rolling Your Own Web Site Administration Tool*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx), in which author Dan Clem walks through the process of building a custom WSAT-like tool.</span></span> <span data-ttu-id="a5f6b-253">Dan comparte su código de origen s aplicación (en C#) y proporciona instrucciones paso a paso para agregarlo a su sitio Web hospedado.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-253">Dan shares his application s source code (in C#) and provides step-by-step instructions for adding it to your hosted website.</span></span>

## <a name="summary"></a><span data-ttu-id="a5f6b-254">Resumen</span><span class="sxs-lookup"><span data-stu-id="a5f6b-254">Summary</span></span>

<span data-ttu-id="a5f6b-255">Al implementar una aplicación web que usa la implementación de base de datos de servicios de aplicación primero debe asegurarse de que la base de datos de producción tiene los objetos de base de datos necesaria.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-255">When deploying a web application that uses the application services database implementation you must first ensure that the production database has the requisite database objects.</span></span> <span data-ttu-id="a5f6b-256">Estos objetos se pueden agregar mediante las técnicas descritas en la *implementar una base de datos* tutorial; también puede usar el `aspnet_regsql.exe` herramienta, como hemos visto en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-256">These objects can be added using the techniques discussed in the *Deploying a Database* tutorial; alternatively, you can use the `aspnet_regsql.exe` tool, as we saw in this tutorial.</span></span> <span data-ttu-id="a5f6b-257">Otros desafíos que hicimos alusión se centran en el nombre de aplicación que se usan en los entornos de desarrollo y producción (lo que es importante si desea que los usuarios y roles creados en el entorno de desarrollo sea válido en producción) y las técnicas para la sincronización administración de los usuarios y roles en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-257">Other challenges we touched on center around synchronizing the application name used in the development and production environments (which is important if you want users and roles created in the development environment to be valid on production) and techniques for managing the users and roles in the production environment.</span></span>

<span data-ttu-id="a5f6b-258">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="a5f6b-258">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="a5f6b-259">Información adicional</span><span class="sxs-lookup"><span data-stu-id="a5f6b-259">Further Reading</span></span>

<span data-ttu-id="a5f6b-260">Para obtener más información sobre los temas tratados en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="a5f6b-260">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="a5f6b-261">*Herramienta de registro de servidor SQL de ASP.NET (aspnet_regsql.exe)*</span><span class="sxs-lookup"><span data-stu-id="a5f6b-261">*ASP.NET SQL Server Registration Tool (aspnet_regsql.exe)*</span></span>](https://msdn.microsoft.com/library/ms229862.aspx)
- [<span data-ttu-id="a5f6b-262">*Creación de la base de datos de servicios de aplicación para SQL Server*</span><span class="sxs-lookup"><span data-stu-id="a5f6b-262">*Creating the Application Services Database for SQL Server*</span></span>](https://msdn.microsoft.com/library/x28wfk74.aspx)
- [<span data-ttu-id="a5f6b-263">*Crear el esquema de pertenencia en SQL Server*</span><span class="sxs-lookup"><span data-stu-id="a5f6b-263">*Creating the Membership Schema in SQL Server*</span></span>](../../older-versions-security/membership/creating-the-membership-schema-in-sql-server-cs.md)
- [<span data-ttu-id="a5f6b-264">*Examen de perfil, Roles y pertenencia ASP.NET s*</span><span class="sxs-lookup"><span data-stu-id="a5f6b-264">*Examining ASP.NET s Membership, Roles, and Profile*</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="a5f6b-265">*Implementar su propia herramienta de administración de sitios Web*</span><span class="sxs-lookup"><span data-stu-id="a5f6b-265">*Rolling Your Own Web Site Administration Tool*</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="a5f6b-266">*Tutoriales de seguridad del sitio Web*</span><span class="sxs-lookup"><span data-stu-id="a5f6b-266">*Website Security Tutorials*</span></span>](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)
- [<span data-ttu-id="a5f6b-267">*Información general de herramienta de administración de sitio Web*</span><span class="sxs-lookup"><span data-stu-id="a5f6b-267">*Web Site Administration Tool Overview*</span></span>](https://msdn.microsoft.com/library/yy40ytx0.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="a5f6b-268">[Anterior](configuring-the-production-web-application-to-use-the-production-database-cs.md)
> [Siguiente](strategies-for-database-development-and-deployment-cs.md)</span><span class="sxs-lookup"><span data-stu-id="a5f6b-268">[Previous](configuring-the-production-web-application-to-use-the-production-database-cs.md)
[Next](strategies-for-database-development-and-deployment-cs.md)</span></span>

---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
title: Examinar los eventos asociados a la inserción, actualización y eliminación (VB) | Microsoft Docs
author: rick-anderson
description: En este tutorial se examinará el uso de los eventos que se producen antes, durante y después de una operación de inserción, actualización o eliminación de un control Web de datos ASP.NET. W...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: c9bd10a7-eff8-4d8c-bec9-963c2aef2d6e
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: 35edb3cefc6fe23bb56e667c02d10dc7798f730d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78492979"
---
# <a name="examining-the-events-associated-with-inserting-updating-and-deleting-vb"></a><span data-ttu-id="9aed8-104">Examinar los eventos relacionados con la inserción, actualización y eliminación (VB)</span><span class="sxs-lookup"><span data-stu-id="9aed8-104">Examining the Events Associated with Inserting, Updating, and Deleting (VB)</span></span>

<span data-ttu-id="9aed8-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9aed8-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9aed8-106">[Descarga](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) de la aplicación de ejemplo o [descarga de PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="9aed8-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_VB.exe) or [Download PDF](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/datatutorial17vb1.pdf)</span></span>

> <span data-ttu-id="9aed8-107">En este tutorial se examinará el uso de los eventos que se producen antes, durante y después de una operación de inserción, actualización o eliminación de un control Web de datos ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="9aed8-107">In this tutorial we'll examine using the events that occur before, during, and after an insert, update, or delete operation of an ASP.NET data Web control.</span></span> <span data-ttu-id="9aed8-108">También veremos cómo personalizar la interfaz de edición para actualizar solo un subconjunto de los campos del producto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-108">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="introduction"></a><span data-ttu-id="9aed8-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="9aed8-109">Introduction</span></span>

<span data-ttu-id="9aed8-110">Al utilizar las características integradas de inserción, edición o eliminación de los controles GridView, DetailsView o FormView, se lleva a cabo una serie de pasos cuando el usuario final completa el proceso de agregar un nuevo registro o actualizar o eliminar un registro existente.</span><span class="sxs-lookup"><span data-stu-id="9aed8-110">When using the built-in inserting, editing, or deleting features of the GridView, DetailsView, or FormView controls, a variety of steps transpire when the end user completes the process of adding a new record or updating or deleting an existing record.</span></span> <span data-ttu-id="9aed8-111">Como hemos comentado en el [tutorial anterior](an-overview-of-inserting-updating-and-deleting-data-vb.md), cuando se edita una fila en el control GridView, el botón Editar se reemplaza por los botones actualizar y cancelar y los BoundFields se convierten en cuadros de texto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-111">As we discussed in the [previous tutorial](an-overview-of-inserting-updating-and-deleting-data-vb.md), when a row is edited in the GridView the Edit button is replaced by Update and Cancel buttons and the BoundFields turn into TextBoxes.</span></span> <span data-ttu-id="9aed8-112">Una vez que el usuario final actualice los datos y haga clic en actualizar, se realizarán los pasos siguientes en el PostBack:</span><span class="sxs-lookup"><span data-stu-id="9aed8-112">After the end user updates the data and clicks Update, the following steps are performed on postback:</span></span>

1. <span data-ttu-id="9aed8-113">GridView rellena la `UpdateParameters` de ObjectDataSource con los campos de identificación únicos del registro editado (a través de la propiedad `DataKeyNames`) junto con los valores especificados por el usuario.</span><span class="sxs-lookup"><span data-stu-id="9aed8-113">The GridView populates its ObjectDataSource's `UpdateParameters` with the edited record's unique identifying field(s) (via the `DataKeyNames` property) along with the values entered by the user</span></span>
2. <span data-ttu-id="9aed8-114">GridView invoca el método `Update()` de ObjectDataSource, que a su vez invoca el método adecuado en el objeto subyacente (`ProductsDAL.UpdateProduct`, en el tutorial anterior).</span><span class="sxs-lookup"><span data-stu-id="9aed8-114">The GridView invokes its ObjectDataSource's `Update()` method, which in turn invokes the appropriate method in the underlying object (`ProductsDAL.UpdateProduct`, in our previous tutorial)</span></span>
3. <span data-ttu-id="9aed8-115">Los datos subyacentes, que ahora incluyen los cambios actualizados, se reenlazan a GridView</span><span class="sxs-lookup"><span data-stu-id="9aed8-115">The underlying data, which now includes the updated changes, is rebound to the GridView</span></span>

<span data-ttu-id="9aed8-116">Durante esta secuencia de pasos, se desencadena una serie de eventos, lo que nos permite crear controladores de eventos para agregar lógica personalizada cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="9aed8-116">During this sequence of steps, a number of events fire, enabling us to create event handlers to add custom logic where needed.</span></span> <span data-ttu-id="9aed8-117">Por ejemplo, antes del paso 1, se activa el evento `RowUpdating` de GridView.</span><span class="sxs-lookup"><span data-stu-id="9aed8-117">For example, prior to Step 1, the GridView's `RowUpdating` event fires.</span></span> <span data-ttu-id="9aed8-118">En este punto, se puede cancelar la solicitud de actualización si hay algún error de validación.</span><span class="sxs-lookup"><span data-stu-id="9aed8-118">We can, at this point, cancel the update request if there is some validation error.</span></span> <span data-ttu-id="9aed8-119">Cuando se invoca el método de `Update()`, se activa el evento de `Updating` de ObjectDataSource, lo que proporciona una oportunidad para agregar o personalizar los valores de cualquiera de las `UpdateParameters`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-119">When the `Update()` method is invoked, the ObjectDataSource's `Updating` event fires, providing an opportunity to add or customize the values of any of the `UpdateParameters`.</span></span> <span data-ttu-id="9aed8-120">Una vez finalizada la ejecución del método del objeto subyacente de ObjectDataSource, se genera el evento `Updated` de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="9aed8-120">After the ObjectDataSource's underlying object's method has completed executing, the ObjectDataSource's `Updated` event is raised.</span></span> <span data-ttu-id="9aed8-121">Un controlador de eventos para el evento `Updated` puede inspeccionar los detalles sobre la operación de actualización, como el número de filas afectadas y si se produjo o no una excepción.</span><span class="sxs-lookup"><span data-stu-id="9aed8-121">An event handler for the `Updated` event can inspect the details about the update operation, such as how many rows were affected and whether or not an exception occurred.</span></span> <span data-ttu-id="9aed8-122">Por último, después del paso 2, se desencadena el evento `RowUpdated` de GridView; un controlador de eventos para este evento puede examinar información adicional sobre la operación de actualización que se acaba de realizar.</span><span class="sxs-lookup"><span data-stu-id="9aed8-122">Finally, after Step 2, the GridView's `RowUpdated` event fires; an event handler for this event can examine additional information about the update operation just performed.</span></span>

<span data-ttu-id="9aed8-123">La figura 1 muestra esta serie de eventos y pasos al actualizar un control GridView.</span><span class="sxs-lookup"><span data-stu-id="9aed8-123">Figure 1 depicts this series of events and steps when updating a GridView.</span></span> <span data-ttu-id="9aed8-124">El patrón de eventos de la figura 1 no es único para la actualización con GridView.</span><span class="sxs-lookup"><span data-stu-id="9aed8-124">The event pattern in Figure 1 is not unique to updating with a GridView.</span></span> <span data-ttu-id="9aed8-125">Al insertar, actualizar o eliminar datos de GridView, DetailsView o FormView, se precipita la misma secuencia de eventos anteriores y posteriores para el control Web de datos y ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="9aed8-125">Inserting, updating, or deleting data from the GridView, DetailsView, or FormView precipitates the same sequence of pre- and post-level events for both the data Web control and the ObjectDataSource.</span></span>

<span data-ttu-id="9aed8-126">[![una serie de eventos previos y posteriores que se activan al actualizar los datos en un control GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-126">[![A Series of Pre- and Post-Events Fire When Updating Data in a GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image1.png)</span></span>

<span data-ttu-id="9aed8-127">**Figura 1**: se activa una serie de eventos previos y posteriores al actualizar los datos en un control GridView ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-127">**Figure 1**: A Series of Pre- and Post-Events Fire When Updating Data in a GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image3.png))</span></span>

<span data-ttu-id="9aed8-128">En este tutorial se examinará el uso de estos eventos para ampliar las capacidades integradas de inserción, actualización y eliminación de los controles Web de datos de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="9aed8-128">In this tutorial we'll examine using these events to extend the built-in inserting, updating, and deleting capabilities of the ASP.NET data Web controls.</span></span> <span data-ttu-id="9aed8-129">También veremos cómo personalizar la interfaz de edición para actualizar solo un subconjunto de los campos del producto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-129">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="step-1-updating-a-productsproductnameandunitpricefields"></a><span data-ttu-id="9aed8-130">Paso 1: actualización de los campos de`ProductName`y`UnitPrice`de un producto</span><span class="sxs-lookup"><span data-stu-id="9aed8-130">Step 1: Updating a Product's`ProductName`and`UnitPrice`Fields</span></span>

<span data-ttu-id="9aed8-131">En las interfaces de edición del tutorial anterior, se tenían que incluir *todos* los campos de producto que no eran de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="9aed8-131">In the editing interfaces from the previous tutorial *all* product fields that were not read-only had to be included.</span></span> <span data-ttu-id="9aed8-132">Si fuera a quitar un campo del `QuantityPerUnit` de GridView: al actualizar los datos, el control Web de datos no establecería el valor de `UpdateParameters` de la `QuantityPerUnit` de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="9aed8-132">If we were to remove a field from the GridView - say `QuantityPerUnit` - when updating the data the data Web control would not set the ObjectDataSource's `QuantityPerUnit` `UpdateParameters` value.</span></span> <span data-ttu-id="9aed8-133">A continuación, ObjectDataSource pasaría un valor de `Nothing` al método `UpdateProduct` capa de lógica de negocios (BLL), que cambiaría la columna `QuantityPerUnit` del registro de la base de datos editada a un valor de `NULL`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-133">The ObjectDataSource would then pass in a value of `Nothing` into the `UpdateProduct` Business Logic Layer (BLL) method, which would change the edited database record's `QuantityPerUnit` column to a `NULL` value.</span></span> <span data-ttu-id="9aed8-134">Del mismo modo, si se quita un campo obligatorio, como `ProductName`, de la interfaz de edición, se producirá un error en la actualización con una excepción "la*columna ' ProductName ' no permite valores NULL*.</span><span class="sxs-lookup"><span data-stu-id="9aed8-134">Similarly, if a required field, such as `ProductName`, is removed from the editing interface, the update will fail with a "*Column 'ProductName' does not allow nulls*" exception.</span></span> <span data-ttu-id="9aed8-135">La razón de este comportamiento se debe a que ObjectDataSource se configuró para llamar al método `UpdateProduct` de la clase `ProductsBLL`, que esperaba un parámetro de entrada para cada uno de los campos del producto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-135">The reason for this behavior was because the ObjectDataSource was configured to call the `ProductsBLL` class's `UpdateProduct` method, which expected an input parameter for each of the product fields.</span></span> <span data-ttu-id="9aed8-136">Por lo tanto, la colección de `UpdateParameters` de ObjectDataSource contenía un parámetro para cada uno de los parámetros de entrada del método.</span><span class="sxs-lookup"><span data-stu-id="9aed8-136">Therefore, the ObjectDataSource's `UpdateParameters` collection contained a parameter for each of the method's input parameters.</span></span>

<span data-ttu-id="9aed8-137">Si queremos proporcionar un control Web de datos que permita al usuario final actualizar solo un subconjunto de campos, es necesario establecer mediante programación los valores de `UpdateParameters` que faltan en el controlador de eventos de `Updating` de ObjectDataSource o crear y llamar a un método BLL que espera solo un subconjunto de los campos.</span><span class="sxs-lookup"><span data-stu-id="9aed8-137">If we want to provide a data Web control that allows the end user to only update a subset of fields, then we need to either programmatically set the missing `UpdateParameters` values in the ObjectDataSource's `Updating` event handler or create and call a BLL method that expects only a subset of the fields.</span></span> <span data-ttu-id="9aed8-138">Vamos a explorar este último enfoque.</span><span class="sxs-lookup"><span data-stu-id="9aed8-138">Let's explore this latter approach.</span></span>

<span data-ttu-id="9aed8-139">En concreto, vamos a crear una página que muestra solo los campos `ProductName` y `UnitPrice` en un control GridView modificable.</span><span class="sxs-lookup"><span data-stu-id="9aed8-139">Specifically, let's create a page that displays just the `ProductName` and `UnitPrice` fields in an editable GridView.</span></span> <span data-ttu-id="9aed8-140">La interfaz de edición de GridView solo permitirá al usuario actualizar los dos campos mostrados, `ProductName` y `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-140">This GridView's editing interface will only allow the user to update the two displayed fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="9aed8-141">Dado que esta interfaz de edición solo proporciona un subconjunto de los campos de un producto, es necesario crear un ObjectDataSource que use el método de `UpdateProduct` de la capa BLL existente y que tenga los valores de campo de producto que faltan establecidos mediante programación en su controlador de eventos `Updating`, o bien, es necesario crear un nuevo método BLL que espera solo el subconjunto de campos definidos en GridView.</span><span class="sxs-lookup"><span data-stu-id="9aed8-141">Since this editing interface only provides a subset of a product's fields, we either need to create an ObjectDataSource that uses the existing BLL's `UpdateProduct` method and has the missing product field values set programmatically in its `Updating` event handler, or we need to create a new BLL method that expects only the subset of fields defined in the GridView.</span></span> <span data-ttu-id="9aed8-142">En este tutorial, vamos a usar la última opción y crearemos una sobrecarga del método `UpdateProduct`, una que toma solo tres parámetros de entrada: `productName`, `unitPrice`y `productID`:</span><span class="sxs-lookup"><span data-stu-id="9aed8-142">For this tutorial, let's use the latter option and create an overload of the `UpdateProduct` method, one that takes in just three input parameters: `productName`, `unitPrice`, and `productID`:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample1.vb)]

<span data-ttu-id="9aed8-143">Al igual que el método de `UpdateProduct` original, esta sobrecarga comienza comprobando si hay un producto en la base de datos con el `ProductID`especificado.</span><span class="sxs-lookup"><span data-stu-id="9aed8-143">Like the original `UpdateProduct` method, this overload starts by checking to see if there is a product in the database with the specified `ProductID`.</span></span> <span data-ttu-id="9aed8-144">En caso contrario, devuelve `False`, que indica que se produjo un error en la solicitud para actualizar la información del producto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-144">If not, it returns `False`, indicating that the request to update the product information failed.</span></span> <span data-ttu-id="9aed8-145">De lo contrario, actualiza los campos `ProductName` y `UnitPrice` del registro del producto existentes en consecuencia y confirma la actualización llamando al método `Update()` del TableAdapter, pasando la instancia de `ProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-145">Otherwise it updates the existing product record's `ProductName` and `UnitPrice` fields accordingly and commits the update by calling the TableAdapter's `Update()` method, passing in the `ProductsRow` instance.</span></span>

<span data-ttu-id="9aed8-146">Con esta adición a nuestra `ProductsBLL` clase, estamos listos para crear la interfaz de GridView simplificada.</span><span class="sxs-lookup"><span data-stu-id="9aed8-146">With this addition to our `ProductsBLL` class, we're ready to create the simplified GridView interface.</span></span> <span data-ttu-id="9aed8-147">Abra el `DataModificationEvents.aspx` en la carpeta `EditInsertDelete` y agregue un control GridView a la página.</span><span class="sxs-lookup"><span data-stu-id="9aed8-147">Open the `DataModificationEvents.aspx` in the `EditInsertDelete` folder and add a GridView to the page.</span></span> <span data-ttu-id="9aed8-148">Cree un nuevo ObjectDataSource y configúrelo para utilizar la `ProductsBLL` clase con su `Select()` asignación de método a `GetProducts` y su `Update()` de asignación de método a la sobrecarga `UpdateProduct` que toma solo los parámetros de entrada `productName`, `unitPrice`y `productID`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-148">Create a new ObjectDataSource and configure it to use the `ProductsBLL` class with its `Select()` method mapping to `GetProducts` and its `Update()` method mapping to the `UpdateProduct` overload that takes in only the `productName`, `unitPrice`, and `productID` input parameters.</span></span> <span data-ttu-id="9aed8-149">En la ilustración 2 se muestra el Asistente para crear orígenes de datos al asignar el método `Update()` de ObjectDataSource a la nueva sobrecarga del método `UpdateProduct` de la clase `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-149">Figure 2 shows the Create Data Source wizard when mapping the ObjectDataSource's `Update()` method to the `ProductsBLL` class's new `UpdateProduct` method overload.</span></span>

<span data-ttu-id="9aed8-150">[![asignar el método Update () de ObjectDataSource a la nueva sobrecarga UpdateProduct](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-150">[![Map the ObjectDataSource's Update() Method to the New UpdateProduct Overload](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image4.png)</span></span>

<span data-ttu-id="9aed8-151">**Figura 2**: asignación del método `Update()` de ObjectDataSource a la nueva sobrecarga de `UpdateProduct` ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-151">**Figure 2**: Map the ObjectDataSource's `Update()` Method to the New `UpdateProduct` Overload ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image6.png))</span></span>

<span data-ttu-id="9aed8-152">Dado que nuestro ejemplo solo necesitará la capacidad de editar datos, pero no insertar o eliminar registros, dedique un momento a indicar explícitamente que los métodos `Insert()` y `Delete()` de ObjectDataSource no se deben asignar a ninguno de los métodos de la clase `ProductsBLL`. para ello, vaya a las pestañas insertar y eliminar y elija (ninguno) en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="9aed8-152">Since our example will initially just need the ability to edit data, but not to insert or delete records, take a moment to explicitly indicate that the ObjectDataSource's `Insert()` and `Delete()` methods shouldn't be mapped to any of the `ProductsBLL` class's methods by going to the INSERT and DELETE tabs and choosing (None) from the drop-down list.</span></span>

<span data-ttu-id="9aed8-153">[![elegir (ninguno) en la lista desplegable de las pestañas insertar y eliminar](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-153">[![Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image7.png)</span></span>

<span data-ttu-id="9aed8-154">**Figura 3**: elegir (ninguno) en la lista desplegable de las pestañas insertar y eliminar ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-154">**Figure 3**: Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image9.png))</span></span>

<span data-ttu-id="9aed8-155">Después de completar este asistente, active la casilla habilitar edición de la etiqueta inteligente de GridView.</span><span class="sxs-lookup"><span data-stu-id="9aed8-155">After completing this wizard check the Enable Editing checkbox from the GridView's smart tag.</span></span>

<span data-ttu-id="9aed8-156">Con la finalización del Asistente para crear orígenes de datos y el enlace a GridView, Visual Studio ha creado la sintaxis declarativa para ambos controles.</span><span class="sxs-lookup"><span data-stu-id="9aed8-156">With the completion of the Create Data Source wizard and binding that to the GridView, Visual Studio has created the declarative syntax for both controls.</span></span> <span data-ttu-id="9aed8-157">Vaya a la vista de código fuente para inspeccionar el marcado declarativo de ObjectDataSource, que se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="9aed8-157">Go to the Source view to inspect the ObjectDataSource's declarative markup, which is shown below:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="9aed8-158">Dado que no hay ninguna asignación para los métodos `Insert()` y `Delete()` de ObjectDataSource, no hay ninguna sección `InsertParameters` o `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-158">Since there are no mappings for the ObjectDataSource's `Insert()` and `Delete()` methods, there are no `InsertParameters` or `DeleteParameters` sections.</span></span> <span data-ttu-id="9aed8-159">Además, dado que el método de `Update()` se asigna a la sobrecarga del método `UpdateProduct` que solo acepta tres parámetros de entrada, la sección `UpdateParameters` tiene solo tres instancias de `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-159">Furthermore, since the `Update()` method is mapped to the `UpdateProduct` method overload that only accepts three input parameters, the `UpdateParameters` section has just three `Parameter` instances.</span></span>

<span data-ttu-id="9aed8-160">Tenga en cuenta que la propiedad `OldValuesParameterFormatString` de ObjectDataSource está establecida en `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-160">Note that the ObjectDataSource's `OldValuesParameterFormatString` property is set to `original_{0}`.</span></span> <span data-ttu-id="9aed8-161">Visual Studio establece esta propiedad automáticamente al usar el Asistente para configurar orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="9aed8-161">This property is set automatically by Visual Studio when using the Configure Data Source wizard.</span></span> <span data-ttu-id="9aed8-162">Sin embargo, dado que nuestros métodos de BLL no esperan que se pase el valor de `ProductID` original, quite la asignación de esta propiedad por completo de la sintaxis declarativa de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="9aed8-162">However, since our BLL methods don't expect the original `ProductID` value to be passed in, remove this property assignment altogether from the ObjectDataSource's declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="9aed8-163">Si simplemente borra el valor de la propiedad `OldValuesParameterFormatString` de la ventana Propiedades en el Vista de diseño, la propiedad seguirá existiendo en la sintaxis declarativa, pero se establecerá en una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="9aed8-163">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but will be set to an empty string.</span></span> <span data-ttu-id="9aed8-164">Quite la propiedad de la sintaxis declarativa o, en el ventana Propiedades, establezca el valor en el predeterminado `{0}`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-164">Either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>

<span data-ttu-id="9aed8-165">Aunque ObjectDataSource solo tiene `UpdateParameters` para el nombre, el precio y el identificador del producto, Visual Studio ha agregado BoundField o CheckBoxField en GridView para cada uno de los campos del producto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-165">While the ObjectDataSource only has `UpdateParameters` for the product's name, price, and ID, Visual Studio has added a BoundField or CheckBoxField in the GridView for each of the product's fields.</span></span>

<span data-ttu-id="9aed8-166">[![GridView contiene un CheckBoxField para cada uno de los campos del producto](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-166">[![The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image10.png)</span></span>

<span data-ttu-id="9aed8-167">**Figura 4**: el control GridView contiene un control BoundField o CheckBoxField para cada uno de los campos del producto ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-167">**Figure 4**: The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image12.png))</span></span>

<span data-ttu-id="9aed8-168">Cuando el usuario final edita un producto y hace clic en su botón actualizar, el control GridView enumera los campos que no eran de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="9aed8-168">When the end user edits a product and clicks its Update button, the GridView enumerates those fields that were not read-only.</span></span> <span data-ttu-id="9aed8-169">A continuación, establece el valor del parámetro correspondiente en la colección de `UpdateParameters` de ObjectDataSource en el valor especificado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="9aed8-169">It then sets the value of the corresponding parameter in the ObjectDataSource's `UpdateParameters` collection to the value entered by the user.</span></span> <span data-ttu-id="9aed8-170">Si no hay un parámetro correspondiente, el control GridView agrega uno a la colección.</span><span class="sxs-lookup"><span data-stu-id="9aed8-170">If there is not a corresponding parameter, the GridView adds one to the collection.</span></span> <span data-ttu-id="9aed8-171">Por lo tanto, si el control GridView contiene BoundFields y CheckBoxFields para todos los campos del producto, ObjectDataSource terminará invocando la `UpdateProduct` sobrecarga que toma todos estos parámetros, a pesar de que el marcado declarativo de ObjectDataSource especifique solo tres parámetros de entrada (vea la figura 5).</span><span class="sxs-lookup"><span data-stu-id="9aed8-171">Therefore, if our GridView contains BoundFields and CheckBoxFields for all of the product's fields, the ObjectDataSource will end up invoking the `UpdateProduct` overload that takes in all of these parameters, despite the fact that the ObjectDataSource's declarative markup specifies only three input parameters (see Figure 5).</span></span> <span data-ttu-id="9aed8-172">De forma similar, si hay una combinación de campos de producto que no son de solo lectura en GridView que no se corresponde con los parámetros de entrada de una sobrecarga `UpdateProduct`, se generará una excepción al intentar actualizar.</span><span class="sxs-lookup"><span data-stu-id="9aed8-172">Similarly, if there is some combination of non-read-only product fields in the GridView that doesn't correspond to the input parameters for a `UpdateProduct` overload, an exception will be raised when attempting to update.</span></span>

<span data-ttu-id="9aed8-173">[![GridView agregará parámetros a la colección UpdateParameters de ObjectDataSource](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-173">[![The GridView Will Add Parameters to the ObjectDataSource's UpdateParameters Collection](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image13.png)</span></span>

<span data-ttu-id="9aed8-174">**Figura 5**: el control GridView agregará parámetros a la colección de `UpdateParameters` de ObjectDataSource ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-174">**Figure 5**: The GridView Will Add Parameters to the ObjectDataSource's `UpdateParameters` Collection ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image15.png))</span></span>

<span data-ttu-id="9aed8-175">Para asegurarse de que ObjectDataSource invoca la sobrecarga `UpdateProduct` que toma solo el nombre, el precio y el identificador del producto, es necesario restringir el control GridView para tener campos editables solo para los `ProductName` y `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-175">To ensure that the ObjectDataSource invokes the `UpdateProduct` overload that takes in just the product's name, price, and ID, we need to restrict the GridView to having editable fields for just the `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="9aed8-176">Esto puede realizarse quitando los demás BoundFields y CheckBoxFields, estableciendo los otros campos de la propiedad `ReadOnly` en `True`, o bien mediante alguna combinación de ambos.</span><span class="sxs-lookup"><span data-stu-id="9aed8-176">This can be accomplished by removing the other BoundFields and CheckBoxFields, by setting those other fields' `ReadOnly` property to `True`, or by some combination of the two.</span></span> <span data-ttu-id="9aed8-177">En este tutorial, vamos a quitar simplemente todos los campos de GridView excepto el `ProductName` y `UnitPrice` BoundFields, después del cual el marcado declarativo de GridView tendrá el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="9aed8-177">For this tutorial let's simply remove all GridView fields except the `ProductName` and `UnitPrice` BoundFields, after which the GridView's declarative markup will look like:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="9aed8-178">Aunque la sobrecarga `UpdateProduct` espera tres parámetros de entrada, solo tenemos dos BoundFields en nuestro GridView.</span><span class="sxs-lookup"><span data-stu-id="9aed8-178">Even though the `UpdateProduct` overload expects three input parameters, we only have two BoundFields in our GridView.</span></span> <span data-ttu-id="9aed8-179">Esto se debe a que el `productID` parámetro de entrada es un valor de clave principal y se pasa a través del valor de la propiedad `DataKeyNames` de la fila modificada.</span><span class="sxs-lookup"><span data-stu-id="9aed8-179">This is because the `productID` input parameter is a primary key value and passed in through the value of the `DataKeyNames` property for the edited row.</span></span>

<span data-ttu-id="9aed8-180">Nuestro GridView, junto con la sobrecarga de `UpdateProduct`, permite a los usuarios editar solo el nombre y el precio de un producto sin perder ningún otro campo de producto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-180">Our GridView, along with the `UpdateProduct` overload, allows a user to edit just the name and price of a product without losing any of the other product fields.</span></span>

<span data-ttu-id="9aed8-181">[![la interfaz permite editar solo el nombre y el precio del producto](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-181">[![The Interface Allows Editing Just the Product's Name and Price](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image16.png)</span></span>

<span data-ttu-id="9aed8-182">**Figura 6**: la interfaz permite editar solo el nombre y el precio del producto ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-182">**Figure 6**: The Interface Allows Editing Just the Product's Name and Price ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="9aed8-183">Tal como se ha explicado en el tutorial anterior, es importante que el estado de vista de GridView esté habilitado (comportamiento predeterminado).</span><span class="sxs-lookup"><span data-stu-id="9aed8-183">As discussed in the previous tutorial, it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="9aed8-184">Si establece la propiedad GridView s `EnableViewState` en `false`, corre el riesgo de que los usuarios simultáneos eliminen o editen registros involuntariamente.</span><span class="sxs-lookup"><span data-stu-id="9aed8-184">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="9aed8-185">Vea [ADVERTENCIA: problema de simultaneidad con ASP.NET 2,0 GridView/DetailsView/FormViews que admiten la edición o eliminación y cuyo estado de vista está deshabilitado](http://scottonwriting.net/sowblog/posts/10054.aspx) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="9aed8-185">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="improving-theunitpriceformatting"></a><span data-ttu-id="9aed8-186">Mejora del formato de`UnitPrice`</span><span class="sxs-lookup"><span data-stu-id="9aed8-186">Improving the`UnitPrice`Formatting</span></span>

<span data-ttu-id="9aed8-187">Aunque el ejemplo de GridView que se muestra en la figura 6 funciona, no se da formato al campo `UnitPrice`, lo que da lugar a una presentación de precios que carece de símbolos de moneda y tiene cuatro posiciones decimales.</span><span class="sxs-lookup"><span data-stu-id="9aed8-187">While the GridView example shown in Figure 6 works, the `UnitPrice` field is not formatted at all, resulting in a price display that lacks any currency symbols and has four decimal places.</span></span> <span data-ttu-id="9aed8-188">Para aplicar un formato de moneda a las filas no editables, basta con establecer la propiedad `DataFormatString` de `UnitPrice` BoundField en `{0:c}` y su propiedad `HtmlEncode` en `False`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-188">To apply a currency formatting for the non-editable rows, simply set the `UnitPrice` BoundField's `DataFormatString` property to `{0:c}` and its `HtmlEncode` property to `False`.</span></span>

<span data-ttu-id="9aed8-189">[![establecer las propiedades DataFormatString y HtmlEncode del UnitPrice en consecuencia](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-189">[![Set the UnitPrice's DataFormatString and HtmlEncode Properties Accordingly](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image19.png)</span></span>

<span data-ttu-id="9aed8-190">**Figura 7**: establecimiento de las propiedades `DataFormatString` y `HtmlEncode` del `UnitPrice`en consecuencia ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-190">**Figure 7**: Set the `UnitPrice`'s `DataFormatString` and `HtmlEncode` Properties Accordingly ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image21.png))</span></span>

<span data-ttu-id="9aed8-191">Con este cambio, las filas no editables dan formato al precio como moneda; la fila modificada, sin embargo, sigue mostrando el valor sin el símbolo de moneda y con cuatro posiciones decimales.</span><span class="sxs-lookup"><span data-stu-id="9aed8-191">With this change, the non-editable rows format the price as a currency; the edited row, however, still displays the value without the currency symbol and with four decimal places.</span></span>

<span data-ttu-id="9aed8-192">[![las filas no editables ahora tienen el formato de valores de moneda](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-192">[![The Non-Editable Rows are Now Formatted as Currency Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image22.png)</span></span>

<span data-ttu-id="9aed8-193">**Figura 8**: ahora, las filas no editables tienen el formato de valores de moneda ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-193">**Figure 8**: The Non-Editable Rows are Now Formatted as Currency Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image24.png))</span></span>

<span data-ttu-id="9aed8-194">Las instrucciones de formato especificadas en la propiedad `DataFormatString` se pueden aplicar a la interfaz de edición estableciendo la propiedad `ApplyFormatInEditMode` de BoundField en `True` (el valor predeterminado es `False`).</span><span class="sxs-lookup"><span data-stu-id="9aed8-194">The formatting instructions specified in the `DataFormatString` property can be applied to the editing interface by setting the BoundField's `ApplyFormatInEditMode` property to `True` (the default is `False`).</span></span> <span data-ttu-id="9aed8-195">Dedique un momento a establecer esta propiedad en `True`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-195">Take a moment to set this property to `True`.</span></span>

<span data-ttu-id="9aed8-196">[![establecer la propiedad ApplyFormatInEditMode de UnitPrice BoundField en true](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-196">[![Set the UnitPrice BoundField's ApplyFormatInEditMode property to True](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image25.png)</span></span>

<span data-ttu-id="9aed8-197">**Figura 9**: establezca la propiedad `ApplyFormatInEditMode` de `UnitPrice` BoundField en `True` ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-197">**Figure 9**: Set the `UnitPrice` BoundField's `ApplyFormatInEditMode` property to `True` ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image27.png))</span></span>

<span data-ttu-id="9aed8-198">Con este cambio, el valor de la `UnitPrice` que se muestra en la fila editada también tiene el formato de moneda.</span><span class="sxs-lookup"><span data-stu-id="9aed8-198">With this change, the value of the `UnitPrice` displayed in the edited row is also formatted as a currency.</span></span>

<span data-ttu-id="9aed8-199">[![el valor UnitPrice de la fila editada ahora tiene el formato de moneda](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-199">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image28.png)</span></span>

<span data-ttu-id="9aed8-200">**Figura 10**: el valor de `UnitPrice` de la fila editada ahora tiene el formato de moneda ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-200">**Figure 10**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image30.png))</span></span>

<span data-ttu-id="9aed8-201">Sin embargo, al actualizar un producto con el símbolo de moneda en el cuadro de texto, como $19,00, se produce una `FormatException`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-201">However, updating a product with the currency symbol in the textbox such as $19.00 throws a `FormatException`.</span></span> <span data-ttu-id="9aed8-202">Cuando GridView intenta asignar los valores proporcionados por el usuario a la colección de `UpdateParameters` de ObjectDataSource, no puede convertir la cadena de `UnitPrice` "$19,00" en el `Decimal` requerido por el parámetro (consulte la figura 11).</span><span class="sxs-lookup"><span data-stu-id="9aed8-202">When the GridView attempts to assign the user-supplied values to the ObjectDataSource's `UpdateParameters` collection it is unable to convert the `UnitPrice` string "$19.00" into the `Decimal` required by the parameter (see Figure 11).</span></span> <span data-ttu-id="9aed8-203">Para solucionar este error, podemos crear un controlador de eventos para el evento de `RowUpdating` de GridView y hacer que analice el `UnitPrice` proporcionado por el usuario como un `Decimal`con formato de moneda.</span><span class="sxs-lookup"><span data-stu-id="9aed8-203">To remedy this we can create an event handler for the GridView's `RowUpdating` event and have it parse the user-supplied `UnitPrice` as a currency-formatted `Decimal`.</span></span>

<span data-ttu-id="9aed8-204">El evento `RowUpdating` de GridView acepta como segundo parámetro un objeto de tipo [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), que incluye un diccionario de `NewValues` como una de sus propiedades que contiene los valores proporcionados por el usuario listos para ser asignados a la colección de `UpdateParameters` de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="9aed8-204">The GridView's `RowUpdating` event accepts as its second parameter an object of type [GridViewUpdateEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), which includes a `NewValues` dictionary as one of its properties that holds the user-supplied values ready to be assigned to the ObjectDataSource's `UpdateParameters` collection.</span></span> <span data-ttu-id="9aed8-205">Podemos sobrescribir el valor de la `UnitPrice` existente en la colección `NewValues` con un valor decimal analizado con el formato de moneda con las siguientes líneas de código en el controlador de eventos `RowUpdating`:</span><span class="sxs-lookup"><span data-stu-id="9aed8-205">We can overwrite the existing `UnitPrice` value in the `NewValues` collection with a decimal value parsed using the currency format with the following lines of code in the `RowUpdating` event handler:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample4.vb)]

<span data-ttu-id="9aed8-206">Si el usuario ha proporcionado un valor `UnitPrice` (como "$19,00"), este valor se sobrescribe con el valor decimal calculado por [decimal. Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), analizando el valor como moneda.</span><span class="sxs-lookup"><span data-stu-id="9aed8-206">If the user has supplied a `UnitPrice` value (such as "$19.00"), this value is overwritten with the decimal value computed by [Decimal.Parse](https://msdn.microsoft.com/library/system.decimal.parse(VS.80).aspx), parsing the value as a currency.</span></span> <span data-ttu-id="9aed8-207">Esto analizará correctamente el decimal en el caso de cualquier símbolo de moneda, comas, puntos decimales, etc., y usará la [enumeración NumberStyles](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) en el espacio de nombres [System. Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) .</span><span class="sxs-lookup"><span data-stu-id="9aed8-207">This will correctly parse the decimal in the event of any currency symbols, commas, decimal points, and so on, and uses the [NumberStyles enumeration](https://msdn.microsoft.com/library/system.globalization.numberstyles(VS.80).aspx) in the [System.Globalization](https://msdn.microsoft.com/library/abeh092z(VS.80).aspx) namespace.</span></span>

<span data-ttu-id="9aed8-208">En la figura 11 se muestra el problema que provocan los símbolos de moneda en el `UnitPrice`proporcionado por el usuario, junto con el modo en que se puede usar el controlador de eventos `RowUpdating` de GridView para analizar correctamente dicha entrada.</span><span class="sxs-lookup"><span data-stu-id="9aed8-208">Figure 11 shows both the problem caused by currency symbols in the user-supplied `UnitPrice`, along with how the GridView's `RowUpdating` event handler can be utilized to correctly parse such input.</span></span>

<span data-ttu-id="9aed8-209">[![el valor UnitPrice de la fila editada ahora tiene el formato de moneda](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-209">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image31.png)</span></span>

<span data-ttu-id="9aed8-210">**Figura 11**: el valor de `UnitPrice` de la fila editada ahora tiene el formato de moneda ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-210">**Figure 11**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image33.png))</span></span>

## <a name="step-2-prohibitingnull-unitprices"></a><span data-ttu-id="9aed8-211">Paso 2: prohibir`NULL UnitPrices`</span><span class="sxs-lookup"><span data-stu-id="9aed8-211">Step 2: Prohibiting`NULL UnitPrices`</span></span>

<span data-ttu-id="9aed8-212">Aunque la base de datos está configurada para permitir `NULL` valores en la columna `UnitPrice` de la tabla `Products`, es posible que desee evitar que los usuarios visiten esta página en concreto para especificar un valor de `UnitPrice` `NULL`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-212">While the database is configured to allow `NULL` values in the `Products` table's `UnitPrice` column, we may want to prevent users visiting this particular page from specifying a `NULL` `UnitPrice` value.</span></span> <span data-ttu-id="9aed8-213">Es decir, si un usuario no puede especificar un valor `UnitPrice` al editar una fila de producto, en lugar de guardar los resultados en la base de datos, deseamos mostrar un mensaje que informa al usuario de que, a través de esta página, los productos editados deben tener un precio especificado.</span><span class="sxs-lookup"><span data-stu-id="9aed8-213">That is, if a user fails to enter a `UnitPrice` value when editing a product row, rather than save the results to the database we want to display a message informing the user that, through this page, any edited products must have a price specified.</span></span>

<span data-ttu-id="9aed8-214">El objeto `GridViewUpdateEventArgs` que se pasa al controlador de eventos `RowUpdating` de GridView contiene una propiedad `Cancel` que, si se establece en `True`, finaliza el proceso de actualización.</span><span class="sxs-lookup"><span data-stu-id="9aed8-214">The `GridViewUpdateEventArgs` object passed into the GridView's `RowUpdating` event handler contains a `Cancel` property that, if set to `True`, terminates the updating process.</span></span> <span data-ttu-id="9aed8-215">Vamos a extender el controlador de eventos `RowUpdating` para establecer `e.Cancel` en `True` y mostrar un mensaje que explique por qué si el valor `UnitPrice` de la colección `NewValues` tiene un valor de `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-215">Let's extend the `RowUpdating` event handler to set `e.Cancel` to `True` and display a message explaining why if the `UnitPrice` value in the `NewValues` collection has a value of `Nothing`.</span></span>

<span data-ttu-id="9aed8-216">Empiece agregando un control Web de etiqueta a la página denominada `MustProvideUnitPriceMessage`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-216">Start by adding a Label Web control to the page named `MustProvideUnitPriceMessage`.</span></span> <span data-ttu-id="9aed8-217">Este control de etiqueta se mostrará si el usuario no puede especificar un valor `UnitPrice` al actualizar un producto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-217">This Label control will be displayed if the user fails to specify a `UnitPrice` value when updating a product.</span></span> <span data-ttu-id="9aed8-218">Establezca la propiedad `Text` de la etiqueta en "debe proporcionar un precio para el producto".</span><span class="sxs-lookup"><span data-stu-id="9aed8-218">Set the Label's `Text` property to "You must provide a price for the product."</span></span> <span data-ttu-id="9aed8-219">También he creado una nueva clase CSS en `Styles.css` denominada `Warning` con la siguiente definición:</span><span class="sxs-lookup"><span data-stu-id="9aed8-219">I've also created a new CSS class in `Styles.css` named `Warning` with the following definition:</span></span>

[!code-css[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample5.css)]

<span data-ttu-id="9aed8-220">Por último, establezca la propiedad `CssClass` de la etiqueta en `Warning`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-220">Finally, set the Label's `CssClass` property to `Warning`.</span></span> <span data-ttu-id="9aed8-221">En este momento, el diseñador debería mostrar el mensaje de advertencia en un tamaño de fuente rojo, negrita, cursiva y extra grande por encima de GridView, como se muestra en la figura 12.</span><span class="sxs-lookup"><span data-stu-id="9aed8-221">At this point the Designer should show the warning message in a red, bold, italic, extra large font size above the GridView, as shown in Figure 12.</span></span>

<span data-ttu-id="9aed8-222">[![se ha agregado una etiqueta sobre GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-222">[![A Label Has Been Added Above the GridView](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image34.png)</span></span>

<span data-ttu-id="9aed8-223">**Figura 12**: se ha agregado una etiqueta encima de GridView ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-223">**Figure 12**: A Label Has Been Added Above the GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image36.png))</span></span>

<span data-ttu-id="9aed8-224">De forma predeterminada, esta etiqueta debe estar oculta, así que establezca su propiedad `Visible` en `False` en el controlador de eventos `Page_Load`:</span><span class="sxs-lookup"><span data-stu-id="9aed8-224">By default, this Label should be hidden, so set its `Visible` property to `False` in the `Page_Load` event handler:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="9aed8-225">Si el usuario intenta actualizar un producto sin especificar el `UnitPrice`, deseamos cancelar la actualización y mostrar la etiqueta de advertencia.</span><span class="sxs-lookup"><span data-stu-id="9aed8-225">If the user attempts to update a product without specifying the `UnitPrice`, we want to cancel the update and display the warning label.</span></span> <span data-ttu-id="9aed8-226">Aumente el controlador de eventos `RowUpdating` de GridView como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="9aed8-226">Augment the GridView's `RowUpdating` event handler as follows:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="9aed8-227">Si un usuario intenta guardar un producto sin especificar un precio, se cancela la actualización y se muestra un mensaje útil.</span><span class="sxs-lookup"><span data-stu-id="9aed8-227">If a user attempts to save a product without specifying a price, the update is cancelled and a helpful message is displayed.</span></span> <span data-ttu-id="9aed8-228">Aunque la base de datos (y la lógica de negocios) permite `NULL` `UnitPrice` s, esta página de ASP.NET en particular no.</span><span class="sxs-lookup"><span data-stu-id="9aed8-228">While the database (and business logic) allows for `NULL` `UnitPrice` s, this particular ASP.NET page does not.</span></span>

<span data-ttu-id="9aed8-229">[![un usuario no puede dejar UnitPrice en blanco](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-229">[![A User Cannot Leave UnitPrice Blank](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image37.png)</span></span>

<span data-ttu-id="9aed8-230">**Figura 13**: un usuario no puede dejar `UnitPrice` en blanco ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-230">**Figure 13**: A User Cannot Leave `UnitPrice` Blank ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image39.png))</span></span>

<span data-ttu-id="9aed8-231">Hasta ahora hemos aprendido a usar el evento `RowUpdating` de GridView para modificar mediante programación los valores de parámetro asignados a la colección de `UpdateParameters` de ObjectDataSource y cómo cancelar el proceso de actualización.</span><span class="sxs-lookup"><span data-stu-id="9aed8-231">So far we have seen how to use the GridView's `RowUpdating` event to programmatically alter the parameter values assigned to the ObjectDataSource's `UpdateParameters` collection as well as how to cancel the updating process altogether.</span></span> <span data-ttu-id="9aed8-232">Estos conceptos se llevan a los controles DetailsView y FormView y también se aplican a la inserción y eliminación.</span><span class="sxs-lookup"><span data-stu-id="9aed8-232">These concepts carry over to the DetailsView and FormView controls and also apply to inserting and deleting.</span></span>

<span data-ttu-id="9aed8-233">Estas tareas también se pueden realizar en el nivel de ObjectDataSource a través de los controladores de eventos para sus eventos `Inserting`, `Updating`y `Deleting`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-233">These tasks can also be done at the ObjectDataSource level through event handlers for its `Inserting`, `Updating`, and `Deleting` events.</span></span> <span data-ttu-id="9aed8-234">Estos eventos se activan antes de que se invoque el método asociado del objeto subyacente y proporcionan una oportunidad de última oportunidad de modificar la colección de parámetros de entrada o cancelar la operación.</span><span class="sxs-lookup"><span data-stu-id="9aed8-234">These events fire before the associated method of the underlying object is invoked and provide a last-chance opportunity to modify the input parameters collection or cancel the operation outright.</span></span> <span data-ttu-id="9aed8-235">A los controladores de eventos de estos tres eventos se les pasa un objeto de tipo [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) que tiene dos propiedades de interés:</span><span class="sxs-lookup"><span data-stu-id="9aed8-235">The event handlers for these three events are passed an object of type [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) that has two properties of interest:</span></span>

- <span data-ttu-id="9aed8-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), que, si se establece en `True`, cancela la operación que se está realizando.</span><span class="sxs-lookup"><span data-stu-id="9aed8-236">[Cancel](https://msdn.microsoft.com/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), which, if set to `True`, cancels the operation being performed</span></span>
- <span data-ttu-id="9aed8-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), que es la colección de `InsertParameters`, `UpdateParameters`o `DeleteParameters`, dependiendo de si el controlador de eventos es para el evento `Inserting`, `Updating`o `Deleting`</span><span class="sxs-lookup"><span data-stu-id="9aed8-237">[InputParameters](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), which is the collection of `InsertParameters`, `UpdateParameters`, or `DeleteParameters`, depending on whether the event handler is for the `Inserting`, `Updating`, or `Deleting` event</span></span>

<span data-ttu-id="9aed8-238">Para ilustrar el trabajo con los valores de parámetro en el nivel de ObjectDataSource, vamos a incluir un DetailsView en la página que permita a los usuarios agregar un nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-238">To illustrate working with the parameter values at the ObjectDataSource level, let's include a DetailsView in our page that allows the users to add a new product.</span></span> <span data-ttu-id="9aed8-239">Este DetailsView se usará para proporcionar una interfaz para agregar rápidamente un nuevo producto a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="9aed8-239">This DetailsView will be used to provide an interface for quickly adding a new product to the database.</span></span> <span data-ttu-id="9aed8-240">Para mantener una interfaz de usuario coherente al agregar un nuevo producto, vamos a permitir que el usuario solo escriba valores para los campos `ProductName` y `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-240">To keep a consistent user interface when adding a new product let's allow the user to only enter values for the `ProductName` and `UnitPrice` fields.</span></span> <span data-ttu-id="9aed8-241">De forma predeterminada, los valores que no se proporcionan en la interfaz de inserción de DetailsView se establecerán en un valor de base de datos `NULL`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-241">By default, those values that aren't supplied in the DetailsView's inserting interface will be set to a `NULL` database value.</span></span> <span data-ttu-id="9aed8-242">Sin embargo, podemos usar el evento `Inserting` de ObjectDataSource para insertar distintos valores predeterminados, como veremos en breve.</span><span class="sxs-lookup"><span data-stu-id="9aed8-242">However, we can use the ObjectDataSource's `Inserting` event to inject different default values, as we'll see shortly.</span></span>

## <a name="step-3-providing-an-interface-to-add-new-products"></a><span data-ttu-id="9aed8-243">Paso 3: proporcionar una interfaz para agregar nuevos productos</span><span class="sxs-lookup"><span data-stu-id="9aed8-243">Step 3: Providing an Interface to Add New Products</span></span>

<span data-ttu-id="9aed8-244">Arrastre un control DetailsView desde el cuadro de herramientas hasta el diseñador situado encima de GridView, borre sus propiedades `Height` y `Width` y enlácelo al ObjectDataSource que ya está presente en la página.</span><span class="sxs-lookup"><span data-stu-id="9aed8-244">Drag a DetailsView from the Toolbox onto the Designer above the GridView, clear out its `Height` and `Width` properties, and bind it to the ObjectDataSource already present on the page.</span></span> <span data-ttu-id="9aed8-245">Esto agregará BoundField o CheckBoxField para cada uno de los campos del producto.</span><span class="sxs-lookup"><span data-stu-id="9aed8-245">This will add a BoundField or CheckBoxField for each of the product's fields.</span></span> <span data-ttu-id="9aed8-246">Como queremos usar este DetailsView para agregar nuevos productos, es necesario activar la opción Habilitar inserción desde la etiqueta inteligente. sin embargo, no hay ninguna opción tal que el método `Insert()` de ObjectDataSource no esté asignado a un método de la clase `ProductsBLL` (Recuerde que establecemos esta asignación en (ninguno) al configurar el origen de datos, consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="9aed8-246">Since we want to use this DetailsView to add new products, we need to check the Enable Inserting option from the smart tag; however, there's no such option because the ObjectDataSource's `Insert()` method is not mapped to a method in the `ProductsBLL` class (recall that we set this mapping to (None) when configuring the data source see Figure 3).</span></span>

<span data-ttu-id="9aed8-247">Para configurar ObjectDataSource, seleccione el vínculo configurar origen de datos de su etiqueta inteligente e inicie el asistente.</span><span class="sxs-lookup"><span data-stu-id="9aed8-247">To configure the ObjectDataSource, select the Configure Data Source link from its smart tag, launching the wizard.</span></span> <span data-ttu-id="9aed8-248">La primera pantalla permite cambiar el objeto subyacente al que está enlazado ObjectDataSource; déjelo establecido en `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-248">The first screen allows you to change the underlying object the ObjectDataSource is bound to; leave it set to `ProductsBLL`.</span></span> <span data-ttu-id="9aed8-249">En la pantalla siguiente se enumeran las asignaciones de los métodos de ObjectDataSource a la del objeto subyacente.</span><span class="sxs-lookup"><span data-stu-id="9aed8-249">The next screen lists the mappings from the ObjectDataSource's methods to the underlying object's.</span></span> <span data-ttu-id="9aed8-250">Aunque hemos indicado explícitamente que los métodos `Insert()` y `Delete()` no deben asignarse a ningún método, si va a las pestañas insertar y eliminar, verá que hay una asignación ahí.</span><span class="sxs-lookup"><span data-stu-id="9aed8-250">Even though we explicitly indicated that the `Insert()` and `Delete()` methods should not be mapped to any methods, if you go to the INSERT and DELETE tabs you'll see that a mapping is there.</span></span> <span data-ttu-id="9aed8-251">Esto se debe a que los métodos `AddProduct` y `DeleteProduct` del `ProductsBLL`usan el atributo `DataObjectMethodAttribute` para indicar que son los métodos predeterminados para `Insert()` y `Delete()`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="9aed8-251">This is because the `ProductsBLL`'s `AddProduct` and `DeleteProduct` methods use the `DataObjectMethodAttribute` attribute to indicate that they are the default methods for `Insert()` and `Delete()`, respectively.</span></span> <span data-ttu-id="9aed8-252">Por lo tanto, el Asistente de ObjectDataSource las selecciona cada vez que se ejecuta el asistente, a menos que se especifique otro valor explícitamente.</span><span class="sxs-lookup"><span data-stu-id="9aed8-252">Hence, the ObjectDataSource wizard selects these each time you run the wizard unless there's some other value explicitly specified.</span></span>

<span data-ttu-id="9aed8-253">Deje el método de `Insert()` que apunta al método `AddProduct`, pero establezca de nuevo la lista desplegable de la pestaña eliminar en (ninguno).</span><span class="sxs-lookup"><span data-stu-id="9aed8-253">Leave the `Insert()` method pointing to the `AddProduct` method, but again set the DELETE tab's drop-down list to (None).</span></span>

<span data-ttu-id="9aed8-254">[![establecer la lista desplegable de la pestaña insertar en el método AddProduct](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-254">[![Set the INSERT Tab's Drop-Down List to the AddProduct Method](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image40.png)</span></span>

<span data-ttu-id="9aed8-255">**Figura 14**: establezca la lista desplegable de la pestaña insertar en el método `AddProduct` ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-255">**Figure 14**: Set the INSERT Tab's Drop-Down List to the `AddProduct` Method ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image42.png))</span></span>

<span data-ttu-id="9aed8-256">[![establecer la lista desplegable de la pestaña eliminar en (ninguna)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-256">[![Set the DELETE Tab's Drop-Down List to (None)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image43.png)</span></span>

<span data-ttu-id="9aed8-257">**Figura 15**: establezca la lista desplegable de la pestaña eliminar en (ninguna) ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-257">**Figure 15**: Set the DELETE Tab's Drop-Down List to (None) ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image45.png))</span></span>

<span data-ttu-id="9aed8-258">Después de realizar estos cambios, la sintaxis declarativa de ObjectDataSource se expandirá para incluir una `InsertParameters` colección, como se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="9aed8-258">After making these changes, the ObjectDataSource's declarative syntax will be expanded to include an `InsertParameters` collection, as shown below:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample8.aspx)]

<span data-ttu-id="9aed8-259">Al volver a ejecutar el asistente, se agrega la propiedad `OldValuesParameterFormatString`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-259">Rerunning the wizard added back the `OldValuesParameterFormatString` property.</span></span> <span data-ttu-id="9aed8-260">Dedique un momento a borrar esta propiedad estableciéndolo en el valor predeterminado (`{0}`) o quitándolo por completo de la sintaxis declarativa.</span><span class="sxs-lookup"><span data-stu-id="9aed8-260">Take a moment to clear this property by setting it to the default value (`{0}`) or removing it altogether from the declarative syntax.</span></span>

<span data-ttu-id="9aed8-261">Con ObjectDataSource que proporciona funcionalidades de inserción, la etiqueta inteligente de DetailsView incluirá ahora la casilla habilitar inserción. vuelva al diseñador y Active esta opción.</span><span class="sxs-lookup"><span data-stu-id="9aed8-261">With the ObjectDataSource providing inserting capabilities, the DetailsView's smart tag will now include the Enable Inserting checkbox; return to the Designer and check this option.</span></span> <span data-ttu-id="9aed8-262">A continuación, reduzca el objeto DetailsView para que solo tenga dos `ProductName` BoundFields y `UnitPrice`, y CommandField.</span><span class="sxs-lookup"><span data-stu-id="9aed8-262">Next, pare down the DetailsView so that it only has two BoundFields - `ProductName` and `UnitPrice` - and the CommandField.</span></span> <span data-ttu-id="9aed8-263">En este punto, la sintaxis declarativa de DetailsView debe ser similar a la siguiente:</span><span class="sxs-lookup"><span data-stu-id="9aed8-263">At this point the DetailsView's declarative syntax should look like:</span></span>

[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample9.aspx)]

<span data-ttu-id="9aed8-264">La figura 16 muestra esta página cuando se ve a través de un explorador en este momento.</span><span class="sxs-lookup"><span data-stu-id="9aed8-264">Figure 16 shows this page when viewed through a browser at this point.</span></span> <span data-ttu-id="9aed8-265">Como puede ver, DetailsView muestra el nombre y el precio del primer producto (Chai).</span><span class="sxs-lookup"><span data-stu-id="9aed8-265">As you can see, the DetailsView lists the name and price of the first product (Chai).</span></span> <span data-ttu-id="9aed8-266">Lo que queremos, sin embargo, es una interfaz de inserción que proporciona un medio para que el usuario agregue rápidamente un nuevo producto a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="9aed8-266">What we want, however, is an inserting interface that provides a means for the user to quickly add a new product to the database.</span></span>

<span data-ttu-id="9aed8-267">[![DetailsView se representa actualmente en modo de solo lectura](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-267">[![The DetailsView is Currently Rendered in Read-Only Mode](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image46.png)</span></span>

<span data-ttu-id="9aed8-268">**Figura 16**: DetailsView se representa actualmente en modo de solo lectura ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-268">**Figure 16**: The DetailsView is Currently Rendered in Read-Only Mode ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image48.png))</span></span>

<span data-ttu-id="9aed8-269">Para mostrar DetailsView en el modo de inserción, es necesario establecer la propiedad `DefaultMode` en `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-269">In order to show the DetailsView in its inserting mode we need to set the `DefaultMode` property to `Inserting`.</span></span> <span data-ttu-id="9aed8-270">Esto representa DetailsView en modo de inserción cuando se visita por primera vez y lo mantiene después de insertar un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="9aed8-270">This renders the DetailsView in insert mode when first visited and keeps it there after inserting a new record.</span></span> <span data-ttu-id="9aed8-271">Como se muestra en la figura 17, este tipo de DetailsView proporciona una interfaz rápida para agregar un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="9aed8-271">As Figure 17 shows, such a DetailsView provides a quick interface for adding a new record.</span></span>

<span data-ttu-id="9aed8-272">[![DetailsView proporciona una interfaz para agregar rápidamente un nuevo producto](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-272">[![The DetailsView Provides an Interface for Quickly Adding a New Product](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image49.png)</span></span>

<span data-ttu-id="9aed8-273">**Figura 17**: DetailsView proporciona una interfaz para agregar rápidamente un nuevo producto ([haga clic para ver la imagen de tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-273">**Figure 17**: The DetailsView Provides an Interface for Quickly Adding a New Product ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image51.png))</span></span>

<span data-ttu-id="9aed8-274">Cuando el usuario escribe un nombre de producto y un precio (como "Acme Water" y 1,99, como en la figura 17) y hace clic en INSERT, se genera un postback y el flujo de trabajo de inserción comienza, y culmina en un nuevo registro de producto que se va a agregar a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="9aed8-274">When the user enters a product name and price (such as "Acme Water" and 1.99, as in Figure 17) and clicks Insert, a postback ensues and the inserting workflow commences, culminating in a new product record being added to the database.</span></span> <span data-ttu-id="9aed8-275">DetailsView mantiene su interfaz de inserción y el control GridView se reenlaza automáticamente a su origen de datos para incluir el nuevo producto, como se muestra en la figura 18.</span><span class="sxs-lookup"><span data-stu-id="9aed8-275">The DetailsView maintains its inserting interface and the GridView is automatically rebound to its data source in order to include the new product, as shown in Figure 18.</span></span>

![El producto](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image52.png)

<span data-ttu-id="9aed8-277">**Figura 18**: el producto "Acme Water" se ha agregado a la base de datos</span><span class="sxs-lookup"><span data-stu-id="9aed8-277">**Figure 18**: The Product "Acme Water" Has Been Added to the Database</span></span>

<span data-ttu-id="9aed8-278">Aunque el control GridView de la figura 18 no lo muestra, los campos de producto que carecen de la interfaz DetailsView `CategoryID`, `SupplierID`, `QuantityPerUnit`, etc., se asignan `NULL` valores de base de datos.</span><span class="sxs-lookup"><span data-stu-id="9aed8-278">While the GridView in Figure 18 doesn't show it, the product fields lacking from the DetailsView interface `CategoryID`, `SupplierID`, `QuantityPerUnit`, and so on are assigned `NULL` database values.</span></span> <span data-ttu-id="9aed8-279">Para ver esto, realice los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="9aed8-279">You can see this by performing the following steps:</span></span>

1. <span data-ttu-id="9aed8-280">Vaya al Explorador de servidores en Visual Studio</span><span class="sxs-lookup"><span data-stu-id="9aed8-280">Go to the Server Explorer in Visual Studio</span></span>
2. <span data-ttu-id="9aed8-281">Expandir el nodo de base de datos `NORTHWND.MDF`</span><span class="sxs-lookup"><span data-stu-id="9aed8-281">Expanding the `NORTHWND.MDF` database node</span></span>
3. <span data-ttu-id="9aed8-282">Haga clic con el botón secundario en el nodo tabla de base de datos `Products`</span><span class="sxs-lookup"><span data-stu-id="9aed8-282">Right-click on the `Products` database table node</span></span>
4. <span data-ttu-id="9aed8-283">Seleccionar Mostrar datos de tabla</span><span class="sxs-lookup"><span data-stu-id="9aed8-283">Select Show Table Data</span></span>

<span data-ttu-id="9aed8-284">Se mostrarán todos los registros de la tabla `Products`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-284">This will list all of the records in the `Products` table.</span></span> <span data-ttu-id="9aed8-285">Como se muestra en la figura 19, todas las columnas de los nuevos productos que no sean `ProductID`, `ProductName`y `UnitPrice` tienen `NULL` valores.</span><span class="sxs-lookup"><span data-stu-id="9aed8-285">As Figure 19 shows, all of our new product's columns other than `ProductID`, `ProductName`, and `UnitPrice` have `NULL` values.</span></span>

<span data-ttu-id="9aed8-286">[![los campos Product no proporcionados en DetailsView tienen asignados valores NULL](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-286">[![The Product Fields Not Provided in the DetailsView are Assigned NULL Values](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image53.png)</span></span>

<span data-ttu-id="9aed8-287">**Figura 19**: los campos de producto no proporcionados en DetailsView se asignan `NULL` valores ([haga clic para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-287">**Figure 19**: The Product Fields Not Provided in the DetailsView are Assigned `NULL` Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image55.png))</span></span>

<span data-ttu-id="9aed8-288">Es posible que deseemos proporcionar un valor predeterminado que no sea `NULL` para uno o varios de estos valores de columna, ya sea porque `NULL` no es la mejor opción predeterminada o porque la propia columna de base de datos no permite `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="9aed8-288">We may want to provide a default value other than `NULL` for one or more of these column values, either because `NULL` isn't the best default option or because the database column itself doesn't allow `NULL` s.</span></span> <span data-ttu-id="9aed8-289">Para lograr esto, se pueden establecer mediante programación los valores de los parámetros de la colección de `InputParameters` de DetailsView.</span><span class="sxs-lookup"><span data-stu-id="9aed8-289">To accomplish this we can programmatically set the values of the parameters of the DetailsView's `InputParameters` collection.</span></span> <span data-ttu-id="9aed8-290">Esta asignación se puede realizar en el controlador de eventos para el evento `ItemInserting` de DetailsView o el evento `Inserting` de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="9aed8-290">This assignment can be done either in the event handler for the DetailsView's `ItemInserting` event or the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="9aed8-291">Dado que ya hemos examinado el uso de los eventos de nivel anterior y posterior en el nivel de control Web de datos, vamos a explorar el uso de los eventos de ObjectDataSource esta vez.</span><span class="sxs-lookup"><span data-stu-id="9aed8-291">Since we've already looked at using the pre- and post-level events at the data Web control level, let's explore using the ObjectDataSource's events this time.</span></span>

## <a name="step-4-assigning-values-to-thecategoryidandsupplieridparameters"></a><span data-ttu-id="9aed8-292">Paso 4: asignar valores a los parámetros`CategoryID`y`SupplierID`</span><span class="sxs-lookup"><span data-stu-id="9aed8-292">Step 4: Assigning Values to the`CategoryID`and`SupplierID`Parameters</span></span>

<span data-ttu-id="9aed8-293">En este tutorial, supongamos que para nuestra aplicación al agregar un nuevo producto a través de esta interfaz, se le debe asignar un `CategoryID` y `SupplierID` valor de 1.</span><span class="sxs-lookup"><span data-stu-id="9aed8-293">For this tutorial let's imagine that for our application when adding a new product through this interface it should be assigned a `CategoryID` and `SupplierID` value of 1.</span></span> <span data-ttu-id="9aed8-294">Como se mencionó anteriormente, ObjectDataSource tiene un par de eventos anteriores y posteriores que se activan durante el proceso de modificación de datos.</span><span class="sxs-lookup"><span data-stu-id="9aed8-294">As mentioned earlier, the ObjectDataSource has a pair of pre- and post-level events that fire during the data modification process.</span></span> <span data-ttu-id="9aed8-295">Cuando se invoca su método de `Insert()`, ObjectDataSource genera primero su evento `Inserting`, llama al método al que se ha asignado su método `Insert()` y, por último, genera el evento `Inserted`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-295">When its `Insert()` method is invoked, the ObjectDataSource first raises its `Inserting` event, then calls the method that its `Insert()` method has been mapped to, and finally raises the `Inserted` event.</span></span> <span data-ttu-id="9aed8-296">El controlador de eventos `Inserting` nos ofrece una última oportunidad para ajustar los parámetros de entrada o cancelar la operación.</span><span class="sxs-lookup"><span data-stu-id="9aed8-296">The `Inserting` event handler affords us one last opportunity to tweak the input parameters or cancel the operation outright.</span></span>

> [!NOTE]
> <span data-ttu-id="9aed8-297">En una aplicación real, probablemente desee permitir que el usuario especifique la categoría y el proveedor, o bien elegir este valor en función de algunos criterios o lógica de negocios (en lugar de seleccionar ciegamente un identificador de 1).</span><span class="sxs-lookup"><span data-stu-id="9aed8-297">In a real-world application you would likely want to either let the user specify the category and supplier or would pick this value for them based on some criteria or business logic (rather than blindly selecting an ID of 1).</span></span> <span data-ttu-id="9aed8-298">Independientemente de, en el ejemplo se muestra cómo establecer mediante programación el valor de un parámetro de entrada desde el evento de nivel anterior de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="9aed8-298">Regardless, the example illustrates how to programmatically set the value of an input parameter from the ObjectDataSource's pre-level event.</span></span>

<span data-ttu-id="9aed8-299">Dedique un momento a crear un controlador de eventos para el evento de `Inserting` de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="9aed8-299">Take a moment to create an event handler for the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="9aed8-300">Observe que el segundo parámetro de entrada del controlador de eventos es un objeto de tipo `ObjectDataSourceMethodEventArgs`, que tiene una propiedad para tener acceso a la colección de parámetros (`InputParameters`) y una propiedad para cancelar la operación (`Cancel`).</span><span class="sxs-lookup"><span data-stu-id="9aed8-300">Notice that the event handler's second input parameter is an object of type `ObjectDataSourceMethodEventArgs`, which has a property to access the parameters collection (`InputParameters`) and a property to cancel the operation (`Cancel`).</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample10.vb)]

<span data-ttu-id="9aed8-301">En este punto, la propiedad `InputParameters` contiene la colección de `InsertParameters` de ObjectDataSource con los valores asignados desde DetailsView.</span><span class="sxs-lookup"><span data-stu-id="9aed8-301">At this point, the `InputParameters` property contains the ObjectDataSource's `InsertParameters` collection with the values assigned from the DetailsView.</span></span> <span data-ttu-id="9aed8-302">Para cambiar el valor de uno de estos parámetros, basta con usar: `e.InputParameters("paramName") = value`.</span><span class="sxs-lookup"><span data-stu-id="9aed8-302">To change the value of one of these parameters, simply use: `e.InputParameters("paramName") = value`.</span></span> <span data-ttu-id="9aed8-303">Por lo tanto, para establecer el `CategoryID` y el `SupplierID` en los valores de 1, ajuste el controlador de eventos `Inserting` de modo que se parezca a lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="9aed8-303">Therefore, to set the `CategoryID` and `SupplierID` to values of 1, adjust the `Inserting` event handler to look like the following:</span></span>

[!code-vb[Main](examining-the-events-associated-with-inserting-updating-and-deleting-vb/samples/sample11.vb)]

<span data-ttu-id="9aed8-304">Esta vez, al agregar un nuevo producto (por ejemplo, Acme soda), las columnas `CategoryID` y `SupplierID` del nuevo producto se establecen en 1 (vea la figura 20).</span><span class="sxs-lookup"><span data-stu-id="9aed8-304">This time when adding a new product (such as Acme Soda), the `CategoryID` and `SupplierID` columns of the new product are set to 1 (see Figure 20).</span></span>

<span data-ttu-id="9aed8-305">[![nuevos productos tienen los valores CategoryID y SupplierID establecidos en 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="9aed8-305">[![New Products Now Have Their CategoryID and SupplierID Values Set to 1](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image56.png)</span></span>

<span data-ttu-id="9aed8-306">**Figura 20**: ahora, los nuevos productos tienen sus valores `CategoryID` y `SupplierID` establecidos en 1 ([haga clic para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="9aed8-306">**Figure 20**: New Products Now Have Their `CategoryID` and `SupplierID` Values Set to 1 ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-vb/_static/image58.png))</span></span>

## <a name="summary"></a><span data-ttu-id="9aed8-307">Resumen</span><span class="sxs-lookup"><span data-stu-id="9aed8-307">Summary</span></span>

<span data-ttu-id="9aed8-308">Durante el proceso de edición, inserción y eliminación, tanto el control Web de datos como ObjectDataSource continúan a través de una serie de eventos previos y posteriores.</span><span class="sxs-lookup"><span data-stu-id="9aed8-308">During the editing, inserting, and deleting process, both the data Web control and the ObjectDataSource proceed through a number of pre- and post-level events.</span></span> <span data-ttu-id="9aed8-309">En este tutorial se han examinado los eventos de nivel anterior y se ha visto cómo se usan para personalizar los parámetros de entrada o cancelar la operación de modificación de datos, tanto desde el control Web de datos como desde los eventos de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="9aed8-309">In this tutorial we examined the pre-level events and saw how to use these to customize the input parameters or cancel the data modification operation altogether both from the data Web control and ObjectDataSource's events.</span></span> <span data-ttu-id="9aed8-310">En el siguiente tutorial, veremos cómo crear y usar controladores de eventos para los eventos de nivel posterior.</span><span class="sxs-lookup"><span data-stu-id="9aed8-310">In the next tutorial we'll look at creating and using event handlers for the post-level events.</span></span>

<span data-ttu-id="9aed8-311">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="9aed8-311">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="9aed8-312">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="9aed8-312">About the Author</span></span>

<span data-ttu-id="9aed8-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros de ASP/ASP. net y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="9aed8-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9aed8-314">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="9aed8-314">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9aed8-315">Su último libro se [*enseña a ASP.NET 2,0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="9aed8-315">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="9aed8-316">Puede ponerse en contacto con usted en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9aed8-316">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="9aed8-317">o a través de su blog, que encontrará en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="9aed8-317">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="9aed8-318">Agradecimiento especial a</span><span class="sxs-lookup"><span data-stu-id="9aed8-318">Special Thanks To</span></span>

<span data-ttu-id="9aed8-319">Muchos revisores útiles revisaron esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="9aed8-319">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9aed8-320">Los revisores de clientes potenciales de este tutorial eran Jackie Goor y Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="9aed8-320">Lead reviewers for this tutorial were Jackie Goor and Liz Shulok.</span></span> <span data-ttu-id="9aed8-321">¿Está interesado en revisar los próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="9aed8-321">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9aed8-322">En caso afirmativo, suéltelo en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9aed8-322">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9aed8-323">[Anterior](an-overview-of-inserting-updating-and-deleting-data-vb.md)
> [Siguiente](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span><span class="sxs-lookup"><span data-stu-id="9aed8-323">[Previous](an-overview-of-inserting-updating-and-deleting-data-vb.md)
[Next](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md)</span></span>

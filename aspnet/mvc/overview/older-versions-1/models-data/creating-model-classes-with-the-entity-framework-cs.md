---
uid: mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
title: Crear clases de modelo con el Entity FrameworkC#() | Microsoft Docs
author: microsoft
description: En este tutorial, aprenderá a usar ASP.NET MVC con Microsoft Entity Framework. Aprenderá a usar el Asistente para entidades para crear una entidad ADO.NET...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 61644169-e8b1-45dd-bf96-9c2301b69879
msc.legacyurl: /mvc/overview/older-versions-1/models-data/creating-model-classes-with-the-entity-framework-cs
msc.type: authoredcontent
ms.openlocfilehash: 2e0e365c287fc455015d237ea466301335805d14
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78469441"
---
# <a name="creating-model-classes-with-the-entity-framework-c"></a><span data-ttu-id="66afc-104">Crear clases de modelo con Entity Framework (C#)</span><span class="sxs-lookup"><span data-stu-id="66afc-104">Creating Model Classes with the Entity Framework (C#)</span></span>

<span data-ttu-id="66afc-105">por [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="66afc-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="66afc-106">En este tutorial, aprenderá a usar ASP.NET MVC con Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="66afc-106">In this tutorial, you learn how to use ASP.NET MVC with the Microsoft Entity Framework.</span></span> <span data-ttu-id="66afc-107">Aprenderá a usar el Asistente para entidades para crear una Entity Data Model ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="66afc-107">You learn how to use the Entity Wizard to create an ADO.NET Entity Data Model.</span></span> <span data-ttu-id="66afc-108">En el transcurso de este tutorial, se crea una aplicación web que muestra cómo seleccionar, insertar, actualizar y eliminar datos de la base de datos mediante el Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="66afc-108">Over the course of this tutorial, we build a web application that illustrates how to select, insert, update, and delete database data by using the Entity Framework.</span></span>

<span data-ttu-id="66afc-109">El objetivo de este tutorial es explicar cómo puede crear clases de acceso a datos mediante Microsoft Entity Framework al compilar una aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="66afc-109">The goal of this tutorial is to explain how you can create data access classes using the Microsoft Entity Framework when building an ASP.NET MVC application.</span></span> <span data-ttu-id="66afc-110">En este tutorial se supone que no tiene ningún conocimiento previo de Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="66afc-110">This tutorial assumes no previous knowledge of the Microsoft Entity Framework.</span></span> <span data-ttu-id="66afc-111">Al final de este tutorial, aprenderá a usar el Entity Framework para seleccionar, insertar, actualizar y eliminar registros de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-111">By the end of this tutorial, you'll understand how to use the Entity Framework to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="66afc-112">Microsoft Entity Framework es una herramienta de asignación relacional de objetos (O/RM) que permite generar automáticamente una capa de acceso a datos a partir de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-112">The Microsoft Entity Framework is an Object Relational Mapping (O/RM) tool that enables you to generate a data access layer from a database automatically.</span></span> <span data-ttu-id="66afc-113">El Entity Framework le permite evitar el trabajo tedioso de crear clases de acceso a datos a mano.</span><span class="sxs-lookup"><span data-stu-id="66afc-113">The Entity Framework enables you to avoid the tedious work of building your data access classes by hand.</span></span>

<span data-ttu-id="66afc-114">Para ilustrar cómo puede usar Microsoft Entity Framework con ASP.NET MVC, crearemos una sencilla aplicación de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="66afc-114">In order to illustrate how you can use the Microsoft Entity Framework with ASP.NET MVC, we'll build a simple sample application.</span></span> <span data-ttu-id="66afc-115">Vamos a crear una aplicación de base de datos de películas que le permita mostrar y editar los registros de la base de datos de películas.</span><span class="sxs-lookup"><span data-stu-id="66afc-115">We'll create a Movie Database application that enables you to display and edit movie database records.</span></span>

<span data-ttu-id="66afc-116">En este tutorial se supone que tiene Visual Studio 2008 o Visual Web Developer 2008 con Service Pack 1.</span><span class="sxs-lookup"><span data-stu-id="66afc-116">This tutorial assumes that you have Visual Studio 2008 or Visual Web Developer 2008 with Service Pack 1.</span></span> <span data-ttu-id="66afc-117">Necesita el Service Pack 1 para poder usar el Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="66afc-117">You need Service Pack 1 in order to use the Entity Framework.</span></span> <span data-ttu-id="66afc-118">Puede descargar Visual Studio 2008 Service Pack 1 o Visual Web Developer con Service Pack 1 desde la siguiente dirección:</span><span class="sxs-lookup"><span data-stu-id="66afc-118">You can download Visual Studio 2008 Service Pack 1 or Visual Web Developer with Service Pack 1 from the following address:</span></span>

> [https://www.asp.net/downloads/](https://www.asp.net/downloads)

> [!NOTE] 
> 
> <span data-ttu-id="66afc-119">No hay ninguna conexión esencial entre ASP.NET MVC y Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="66afc-119">There is no essential connection between ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="66afc-120">Hay varias alternativas a la Entity Framework que puede usar con ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="66afc-120">There are several alternatives to the Entity Framework that you can use with ASP.NET MVC.</span></span> <span data-ttu-id="66afc-121">Por ejemplo, puede compilar las clases de modelo de MVC con otras herramientas de O/RM como Microsoft LINQ to SQL, NHibernate o Subsonic.</span><span class="sxs-lookup"><span data-stu-id="66afc-121">For example, you can build your MVC Model classes using other O/RM tools such as Microsoft LINQ to SQL, NHibernate, or SubSonic.</span></span>

## <a name="creating-the-movie-sample-database"></a><span data-ttu-id="66afc-122">Crear la base de datos de ejemplo Movie</span><span class="sxs-lookup"><span data-stu-id="66afc-122">Creating the Movie Sample Database</span></span>

<span data-ttu-id="66afc-123">La aplicación de base de datos de películas utiliza una tabla de base de datos denominada películas que contiene las columnas siguientes:</span><span class="sxs-lookup"><span data-stu-id="66afc-123">The Movie Database application uses a database table named Movies that contains the following columns:</span></span>

| <span data-ttu-id="66afc-124">Nombre de columna</span><span class="sxs-lookup"><span data-stu-id="66afc-124">Column Name</span></span> | <span data-ttu-id="66afc-125">Tipo de datos</span><span class="sxs-lookup"><span data-stu-id="66afc-125">Data Type</span></span> | <span data-ttu-id="66afc-126">¿Permitir valores NULL?</span><span class="sxs-lookup"><span data-stu-id="66afc-126">Allow Nulls?</span></span> | <span data-ttu-id="66afc-127">¿Es la clave principal?</span><span class="sxs-lookup"><span data-stu-id="66afc-127">Is Primary Key?</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="66afc-128">Id.</span><span class="sxs-lookup"><span data-stu-id="66afc-128">Id</span></span> | <span data-ttu-id="66afc-129">int</span><span class="sxs-lookup"><span data-stu-id="66afc-129">int</span></span> | <span data-ttu-id="66afc-130">False</span><span class="sxs-lookup"><span data-stu-id="66afc-130">False</span></span> | <span data-ttu-id="66afc-131">True</span><span class="sxs-lookup"><span data-stu-id="66afc-131">True</span></span> |
| <span data-ttu-id="66afc-132">Título</span><span class="sxs-lookup"><span data-stu-id="66afc-132">Title</span></span> | <span data-ttu-id="66afc-133">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="66afc-133">nvarchar(100)</span></span> | <span data-ttu-id="66afc-134">False</span><span class="sxs-lookup"><span data-stu-id="66afc-134">False</span></span> | <span data-ttu-id="66afc-135">False</span><span class="sxs-lookup"><span data-stu-id="66afc-135">False</span></span> |
| <span data-ttu-id="66afc-136">Director</span><span class="sxs-lookup"><span data-stu-id="66afc-136">Director</span></span> | <span data-ttu-id="66afc-137">nvarchar(100)</span><span class="sxs-lookup"><span data-stu-id="66afc-137">nvarchar(100)</span></span> | <span data-ttu-id="66afc-138">False</span><span class="sxs-lookup"><span data-stu-id="66afc-138">False</span></span> | <span data-ttu-id="66afc-139">False</span><span class="sxs-lookup"><span data-stu-id="66afc-139">False</span></span> |

<span data-ttu-id="66afc-140">Puede Agregar esta tabla a un proyecto de ASP.NET MVC siguiendo estos pasos:</span><span class="sxs-lookup"><span data-stu-id="66afc-140">You can add this table to an ASP.NET MVC project by following these steps:</span></span>

1. <span data-ttu-id="66afc-141">Haga clic con el botón derecho en la carpeta\_de datos de la aplicación en la ventana de Explorador de soluciones y seleccione la opción de menú **Agregar, nuevo elemento.**</span><span class="sxs-lookup"><span data-stu-id="66afc-141">Right-click the App\_Data folder in the Solution Explorer window and select the menu option **Add, New Item.**</span></span>
2. <span data-ttu-id="66afc-142">En el cuadro de diálogo **Agregar nuevo elemento** , seleccione **SQL Server base de datos**, asigne al nombre de la base de datos el nombre MoviesDB. MDF y haga clic en el botón **Agregar** .</span><span class="sxs-lookup"><span data-stu-id="66afc-142">From the **Add New Item** dialog box, select **SQL Server Database**, give the database the name MoviesDB.mdf, and click the **Add** button.</span></span>
3. <span data-ttu-id="66afc-143">Haga doble clic en el archivo MoviesDB. MDF para abrir la ventana Explorador de servidores/Explorador de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-143">Double-click the MoviesDB.mdf file to open the Server Explorer/Database Explorer window.</span></span>
4. <span data-ttu-id="66afc-144">Expanda la conexión de base de datos MoviesDB. MDF, haga clic con el botón secundario en la carpeta tablas y seleccione la opción de menú **Agregar nueva tabla**.</span><span class="sxs-lookup"><span data-stu-id="66afc-144">Expand the MoviesDB.mdf database connection, right-click the Tables folder, and select the menu option **Add New Table**.</span></span>
5. <span data-ttu-id="66afc-145">En el Diseñador de tablas, agregue las columnas ID, title y director.</span><span class="sxs-lookup"><span data-stu-id="66afc-145">In the Table Designer, add the Id, Title, and Director columns.</span></span>
6. <span data-ttu-id="66afc-146">Haga clic en el botón **Guardar** (tiene el icono del disquete) para guardar la nueva tabla con el nombre movies.</span><span class="sxs-lookup"><span data-stu-id="66afc-146">Click the **Save** button (it has the icon of the floppy) to save the new table with the name Movies.</span></span>

<span data-ttu-id="66afc-147">Después de crear la tabla de base de datos de películas, debe agregar algunos datos de ejemplo a la tabla.</span><span class="sxs-lookup"><span data-stu-id="66afc-147">After you create the Movies database table, you should add some sample data to the table.</span></span> <span data-ttu-id="66afc-148">Haga clic con el botón secundario en la tabla películas y seleccione la opción de menú **Mostrar datos de tabla**.</span><span class="sxs-lookup"><span data-stu-id="66afc-148">Right-click the Movies table and select the menu option **Show Table Data**.</span></span> <span data-ttu-id="66afc-149">Puede escribir datos de película falsos en la cuadrícula que aparece.</span><span class="sxs-lookup"><span data-stu-id="66afc-149">You can enter fake movie data into the grid that appears.</span></span>

## <a name="creating-the-adonet-entity-data-model"></a><span data-ttu-id="66afc-150">Crear la Entity Data Model ADO.NET</span><span class="sxs-lookup"><span data-stu-id="66afc-150">Creating the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="66afc-151">Para usar el Entity Framework, debe crear un Entity Data Model.</span><span class="sxs-lookup"><span data-stu-id="66afc-151">In order to use the Entity Framework, you need to create an Entity Data Model.</span></span> <span data-ttu-id="66afc-152">Puede aprovechar las ventajas del *Asistente para Entity Data Model* de Visual Studio para generar un Entity Data Model a partir de una base de datos automáticamente.</span><span class="sxs-lookup"><span data-stu-id="66afc-152">You can take advantage of the Visual Studio *Entity Data Model Wizard* to generate an Entity Data Model from a database automatically.</span></span>

<span data-ttu-id="66afc-153">Siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="66afc-153">Follow these steps:</span></span>

1. <span data-ttu-id="66afc-154">Haga clic con el botón secundario en la carpeta modelos de la ventana de Explorador de soluciones y seleccione la opción de menú **Agregar, nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="66afc-154">Right-click the Models folder in the Solution Explorer window and select the menu option **Add, New Item**.</span></span>
2. <span data-ttu-id="66afc-155">En el cuadro de diálogo **Agregar nuevo elemento** , seleccione la categoría de datos (vea la ilustración 1).</span><span class="sxs-lookup"><span data-stu-id="66afc-155">In the **Add New Item** dialog, select the Data category (see Figure 1).</span></span>
3. <span data-ttu-id="66afc-156">Seleccione la plantilla **ADO.NET Entity Data Model** , asigne al Entity Data Model el nombre MoviesDBModel. edmx y haga clic en el botón **Agregar** .</span><span class="sxs-lookup"><span data-stu-id="66afc-156">Select the **ADO.NET Entity Data Model** template, give the Entity Data Model the name MoviesDBModel.edmx, and click the **Add** button.</span></span> <span data-ttu-id="66afc-157">Al hacer clic en el botón **Agregar** se inicia el Asistente para modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-157">Clicking the **Add** button launches the Data Model Wizard.</span></span>
4. <span data-ttu-id="66afc-158">En el paso **elegir contenido del modelo** , elija la opción **generar desde una base de datos** y haga clic en el botón **siguiente** (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="66afc-158">In the **Choose Model Contents** step, choose the **Generate from a database** option and click the **Next** button (see Figure 2).</span></span>
5. <span data-ttu-id="66afc-159">En el paso **elegir la conexión de datos** , seleccione la conexión de base de datos MoviesDB. MDF, escriba el nombre de configuración de la conexión de entidades MoviesDBEntities y haga clic en el botón **siguiente** (vea la figura 3).</span><span class="sxs-lookup"><span data-stu-id="66afc-159">In the **Choose Your Data Connection** step, select the MoviesDB.mdf database connection, enter the entities connection settings name MoviesDBEntities, and click the **Next** button (see Figure 3).</span></span>
6. <span data-ttu-id="66afc-160">En el paso **elegir los objetos de base de datos** , seleccione la tabla de la base de datos de películas y haga clic en el botón **Finalizar** (consulte la figura 4).</span><span class="sxs-lookup"><span data-stu-id="66afc-160">In the **Choose Your Database Objects** step, select the Movie database table and click the **Finish** button (see Figure 4).</span></span>

<span data-ttu-id="66afc-161">Después de completar estos pasos, se abre ADO.NET Entity Data Model Designer (Entity Designer).</span><span class="sxs-lookup"><span data-stu-id="66afc-161">After you complete these steps, the ADO.NET Entity Data Model Designer (Entity Designer) opens.</span></span>

<span data-ttu-id="66afc-162">**Figura 1: creación de una nueva Entity Data Model**</span><span class="sxs-lookup"><span data-stu-id="66afc-162">**Figure 1 – Creating a new Entity Data Model**</span></span>

![clip_image002](creating-model-classes-with-the-entity-framework-cs/_static/image1.jpg)

<span data-ttu-id="66afc-164">**Ilustración 2: paso elegir el contenido del modelo**</span><span class="sxs-lookup"><span data-stu-id="66afc-164">**Figure 2 – Choose Model Contents Step**</span></span>

![clip_image004](creating-model-classes-with-the-entity-framework-cs/_static/image2.jpg)

<span data-ttu-id="66afc-166">**Figura 3: selección de la conexión de datos**</span><span class="sxs-lookup"><span data-stu-id="66afc-166">**Figure 3 – Choose Your Data Connection**</span></span>

![clip_image006](creating-model-classes-with-the-entity-framework-cs/_static/image3.jpg)

<span data-ttu-id="66afc-168">**Ilustración 4: elegir los objetos de base de datos**</span><span class="sxs-lookup"><span data-stu-id="66afc-168">**Figure 4 – Choose Your Database Objects**</span></span>

![clip_image008](creating-model-classes-with-the-entity-framework-cs/_static/image4.jpg)

#### <a name="modifying-the-adonet-entity-data-model"></a><span data-ttu-id="66afc-170">Modificar el Entity Data Model ADO.NET</span><span class="sxs-lookup"><span data-stu-id="66afc-170">Modifying the ADO.NET Entity Data Model</span></span>

<span data-ttu-id="66afc-171">Después de crear un Entity Data Model, puede modificar el modelo mediante el uso de Entity Designer (vea la figura 5).</span><span class="sxs-lookup"><span data-stu-id="66afc-171">After you create an Entity Data Model, you can modify the model by taking advantage of the Entity Designer (see Figure 5).</span></span> <span data-ttu-id="66afc-172">Puede abrir el diseñador de entidades en cualquier momento si hace doble clic en el archivo MoviesDBModel. edmx incluido en la carpeta modelos dentro de la ventana de Explorador de soluciones.</span><span class="sxs-lookup"><span data-stu-id="66afc-172">You can open the Entity Designer at any time by double-clicking the MoviesDBModel.edmx file contained in the Models folder within the Solution Explorer window.</span></span>

<span data-ttu-id="66afc-173">**Figura 5: diseñador de Entity Data Model de ADO.NET**</span><span class="sxs-lookup"><span data-stu-id="66afc-173">**Figure 5 – The ADO.NET Entity Data Model Designer**</span></span>

![clip_image010](creating-model-classes-with-the-entity-framework-cs/_static/image5.jpg)

<span data-ttu-id="66afc-175">Por ejemplo, puede usar Entity Designer para cambiar los nombres de las clases generadas por el Asistente para datos del modelo de entidad.</span><span class="sxs-lookup"><span data-stu-id="66afc-175">For example, you can use the Entity Designer to change the names of the classes that the Entity Model Data Wizard generates.</span></span> <span data-ttu-id="66afc-176">El asistente creó una nueva clase de acceso a datos denominada movies.</span><span class="sxs-lookup"><span data-stu-id="66afc-176">The Wizard created a new data access class named Movies.</span></span> <span data-ttu-id="66afc-177">En otras palabras, el asistente asignó a la clase el mismo nombre que la tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-177">In other words, the Wizard gave the class the very same name as the database table.</span></span> <span data-ttu-id="66afc-178">Dado que usaremos esta clase para representar una instancia de película determinada, deberíamos cambiar el nombre de la clase de películas a película.</span><span class="sxs-lookup"><span data-stu-id="66afc-178">Because we will use this class to represent a particular Movie instance, we should rename the class from Movies to Movie.</span></span>

<span data-ttu-id="66afc-179">Si desea cambiar el nombre de una clase de entidad, puede hacer doble clic en el nombre de clase en Entity Designer y escribir un nuevo nombre (vea la figura 6).</span><span class="sxs-lookup"><span data-stu-id="66afc-179">If you want to rename an entity class, you can double-click on the class name in the Entity Designer and enter a new name (see Figure 6).</span></span> <span data-ttu-id="66afc-180">Como alternativa, puede cambiar el nombre de una entidad en el ventana Propiedades después de seleccionar una entidad en Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="66afc-180">Alternatively, you can change the name of an entity in the Properties window after selecting an entity in the Entity Designer.</span></span>

<span data-ttu-id="66afc-181">**Ilustración 6: cambiar el nombre de una entidad**</span><span class="sxs-lookup"><span data-stu-id="66afc-181">**Figure 6 – Changing an entity name**</span></span>

![clip_image012](creating-model-classes-with-the-entity-framework-cs/_static/image6.jpg)

<span data-ttu-id="66afc-183">Recuerde guardar el Entity Data Model después de realizar una modificación; para ello, haga clic en el botón Guardar (el icono del disquete).</span><span class="sxs-lookup"><span data-stu-id="66afc-183">Remember to save your Entity Data Model after making a modification by clicking the Save button (the icon of the floppy disk).</span></span> <span data-ttu-id="66afc-184">En segundo plano, Entity Designer genera un conjunto de C# clases.</span><span class="sxs-lookup"><span data-stu-id="66afc-184">Behind the scenes, the Entity Designer generates a set of C# classes.</span></span> <span data-ttu-id="66afc-185">Puede ver estas clases abriendo el archivo MoviesDBModel.Designer.cs desde la ventana Explorador de soluciones.</span><span class="sxs-lookup"><span data-stu-id="66afc-185">You can view these classes by opening the MoviesDBModel.Designer.cs file from the Solution Explorer window.</span></span>

<span data-ttu-id="66afc-186">No modifique el código en el archivo Designer.cs, ya que los cambios se sobrescribirán la próxima vez que use el diseñador de entidades.</span><span class="sxs-lookup"><span data-stu-id="66afc-186">Don't modify the code in the Designer.cs file since your changes will be overwritten the next time you use the Entity Designer.</span></span> <span data-ttu-id="66afc-187">Si desea ampliar la funcionalidad de las clases de entidad definidas en el archivo Designer.cs, puede crear *clases parciales* en archivos independientes.</span><span class="sxs-lookup"><span data-stu-id="66afc-187">If you want to extend the functionality of the entity classes defined in the Designer.cs file then you can create *partial classes* in separate files.</span></span>

#### <a name="selecting-database-records-with-the-entity-framework"></a><span data-ttu-id="66afc-188">Selección de registros de base de datos con el Entity Framework</span><span class="sxs-lookup"><span data-stu-id="66afc-188">Selecting Database Records with the Entity Framework</span></span>

<span data-ttu-id="66afc-189">Vamos a empezar a crear la aplicación de base de datos de películas mediante la creación de una página que muestra una lista de registros de películas.</span><span class="sxs-lookup"><span data-stu-id="66afc-189">Let's start building our Movie Database application by creating a page that displays a list of movie records.</span></span> <span data-ttu-id="66afc-190">El controlador Home de la lista 1 expone una acción denominada index ().</span><span class="sxs-lookup"><span data-stu-id="66afc-190">The Home controller in Listing 1 exposes an action named Index().</span></span> <span data-ttu-id="66afc-191">La acción index () devuelve todos los registros de película de la tabla de la base de datos Movie aprovechando el Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="66afc-191">The Index() action returns all of the movie records from the Movie database table by taking advantage of the Entity Framework.</span></span>

<span data-ttu-id="66afc-192">**Lista 1: Controllers\HomeController.cs**</span><span class="sxs-lookup"><span data-stu-id="66afc-192">**Listing 1 – Controllers\HomeController.cs**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample1.cs)]

<span data-ttu-id="66afc-193">Observe que el controlador de la lista 1 incluye un constructor.</span><span class="sxs-lookup"><span data-stu-id="66afc-193">Notice that the controller in Listing 1 includes a constructor.</span></span> <span data-ttu-id="66afc-194">El constructor inicializa un campo de nivel de clase denominado \_dB.</span><span class="sxs-lookup"><span data-stu-id="66afc-194">The constructor initializes a class-level field named \_db.</span></span> <span data-ttu-id="66afc-195">El campo \_dB representa las entidades de base de datos generadas por el Entity Framework de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="66afc-195">The \_db field represents the database entities generated by the Microsoft Entity Framework.</span></span> <span data-ttu-id="66afc-196">El campo \_dB es una instancia de la clase MoviesDBEntities generada por Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="66afc-196">The \_db field is an instance of the MoviesDBEntities class that was generated by the Entity Designer.</span></span>

<span data-ttu-id="66afc-197">Para usar la clase theMoviesDBEntities en el controlador Home, debe importar el espacio de nombres MovieEntityApp. Models (*MVCProjectName*. Modelos).</span><span class="sxs-lookup"><span data-stu-id="66afc-197">In order to use theMoviesDBEntities class in the Home controller, you must import the MovieEntityApp.Models namespace (*MVCProjectName*.Models).</span></span>

<span data-ttu-id="66afc-198">El campo \_dB se utiliza dentro de la acción index () para recuperar los registros de la tabla de la base de datos movies.</span><span class="sxs-lookup"><span data-stu-id="66afc-198">The \_db field is used within the Index() action to retrieve the records from the Movies database table.</span></span> <span data-ttu-id="66afc-199">Expresión \_dB. MovieSet representa todos los registros de la tabla de base de datos de películas.</span><span class="sxs-lookup"><span data-stu-id="66afc-199">The expression \_db.MovieSet represents all of the records from the Movies database table.</span></span> <span data-ttu-id="66afc-200">El método ToList () se usa para convertir el conjunto de películas en una colección genérica de objetos Movie (list&lt;Movie&gt;).</span><span class="sxs-lookup"><span data-stu-id="66afc-200">The ToList() method is used to convert the set of movies into a generic collection of Movie objects (List&lt;Movie&gt;).</span></span>

<span data-ttu-id="66afc-201">Los registros de la película se recuperan con la ayuda de LINQ to Entities.</span><span class="sxs-lookup"><span data-stu-id="66afc-201">The movie records are retrieved with the help of LINQ to Entities.</span></span> <span data-ttu-id="66afc-202">La acción index () de la lista 1 utiliza la *Sintaxis del método* LINQ para recuperar el conjunto de registros de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-202">The Index() action in Listing 1 uses LINQ *method syntax* to retrieve the set of database records.</span></span> <span data-ttu-id="66afc-203">Si lo prefiere, puede usar la *Sintaxis de consulta* LINQ en su lugar.</span><span class="sxs-lookup"><span data-stu-id="66afc-203">If you prefer, you can use LINQ *query syntax* instead.</span></span> <span data-ttu-id="66afc-204">Las dos instrucciones siguientes hacen lo mismo:</span><span class="sxs-lookup"><span data-stu-id="66afc-204">The following two statements do the very same thing:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample2.cs)]

<span data-ttu-id="66afc-205">Use la sintaxis de LINQ: sintaxis de método o sintaxis de consulta, que le resultará más intuitiva.</span><span class="sxs-lookup"><span data-stu-id="66afc-205">Use whichever LINQ syntax – method syntax or query syntax – that you find most intuitive.</span></span> <span data-ttu-id="66afc-206">No hay ninguna diferencia en el rendimiento entre los dos enfoques: la única diferencia es el estilo.</span><span class="sxs-lookup"><span data-stu-id="66afc-206">There is no difference in performance between the two approaches – the only difference is style.</span></span>

<span data-ttu-id="66afc-207">La vista de la lista 2 se usa para mostrar los registros de la película.</span><span class="sxs-lookup"><span data-stu-id="66afc-207">The view in Listing 2 is used to display the movie records.</span></span>

<span data-ttu-id="66afc-208">**Lista 2: Views\Home\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="66afc-208">**Listing 2 – Views\Home\Index.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample3.aspx)]

<span data-ttu-id="66afc-209">La vista de la lista 2 contiene un bucle **foreach** que recorre en iteración cada registro de película y muestra los valores de las propiedades del título y del director del registro de la película.</span><span class="sxs-lookup"><span data-stu-id="66afc-209">The view in Listing 2 contains a **foreach** loop that iterates through each movie record and displays the values of the movie record's Title and Director properties.</span></span> <span data-ttu-id="66afc-210">Observe que se muestra un vínculo de edición y eliminación junto a cada registro.</span><span class="sxs-lookup"><span data-stu-id="66afc-210">Notice that an Edit and Delete link is displayed next to each record.</span></span> <span data-ttu-id="66afc-211">Además, aparece un vínculo agregar película en la parte inferior de la vista (vea la figura 7).</span><span class="sxs-lookup"><span data-stu-id="66afc-211">Furthermore, an Add Movie link appears at the bottom of the view (see Figure 7).</span></span>

<span data-ttu-id="66afc-212">**Ilustración 7: la vista de índice**</span><span class="sxs-lookup"><span data-stu-id="66afc-212">**Figure 7 – The Index view**</span></span>

![clip_image014](creating-model-classes-with-the-entity-framework-cs/_static/image7.jpg)

<span data-ttu-id="66afc-214">La vista de índice es una *vista con tipo*.</span><span class="sxs-lookup"><span data-stu-id="66afc-214">The Index view is a *typed view*.</span></span> <span data-ttu-id="66afc-215">La vista de índice incluye una directiva &lt;% @ Page%&gt; con un atributo *Inherits* que convierte la propiedad Model en una colección de lista genérica fuertemente tipada de objetos Movie (list&lt;Movie).</span><span class="sxs-lookup"><span data-stu-id="66afc-215">The Index view includes a &lt;%@ Page %&gt; directive with an *Inherits* attribute that casts the Model property to a strongly typed generic List collection of Movie objects (List&lt;Movie).</span></span>

## <a name="inserting-database-records-with-the-entity-framework"></a><span data-ttu-id="66afc-216">Insertar registros de base de datos con el Entity Framework</span><span class="sxs-lookup"><span data-stu-id="66afc-216">Inserting Database Records with the Entity Framework</span></span>

<span data-ttu-id="66afc-217">Puede utilizar la Entity Framework para facilitar la inserción de nuevos registros en una tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-217">You can use the Entity Framework to make it easy to insert new records into a database table.</span></span> <span data-ttu-id="66afc-218">La lista 3 contiene dos nuevas acciones agregadas a la clase de controlador de inicio que puede usar para insertar nuevos registros en la tabla de la base de datos de películas.</span><span class="sxs-lookup"><span data-stu-id="66afc-218">Listing 3 contains two new actions added to the Home controller class that you can use to insert new records into the Movie database table.</span></span>

<span data-ttu-id="66afc-219">**Lista 3: Controllers\HomeController.cs (agregar métodos)**</span><span class="sxs-lookup"><span data-stu-id="66afc-219">**Listing 3 – Controllers\HomeController.cs (Add methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample4.cs)]

<span data-ttu-id="66afc-220">La primera acción Add () simplemente devuelve una vista.</span><span class="sxs-lookup"><span data-stu-id="66afc-220">The first Add() action simply returns a view.</span></span> <span data-ttu-id="66afc-221">La vista contiene un formulario para agregar un nuevo registro de la base de datos de películas (vea la figura 8).</span><span class="sxs-lookup"><span data-stu-id="66afc-221">The view contains a form for adding a new movie database record (see Figure 8).</span></span> <span data-ttu-id="66afc-222">Cuando se envía el formulario, se invoca la segunda acción Add ().</span><span class="sxs-lookup"><span data-stu-id="66afc-222">When you submit the form, the second Add() action is invoked.</span></span>

<span data-ttu-id="66afc-223">Observe que la segunda acción Add () se decora con el atributo AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="66afc-223">Notice that the second Add() action is decorated with the AcceptVerbs attribute.</span></span> <span data-ttu-id="66afc-224">Esta acción solo se puede invocar cuando se realiza una operación POST de HTTP.</span><span class="sxs-lookup"><span data-stu-id="66afc-224">This action can be invoked only when performing an HTTP POST operation.</span></span> <span data-ttu-id="66afc-225">En otras palabras, esta acción solo se puede invocar al publicar un formulario HTML.</span><span class="sxs-lookup"><span data-stu-id="66afc-225">In other words, this action can only be invoked when posting an HTML form.</span></span>

<span data-ttu-id="66afc-226">La segunda acción Add () crea una nueva instancia de la clase Entity Framework Movie con la ayuda del método TryUpdateModel MVC ASP.NET ().</span><span class="sxs-lookup"><span data-stu-id="66afc-226">The second Add() action creates a new instance of the Entity Framework Movie class with the help of the ASP.NET MVC TryUpdateModel() method.</span></span> <span data-ttu-id="66afc-227">El método TryUpdateModel () toma los campos del FormCollection que se pasan al método Add () y asigna los valores de estos campos de formulario HTML a la clase Movie.</span><span class="sxs-lookup"><span data-stu-id="66afc-227">The TryUpdateModel() method takes the fields in the FormCollection passed to the Add() method and assigns the values of these HTML form fields to the Movie class.</span></span>

<span data-ttu-id="66afc-228">Al utilizar Entity Framework, debe proporcionar una "lista de permitidos" de propiedades cuando se usan métodos TryUpdateModel o UpdateModel para actualizar las propiedades de una clase de entidad.</span><span class="sxs-lookup"><span data-stu-id="66afc-228">When using the Entity Framework, you must supply a "white list" of properties when using the TryUpdateModel or UpdateModel methods to update the properties of an entity class.</span></span>

<span data-ttu-id="66afc-229">A continuación, la acción Add () realiza una validación de formulario simple.</span><span class="sxs-lookup"><span data-stu-id="66afc-229">Next, the Add() action performs some simple form validation.</span></span> <span data-ttu-id="66afc-230">La acción comprueba que las propiedades title y director tienen valores.</span><span class="sxs-lookup"><span data-stu-id="66afc-230">The action verifies that both the Title and Director properties have values.</span></span> <span data-ttu-id="66afc-231">Si se produce un error de validación, se agrega un mensaje de error de validación a ModelState.</span><span class="sxs-lookup"><span data-stu-id="66afc-231">If there is a validation error, then a validation error message is added to ModelState.</span></span>

<span data-ttu-id="66afc-232">Si no hay ningún error de validación, se agrega un nuevo registro de película a la tabla de base de datos de películas con la ayuda del Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="66afc-232">If there are no validation errors then a new movie record is added to the Movies database table with the help of the Entity Framework.</span></span> <span data-ttu-id="66afc-233">El nuevo registro se agrega a la base de datos con las dos líneas de código siguientes:</span><span class="sxs-lookup"><span data-stu-id="66afc-233">The new record is added to the database with the following two lines of code:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample5.cs)]

<span data-ttu-id="66afc-234">La primera línea de código agrega la nueva entidad Movie al conjunto de películas cuyo seguimiento realiza el Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="66afc-234">The first line of code adds the new Movie entity to the set of movies being tracked by the Entity Framework.</span></span> <span data-ttu-id="66afc-235">La segunda línea de código guarda los cambios que se hayan realizado en las películas de las que se realiza el seguimiento en la base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="66afc-235">The second line of code saves whatever changes have been made to the Movies being tracked back to the underlying database.</span></span>

<span data-ttu-id="66afc-236">**Figura 8: la vista agregar**</span><span class="sxs-lookup"><span data-stu-id="66afc-236">**Figure 8 – The Add view**</span></span>

![clip_image016](creating-model-classes-with-the-entity-framework-cs/_static/image8.jpg)

#### <a name="updating-database-records-with-the-entity-framework"></a><span data-ttu-id="66afc-238">Actualización de registros de base de datos con el Entity Framework</span><span class="sxs-lookup"><span data-stu-id="66afc-238">Updating Database Records with the Entity Framework</span></span>

<span data-ttu-id="66afc-239">Puede seguir casi el mismo enfoque para editar un registro de base de datos con el Entity Framework como el enfoque que hemos seguido para insertar un nuevo registro de base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-239">You can follow almost the same approach to edit a database record with the Entity Framework as the approach that we just followed to insert a new database record.</span></span> <span data-ttu-id="66afc-240">La lista 4 contiene dos nuevas acciones de controlador denominadas Edit ().</span><span class="sxs-lookup"><span data-stu-id="66afc-240">Listing 4 contains two new controller actions named Edit().</span></span> <span data-ttu-id="66afc-241">La primera acción Edit () devuelve un formulario HTML para editar un registro de película.</span><span class="sxs-lookup"><span data-stu-id="66afc-241">The first Edit() action returns an HTML form for editing a movie record.</span></span> <span data-ttu-id="66afc-242">La segunda acción de edición () intenta actualizar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-242">The second Edit() action attempts to update the database.</span></span>

<span data-ttu-id="66afc-243">**Lista 4: Controllers\HomeController.cs (editar métodos)**</span><span class="sxs-lookup"><span data-stu-id="66afc-243">**Listing 4 – Controllers\HomeController.cs (Edit methods)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample6.cs)]

<span data-ttu-id="66afc-244">La segunda acción Edit () se inicia al recuperar el registro de la película de la base de datos que coincide con el identificador de la película que se está editando.</span><span class="sxs-lookup"><span data-stu-id="66afc-244">The second Edit() action starts by retrieving the Movie record from the database that matches the Id of the movie being edited.</span></span> <span data-ttu-id="66afc-245">La siguiente instrucción LINQ to Entities obtiene el primer registro de base de datos que coincide con un identificador determinado:</span><span class="sxs-lookup"><span data-stu-id="66afc-245">The following LINQ to Entities statement grabs the first database record that matches a particular Id:</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample7.cs)]

<span data-ttu-id="66afc-246">A continuación, se usa el método TryUpdateModel () para asignar los valores de los campos de formulario HTML a las propiedades de la entidad Movie.</span><span class="sxs-lookup"><span data-stu-id="66afc-246">Next, the TryUpdateModel() method is used to assign the values of the HTML form fields to the properties of the movie entity.</span></span> <span data-ttu-id="66afc-247">Tenga en cuenta que se proporciona una lista de permitidos para especificar las propiedades exactas para actualizar.</span><span class="sxs-lookup"><span data-stu-id="66afc-247">Notice that a white list is supplied to specify the exact properties to update.</span></span>

<span data-ttu-id="66afc-248">Después, se realiza una validación simple para comprobar que el título de la película y las propiedades del Director tienen valores.</span><span class="sxs-lookup"><span data-stu-id="66afc-248">Next, some simple validation is performed to verify that both the Movie Title and Director properties have values.</span></span> <span data-ttu-id="66afc-249">Si falta un valor en alguna de las propiedades, se agrega un mensaje de error de validación a ModelState y ModelState. IsValid devuelve el valor false.</span><span class="sxs-lookup"><span data-stu-id="66afc-249">If either property is missing a value, then a validation error message is added to ModelState and ModelState.IsValid returns the value false.</span></span>

<span data-ttu-id="66afc-250">Por último, si no hay ningún error de validación, la tabla de base de datos de películas subyacentes se actualiza con los cambios llamando al método SaveChanges ().</span><span class="sxs-lookup"><span data-stu-id="66afc-250">Finally, if there are no validation errors, then the underlying Movies database table is updated with any changes by calling the SaveChanges() method.</span></span>

<span data-ttu-id="66afc-251">Al editar registros de base de datos, debe pasar el identificador del registro que se está editando a la acción de controlador que realiza la actualización de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-251">When editing database records, you need to pass the Id of the record being edited to the controller action that performs the database update.</span></span> <span data-ttu-id="66afc-252">De lo contrario, la acción del controlador no sabrá qué registro se va a actualizar en la base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="66afc-252">Otherwise, the controller action will not know which record to update in the underlying database.</span></span> <span data-ttu-id="66afc-253">La vista de edición, incluida en la lista 5, incluye un campo de formulario oculto que representa el identificador del registro de base de datos que se está editando.</span><span class="sxs-lookup"><span data-stu-id="66afc-253">The Edit view, contained in Listing 5, includes a hidden form field that represents the Id of the database record being edited.</span></span>

<span data-ttu-id="66afc-254">**Lista 5: Views\Home\Edit.aspx**</span><span class="sxs-lookup"><span data-stu-id="66afc-254">**Listing 5 – Views\Home\Edit.aspx**</span></span>

[!code-aspx[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample8.aspx)]

## <a name="deleting-database-records-with-the-entity-framework"></a><span data-ttu-id="66afc-255">Eliminar registros de base de datos con el Entity Framework</span><span class="sxs-lookup"><span data-stu-id="66afc-255">Deleting Database Records with the Entity Framework</span></span>

<span data-ttu-id="66afc-256">La última operación de base de datos, que necesitamos abordar en este tutorial, es la eliminación de registros de base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-256">The final database operation, which we need to tackle in this tutorial, is deleting database records.</span></span> <span data-ttu-id="66afc-257">Puede usar la acción del controlador en la lista 6 para eliminar un registro de base de datos determinado.</span><span class="sxs-lookup"><span data-stu-id="66afc-257">You can use the controller action in Listing 6 to delete a particular database record.</span></span>

<span data-ttu-id="66afc-258">**Listado 6--\Controllers\HomeController.cs (acción de eliminación)**</span><span class="sxs-lookup"><span data-stu-id="66afc-258">**Listing 6 -- \Controllers\HomeController.cs (Delete action)**</span></span>

[!code-csharp[Main](creating-model-classes-with-the-entity-framework-cs/samples/sample9.cs)]

<span data-ttu-id="66afc-259">La acción Delete () recupera primero la entidad Movie que coincide con el identificador pasado a la acción.</span><span class="sxs-lookup"><span data-stu-id="66afc-259">The Delete() action first retrieves the Movie entity that matches the Id passed to the action.</span></span> <span data-ttu-id="66afc-260">A continuación, la película se elimina de la base de datos llamando al método DeleteObject () seguido del método SaveChanges ().</span><span class="sxs-lookup"><span data-stu-id="66afc-260">Next, the movie is deleted from the database by calling the DeleteObject() method followed by the SaveChanges() method.</span></span> <span data-ttu-id="66afc-261">Por último, se redirige al usuario a la vista de índice.</span><span class="sxs-lookup"><span data-stu-id="66afc-261">Finally, the user is redirected back to the Index view.</span></span>

## <a name="summary"></a><span data-ttu-id="66afc-262">Resumen</span><span class="sxs-lookup"><span data-stu-id="66afc-262">Summary</span></span>

<span data-ttu-id="66afc-263">El propósito de este tutorial fue demostrar cómo puede compilar aplicaciones web controladas por la base de datos aprovechando ASP.NET MVC y Microsoft Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="66afc-263">The purpose of this tutorial was to demonstrate how you can build database-driven web applications by taking advantage of ASP.NET MVC and the Microsoft Entity Framework.</span></span> <span data-ttu-id="66afc-264">Aprendió a crear una aplicación que le permite seleccionar, insertar, actualizar y eliminar registros de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-264">You learned how to build an application that enables you to select, insert, update, and delete database records.</span></span>

<span data-ttu-id="66afc-265">En primer lugar, se describe cómo puede usar el Asistente para Entity Data Model con el fin de generar una Entity Data Model desde Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="66afc-265">First, we discussed how you can use the Entity Data Model Wizard to generate an Entity Data Model from within Visual Studio.</span></span> <span data-ttu-id="66afc-266">A continuación, aprenderá a usar LINQ to Entities para recuperar un conjunto de registros de base de datos de una tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-266">Next, you learn how to use LINQ to Entities to retrieve a set of database records from a database table.</span></span> <span data-ttu-id="66afc-267">Por último, usamos el Entity Framework para insertar, actualizar y eliminar registros de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="66afc-267">Finally, we used the Entity Framework to insert, update, and delete database records.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="66afc-268">Siguiente</span><span class="sxs-lookup"><span data-stu-id="66afc-268">Next</span></span>](creating-model-classes-with-linq-to-sql-cs.md)

---
uid: mvc/overview/performance/bundling-and-minification
title: Agrupar y Minificación | Microsoft Docs
author: Rick-Anderson
description: La agrupación y la minificación son dos técnicas que puede usar en ASP.NET 4,5 para mejorar el tiempo de carga de la solicitud. La agrupación y minificación mejora el tiempo de carga de reducin...
ms.author: riande
ms.date: 08/23/2012
ms.assetid: 5894dc13-5d45-4dad-8096-136499120f1d
msc.legacyurl: /mvc/overview/performance/bundling-and-minification
msc.type: authoredcontent
ms.openlocfilehash: 239980d747c6e0d6be1e9b4fe0371e276e37cf21
ms.sourcegitcommit: 88fc80e3f65aebdf61ec9414810ddbc31c543f04
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/22/2020
ms.locfileid: "76519289"
---
# <a name="bundling-and-minification"></a><span data-ttu-id="e7e6f-104">Agrupar y minificar</span><span class="sxs-lookup"><span data-stu-id="e7e6f-104">Bundling and Minification</span></span>

<span data-ttu-id="e7e6f-105">por [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="e7e6f-105">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

> <span data-ttu-id="e7e6f-106">La agrupación y la minificación son dos técnicas que puede usar en ASP.NET 4,5 para mejorar el tiempo de carga de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-106">Bundling and minification are two techniques you can use in ASP.NET 4.5 to improve request load time.</span></span> <span data-ttu-id="e7e6f-107">La agrupación y minificación mejora el tiempo de carga al reducir el número de solicitudes al servidor y reducir el tamaño de los activos solicitados (como CSS y JavaScript).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-107">Bundling and minification improves load time by reducing the number of requests to the server and reducing the size of requested assets (such as CSS and JavaScript.)</span></span>

<span data-ttu-id="e7e6f-108">La mayoría de los exploradores principales actuales limitan el número de [conexiones simultáneas](http://www.browserscope.org/?category=network) por cada nombre de host a seis.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-108">Most of the current major browsers limit the number of [simultaneous connections](http://www.browserscope.org/?category=network) per each hostname to six.</span></span> <span data-ttu-id="e7e6f-109">Esto significa que, mientras se procesan seis solicitudes, el explorador pondrá en cola las solicitudes adicionales de recursos de un host.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-109">That means that while six requests are being processed, additional requests for assets on a host will be queued by the browser.</span></span> <span data-ttu-id="e7e6f-110">En la imagen siguiente, las pestañas red de herramientas de desarrollo F12 de IE muestran el tiempo necesario para los recursos que requiere la vista acerca de de una aplicación de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-110">In the image below, the IE F12 developer tools network tabs shows the timing for assets required by the About view of a sample application.</span></span>

![B/M](bundling-and-minification/_static/image1.png)

<span data-ttu-id="e7e6f-112">Las barras grises muestran la hora en que el explorador pone en cola la solicitud a la espera del límite de seis conexiones.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-112">The gray bars show the time the request is queued by the browser waiting on the six connection limit.</span></span> <span data-ttu-id="e7e6f-113">La barra amarilla es el tiempo de solicitud hasta el primer byte, es decir, el tiempo que se tarda en enviar la solicitud y recibir la primera respuesta del servidor.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-113">The yellow bar is the request time to first byte, that is, the time taken to send the request and receive the first response from the server.</span></span> <span data-ttu-id="e7e6f-114">Las barras azules muestran el tiempo necesario para recibir los datos de respuesta del servidor.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-114">The blue bars show the time taken to receive the response data from the server.</span></span> <span data-ttu-id="e7e6f-115">Puede hacer doble clic en un recurso para obtener información detallada sobre el control de tiempo.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-115">You can double-click on an asset to get detailed timing information.</span></span> <span data-ttu-id="e7e6f-116">Por ejemplo, en la siguiente imagen se muestran los detalles de tiempo para cargar el archivo */scripts/MyScripts/JavaScript6.js* .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-116">For example, the following image shows the timing details for loading the */Scripts/MyScripts/JavaScript6.js* file.</span></span>

![](bundling-and-minification/_static/image2.png)

<span data-ttu-id="e7e6f-117">En la imagen anterior se muestra el evento de **Inicio** , que proporciona la hora a la que se puso en cola la solicitud debido a que el explorador limita el número de conexiones simultáneas.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-117">The preceding image shows the **Start** event, which gives the time the request was queued because of the browser limit the number of simultaneous connections.</span></span> <span data-ttu-id="e7e6f-118">En este caso, la solicitud se puso en cola durante 46 milisegundos a la espera de que se completara otra solicitud.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-118">In this case, the request was queued for 46 milliseconds waiting for another request to complete.</span></span>

## <a name="bundling"></a><span data-ttu-id="e7e6f-119">Unión</span><span class="sxs-lookup"><span data-stu-id="e7e6f-119">Bundling</span></span>

<span data-ttu-id="e7e6f-120">La Unión es una nueva característica de ASP.NET 4,5 que facilita la combinación o agrupación de varios archivos en un único archivo.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-120">Bundling is a new feature in ASP.NET 4.5 that makes it easy to combine or bundle multiple files into a single file.</span></span> <span data-ttu-id="e7e6f-121">Puede crear CSS, JavaScript y otros paquetes.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-121">You can create CSS, JavaScript and other bundles.</span></span> <span data-ttu-id="e7e6f-122">Menos archivos significa menos solicitudes HTTP y esto puede mejorar el rendimiento de la carga de la primera página.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-122">Fewer files means fewer HTTP requests and that can improve first page load performance.</span></span>

<span data-ttu-id="e7e6f-123">En la imagen siguiente se muestra la misma vista de control de tiempo de la vista acerca de que se mostró anteriormente, pero esta vez con la agrupación y la minificación habilitada.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-123">The following image shows the same timing view of the About view shown previously, but this time with bundling and minification enabled.</span></span>

![](bundling-and-minification/_static/image3.png)

## <a name="minification"></a><span data-ttu-id="e7e6f-124">Minificación</span><span class="sxs-lookup"><span data-stu-id="e7e6f-124">Minification</span></span>

<span data-ttu-id="e7e6f-125">Minificación realiza una variedad de diferentes optimizaciones de código en scripts o CSS, como quitar los comentarios y los espacios en blanco innecesarios, y acortar los nombres de variable a un carácter.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-125">Minification performs a variety of different code optimizations to scripts or css, such as removing unnecessary white space and comments and shortening variable names to one character.</span></span> <span data-ttu-id="e7e6f-126">Considere la siguiente función de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-126">Consider the following JavaScript function.</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample1.js)]

<span data-ttu-id="e7e6f-127">Después de minificación, la función se reduce a lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-127">After minification, the function is reduced to the following:</span></span>

[!code-javascript[Main](bundling-and-minification/samples/sample2.js)]

<span data-ttu-id="e7e6f-128">Además de quitar los comentarios y los espacios en blanco innecesarios, se ha cambiado el nombre de los siguientes parámetros y nombres de variable (abreviado) de la manera siguiente:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-128">In addition to removing the comments and unnecessary whitespace, the following parameters and variable names were renamed (shortened) as follows:</span></span>

| <span data-ttu-id="e7e6f-129">**Original**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-129">**Original**</span></span> | <span data-ttu-id="e7e6f-130">**Cambia**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-130">**Renamed**</span></span> |
| --- | --- |
| <span data-ttu-id="e7e6f-131">imageTagAndImageID</span><span class="sxs-lookup"><span data-stu-id="e7e6f-131">imageTagAndImageID</span></span> | <span data-ttu-id="e7e6f-132">n</span><span class="sxs-lookup"><span data-stu-id="e7e6f-132">n</span></span> |
| <span data-ttu-id="e7e6f-133">imageContext</span><span class="sxs-lookup"><span data-stu-id="e7e6f-133">imageContext</span></span> | <span data-ttu-id="e7e6f-134">m</span><span class="sxs-lookup"><span data-stu-id="e7e6f-134">t</span></span> |
| <span data-ttu-id="e7e6f-135">imageElement</span><span class="sxs-lookup"><span data-stu-id="e7e6f-135">imageElement</span></span> | <span data-ttu-id="e7e6f-136">i</span><span class="sxs-lookup"><span data-stu-id="e7e6f-136">i</span></span> |

## <a name="impact-of-bundling-and-minification"></a><span data-ttu-id="e7e6f-137">Impacto de la agrupación y Minificación</span><span class="sxs-lookup"><span data-stu-id="e7e6f-137">Impact of Bundling and Minification</span></span>

<span data-ttu-id="e7e6f-138">En la tabla siguiente se muestran varias diferencias importantes entre enumerar todos los recursos individualmente y usar la Unión y minificación (B/M) en el programa de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-138">The following table shows several important differences between listing all the assets individually and using bundling and minification (B/M) in the sample program.</span></span>

|  | <span data-ttu-id="e7e6f-139">**Usar B/M**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-139">**Using B/M**</span></span> | <span data-ttu-id="e7e6f-140">**Sin B/M**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-140">**Without B/M**</span></span> | <span data-ttu-id="e7e6f-141">**Cambio**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-141">**Change**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="e7e6f-142">**Solicitudes de archivo**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-142">**File Requests**</span></span> | <span data-ttu-id="e7e6f-143">9</span><span class="sxs-lookup"><span data-stu-id="e7e6f-143">9</span></span> | <span data-ttu-id="e7e6f-144">34</span><span class="sxs-lookup"><span data-stu-id="e7e6f-144">34</span></span> | <span data-ttu-id="e7e6f-145">256%</span><span class="sxs-lookup"><span data-stu-id="e7e6f-145">256%</span></span> |
| <span data-ttu-id="e7e6f-146">**KB enviados**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-146">**KB Sent**</span></span> | <span data-ttu-id="e7e6f-147">3.26</span><span class="sxs-lookup"><span data-stu-id="e7e6f-147">3.26</span></span> | <span data-ttu-id="e7e6f-148">11.92</span><span class="sxs-lookup"><span data-stu-id="e7e6f-148">11.92</span></span> | <span data-ttu-id="e7e6f-149">266%</span><span class="sxs-lookup"><span data-stu-id="e7e6f-149">266%</span></span> |
| <span data-ttu-id="e7e6f-150">**KB recibidos**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-150">**KB Received**</span></span> | <span data-ttu-id="e7e6f-151">388.51</span><span class="sxs-lookup"><span data-stu-id="e7e6f-151">388.51</span></span> | <span data-ttu-id="e7e6f-152">530</span><span class="sxs-lookup"><span data-stu-id="e7e6f-152">530</span></span> | <span data-ttu-id="e7e6f-153">36%</span><span class="sxs-lookup"><span data-stu-id="e7e6f-153">36%</span></span> |
| <span data-ttu-id="e7e6f-154">**Tiempo de carga**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-154">**Load Time**</span></span> | <span data-ttu-id="e7e6f-155">510 MS</span><span class="sxs-lookup"><span data-stu-id="e7e6f-155">510 MS</span></span> | <span data-ttu-id="e7e6f-156">780 MS</span><span class="sxs-lookup"><span data-stu-id="e7e6f-156">780 MS</span></span> | <span data-ttu-id="e7e6f-157">53%</span><span class="sxs-lookup"><span data-stu-id="e7e6f-157">53%</span></span> |

<span data-ttu-id="e7e6f-158">Los bytes enviados tuvieron una reducción significativa en la agrupación, ya que los exploradores son bastante detallados con los encabezados HTTP que se aplican en las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-158">The bytes sent had a significant reduction with bundling as browsers are fairly verbose with the HTTP headers they apply on requests.</span></span> <span data-ttu-id="e7e6f-159">La reducción de bytes recibidos no es tan grande porque los archivos más grandes (*scripts\\jQuery-UI-1.8.11. min. js* y *scripts\\jQuery-1.7.1. min. js*) ya se reducida.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-159">The received bytes reduction is not as large because the largest files (*Scripts\\jquery-ui-1.8.11.min.js* and *Scripts\\jquery-1.7.1.min.js*) are already minified.</span></span> <span data-ttu-id="e7e6f-160">Nota: los intervalos en el programa de ejemplo usaban la herramienta [Fiddler](http://www.fiddler2.com/fiddler2/) para simular una red lenta.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-160">Note: The timings on the sample program used the [Fiddler](http://www.fiddler2.com/fiddler2/) tool to simulate a slow network.</span></span> <span data-ttu-id="e7e6f-161">(En el menú **reglas** de Fiddler, seleccione **rendimiento** y, a continuación, **simular velocidades de módem**).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-161">(From the Fiddler **Rules** menu, select **Performance** then **Simulate Modem Speeds**.)</span></span>

## <a name="debugging-bundled-and-minified-javascript"></a><span data-ttu-id="e7e6f-162">Depuración de JavaScript agrupado y reducida</span><span class="sxs-lookup"><span data-stu-id="e7e6f-162">Debugging Bundled and Minified JavaScript</span></span>

<span data-ttu-id="e7e6f-163">Es fácil depurar el código JavaScript en un entorno de desarrollo (donde el [elemento de compilación](https://msdn.microsoft.com/library/s10awwz0.aspx) en el archivo *Web. config* se establece en `debug="true"`) porque los archivos JavaScript no están agrupados ni reducida.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-163">It's easy to debug your JavaScript in a development environment (where the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx) in the *Web.config* file is set to `debug="true"` ) because the JavaScript files are not bundled or minified.</span></span> <span data-ttu-id="e7e6f-164">También puede depurar una compilación de versión en la que los archivos de JavaScript estén agrupados y reducida.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-164">You can also debug a release build where your JavaScript files are bundled and minified.</span></span> <span data-ttu-id="e7e6f-165">Con las herramientas de desarrollo F12 de IE, puede depurar una función de JavaScript incluida en un paquete de reducida con el siguiente enfoque:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-165">Using the IE F12 developer tools, you debug a JavaScript function included in a minified bundle using the following approach:</span></span>

1. <span data-ttu-id="e7e6f-166">Seleccione la pestaña **script** y, a continuación, seleccione el botón **iniciar depuración** .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-166">Select the **Script** tab and then select the **Start debugging** button.</span></span>
2. <span data-ttu-id="e7e6f-167">Seleccione el paquete que contiene la función de JavaScript que desea depurar mediante el botón activos.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-167">Select the bundle containing the JavaScript function you want to debug using the assets button.</span></span>  
    ![](bundling-and-minification/_static/image4.png)
3. <span data-ttu-id="e7e6f-168">Formatee el reducida JavaScript seleccionando el **botón configuración** ![](bundling-and-minification/_static/image5.png)y, a continuación, seleccionando **dar formato a JavaScript**.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-168">Format the minified JavaScript by selecting the **Configuration button** ![](bundling-and-minification/_static/image5.png), and then selecting **Format JavaScript**.</span></span>
4. <span data-ttu-id="e7e6f-169">En el cuadro de entrada **script de búsqueda** , seleccione el nombre de la función que desea depurar.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-169">In the **Search Script** input box, select the name of the function you want to debug.</span></span> <span data-ttu-id="e7e6f-170">En la imagen siguiente, se especificó **AddAltToImg** en el cuadro de entrada **script de búsqueda** .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-170">In the following image, **AddAltToImg** was entered in the **Search Script** input box.</span></span>  
    ![](bundling-and-minification/_static/image6.png)

<span data-ttu-id="e7e6f-171">Para obtener más información sobre la depuración con las herramientas de desarrollo F12, vea el artículo de MSDN [sobre el uso del herramientas de desarrollo F12 para depurar errores de JavaScript](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-171">For more information on debugging with the F12 developer tools, see the MSDN article [Using the F12 Developer Tools to Debug JavaScript Errors](https://msdn.microsoft.com/library/ie/gg699336(v=vs.85).aspx).</span></span>

## <a name="controlling-bundling-and-minification"></a><span data-ttu-id="e7e6f-172">Controlar la agrupación y Minificación</span><span class="sxs-lookup"><span data-stu-id="e7e6f-172">Controlling Bundling and Minification</span></span>

<span data-ttu-id="e7e6f-173">La agrupación y minificación está habilitada o deshabilitada estableciendo el valor del atributo debug en el [elemento Compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) en el archivo *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-173">Bundling and minification is enabled or disabled by setting the value of the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file.</span></span> <span data-ttu-id="e7e6f-174">En el XML siguiente, `debug` se establece en true para que la agrupación y minificación esté deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-174">In the following XML, `debug` is set to true so bundling and minification is disabled.</span></span>

[!code-xml[Main](bundling-and-minification/samples/sample3.xml?highlight=2)]

<span data-ttu-id="e7e6f-175">Para habilitar la agrupación y la minificación, establezca el valor de `debug` en "false".</span><span class="sxs-lookup"><span data-stu-id="e7e6f-175">To enable bundling and minification, set the `debug` value to "false".</span></span> <span data-ttu-id="e7e6f-176">Puede invalidar la configuración de *Web. config* con la propiedad `EnableOptimizations` en la clase `BundleTable`.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-176">You can override the *Web.config* setting with the `EnableOptimizations` property on the `BundleTable` class.</span></span> <span data-ttu-id="e7e6f-177">En el código siguiente se habilita la agrupación y la minificación, y se reemplaza cualquier valor en el archivo *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-177">The following code enables bundling and minification and overrides any setting in the *Web.config* file.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample4.cs?highlight=7)]

> [!NOTE]
> <span data-ttu-id="e7e6f-178">A menos que `EnableOptimizations` sea `true` o el atributo Debug del [elemento Compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) del archivo *Web. config* esté establecido en `false`, los archivos no se agruparán ni se reducida.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-178">Unless `EnableOptimizations` is `true` or the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file is set to `false`, files will not be bundled or minified.</span></span> <span data-ttu-id="e7e6f-179">Además, no se usará la versión. min de los archivos, se seleccionarán las versiones de depuración completas.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-179">Additionally, the .min version of files will not be used, the full debug versions will be selected.</span></span> <span data-ttu-id="e7e6f-180">`EnableOptimizations` invalida el atributo debug en el [elemento Compilation](https://msdn.microsoft.com/library/s10awwz0.aspx) del archivo *Web. config*</span><span class="sxs-lookup"><span data-stu-id="e7e6f-180">`EnableOptimizations` overrides the debug attribute in the [compilation Element](https://msdn.microsoft.com/library/s10awwz0.aspx)  in the *Web.config* file</span></span>

## <a name="using-bundling-and-minification-with-aspnet-web-forms-and-web-pages"></a><span data-ttu-id="e7e6f-181">Usar la Unión y Minificación con formularios Web Forms y páginas web de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="e7e6f-181">Using Bundling and Minification with ASP.NET Web Forms and Web Pages</span></span>

- <span data-ttu-id="e7e6f-182">En el caso de las páginas web, vea la entrada de blog [Agregar optimización web a un sitio de Web pages](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-182">For Web Pages, see the blog entry [Adding Web Optimization to a Web Pages Site](https://docs.microsoft.com/archive/blogs/rickandy/adding-web-optimization-to-a-web-pages-site).</span></span>
- <span data-ttu-id="e7e6f-183">Para los formularios Web Forms, vea la entrada de blog [Agregar agrupación y minificación a formularios Web Forms](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-183">For Web Forms, see the blog entry [Adding Bundling and Minification to Web Forms](https://docs.microsoft.com/archive/blogs/rickandy/adding-bundling-and-minification-to-web-forms).</span></span>

## <a name="using-bundling-and-minification-with-aspnet-mvc"></a><span data-ttu-id="e7e6f-184">Uso de la Unión y Minificación con ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="e7e6f-184">Using Bundling and Minification with ASP.NET MVC</span></span>

<span data-ttu-id="e7e6f-185">En esta sección se creará un proyecto de ASP.NET MVC para examinar la Unión y la minificación.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-185">In this section we will create an ASP.NET MVC project to examine bundling and minification.</span></span> <span data-ttu-id="e7e6f-186">En primer lugar, cree un nuevo proyecto de Internet de ASP.NET MVC denominado **MvcBM** sin cambiar ninguno de los valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-186">First, create a new ASP.NET MVC internet project named **MvcBM** without changing any of the defaults.</span></span>

<span data-ttu-id="e7e6f-187">Abra el *\\de la aplicación \_inicio\\archivo BundleConfig.CS* y examine el método `RegisterBundles` que se usa para crear, registrar y configurar agrupaciones.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-187">Open the *App\\\_Start\\BundleConfig.cs* file and examine the `RegisterBundles` method which is used to create, register and configure bundles.</span></span> <span data-ttu-id="e7e6f-188">En el código siguiente se muestra una parte del método `RegisterBundles`.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-188">The following code shows a portion of the `RegisterBundles` method.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample5.cs)]

<span data-ttu-id="e7e6f-189">En el código anterior se crea una nueva agrupación de JavaScript denominada *~/bundles/jQuery* que incluye todo lo adecuado (es decir, Debug o reducida, pero no). *vsdoc*) en la carpeta *scripts* que coincide con la cadena comodín "~/scripts/jQuery-{version}.js".</span><span class="sxs-lookup"><span data-stu-id="e7e6f-189">The  preceding code creates a new JavaScript bundle named *~/bundles/jquery* that includes all the appropriate (that is debug or minified but not .*vsdoc*) files in the *Scripts* folder that match the wild card string "~/Scripts/jquery-{version}.js".</span></span> <span data-ttu-id="e7e6f-190">En el caso de ASP.NET MVC 4, esto significa que, con una configuración de depuración, el archivo *jQuery-1.7.1. js* se agregará a la agrupación.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-190">For ASP.NET MVC 4, this means with a debug configuration, the file *jquery-1.7.1.js* will be added to the bundle.</span></span> <span data-ttu-id="e7e6f-191">En una configuración de versión, se agregará *jQuery-1.7.1. min. js* .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-191">In a release configuration, *jquery-1.7.1.min.js* will be added.</span></span> <span data-ttu-id="e7e6f-192">El marco de trabajo de agrupación sigue varias convenciones comunes, como:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-192">The bundling framework follows several common conventions such as:</span></span>

- <span data-ttu-id="e7e6f-193">Selección de un archivo ". min" para el lanzamiento cuando *FileX. min. js* y *FileX. js* existan.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-193">Selecting ".min" file for release when *FileX.min.js* and *FileX.js* exist.</span></span>
- <span data-ttu-id="e7e6f-194">Seleccionar la versión no ". min" para la depuración.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-194">Selecting the non ".min" version for debug.</span></span>
- <span data-ttu-id="e7e6f-195">Se omiten los archivos "-vsdoc" (como *jQuery-1.7.1-vsdoc. js*), que solo se usan en IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-195">Ignoring "-vsdoc" files (such as *jquery-1.7.1-vsdoc.js*), which are used only by IntelliSense.</span></span>

<span data-ttu-id="e7e6f-196">La `{version}` coincidencia de caracteres comodín mostrada anteriormente se usa para crear automáticamente un grupo de jQuery con la versión adecuada de jQuery en la carpeta *scripts* .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-196">The `{version}` wild card matching shown above is used to automatically create a jQuery bundle with the appropriate version of jQuery in your *Scripts* folder.</span></span> <span data-ttu-id="e7e6f-197">En este ejemplo, el uso de un carácter comodín proporciona las siguientes ventajas:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-197">In this example, using a wild card provides the following benefits:</span></span>

- <span data-ttu-id="e7e6f-198">Permite usar NuGet para actualizar a una versión más reciente de jQuery sin cambiar el código de unión anterior o las referencias de jQuery en las páginas de vista.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-198">Allows you to use NuGet to update to a newer jQuery version without changing the preceding bundling code or jQuery references in your view pages.</span></span>
- <span data-ttu-id="e7e6f-199">Selecciona automáticamente la versión completa de las configuraciones de depuración y la versión ". min" para las compilaciones de versión.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-199">Automatically selects the full version for debug configurations and the ".min" version for release builds.</span></span>

## <a name="using-a-cdn"></a><span data-ttu-id="e7e6f-200">Usar una red CDN</span><span class="sxs-lookup"><span data-stu-id="e7e6f-200">Using a CDN</span></span>

 <span data-ttu-id="e7e6f-201">El código siguiente reemplaza el paquete de jQuery local por un paquete de jQuery de CDN.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-201">The follow code replaces the local jQuery bundle with a CDN jQuery bundle.</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample6.cs)]

<span data-ttu-id="e7e6f-202">En el código anterior, se solicitará jQuery desde la red CDN en modo de versión y la versión de depuración de jQuery se capturará localmente en modo de depuración.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-202">In the code above, jQuery will be requested from the CDN while in release mode and the debug version of jQuery will be fetched locally in debug mode.</span></span> <span data-ttu-id="e7e6f-203">Cuando se usa una red CDN, debe tener un mecanismo de reserva en caso de que se produzca un error en la solicitud de CDN.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-203">When using a CDN, you should have a fallback mechanism in case the CDN request fails.</span></span> <span data-ttu-id="e7e6f-204">El siguiente fragmento de marcado del final del archivo de diseño muestra un script agregado para solicitar jQuery en caso de que se produzca un error en la red CDN.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-204">The following markup fragment from the end of the layout file shows script added to request jQuery should the CDN fail.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample7.cshtml?highlight=5-13)]

## <a name="creating-a-bundle"></a><span data-ttu-id="e7e6f-205">Crear un paquete</span><span class="sxs-lookup"><span data-stu-id="e7e6f-205">Creating a Bundle</span></span>

<span data-ttu-id="e7e6f-206">La clase [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `Include` método toma una matriz de cadenas, donde cada cadena es una ruta de acceso virtual a un recurso.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-206">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `Include` method takes an array of strings, where each string is a virtual path to resource.</span></span> <span data-ttu-id="e7e6f-207">El siguiente código del método `RegisterBundles` del\\de la *aplicación \_inicio\\archivo BundleConfig.CS* muestra cómo se agregan varios archivos a un paquete:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-207">The following code from the `RegisterBundles` method in the *App\\\_Start\\BundleConfig.cs* file shows how multiple files are added to a bundle:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample8.cs)]

<span data-ttu-id="e7e6f-208">La clase [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `IncludeDirectory` método se proporciona para agregar todos los archivos de un directorio (y, opcionalmente, todos los subdirectorios) que coinciden con un patrón de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-208">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` method is provided to add all the files in a directory (and optionally all subdirectories) which match a search pattern.</span></span> <span data-ttu-id="e7e6f-209">A continuación se muestra la clase de [paquete](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) `IncludeDirectory` API:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-209">The [Bundle](https://msdn.microsoft.com/library/system.web.optimization.bundle(v=VS.110).aspx) class `IncludeDirectory` API is shown below:</span></span>

[!code-csharp[Main](bundling-and-minification/samples/sample9.cs)]

<span data-ttu-id="e7e6f-210">En las vistas se hace referencia a las agrupaciones mediante el método Render (`Styles.Render` para CSS y `Scripts.Render` para JavaScript).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-210">Bundles are referenced in views using the Render method, (`Styles.Render` for CSS and `Scripts.Render` for JavaScript).</span></span> <span data-ttu-id="e7e6f-211">El siguiente marcado de las *vistas\\Compartidos\\\_archivo layout. cshtml* muestra cómo las vistas de proyecto de internet de ASP.net predeterminadas hacen referencia a las agrupaciones CSS y JavaScript.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-211">The following markup from the *Views\\Shared\\\_Layout.cshtml* file shows how the default ASP.NET internet project views reference CSS and JavaScript bundles.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample10.cshtml?highlight=5-6,11)]

<span data-ttu-id="e7e6f-212">Observe que los métodos de representación toman una matriz de cadenas, por lo que puede agregar varios paquetes en una línea de código.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-212">Notice the Render methods takes an array of strings, so you can add multiple bundles in one line of code.</span></span> <span data-ttu-id="e7e6f-213">Por lo general, querrá usar los métodos de representación que crean el HTML necesario para hacer referencia al recurso.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-213">You will generally want to use the Render methods which create the necessary HTML to reference the asset.</span></span> <span data-ttu-id="e7e6f-214">Puede usar el método `Url` para generar la dirección URL para el recurso sin el marcado necesario para hacer referencia al recurso.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-214">You can use the `Url` method to generate the URL to the asset without the markup needed to reference the asset.</span></span> <span data-ttu-id="e7e6f-215">Supongamos que desea usar el nuevo atributo [Async](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async) de HTML5.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-215">Suppose you wanted to use the new HTML5 [async](http://www.whatwg.org/specs/web-apps/current-work/#attr-script-async) attribute.</span></span> <span data-ttu-id="e7e6f-216">En el código siguiente se muestra cómo hacer referencia a Modernizr con el método `Url`.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-216">The following code shows how to reference modernizr using the `Url` method.</span></span>

[!code-cshtml[Main](bundling-and-minification/samples/sample11.cshtml?highlight=11)]

## <a name="using-the--wildcard-character-to-select-files"></a><span data-ttu-id="e7e6f-217">Usar el carácter comodín "\*" para seleccionar archivos</span><span class="sxs-lookup"><span data-stu-id="e7e6f-217">Using the "\*" Wildcard Character to Select Files</span></span>

<span data-ttu-id="e7e6f-218">La ruta de acceso virtual especificada en el método `Include` y el patrón de búsqueda en el método `IncludeDirectory` puede aceptar un carácter comodín "\*" como prefijo o sufijo en el último segmento de ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-218">The virtual path specified in the `Include` method and the search pattern in the `IncludeDirectory` method can accept one "\*" wildcard character as a prefix or suffix to in the last path segment.</span></span> <span data-ttu-id="e7e6f-219">La cadena de búsqueda no distingue mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-219">The search string is case insensitive.</span></span> <span data-ttu-id="e7e6f-220">El método `IncludeDirectory` tiene la opción de buscar en subdirectorios.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-220">The `IncludeDirectory` method has the option of searching subdirectories.</span></span>

<span data-ttu-id="e7e6f-221">Considere un proyecto con los siguientes archivos JavaScript:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-221">Consider a project with the following JavaScript files:</span></span>

- <span data-ttu-id="e7e6f-222">*Scripts\\Common\\AddAltToImg.js*</span><span class="sxs-lookup"><span data-stu-id="e7e6f-222">*Scripts\\Common\\AddAltToImg.js*</span></span>
- <span data-ttu-id="e7e6f-223">*Scripts\\Common\\ToggleDiv. js*</span><span class="sxs-lookup"><span data-stu-id="e7e6f-223">*Scripts\\Common\\ToggleDiv.js*</span></span>
- <span data-ttu-id="e7e6f-224">*Scripts\\Common\\ToggleImg.js*</span><span class="sxs-lookup"><span data-stu-id="e7e6f-224">*Scripts\\Common\\ToggleImg.js*</span></span>
- <span data-ttu-id="e7e6f-225">*Scripts\\Common\\Sub1\\ToggleLinks. js*</span><span class="sxs-lookup"><span data-stu-id="e7e6f-225">*Scripts\\Common\\Sub1\\ToggleLinks.js*</span></span>

![DIR imag](bundling-and-minification/_static/image7.png)

<span data-ttu-id="e7e6f-227">En la tabla siguiente se muestran los archivos agregados a un paquete mediante el carácter comodín, como se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-227">The following table shows the files added to a bundle using the wildcard as shown:</span></span>

| <span data-ttu-id="e7e6f-228">**Call**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-228">**Call**</span></span> | <span data-ttu-id="e7e6f-229">**Archivos agregados o excepción generados**</span><span class="sxs-lookup"><span data-stu-id="e7e6f-229">**Files Added or Exception Raised**</span></span> |
| --- | --- |
| <span data-ttu-id="e7e6f-230">Include("~/Scripts/Common/\*.js")</span><span class="sxs-lookup"><span data-stu-id="e7e6f-230">Include("~/Scripts/Common/\*.js")</span></span> | <span data-ttu-id="e7e6f-231">*AddAltToImg.js*, *ToggleDiv.js*, *ToggleImg.js*</span><span class="sxs-lookup"><span data-stu-id="e7e6f-231">*AddAltToImg.js*, *ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="e7e6f-232">Include("~/Scripts/Common/T\*.js")</span><span class="sxs-lookup"><span data-stu-id="e7e6f-232">Include("~/Scripts/Common/T\*.js")</span></span> | <span data-ttu-id="e7e6f-233">Excepción de patrón no válida.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-233">Invalid pattern exception.</span></span> <span data-ttu-id="e7e6f-234">El carácter comodín solo se permite en el prefijo o sufijo.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-234">The wildcard character is only allowed on the prefix or suffix.</span></span> |
| <span data-ttu-id="e7e6f-235">Incluya ("~/Scripts/Common/\*OG.\*")</span><span class="sxs-lookup"><span data-stu-id="e7e6f-235">Include("~/Scripts/Common/\*og.\*")</span></span> | <span data-ttu-id="e7e6f-236">Excepción de patrón no válida.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-236">Invalid pattern exception.</span></span> <span data-ttu-id="e7e6f-237">Solo se permite un carácter comodín.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-237">Only one wildcard character is allowed.</span></span> |
| <span data-ttu-id="e7e6f-238">Include ("~/Scripts/Common/T\*")</span><span class="sxs-lookup"><span data-stu-id="e7e6f-238">Include("~/Scripts/Common/T\*")</span></span> | <span data-ttu-id="e7e6f-239">*ToggleDiv. js*, *ToggleImg. js*</span><span class="sxs-lookup"><span data-stu-id="e7e6f-239">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="e7e6f-240">Include ("~/Scripts/Common/\*")</span><span class="sxs-lookup"><span data-stu-id="e7e6f-240">Include("~/Scripts/Common/\*")</span></span> | <span data-ttu-id="e7e6f-241">Excepción de patrón no válida.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-241">Invalid pattern exception.</span></span> <span data-ttu-id="e7e6f-242">Un segmento de carácter comodín puro no es válido.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-242">A pure wildcard segment is not valid.</span></span> |
| <span data-ttu-id="e7e6f-243">IncludeDirectory("~/Scripts/Common", "T\*")</span><span class="sxs-lookup"><span data-stu-id="e7e6f-243">IncludeDirectory("~/Scripts/Common", "T\*")</span></span> | <span data-ttu-id="e7e6f-244">*ToggleDiv. js*, *ToggleImg. js*</span><span class="sxs-lookup"><span data-stu-id="e7e6f-244">*ToggleDiv.js*, *ToggleImg.js*</span></span> |
| <span data-ttu-id="e7e6f-245">IncludeDirectory ("~/Scripts/Common", "T\*", true)</span><span class="sxs-lookup"><span data-stu-id="e7e6f-245">IncludeDirectory("~/Scripts/Common", "T\*", true)</span></span> | <span data-ttu-id="e7e6f-246">*ToggleDiv. js*, *ToggleImg. js*, *ToggleLinks. js*</span><span class="sxs-lookup"><span data-stu-id="e7e6f-246">*ToggleDiv.js*, *ToggleImg.js*, *ToggleLinks.js*</span></span> |

<span data-ttu-id="e7e6f-247">Agregar explícitamente cada archivo a una agrupación suele ser preferible a la carga de archivos con comodín por los siguientes motivos:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-247">Explicitly adding each file to a bundle is generally the preferred over wildcard loading of files for the following reasons:</span></span>

- <span data-ttu-id="e7e6f-248">La adición de scripts de forma predeterminada para cargarlos en orden alfabético, que normalmente no es lo que se desea.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-248">Adding scripts by wildcard defaults to loading them in alphabetical order, which is typically not what you want.</span></span> <span data-ttu-id="e7e6f-249">Con frecuencia, los archivos CSS y JavaScript deben agregarse en un orden específico (no alfabético).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-249">CSS and JavaScript files frequently need to be added in a specific (non-alphabetic) order.</span></span> <span data-ttu-id="e7e6f-250">Puede mitigar este riesgo agregando una implementación de [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) personalizada, pero agregar explícitamente cada archivo es menos propenso a errores.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-250">You can mitigate this risk by adding a custom [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation, but explicitly adding each file is less error prone.</span></span> <span data-ttu-id="e7e6f-251">Por ejemplo, podría agregar nuevos recursos a una carpeta en el futuro, lo que podría requerir que modifique la implementación de [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-251">For example, you might add new assets to a folder in the future which might require you to modify your [IBundleOrderer](https://msdn.microsoft.com/library/system.web.optimization.ibundleorderer(VS.110).aspx) implementation.</span></span>
- <span data-ttu-id="e7e6f-252">La visualización de archivos específicos agregados a un directorio mediante la carga de caracteres comodín puede incluirse en todas las vistas que hacen referencia a ese lote.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-252">View specific files added to a directory using wild card loading can be included in all views referencing that bundle.</span></span> <span data-ttu-id="e7e6f-253">Si el script específico de la vista se agrega a un paquete, es posible que obtenga un error de JavaScript en otras vistas que hagan referencia a la agrupación.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-253">If the view specific script is added to a bundle, you may get a JavaScript error on other views that reference the bundle.</span></span>
- <span data-ttu-id="e7e6f-254">Los archivos CSS que importan otros archivos hacen que los archivos importados se carguen dos veces.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-254">CSS files that import other files result in the imported files loaded twice.</span></span> <span data-ttu-id="e7e6f-255">Por ejemplo, el código siguiente crea una agrupación con la mayoría de los archivos CSS de tema de la interfaz de usuario de jQuery cargados dos veces.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-255">For example, the following code creates a bundle with most of the jQuery UI theme CSS files loaded twice.</span></span> 

    [!code-csharp[Main](bundling-and-minification/samples/sample12.cs)]

  <span data-ttu-id="e7e6f-256">El selector de carácter comodín "\*. css" incluye en cada archivo CSS de la carpeta, incluido el *contenido\\temas\\base\\jQuery. UI. All. CSS* File.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-256">The wild card selector "\*.css" brings in each CSS file in the folder, including the *Content\\themes\\base\\jquery.ui.all.css* file.</span></span> <span data-ttu-id="e7e6f-257">El archivo *jQuery. UI. All. CSS* importa otros archivos CSS.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-257">The *jquery.ui.all.css* file imports other CSS files.</span></span>

## <a name="bundle-caching"></a><span data-ttu-id="e7e6f-258">Agrupación en caché</span><span class="sxs-lookup"><span data-stu-id="e7e6f-258">Bundle Caching</span></span>

<span data-ttu-id="e7e6f-259">Agrupaciones establezca el encabezado Expires de HTTP un año a partir de la creación de la agrupación.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-259">Bundles set the HTTP Expires Header one year from when the bundle is created.</span></span> <span data-ttu-id="e7e6f-260">Si navega a una página que se ha visto anteriormente, Fiddler muestra que IE no realiza una solicitud condicional para la agrupación, es decir, no hay solicitudes HTTP GET procedentes de IE para las agrupaciones y ninguna respuesta HTTP 304 del servidor.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-260">If you navigate to a previously viewed page, Fiddler shows IE does not make a conditional request for the bundle, that is, there are no HTTP GET requests from IE for the bundles and no HTTP 304 responses from the server.</span></span> <span data-ttu-id="e7e6f-261">Puede forzar que IE realice una solicitud condicional para cada paquete con la tecla F5 (lo que da como resultado una respuesta HTTP 304 para cada paquete).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-261">You can force IE to make a conditional request for each bundle with the F5 key (resulting in a HTTP 304 response for each bundle).</span></span> <span data-ttu-id="e7e6f-262">Puede forzar una actualización completa mediante ^ F5 (lo que da como resultado una respuesta HTTP 200 para cada paquete).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-262">You can force a full refresh by using ^F5 (resulting in a HTTP 200 response for each bundle.)</span></span>

<span data-ttu-id="e7e6f-263">En la imagen siguiente se muestra la pestaña **almacenamiento en caché** del panel de respuesta Fiddler:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-263">The following image shows the **Caching** tab of the Fiddler response pane:</span></span>

![imagen de almacenamiento en caché de Fiddler](bundling-and-minification/_static/image8.png)

<span data-ttu-id="e7e6f-265">Solicitud</span><span class="sxs-lookup"><span data-stu-id="e7e6f-265">The request</span></span>   
`http://localhost/MvcBM_time/bundles/AllMyScripts?v=r0sLDicvP58AIXN_mc3QdyVvVj5euZNzdsa2N1PKvb81`  
 <span data-ttu-id="e7e6f-266">es para la agrupación **AllMyScripts** y contiene una cadena de consulta Pair **v = R0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-266">is for the bundle **AllMyScripts** and contains a query string pair **v=r0sLDicvP58AIXN\\\_mc3QdyVvVj5euZNzdsa2N1PKvb81**.</span></span> <span data-ttu-id="e7e6f-267">La cadena de consulta **v** tiene un token de valor que es un identificador único que se usa para el almacenamiento en caché.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-267">The query string **v** has a value token that is a unique identifier used for caching.</span></span> <span data-ttu-id="e7e6f-268">Siempre que el paquete no cambie, la aplicación ASP.NET solicitará el paquete **AllMyScripts** con este token.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-268">As long as the bundle doesn't change, the ASP.NET application will request the **AllMyScripts** bundle using this token.</span></span> <span data-ttu-id="e7e6f-269">Si cambia algún archivo de la agrupación, el marco de optimización de ASP.NET generará un nuevo token, lo que garantiza que las solicitudes del explorador para la agrupación obtendrán el paquete más reciente.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-269">If any file in the bundle changes, the ASP.NET optimization framework will generate a new token, guaranteeing that browser requests for the bundle will get the latest bundle.</span></span>

<span data-ttu-id="e7e6f-270">Si ejecuta las herramientas de desarrollo de IE9 F12 y navega a una página cargada anteriormente, IE muestra incorrectamente las solicitudes GET condicionales realizadas a cada agrupación y el servidor devuelve HTTP 304.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-270">If you run the IE9 F12 developer tools and navigate to a previously loaded page, IE incorrectly shows conditional GET requests made to each bundle and the server returning HTTP 304.</span></span> <span data-ttu-id="e7e6f-271">Puede leer por qué IE9 tiene problemas para determinar si se realizó una solicitud condicional en la entrada de blog [mediante redes CDN y expira para mejorar el rendimiento del sitio web](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-271">You can read why IE9 has problems determining if a conditional request was made in the blog entry [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

## <a name="less-coffeescript-scss-sass-bundling"></a><span data-ttu-id="e7e6f-272">LESS, CoffeeScript, SCSS y Sass.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-272">LESS, CoffeeScript, SCSS, Sass Bundling.</span></span>

<span data-ttu-id="e7e6f-273">El marco de trabajo de agrupación y minificación proporciona un mecanismo para procesar lenguajes intermedios como [SCSS](http://sass-lang.com/), [Sass](http://sass-lang.com/), [less](http://www.dotlesscss.org/) o [CoffeeScript](http://coffeescript.org/)y aplicar transformaciones como minificación al grupo resultante.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-273">The bundling and minification framework provides a mechanism to process intermediate languages such as [SCSS](http://sass-lang.com/), [Sass](http://sass-lang.com/), [LESS](http://www.dotlesscss.org/) or [Coffeescript](http://coffeescript.org/), and apply transforms such as minification to the resulting bundle.</span></span> <span data-ttu-id="e7e6f-274">Por ejemplo, para agregar archivos [. Less](http://www.dotlesscss.org/) al proyecto de MVC 4:</span><span class="sxs-lookup"><span data-stu-id="e7e6f-274">For example, to add [.less](http://www.dotlesscss.org/) files to your MVC 4 project:</span></span>

1. <span data-ttu-id="e7e6f-275">Cree una carpeta para el menor contenido.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-275">Create a folder for your LESS content.</span></span> <span data-ttu-id="e7e6f-276">En el ejemplo siguiente se usa el *contenido\\* carpeta.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-276">The following example uses the *Content\\MyLess* folder.</span></span>
2. <span data-ttu-id="e7e6f-277">Agregue **el paquete NuGet** [. Less](http://www.dotlesscss.org/) sin punto a su proyecto.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-277">Add the [.less](http://www.dotlesscss.org/) NuGet package **dotless** to your project.</span></span>  
    <span data-ttu-id="e7e6f-278">![instalación sin punto de NuGet](bundling-and-minification/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="e7e6f-278">![NuGet dotless install](bundling-and-minification/_static/image9.png)</span></span>
3. <span data-ttu-id="e7e6f-279">Agregue una clase que implemente la interfaz [IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-279">Add a class that implements the [IBundleTransform](https://msdn.microsoft.com/library/system.web.optimization.ibundletransform(VS.110).aspx) interface.</span></span> <span data-ttu-id="e7e6f-280">Para la transformación. Less, agregue el código siguiente al proyecto.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-280">For the .less transform, add the following code to your project.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample13.cs)]
4. <span data-ttu-id="e7e6f-281">Cree una agrupación de menos archivos con la `LessTransform` y la transformación [CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx) .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-281">Create a bundle of LESS files with the `LessTransform` and the [CssMinify](https://msdn.microsoft.com/library/system.web.optimization.cssminify(VS.110).aspx) transform.</span></span> <span data-ttu-id="e7e6f-282">Agregue el código siguiente al método `RegisterBundles` en el archivo *App\\_Start\\BundleConfig.CS* .</span><span class="sxs-lookup"><span data-stu-id="e7e6f-282">Add the following code to the `RegisterBundles` method in the *App\\_Start\\BundleConfig.cs* file.</span></span>

    [!code-csharp[Main](bundling-and-minification/samples/sample14.cs)]
5. <span data-ttu-id="e7e6f-283">Agregue el código siguiente a cualquier vista que haga referencia a la agrupación LESS.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-283">Add the following code to any views which references the LESS bundle.</span></span>

    [!code-cshtml[Main](bundling-and-minification/samples/sample15.cshtml)]

## <a name="bundle-considerations"></a><span data-ttu-id="e7e6f-284">Consideraciones de agrupación</span><span class="sxs-lookup"><span data-stu-id="e7e6f-284">Bundle Considerations</span></span>

<span data-ttu-id="e7e6f-285">Una buena Convención que se debe seguir al crear paquetes es incluir "bundle" como prefijo en el nombre de la agrupación.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-285">A good convention to follow when creating bundles is to include "bundle" as a prefix in the bundle name.</span></span> <span data-ttu-id="e7e6f-286">Esto impedirá un posible [conflicto de enrutamiento](https://forums.asp.net/post/5012037.aspx).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-286">This will prevent a possible [routing conflict](https://forums.asp.net/post/5012037.aspx).</span></span>

<span data-ttu-id="e7e6f-287">Una vez que se actualiza un archivo en una agrupación, se genera un nuevo token para el parámetro de cadena de consulta de agrupación y se debe descargar el paquete completo la próxima vez que un cliente solicite una página que contenga la agrupación.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-287">Once you update one file in a bundle, a new token is generated for the bundle query string parameter and the full bundle must be downloaded the next time a client requests a page containing the bundle.</span></span> <span data-ttu-id="e7e6f-288">En el marcado tradicional en el que cada activo se muestra individualmente, solo se descargaría el archivo modificado.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-288">In traditional markup where each asset is listed individually, only the changed file would be downloaded.</span></span> <span data-ttu-id="e7e6f-289">Los recursos que cambian con frecuencia pueden no ser buenos candidatos para la agrupación.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-289">Assets that change frequently may not be good candidates for bundling.</span></span>

<span data-ttu-id="e7e6f-290">La agrupación y minificación mejoran principalmente el tiempo de carga de la primera solicitud de página.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-290">Bundling and minification primarily improve the first page request load time.</span></span> <span data-ttu-id="e7e6f-291">Una vez que se ha solicitado una página web, el explorador almacena en caché los recursos (JavaScript, CSS e imágenes), por lo que la Unión y minificación no proporcionarán ningún aumento del rendimiento al solicitar la misma página o páginas en el mismo sitio que soliciten los mismos recursos.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-291">Once a webpage has been requested, the browser caches the assets (JavaScript, CSS and images) so bundling and minification won't provide any performance boost when requesting the same page, or pages on the same site requesting the same assets.</span></span> <span data-ttu-id="e7e6f-292">Si no establece el encabezado Expires correctamente en sus activos y no usa la agrupación y minificación, la heurística de actualización de exploradores marcará los recursos obsoletos después de unos días y el explorador requerirá una solicitud de validación para cada activo.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-292">If you don't set the expires header correctly on your assets, and you don't use bundling and minification, the browsers freshness heuristics will mark the assets stale after a few days and the browser will require a validation request for each asset.</span></span> <span data-ttu-id="e7e6f-293">En este caso, la agrupación y la minificación proporcionan un aumento del rendimiento después de la primera solicitud de la página.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-293">In this case, bundling and minification provide a performance increase after the first page request.</span></span> <span data-ttu-id="e7e6f-294">Para obtener más información, consulte el blog [uso de redes CDN y expira para mejorar el rendimiento del sitio web](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-294">For details, see the blog [Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span>

<span data-ttu-id="e7e6f-295">La limitación del explorador de seis conexiones simultáneas por cada nombre de host se puede mitigar mediante una [red CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-295">The browser limitation of six simultaneous connections per each hostname can be mitigated by using a [CDN](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx).</span></span> <span data-ttu-id="e7e6f-296">Dado que la red CDN tendrá un nombre de host diferente al del sitio de hospedaje, las solicitudes de recursos de la red CDN no contarán en el límite de seis conexiones simultáneas para el entorno de hospedaje.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-296">Because the CDN will have a different hostname than your hosting site, asset requests from the CDN will not count against the six simultaneous connections limit to your hosting environment.</span></span> <span data-ttu-id="e7e6f-297">Una red CDN también puede proporcionar un almacenamiento en caché de paquetes común y las ventajas de almacenamiento en caché perimetral.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-297">A CDN can also provide common package caching and edge caching advantages.</span></span>

<span data-ttu-id="e7e6f-298">Las agrupaciones se deben particionar por páginas que las necesiten.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-298">Bundles should be partitioned by pages that need them.</span></span> <span data-ttu-id="e7e6f-299">Por ejemplo, la plantilla predeterminada de MVC de ASP.NET para una aplicación de Internet crea un paquete de validación de jQuery independiente de jQuery.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-299">For example, the default ASP.NET MVC template for an internet application creates a jQuery Validation bundle separate from jQuery.</span></span> <span data-ttu-id="e7e6f-300">Dado que las vistas predeterminadas creadas no tienen ninguna entrada y no envían valores, no incluyen el paquete de validación.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-300">Because the default views created have no input and do not post values, they don't include the validation bundle.</span></span>

<span data-ttu-id="e7e6f-301">El espacio de nombres `System.Web.Optimization` se implementa en *System. Web. Optimization. dll*.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-301">The `System.Web.Optimization` namespace is implemented in *System.Web.Optimization.dll*.</span></span> <span data-ttu-id="e7e6f-302">Aprovecha la biblioteca webgrasa (*webgrasa. dll*) para las funcionalidades de minificación, que a su vez usa *Antlr3. Runtime. dll*.</span><span class="sxs-lookup"><span data-stu-id="e7e6f-302">It leverages the WebGrease library (*WebGrease.dll*) for minification capabilities, which in turn uses *Antlr3.Runtime.dll*.</span></span>

<span data-ttu-id="e7e6f-303">*Utilizo Twitter para hacer entradas rápidas y compartir vínculos. Mi identificador de Twitter es*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="e7e6f-303">*I use Twitter to make quick posts and share links. My Twitter handle is*: [@RickAndMSFT](http://twitter.com/RickAndMSFT)</span></span>

## <a name="additional-resources"></a><span data-ttu-id="e7e6f-304">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="e7e6f-304">Additional resources</span></span>

- <span data-ttu-id="e7e6f-305">Vídeo:[agrupar y optimizar](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing) mediante [Howard Dierking](https://twitter.com/#!/howard_dierking)</span><span class="sxs-lookup"><span data-stu-id="e7e6f-305">Video:[Bundling and Optimizing](https://channel9.msdn.com/Events/aspConf/aspConf/Bundling-and-Optimizing) by [Howard Dierking](https://twitter.com/#!/howard_dierking)</span></span>
- <span data-ttu-id="e7e6f-306">[Agregar optimización web a un sitio de Web pages](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-306">[Adding Web Optimization to a Web Pages Site](https://blogs.msdn.com/b/rickandy/archive/2012/08/15/adding-web-optimization-to-a-web-pages-site.aspx).</span></span>
- <span data-ttu-id="e7e6f-307">[Agregar agrupación y minificación a formularios Web Forms](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx).</span><span class="sxs-lookup"><span data-stu-id="e7e6f-307">[Adding Bundling and Minification to Web Forms](https://blogs.msdn.com/b/rickandy/archive/2012/08/14/adding-bundling-and-minification-to-web-forms.aspx).</span></span>
- <span data-ttu-id="e7e6f-308">[Implicaciones de rendimiento de la agrupación y minificación en la exploración Web](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx) mediante el [@frystyk](https://twitter.com/frystyk) de [Henrik F Nielsen](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen)</span><span class="sxs-lookup"><span data-stu-id="e7e6f-308">[Performance Implications of Bundling and Minification on Web Browsing](https://blogs.msdn.com/b/henrikn/archive/2012/06/17/performance-implications-of-bundling-and-minification-on-http.aspx) by [Henrik F Nielsen](http://en.wikipedia.org/wiki/Henrik_Frystyk_Nielsen) [@frystyk](https://twitter.com/frystyk)</span></span>
- <span data-ttu-id="e7e6f-309">El [uso de redes CDN y expira para mejorar el rendimiento del sitio web](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) por Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="e7e6f-309">[Using CDNs and Expires to Improve Web Site Performance](https://blogs.msdn.com/b/rickandy/archive/2011/05/21/using-cdns-to-improve-web-site-performance.aspx) by Rick Anderson [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT)</span></span>
- [<span data-ttu-id="e7e6f-310">Minimizar RTT (tiempos de ida y vuelta)</span><span class="sxs-lookup"><span data-stu-id="e7e6f-310">Minimize RTT (round-trip times)</span></span>](https://developers.google.com/speed/docs/best-practices/rtt)

## <a name="contributors"></a><span data-ttu-id="e7e6f-311">Colaboradores</span><span class="sxs-lookup"><span data-stu-id="e7e6f-311">Contributors</span></span>

- <span data-ttu-id="e7e6f-312">Hao Kung</span><span class="sxs-lookup"><span data-stu-id="e7e6f-312">Hao Kung</span></span>
- [<span data-ttu-id="e7e6f-313">Howard Dierking</span><span class="sxs-lookup"><span data-stu-id="e7e6f-313">Howard Dierking</span></span>](https://twitter.com/#!/howard_dierking)
- <span data-ttu-id="e7e6f-314">Diana LaRose</span><span class="sxs-lookup"><span data-stu-id="e7e6f-314">Diana LaRose</span></span>

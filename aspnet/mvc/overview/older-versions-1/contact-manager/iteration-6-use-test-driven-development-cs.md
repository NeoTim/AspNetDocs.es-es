---
uid: mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
title: 'Iteración #6: use el desarrollo controlado por pruebas (C-) Microsoft Docs'
author: rick-anderson
description: En esta sexta iteración, agregamos nueva funcionalidad a nuestra aplicación escribiendo primero las pruebas unitarias y escribiendo código en las pruebas unitarias. En esta iteración,...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 013c3c26-7dc3-41d1-8064-f233c86008b5
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
msc.type: authoredcontent
ms.openlocfilehash: d0e8f30a075cc79c7410ffe1b8bf02da2bd44443
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542331"
---
# <a name="iteration-6--use-test-driven-development-c"></a><span data-ttu-id="0baad-104">Iteración n.º 6: Usar el desarrollo mediante pruebas (C#)</span><span class="sxs-lookup"><span data-stu-id="0baad-104">Iteration #6 – Use test-driven development (C#)</span></span>

<span data-ttu-id="0baad-105">por [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="0baad-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="0baad-106">Descargar código</span><span class="sxs-lookup"><span data-stu-id="0baad-106">Download Code</span></span>](iteration-6-use-test-driven-development-cs/_static/contactmanager_6_cs1.zip)

> <span data-ttu-id="0baad-107">En esta sexta iteración, agregamos nueva funcionalidad a nuestra aplicación escribiendo primero las pruebas unitarias y escribiendo código en las pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-107">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="0baad-108">En esta iteración, agregamos grupos de contactos.</span><span class="sxs-lookup"><span data-stu-id="0baad-108">In this iteration, we add contact groups.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="0baad-109">Creación de una aplicación de administración de contactos ASP.NET MVC (C-)</span><span class="sxs-lookup"><span data-stu-id="0baad-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="0baad-110">En esta serie de tutoriales, creamos una aplicación de administración de contactos completa de principio a fin.</span><span class="sxs-lookup"><span data-stu-id="0baad-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="0baad-111">La aplicación Contact Manager le permite almacenar información de contacto (nombres, números de teléfono y direcciones de correo electrónico) para una lista de personas.</span><span class="sxs-lookup"><span data-stu-id="0baad-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="0baad-112">Creamos la aplicación en varias iteraciones.</span><span class="sxs-lookup"><span data-stu-id="0baad-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="0baad-113">Con cada iteración, mejoramos gradualmente la aplicación.</span><span class="sxs-lookup"><span data-stu-id="0baad-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="0baad-114">El objetivo de este enfoque de iteración múltiple es permitirle comprender el motivo de cada cambio.</span><span class="sxs-lookup"><span data-stu-id="0baad-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="0baad-115">#1 de iteración: cree la aplicación.</span><span class="sxs-lookup"><span data-stu-id="0baad-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="0baad-116">En la primera iteración, creamos Contact Manager de la manera más sencilla posible.</span><span class="sxs-lookup"><span data-stu-id="0baad-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="0baad-117">Agregamos compatibilidad con operaciones básicas de base de datos: Crear, leer, actualizar y eliminar (CRUD).</span><span class="sxs-lookup"><span data-stu-id="0baad-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="0baad-118">Iteración #2 - Hacer que la aplicación se vea bien.</span><span class="sxs-lookup"><span data-stu-id="0baad-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="0baad-119">En esta iteración, mejoramos el aspecto de la aplicación modificando la página maestra de vista de ASP.NET MVC predeterminada y la hoja de estilos en cascada.</span><span class="sxs-lookup"><span data-stu-id="0baad-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="0baad-120">#3 de iteración: agregar validación de formulario.</span><span class="sxs-lookup"><span data-stu-id="0baad-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="0baad-121">En la tercera iteración, agregamos validación básica del formulario.</span><span class="sxs-lookup"><span data-stu-id="0baad-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="0baad-122">Evitamos que las personas envíen un formulario sin completar los campos de formulario obligatorios.</span><span class="sxs-lookup"><span data-stu-id="0baad-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="0baad-123">También validamos direcciones de correo electrónico y números de teléfono.</span><span class="sxs-lookup"><span data-stu-id="0baad-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="0baad-124">Iteración #4: haga que la aplicación se acople libremente.</span><span class="sxs-lookup"><span data-stu-id="0baad-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="0baad-125">En esta cuarta iteración, aprovechamos varios patrones de diseño de software para facilitar el mantenimiento y la modificación de la aplicación Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="0baad-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="0baad-126">Por ejemplo, refactorizamos nuestra aplicación para usar el patrón Repository y el patrón Dependency Injection.</span><span class="sxs-lookup"><span data-stu-id="0baad-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="0baad-127">Iteración #5: crear pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="0baad-128">En la quinta iteración, hacemos que nuestra aplicación sea más fácil de mantener y modificar agregando pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="0baad-129">Nos burlamos de nuestras clases de modelo de datos y creamos pruebas unitarias para nuestros controladores y lógica de validación.</span><span class="sxs-lookup"><span data-stu-id="0baad-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="0baad-130">#6 de iteración: use el desarrollo controlado por pruebas.</span><span class="sxs-lookup"><span data-stu-id="0baad-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="0baad-131">En esta sexta iteración, agregamos nueva funcionalidad a nuestra aplicación escribiendo primero las pruebas unitarias y escribiendo código en las pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="0baad-132">En esta iteración, agregamos grupos de contactos.</span><span class="sxs-lookup"><span data-stu-id="0baad-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="0baad-133">de #7 iteración: agregue la funcionalidad DebAjax.</span><span class="sxs-lookup"><span data-stu-id="0baad-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="0baad-134">En la séptima iteración, mejoramos la capacidad de respuesta y el rendimiento de nuestra aplicación mediante la adición de compatibilidad con Ajax.</span><span class="sxs-lookup"><span data-stu-id="0baad-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="0baad-135">Esta iteración</span><span class="sxs-lookup"><span data-stu-id="0baad-135">This Iteration</span></span>

<span data-ttu-id="0baad-136">En la iteración anterior de la aplicación Contact Manager, creamos pruebas unitarias para proporcionar una red de seguridad para nuestro código.</span><span class="sxs-lookup"><span data-stu-id="0baad-136">In the previous iteration of the Contact Manager application, we created unit tests to provide a safety net for our code.</span></span> <span data-ttu-id="0baad-137">La motivación para crear las pruebas unitarias era hacer que nuestro código fuera más resistente al cambio.</span><span class="sxs-lookup"><span data-stu-id="0baad-137">The motivation for creating the unit tests was to make our code more resilient to change.</span></span> <span data-ttu-id="0baad-138">Con las pruebas unitarias en su lugar, podemos hacer felizmente cualquier cambio en nuestro código e inmediatamente saber si hemos roto la funcionalidad existente.</span><span class="sxs-lookup"><span data-stu-id="0baad-138">With unit tests in place, we can happily make any change to our code and immediately know whether we have broken existing functionality.</span></span>

<span data-ttu-id="0baad-139">En esta iteración, usamos pruebas unitarias para un propósito completamente diferente.</span><span class="sxs-lookup"><span data-stu-id="0baad-139">In this iteration, we use unit tests for an entirely different purpose.</span></span> <span data-ttu-id="0baad-140">En esta iteración, usamos pruebas unitarias como parte de una filosofía de diseño de aplicación denominada *desarrollo controlado por pruebas.*</span><span class="sxs-lookup"><span data-stu-id="0baad-140">In this iteration, we use unit tests as part of an application design philosophy called *test-driven development*.</span></span> <span data-ttu-id="0baad-141">Cuando se practica el desarrollo controlado por pruebas, primero se escriben pruebas y, a continuación, se escribe código en las pruebas.</span><span class="sxs-lookup"><span data-stu-id="0baad-141">When you practice test-driven development, you write tests first and then write code against the tests.</span></span>

<span data-ttu-id="0baad-142">Más precisamente, al practicar el desarrollo controlado por pruebas, hay tres pasos que se completan al crear código (Rojo/Verde/Refactor):</span><span class="sxs-lookup"><span data-stu-id="0baad-142">More precisely, when practicing test-driven development, there are three steps that you complete when creating code (Red/ Green/Refactor):</span></span>

1. <span data-ttu-id="0baad-143">Escribir una prueba unitaria que falle (Rojo)</span><span class="sxs-lookup"><span data-stu-id="0baad-143">Write a unit test that fails (Red)</span></span>
2. <span data-ttu-id="0baad-144">Escribir código que pase la prueba unitaria (verde)</span><span class="sxs-lookup"><span data-stu-id="0baad-144">Write code that passes the unit test (Green)</span></span>
3. <span data-ttu-id="0baad-145">Refactorizar el código (Refactorizar)</span><span class="sxs-lookup"><span data-stu-id="0baad-145">Refactor your code (Refactor)</span></span>

<span data-ttu-id="0baad-146">En primer lugar, escriba la prueba unitaria.</span><span class="sxs-lookup"><span data-stu-id="0baad-146">First, you write the unit test.</span></span> <span data-ttu-id="0baad-147">La prueba unitaria debe expresar su intención de cómo espera que se comporte el código.</span><span class="sxs-lookup"><span data-stu-id="0baad-147">The unit test should express your intention for how you expect your code to behave.</span></span> <span data-ttu-id="0baad-148">La primera vez que cree la prueba unitaria, la prueba unitaria debe fallar.</span><span class="sxs-lookup"><span data-stu-id="0baad-148">When you first create the unit test, the unit test should fail.</span></span> <span data-ttu-id="0baad-149">La prueba debe producir un error porque aún no ha escrito ningún código de aplicación que satisfaga la prueba.</span><span class="sxs-lookup"><span data-stu-id="0baad-149">The test should fail because you have not yet written any application code that satisfies the test.</span></span>

<span data-ttu-id="0baad-150">A continuación, escriba suficiente código para que pase la prueba unitaria.</span><span class="sxs-lookup"><span data-stu-id="0baad-150">Next, you write just enough code in order for the unit test to pass.</span></span> <span data-ttu-id="0baad-151">El objetivo es escribir el código de la manera más laz, más descuidada y rápida posible.</span><span class="sxs-lookup"><span data-stu-id="0baad-151">The goal is to write the code in the laziest, sloppiest and fastest possible way.</span></span> <span data-ttu-id="0baad-152">No debe perder el tiempo pensando en la arquitectura de su aplicación.</span><span class="sxs-lookup"><span data-stu-id="0baad-152">You should not waste time thinking about the architecture of your application.</span></span> <span data-ttu-id="0baad-153">En su lugar, debe centrarse en escribir la cantidad mínima de código necesaria para satisfacer la intención expresada por la prueba unitaria.</span><span class="sxs-lookup"><span data-stu-id="0baad-153">Instead, you should focus on writing the minimal amount of code necessary to satisfy the intention expressed by the unit test.</span></span>

<span data-ttu-id="0baad-154">Por último, después de haber escrito suficiente código, puede retroceder y considerar la arquitectura general de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="0baad-154">Finally, after you have written enough code, you can step back and consider the overall architecture of your application.</span></span> <span data-ttu-id="0baad-155">En este paso, reescribirá (refactorizará) el código aprovechando los patrones de diseño de software, como el patrón de repositorio, para que el código sea más mantenible.</span><span class="sxs-lookup"><span data-stu-id="0baad-155">In this step, you rewrite (refactor) your code by taking advantage of software design patterns -- such as the repository pattern -- so that your code is more maintainable.</span></span> <span data-ttu-id="0baad-156">Puede reescribir sin miedo el código en este paso porque el código está cubierto por pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-156">You can fearlessly rewrite your code in this step because your code is covered by unit tests.</span></span>

<span data-ttu-id="0baad-157">Hay muchos beneficios que resultan de la práctica del desarrollo basado en pruebas.</span><span class="sxs-lookup"><span data-stu-id="0baad-157">There are many benefits that result from practicing test-driven development.</span></span> <span data-ttu-id="0baad-158">En primer lugar, el desarrollo controlado por pruebas le obliga a centrarse en el código que realmente necesita ser escrito.</span><span class="sxs-lookup"><span data-stu-id="0baad-158">First, test-driven development forces you to focus on code that actually needs to be written.</span></span> <span data-ttu-id="0baad-159">Debido a que constantemente se centra en escribir suficiente código para pasar una prueba en particular, se le impide vagar por las malas hierbas y escribir cantidades masivas de código que nunca usará.</span><span class="sxs-lookup"><span data-stu-id="0baad-159">Because you are constantly focused on just writing enough code to pass a particular test, you are prevented from wandering into the weeds and writing massive amounts of code that you will never use.</span></span>

<span data-ttu-id="0baad-160">En segundo lugar, una metodología de diseño "test first" le obliga a escribir código desde la perspectiva de cómo se usará el código.</span><span class="sxs-lookup"><span data-stu-id="0baad-160">Second, a "test first" design methodology forces you to write code from the perspective of how your code will be used.</span></span> <span data-ttu-id="0baad-161">En otras palabras, cuando se practica el desarrollo basado en pruebas, se escriben constantemente las pruebas desde la perspectiva del usuario.</span><span class="sxs-lookup"><span data-stu-id="0baad-161">In other words, when practicing test-driven development, you are constantly writing your tests from a user perspective.</span></span> <span data-ttu-id="0baad-162">Por lo tanto, el desarrollo controlado por pruebas puede dar lugar a API más limpias y comprensibles.</span><span class="sxs-lookup"><span data-stu-id="0baad-162">Therefore, test-driven development can result in cleaner and more understandable APIs.</span></span>

<span data-ttu-id="0baad-163">Por último, el desarrollo controlado por pruebas le obliga a escribir pruebas unitarias como parte del proceso normal de escritura de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="0baad-163">Finally, test-driven development forces you to write unit tests as part of the normal process of writing an application.</span></span> <span data-ttu-id="0baad-164">A medida que se acerca una fecha límite del proyecto, las pruebas suelen ser lo primero que sale por la ventana.</span><span class="sxs-lookup"><span data-stu-id="0baad-164">As a project deadline approaches, testing is typically the first thing that goes out the window.</span></span> <span data-ttu-id="0baad-165">Al practicar el desarrollo basado en pruebas, por otro lado, es más probable que sea virtuoso sobre la escritura de pruebas unitarias porque el desarrollo basado en pruebas hace que las pruebas unitarias sean fundamentales para el proceso de creación de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="0baad-165">When practicing test-driven development, on the other hand, you are more likely to be virtuous about writing unit tests because test-driven development makes unit tests central to the process of building an application.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="0baad-166">Para obtener más información sobre el desarrollo basado en pruebas, le recomiendo que lea el libro de Michael Feathers **Trabajar eficazmente con código heredado**.</span><span class="sxs-lookup"><span data-stu-id="0baad-166">To learn more about test-driven development, I recommend that you read Michael Feathers book **Working Effectively with Legacy Code**.</span></span>

<span data-ttu-id="0baad-167">En esta iteración, agregamos una nueva característica a nuestra aplicación Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="0baad-167">In this iteration, we add a new feature to our Contact Manager application.</span></span> <span data-ttu-id="0baad-168">Agregamos soporte para grupos de contacto.</span><span class="sxs-lookup"><span data-stu-id="0baad-168">We add support for Contact Groups.</span></span> <span data-ttu-id="0baad-169">Puedes usar Grupos de contactos para organizar tus contactos en categorías como Grupos de empresas y amigos.</span><span class="sxs-lookup"><span data-stu-id="0baad-169">You can use Contact Groups to organize your contacts into categories such as Business and Friend groups.</span></span>

<span data-ttu-id="0baad-170">Agregaremos esta nueva funcionalidad a nuestra aplicación siguiendo un proceso de desarrollo controlado por pruebas.</span><span class="sxs-lookup"><span data-stu-id="0baad-170">We'll add this new functionality to our application by following a process of test-driven development.</span></span> <span data-ttu-id="0baad-171">Primero escribiremos nuestras pruebas unitarias y escribiremos todo nuestro código con estas pruebas.</span><span class="sxs-lookup"><span data-stu-id="0baad-171">We'll write our unit tests first and we'll write all of our code against these tests.</span></span>

## <a name="what-gets-tested"></a><span data-ttu-id="0baad-172">Lo que se prueba</span><span class="sxs-lookup"><span data-stu-id="0baad-172">What Gets Tested</span></span>

<span data-ttu-id="0baad-173">Como hemos explicado en la iteración anterior, normalmente no se escriben pruebas unitarias para la lógica de acceso a datos o la lógica de vista.</span><span class="sxs-lookup"><span data-stu-id="0baad-173">As we discussed in the previous iteration, you typically do not write unit tests for data access logic or view logic.</span></span> <span data-ttu-id="0baad-174">No se escriben pruebas unitarias para la lógica de acceso a datos porque el acceso a una base de datos es una operación relativamente lenta.</span><span class="sxs-lookup"><span data-stu-id="0baad-174">You don t write unit tests for data access logic because accessing a database is a relatively slow operation.</span></span> <span data-ttu-id="0baad-175">No se escriben pruebas unitarias para la lógica de vista porque el acceso a una vista requiere poner en marcha un servidor web que es una operación relativamente lenta.</span><span class="sxs-lookup"><span data-stu-id="0baad-175">You don t write unit tests for view logic because accessing a view requires spinning up a web server which is a relatively slow operation.</span></span> <span data-ttu-id="0baad-176">No debe escribir una prueba unitaria a menos que la prueba se pueda ejecutar una y otra vez muy rápido</span><span class="sxs-lookup"><span data-stu-id="0baad-176">You shouldn't write a unit test unless the test can be executed over and over again very fast</span></span>

<span data-ttu-id="0baad-177">Dado que el desarrollo controlado por pruebas está impulsado por pruebas unitarias, nos centramos inicialmente en escribir el controlador y la lógica empresarial.</span><span class="sxs-lookup"><span data-stu-id="0baad-177">Because test-driven development is driven by unit tests, we focus initially on writing controller and business logic.</span></span> <span data-ttu-id="0baad-178">Evitamos tocar la base de datos o las vistas.</span><span class="sxs-lookup"><span data-stu-id="0baad-178">We avoid touching the database or views.</span></span> <span data-ttu-id="0baad-179">No modificaremos la base de datos ni crearemos nuestras vistas hasta el final de este tutorial.</span><span class="sxs-lookup"><span data-stu-id="0baad-179">We won't modify the database or create our views until the very end of this tutorial.</span></span> <span data-ttu-id="0baad-180">Comenzamos con lo que se puede probar.</span><span class="sxs-lookup"><span data-stu-id="0baad-180">We start with what can be tested.</span></span>

## <a name="creating-user-stories"></a><span data-ttu-id="0baad-181">Creación de historias de usuario</span><span class="sxs-lookup"><span data-stu-id="0baad-181">Creating User Stories</span></span>

<span data-ttu-id="0baad-182">Cuando se practica el desarrollo basado en pruebas, siempre comienza escribiendo una prueba.</span><span class="sxs-lookup"><span data-stu-id="0baad-182">When practicing test-driven development, you always start by writing a test.</span></span> <span data-ttu-id="0baad-183">Esto plantea inmediatamente la pregunta: ¿Cómo decide qué prueba escribir primero?</span><span class="sxs-lookup"><span data-stu-id="0baad-183">This immediately raises the question: How do you decide what test to write first?</span></span> <span data-ttu-id="0baad-184">Para responder a esta pregunta, debe escribir un conjunto de [**historias**](http://en.wikipedia.org/wiki/User_stories)de usuario .</span><span class="sxs-lookup"><span data-stu-id="0baad-184">To answer this question, you should write a set of [**user stories**](http://en.wikipedia.org/wiki/User_stories).</span></span>

<span data-ttu-id="0baad-185">Una historia de usuario es una descripción muy breve (normalmente una frase) de un requisito de software.</span><span class="sxs-lookup"><span data-stu-id="0baad-185">A user story is a very brief (usually one sentence) description of a software requirement.</span></span> <span data-ttu-id="0baad-186">Debe ser una descripción no técnica de un requisito escrito desde la perspectiva del usuario.</span><span class="sxs-lookup"><span data-stu-id="0baad-186">It should be a non-technical description of a requirement written from a user perspective.</span></span>

<span data-ttu-id="0baad-187">Aquí está el conjunto de historias de usuario que describen las características requeridas por la nueva funcionalidad del grupo de contacto:</span><span class="sxs-lookup"><span data-stu-id="0baad-187">Here s the set of user stories that describe the features required by the new Contact Group functionality:</span></span>

1. <span data-ttu-id="0baad-188">El usuario puede ver una lista de grupos de contactos.</span><span class="sxs-lookup"><span data-stu-id="0baad-188">User can view a list of contact groups.</span></span>
2. <span data-ttu-id="0baad-189">El usuario puede crear un nuevo grupo de contactos.</span><span class="sxs-lookup"><span data-stu-id="0baad-189">User can create a new contact group.</span></span>
3. <span data-ttu-id="0baad-190">El usuario puede eliminar un grupo de contactos existente.</span><span class="sxs-lookup"><span data-stu-id="0baad-190">User can delete an existing contact group.</span></span>
4. <span data-ttu-id="0baad-191">El usuario puede seleccionar un grupo de contactos al crear un nuevo contacto.</span><span class="sxs-lookup"><span data-stu-id="0baad-191">User can select a contact group when creating a new contact.</span></span>
5. <span data-ttu-id="0baad-192">El usuario puede seleccionar un grupo de contactos al editar un contacto existente.</span><span class="sxs-lookup"><span data-stu-id="0baad-192">User can select a contact group when editing an existing contact.</span></span>
6. <span data-ttu-id="0baad-193">Se muestra una lista de grupos de contactos en la vista de índice.</span><span class="sxs-lookup"><span data-stu-id="0baad-193">A list of contact groups is displayed in the Index view.</span></span>
7. <span data-ttu-id="0baad-194">Cuando un usuario hace clic en un grupo de contactos, se muestra una lista de contactos coincidentes.</span><span class="sxs-lookup"><span data-stu-id="0baad-194">When a user clicks a contact group, a list of matching contacts is displayed.</span></span>

<span data-ttu-id="0baad-195">Tenga en cuenta que esta lista de historias de usuario es completamente comprensible para un cliente.</span><span class="sxs-lookup"><span data-stu-id="0baad-195">Notice that this list of user stories is completely understandable by a customer.</span></span> <span data-ttu-id="0baad-196">No se mencionan los detalles técnicos de la implementación.</span><span class="sxs-lookup"><span data-stu-id="0baad-196">There is no mention of technical implementation details.</span></span>

<span data-ttu-id="0baad-197">Mientras que en el proceso de creación de la aplicación, el conjunto de historias de usuario puede ser más refinado.</span><span class="sxs-lookup"><span data-stu-id="0baad-197">While in the process of building your application, the set of user stories can become more refined.</span></span> <span data-ttu-id="0baad-198">Puede dividir una historia de usuario en varias historias (requisitos).</span><span class="sxs-lookup"><span data-stu-id="0baad-198">You might break a user story into multiple stories (requirements).</span></span> <span data-ttu-id="0baad-199">Por ejemplo, puede decidir que la creación de un nuevo grupo de contactos debe implicar la validación.</span><span class="sxs-lookup"><span data-stu-id="0baad-199">For example, you might decide that creating a new contact group should involve validation.</span></span> <span data-ttu-id="0baad-200">El envío de un grupo de contactos sin un nombre debe devolver un error de validación.</span><span class="sxs-lookup"><span data-stu-id="0baad-200">Submitting a contact group without a name should return a validation error.</span></span>

<span data-ttu-id="0baad-201">Después de crear una lista de historias de usuario, está listo para escribir la primera prueba unitaria.</span><span class="sxs-lookup"><span data-stu-id="0baad-201">After you create a list of user stories, you are ready to write your first unit test.</span></span> <span data-ttu-id="0baad-202">Comenzaremos creando una prueba unitaria para ver la lista de grupos de contactos.</span><span class="sxs-lookup"><span data-stu-id="0baad-202">We'll start by creating a unit test for viewing the list of contact groups.</span></span>

## <a name="listing-contact-groups"></a><span data-ttu-id="0baad-203">Listado de grupos de contacto</span><span class="sxs-lookup"><span data-stu-id="0baad-203">Listing Contact Groups</span></span>

<span data-ttu-id="0baad-204">Nuestra primera historia de usuario es que un usuario debe ser capaz de ver una lista de grupos de contacto.</span><span class="sxs-lookup"><span data-stu-id="0baad-204">Our first user story is that a user should be able to view a list of contact groups.</span></span> <span data-ttu-id="0baad-205">Necesitamos expresar esta historia con una prueba.</span><span class="sxs-lookup"><span data-stu-id="0baad-205">We need to express this story with a test.</span></span>

<span data-ttu-id="0baad-206">Cree una nueva prueba unitaria haciendo clic con el botón derecho en la carpeta Controladores del proyecto ContactManager.Tests, seleccionando **Agregar, Nueva prueba**y seleccionando la plantilla **Prueba unitaria** (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="0baad-206">Create a new unit test by right-clicking the Controllers folder in the ContactManager.Tests project, selecting **Add, New Test**, and selecting the **Unit Test** template (see Figure 1).</span></span> <span data-ttu-id="0baad-207">Asigne un nombre al nuevo GroupControllerTest.cs de prueba unitaria y haga clic en el botón **Aceptar.**</span><span class="sxs-lookup"><span data-stu-id="0baad-207">Name the new unit test GroupControllerTest.cs and click the **OK** button.</span></span>

<span data-ttu-id="0baad-208">[![Agregar la prueba unitaria GroupControllerTest](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-208">[![Adding the GroupControllerTest unit test](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span></span>

<span data-ttu-id="0baad-209">**Figura 01**: Adición de la prueba unitaria GroupControllerTest([Haga clic para ver la imagen de tamaño completo](iteration-6-use-test-driven-development-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="0baad-209">**Figure 01**: Adding the GroupControllerTest unit test([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image2.png))</span></span>

<span data-ttu-id="0baad-210">Nuestra primera prueba unitaria está contenida en el listado 1.</span><span class="sxs-lookup"><span data-stu-id="0baad-210">Our first unit test is contained in Listing 1.</span></span> <span data-ttu-id="0baad-211">Esta prueba comprueba que el método Index() del controlador Group devuelve un conjunto de groups.</span><span class="sxs-lookup"><span data-stu-id="0baad-211">This test verifies that the Index() method of the Group controller returns a set of Groups.</span></span> <span data-ttu-id="0baad-212">La prueba comprueba que se devuelve una colección de grupos en los datos de vista.</span><span class="sxs-lookup"><span data-stu-id="0baad-212">The test verifies that a collection of Groups is returned in view data.</span></span>

<span data-ttu-id="0baad-213">**Listado 1 - Controllers-GroupControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-213">**Listing 1 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample1.cs)]

<span data-ttu-id="0baad-214">La primera vez que escriba el código en el listado 1 de Visual Studio, obtendrá muchas líneas onduladas rojas.</span><span class="sxs-lookup"><span data-stu-id="0baad-214">When you first type the code in Listing 1 in Visual Studio, you'll get a lot of red squiggly lines.</span></span> <span data-ttu-id="0baad-215">No hemos creado las clases GroupController o Group.</span><span class="sxs-lookup"><span data-stu-id="0baad-215">We have not created the GroupController or Group classes.</span></span>

<span data-ttu-id="0baad-216">En este punto, ni siquiera podemos construir nuestra aplicación por lo que no podemos ejecutar nuestra primera prueba unitaria.</span><span class="sxs-lookup"><span data-stu-id="0baad-216">At this point, we can t even build our application so we can t execute our first unit test.</span></span> <span data-ttu-id="0baad-217">Eso es bueno.</span><span class="sxs-lookup"><span data-stu-id="0baad-217">That s good.</span></span> <span data-ttu-id="0baad-218">Eso cuenta como una prueba fallida.</span><span class="sxs-lookup"><span data-stu-id="0baad-218">That counts as a failing test.</span></span> <span data-ttu-id="0baad-219">Por lo tanto, ahora tenemos permiso para empezar a escribir código de aplicación.</span><span class="sxs-lookup"><span data-stu-id="0baad-219">Therefore, we now have permission to start writing application code.</span></span> <span data-ttu-id="0baad-220">Necesitamos escribir suficiente código para ejecutar nuestra prueba.</span><span class="sxs-lookup"><span data-stu-id="0baad-220">We need to write enough code to execute our test.</span></span>

<span data-ttu-id="0baad-221">La clase de controlador de grupo en el listado 2 contiene el mínimo de código necesario para pasar la prueba unitaria.</span><span class="sxs-lookup"><span data-stu-id="0baad-221">The Group controller class in Listing 2 contains the bare minimum of code required to pass the unit test.</span></span> <span data-ttu-id="0baad-222">La acción Index() devuelve una lista de grupos codificada estáticamente (la clase Group se define en el listado 3).</span><span class="sxs-lookup"><span data-stu-id="0baad-222">The Index() action returns a statically coded list of Groups (the Group class is defined in Listing 3).</span></span>

<span data-ttu-id="0baad-223">**Listado 2 - Controllers-GroupController.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-223">**Listing 2 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample2.cs)]

<span data-ttu-id="0baad-224">**Listado 3 - Modelos-Group.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-224">**Listing 3 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample3.cs)]

<span data-ttu-id="0baad-225">Después de agregar las clases GroupController y Group a nuestro proyecto, nuestra primera prueba unitaria se completa correctamente (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="0baad-225">After we add the GroupController and Group classes to our project, our first unit test completes successfully (see Figure 2).</span></span> <span data-ttu-id="0baad-226">Hemos hecho el trabajo mínimo necesario para pasar la prueba.</span><span class="sxs-lookup"><span data-stu-id="0baad-226">We have done the minimum work required to pass the test.</span></span> <span data-ttu-id="0baad-227">Es hora de celebrar.</span><span class="sxs-lookup"><span data-stu-id="0baad-227">It is time to celebrate.</span></span>

<span data-ttu-id="0baad-228">[![¡Éxito!](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-228">[![Success!](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span></span>

<span data-ttu-id="0baad-229">**Figura 02**: ¡El éxito! ( Haga clic para ver la[imagen de tamaño completo](iteration-6-use-test-driven-development-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="0baad-229">**Figure 02**: Success!([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image4.png))</span></span>

## <a name="creating-contact-groups"></a><span data-ttu-id="0baad-230">Creación de grupos de contacto</span><span class="sxs-lookup"><span data-stu-id="0baad-230">Creating Contact Groups</span></span>

<span data-ttu-id="0baad-231">Ahora podemos pasar a la segunda historia del usuario.</span><span class="sxs-lookup"><span data-stu-id="0baad-231">Now we can move on to the second user story.</span></span> <span data-ttu-id="0baad-232">Necesitamos ser capaces de crear nuevos grupos de contacto.</span><span class="sxs-lookup"><span data-stu-id="0baad-232">We need to be able to create new contact groups.</span></span> <span data-ttu-id="0baad-233">Tenemos que expresar esta intención con una prueba.</span><span class="sxs-lookup"><span data-stu-id="0baad-233">We need to express this intention with a test.</span></span>

<span data-ttu-id="0baad-234">La prueba del listado 4 comprueba que al llamar al método Create() con un nuevo grupo se agrega el grupo a la lista de grupos devueltos por el método Index().</span><span class="sxs-lookup"><span data-stu-id="0baad-234">The test in Listing 4 verifies that calling the Create() method with a new Group adds the Group to the list of Groups returned by the Index() method.</span></span> <span data-ttu-id="0baad-235">En otras palabras, si creo un nuevo grupo, entonces debería ser capaz de recuperar el nuevo grupo de la lista de grupos devueltos por el método Index().</span><span class="sxs-lookup"><span data-stu-id="0baad-235">In other words, if I create a new group then I should be able to get the new Group back from the list of Groups returned by the Index() method.</span></span>

<span data-ttu-id="0baad-236">**Listado 4 - Controllers-GroupControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-236">**Listing 4 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample4.cs)]

<span data-ttu-id="0baad-237">La prueba en el listado 4 llama al método Create() del controlador de grupo con un nuevo grupo de contacto.</span><span class="sxs-lookup"><span data-stu-id="0baad-237">The test in Listing 4 calls the Group controller Create() method with a new contact Group.</span></span> <span data-ttu-id="0baad-238">A continuación, la prueba comprueba que al llamar al método Index() del controlador de grupo se devuelve el nuevo grupo en los datos de vista.</span><span class="sxs-lookup"><span data-stu-id="0baad-238">Next, the test verifies that calling the Group controller Index() method returns the new Group in view data.</span></span>

<span data-ttu-id="0baad-239">El controlador de grupo modificado en el listado 5 contiene el mínimo de cambios necesarios para pasar la nueva prueba.</span><span class="sxs-lookup"><span data-stu-id="0baad-239">The modified Group controller in Listing 5 contains the bare minimum of changes required to pass the new test.</span></span>

<span data-ttu-id="0baad-240">**Listado 5 - Controllers-GroupController.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-240">**Listing 5 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample5.cs)]

## <a name="the-group-controller-in-listing-5-has-a-new-create-action-this-action-adds-a-group-to-a-collection-of-groups-notice-that-the-index-action-has-been-modified-to-return-the-contents-of-the-collection-of-groups"></a><span data-ttu-id="0baad-241">El controlador de grupo en el listado 5 tiene una nueva acción Create().</span><span class="sxs-lookup"><span data-stu-id="0baad-241">The Group controller in Listing 5 has a new Create() action.</span></span> <span data-ttu-id="0baad-242">Esta acción agrega un grupo a una colección de grupos.</span><span class="sxs-lookup"><span data-stu-id="0baad-242">This action adds a Group to a collection of Groups.</span></span> <span data-ttu-id="0baad-243">Observe que la acción Index() se ha modificado para devolver el contenido de la colección de grupos.</span><span class="sxs-lookup"><span data-stu-id="0baad-243">Notice that the Index() action has been modified to return the contents of the collection of Groups.</span></span>

<span data-ttu-id="0baad-244">Una vez más, hemos realizado la cantidad mínima de trabajo necesaria para pasar la prueba unitaria.</span><span class="sxs-lookup"><span data-stu-id="0baad-244">Once again, we have performed the bare minimum amount of work required to pass the unit test.</span></span> <span data-ttu-id="0baad-245">Después de realizar estos cambios en el controlador de grupo, todas nuestras pruebas unitarias pasan.</span><span class="sxs-lookup"><span data-stu-id="0baad-245">After we make these changes to the Group controller, all of our unit tests pass.</span></span>

## <a name="adding-validation"></a><span data-ttu-id="0baad-246">Agregar una validación</span><span class="sxs-lookup"><span data-stu-id="0baad-246">Adding Validation</span></span>

<span data-ttu-id="0baad-247">Este requisito no se indicó explícitamente en la historia del usuario.</span><span class="sxs-lookup"><span data-stu-id="0baad-247">This requirement was not stated explicitly in the user story.</span></span> <span data-ttu-id="0baad-248">Sin embargo, es razonable exigir que un Grupo tenga un nombre.</span><span class="sxs-lookup"><span data-stu-id="0baad-248">However, it is reasonable to require that a Group have a name.</span></span> <span data-ttu-id="0baad-249">De lo contrario, organizar los contactos en Grupos no sería muy útil.</span><span class="sxs-lookup"><span data-stu-id="0baad-249">Otherwise, organizing contacts into Groups would not be very useful.</span></span>

<span data-ttu-id="0baad-250">El listado 6 contiene una nueva prueba que expresa esta intención.</span><span class="sxs-lookup"><span data-stu-id="0baad-250">Listing 6 contains a new test that expresses this intention.</span></span> <span data-ttu-id="0baad-251">Esta prueba comprueba que al intentar crear un grupo sin proporcionar un nombre, se produce un mensaje de error de validación en el estado del modelo.</span><span class="sxs-lookup"><span data-stu-id="0baad-251">This test verifies that attempting to create a Group without supplying a name results in a validation error message in model state.</span></span>

<span data-ttu-id="0baad-252">**Listado 6 - Controllers-GroupControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-252">**Listing 6 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample6.cs)]

<span data-ttu-id="0baad-253">Para satisfacer esta prueba, necesitamos agregar una propiedad Name a nuestra clase Group (consulte el listado 7).</span><span class="sxs-lookup"><span data-stu-id="0baad-253">In order to satisfy this test, we need to add a Name property to our Group class (see Listing 7).</span></span> <span data-ttu-id="0baad-254">Además, necesitamos agregar un poco de lógica de validación a nuestra acción Create() del controlador de grupo (consulte el listado 8).</span><span class="sxs-lookup"><span data-stu-id="0baad-254">Furthermore, we need to add a tiny bit of validation logic to our Group controller s Create() action (see Listing 8).</span></span>

<span data-ttu-id="0baad-255">**Listado 7 - Modelos-Group.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-255">**Listing 7 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample7.cs)]

<span data-ttu-id="0baad-256">**Listado 8 - Controllers-GroupController.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-256">**Listing 8 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample8.cs)]

<span data-ttu-id="0baad-257">Observe que la acción Create() del controlador de grupo ahora contiene lógica de validación y de base de datos.</span><span class="sxs-lookup"><span data-stu-id="0baad-257">Notice that the Group controller Create() action now contains both validation and database logic.</span></span> <span data-ttu-id="0baad-258">Actualmente, la base de datos utilizada por el controlador de grupo consta de nada más que una colección en memoria.</span><span class="sxs-lookup"><span data-stu-id="0baad-258">Currently, the database used by the Group controller consists of nothing more than an in-memory collection.</span></span>

## <a name="time-to-refactor"></a><span data-ttu-id="0baad-259">Tiempo para refactorizar</span><span class="sxs-lookup"><span data-stu-id="0baad-259">Time to Refactor</span></span>

<span data-ttu-id="0baad-260">El tercer paso en Rojo/Verde/Refactores es la parte Refactorizar.</span><span class="sxs-lookup"><span data-stu-id="0baad-260">The third step in Red/Green/Refactor is the Refactor part.</span></span> <span data-ttu-id="0baad-261">En este punto, tenemos que retroceder de nuestro código y considerar cómo podemos refactorizar nuestra aplicación para mejorar su diseño.</span><span class="sxs-lookup"><span data-stu-id="0baad-261">At this point, we need to step back from our code and consider how we can refactor our application to improve its design.</span></span> <span data-ttu-id="0baad-262">La etapa Refactores es la etapa en la que pensamos mucho en la mejor manera de implementar los principios y patrones de diseño de software.</span><span class="sxs-lookup"><span data-stu-id="0baad-262">The Refactor stage is the stage at which we think hard about the best way of implementing software design principles and patterns.</span></span>

<span data-ttu-id="0baad-263">Somos libres de modificar nuestro código de cualquier manera que elijamos para mejorar el diseño del código.</span><span class="sxs-lookup"><span data-stu-id="0baad-263">We are free to modify our code in any way that we choose to improve the design of the code.</span></span> <span data-ttu-id="0baad-264">Tenemos una red de seguridad de pruebas unitarias que nos impiden romper la funcionalidad existente.</span><span class="sxs-lookup"><span data-stu-id="0baad-264">We have a safety net of unit tests that prevent us from breaking existing functionality.</span></span>

<span data-ttu-id="0baad-265">En este momento, nuestro controlador de grupo es un desastre desde la perspectiva de un buen diseño de software.</span><span class="sxs-lookup"><span data-stu-id="0baad-265">Right now, our Group controller is a mess from the perspective of good software design.</span></span> <span data-ttu-id="0baad-266">El controlador de grupo contiene un lío enredado de validación y código de acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="0baad-266">The Group controller contains a tangled mess of validation and data access code.</span></span> <span data-ttu-id="0baad-267">Para evitar violar el Principio de Responsabilidad Única, necesitamos separar estas preocupaciones en diferentes clases.</span><span class="sxs-lookup"><span data-stu-id="0baad-267">To avoid violating the Single Responsibility Principle, we need to separate these concerns into different classes.</span></span>

<span data-ttu-id="0baad-268">Nuestra clase de controlador de grupo refactorizado se encuentra en el listado 9.</span><span class="sxs-lookup"><span data-stu-id="0baad-268">Our refactored Group controller class is contained in Listing 9.</span></span> <span data-ttu-id="0baad-269">El controlador se ha modificado para utilizar la capa de servicio ContactManager.</span><span class="sxs-lookup"><span data-stu-id="0baad-269">The controller has been modified to use the ContactManager service layer.</span></span> <span data-ttu-id="0baad-270">Esta es la misma capa de servicio que usamos con el controlador de contacto.</span><span class="sxs-lookup"><span data-stu-id="0baad-270">This is the same service layer that we use with the Contact controller.</span></span>

<span data-ttu-id="0baad-271">El listado 10 contiene los nuevos métodos agregados a la capa de servicio ContactManager para admitir la validación, la lista y la creación de grupos.</span><span class="sxs-lookup"><span data-stu-id="0baad-271">Listing 10 contains the new methods added to the ContactManager service layer to support validating, listing, and creating groups.</span></span> <span data-ttu-id="0baad-272">La interfaz IContactManagerService se actualizó para incluir los nuevos métodos.</span><span class="sxs-lookup"><span data-stu-id="0baad-272">The IContactManagerService interface was updated to include the new methods.</span></span>

<span data-ttu-id="0baad-273">El listado 11 contiene una nueva clase FakeContactManagerRepository que implementa la interfaz IContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="0baad-273">Listing 11 contains a new FakeContactManagerRepository class that implements the IContactManagerRepository interface.</span></span> <span data-ttu-id="0baad-274">A diferencia de la EntityContactManagerRepository clase que también implementa el IContactManagerRepository interfaz, nuestra nueva Clase FakeContactManagerRepository no se comunica con la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0baad-274">Unlike the EntityContactManagerRepository class that also implements the IContactManagerRepository interface, our new FakeContactManagerRepository class does not communicate with the database.</span></span> <span data-ttu-id="0baad-275">La clase FakeContactManagerRepository utiliza una colección en memoria como proxy para la base de datos.</span><span class="sxs-lookup"><span data-stu-id="0baad-275">The FakeContactManagerRepository class uses an in-memory collection as a proxy for the database.</span></span> <span data-ttu-id="0baad-276">Usaremos esta clase en nuestras pruebas unitarias como una capa de repositorio falsa.</span><span class="sxs-lookup"><span data-stu-id="0baad-276">We'll use this class in our unit tests as a fake repository layer.</span></span>

<span data-ttu-id="0baad-277">**Listado 9 - Controllers-GroupController.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-277">**Listing 9 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample9.cs)]

<span data-ttu-id="0baad-278">**Listado 10 - Controllers-ContactManagerService.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-278">**Listing 10 - Controllers\ContactManagerService.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample10.cs)]

<span data-ttu-id="0baad-279">**Listado 11 - Controllers-FakeContactManagerRepository.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-279">**Listing 11 - Controllers\FakeContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample11.cs)]

<span data-ttu-id="0baad-280">Modificar la interfaz IContactManagerRepository requiere el uso para implementar los métodos CreateGroup() y ListGroups() en la clase EntityContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="0baad-280">Modifying the IContactManagerRepository interface requires use to implement the CreateGroup() and ListGroups() methods in the EntityContactManagerRepository class.</span></span> <span data-ttu-id="0baad-281">La forma más laz y más rápida de hacer esto es agregar métodos de código auxiliar que se ven así:</span><span class="sxs-lookup"><span data-stu-id="0baad-281">The laziest and fastest way to do this is to add stub methods that look like this:</span></span>   

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample12.cs)]

<span data-ttu-id="0baad-282">Por último, estos cambios en el diseño de nuestra aplicación requieren que hagamos algunas modificaciones a nuestras pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-282">Finally, these changes to the design of our application require us to make some modifications to our unit tests.</span></span> <span data-ttu-id="0baad-283">Ahora necesitamos usar FakeContactManagerRepository al realizar las pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-283">We now need to use the FakeContactManagerRepository when performing the unit tests.</span></span> <span data-ttu-id="0baad-284">La clase GroupControllerTest actualizada se encuentra en el listado 12.</span><span class="sxs-lookup"><span data-stu-id="0baad-284">The updated GroupControllerTest class is contained in Listing 12.</span></span>

<span data-ttu-id="0baad-285">**Listado 12 - Controllers-GroupControllerTest.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-285">**Listing 12 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample13.cs)]

<span data-ttu-id="0baad-286">Después de que hagamos todos estos cambios, una vez más, todas nuestras pruebas unitarias pasan.</span><span class="sxs-lookup"><span data-stu-id="0baad-286">After we make all of these changes, once again, all of our unit tests pass.</span></span> <span data-ttu-id="0baad-287">Hemos completado todo el ciclo de Rojo/Verde/Refactor.</span><span class="sxs-lookup"><span data-stu-id="0baad-287">We have completed the entire cycle of Red/Green/Refactor.</span></span> <span data-ttu-id="0baad-288">Hemos implementado las dos primeras historias de usuario.</span><span class="sxs-lookup"><span data-stu-id="0baad-288">We have implemented the first two user stories.</span></span> <span data-ttu-id="0baad-289">Ahora tenemos pruebas unitarias de apoyo para los requisitos expresados en las historias de usuario.</span><span class="sxs-lookup"><span data-stu-id="0baad-289">We now have supporting unit tests for the requirements expressed in the user stories.</span></span> <span data-ttu-id="0baad-290">La implementación del resto de las historias de usuario implica repetir el mismo ciclo de Rojo/Verde/Refactor.</span><span class="sxs-lookup"><span data-stu-id="0baad-290">Implementing the remainder of the user stories involves repeating the same cycle of Red/Green/Refactor.</span></span>

## <a name="modifying-our-database"></a><span data-ttu-id="0baad-291">Modificación de nuestra base de datos</span><span class="sxs-lookup"><span data-stu-id="0baad-291">Modifying our Database</span></span>

<span data-ttu-id="0baad-292">Desafortunadamente, a pesar de que hemos satisfecho todos los requisitos expresados por nuestras pruebas unitarias, nuestro trabajo no está hecho.</span><span class="sxs-lookup"><span data-stu-id="0baad-292">Unfortunately, even though we have satisfied all of the requirements expressed by our unit tests, our work is not done.</span></span> <span data-ttu-id="0baad-293">Todavía tenemos que modificar nuestra base de datos.</span><span class="sxs-lookup"><span data-stu-id="0baad-293">We still need to modify our database.</span></span>

<span data-ttu-id="0baad-294">Necesitamos crear una nueva tabla de base de datos de grupo.</span><span class="sxs-lookup"><span data-stu-id="0baad-294">We need to create a new Group database table.</span></span> <span data-ttu-id="0baad-295">Siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="0baad-295">Follow these steps:</span></span>

1. <span data-ttu-id="0baad-296">En la ventana Explorador de servidores, haga clic con el botón derecho en la carpeta Tablas y seleccione la opción de menú **Agregar nueva tabla**.</span><span class="sxs-lookup"><span data-stu-id="0baad-296">In the Server Explorer window, right-click the Tables folder and select the menu option **Add New Table**.</span></span>
2. <span data-ttu-id="0baad-297">Escriba las dos columnas que se describen a continuación en el Diseñador de tablas.</span><span class="sxs-lookup"><span data-stu-id="0baad-297">Enter the two columns described below in the Table Designer.</span></span>
3. <span data-ttu-id="0baad-298">Marque la columna Id como clave principal y la columna Identity.</span><span class="sxs-lookup"><span data-stu-id="0baad-298">Mark the Id column as a primary key and Identity column.</span></span>
4. <span data-ttu-id="0baad-299">Guarde la nueva tabla con el nombre Grupos haciendo clic en el icono del disquete.</span><span class="sxs-lookup"><span data-stu-id="0baad-299">Save the new table with the name Groups by clicking the icon of the floppy.</span></span>

<a id="0.11_table01"></a>

| <span data-ttu-id="0baad-300">**Nombre de columna**</span><span class="sxs-lookup"><span data-stu-id="0baad-300">**Column Name**</span></span> | <span data-ttu-id="0baad-301">**Tipo de datos**</span><span class="sxs-lookup"><span data-stu-id="0baad-301">**Data Type**</span></span> | <span data-ttu-id="0baad-302">**Permitir valores NULL**</span><span class="sxs-lookup"><span data-stu-id="0baad-302">**Allow Nulls**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="0baad-303">Identificador</span><span class="sxs-lookup"><span data-stu-id="0baad-303">Id</span></span> | <span data-ttu-id="0baad-304">int</span><span class="sxs-lookup"><span data-stu-id="0baad-304">int</span></span> | <span data-ttu-id="0baad-305">False</span><span class="sxs-lookup"><span data-stu-id="0baad-305">False</span></span> |
| <span data-ttu-id="0baad-306">NOMBRE</span><span class="sxs-lookup"><span data-stu-id="0baad-306">Name</span></span> | <span data-ttu-id="0baad-307">nvarchar(50)</span><span class="sxs-lookup"><span data-stu-id="0baad-307">nvarchar(50)</span></span> | <span data-ttu-id="0baad-308">False</span><span class="sxs-lookup"><span data-stu-id="0baad-308">False</span></span> |

<span data-ttu-id="0baad-309">A continuación, necesitamos eliminar todos los datos de la tabla Contactos (de lo contrario, no podremos crear una relación entre las tablas Contactos y Grupos).</span><span class="sxs-lookup"><span data-stu-id="0baad-309">Next, we need to delete all of the data from the Contacts table (otherwise, we won't be able to create a relationship between the Contacts and Groups tables).</span></span> <span data-ttu-id="0baad-310">Siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="0baad-310">Follow these steps:</span></span>

1. <span data-ttu-id="0baad-311">Haga clic con el botón derecho en la tabla Contactos y seleccione la opción de menú **Mostrar datos**de tabla .</span><span class="sxs-lookup"><span data-stu-id="0baad-311">Right-click the Contacts table and select the menu option **Show Table Data**.</span></span>
2. <span data-ttu-id="0baad-312">Elimine todas las filas.</span><span class="sxs-lookup"><span data-stu-id="0baad-312">Delete all of the rows.</span></span>

<span data-ttu-id="0baad-313">A continuación, necesitamos definir una relación entre la tabla de base de datos Grupos y la tabla de base de datos Contactos existente.</span><span class="sxs-lookup"><span data-stu-id="0baad-313">Next, we need to define a relationship between the Groups database table and the existing Contacts database table.</span></span> <span data-ttu-id="0baad-314">Siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="0baad-314">Follow these steps:</span></span>

1. <span data-ttu-id="0baad-315">Haga doble clic en la tabla Contactos en la ventana Explorador de servidores para abrir el Diseñador de tablas.</span><span class="sxs-lookup"><span data-stu-id="0baad-315">Double-click the Contacts table in the Server Explorer window to open the Table Designer.</span></span>
2. <span data-ttu-id="0baad-316">Agregue una nueva columna de enteros a la tabla Contactos denominada GroupId.</span><span class="sxs-lookup"><span data-stu-id="0baad-316">Add a new integer column to the Contacts table named GroupId.</span></span>
3. <span data-ttu-id="0baad-317">Haga clic en el botón Relación para abrir el cuadro de diálogo Relaciones de clave externa (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="0baad-317">Click the Relationship button to open the Foreign Key Relationships dialog (see Figure 3).</span></span>
4. <span data-ttu-id="0baad-318">Haga clic en el botón Agregar.</span><span class="sxs-lookup"><span data-stu-id="0baad-318">Click the Add button.</span></span>
5. <span data-ttu-id="0baad-319">Haga clic en el botón de puntos suspensivos que aparece junto al botón Especificación de tablas y columnas.</span><span class="sxs-lookup"><span data-stu-id="0baad-319">Click the ellipsis button that appears next to the Table and Columns Specification button.</span></span>
6. <span data-ttu-id="0baad-320">En el cuadro de diálogo Tablas y columnas, seleccione Grupos como tabla de claves principal e Id como columna de clave principal.</span><span class="sxs-lookup"><span data-stu-id="0baad-320">In the Tables and Columns dialog, select Groups as the primary key table and Id as the primary key column.</span></span> <span data-ttu-id="0baad-321">Seleccione Contactos como tabla de clave externa y GroupId como columna de clave externa (consulte la figura 4).</span><span class="sxs-lookup"><span data-stu-id="0baad-321">Select Contacts as the foreign key table and GroupId as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="0baad-322">Haga clic en el botón Aceptar.</span><span class="sxs-lookup"><span data-stu-id="0baad-322">Click the OK button.</span></span>
7. <span data-ttu-id="0baad-323">En **INSERT y UPDATE Specification**, seleccione el valor **Cascade** para Delete **Rule**.</span><span class="sxs-lookup"><span data-stu-id="0baad-323">Under **INSERT and UPDATE Specification**, select the value **Cascade** for **Delete Rule**.</span></span>
8. <span data-ttu-id="0baad-324">Haga clic en el botón Cerrar para cerrar el cuadro de diálogo Relaciones de clave externa.</span><span class="sxs-lookup"><span data-stu-id="0baad-324">Click the Close button to close the Foreign Key Relationships dialog.</span></span>
9. <span data-ttu-id="0baad-325">Haga clic en el botón Guardar para guardar los cambios en la tabla Contactos.</span><span class="sxs-lookup"><span data-stu-id="0baad-325">Click the Save button to save the changes to the Contacts table.</span></span>

<span data-ttu-id="0baad-326">[![Creación de una relación de tabla de base de datos](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-326">[![Creating a database table relationship](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span></span>

<span data-ttu-id="0baad-327">**Figura 03**: Creación de una relación de tabla de base de datos[(Haga clic para ver la imagen de tamaño completo)](iteration-6-use-test-driven-development-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-327">**Figure 03**: Creating a database table relationship ([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image6.png))</span></span>

<span data-ttu-id="0baad-328">[![Especificación de relaciones de tabla](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-328">[![Specifying table relationships](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span></span>

<span data-ttu-id="0baad-329">**Figura 04**: Especificación de relaciones de tabla[(Haga clic para ver la imagen de tamaño completo)](iteration-6-use-test-driven-development-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-329">**Figure 04**: Specifying table relationships([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image8.png))</span></span>

### <a name="updating-our-data-model"></a><span data-ttu-id="0baad-330">Actualización de nuestro modelo de datos</span><span class="sxs-lookup"><span data-stu-id="0baad-330">Updating our Data Model</span></span>

<span data-ttu-id="0baad-331">A continuación, necesitamos actualizar nuestro modelo de datos para representar la nueva tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="0baad-331">Next, we need to update our data model to represent the new database table.</span></span> <span data-ttu-id="0baad-332">Siga estos pasos:</span><span class="sxs-lookup"><span data-stu-id="0baad-332">Follow these steps:</span></span>

1. <span data-ttu-id="0baad-333">Haga doble clic en el archivo ContactManagerModel.edmx de la carpeta Modelos para abrir Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="0baad-333">Double-click the ContactManagerModel.edmx file in the Models folder to open the Entity Designer.</span></span>
2. <span data-ttu-id="0baad-334">Haga clic con el botón derecho en la superficie Diseñador y seleccione la opción de menú **Actualizar modelo desde base de datos**.</span><span class="sxs-lookup"><span data-stu-id="0baad-334">Right-click the Designer surface and select the menu option **Update Model from Database**.</span></span>
3. <span data-ttu-id="0baad-335">En el Asistente para actualización, seleccione la tabla Grupos y haga clic en el botón Finalizar (consulte la figura 5).</span><span class="sxs-lookup"><span data-stu-id="0baad-335">In the Update Wizard, select the Groups table and click the Finish button (see Figure 5).</span></span>
4. <span data-ttu-id="0baad-336">Haga clic con el botón derecho en la entidad Grupos y seleccione la opción de menú **Cambiar nombre**.</span><span class="sxs-lookup"><span data-stu-id="0baad-336">Right-click the Groups entity and select the menu option **Rename**.</span></span> <span data-ttu-id="0baad-337">Cambie el nombre de la entidad *Grupos* a *Grupo* (singular).</span><span class="sxs-lookup"><span data-stu-id="0baad-337">Change the name of the *Groups* entity to *Group* (singular).</span></span>
5. <span data-ttu-id="0baad-338">Haga clic con el botón derecho en la propiedad de navegación Grupos que aparece en la parte inferior de la entidad Contacto.</span><span class="sxs-lookup"><span data-stu-id="0baad-338">Right-click the Groups navigation property that appears at the bottom of the Contact entity.</span></span> <span data-ttu-id="0baad-339">Cambie el nombre de la propiedad de navegación *Grupos* a *Grupo* (singular).</span><span class="sxs-lookup"><span data-stu-id="0baad-339">Change the name of the *Groups* navigation property to *Group* (singular).</span></span>

<span data-ttu-id="0baad-340">[![Actualización de un modelo de Entity Framework desde la base de datos](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-340">[![Updating an Entity Framework model from the database](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span></span>

<span data-ttu-id="0baad-341">**Figura 05**: Actualización de un modelo de Entity Framework desde la base de datos[(Haga clic para ver la imagen de tamaño completo)](iteration-6-use-test-driven-development-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-341">**Figure 05**: Updating an Entity Framework model from the database([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image10.png))</span></span>

<span data-ttu-id="0baad-342">Después de completar estos pasos, el modelo de datos representará las tablas Contactos y Grupos.</span><span class="sxs-lookup"><span data-stu-id="0baad-342">After you complete these steps, your data model will represent both the Contacts and Groups tables.</span></span> <span data-ttu-id="0baad-343">Entity Designer debe mostrar ambas entidades (consulte la figura 6).</span><span class="sxs-lookup"><span data-stu-id="0baad-343">The Entity Designer should show both entities (see Figure 6).</span></span>

<span data-ttu-id="0baad-344">[![Entity Designer que muestra Grupo y Contacto](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-344">[![Entity Designer displaying Group and Contact](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span></span>

<span data-ttu-id="0baad-345">**Figura 06**: Entity Designer que muestra Group y Contact(Click para ver la[imagen de tamaño completo)](iteration-6-use-test-driven-development-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-345">**Figure 06**: Entity Designer displaying Group and Contact([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image12.png))</span></span>

### <a name="creating-our-repository-classes"></a><span data-ttu-id="0baad-346">Creación de nuestras clases de repositorio</span><span class="sxs-lookup"><span data-stu-id="0baad-346">Creating our Repository Classes</span></span>

<span data-ttu-id="0baad-347">A continuación, necesitamos implementar nuestra clase de repositorio.</span><span class="sxs-lookup"><span data-stu-id="0baad-347">Next, we need to implement our repository class.</span></span> <span data-ttu-id="0baad-348">En el transcurso de esta iteración, agregamos varios métodos nuevos a la interfaz IContactManagerRepository mientras se escribía código para satisfacer nuestras pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-348">Over the course of this iteration, we added several new methods to the IContactManagerRepository interface while writing code to satisfy our unit tests.</span></span> <span data-ttu-id="0baad-349">La versión final de la interfaz IContactManagerRepository se encuentra en el listado 14.</span><span class="sxs-lookup"><span data-stu-id="0baad-349">The final version of the IContactManagerRepository interface is contained in Listing 14.</span></span>

<span data-ttu-id="0baad-350">**Listado 14 - Modelos-IContactManagerRepository.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-350">**Listing 14 - Models\IContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample14.cs)]

<span data-ttu-id="0baad-351">En realidad, no hemos implementado ninguno de los métodos relacionados con el trabajo con grupos de contacto.</span><span class="sxs-lookup"><span data-stu-id="0baad-351">We haven't actually implemented any of the methods related to working with contact groups.</span></span> <span data-ttu-id="0baad-352">Actualmente, la clase EntityContactManagerRepository tiene métodos de código auxiliar para cada uno de los métodos de grupo de contactos enumerados en la interfaz IContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="0baad-352">Currently, the EntityContactManagerRepository class has stub methods for each of the contact group methods listed in the IContactManagerRepository interface.</span></span> <span data-ttu-id="0baad-353">Por ejemplo, el método ListGroups() tiene este aspecto actualmente:</span><span class="sxs-lookup"><span data-stu-id="0baad-353">For example, the ListGroups() method currently looks like this:</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample15.cs)]

<span data-ttu-id="0baad-354">Los métodos de código auxiliar nos permitieron compilar nuestra aplicación y pasar las pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-354">The stub methods enabled us to compile our application and pass the unit tests.</span></span> <span data-ttu-id="0baad-355">Sin embargo, ahora es el momento de implementar realmente estos métodos.</span><span class="sxs-lookup"><span data-stu-id="0baad-355">However, now it is time to actually implement these methods.</span></span> <span data-ttu-id="0baad-356">La versión final de la Clase EntityContactManagerRepository se encuentra en el listado 13.</span><span class="sxs-lookup"><span data-stu-id="0baad-356">The final version of the EntityContactManagerRepository class is contained in Listing 13.</span></span>

<span data-ttu-id="0baad-357">**Listado 13 - Modelos-EntityContactManagerRepository.cs**</span><span class="sxs-lookup"><span data-stu-id="0baad-357">**Listing 13 - Models\EntityContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample16.cs)]

### <a name="creating-the-views"></a><span data-ttu-id="0baad-358">Creación de las vistas</span><span class="sxs-lookup"><span data-stu-id="0baad-358">Creating the Views</span></span>

<span data-ttu-id="0baad-359">ASP.NET aplicación MVC cuando se usa el motor de vista de ASP.NET predeterminado.</span><span class="sxs-lookup"><span data-stu-id="0baad-359">ASP.NET MVC application when you use the default ASP.NET view engine.</span></span> <span data-ttu-id="0baad-360">Por lo tanto, no se crean vistas en respuesta a una prueba unitaria determinada.</span><span class="sxs-lookup"><span data-stu-id="0baad-360">So, you don t create views in response to a particular unit test.</span></span> <span data-ttu-id="0baad-361">Sin embargo, dado que una aplicación sería inútil sin vistas, no podemos completar esta iteración sin crear y modificar las vistas contenidas en la aplicación Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="0baad-361">However, because an application would be useless without views, we can t complete this iteration without creating and modifying the views contained in the Contact Manager application.</span></span>

<span data-ttu-id="0baad-362">Necesitamos crear las siguientes nuevas vistas para administrar grupos de contactos (consulte la figura 7):</span><span class="sxs-lookup"><span data-stu-id="0baad-362">We need to create the following new views for managing contact groups (see Figure 7):</span></span>

- <span data-ttu-id="0baad-363">Views-Group-Index.aspx: muestra la lista de grupos de contactos</span><span class="sxs-lookup"><span data-stu-id="0baad-363">Views\Group\Index.aspx - Displays list of contact groups</span></span>
- <span data-ttu-id="0baad-364">Views-Group-Delete.aspx: muestra el formulario de confirmación para eliminar un grupo de contactos</span><span class="sxs-lookup"><span data-stu-id="0baad-364">Views\Group\Delete.aspx - Displays confirmation form for deleting a contact group</span></span>

<span data-ttu-id="0baad-365">[![La vista de índice de grupo](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-365">[![The Group Index view](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span></span>

<span data-ttu-id="0baad-366">**Figura 07**: La vista de índice de grupo[(Haga clic para ver la imagen de tamaño completo)](iteration-6-use-test-driven-development-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-366">**Figure 07**: The Group Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image14.png))</span></span>

<span data-ttu-id="0baad-367">Necesitamos modificar las siguientes vistas existentes para que incluyan grupos de contactos:</span><span class="sxs-lookup"><span data-stu-id="0baad-367">We need to modify the following existing views so that they include contact groups:</span></span>

- <span data-ttu-id="0baad-368">Views-Home-Create.aspx</span><span class="sxs-lookup"><span data-stu-id="0baad-368">Views\Home\Create.aspx</span></span>
- <span data-ttu-id="0baad-369">Views-Home-Edit.aspx</span><span class="sxs-lookup"><span data-stu-id="0baad-369">Views\Home\Edit.aspx</span></span>
- <span data-ttu-id="0baad-370">Vistas-Home-Index.aspx</span><span class="sxs-lookup"><span data-stu-id="0baad-370">Views\Home\Index.aspx</span></span>

<span data-ttu-id="0baad-371">Puede ver las vistas modificadas examinando la aplicación de Visual Studio que acompaña a este tutorial.</span><span class="sxs-lookup"><span data-stu-id="0baad-371">You can see the modified views by looking at the Visual Studio application that accompanies this tutorial.</span></span> <span data-ttu-id="0baad-372">Por ejemplo, la Figura 8 ilustra la vista de índice de contacto.</span><span class="sxs-lookup"><span data-stu-id="0baad-372">For example, Figure 8 illustrates the Contact Index view.</span></span>

<span data-ttu-id="0baad-373">[![La vista de índice de contacto](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-373">[![The Contact Index view](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span></span>

<span data-ttu-id="0baad-374">**Figura 08**: La vista de índice de contacto[(Haga clic para ver la imagen de tamaño completo)](iteration-6-use-test-driven-development-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="0baad-374">**Figure 08**: The Contact Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image16.png))</span></span>

## <a name="summary"></a><span data-ttu-id="0baad-375">Resumen</span><span class="sxs-lookup"><span data-stu-id="0baad-375">Summary</span></span>

<span data-ttu-id="0baad-376">En esta iteración, agregamos nueva funcionalidad a nuestra aplicación Contact Manager siguiendo una metodología de diseño de aplicaciones de desarrollo controlada por pruebas.</span><span class="sxs-lookup"><span data-stu-id="0baad-376">In this iteration, we added new functionality to our Contact Manager application by following a test-driven development application design methodology.</span></span> <span data-ttu-id="0baad-377">Comenzamos creando un conjunto de historias de usuario.</span><span class="sxs-lookup"><span data-stu-id="0baad-377">We started by creating a set of user stories.</span></span> <span data-ttu-id="0baad-378">Hemos creado un conjunto de pruebas unitarias que se corresponde con los requisitos expresados por las historias de usuario.</span><span class="sxs-lookup"><span data-stu-id="0baad-378">We created a set of unit tests that corresponds to the requirements expressed by the user stories.</span></span> <span data-ttu-id="0baad-379">Por último, escribimos el código suficiente para satisfacer los requisitos expresados por las pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="0baad-379">Finally, we wrote just enough code to satisfy the requirements expressed by the unit tests.</span></span>

<span data-ttu-id="0baad-380">Después de que terminamos de escribir suficiente código para satisfacer los requisitos expresados por las pruebas unitarias, actualizamos nuestra base de datos y vistas.</span><span class="sxs-lookup"><span data-stu-id="0baad-380">After we finished writing enough code to satisfy the requirements expressed by the unit tests, we updated our database and views.</span></span> <span data-ttu-id="0baad-381">Agregamos una nueva tabla Groups a nuestra base de datos y actualizamos nuestro Entity Framework Data Model.</span><span class="sxs-lookup"><span data-stu-id="0baad-381">We added a new Groups table to our database and updated our Entity Framework Data Model.</span></span> <span data-ttu-id="0baad-382">También creamos y modificamos un conjunto de vistas.</span><span class="sxs-lookup"><span data-stu-id="0baad-382">We also created and modified a set of views.</span></span>

<span data-ttu-id="0baad-383">En la siguiente iteración, la iteración final, reescribimos nuestra aplicación para aprovechar Ajax.</span><span class="sxs-lookup"><span data-stu-id="0baad-383">In the next iteration -- the final iteration -- we rewrite our application to take advantage of Ajax.</span></span> <span data-ttu-id="0baad-384">Aprovechando Ajax, mejoraremos la capacidad de respuesta y el rendimiento de la aplicación Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="0baad-384">By taking advantage of Ajax, we'll improve the responsiveness and performance of the Contact Manager application.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0baad-385">[Anterior](iteration-5-create-unit-tests-cs.md)
> [Siguiente](iteration-7-add-ajax-functionality-cs.md)</span><span class="sxs-lookup"><span data-stu-id="0baad-385">[Previous](iteration-5-create-unit-tests-cs.md)
[Next](iteration-7-add-ajax-functionality-cs.md)</span></span>

---
uid: mvc/overview/getting-started/introduction/adding-validation
title: Agregar validación | Microsoft Docs
author: Rick-Anderson
description: ''
ms.author: riande
ms.date: 01/06/2019
ms.assetid: 9f35ca15-e216-4db6-9ebf-24380b0f31b4
msc.legacyurl: /mvc/overview/getting-started/introduction/adding-validation
msc.type: authoredcontent
ms.openlocfilehash: 6894d01af7cd142a5579f73ae5209ca13756ca52
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2019
ms.locfileid: "65120749"
---
# <a name="adding-validation"></a><span data-ttu-id="e3240-102">Agregar una validación</span><span class="sxs-lookup"><span data-stu-id="e3240-102">Adding Validation</span></span>

<span data-ttu-id="e3240-103">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span><span class="sxs-lookup"><span data-stu-id="e3240-103">by [Rick Anderson]((https://twitter.com/RickAndMSFT))</span></span>

[!INCLUDE [Tutorial Note](sample/code-location.md)]

<span data-ttu-id="e3240-104">En esta sección agregará lógica de validación para el `Movie` modelo y se asegurará de que las reglas de validación se aplican cada vez que un usuario intenta crear o editar una película con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e3240-104">In this section you'll add validation logic to the `Movie` model, and you'll ensure that the validation rules are enforced any time a user attempts to create or edit a movie using the application.</span></span>

## <a name="keeping-things-dry"></a><span data-ttu-id="e3240-105">Mantener las cosas seco</span><span class="sxs-lookup"><span data-stu-id="e3240-105">Keeping Things DRY</span></span>

<span data-ttu-id="e3240-106">Uno de los principios de diseño principales de ASP.NET MVC es [seco](http://en.wikipedia.org/wiki/Don't_repeat_yourself) (&quot;no&quot;).</span><span class="sxs-lookup"><span data-stu-id="e3240-106">One of the core design tenets of ASP.NET MVC is [DRY](http://en.wikipedia.org/wiki/Don't_repeat_yourself) (&quot;Don't Repeat Yourself&quot;).</span></span> <span data-ttu-id="e3240-107">ASP.NET MVC le anima a especificar funcionalidad o comportamiento de una sola vez y, a continuación, hacer que se reflejen en todas partes en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="e3240-107">ASP.NET MVC encourages you to specify functionality or behavior only once, and then have it be reflected everywhere in an application.</span></span> <span data-ttu-id="e3240-108">Esto reduce la cantidad de código que necesita para escribir y hace que el código que escribe menos error propenso a errores y más fácil de mantener.</span><span class="sxs-lookup"><span data-stu-id="e3240-108">This reduces the amount of code you need to write and makes the code you do write less error prone and easier to maintain.</span></span>

<span data-ttu-id="e3240-109">La compatibilidad de validación proporcionada por ASP.NET MVC y Entity Framework Code First es un buen ejemplo del principio DRY en acción.</span><span class="sxs-lookup"><span data-stu-id="e3240-109">The validation support provided by ASP.NET MVC and Entity Framework Code First is a great example of the DRY principle in action.</span></span> <span data-ttu-id="e3240-110">Puede especificar mediante declaración las reglas de validación en un solo lugar (en la clase del modelo) y las reglas se aplican en todas partes en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e3240-110">You can declaratively specify validation rules in one place (in the model class) and the rules are enforced everywhere in the application.</span></span>

<span data-ttu-id="e3240-111">Echemos un vistazo a cómo puede aprovechar las ventajas de esta compatibilidad de validación de la aplicación de película.</span><span class="sxs-lookup"><span data-stu-id="e3240-111">Let's look at how you can take advantage of this validation support in the movie application.</span></span>

## <a name="adding-validation-rules-to-the-movie-model"></a><span data-ttu-id="e3240-112">Agregar reglas de validación al modelo de película</span><span class="sxs-lookup"><span data-stu-id="e3240-112">Adding Validation Rules to the Movie Model</span></span>

<span data-ttu-id="e3240-113">Para comenzar, agregar alguna lógica de validación para el `Movie` clase.</span><span class="sxs-lookup"><span data-stu-id="e3240-113">You'll begin by adding some validation logic to the `Movie` class.</span></span>

<span data-ttu-id="e3240-114">Abra el archivo *Movie.cs*.</span><span class="sxs-lookup"><span data-stu-id="e3240-114">Open the *Movie.cs* file.</span></span> <span data-ttu-id="e3240-115">Tenga en cuenta la [ `System.ComponentModel.DataAnnotations` ](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.aspx) no contiene el espacio de nombres `System.Web`.</span><span class="sxs-lookup"><span data-stu-id="e3240-115">Notice the [`System.ComponentModel.DataAnnotations`](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.aspx) namespace does not contain `System.Web`.</span></span> <span data-ttu-id="e3240-116">DataAnnotations proporciona un conjunto integrado de atributos de validación que se pueden aplicar mediante declaración a cualquier clase o propiedad.</span><span class="sxs-lookup"><span data-stu-id="e3240-116">DataAnnotations provides a built-in set of validation attributes that you can apply declaratively to any class or property.</span></span> <span data-ttu-id="e3240-117">(También contiene atributos de formato como [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) que ayudan a aplicar formato y no proporcionan ninguna validación.)</span><span class="sxs-lookup"><span data-stu-id="e3240-117">(It also contains formatting attributes like [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) that help with formatting and don't provide any validation.)</span></span>

<span data-ttu-id="e3240-118">Ahora, actualice el `Movie` clase para aprovechar las ventajas de los integrados [ `Required` ](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.requiredattribute.aspx), [ `StringLength` ](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.stringlengthattribute.aspx), [RegularExpression](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.regularexpressionattribute.aspx), y [ `Range` ](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) atributos de validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-118">Now update the `Movie` class to take advantage of the built-in [`Required`](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.requiredattribute.aspx), [`StringLength`](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.stringlengthattribute.aspx), [RegularExpression](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.regularexpressionattribute.aspx), and [`Range`](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) validation attributes.</span></span> <span data-ttu-id="e3240-119">Reemplace el `Movie` clase con lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="e3240-119">Replace the `Movie` class with the following:</span></span>

[!code-csharp[Main](adding-validation/samples/sample1.cs?highlight=5,13-15,18-19,22-23)]

<span data-ttu-id="e3240-120">El [ `StringLength` ](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.stringlengthattribute.aspx) atributo establece la longitud máxima de la cadena y establece esta limitación en la base de datos, por lo tanto, se cambiará el esquema de base de datos.</span><span class="sxs-lookup"><span data-stu-id="e3240-120">The [`StringLength`](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.stringlengthattribute.aspx) attribute sets the maximum length of the string, and it sets this limitation on the database, therefore the database schema will change.</span></span> <span data-ttu-id="e3240-121">Haga clic con el botón derecho en el **películas** tabla **Explorador de servidores** y haga clic en **Abrir definición de tabla**:</span><span class="sxs-lookup"><span data-stu-id="e3240-121">Right click on the **Movies** table in **Server explorer** and click **Open Table Definition**:</span></span>

![](adding-validation/_static/image1.png)

<span data-ttu-id="e3240-122">En la imagen anterior, puede ver todos los campos de cadena se establecen en [NVARCHAR (MAX)](https://technet.microsoft.com/library/ms186939.aspx).</span><span class="sxs-lookup"><span data-stu-id="e3240-122">In the image above, you can see all the string fields are set to [NVARCHAR (MAX)](https://technet.microsoft.com/library/ms186939.aspx).</span></span> <span data-ttu-id="e3240-123">Se usará las migraciones para actualizar el esquema.</span><span class="sxs-lookup"><span data-stu-id="e3240-123">We will use migrations to update the schema.</span></span> <span data-ttu-id="e3240-124">Compile la solución y, a continuación, abra el **Package Manager Console** ventana y escriba los siguientes comandos:</span><span class="sxs-lookup"><span data-stu-id="e3240-124">Build the solution, and then open the **Package Manager Console** window and enter the following commands:</span></span>

[!code-console[Main](adding-validation/samples/sample2.cmd)]

<span data-ttu-id="e3240-125">Cuando finalice este comando, Visual Studio abre el archivo de clase que define la nueva `DbMigration` clase derivada con el nombre especificado (`DataAnnotations`) y en el `Up` puede ver el código que actualiza las restricciones de esquema del método:</span><span class="sxs-lookup"><span data-stu-id="e3240-125">When this command finishes, Visual Studio opens the class file that defines the new `DbMigration` derived class with the name specified (`DataAnnotations`), and in the `Up` method you can see the code that updates the schema constraints:</span></span>

[!code-csharp[Main](adding-validation/samples/sample3.cs)]

<span data-ttu-id="e3240-126">El `Genre` campo ya no es que acepta valores null (es decir, debe especificar un valor).</span><span class="sxs-lookup"><span data-stu-id="e3240-126">The `Genre` field is no longer nullable (that is, you must enter a value).</span></span> <span data-ttu-id="e3240-127">El `Rating` campo tiene una longitud máxima de 5 y `Title` tiene una longitud máxima de 60.</span><span class="sxs-lookup"><span data-stu-id="e3240-127">The `Rating` field has a maximum length of 5 and `Title` has a maximum length of 60.</span></span> <span data-ttu-id="e3240-128">La longitud mínima de 3 en `Title` y el intervalo en `Price` no ha creado los cambios de esquema.</span><span class="sxs-lookup"><span data-stu-id="e3240-128">The minimum length of 3 on `Title` and the range on `Price` did not create schema changes.</span></span>

<span data-ttu-id="e3240-129">Examinar el esquema de la película:</span><span class="sxs-lookup"><span data-stu-id="e3240-129">Examine the Movie schema:</span></span>

![](adding-validation/_static/image2.png)

<span data-ttu-id="e3240-130">Los campos de cadena muestran los nuevos límites de longitud y `Genre` ya no se protege como que acepta valores NULL.</span><span class="sxs-lookup"><span data-stu-id="e3240-130">The string fields show the new length limits and `Genre` is no longer checked as nullable.</span></span>

<span data-ttu-id="e3240-131">Los atributos de validación especifican el comportamiento que quiere aplicar en las propiedades del modelo al que se aplican.</span><span class="sxs-lookup"><span data-stu-id="e3240-131">The validation attributes specify behavior that you want to enforce on the model properties they are applied to.</span></span> <span data-ttu-id="e3240-132">Los atributos `Required` y `MinimumLength` indican que una propiedad debe tener un valor, pero nada evita que un usuario escriba espacios en blanco para satisfacer esta validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-132">The `Required` and `MinimumLength` attributes indicates that a property must have a value; but nothing prevents a user from entering white space to satisfy this validation.</span></span> <span data-ttu-id="e3240-133">El [RegularExpression](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.regularexpressionattribute.aspx) atributo se utiliza para limitar los caracteres que pueden ser de entrada.</span><span class="sxs-lookup"><span data-stu-id="e3240-133">The [RegularExpression](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.regularexpressionattribute.aspx) attribute is used to limit what characters can be input.</span></span> <span data-ttu-id="e3240-134">En el código anterior, `Genre` y `Rating` solamente pueden usar letras (no se permiten espacios en blanco, números ni caracteres especiales).</span><span class="sxs-lookup"><span data-stu-id="e3240-134">In the code above, `Genre` and `Rating` must use only letters (white space, numbers and special characters are not allowed).</span></span> <span data-ttu-id="e3240-135">El [ `Range` ](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) atributo restringe un valor a dentro de un intervalo especificado.</span><span class="sxs-lookup"><span data-stu-id="e3240-135">The [`Range`](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) attribute constrains a value to within a specified range.</span></span> <span data-ttu-id="e3240-136">El atributo `StringLength` permite establecer la longitud máxima de una propiedad de cadena y, opcionalmente, su longitud mínima.</span><span class="sxs-lookup"><span data-stu-id="e3240-136">The `StringLength` attribute lets you set the maximum length of a string property, and optionally its minimum length.</span></span> <span data-ttu-id="e3240-137">Tipos de valor (como `decimal, int, float, DateTime`) son intrínsecamente necesarios y no es necesario el `Required` atributo.</span><span class="sxs-lookup"><span data-stu-id="e3240-137">Value types (such as `decimal, int, float, DateTime`) are inherently required and don't need the `Required` attribute.</span></span>

<span data-ttu-id="e3240-138">En primer lugar, código garantiza que se aplican las reglas de validación que especifique en una clase de modelo antes de que la aplicación guarda los cambios en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="e3240-138">Code First ensures that the validation rules you specify on a model class are enforced before the application saves changes in the database.</span></span> <span data-ttu-id="e3240-139">Por ejemplo, el código siguiente producirá un [DbEntityValidationException](https://msdn.microsoft.com/library/system.data.entity.validation.dbentityvalidationexception(v=vs.103).aspx) excepción cuando el `SaveChanges` se denomina método, porque varios necesario `Movie` faltan valores de propiedad:</span><span class="sxs-lookup"><span data-stu-id="e3240-139">For example, the code below will throw a [DbEntityValidationException](https://msdn.microsoft.com/library/system.data.entity.validation.dbentityvalidationexception(v=vs.103).aspx) exception when the `SaveChanges` method is called, because several required `Movie` property values are missing:</span></span>

[!code-csharp[Main](adding-validation/samples/sample4.cs)]

<span data-ttu-id="e3240-140">El código anterior produce la excepción siguiente:</span><span class="sxs-lookup"><span data-stu-id="e3240-140">The code above throws the following exception:</span></span>

<span data-ttu-id="e3240-141">*Error de validación de una o más entidades. Vea la propiedad 'EntityValidationErrors' para obtener más detalles.*</span><span class="sxs-lookup"><span data-stu-id="e3240-141">*Validation failed for one or more entities. See 'EntityValidationErrors' property for more details.*</span></span>

<span data-ttu-id="e3240-142">Las reglas de validación que aplique automáticamente .NET Framework ayuda a que la aplicación sea más robusto.</span><span class="sxs-lookup"><span data-stu-id="e3240-142">Having validation rules automatically enforced by the .NET Framework helps make your application more robust.</span></span> <span data-ttu-id="e3240-143">También nos permite asegurarnos de que todo se valida y que no nos dejamos ningún dato incorrecto en la base de datos accidentalmente.</span><span class="sxs-lookup"><span data-stu-id="e3240-143">It also ensures that you can't forget to validate something and inadvertently let bad data into the database.</span></span>

## <a name="validation-error-ui-in-aspnet-mvc"></a><span data-ttu-id="e3240-144">Error de validación de la interfaz de usuario en ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="e3240-144">Validation Error UI in ASP.NET MVC</span></span>

<span data-ttu-id="e3240-145">Ejecute la aplicación y vaya a la */Movies* dirección URL.</span><span class="sxs-lookup"><span data-stu-id="e3240-145">Run the application and navigate to the */Movies* URL.</span></span>

<span data-ttu-id="e3240-146">Haga clic en el **crear nuevo** el vínculo para agregar una nueva película.</span><span class="sxs-lookup"><span data-stu-id="e3240-146">Click the **Create New** link to add a new movie.</span></span> <span data-ttu-id="e3240-147">Rellene el formulario con algunos valores no válidos.</span><span class="sxs-lookup"><span data-stu-id="e3240-147">Fill out the form with some invalid values.</span></span> <span data-ttu-id="e3240-148">En cuanto la validación del lado cliente de jQuery detecta el problema, muestra un mensaje de error.</span><span class="sxs-lookup"><span data-stu-id="e3240-148">As soon as jQuery client side validation detects the error, it displays an error message.</span></span>

![8_validationErrors](adding-validation/_static/image3.png)

> [!NOTE]
> <span data-ttu-id="e3240-150">para admitir la validación de jQuery para configuraciones regionales distintas del inglés que usan una coma (",") para un punto decimal, debe incluir el paquete NuGet globalizar como se describió anteriormente en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="e3240-150">to support jQuery validation for non-English locales that use a comma (",") for a decimal point, you must include the NuGet globalize as described previously in this tutorial.</span></span>

<span data-ttu-id="e3240-151">Observe cómo el formulario automáticamente usa un color de borde de color rojo para resaltar los cuadros de texto que contienen datos no válidos y se genera un mensaje de error de validación adecuado junto a cada uno de ellos.</span><span class="sxs-lookup"><span data-stu-id="e3240-151">Notice how the form has automatically used a red border color to highlight the text boxes that contain invalid data and has emitted an appropriate validation error message next to each one.</span></span> <span data-ttu-id="e3240-152">Los errores se aplican en el lado cliente (con JavaScript y jQuery) y en el lado servidor (cuando un usuario tiene JavaScript deshabilitado).</span><span class="sxs-lookup"><span data-stu-id="e3240-152">The errors are enforced both client-side (using JavaScript and jQuery) and server-side (in case a user has JavaScript disabled).</span></span>

<span data-ttu-id="e3240-153">Una ventaja real es que no necesita cambiar una sola línea de código en el `MoviesController` clase o en el *Create.cshtml* vista con el fin de habilitar esta interfaz de usuario de validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-153">A real benefit is that you didn't need to change a single line of code in the `MoviesController` class or in the *Create.cshtml* view in order to enable this validation UI.</span></span> <span data-ttu-id="e3240-154">El controlador y las vistas que creó en pasos anteriores de este tutorial seleccionaron automáticamente las reglas de validación que especificó mediante atributos de validación en las propiedades de la clase del modelo `Movie`.</span><span class="sxs-lookup"><span data-stu-id="e3240-154">The controller and views you created earlier in this tutorial automatically picked up the validation rules that you specified by using validation attributes on the properties of the `Movie` model class.</span></span> <span data-ttu-id="e3240-155">Pruebe la aplicación mediante el método de acción `Edit` y se aplicará la misma validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-155">Test validation using the `Edit` action method, and the same validation is applied.</span></span>

<span data-ttu-id="e3240-156">Los datos del formulario no se envían al servidor hasta que no hay ningún error de validación del lado cliente.</span><span class="sxs-lookup"><span data-stu-id="e3240-156">The form data is not sent to the server until there are no client side validation errors.</span></span> <span data-ttu-id="e3240-157">Puede comprobarlo colocando un punto de interrupción en el método HTTP Post, mediante el uso de la [herramienta fiddler](http://fiddler2.com/fiddler2/), o IE [herramientas de desarrollo F12](https://msdn.microsoft.com/ie/aa740478).</span><span class="sxs-lookup"><span data-stu-id="e3240-157">You can verify this by putting a break point in the HTTP Post method, by using the [fiddler tool](http://fiddler2.com/fiddler2/), or the IE [F12 developer tools](https://msdn.microsoft.com/ie/aa740478).</span></span>

## <a name="how-validation-occurs-in-the-create-view-and-create-action-method"></a><span data-ttu-id="e3240-158">Cómo se produce la validación en el crear, ver y crea método de acción</span><span class="sxs-lookup"><span data-stu-id="e3240-158">How Validation Occurs in the Create View and Create Action Method</span></span>

<span data-ttu-id="e3240-159">Tal vez se pregunte cómo se generó la validación de la interfaz de usuario sin actualizar el código en el controlador o las vistas.</span><span class="sxs-lookup"><span data-stu-id="e3240-159">You might wonder how the validation UI was generated without any updates to the code in the controller or views.</span></span> <span data-ttu-id="e3240-160">La lista siguiente muestra lo que el `Create` métodos en el `MovieController` se parecen a clase.</span><span class="sxs-lookup"><span data-stu-id="e3240-160">The next listing shows what the `Create` methods in the `MovieController` class look like.</span></span> <span data-ttu-id="e3240-161">Son iguales que cómo haya creado anteriormente en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="e3240-161">They're unchanged from how you created them earlier in this tutorial.</span></span>

[!code-csharp[Main](adding-validation/samples/sample5.cs)]

<span data-ttu-id="e3240-162">El primer método de acción `Create` (HTTP GET) muestra el formulario de creación inicial.</span><span class="sxs-lookup"><span data-stu-id="e3240-162">The first (HTTP GET) `Create` action method displays the initial Create form.</span></span> <span data-ttu-id="e3240-163">La segunda versión (`[HttpPost]`) controla el envío de formulario.</span><span class="sxs-lookup"><span data-stu-id="e3240-163">The second (`[HttpPost]`) version handles the form post.</span></span> <span data-ttu-id="e3240-164">El segundo `Create` método (el `HttpPost` versión) comprueba `ModelState.IsValid` para ver si la película tiene errores de validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-164">The second `Create` method (the `HttpPost` version) checks `ModelState.IsValid` to see whether the movie has any validation errors.</span></span> <span data-ttu-id="e3240-165">Al obtener esta propiedad se evalúa como los atributos de validación que se han aplicado al objeto.</span><span class="sxs-lookup"><span data-stu-id="e3240-165">Getting this property evaluates any validation attributes that have been applied to the object.</span></span> <span data-ttu-id="e3240-166">Si el objeto tiene errores de validación, el `Create` método vuelve a mostrar el formulario.</span><span class="sxs-lookup"><span data-stu-id="e3240-166">If the object has validation errors, the `Create` method redisplays the form.</span></span> <span data-ttu-id="e3240-167">Si no hay ningún error, el método guarda la nueva película en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="e3240-167">If there are no errors, the method saves the new movie in the database.</span></span> <span data-ttu-id="e3240-168">En nuestro ejemplo de película, **el formulario no se publica en el servidor cuando hay errores de validación detectados en el lado cliente; el segundo** `Create` **nunca se llama al método**.</span><span class="sxs-lookup"><span data-stu-id="e3240-168">In our movie example, **the form isn't posted to the server when there are validation errors detected on the client side; the second** `Create` **method is never called**.</span></span> <span data-ttu-id="e3240-169">Si deshabilita JavaScript en el explorador, la validación del cliente está deshabilitada y la operación HTTP POST `Create` método obtiene `ModelState.IsValid` para comprobar si la película tiene errores de validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-169">If you disable JavaScript in your browser, client validation is disabled, and the HTTP POST `Create` method gets `ModelState.IsValid` to check whether the movie has any validation errors.</span></span>

<span data-ttu-id="e3240-170">Puede establecer un punto de interrupción en el método `HttpPost Create` y comprobar si nunca se llama al método. La validación del lado cliente no enviará los datos del formulario cuando se detecten errores de validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-170">You can set a break point in the `HttpPost Create` method and verify the method is never called, client side validation will not submit the form data when validation errors are detected.</span></span> <span data-ttu-id="e3240-171">Si deshabilita JavaScript en el explorador y después envía el formulario con errores, se alcanzará el punto de interrupción.</span><span class="sxs-lookup"><span data-stu-id="e3240-171">If you disable JavaScript in your browser, then submit the form with errors, the break point will be hit.</span></span> <span data-ttu-id="e3240-172">Puede seguir obteniendo validación completa sin JavaScript.</span><span class="sxs-lookup"><span data-stu-id="e3240-172">You still get full validation without JavaScript.</span></span> <span data-ttu-id="e3240-173">La siguiente imagen muestra cómo deshabilitar JavaScript en Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="e3240-173">The following image shows how to disable JavaScript in Internet Explorer.</span></span>

![](adding-validation/_static/image5.png)

![](adding-validation/_static/image6.png)

<span data-ttu-id="e3240-174">En la siguiente imagen se muestra cómo deshabilitar JavaScript en el explorador Firefox.</span><span class="sxs-lookup"><span data-stu-id="e3240-174">The following image shows how to disable JavaScript in the FireFox browser.</span></span>

![](adding-validation/_static/image7.png)

<span data-ttu-id="e3240-175">En la siguiente imagen se muestra cómo deshabilitar JavaScript en el explorador Chrome.</span><span class="sxs-lookup"><span data-stu-id="e3240-175">The following image shows how to disable JavaScript in the Chrome browser.</span></span>

![](adding-validation/_static/image8.png)

<span data-ttu-id="e3240-176">A continuación se presenta la *Create.cshtml* plantilla de vista que se ha aplicado scaffolding anteriormente en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="e3240-176">Below is the *Create.cshtml* view template that you scaffolded earlier in the tutorial.</span></span> <span data-ttu-id="e3240-177">Los métodos de acción que se muestran arriba la usan para mostrar el formulario inicial y para volver a mostrarlo en caso de error.</span><span class="sxs-lookup"><span data-stu-id="e3240-177">It's used by the action methods shown above both to display the initial form and to redisplay it in the event of an error.</span></span>

[!code-cshtml[Main](adding-validation/samples/sample6.cshtml?highlight=16-17)]

<span data-ttu-id="e3240-178">Observe cómo el código usa un `Html.EditorFor` auxiliar para generar el `<input>` para cada elemento `Movie` propiedad.</span><span class="sxs-lookup"><span data-stu-id="e3240-178">Notice how the code uses an `Html.EditorFor` helper to output the `<input>` element for each `Movie` property.</span></span> <span data-ttu-id="e3240-179">Junto a esta aplicación auxiliar es una llamada a la `Html.ValidationMessageFor` método auxiliar.</span><span class="sxs-lookup"><span data-stu-id="e3240-179">Next to this helper is a call to the `Html.ValidationMessageFor` helper method.</span></span> <span data-ttu-id="e3240-180">Estos dos métodos auxiliares que funcionan con el objeto de modelo que se pasa por el controlador a la vista (en este caso, un `Movie` objeto).</span><span class="sxs-lookup"><span data-stu-id="e3240-180">These two helper methods work with the model object that's passed by the controller to the view (in this case, a `Movie` object).</span></span> <span data-ttu-id="e3240-181">Automáticamente buscar atributos de validación especificados en los mensajes de error de modelo y la presentación según corresponda.</span><span class="sxs-lookup"><span data-stu-id="e3240-181">They automatically look for validation attributes specified on the model and display error messages as appropriate.</span></span>

<span data-ttu-id="e3240-182">Lo realmente bueno de este enfoque es que ni el controlador ni la plantilla de vista `Create` saben que las reglas de validación actuales se están aplicando ni conocen los mensajes de error específicos que se muestran.</span><span class="sxs-lookup"><span data-stu-id="e3240-182">What's really nice about this approach is that neither the controller nor the `Create` view template knows anything about the actual validation rules being enforced or about the specific error messages displayed.</span></span> <span data-ttu-id="e3240-183">Las reglas de validación y las cadenas de error solo se especifican en la clase `Movie`.</span><span class="sxs-lookup"><span data-stu-id="e3240-183">The validation rules and the error strings are specified only in the `Movie` class.</span></span> <span data-ttu-id="e3240-184">Estas mismas reglas de validación se aplican automáticamente a la vista `Edit` y a cualquier otra vista de plantillas creada que edite el modelo.</span><span class="sxs-lookup"><span data-stu-id="e3240-184">These same validation rules are automatically applied to the `Edit` view and any other views templates you might create that edit your model.</span></span>

<span data-ttu-id="e3240-185">Si desea cambiar la lógica de validación más adelante, puede hacerlo en exactamente un solo lugar mediante la adición de atributos de validación al modelo (en este ejemplo, el `movie` clase).</span><span class="sxs-lookup"><span data-stu-id="e3240-185">If you want to change the validation logic later, you can do so in exactly one place by adding validation attributes to the model (in this example, the `movie` class).</span></span> <span data-ttu-id="e3240-186">No tendrá que preocuparse de que diferentes partes de la aplicación sean incoherentes con el modo en que se aplican las reglas: toda la lógica de validación se definirá en un solo lugar y se usará en todas partes.</span><span class="sxs-lookup"><span data-stu-id="e3240-186">You won't have to worry about different parts of the application being inconsistent with how the rules are enforced — all validation logic will be defined in one place and used everywhere.</span></span> <span data-ttu-id="e3240-187">Esto mantiene el código muy limpio y hace que sea fácil de mantener y evolucionar.</span><span class="sxs-lookup"><span data-stu-id="e3240-187">This keeps the code very clean, and makes it easy to maintain and evolve.</span></span> <span data-ttu-id="e3240-188">Y significa que respeta totalmente el *seco* principio.</span><span class="sxs-lookup"><span data-stu-id="e3240-188">And it means that you'll be fully honoring the *DRY* principle.</span></span>

## <a name="using-datatype-attributes"></a><span data-ttu-id="e3240-189">Uso de atributos DataType</span><span class="sxs-lookup"><span data-stu-id="e3240-189">Using DataType Attributes</span></span>

<span data-ttu-id="e3240-190">Abra el archivo *Movie.cs* y examine la clase `Movie`.</span><span class="sxs-lookup"><span data-stu-id="e3240-190">Open the *Movie.cs* file and examine the `Movie` class.</span></span> <span data-ttu-id="e3240-191">El [ `System.ComponentModel.DataAnnotations` ](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.aspx) espacio de nombres proporciona atributos de formato además del conjunto integrado de atributos de validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-191">The [`System.ComponentModel.DataAnnotations`](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.aspx) namespace provides formatting attributes in addition to the built-in set of validation attributes.</span></span> <span data-ttu-id="e3240-192">Ya hemos aplicado un [ `DataType` ](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) valor de enumeración para la fecha de lanzamiento y los campos de precio.</span><span class="sxs-lookup"><span data-stu-id="e3240-192">We've already applied a [`DataType`](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) enumeration value to the release date and to the price fields.</span></span> <span data-ttu-id="e3240-193">El siguiente código muestra la `ReleaseDate` y `Price` propiedades con los valores adecuados [ `DataType` ](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) atributo.</span><span class="sxs-lookup"><span data-stu-id="e3240-193">The following code shows the `ReleaseDate` and `Price` properties with the appropriate [`DataType`](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) attribute.</span></span>

[!code-csharp[Main](adding-validation/samples/sample7.cs)]

<span data-ttu-id="e3240-194">El [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) atributos solo proporcionan sugerencias para el motor de vista aplique formato a los datos (y suministre atributos como `<a>` para las direcciones URL y `<a href="mailto:EmailAddress.com">` para correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="e3240-194">The [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) attributes only provide hints for the view engine to format the data (and supply attributes such as `<a>` for URL's and `<a href="mailto:EmailAddress.com">` for email.</span></span> <span data-ttu-id="e3240-195">Puede usar el [RegularExpression](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.regularexpressionattribute.aspx) atributo para validar el formato de los datos.</span><span class="sxs-lookup"><span data-stu-id="e3240-195">You can use the [RegularExpression](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.regularexpressionattribute.aspx) attribute to validate the format of the data.</span></span> <span data-ttu-id="e3240-196">El [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) atributo se usa para especificar un tipo de datos que es más específico que el tipo intrínseco de base de datos, son ***no*** atributos de validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-196">The [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) attribute is used to specify a data type that is more specific than the database intrinsic type, they are ***not*** validation attributes.</span></span> <span data-ttu-id="e3240-197">En este caso solo se quiere realizar el seguimiento de la fecha, no de la fecha y la hora.</span><span class="sxs-lookup"><span data-stu-id="e3240-197">In this case we only want to keep track of the date, not the date and time.</span></span> <span data-ttu-id="e3240-198">El [enumeración DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) proporciona muchos tipos de datos, como *fecha, hora, PhoneNumber, Currency, EmailAddress* y mucho más.</span><span class="sxs-lookup"><span data-stu-id="e3240-198">The [DataType Enumeration](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) provides for many data types, such as *Date, Time, PhoneNumber, Currency, EmailAddress* and more.</span></span> <span data-ttu-id="e3240-199">El atributo `DataType` también puede permitir que la aplicación proporcione automáticamente características específicas del tipo.</span><span class="sxs-lookup"><span data-stu-id="e3240-199">The `DataType` attribute can also enable the application to automatically provide type-specific features.</span></span> <span data-ttu-id="e3240-200">Por ejemplo, un `mailto:` vínculo puede crearse para [DataType.EmailAddress](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx), y se puede proporcionar un selector de fecha para [DataType.Date](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) en exploradores que admiten [HTML5](http://html5.org/).</span><span class="sxs-lookup"><span data-stu-id="e3240-200">For example, a `mailto:` link can be created for [DataType.EmailAddress](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx), and a date selector can be provided for [DataType.Date](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatype.aspx) in browsers that support [HTML5](http://html5.org/).</span></span> <span data-ttu-id="e3240-201">El [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) emite de atributos HTML 5 [data -](http://ejohn.org/blog/html-5-data-attributes/) (pronunciado *"datos dash"*) los atributos que los exploradores HTML 5 pueden comprender.</span><span class="sxs-lookup"><span data-stu-id="e3240-201">The [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) attributes emits HTML 5 [data-](http://ejohn.org/blog/html-5-data-attributes/) (pronounced *data dash*) attributes that HTML 5 browsers can understand.</span></span> <span data-ttu-id="e3240-202">El [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) atributos no proporcionan ninguna validación.</span><span class="sxs-lookup"><span data-stu-id="e3240-202">The [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) attributes do not provide any validation.</span></span>

<span data-ttu-id="e3240-203">`DataType.Date` no especifica el formato de la fecha que se muestra.</span><span class="sxs-lookup"><span data-stu-id="e3240-203">`DataType.Date` does not specify the format of the date that is displayed.</span></span> <span data-ttu-id="e3240-204">De forma predeterminada, se muestra el campo de datos según los formatos predeterminados basados en el servidor [CultureInfo](https://msdn.microsoft.com/library/vstudio/system.globalization.cultureinfo(v=vs.110).aspx).</span><span class="sxs-lookup"><span data-stu-id="e3240-204">By default, the data field is displayed according to the default formats based on the server's [CultureInfo](https://msdn.microsoft.com/library/vstudio/system.globalization.cultureinfo(v=vs.110).aspx).</span></span>

<span data-ttu-id="e3240-205">El atributo `DisplayFormat` se usa para especificar el formato de fecha de forma explícita:</span><span class="sxs-lookup"><span data-stu-id="e3240-205">The `DisplayFormat` attribute is used to explicitly specify the date format:</span></span>

[!code-csharp[Main](adding-validation/samples/sample8.cs)]

<span data-ttu-id="e3240-206">El `ApplyFormatInEditMode` configuración especifica que el formato especificado también se debe aplicar cuando el valor se muestra en un cuadro de texto para su edición.</span><span class="sxs-lookup"><span data-stu-id="e3240-206">The `ApplyFormatInEditMode` setting specifies that the specified formatting should also be applied when the value is displayed in a text box for editing.</span></span> <span data-ttu-id="e3240-207">(No es posible que desee que algunos campos, por ejemplo, para los valores de moneda, es posible que no desea el símbolo de moneda en el cuadro de texto para su edición.)</span><span class="sxs-lookup"><span data-stu-id="e3240-207">(You might not want that for some fields — for example, for currency values, you might not want the currency symbol in the text box for editing.)</span></span>

<span data-ttu-id="e3240-208">Puede usar el [DisplayFormat](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.displayformatattribute.aspx) atributo por sí solo, pero suele ser una buena idea usar el [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) atributo también.</span><span class="sxs-lookup"><span data-stu-id="e3240-208">You can use the [DisplayFormat](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.displayformatattribute.aspx) attribute by itself, but it's generally a good idea to use the [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) attribute also.</span></span> <span data-ttu-id="e3240-209">El `DataType` atributo transmite la *semántica* de los datos como contraposición a cómo se representan en una pantalla y proporciona las siguientes ventajas que no conseguimos `DisplayFormat`:</span><span class="sxs-lookup"><span data-stu-id="e3240-209">The `DataType` attribute conveys the *semantics* of the data as opposed to how to render it on a screen, and provides the following benefits that you don't get with `DisplayFormat`:</span></span>

- <span data-ttu-id="e3240-210">El explorador puede habilitar características de HTML5 (por ejemplo mostrar un control de calendario, el símbolo de divisa adecuado según la configuración regional, vínculos de correo electrónico, etcetera.).</span><span class="sxs-lookup"><span data-stu-id="e3240-210">The browser can enable HTML5 features (for example to show a calendar control, the locale-appropriate currency symbol, email links, etc.).</span></span>
- <span data-ttu-id="e3240-211">De forma predeterminada, el explorador representa los datos con el formato correcto en función de su [configuración regional](https://msdn.microsoft.com/library/vstudio/wyzd2bce.aspx).</span><span class="sxs-lookup"><span data-stu-id="e3240-211">By default, the browser will render data using the correct format based on your [locale](https://msdn.microsoft.com/library/vstudio/wyzd2bce.aspx).</span></span>
- <span data-ttu-id="e3240-212">El [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) atributo puede habilitar MVC elegir la plantilla de campo a la derecha para representar los datos (el [DisplayFormat](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.displayformatattribute.aspx) si utiliza por sí mismo utiliza la plantilla de cadena).</span><span class="sxs-lookup"><span data-stu-id="e3240-212">The [DataType](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.datatypeattribute.aspx) attribute can enable MVC to choose the right field template to render the data (the [DisplayFormat](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.displayformatattribute.aspx) if used by itself uses the string template).</span></span> <span data-ttu-id="e3240-213">Para obtener más información, consulte Brad Wilson [plantillas de ASP.NET MVC 2](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html).</span><span class="sxs-lookup"><span data-stu-id="e3240-213">For more information, see Brad Wilson's [ASP.NET MVC 2 Templates](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-1-introduction.html).</span></span> <span data-ttu-id="e3240-214">(Aunque se escribió para MVC 2, en este artículo todavía se aplica a la versión actual de ASP.NET MVC.)</span><span class="sxs-lookup"><span data-stu-id="e3240-214">(Though written for MVC 2, this article still applies to the current version of ASP.NET MVC.)</span></span>

<span data-ttu-id="e3240-215">Si usas el `DataType` atributo con un campo de fecha, tendrá que especificar el `DisplayFormat` atributo también con el fin de asegurarse de que el campo se representa correctamente en exploradores de Chrome.</span><span class="sxs-lookup"><span data-stu-id="e3240-215">If you use the `DataType` attribute with a date field, you have to specify the `DisplayFormat` attribute also in order to ensure that the field renders correctly in Chrome browsers.</span></span> <span data-ttu-id="e3240-216">Para obtener más información, consulte [este hilo](http://stackoverflow.com/questions/12633471/mvc4-datatype-date-editorfor-wont-display-date-value-in-chrome-fine-in-ie).</span><span class="sxs-lookup"><span data-stu-id="e3240-216">For more information, see [this StackOverflow thread](http://stackoverflow.com/questions/12633471/mvc4-datatype-date-editorfor-wont-display-date-value-in-chrome-fine-in-ie).</span></span>

> [!NOTE]
> <span data-ttu-id="e3240-217">validación de jQuery no funciona con el [intervalo](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) atributo y [DateTime](https://msdn.microsoft.com/library/system.datetime.aspx).</span><span class="sxs-lookup"><span data-stu-id="e3240-217">jQuery validation does not work with the [Range](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) attribute and [DateTime](https://msdn.microsoft.com/library/system.datetime.aspx).</span></span> <span data-ttu-id="e3240-218">Por ejemplo, el código siguiente siempre muestra un error de validación del lado cliente, incluso cuando la fecha está en el intervalo especificado:</span><span class="sxs-lookup"><span data-stu-id="e3240-218">For example, the following code will always display a client side validation error, even when the date is in the specified range:</span></span>
> 
> [!code-csharp[Main](adding-validation/samples/sample9.cs)]
> 
> <span data-ttu-id="e3240-219">Deberá deshabilitar la validación de la fecha de jQuery para usar el [intervalo](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) con el atributo [DateTime](https://msdn.microsoft.com/library/system.datetime.aspx).</span><span class="sxs-lookup"><span data-stu-id="e3240-219">You will need to disable jQuery date validation to use the [Range](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) attribute with [DateTime](https://msdn.microsoft.com/library/system.datetime.aspx).</span></span> <span data-ttu-id="e3240-220">Por lo general no resulta una buena práctica para compilar fechas fijas en los modelos, por lo que usar el [intervalo](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) atributo y [DateTime](https://msdn.microsoft.com/library/system.datetime.aspx) es en absoluto.</span><span class="sxs-lookup"><span data-stu-id="e3240-220">It's generally not a good practice to compile hard dates in your models, so using the [Range](https://msdn.microsoft.com/library/system.componentmodel.dataannotations.rangeattribute.aspx) attribute and [DateTime](https://msdn.microsoft.com/library/system.datetime.aspx) is discouraged.</span></span>

<span data-ttu-id="e3240-221">El código siguiente muestra la combinación de atributos en una línea:</span><span class="sxs-lookup"><span data-stu-id="e3240-221">The following code shows combining attributes on one line:</span></span>

[!code-csharp[Main](adding-validation/samples/sample10.cs?highlight=4,6,10,12)]

<span data-ttu-id="e3240-222">En la siguiente parte de la serie de tutoriales, revisaremos la aplicación y realizaremos algunas mejoras a los métodos `Details` y `Delete` generados automáticamente.</span><span class="sxs-lookup"><span data-stu-id="e3240-222">In the next part of the series, we'll review the application and make some improvements to the automatically generated `Details` and `Delete` methods.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e3240-223">[Anterior](adding-a-new-field.md)
> [Siguiente](examining-the-details-and-delete-methods.md)</span><span class="sxs-lookup"><span data-stu-id="e3240-223">[Previous](adding-a-new-field.md)
[Next](examining-the-details-and-delete-methods.md)</span></span>

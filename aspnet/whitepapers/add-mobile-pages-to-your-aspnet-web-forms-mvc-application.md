---
uid: whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
title: Cómo Agregar las páginas móviles a los formularios de ASP.NET Web / aplicación MVC | Microsoft Docs
author: rick-anderson
description: Esta página se describe varias maneras de servir páginas optimizadas para dispositivos móviles de los formularios Web Forms de ASP.NET / aplicación de MVC y sugiere la arquitectura y...
ms.author: riande
ms.date: 01/20/2011
ms.assetid: 3124f28e-cc32-418a-afe3-519fa56f4c36
msc.legacyurl: /whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
msc.type: content
ms.openlocfilehash: 63c555358d06a9506bb5c8c993800c3307108192
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2019
ms.locfileid: "65114444"
---
# <a name="how-to-add-mobile-pages-to-your-aspnet-web-forms--mvc-application"></a><span data-ttu-id="432fe-103">Cómo Agregar páginas de dispositivos móviles a los formularios Web Forms o a la aplicación de MVC de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="432fe-103">How To: Add Mobile Pages to Your ASP.NET Web Forms / MVC Application</span></span>

> <span data-ttu-id="432fe-104">**Se aplica a**</span><span class="sxs-lookup"><span data-stu-id="432fe-104">**Applies To**</span></span>
> 
> - <span data-ttu-id="432fe-105">Versión de formularios Web Forms ASP.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="432fe-105">ASP.NET Web Forms version 4.0</span></span>
> - <span data-ttu-id="432fe-106">ASP.NET MVC versión 3.0</span><span class="sxs-lookup"><span data-stu-id="432fe-106">ASP.NET MVC version 3.0</span></span>
> 
> <span data-ttu-id="432fe-107">**Resumen**</span><span class="sxs-lookup"><span data-stu-id="432fe-107">**Summary**</span></span>
> 
> <span data-ttu-id="432fe-108">Esta página se describe varias maneras de servir páginas optimizadas para dispositivos móviles de los formularios Web Forms de ASP.NET / aplicación de MVC y sugiere la arquitectura y diseño cuestiones a considerar cuando el destino es una amplia gama de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="432fe-108">This How To describes various ways to serve pages optimized for mobile devices from your ASP.NET Web Forms / MVC application, and suggests architectural and design issues to consider when targeting a broad range of devices.</span></span> <span data-ttu-id="432fe-109">Este documento también explica por qué los controles ASP.NET Mobile desde ASP.NET 2.0 a 3.5 ahora están obsoletos y se tratan algunas alternativas modernas.</span><span class="sxs-lookup"><span data-stu-id="432fe-109">This document also explains why the ASP.NET Mobile Controls from ASP.NET 2.0 to 3.5 are now obsolete, and discusses some modern alternatives.</span></span>

## <a name="contents"></a><span data-ttu-id="432fe-110">Contenido</span><span class="sxs-lookup"><span data-stu-id="432fe-110">Contents</span></span>

- <span data-ttu-id="432fe-111">Información general</span><span class="sxs-lookup"><span data-stu-id="432fe-111">Overview</span></span>
- <span data-ttu-id="432fe-112">Opciones de arquitectura</span><span class="sxs-lookup"><span data-stu-id="432fe-112">Architectural options</span></span>
- <span data-ttu-id="432fe-113">Detección de explorador y del dispositivo</span><span class="sxs-lookup"><span data-stu-id="432fe-113">Browser and device detection</span></span>
- <span data-ttu-id="432fe-114">Cómo las aplicaciones de formularios Web Forms ASP.NET pueden presentar páginas específicas de dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-114">How ASP.NET Web Forms applications can present mobile-specific pages</span></span>
- <span data-ttu-id="432fe-115">Cómo las aplicaciones de ASP.NET MVC pueden presentar páginas específicas de dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-115">How ASP.NET MVC applications can present mobile-specific pages</span></span>
- <span data-ttu-id="432fe-116">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="432fe-116">Additional resources</span></span>

<span data-ttu-id="432fe-117">Para obtener ejemplos de código descargable que muestra las técnicas de este artículo técnico para ASP.NET Web Forms y MVC, consulte [Mobile Apps & sitios con ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="432fe-117">For downloadable code samples demonstrating this white paper's techniques for both ASP.NET Web Forms and MVC, see [Mobile Apps & Sites with ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span></span>

## <a name="overview"></a><span data-ttu-id="432fe-118">Información general</span><span class="sxs-lookup"><span data-stu-id="432fe-118">Overview</span></span>

<span data-ttu-id="432fe-119">Los dispositivos móviles – smartphones, tabletas y teléfonos de la característica: siguen creciendo en popularidad como un medio para tener acceso a la Web.</span><span class="sxs-lookup"><span data-stu-id="432fe-119">Mobile devices – smartphones, feature phones, and tablets – continue to grow in popularity as a means to access the Web.</span></span> <span data-ttu-id="432fe-120">Para muchos desarrolladores web y las empresas orientados a web, esto significa que resulta cada vez más importante proporcionar una gran experiencia de exploración para los visitantes utilizan esos dispositivos.</span><span class="sxs-lookup"><span data-stu-id="432fe-120">For many web developers and web-oriented businesses, this means it's increasingly important to provide a great browsing experience for visitors using those devices.</span></span>

### <a name="how-earlier-versions-of-aspnet-supported-mobile-browsers"></a><span data-ttu-id="432fe-121">Cómo versiones preliminares de los exploradores móviles compatibles con ASP.NET</span><span class="sxs-lookup"><span data-stu-id="432fe-121">How earlier versions of ASP.NET supported mobile browsers</span></span>

<span data-ttu-id="432fe-122">Las versiones de ASP.NET 2.0 a 3.5 incluye *controles ASP.NET Mobile*: un conjunto de controles de servidor para dispositivos móviles en el *System.Web.Mobile.dll* ensamblado y el  *En System.Web.UI.MobileControls* espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="432fe-122">ASP.NET versions 2.0 to 3.5 included *ASP.NET Mobile Controls*: a set of server controls for mobile devices in the *System.Web.Mobile.dll* assembly and the *System.Web.UI.MobileControls* namespace.</span></span> <span data-ttu-id="432fe-123">El ensamblado todavía está incluido en ASP.NET 4, pero está en desuso.</span><span class="sxs-lookup"><span data-stu-id="432fe-123">The assembly is still included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="432fe-124">Para migrar a los enfoques más modernos, tales como los descritos en este artículo, se aconseja a los desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="432fe-124">Developers are advised to migrate to more modern approaches, such as those described in this paper.</span></span>

<span data-ttu-id="432fe-125">El motivo por qué controles móviles de ASP.NET se han marcado como obsoleto es que su diseño se centra en los teléfonos móviles que son comunes en torno a 2005 y anterior.</span><span class="sxs-lookup"><span data-stu-id="432fe-125">The reason why ASP.NET Mobile Controls have been marked as obsolete is that their design is oriented around the mobile phones that were common around 2005 and earlier.</span></span> <span data-ttu-id="432fe-126">Los controles están diseñados principalmente para representar el marcado de cHTML o de WML (en lugar de HTML normal) para los exploradores WAP de aquella era.</span><span class="sxs-lookup"><span data-stu-id="432fe-126">The controls are mainly designed to render WML or cHTML markup (instead of regular HTML) for the WAP browsers of that era.</span></span> <span data-ttu-id="432fe-127">Pero WAP, WML y cHTML ya no son relevantes para la mayoría de los proyectos, porque HTML se ha convertido en el lenguaje de marcado ubicuo para exploradores de escritorio y móviles iguales.</span><span class="sxs-lookup"><span data-stu-id="432fe-127">But WAP, WML, and cHTML are no longer relevant for most projects, because HTML has now become the ubiquitous markup language for mobile and desktop browsers alike.</span></span>

### <a name="the-challenges-of-supporting-mobile-devices-today"></a><span data-ttu-id="432fe-128">Los desafíos de hoy en día se admiten aquellos dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-128">The challenges of supporting mobile devices today</span></span>

<span data-ttu-id="432fe-129">Aunque los exploradores móviles ahora casi totalmente compatible con HTML, todavía sufrirán muchos desafíos al que tiene como finalidad crear excelentes experiencias de exploración móviles:</span><span class="sxs-lookup"><span data-stu-id="432fe-129">Even though mobile browsers now almost universally support HTML, you will still face many challenges when aiming to create great mobile browsing experiences:</span></span>

- <span data-ttu-id="432fe-130">***Tamaño de pantalla*** : los dispositivos móviles varían considerablemente en el formulario y sus pantallas suelen ser mucho menor que los monitores de escritorio.</span><span class="sxs-lookup"><span data-stu-id="432fe-130">***Screen size*** - Mobile devices vary dramatically in form, and their screens are often much smaller than desktop monitors.</span></span> <span data-ttu-id="432fe-131">Por lo tanto, es posible que deba crear diseños de página completamente diferente para ellos.</span><span class="sxs-lookup"><span data-stu-id="432fe-131">So, you may need to design completely different page layouts for them.</span></span>
- <span data-ttu-id="432fe-132">***Métodos de entrada*** : algunos dispositivos tienen teclados, algunos tienen fonocaptores, otros usuarios usan un toque.</span><span class="sxs-lookup"><span data-stu-id="432fe-132">***Input methods*** – Some devices have keypads, some have styluses, others use touch.</span></span> <span data-ttu-id="432fe-133">Deberá considerar navegación varios mecanismos y los datos de los métodos de entrada.</span><span class="sxs-lookup"><span data-stu-id="432fe-133">You may need to consider multiple navigation mechanisms and data input methods.</span></span>
- <span data-ttu-id="432fe-134">***Cumplimiento de estándares*** – muchos exploradores móviles no son compatibles con los estándares más recientes de HTML, CSS o JavaScript.</span><span class="sxs-lookup"><span data-stu-id="432fe-134">***Standards compliance*** – Many mobile browsers do not support the latest HTML, CSS, or JavaScript standards.</span></span>
- <span data-ttu-id="432fe-135">***Ancho de banda*** : rendimiento de la red de telefonía móvil datos varía ampliamente y algunos usuarios finales se encuentran en las tarifas que cobran por en megabytes.</span><span class="sxs-lookup"><span data-stu-id="432fe-135">***Bandwidth*** – Cellular data network performance varies wildly, and some end users are on tariffs that charge by the megabyte.</span></span>

<span data-ttu-id="432fe-136">No hay ninguna solución única; la aplicación tendrá que buscar y comportarse de manera diferente según el dispositivo tener acceso a él.</span><span class="sxs-lookup"><span data-stu-id="432fe-136">There's no one-size-fits-all solution; your application will have to look and behave differently according to the device accessing it.</span></span> <span data-ttu-id="432fe-137">Dependiendo de qué nivel de compatibilidad con dispositivos móvil que desee, esto puede ser un desafío mayor para los desarrolladores web que alguna vez fue el escritorio "wars explorador".</span><span class="sxs-lookup"><span data-stu-id="432fe-137">Depending on what level of mobile support you want, this can be a bigger challenge for web developers than the desktop "browser wars" ever was.</span></span>

<span data-ttu-id="432fe-138">Desarrolladores que abordan la compatibilidad del explorador móvil por primera vez a menudo inicialmente crean que solo es importante admitir los smartphones más recientes y más sofisticados (p. ej., Windows Phone 7, iPhone o Android), quizás porque los desarrolladores a menudo personalmente poseen como dispositivos.</span><span class="sxs-lookup"><span data-stu-id="432fe-138">Developers approaching mobile browser support for the first time often initially think it's only important to support the latest and most sophisticated smartphones (e.g., Windows Phone 7, iPhone, or Android), perhaps because developers often personally own such devices.</span></span> <span data-ttu-id="432fe-139">Sin embargo, todavía son extremadamente populares teléfonos más baratos y sus propietarios deben usar para navegar por Internet, especialmente en los países donde los teléfonos móviles son más fáciles de obtener que una conexión de banda ancha.</span><span class="sxs-lookup"><span data-stu-id="432fe-139">However, cheaper phones are still extremely popular, and their owners do use them to browse the web – especially in countries where mobile phones are easier to get than a broadband connection.</span></span> <span data-ttu-id="432fe-140">Debe decidir qué gama de dispositivos para admitir teniendo en cuenta sus clientes es probable que su negocio.</span><span class="sxs-lookup"><span data-stu-id="432fe-140">Your business will need to decide what range of devices to support by considering its likely customers.</span></span> <span data-ttu-id="432fe-141">Si va a crear un folleto en línea para un spa de mantenimiento de lujo, podría tomar la decisión de negocio solo como destino smartphones avanzados, mientras que si va a crear un sistema de reservas de vale para un cine, probablemente necesitará tener en cuenta que los visitantes con menos eficaces características teléfonos.</span><span class="sxs-lookup"><span data-stu-id="432fe-141">If you're building an online brochure for a luxury health spa, you might make a business decision only to target advanced smartphones, whereas if you're creating a ticket booking system for a cinema, you probably need to account for visitors with less powerful feature phones.</span></span>

## <a name="architectural-options"></a><span data-ttu-id="432fe-142">Opciones de arquitectura</span><span class="sxs-lookup"><span data-stu-id="432fe-142">Architectural options</span></span>

<span data-ttu-id="432fe-143">Antes de entrar en los detalles técnicos específicos de ASP.NET Web Forms o MVC, tenga en cuenta que los desarrolladores web en general tienen tres opciones posibles principales para admitir exploradores móviles:</span><span class="sxs-lookup"><span data-stu-id="432fe-143">Before we get to the specific technical details of ASP.NET Web Forms or MVC, note that web developers in general have three main possible options for supporting mobile browsers:</span></span>

1. <span data-ttu-id="432fe-144">***No hacer nada:*** simplemente puede crear una aplicación web orientada a servicios de escritorio estándar y se basan en los exploradores móviles se representan de manera aceptable.</span><span class="sxs-lookup"><span data-stu-id="432fe-144">***Do nothing –*** You can simply create a standard, desktop-oriented web application, and rely on mobile browsers to render it acceptably.</span></span> 

    - <span data-ttu-id="432fe-145">**Ventaja**: Es la opción más económica de implementar y mantener: un trabajo adicional no</span><span class="sxs-lookup"><span data-stu-id="432fe-145">**Advantage**: It's the cheapest option to implement and maintain – no extra work</span></span>
    - <span data-ttu-id="432fe-146">**Desventaja**: Le ofrece la experiencia del usuario final peor:</span><span class="sxs-lookup"><span data-stu-id="432fe-146">**Disadvantage**: Gives the worst end-user experience:</span></span> 

        - <span data-ttu-id="432fe-147">Los smartphones más recientes puede representar el HTML, así como un explorador de escritorio, pero todavía se verán obligados a los usuarios para aplicar zoom y desplazamiento horizontal y verticalmente para consumir el contenido en una pantalla pequeña.</span><span class="sxs-lookup"><span data-stu-id="432fe-147">The latest smartphones may render your HTML just as well as a desktop browser, but users will still be forced to zoom and scroll horizontally and vertically to consume your content on a small screen.</span></span> <span data-ttu-id="432fe-148">Esto está lejos de ser óptimo.</span><span class="sxs-lookup"><span data-stu-id="432fe-148">This is far from optimal.</span></span>
        - <span data-ttu-id="432fe-149">Los dispositivos más antiguos y los teléfonos de característica pueden producir un error al representar el marcado de forma satisfactoria.</span><span class="sxs-lookup"><span data-stu-id="432fe-149">Older devices and feature phones may fail to render your markup in a satisfactory way.</span></span>
        - <span data-ttu-id="432fe-150">Incluso en los últimos dispositivos Tablet PC (cuyas pantallas pueden ser tan grandes como las de portátiles), se aplican las reglas de interacción diferentes.</span><span class="sxs-lookup"><span data-stu-id="432fe-150">Even on the latest tablet devices (whose screens can be as big as laptop screens), different interaction rules apply.</span></span> <span data-ttu-id="432fe-151">Entrada basados en funcionalidad táctil funciona mejor con los botones más grandes y vincula diseminación aún más separado y no hay ninguna manera de mantener el mouse de un cursor del mouse sobre un menú emergente.</span><span class="sxs-lookup"><span data-stu-id="432fe-151">Touch-based input works best with larger buttons and links spread further apart, and there's no way to hover a mouse cursor over a fly-out menu.</span></span>
2. <span data-ttu-id="432fe-152">***Resolver el problema en el cliente* –** con cuidado de uso de CSS y [mejora progresiva](http://en.wikipedia.org/wiki/Progressive_enhancement) puede crear marcado, estilos y scripts que se adapten a cualquier explorador que está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="432fe-152">***Solve the problem on the client* –** With careful use of CSS and [progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) you can create markup, styles, and scripts that adapt to whatever browser is running them.</span></span> <span data-ttu-id="432fe-153">Por ejemplo, con [las consultas de medios de CSS 3](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), podría crear un diseño de varias columna que se convierte en un diseño de columna única en los dispositivos cuyas pantallas son más estrechas que el umbral seleccionado.</span><span class="sxs-lookup"><span data-stu-id="432fe-153">For example, with [CSS 3 media queries](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), you could create a multi-column layout that turns into a single column layout on devices whose screens are narrower than a chosen threshold.</span></span> 

    - <span data-ttu-id="432fe-154">**Ventaja**: Optimiza la representación del dispositivo específico en uso, incluso para futuros dispositivos desconocidos función cualquier pantalla y las características de entrada tienen</span><span class="sxs-lookup"><span data-stu-id="432fe-154">**Advantage**: Optimizes rendering for the specific device in use, even for unknown future devices according to whatever screen and input characteristics they have</span></span>
    - <span data-ttu-id="432fe-155">**Ventaja**: Permite compartir la lógica del lado servidor en todos los tipos de dispositivo: duplicación mínima de código ni esfuerzo alguno fácilmente</span><span class="sxs-lookup"><span data-stu-id="432fe-155">**Advantage**: Easily lets you share server-side logic across all device types – minimal duplication of code or effort</span></span>
    - <span data-ttu-id="432fe-156">**Desventaja**: Los dispositivos móviles son muy diferentes del que es posible que realmente quiere las páginas móviles sea completamente distinto de las páginas de escritorio, que muestra información diferentes dispositivos de escritorio.</span><span class="sxs-lookup"><span data-stu-id="432fe-156">**Disadvantage**: Mobile devices are so different from desktop devices that you may really want your mobile pages to be completely different from your desktop pages, showing different information.</span></span> <span data-ttu-id="432fe-157">Estas variaciones pueden ser ineficaces o poco probables de conseguir con eficacia a través de CSS por sí solo, especialmente teniendo en cuenta cómo incoherentemente dispositivos antiguos interpretan las reglas de CSS.</span><span class="sxs-lookup"><span data-stu-id="432fe-157">Such variations can be inefficient or impossible to achieve robustly through CSS alone, especially considering how inconsistently older devices interpret CSS rules.</span></span> <span data-ttu-id="432fe-158">Esto es especialmente cierto para los atributos CSS 3.</span><span class="sxs-lookup"><span data-stu-id="432fe-158">This is particularly true of CSS 3 attributes.</span></span>
    - <span data-ttu-id="432fe-159">**Desventaja**: No proporciona compatibilidad con lógica de servidor diferente y flujos de trabajo para distintos dispositivos.</span><span class="sxs-lookup"><span data-stu-id="432fe-159">**Disadvantage**: Provides no support for varying server-side logic and workflows for different devices.</span></span> <span data-ttu-id="432fe-160">Por ejemplo, no es posible, implemente una compra carro de la desprotección flujo de trabajo simplificado para usuarios móviles mediante CSS por sí solo.</span><span class="sxs-lookup"><span data-stu-id="432fe-160">You can't, for example, implement a simplified shopping cart checkout workflow for mobile users by means of CSS alone.</span></span>
    - <span data-ttu-id="432fe-161">**Desventaja**: Uso de ancho de banda ineficaz.</span><span class="sxs-lookup"><span data-stu-id="432fe-161">**Disadvantage**: Inefficient bandwidth use.</span></span> <span data-ttu-id="432fe-162">El servidor puede tener que transmitir el marcado y los estilos que se aplican a todos los dispositivos posibles, aunque el dispositivo de destino sólo utilizará un subconjunto de esa información.</span><span class="sxs-lookup"><span data-stu-id="432fe-162">You server may have to transmit the markup and styles that apply to all possible devices, even though the target device will only use a subset of that information.</span></span>
3. <span data-ttu-id="432fe-163">***Solucionar el problema en el servidor* –** si el servidor sabe cuál es el dispositivo tiene acceso a ella, o en menos de las características de ese dispositivo, como su tamaño de la pantalla y el método de entrada, y ya sea un dispositivo móvil: se puede ejecutar una lógica diferente y marcado HTML diferentes de salida.</span><span class="sxs-lookup"><span data-stu-id="432fe-163">***Solve the problem on the server* –** If your server knows what device is accessing it – or at least the characteristics of that device, such as its screen size and input method, and whether it's a mobile device – it can run different logic and output different HTML markup.</span></span> 

    - <span data-ttu-id="432fe-164">**Ventaja:** Obtener la máxima flexibilidad.</span><span class="sxs-lookup"><span data-stu-id="432fe-164">**Advantage:** Maximum flexibility.</span></span> <span data-ttu-id="432fe-165">No hay ningún límite a cuánto puede variar la lógica del lado servidor para dispositivos móviles u optimizar el marcado para el diseño deseado, específicos del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="432fe-165">There's no limit to how much you can vary your server-side logic for mobiles or optimize your markup for the desired, device-specific layout.</span></span>
    - <span data-ttu-id="432fe-166">**Ventaja:** Uso eficaz del ancho de banda.</span><span class="sxs-lookup"><span data-stu-id="432fe-166">**Advantage:** Efficient bandwidth use.</span></span> <span data-ttu-id="432fe-167">Solo necesita transmitir el marcado y la información de estilo que se va a usar el dispositivo de destino.</span><span class="sxs-lookup"><span data-stu-id="432fe-167">You only need to transmit the markup and styling information that the target device is going to use.</span></span>
    - <span data-ttu-id="432fe-168">**Desventaja:** A veces, fuerza la repetición de código o el esfuerzo (p. ej., que puede crear copias similares pero ligeramente distintos de las páginas de formularios Web Forms o las vistas de MVC).</span><span class="sxs-lookup"><span data-stu-id="432fe-168">**Disadvantage:** Sometimes forces repetition of effort or code (e.g., making you create similar but slightly different copies of your Web Forms pages or MVC views).</span></span> <span data-ttu-id="432fe-169">Donde sea posible que separará lógica común en una capa subyacente o servicio, pero aún así, algunas partes del código de interfaz de usuario o de marcado que tenga que se duplican y, a continuación, se mantienen en paralelo.</span><span class="sxs-lookup"><span data-stu-id="432fe-169">Where possible you will factor out common logic into an underlying layer or service, but still, some parts of your UI code or markup may have to be duplicated and then maintained in parallel.</span></span>
    - <span data-ttu-id="432fe-170">**Desventaja:** Detección de dispositivos no es trivial.</span><span class="sxs-lookup"><span data-stu-id="432fe-170">**Disadvantage:** Device detection is not trivial.</span></span> <span data-ttu-id="432fe-171">Se requiere una lista o una base de datos de tipos de dispositivos conocidos y sus características (que no sea siempre actualizadas perfectamente) y no está garantizado que coincidan exactamente con todas las solicitudes entrantes.</span><span class="sxs-lookup"><span data-stu-id="432fe-171">It requires a list or database of known device types and their characteristics (which may not always be perfectly up-to-date) and isn't guaranteed to accurately match every incoming request.</span></span> <span data-ttu-id="432fe-172">Este documento describe algunas opciones y sus riesgos más adelante.</span><span class="sxs-lookup"><span data-stu-id="432fe-172">This document describes some options and their pitfalls later.</span></span>

<span data-ttu-id="432fe-173">Para obtener los mejores resultados, la mayoría de los desarrolladores encontrar que necesitan para combinar las opciones de (2) y (3).</span><span class="sxs-lookup"><span data-stu-id="432fe-173">To get the best results, most developers find they need to combine options (2) and (3).</span></span> <span data-ttu-id="432fe-174">Diferencias menores de estilo se implementan mejor en el cliente mediante CSS o JavaScript incluso, mientras que las diferencias más importantes en los datos, el flujo de trabajo o el marcado se implementan la forma más eficaz en el código del lado servidor.</span><span class="sxs-lookup"><span data-stu-id="432fe-174">Minor stylistic differences are best accommodated on the client using CSS or even JavaScript, whereas major differences in data, workflow, or markup are most effectively implemented in server-side code.</span></span>

### <a name="this-paper-focuses-on-server-side-techniques"></a><span data-ttu-id="432fe-175">Este documento se centra en técnicas de servidor</span><span class="sxs-lookup"><span data-stu-id="432fe-175">This paper focuses on server-side techniques</span></span>

<span data-ttu-id="432fe-176">Puesto que ASP.NET Web Forms y MVC son ambas tecnologías principalmente en el servidor, en este artículo se centrará en las técnicas de servidor que le permiten generar marcado diferente y la lógica para los exploradores móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-176">Since ASP.NET Web Forms and MVC are both primarily server-side technologies, this white paper will focus on server-side techniques that let you produce different markup and logic for mobile browsers.</span></span> <span data-ttu-id="432fe-177">Por supuesto, también se puede combinar con cualquier técnica de lado cliente (p. ej., CSS 3 las consultas de medios, mejora progresiva de JavaScript), pero es más una cuestión de diseño web de desarrollo de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="432fe-177">Of course, you can also combine this with any client-side technique (e.g., CSS 3 media queries, progressive-enhancement JavaScript), but that's more a matter of web design than ASP.NET development.</span></span>

## <a name="browser-and-device-detection"></a><span data-ttu-id="432fe-178">Detección de explorador y del dispositivo</span><span class="sxs-lookup"><span data-stu-id="432fe-178">Browser and device detection</span></span>

<span data-ttu-id="432fe-179">El requisito previo de claves para todas las técnicas de lado servidor para admitir dispositivos móviles es saber qué dispositivo usa el visitante.</span><span class="sxs-lookup"><span data-stu-id="432fe-179">The key prerequisite for all server-side techniques for supporting mobile devices is to know what device your visitor is using.</span></span> <span data-ttu-id="432fe-180">De hecho, aún mejor que saber el número de fabricante y modelo del dispositivo es saber el *características* del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="432fe-180">In fact, even better than knowing the manufacturer and model number of that device is knowing the *characteristics* of the device.</span></span> <span data-ttu-id="432fe-181">Pueden incluir características:</span><span class="sxs-lookup"><span data-stu-id="432fe-181">Characteristics may include:</span></span>

- <span data-ttu-id="432fe-182">¿Es un dispositivo móvil?</span><span class="sxs-lookup"><span data-stu-id="432fe-182">Is it a mobile device?</span></span>
- <span data-ttu-id="432fe-183">Método de entrada (mouse/teclado, táctil, teclado, un joystick,...)</span><span class="sxs-lookup"><span data-stu-id="432fe-183">Input method (mouse/keyboard, touch, keypad, joystick, …)</span></span>
- <span data-ttu-id="432fe-184">Tamaño de pantalla (físicamente y en píxeles)</span><span class="sxs-lookup"><span data-stu-id="432fe-184">Screen size (physically and in pixels)</span></span>
- <span data-ttu-id="432fe-185">Formatos admitidos de medios y datos</span><span class="sxs-lookup"><span data-stu-id="432fe-185">Supported media and data formats</span></span>
- <span data-ttu-id="432fe-186">Etc.</span><span class="sxs-lookup"><span data-stu-id="432fe-186">Etc.</span></span>

<span data-ttu-id="432fe-187">Es mejor tomar decisiones basadas en las características que el número de modelo, ya que, a continuación, estará equipado mejor para controlar futuros dispositivos.</span><span class="sxs-lookup"><span data-stu-id="432fe-187">It's better to make decisions based on characteristics than model number, because then you'll be better equipped to handle future devices.</span></span>

### <a name="using-aspnets-built-in-browser-detection-support"></a><span data-ttu-id="432fe-188">Uso de ASP. Compatibilidad con detección de explorador integrado de la red</span><span class="sxs-lookup"><span data-stu-id="432fe-188">Using ASP.NET's built-in browser detection support</span></span>

<span data-ttu-id="432fe-189">Los desarrolladores de ASP.NET Web Forms y MVC inmediatamente pueden detectar características importantes de un explorador visita inspeccionando las propiedades de la *Request.Browser* objeto.</span><span class="sxs-lookup"><span data-stu-id="432fe-189">ASP.NET Web Forms and MVC developers can immediately discover important characteristics of a visiting browser by inspecting properties of the *Request.Browser* object.</span></span> <span data-ttu-id="432fe-190">Por ejemplo, vea</span><span class="sxs-lookup"><span data-stu-id="432fe-190">For example, see</span></span>

- <span data-ttu-id="432fe-191">Request.Browser.IsMobileDevice</span><span class="sxs-lookup"><span data-stu-id="432fe-191">Request.Browser.IsMobileDevice</span></span>
- <span data-ttu-id="432fe-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span><span class="sxs-lookup"><span data-stu-id="432fe-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span></span>
- <span data-ttu-id="432fe-193">Request.Browser.ScreenPixelsWidth</span><span class="sxs-lookup"><span data-stu-id="432fe-193">Request.Browser.ScreenPixelsWidth</span></span>
- <span data-ttu-id="432fe-194">Request.Browser.SupportsXmlHttp</span><span class="sxs-lookup"><span data-stu-id="432fe-194">Request.Browser.SupportsXmlHttp</span></span>
- <span data-ttu-id="432fe-195">...y muchos otros</span><span class="sxs-lookup"><span data-stu-id="432fe-195">…and many others</span></span>

<span data-ttu-id="432fe-196">En segundo plano, la plataforma ASP.NET coincide con la entrada *User-Agent* encabezado HTTP (UA) con expresiones regulares en un conjunto de archivos XML de definición de explorador.</span><span class="sxs-lookup"><span data-stu-id="432fe-196">Behind the scenes, the ASP.NET platform matches the incoming *User-Agent* (UA) HTTP header against regular expressions in a set of Browser Definition XML files.</span></span> <span data-ttu-id="432fe-197">De forma predeterminada, la plataforma incluye las definiciones para varios dispositivos móviles comunes, y puede agregar archivos de definición de explorador personalizados para que otros usuarios que quieran reconocer.</span><span class="sxs-lookup"><span data-stu-id="432fe-197">By default the platform includes definitions for many common mobile devices, and you can add custom Browser Definition files for others you wish to recognize.</span></span> <span data-ttu-id="432fe-198">Para obtener más información, vea la página MSDN [controles de servidor Web de ASP.NET y las capacidades del explorador](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span><span class="sxs-lookup"><span data-stu-id="432fe-198">For more details, see the MSDN page [ASP.NET Web Server Controls and Browser Capabilities](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span></span>

### <a name="using-the-wurfl-device-database-via-51degreesmobi-foundation"></a><span data-ttu-id="432fe-199">Uso de la base de datos del dispositivo WURFL a través de 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="432fe-199">Using the WURFL device database via 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="432fe-200">Mientras que ASP. Compatibilidad con detección de explorador integrado de la red será suficiente para muchas aplicaciones, hay dos casos principales es posible que no sea suficiente:</span><span class="sxs-lookup"><span data-stu-id="432fe-200">While ASP.NET's built-in browser detection support will be sufficient for many applications, there are two main cases when it might not be enough:</span></span>

- <span data-ttu-id="432fe-201">***Desea reconocer los últimos dispositivos***(sin necesidad de crear manualmente los archivos de definición de explorador para ellos).</span><span class="sxs-lookup"><span data-stu-id="432fe-201">***You want to recognize the latest devices***(without manually creating Browser Definition files for them).</span></span> <span data-ttu-id="432fe-202">Tenga en cuenta que los archivos de definición de explorador del 4 de .NET no son lo suficientemente recientes como para reconocer los iPad de Apple, teléfonos Android, exploradores de Opera Mobile o Windows Phone 7.</span><span class="sxs-lookup"><span data-stu-id="432fe-202">Note that .NET 4's Browser Definition files are not recent enough to recognize Windows Phone 7, Android phones, Opera Mobile browsers, or Apple iPads.</span></span>
- <span data-ttu-id="432fe-203">***Necesita información más detallada sobre las capacidades de dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="432fe-203">***You need more detailed information about device capabilities***.</span></span> <span data-ttu-id="432fe-204">Es posible que deba saber sobre el método de entrada de un dispositivo (por ejemplo, el teclado de vs táctil) o qué audio formatea el explorador admite.</span><span class="sxs-lookup"><span data-stu-id="432fe-204">You may need to know about a device's input method (e.g., touch vs keypad), or what audio formats the browser supports.</span></span> <span data-ttu-id="432fe-205">Esta información no está disponible en los archivos de definición de explorador estándar.</span><span class="sxs-lookup"><span data-stu-id="432fe-205">This information isn't available in the standard Browser Definition files.</span></span>

<span data-ttu-id="432fe-206">El [ *Wireless Universal Resource File* proyecto (WURFL)](http://wurfl.sourceforge.net/) mantiene mucho más detallada y actualizada información acerca de los dispositivos móviles en uso hoy en día.</span><span class="sxs-lookup"><span data-stu-id="432fe-206">The [*Wireless Universal Resource File* (WURFL) project](http://wurfl.sourceforge.net/) maintains much more up-to-date and detailed information about mobile devices in use today.</span></span>

<span data-ttu-id="432fe-207">La buena noticia para los desarrolladores de .NET es que ASP. Característica de detección de explorador de la red es extensible, por lo que es posible mejorarlo para solucionar estos problemas.</span><span class="sxs-lookup"><span data-stu-id="432fe-207">The great news for .NET developers is that ASP.NET's browser detection feature is extensible, so it's possible to enhance it to overcome these problems.</span></span> <span data-ttu-id="432fe-208">Por ejemplo, puede agregar el código abierto [ *51Degrees.mobi Foundation* ](https://github.com/51Degrees/dotNET-Device-Detection) biblioteca al proyecto.</span><span class="sxs-lookup"><span data-stu-id="432fe-208">For example, you can add the open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) library to your project.</span></span> <span data-ttu-id="432fe-209">Es un IHttpModule de ASP.NET o un explorador capacidades de proveedor (se puede utilizar en aplicaciones de formularios Web Forms y MVC), que lee los datos WURFL y lo enlaza a ASP directamente. Mecanismo de detección de explorador integrado de la red.</span><span class="sxs-lookup"><span data-stu-id="432fe-209">It's an ASP.NET IHttpModule or Browser Capabilities Provider (usable on both Web Forms and MVC applications), that directly reads WURFL data and hooks it into ASP.NET's built-in browser detection mechanism.</span></span> <span data-ttu-id="432fe-210">Una vez haya instalado el módulo, *Request.Browser* repentinamente contendrá información mucho más precisa y detallada: lo reconocerá muchos de los dispositivos que se ha mencionado anteriormente y enumerar sus capacidades (incluido correctamente funcionalidades adicionales como método de entrada).</span><span class="sxs-lookup"><span data-stu-id="432fe-210">Once you've installed the module, *Request.Browser* will suddenly contain a lot more accurate and detailed information: it will correctly recognize many of the devices previously mentioned and list their capabilities (including additional capabilities such as input method).</span></span> <span data-ttu-id="432fe-211">Consulte la documentación del proyecto para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="432fe-211">See the project's documentation for more details.</span></span>

## <a name="how-web-forms-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="432fe-212">Cómo las aplicaciones de formularios Web Forms pueden presentar páginas específicas de dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-212">How Web Forms applications can present mobile-specific pages</span></span>

<span data-ttu-id="432fe-213">De forma predeterminada, presentamos cómo se muestra una nueva aplicación de formularios Web Forms en dispositivos móviles comunes:</span><span class="sxs-lookup"><span data-stu-id="432fe-213">By default, here's how a brand new Web Forms application displays on common mobile devices:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image1.png)

<span data-ttu-id="432fe-214">Claramente, ni el diseño es apta para móviles muy: esta página se diseñó para un monitor grande, orientado a horizontal, no para una pantalla pequeña orientación vertical.</span><span class="sxs-lookup"><span data-stu-id="432fe-214">Clearly, neither layout looks very mobile-friendly – this page was designed for a large, landscape-oriented monitor, not for a small portrait-oriented screen.</span></span> <span data-ttu-id="432fe-215">Así que ¿qué puede hacer al respecto?</span><span class="sxs-lookup"><span data-stu-id="432fe-215">So what can you do about it?</span></span>

<span data-ttu-id="432fe-216">Como se explicó anteriormente en este artículo, hay muchas maneras de personalizar las páginas para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-216">As discussed earlier in this paper, there are many ways to tailor your pages for mobile devices.</span></span> <span data-ttu-id="432fe-217">Algunas técnicas están basadas en servidor, otros se ejecutan en el cliente.</span><span class="sxs-lookup"><span data-stu-id="432fe-217">Some techniques are server-based, others run on the client.</span></span>

### <a name="creating-a-mobile-specific-master-page"></a><span data-ttu-id="432fe-218">Creación de una página maestra específica móvil</span><span class="sxs-lookup"><span data-stu-id="432fe-218">Creating a mobile-specific master page</span></span>

<span data-ttu-id="432fe-219">Según sus requisitos, puede usar los mismos formularios Web para todos los visitantes, pero tiene dos páginas maestra independientes: uno para los visitantes del escritorio, otro para los visitantes en dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-219">Depending on your requirements, you may be able to use the same Web Forms for all visitors, but have two separate master pages: one for desktop visitors, another for mobile visitors.</span></span> <span data-ttu-id="432fe-220">Esto ofrece la flexibilidad de cambiar el nivel superior marcado HTML para adaptarlo a dispositivos móviles, sin que sea necesario duplicar cualquier lógica de página o la hoja de estilos CSS.</span><span class="sxs-lookup"><span data-stu-id="432fe-220">This gives you the flexibility of changing the CSS stylesheet or your top-level HTML markup to suit mobile devices, without forcing you to duplicate any page logic.</span></span>

<span data-ttu-id="432fe-221">Esto es fácil de hacer.</span><span class="sxs-lookup"><span data-stu-id="432fe-221">This is easy to do.</span></span> <span data-ttu-id="432fe-222">Por ejemplo, puede agregar un controlador de PreInit como el siguiente a un formulario Web Forms:</span><span class="sxs-lookup"><span data-stu-id="432fe-222">For example, you can add a PreInit handler such as the following to a Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample1.cs)]

<span data-ttu-id="432fe-223">Ahora, cree una página maestra denominada Mobile.Master en la carpeta de nivel superior de la aplicación y se usará cuando se detecta un dispositivo móvil.</span><span class="sxs-lookup"><span data-stu-id="432fe-223">Now, create a master page called Mobile.Master in the top-level folder of your application, and it will be used when a mobile device is detected.</span></span> <span data-ttu-id="432fe-224">La página maestra móvil puede hacer referencia a una hoja de estilos CSS específicas de dispositivos móviles si es necesario.</span><span class="sxs-lookup"><span data-stu-id="432fe-224">Your mobile master page can reference a mobile-specific CSS stylesheet if necessary.</span></span> <span data-ttu-id="432fe-225">Los visitantes escritorio seguirán viendo la página maestra predeterminada, no lo móvil.</span><span class="sxs-lookup"><span data-stu-id="432fe-225">Desktop visitors will still see your default master page, not the mobile one.</span></span>

### <a name="creating-independent-mobile-specific-web-forms"></a><span data-ttu-id="432fe-226">Creación de independiente de formularios Web Forms específicas de dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-226">Creating independent mobile-specific Web Forms</span></span>

<span data-ttu-id="432fe-227">Para obtener la máxima flexibilidad, puede ir mucho más allá de simplemente tener páginas maestras independientes para distintos tipos de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="432fe-227">For maximum flexibility, you can go much further than just having separate master pages for different device types.</span></span> <span data-ttu-id="432fe-228">Puede implementar dos *totalmente independientes conjuntos de páginas de formularios Web Forms* : uno establecido para los exploradores de escritorio, otro conjunto para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-228">You can implement two *totally separate sets of Web Forms pages* – one set for desktop browsers, another set for mobiles.</span></span> <span data-ttu-id="432fe-229">Esto funciona mejor si desea presentar información muy diferente o flujos de trabajo a los visitantes en dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-229">This works best if you want to present very different information or workflows to mobile visitors.</span></span> <span data-ttu-id="432fe-230">El resto de esta sección describe este enfoque en detalle.</span><span class="sxs-lookup"><span data-stu-id="432fe-230">The rest of this section describes this approach in detail.</span></span>

<span data-ttu-id="432fe-231">Suponiendo que ya tiene una aplicación de formularios Web Forms diseñada para los exploradores de escritorio, la manera más fácil para continuar es crear una subcarpeta denominada "Mobile" dentro del proyecto y compilar las páginas móviles no existe.</span><span class="sxs-lookup"><span data-stu-id="432fe-231">Assuming you already have a Web Forms application designed for desktop browsers, the easiest way to proceed is to create a subfolder called "Mobile" within your project, and build your mobile pages there.</span></span> <span data-ttu-id="432fe-232">Puede crear todo un sitio secundario, con sus propias páginas maestras, las hojas de estilo y páginas, utilizando las mismas técnicas que usaría para cualquier otra aplicación de formularios Web Forms.</span><span class="sxs-lookup"><span data-stu-id="432fe-232">You can construct an entire sub-site, with its own master pages, style sheets, and pages, using all the same techniques that you'd use for any other Web Forms application.</span></span> <span data-ttu-id="432fe-233">No es necesario generar un equivalente para móviles *cada* página en el sitio de escritorio; puede elegir qué subconjunto de funcionalidad que tiene sentido para los visitantes en dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-233">You don't necessarily need to produce a mobile equivalent for *every* page in your desktop site; you can choose what subset of functionality makes sense for mobile visitors.</span></span>

<span data-ttu-id="432fe-234">Las páginas móviles pueden compartir recursos estáticos comunes (como imágenes, JavaScript o CSS archivos) con sus páginas normales si lo desea.</span><span class="sxs-lookup"><span data-stu-id="432fe-234">Your mobile pages can share common static resources (such as images, JavaScript, or CSS files) with your regular pages if you wish.</span></span> <span data-ttu-id="432fe-235">Puesto que la carpeta "Mobile" le *no* marcarse como una aplicación independiente cuando se hospeda en IIS (es simplemente una subcarpeta simple de páginas de formularios Web Forms), también compartirán las mismas configuración, los datos de sesión y otras infraestructuras como su páginas del escritorio.</span><span class="sxs-lookup"><span data-stu-id="432fe-235">Since your "Mobile" folder will *not* be marked as a separate application when hosted in IIS (it's just a simple subfolder of Web Forms pages), it will also share all the same configuration, Session data, and other infrastructure as your desktop pages.</span></span>

> [!NOTE]
> <span data-ttu-id="432fe-236">Puesto que este enfoque implica normalmente algunas duplicaciones de código (las páginas móviles están probable que comparten algunas similitudes con páginas de escritorio), es importante el factor de cualquier negocio lógica o datos acceso código común en una capa subyacente compartida o un servicio.</span><span class="sxs-lookup"><span data-stu-id="432fe-236">Since this approach usually involves some duplication of code (mobile pages are likely to share some similarities with desktop pages), it's important to factor out any common business logic or data access code into a shared underlying layer or service.</span></span> <span data-ttu-id="432fe-237">En caso contrario, deberá doble el esfuerzo de crear y mantener la aplicación.</span><span class="sxs-lookup"><span data-stu-id="432fe-237">Otherwise, you'll double the effort of creating and maintaining your application.</span></span>

#### <a name="redirecting-mobile-visitors-to-your-mobile-pages"></a><span data-ttu-id="432fe-238">Redirigir visitantes en dispositivos móviles a las páginas móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-238">Redirecting mobile visitors to your mobile pages</span></span>

<span data-ttu-id="432fe-239">A menudo resulta conveniente redirigir los visitantes en dispositivos móviles a las páginas móviles sólo en el *primera* solicitar en su sesión de exploración (y no en todas las solicitudes en su sesión), porque:</span><span class="sxs-lookup"><span data-stu-id="432fe-239">It's often convenient to redirect mobile visitors to the mobile pages only on the *first* request in their browsing session (and not on every request in their session), because:</span></span>

- <span data-ttu-id="432fe-240">A continuación, puede permitir fácilmente visitantes en dispositivos móviles tener acceso a las páginas de escritorio si lo desean, simplemente poner un vínculo en la página maestra que se va a "Versión de escritorio".</span><span class="sxs-lookup"><span data-stu-id="432fe-240">You can then easily allow mobile visitors to access your desktop pages if they wish – just put a link on your master page that goes to "Desktop version".</span></span> <span data-ttu-id="432fe-241">El visitante no pueden redirigir a una página móvil, porque ya no es la primera solicitud en su sesión.</span><span class="sxs-lookup"><span data-stu-id="432fe-241">The visitor won't be redirected back to a mobile page, because it's no longer the first request in their session.</span></span>
- <span data-ttu-id="432fe-242">Evita el riesgo de interferir con las solicitudes de los recursos dinámicos compartidos entre las partes de escritorio y móviles de su sitio (por ejemplo, si tiene un formulario Web comunes que se muestran las partes móviles y de escritorio de su sitio en un IFRAME, así como ciertos controladores de Ajax)</span><span class="sxs-lookup"><span data-stu-id="432fe-242">It avoids the risk of interfering with requests for any dynamic resources shared between desktop and mobile parts of your site (e.g., if you have a common Web Form that both desktop and mobile parts of your site display in an IFRAME, or certain Ajax handlers)</span></span>

<span data-ttu-id="432fe-243">Para ello, puede colocar la lógica de redirección en una **sesión\_iniciar** método.</span><span class="sxs-lookup"><span data-stu-id="432fe-243">To do this, you can place your redirection logic in a **Session\_Start** method.</span></span> <span data-ttu-id="432fe-244">Por ejemplo, agregue el método siguiente al archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="432fe-244">For example, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample2.cs)]

#### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="432fe-245">Configurar la autenticación de formularios para respetar las páginas móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-245">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="432fe-246">Tenga en cuenta que la autenticación de formularios hace determinadas suposiciones sobre dónde puede redirigir a los visitantes durante y después del proceso de autenticación:</span><span class="sxs-lookup"><span data-stu-id="432fe-246">Note that Forms Authentication makes certain assumptions about where it can redirect visitors during and after the authentication process:</span></span>

- <span data-ttu-id="432fe-247">Cuando un usuario necesita autenticarse, autenticación de formularios redirigirá a la página de inicio de sesión de escritorio, independientemente de si un usuario móvil o de escritorio (ya que solo tiene un concepto de *una* dirección URL de inicio de sesión).</span><span class="sxs-lookup"><span data-stu-id="432fe-247">When a user needs to be authenticated, Forms Authentication will redirect them to your desktop login page, regardless of whether they're a desktop or mobile user (because it only has a concept of *one* login URL).</span></span> <span data-ttu-id="432fe-248">Suponiendo que desea aplicar el estilo de la página de inicio de sesión móvil diferente, deberá mejorar su página de inicio de sesión de escritorio para que lo redirige a los usuarios móviles a una página de inicio de sesión móvil independiente.</span><span class="sxs-lookup"><span data-stu-id="432fe-248">Assuming you want to style your mobile login page differently, you need to enhance your desktop login page so that it redirects mobile users to a separate mobile login page.</span></span> <span data-ttu-id="432fe-249">Por ejemplo, agregue el código siguiente a su **desktop** código de página de inicio de sesión en segundo plano:</span><span class="sxs-lookup"><span data-stu-id="432fe-249">For example, add the following code to your **desktop** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample3.cs)]
- <span data-ttu-id="432fe-250">Después de que un usuario inicia sesión correctamente, la autenticación de formularios de forma predeterminada redirigirá a la página principal del escritorio (ya que solo tiene un concepto de *uno* página predeterminada).</span><span class="sxs-lookup"><span data-stu-id="432fe-250">After a user successfully logs in, Forms Authentication will by default redirect them to your desktop home page (because it only has a concept of *one* default page).</span></span> <span data-ttu-id="432fe-251">Necesario mejorar su página de inicio de sesión móvil para que lo redirige a la página principal de mobile después un registro correcto.</span><span class="sxs-lookup"><span data-stu-id="432fe-251">You need to enhance your mobile login page so that it redirects to the mobile home page after a successful log-in.</span></span> <span data-ttu-id="432fe-252">Por ejemplo, agregue el código siguiente a su **móvil** código de página de inicio de sesión en segundo plano:</span><span class="sxs-lookup"><span data-stu-id="432fe-252">For example, add the following code to your **mobile** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample4.cs)]
  
  <span data-ttu-id="432fe-253">Este código supone que la página tiene un control de servidor de inicio de sesión llamado LoginUser, como se muestra en la plantilla de proyecto predeterminada.</span><span class="sxs-lookup"><span data-stu-id="432fe-253">This code assumes your page has a Login server control called LoginUser, as in the default project template.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="432fe-254">Trabajar con la caché de resultados</span><span class="sxs-lookup"><span data-stu-id="432fe-254">Working with Output Caching</span></span>

<span data-ttu-id="432fe-255">Si usa la caché de resultados, tenga en cuenta que de forma predeterminada, es posible que un usuario de escritorio visitar una URL de determinadas (lo que su salida se almacene en caché), seguido por un usuario móvil que, a continuación, recibe el resultado de desktop almacenados en caché.</span><span class="sxs-lookup"><span data-stu-id="432fe-255">If you're using output caching, beware that by default it's possible for a desktop user to visit a certain URL (causing its output to be cached), followed by a mobile user who then receives the cached desktop output.</span></span> <span data-ttu-id="432fe-256">Esta advertencia se aplica si solo está variar la página maestra por tipo de dispositivo, o implementar totalmente separada formularios Web Forms por tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="432fe-256">This warning applies whether you're just varying your master page by device type, or implementing totally separate Web Forms per device type.</span></span>

<span data-ttu-id="432fe-257">Para evitar el problema, puede indicar a ASP.NET para modificar la entrada de caché según si el visitante usa un dispositivo móvil.</span><span class="sxs-lookup"><span data-stu-id="432fe-257">To avoid the problem, you can instruct ASP.NET to vary the cache entry according to whether the visitor is using a mobile device.</span></span> <span data-ttu-id="432fe-258">Agregue un parámetro VaryByCustom a la declaración de directiva OutputCache de la página de la manera siguiente:</span><span class="sxs-lookup"><span data-stu-id="432fe-258">Add a VaryByCustom parameter to your page's OutputCache declaration as follows:</span></span>

[!code-aspx[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample5.aspx)]

<span data-ttu-id="432fe-259">A continuación, defina *isMobileDevice* como una caché personalizada parámetro agregando el siguiente método reemplace al archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="432fe-259">Next, define *isMobileDevice* as a custom cache parameter by adding the following method override to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample6.cs)]

<span data-ttu-id="432fe-260">Esto garantizará que visitantes en dispositivos móviles a la página no reciben la salida guardado previamente en la memoria caché un visitante de escritorio.</span><span class="sxs-lookup"><span data-stu-id="432fe-260">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="432fe-261">Un ejemplo práctico</span><span class="sxs-lookup"><span data-stu-id="432fe-261">A working example</span></span>

<span data-ttu-id="432fe-262">Para ver estas técnicas en acción, descargue [ejemplos de código de este artículo técnico](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="432fe-262">To see these techniques in action, download [this white paper's code samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="432fe-263">La aplicación de ejemplo de formularios Web Forms redirige automáticamente a los usuarios móviles a un conjunto de páginas específicas de dispositivos móviles en una subcarpeta denominada Mobile.</span><span class="sxs-lookup"><span data-stu-id="432fe-263">The Web Forms sample application automatically redirects mobile users to a set of mobile-specific pages in a subfolder called Mobile.</span></span> <span data-ttu-id="432fe-264">El marcado y los estilos de dichas páginas mejor está optimizado para los exploradores móviles, como puede ver en las capturas de pantalla siguiente:</span><span class="sxs-lookup"><span data-stu-id="432fe-264">The markup and styling of those pages is better optimized for mobile browsers, as you can see from the following screenshots:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image2.png)

<span data-ttu-id="432fe-265">Para obtener más sugerencias sobre cómo optimizar su marcado y CSS para los exploradores móviles, consulte la sección "Estilos páginas móviles para los exploradores móviles" más adelante en este documento.</span><span class="sxs-lookup"><span data-stu-id="432fe-265">For more tips about optimizing your markup and CSS for mobile browsers, see the section "Styling mobile pages for mobile browsers" later in this document.</span></span>

## <a name="how-aspnet-mvc-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="432fe-266">Cómo las aplicaciones de ASP.NET MVC pueden presentar páginas específicas de dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-266">How ASP.NET MVC applications can present mobile-specific pages</span></span>

<span data-ttu-id="432fe-267">Puesto que el patrón Model-View-Controller separa la lógica de aplicación (en los controladores) desde la lógica de presentación (en las vistas), puede elegir desde cualquiera de los métodos siguientes para controlar la compatibilidad con dispositivos móvil en el código del lado servidor:</span><span class="sxs-lookup"><span data-stu-id="432fe-267">Since the Model-View-Controller pattern decouples application logic (in controllers) from presentation logic (in views), you can choose from any of the following approaches to handling mobile support in server-side code:</span></span>

1. <span data-ttu-id="432fe-268">***Usar los mismos controladores y vistas para los exploradores de escritorio y móviles, pero representan las vistas con distintos diseños de Razor según el tipo de dispositivo***</span><span class="sxs-lookup"><span data-stu-id="432fe-268">\***Use the same controllers and views for both desktop and mobile browsers, but render the views with different Razor layouts depending on the device type\*.**</span></span> <span data-ttu-id="432fe-269">Esta opción funciona mejor si están mostrando datos idénticos en todos los dispositivos, pero simplemente desea proporcionar distintas hojas de estilo CSS o cambiar algunos elementos de HTML de nivel superior para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-269">This option works best if you're displaying identical data on all devices, but simply want to supply different CSS stylesheets or change a few top-level HTML elements for mobiles.</span></span>
2. <span data-ttu-id="432fe-270">***Usar los mismos controladores para los exploradores de escritorio y móviles, pero presentar vistas distintas según el tipo de dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="432fe-270">***Use the same controllers for both desktop and mobile browsers, but render different views depending on the device type***.</span></span> <span data-ttu-id="432fe-271">Esta opción funciona mejor si está mostrando aproximadamente los mismos datos y proporcionar los mismos flujos de trabajo para los usuarios finales, pero desea presentar HTML muy diferente para satisfacer el dispositivo que se usa.</span><span class="sxs-lookup"><span data-stu-id="432fe-271">This option works best if you're displaying roughly the same data and providing the same workflows for end users, but want to render very different HTML markup to suit the device being used.</span></span>
3. <span data-ttu-id="432fe-272">***Crear áreas bien diferenciadas para los exploradores de escritorio y móviles, implementar vistas y controladores independientes para cada***</span><span class="sxs-lookup"><span data-stu-id="432fe-272">\***Create separate areas for desktop and mobile browsers, implementing independent controllers and views for each\*.**</span></span> <span data-ttu-id="432fe-273">Esta opción funciona mejor si mostrar pantallas muy diferentes, que contiene información diferente e iniciales al usuario a través de diferentes flujos de trabajo optimizado para su tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="432fe-273">This option works best if you're displaying very different screens, containing different information and leading the user through different workflows optimized for their device type.</span></span> <span data-ttu-id="432fe-274">Significa que es posible que algunos repetición de código, pero puede minimizar esto mediante la exclusión lógica común en una capa o de servicio subyacente.</span><span class="sxs-lookup"><span data-stu-id="432fe-274">It may mean some repetition of code, but you can minimize that by factoring out common logic into an underlying layer or service.</span></span>

<span data-ttu-id="432fe-275">Si desea aprovechar el **primera** opción y variar solo el diseño de Razor por tipo de dispositivo, es muy fácil.</span><span class="sxs-lookup"><span data-stu-id="432fe-275">If you want to take the **first** option and vary only the Razor layout per device type, it's very easy.</span></span> <span data-ttu-id="432fe-276">Solo tiene que modificar su \_ViewStart.cshtml archivo como sigue:</span><span class="sxs-lookup"><span data-stu-id="432fe-276">Just modify your \_ViewStart.cshtml file as follows:</span></span>

[!code-cshtml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample7.cshtml)]

<span data-ttu-id="432fe-277">Ahora puede crear un diseño específico de dispositivos móviles denominado \_LayoutMobile.cshtml con una estructura de la página y CSS reglas optimizados para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-277">Now you can create a mobile-specific layout called \_LayoutMobile.cshtml with a page structure and CSS rules optimized for mobile devices.</span></span>

<span data-ttu-id="432fe-278">Si desea aprovechar el **segundo** opción render vistas totalmente diferente según el tipo de dispositivo del visitante, consulte [entrada de blog de Scott Hanselman](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span><span class="sxs-lookup"><span data-stu-id="432fe-278">If you want to take the **second** option render totally different views according to the visitor's device type, see [Scott Hanselman's blog post](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span></span>

<span data-ttu-id="432fe-279">El resto de este artículo se centra en la **tercer** opción – Crear controladores independientes *y* vistas para dispositivos móviles: para que pueda controlar exactamente qué subconjunto de funcionalidad se ofrece para los visitantes en dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-279">The rest of this paper focuses on the **third** option – creating separate controllers *and* views for mobile devices – so you can control exactly what subset of functionality is offered for mobile visitors.</span></span>

### <a name="setting-up-a-mobile-area-within-your-aspnet-mvc-application"></a><span data-ttu-id="432fe-280">Configurar un área dentro de la aplicación de MVC de ASP.NET Mobile</span><span class="sxs-lookup"><span data-stu-id="432fe-280">Setting up a Mobile area within your ASP.NET MVC application</span></span>

<span data-ttu-id="432fe-281">Puede agregar un área denominada "Mobile" a una aplicación ASP.NET MVC existente de la manera normal: haga doble clic en el nombre del proyecto en el Explorador de soluciones, a continuación, elija Agregar à área.</span><span class="sxs-lookup"><span data-stu-id="432fe-281">You can add an area called "Mobile" to an existing ASP.NET MVC application in the normal way: right-click on your project name in Solution Explorer, then choose Add à Area.</span></span> <span data-ttu-id="432fe-282">A continuación, puede agregar controladores y vistas como lo haría para cualquier otra área dentro de una aplicación ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="432fe-282">You can then add controllers and views as you would for any other area within an ASP.NET MVC application.</span></span> <span data-ttu-id="432fe-283">Por ejemplo, agregar a su área móvil un nuevo controlador denominado HomeController para que actúe como una página de inicio para los visitantes en dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-283">For example, add to your Mobile area a new controller called HomeController to act as a homepage for mobile visitors.</span></span>

### <a name="ensuring-the-url-mobile-reaches-the-mobile-homepage"></a><span data-ttu-id="432fe-284">Lo que garantiza la dirección URL de /Mobile llega a la página principal de móvil</span><span class="sxs-lookup"><span data-stu-id="432fe-284">Ensuring the URL /Mobile reaches the mobile homepage</span></span>

<span data-ttu-id="432fe-285">Si desea que la dirección URL /Mobile para llegar a la acción Index en HomeController dentro de su área móvil, deberá realizar dos pequeños cambios en la configuración de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="432fe-285">If you want the URL /Mobile to reach the Index action on HomeController inside your Mobile area, you will need to make two small changes to your routing configuration.</span></span> <span data-ttu-id="432fe-286">En primer lugar, actualice la clase MobileAreaRegistration para que el HomeController es el controlador predeterminado en el área móvil, tal como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="432fe-286">First, update your MobileAreaRegistration class so that HomeController is the default controller in your Mobile area, as shown in the following code:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample8.cs)]

<span data-ttu-id="432fe-287">Esto significa que la página principal de móvil ahora se ubicarán en /Mobile en lugar de/Mobile/Home, porque "Hogar" es ahora el implícitamente nombre de controlador de forma predeterminada para las páginas móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-287">This means the mobile homepage will now be located at /Mobile, rather than /Mobile/Home, because "Home" is now the implicitly default controller name for mobile pages.</span></span>

<span data-ttu-id="432fe-288">A continuación, tenga en cuenta que al agregar un segundo HomeController a su aplicación (es decir, la móviles, además de escritorio uno existente), habrá divide la página principal de escritorio normal.</span><span class="sxs-lookup"><span data-stu-id="432fe-288">Next, note that by adding a second HomeController to your application (i.e., the mobile one, in addition to the existing desktop one), you'll have broken your regular desktop homepage.</span></span> <span data-ttu-id="432fe-289">Se producirá un error con el error "*se encontraron varios tipos que coinciden con el controlador denominado 'Inicio'* ".</span><span class="sxs-lookup"><span data-stu-id="432fe-289">It will fail with the error "*Multiple types were found that match the controller named 'Home'*".</span></span> <span data-ttu-id="432fe-290">Para resolver este problema, actualice la configuración de enrutamiento de nivel superior (de Global.asax.cs) para especificar que el HomeController escritorio debería tener prioridad cuando hay ambigüedad:</span><span class="sxs-lookup"><span data-stu-id="432fe-290">To resolve this, update your top-level routing configuration (in Global.asax.cs) to specify that your desktop HomeController should take priority when there's ambiguity:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample9.cs)]

<span data-ttu-id="432fe-291">Ahora el error irá ubicación y la dirección URL http:\/\/*suSitio*/ llegará a la página principal de escritorio y http:\/\/*suSitio*le /mobile/ llegue a la página principal de dispositivos móvil.</span><span class="sxs-lookup"><span data-stu-id="432fe-291">Now the error will go away, and the URL http:\/\/*yoursite*/ will reach the desktop homepage, and http:\/\/*yoursite*/mobile/ will reach the mobile homepage.</span></span>

### <a name="redirecting-mobile-visitors-to-your-mobile-area"></a><span data-ttu-id="432fe-292">Redirigir visitantes en dispositivos móviles a su área móvil</span><span class="sxs-lookup"><span data-stu-id="432fe-292">Redirecting mobile visitors to your mobile area</span></span>

<span data-ttu-id="432fe-293">Hay muchas diferentes puntos de extensibilidad de ASP.NET MVC, por lo que hay muchas maneras posibles para inyectar lógica de redirección.</span><span class="sxs-lookup"><span data-stu-id="432fe-293">There are many different extensibility points in ASP.NET MVC, so there are many possible ways to inject redirection logic.</span></span> <span data-ttu-id="432fe-294">Es una opción clara crear un atributo de filtro, [RedirectMobileDevicesToMobileArea], que realiza un redireccionamiento si se cumplen las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="432fe-294">One neat option is to create a filter attribute, [RedirectMobileDevicesToMobileArea], that performs a redirection if the following conditions are met:</span></span>

1. <span data-ttu-id="432fe-295">Es la primera solicitud en la sesión del usuario (es decir, Session.IsNewSession es igual a true)</span><span class="sxs-lookup"><span data-stu-id="432fe-295">It's the first request in the user's session (i.e., Session.IsNewSession equals true)</span></span>
2. <span data-ttu-id="432fe-296">La solicitud procede de un explorador móvil (es decir, Request.Browser.IsMobileDevice es igual a true)</span><span class="sxs-lookup"><span data-stu-id="432fe-296">The request comes from a mobile browser (i.e., Request.Browser.IsMobileDevice equals true)</span></span>
3. <span data-ttu-id="432fe-297">El usuario ya no solicita un recurso en el área móvil (es decir, el *ruta* parte de la dirección URL no empieza por /Mobile)</span><span class="sxs-lookup"><span data-stu-id="432fe-297">The user is not already requesting a resource in the mobile area (i.e., the *path* part of the URL does not begin with /Mobile)</span></span>

<span data-ttu-id="432fe-298">El ejemplo descargable incluido en este artículo incluye una implementación de esta lógica.</span><span class="sxs-lookup"><span data-stu-id="432fe-298">The downloadable sample included with this white paper includes an implementation of this logic.</span></span> <span data-ttu-id="432fe-299">Se implementa como un filtro de autorización, derivado de AuthorizeAttribute, lo que significa que pueda funcionar correctamente, incluso si está utilizando el almacenamiento en caché de salida (en caso contrario, si un visitante escritorio primera accesos a una URL determinada, el resultado de desktop podrían almacenarse en caché y, después, atiende a posteriores visitantes en dispositivos móviles).</span><span class="sxs-lookup"><span data-stu-id="432fe-299">It's implemented as an authorization filter, derived from AuthorizeAttribute, which means it can work correctly even if you are using output caching (otherwise, if a desktop visitor first accesses a certain URL, the desktop output might be cached and then served to subsequent mobile visitors).</span></span>

<span data-ttu-id="432fe-300">Ya que es un filtro, puede elegir uno de ellos para aplicarla a determinados controladores y acciones, por ejemplo,</span><span class="sxs-lookup"><span data-stu-id="432fe-300">As it's a filter, you can choose either to apply it to specific controllers and actions, e.g.,</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample10.cs)]

<span data-ttu-id="432fe-301">…</span><span class="sxs-lookup"><span data-stu-id="432fe-301">…</span></span> <span data-ttu-id="432fe-302">o puede aplicarla a todos los controladores y acciones como un MVC 3 *filtros globales* en el archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="432fe-302">or you can apply it to all controllers and actions as an MVC 3 *global filter* in your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample11.cs)]

<span data-ttu-id="432fe-303">El ejemplo descargable también muestra cómo puede crear subclases de este atributo que redireccionan a ubicaciones específicas dentro de su área móvil.</span><span class="sxs-lookup"><span data-stu-id="432fe-303">The downloadable sample also demonstrates how you can create subclasses of this attribute that redirect to specific locations within your mobile area.</span></span> <span data-ttu-id="432fe-304">Esto significa, por ejemplo, que puede:</span><span class="sxs-lookup"><span data-stu-id="432fe-304">This means, for example, you can:</span></span>

- <span data-ttu-id="432fe-305">Registrar un filtro global tal como se muestra arriba que envía los visitantes en dispositivos móviles a la página principal móvil de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="432fe-305">Register a global filter as shown above that sends mobile visitors to the mobile homepage by default.</span></span>
- <span data-ttu-id="432fe-306">También aplicar un filtro de [RedirectMobileDevicesToMobileProductPage] especial a una acción de "ver el producto" que toma los visitantes en dispositivos móviles a la versión móvil de cualquier página del producto que lo haya solicitado.</span><span class="sxs-lookup"><span data-stu-id="432fe-306">Also apply a special [RedirectMobileDevicesToMobileProductPage] filter to a "view product" action that takes mobile visitors to the mobile version of whatever product page they had requested.</span></span>
- <span data-ttu-id="432fe-307">También se aplican otras subclases del filtro especiales para realizar determinadas acciones, redirigiendo a la página móvil equivalente visitantes en dispositivos móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-307">Also apply other special subclasses of the filter to specific actions, redirecting mobile visitors to the equivalent mobile page</span></span>

### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="432fe-308">Configurar la autenticación de formularios para respetar las páginas móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-308">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="432fe-309">Si usa la autenticación de formularios, debe tener en cuenta que cuando un usuario necesita iniciar sesión, redirige automáticamente al usuario a una sola "iniciar sesión" dirección URL específica, cuyo valor predeterminado es **/cuenta/inicio de sesión**.</span><span class="sxs-lookup"><span data-stu-id="432fe-309">If you're using Forms Authentication, you should note that when a user needs to log in, it automatically redirects the user to a single specific "log on" URL, which by default is **/Account/LogOn**.</span></span> <span data-ttu-id="432fe-310">Esto significa que los usuarios móviles que se le redirija a la acción escritorio "iniciar sesión".</span><span class="sxs-lookup"><span data-stu-id="432fe-310">This means that mobile users may be redirected to your desktop "log on" action.</span></span>

<span data-ttu-id="432fe-311">Para evitar este problema, agregue lógica a la acción "iniciar sesión" del escritorio para que los usuarios móviles redirige de nuevo a una acción "iniciar sesión" móviles.</span><span class="sxs-lookup"><span data-stu-id="432fe-311">To avoid this problem, add logic to your desktop "log on" action so that it redirects mobile users again to a mobile "log on" action.</span></span> <span data-ttu-id="432fe-312">Si usa la plantilla de aplicación de ASP.NET MVC predeterminada, actualizar acción de inicio de sesión de AccountController como sigue:</span><span class="sxs-lookup"><span data-stu-id="432fe-312">If you're using the default ASP.NET MVC application template, update AccountController's LogOn action as follows:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample12.cs)]

<span data-ttu-id="432fe-313">…</span><span class="sxs-lookup"><span data-stu-id="432fe-313">…</span></span> <span data-ttu-id="432fe-314">y, a continuación, implementar una acción de "iniciar sesión" específicas de dispositivos móviles adecuados en un controlador llamado AccountController en su área móvil.</span><span class="sxs-lookup"><span data-stu-id="432fe-314">and then implement a suitable mobile-specific "log on" action on a controller called AccountController in your Mobile area.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="432fe-315">Trabajar con la caché de resultados</span><span class="sxs-lookup"><span data-stu-id="432fe-315">Working with Output Caching</span></span>

<span data-ttu-id="432fe-316">Si usa el filtro [OutputCache], debe forzar la entrada de caché que varían según el tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="432fe-316">If you're using the [OutputCache] filter, you must force the cache entry to vary by device type.</span></span> <span data-ttu-id="432fe-317">Por ejemplo, escriba:</span><span class="sxs-lookup"><span data-stu-id="432fe-317">For example, write:</span></span>

[!code-javascript[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample13.js)]

<span data-ttu-id="432fe-318">A continuación, agregue el método siguiente al archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="432fe-318">Then, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample14.cs)]

<span data-ttu-id="432fe-319">Esto garantizará que visitantes en dispositivos móviles a la página no reciben la salida guardado previamente en la memoria caché un visitante de escritorio.</span><span class="sxs-lookup"><span data-stu-id="432fe-319">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="432fe-320">Un ejemplo práctico</span><span class="sxs-lookup"><span data-stu-id="432fe-320">A working example</span></span>

<span data-ttu-id="432fe-321">Para ver estas técnicas en acción, descargue [código de este artículo técnico asociado ejemplos](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="432fe-321">To see these techniques in action, download [this white paper's code associated samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="432fe-322">El ejemplo incluye una aplicación de ASP.NET MVC 3 (Release Candidate) ha mejorado para admitir dispositivos móviles mediante los métodos descritos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="432fe-322">The sample includes an ASP.NET MVC 3 (Release Candidate) application enhanced to support mobile devices using the methods described above.</span></span>

## <a name="further-guidance-and-suggestions"></a><span data-ttu-id="432fe-323">Más orientación y sugerencias</span><span class="sxs-lookup"><span data-stu-id="432fe-323">Further guidance and suggestions</span></span>

<span data-ttu-id="432fe-324">En la siguiente explicación se aplica tanto a los formularios Web Forms y los desarrolladores MVC que usan las técnicas descritas en este documento.</span><span class="sxs-lookup"><span data-stu-id="432fe-324">The following discussion applies both to Web Forms and MVC developers who are using the techniques covered in this document.</span></span>

### <a name="enhancing-your-redirection-logic-using-51degreesmobi-foundation"></a><span data-ttu-id="432fe-325">Mejorar su lógica de redirección mediante 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="432fe-325">Enhancing your redirection logic using 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="432fe-326">La lógica de redirección que se muestra en este documento puede ser suficiente para la aplicación, pero no funcionará si tiene que deshabilitar las sesiones, o con los exploradores móviles que rechazan las cookies (estos no tienen sesiones), ya que no sabrá si una solicitud determinada es la primera de ellas desde ese visitante.</span><span class="sxs-lookup"><span data-stu-id="432fe-326">The redirection logic shown in this document may be perfectly sufficient for your application, but it won't work if you need to disable sessions, or with mobile browsers that reject cookies (these can't have sessions), because it won't know whether a given request is the first one from that visitor.</span></span>

<span data-ttu-id="432fe-327">Ya ha aprendido cómo la base de código abierto 51Degrees.mobi puede mejorar la precisión de ASP. Detección de explorador de la red.</span><span class="sxs-lookup"><span data-stu-id="432fe-327">You already learned how the open source 51Degrees.mobi Foundation can improve the accuracy of ASP.NET's browser detection.</span></span> <span data-ttu-id="432fe-328">También tiene una capacidad integrada para redirigir los visitantes en dispositivos móviles a ubicaciones específicas configurados en el archivo Web.config. Es capaz de funcionar sin dependiendo de las sesiones ASP.NET (y, por tanto, las cookies) al almacenar un registro temporal de los valores hash de los encabezados HTTP y las direcciones IP de los visitantes, de modo que lo sepa si cada solicitud es la primera de ellas desde un visitante determinado.</span><span class="sxs-lookup"><span data-stu-id="432fe-328">It also has a built-in ability to redirect mobile visitors to specific locations configured in Web.config. It's able to work without depending on ASP.NET Sessions (and hence cookies) by storing a temporary log of hashes of visitors' HTTP headers and IP addresses, so it knows whether or not each request is the first one from a given vistor.</span></span>

<span data-ttu-id="432fe-329">El siguiente elemento agregado a la sección fiftyOne del archivo web.config redirigirá la primera solicitud desde un dispositivo móvil detectado a la página ~ / Mobile/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="432fe-329">The following element added to the fiftyOne section of the web.config file will redirect the first request from a detected mobile device to the page ~/Mobile/Default.aspx.</span></span> <span data-ttu-id="432fe-330">Las solicitudes de páginas bajo la carpeta móvil le *no* redirigirá, independientemente del tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="432fe-330">Any requests to pages under the Mobile folder will *not* be redirected, regardless of device type.</span></span> <span data-ttu-id="432fe-331">Si el dispositivo móvil ha estado inactivo durante un período de 20 minutos o más el dispositivo se olvidarán y las solicitudes posteriores se tratará como nuevos para los fines de redirección.</span><span class="sxs-lookup"><span data-stu-id="432fe-331">If the mobile device has been inactive for a period of 20 minutes or more the device will be forgotten and subsequent requests will be treated as new ones for the purposes of redirection.</span></span>

[!code-xml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample15.xml)]

<span data-ttu-id="432fe-332">Para obtener más información, consulte [51degrees.mobi documentación Foundation](https://github.com/51Degrees/dotNET-Device-Detection).</span><span class="sxs-lookup"><span data-stu-id="432fe-332">For more details, see [51degrees.mobi Foundation documentation](https://github.com/51Degrees/dotNET-Device-Detection).</span></span>

> [!NOTE]
> <span data-ttu-id="432fe-333">Le *puede* característica de redirección de la Fundación de 51Degrees.mobi de uso en aplicaciones de ASP.NET MVC, pero tendrá que definir la configuración de redirección en cuanto a direcciones URL sin formato, no en términos de los parámetros de enrutamiento o colocar filtros de MVC en acciones.</span><span class="sxs-lookup"><span data-stu-id="432fe-333">You *can* use 51Degrees.mobi Foundation's redirection feature on ASP.NET MVC applications, but you will need to define your redirection configuration in terms of plain URLs, not in terms of routing parameters or by putting MVC filters on actions.</span></span> <span data-ttu-id="432fe-334">Esto es porque (en el momento de redactar) 51Degrees.mobi Foundation no reconoce los filtros o enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="432fe-334">This is because (at the time of writing) 51Degrees.mobi Foundation does not recognize filters or routing.</span></span>

### <a name="disabling-transcoders-and-proxy-servers"></a><span data-ttu-id="432fe-335">Deshabilitar servidores Proxy y los transcodificadores</span><span class="sxs-lookup"><span data-stu-id="432fe-335">Disabling Transcoders and Proxy Servers</span></span>

<span data-ttu-id="432fe-336">Operadores de red móvil tienen dos objetivos amplia en su enfoque a internet móvil:</span><span class="sxs-lookup"><span data-stu-id="432fe-336">Mobile network operators have two broad objectives in their approach to the mobile internet:</span></span>

1. <span data-ttu-id="432fe-337">Proporcionar como contenido mucho pertinente como sea posible</span><span class="sxs-lookup"><span data-stu-id="432fe-337">Provide as much relevant content as possible</span></span>
2. <span data-ttu-id="432fe-338">Maximizar el número de clientes que pueden compartir el ancho de banda de red limitado de radio</span><span class="sxs-lookup"><span data-stu-id="432fe-338">Maximize the number of customers who can share the limited radio network bandwidth</span></span>

<span data-ttu-id="432fe-339">Puesto que la mayoría de las páginas web se diseñaron para pantallas de tamaño de escritorio grandes y conexiones de banda ancha de línea rápido se ha corregido, usar muchos operadores *transcodificadores* o *servidores proxy* que alterar dinámicamente el contenido web.</span><span class="sxs-lookup"><span data-stu-id="432fe-339">Since most web pages were designed for large desktop-sized screens and fast fixed-line broadband connections, many operators use *transcoders* or *proxy servers* that dynamically alter web content.</span></span> <span data-ttu-id="432fe-340">Puede modificar el formato HTML o CSS para que se ajuste a pantallas más pequeñas (especialmente para la "característica teléfonos" que no tienen la capacidad de procesamiento para controlar los diseños complejos), y pueden volver a comprimir las imágenes (lo que reduce considerablemente su calidad) para mejorar las velocidades de entrega de la página.</span><span class="sxs-lookup"><span data-stu-id="432fe-340">They may modify your HTML markup or CSS to suit smaller screens (especially for "feature phones" that lack the processing power to handle complex layouts), and they may recompress your images (significantly reducing their quality) to improve page delivery speeds.</span></span>

<span data-ttu-id="432fe-341">Pero si ha realizado el esfuerzo para producir una versión optimizada para móviles de su sitio, probablemente no desea que el operador de red que interfieran con él cualquiera aún más.</span><span class="sxs-lookup"><span data-stu-id="432fe-341">But if you've taken the effort to produce a mobile-optimized version of your site, you probably don't want the network operator to interfere with it any further.</span></span> <span data-ttu-id="432fe-342">Puede agregar la siguiente línea a la página\_eventos de carga en cualquier formulario Web Forms de ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="432fe-342">You can add the following line to the Page\_Load event in any ASP.NET Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample16.cs)]

<span data-ttu-id="432fe-343">O bien, para un controlador ASP.NET MVC, puede agregar la siguiente invalidación de método para que se aplique a todas las acciones en el controlador:</span><span class="sxs-lookup"><span data-stu-id="432fe-343">Or, for an ASP.NET MVC controller, you could add the following method override so that it applies to all actions on that controller:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample17.cs)]

<span data-ttu-id="432fe-344">El mensaje HTTP resultante informa a los transcodificadores conformes de W3C y los servidores de proxy no alterar el contenido.</span><span class="sxs-lookup"><span data-stu-id="432fe-344">The resulting HTTP message informs W3C compliant transcoders and proxies not to alter content.</span></span> <span data-ttu-id="432fe-345">Por supuesto, no hay ninguna garantía de que los operadores de redes móviles respetará este mensaje.</span><span class="sxs-lookup"><span data-stu-id="432fe-345">Of course, there is no guarantee that mobile network operators will respect this message.</span></span>

### <a name="styling-mobile-pages-for-mobile-browsers"></a><span data-ttu-id="432fe-346">Aplicar estilos a las páginas móviles para los exploradores móviles</span><span class="sxs-lookup"><span data-stu-id="432fe-346">Styling mobile pages for mobile browsers</span></span>

<span data-ttu-id="432fe-347">Está fuera del ámbito de este documento describir en detalle qué tipos de trabajo de marcado HTML correctamente o qué técnicas de diseño web maximizar la facilidad de uso en determinados dispositivos.</span><span class="sxs-lookup"><span data-stu-id="432fe-347">It's beyond the scope of this document to describe in great detail what kinds of HTML markup work correctly or which web design techniques maximize usability on particular devices.</span></span> <span data-ttu-id="432fe-348">Se copia para buscar un diseño lo suficientemente sencillo, optimizado para una pantalla tamaño mobile, sin usar no confiable HTML o CSS trucos de posicionamiento.</span><span class="sxs-lookup"><span data-stu-id="432fe-348">It's up to you to find a sufficiently simple layout, optimized for a mobile-sized screen, without using unreliable HTML or CSS positioning tricks.</span></span> <span data-ttu-id="432fe-349">Sin embargo, es una técnica importante que merece la pena mencionar, el *etiqueta meta de ventanilla*.</span><span class="sxs-lookup"><span data-stu-id="432fe-349">One important technique worth mentioning, however, is the *viewport meta tag*.</span></span>

<span data-ttu-id="432fe-350">Lo ciertos exploradores móviles, en un esfuerzo para mostrar las páginas web diseñadas para los monitores de escritorio, representan la página en un lienzo virtual, también denominado "ventanilla" (por ejemplo, la ventanilla virtual es 980 píxeles de ancho en iPhone y 850 píxeles de ancho en Opera Mobile de forma predeterminada) y, a continuación, Reduzca el resultado para ajustarla a píxeles físicos de la pantalla.</span><span class="sxs-lookup"><span data-stu-id="432fe-350">Certain modern mobile browsers, in an effort display web pages meant for desktop monitors, render the page on a virtual canvas, also called "viewport" (e.g., the virtual viewport is 980 pixels wide on iPhone, and 850 pixels wide on Opera Mobile by default) and then scale the result down to fit onto the screen's physical pixels.</span></span> <span data-ttu-id="432fe-351">El usuario puede, a continuación, usar el zoom y panorámica dicha ventanilla.</span><span class="sxs-lookup"><span data-stu-id="432fe-351">The user can then zoom in and pan around that viewport.</span></span> <span data-ttu-id="432fe-352">Esto tiene la ventaja que permite que el explorador muestre la página en su diseño previsto, pero también tiene la desventaja que obliga a Zoom y panorámica, que no es apto para el usuario.</span><span class="sxs-lookup"><span data-stu-id="432fe-352">This has the advantage that it lets the browser display the page in its intended layout, but it's also has the disadvantage that it forces zooming and panning, which is inconvenient for the user.</span></span> <span data-ttu-id="432fe-353">Si va a diseñar para dispositivos móviles, es mejor diseño para una pantalla estrecha para que no sea necesario zoom o desplazamiento horizontal.</span><span class="sxs-lookup"><span data-stu-id="432fe-353">If you're designing for mobile, it's better to design for a narrow screen so that no zooming or horizontal scrolling is necessary.</span></span>

<span data-ttu-id="432fe-354">Una manera de indicar al explorador móvil ancho debe ser la ventanilla es a través de la no estándar *ventanilla* etiqueta meta.</span><span class="sxs-lookup"><span data-stu-id="432fe-354">A way to tell the mobile browser how wide the viewport should be is through the nonstandard *viewport* meta tag.</span></span> <span data-ttu-id="432fe-355">Por ejemplo, si agrega lo siguiente a la sección de encabezado de la página,</span><span class="sxs-lookup"><span data-stu-id="432fe-355">For example, if you add the following to your page's HEAD section,</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample18.html)]

<span data-ttu-id="432fe-356">…</span><span class="sxs-lookup"><span data-stu-id="432fe-356">…</span></span> <span data-ttu-id="432fe-357">a continuación, compatibilidad con exploradores de smartphone se diseñe la página en un lienzo virtual a nivel de 480 píxeles.</span><span class="sxs-lookup"><span data-stu-id="432fe-357">then supporting smartphone browsers will lay out the page on a 480-pixel wide virtual canvas.</span></span> <span data-ttu-id="432fe-358">Esto significa que, si los elementos HTML definen el ancho en términos de porcentaje, se interpretará los porcentajes en relación con este ancho de 480 píxeles, no el ancho del área de visualización predeterminado.</span><span class="sxs-lookup"><span data-stu-id="432fe-358">This means that if your HTML elements define their widths in percentage terms, the percentages will be interpreted with respect to this 480-pixel width, not the default viewport width.</span></span> <span data-ttu-id="432fe-359">Como resultado, el usuario es menos probable que tenga que aplicar el zoom y desplazar horizontalmente: considerablemente mejora la experiencia de exploración móvil.</span><span class="sxs-lookup"><span data-stu-id="432fe-359">As a result, the user is less likely to have to zoom and pan horizontally – considerably improving the mobile browsing experience.</span></span>

<span data-ttu-id="432fe-360">Si desea que el ancho de la ventanilla para que coincida con píxeles físicos del dispositivo, se puede especificar lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="432fe-360">If you want the viewport width to match the device's physical pixels, you can specify the following:</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample19.html)]

<span data-ttu-id="432fe-361">Para que funcione correctamente, debe no fuerza explícitamente elementos que se va a superar ese ancho (por ejemplo, mediante un *ancho* atributo o propiedad CSS), en caso contrario, se forzará el explorador para usar un área de visualización mayor independientemente.</span><span class="sxs-lookup"><span data-stu-id="432fe-361">For this to work correctly, you must not explicitly force elements to exceed that width (e.g., using a *width* attribute or CSS property), otherwise the browser will be forced to use a larger viewport regardless.</span></span> <span data-ttu-id="432fe-362">Vea también: [más detalles acerca de la etiqueta de ventanilla no estándar](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span><span class="sxs-lookup"><span data-stu-id="432fe-362">See also: [more details about the nonstandard viewport tag](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span></span>

<span data-ttu-id="432fe-363">Los smartphones más modernos admiten *orientación dual*: se mantendrían en modo vertical u horizontal.</span><span class="sxs-lookup"><span data-stu-id="432fe-363">Most modern smartphones support *dual orientation*: they can be held in either portrait or landscape mode.</span></span> <span data-ttu-id="432fe-364">Por lo tanto, es importante no realizar suposiciones sobre el ancho de pantalla en píxeles.</span><span class="sxs-lookup"><span data-stu-id="432fe-364">So, it's important not to make assumptions about the screen width in pixels.</span></span> <span data-ttu-id="432fe-365">No incluso se supone que se ha corregido el ancho de pantalla, dado que el usuario puede orientar volver a su dispositivo mientras están en la página.</span><span class="sxs-lookup"><span data-stu-id="432fe-365">Don't even assume that the screen width is fixed, because the user can re-orient their device while they are on your page.</span></span>

<span data-ttu-id="432fe-366">Dispositivos Windows Mobile y Blackberry antiguos también pueden aceptar las siguientes etiquetas meta en el encabezado de página para informarles de contenido se ha optimizado para dispositivos móviles y, por tanto, no deben transformarse.</span><span class="sxs-lookup"><span data-stu-id="432fe-366">Older Windows Mobile and Blackberry devices may also accept the following meta tags in the page header to inform them content has been optimized for mobile and therefore should not be transformed.</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample20.html)]

## <a name="additional-resources"></a><span data-ttu-id="432fe-367">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="432fe-367">Additional Resources</span></span>

<span data-ttu-id="432fe-368">Para obtener una lista de los emuladores de dispositivos móviles y los simuladores puede usar para probar la aplicación web ASP.NET mobile, consulte la página [simular dispositivos móviles conocidos para realizar pruebas](../mobile/device-simulators.md).</span><span class="sxs-lookup"><span data-stu-id="432fe-368">For a list of mobile device emulators and simulators you can use to test your mobile ASP.NET web application, see the page [Simulate popular mobile devices for testing](../mobile/device-simulators.md).</span></span>

## <a name="credits"></a><span data-ttu-id="432fe-369">Créditos</span><span class="sxs-lookup"><span data-stu-id="432fe-369">Credits</span></span>

- <span data-ttu-id="432fe-370">Autor principal: Steven Sanderson</span><span class="sxs-lookup"><span data-stu-id="432fe-370">Primary author: Steven Sanderson</span></span>
- <span data-ttu-id="432fe-371">Los revisores / adicionales escritores de contenido: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span><span class="sxs-lookup"><span data-stu-id="432fe-371">Reviewers / additional content writers: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span></span>

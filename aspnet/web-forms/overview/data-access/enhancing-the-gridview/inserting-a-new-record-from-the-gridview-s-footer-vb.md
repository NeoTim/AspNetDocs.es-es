---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: Insertar un nuevo registro desde el pie de página de GridView (VB) | Microsoft Docs
author: rick-anderson
description: Mientras el control GridView no proporciona compatibilidad integrada para insertar un nuevo registro de datos, en este tutorial se muestra cómo aumentar el control GridView para incluir un...
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 962d1ff53b87577dd8f232f1bcb8fd01198a5a6d
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/06/2019
ms.locfileid: "65108640"
---
# <a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="c5a7c-103">Insertar un nuevo registro desde el pie de página de GridView (VB)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-103">Inserting a New Record from the GridView's Footer (VB)</span></span>

<span data-ttu-id="c5a7c-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c5a7c-105">[Descargue la aplicación de ejemplo](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) o [descargar PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="c5a7c-106">Mientras el control GridView no proporciona compatibilidad integrada para insertar un nuevo registro de datos, en este tutorial se muestra cómo aumentar el control GridView para incluir una interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="c5a7c-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="c5a7c-107">Introduction</span></span>

<span data-ttu-id="c5a7c-108">Como se describe en el [una visión general de insertar, actualizar y eliminar datos](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, los controles GridView, DetailsView y FormView Web incluyen capacidades de modificación de datos integrados.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="c5a7c-109">Cuando se usa con controles de origen de datos declarativo, el estos tres controles Web pueden configurarse de forma rápida y sencilla para modificar datos y en escenarios sin necesidad de escribir una sola línea de código.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="c5a7c-110">Desafortunadamente, los controles DetailsView y FormView ofrecen integrados Insertar, editar y eliminar capacidades.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="c5a7c-111">GridView sólo ofrece la edición y eliminación de soporte técnico.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="c5a7c-112">Sin embargo, con un poco codo grasa, podemos aumentar el control GridView para incluir una interfaz de inserción.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="c5a7c-113">Agregar funciones de inserción en el control GridView, somos responsables de decidir cómo los registros nuevos se agregará, creación de la interfaz de inserción y escribir el código para insertar el nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="c5a7c-114">En este tutorial que se examinará la adición de la interfaz de inserción al pie de página de GridView s filas (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="c5a7c-115">La celda de pie de página para cada columna incluye el elemento de interfaz de usuario de recopilación de datos correspondiente (un cuadro de texto para el nombre del producto s, DropDownList para el proveedor y así sucesivamente).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="c5a7c-116">También necesitamos una columna para agregar botón que, al hacer clic en, se producen un postback e insertar un nuevo registro en el `Products` utilizando los valores proporcionados en la fila de pie de tabla.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>

<span data-ttu-id="c5a7c-117">[![La fila de pie de página proporciona una interfaz para agregar nuevos productos](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="c5a7c-118">**Figura 1**: La fila de pie de página proporciona una interfaz para agregar nuevos productos ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>

## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="c5a7c-119">Paso 1: Muestra información del producto en un control GridView</span><span class="sxs-lookup"><span data-stu-id="c5a7c-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="c5a7c-120">Antes de que se refieren a nosotros mismos con la creación de la interfaz de inserción en el pie de página de GridView s, permiten centrarnos primero de s acerca de cómo agregar un control GridView a la página que se enumera los productos en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="c5a7c-121">Comience abriendo la `InsertThroughFooter.aspx` página en el `EnhancedGridView` carpeta y arrastre un control GridView del cuadro de herramientas hasta el diseñador, configurando la s GridView `ID` propiedad `Products`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="c5a7c-122">A continuación, use la etiqueta inteligente de GridView s para enlazarla a un nuevo origen ObjectDataSource denominado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>

<span data-ttu-id="c5a7c-123">[![Crear un nuevo origen ObjectDataSource denominado ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="c5a7c-124">**Figura 2**: Crear un nuevo origen ObjectDataSource denominado `ProductsDataSource` ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>

<span data-ttu-id="c5a7c-125">Configurar el origen ObjectDataSource para usar el `ProductsBLL` clase s `GetProducts()` método para recuperar información del producto.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="c5a7c-126">Para este tutorial, permiten s centrarse estrictamente agregar funciones de inserción y no preocuparse acerca de la edición y eliminación.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="c5a7c-127">Por lo tanto, asegúrese de que se establece la lista desplegable en la pestaña Insertar en `AddProduct()` y que las listas desplegables en las fichas de UPDATE y DELETE se establecen en (ninguno).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>

<span data-ttu-id="c5a7c-128">[![El método AddProduct se asignan al método Insert() ObjectDataSource s](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="c5a7c-129">**Figura 3**: Mapa del `AddProduct` método al origen ObjectDataSource s `Insert()` método ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>

<span data-ttu-id="c5a7c-130">[![Establece la actualización y eliminación pestañas listas desplegables en (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="c5a7c-131">**Figura 4**: Establezca la actualización y listas desplegables de las pestañas eliminar (ninguno) ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>

<span data-ttu-id="c5a7c-132">Después de completar al Asistente para configurar origen de datos de origen ObjectDataSource s, Visual Studio agregará automáticamente los campos en el control GridView para cada uno de los campos de datos correspondiente.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="c5a7c-133">Por ahora, deje todos los campos agregados por Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="c5a7c-134">Más adelante en este tutorial, se deberá volver y quitar algunos de los campos cuyos valores don t deben especificarse cuando se agrega un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="c5a7c-135">Dado que hay cerca de 80 productos en la base de datos, un usuario tendrá que desplazarse hasta la parte inferior de la página web con el fin de agregar un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="c5a7c-136">Por lo tanto, permiten s habilita la paginación hacer la interfaz de inserción más visible y accesible.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="c5a7c-137">Para activar la paginación, simplemente marque la casilla de verificación Habilitar la paginación de la etiqueta inteligente de s GridView.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="c5a7c-138">En este momento, el marcado declarativo de s GridView y ObjectDataSource debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]

<span data-ttu-id="c5a7c-139">[![Se muestran todos los campos de datos de producto en un control GridView paginado](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="c5a7c-140">**Figura 5**: Se muestran todos los campos de datos de producto en un control GridView paginado ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="c5a7c-141">Paso 2: Agregar una fila de pie de página</span><span class="sxs-lookup"><span data-stu-id="c5a7c-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="c5a7c-142">Junto con su encabezado y las filas de datos, el control GridView incluye una fila de pie de página.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="c5a7c-143">Las filas de encabezado y pie de página se muestran según los valores de las operaciones de asignación GridView [ `ShowHeader` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) y [ `ShowFooter` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) propiedades.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="c5a7c-144">Para mostrar la fila de pie de página, basta con establecer la `ShowFooter` propiedad `True`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="c5a7c-145">Como se muestra en la figura 6, establecer el `ShowFooter` propiedad `True` agrega una fila de pie de página a la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>

<span data-ttu-id="c5a7c-146">[![Para mostrar la fila de pie de página, establezca ShowFooter en True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="c5a7c-147">**Figura 6**: Para mostrar la fila de pie de página, establezca `ShowFooter` a `True` ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>

<span data-ttu-id="c5a7c-148">Tenga en cuenta que la fila de pie de página tiene un color de fondo de color rojo oscuro.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="c5a7c-149">Esto ocurre con el tema DataWebControls se crean y se aplican a todas las páginas en el [mostrar datos con el origen ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="c5a7c-150">En concreto, el `GridView.skin` archivo configura el `FooterStyle` propiedad tal que usa el `FooterStyle` clase CSS.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="c5a7c-151">El `FooterStyle` clase se define en `Styles.css` como sigue:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>

[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="c5a7c-152">Se ve al explorar el uso de la fila de pie de página de GridView s en tutoriales anteriores.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="c5a7c-153">Si es necesario, vuelva a consultar el [mostrar información de resumen en el pie de página de GridView](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial para ponerse al día.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>

<span data-ttu-id="c5a7c-154">Después de establecer el `ShowFooter` propiedad `True`, dedique un momento para ver la salida en un explorador.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="c5a7c-155">Actualmente la t de fila de pie de página contiene cualquier texto o controles Web.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="c5a7c-156">En el paso 3 se modificará el pie de página para cada campo de GridView para que incluya la interfaz adecuada de inserción.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>

<span data-ttu-id="c5a7c-157">[![La fila de pie de página vacía es muestran encima de la paginación controles de interfaz](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="c5a7c-158">**Figura 7**: La fila de pie de página vacía es muestran encima de la paginación controles de interfaz ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>

## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="c5a7c-159">Paso 3: Personalización de la fila de pie de página</span><span class="sxs-lookup"><span data-stu-id="c5a7c-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="c5a7c-160">En el [uso de TemplateFields en el GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial hemos visto cómo personalizar en gran medida la presentación de una determinada columna de GridView, uso de TemplateFields (en lugar de BoundFields o CheckBoxFields); en [ Personalizar la interfaz de modificación de datos](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) analizamos el uso de TemplateFields para personalizar la interfaz de edición en un control GridView.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="c5a7c-161">Recuerde que TemplateField se compone de una serie de plantillas que define la combinación de marcado, los controles Web y sintaxis de enlace de datos había usado con ciertos tipos de filas.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="c5a7c-162">El `ItemTemplate`, por ejemplo, especifica la plantilla utilizada para las filas de solo lectura, mientras que el `EditItemTemplate` define la plantilla para la fila editable.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="c5a7c-163">Junto con el `ItemTemplate` y `EditItemTemplate`, TemplateField también incluye un `FooterTemplate` que especifica el contenido de la fila de pie de página.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="c5a7c-164">Por lo tanto, podemos agregar los controles Web necesarios para cada campo s insertar interfaz en el `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="c5a7c-165">Para empezar, convertir todos los campos en el control GridView en TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="c5a7c-166">Esto puede hacerse el vínculo Editar columnas en el control GridView s etiquetas inteligentes, al seleccionar cada campo en la esquina inferior izquierda y haga clic en la función Convert este campo en un vínculo TemplateField.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>

![Convierte cada campo en TemplateField](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="c5a7c-168">**Figura 8**: Convierte cada campo en TemplateField</span><span class="sxs-lookup"><span data-stu-id="c5a7c-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>

<span data-ttu-id="c5a7c-169">Al hacer clic en la función Convert este campo en TemplateField convierte el tipo de campo actual en un TemplateField equivalente.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="c5a7c-170">Por ejemplo, se reemplaza cada BoundField por TemplateField con un `ItemTemplate` que contiene una etiqueta que muestra el campo de datos correspondiente y un `EditItemTemplate` que muestra el campo de datos en un cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="c5a7c-171">El `ProductName` BoundField se ha convertido en el siguiente marcado TemplateField:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="c5a7c-172">Del mismo modo, el `Discontinued` CampoCasillaVerificación se ha convertido en TemplateField cuya `ItemTemplate` y `EditItemTemplate` contiene un control de casilla de verificación Web (con el `ItemTemplate` s casilla deshabilitada).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="c5a7c-173">Solo lectura `ProductID` BoundField se ha convertido en TemplateField con un control de etiqueta tanto en el `ItemTemplate` y `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="c5a7c-174">En resumen, convertir un GridView existente en TemplateField es una manera rápida y sencilla para cambiar a TemplateField más personalizable sin perder la funcionalidad de campo s existente.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="c5a7c-175">Desde el control GridView se está trabajando edición de soporte técnico de t, no dude en quitar el `EditItemTemplate` desde cada TemplateField, dejando sólo los `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="c5a7c-176">Una vez hecho esto, el marcado declarativo de GridView s debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-176">After doing this, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="c5a7c-177">Ahora que cada campo del control GridView se ha convertido en TemplateField, podemos escribir la interfaz adecuada de inserción en cada campo s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="c5a7c-178">Algunos de los campos no tendrá una interfaz de inserción (`ProductID`, por ejemplo); otros usuarios varían en los controles Web que se usa para recopilar la información del producto s nuevo.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="c5a7c-179">Para crear la interfaz de edición, elija el vínculo Editar plantillas de la etiqueta inteligente de s GridView.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="c5a7c-180">A continuación, en la lista desplegable, seleccione el campo apropiado s `FooterTemplate` y arrastre el control adecuado desde el cuadro de herramientas hasta el diseñador.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>

<span data-ttu-id="c5a7c-181">[![Agregar la interfaz de inserción adecuada a cada FooterTemplate s de campo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="c5a7c-182">**Figura 9**: Agregar la interfaz adecuada de inserción para cada campo s `FooterTemplate` ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>

<span data-ttu-id="c5a7c-183">La lista con viñetas siguiente enumera los campos de GridView, especificar la interfaz de inserción para agregar:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="c5a7c-184">`ProductID` Ninguno.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-184">`ProductID` none.</span></span>
- <span data-ttu-id="c5a7c-185">`ProductName` Agregue un cuadro de texto y establezca su `ID` a `NewProductName`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="c5a7c-186">Agregue un control RequiredFieldValidator para asegurarse de que el usuario escribe un valor para el nuevo nombre de producto s.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="c5a7c-187">`SupplierID` Ninguno.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-187">`SupplierID` none.</span></span>
- <span data-ttu-id="c5a7c-188">`CategoryID` Ninguno.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-188">`CategoryID` none.</span></span>
- <span data-ttu-id="c5a7c-189">`QuantityPerUnit` Agregar un cuadro de texto, establecer su `ID` a `NewQuantityPerUnit`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="c5a7c-190">`UnitPrice` Agregar un cuadro de texto denominado `NewUnitPrice` y un control CompareValidator que garantiza que el valor especificado es un valor de moneda mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="c5a7c-191">`UnitsInStock` Use un cuadro de texto cuyo `ID` está establecido en `NewUnitsInStock`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="c5a7c-192">Incluir un CompareValidator que garantiza que el valor especificado es un valor entero mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="c5a7c-193">`UnitsOnOrder` Use un cuadro de texto cuyo `ID` está establecido en `NewUnitsOnOrder`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="c5a7c-194">Incluir un CompareValidator que garantiza que el valor especificado es un valor entero mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="c5a7c-195">`ReorderLevel` Use un cuadro de texto cuyo `ID` está establecido en `NewReorderLevel`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="c5a7c-196">Incluir un CompareValidator que garantiza que el valor especificado es un valor entero mayor o igual que cero.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="c5a7c-197">`Discontinued` Agregar un control CheckBox, establecer su `ID` a `NewDiscontinued`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="c5a7c-198">`CategoryName` Agregue un DropDownList y establezca su `ID` a `NewCategoryID`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="c5a7c-199">Enlazarlo a un nuevo origen ObjectDataSource denominado `CategoriesDataSource` y configúrelo para utilizar el `CategoriesBLL` clase s `GetCategories()` método.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="c5a7c-200">Tiene la s DropDownList `ListItem` mostrar s el `CategoryName` datos de campo, utilizando el `CategoryID` campo de datos como sus valores.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="c5a7c-201">`SupplierName` Agregue un DropDownList y establezca su `ID` a `NewSupplierID`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="c5a7c-202">Enlazarlo a un nuevo origen ObjectDataSource denominado `SuppliersDataSource` y configúrelo para utilizar el `SuppliersBLL` clase s `GetSuppliers()` método.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="c5a7c-203">Tiene la s DropDownList `ListItem` mostrar s el `CompanyName` datos de campo, utilizando el `SupplierID` campo de datos como sus valores.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="c5a7c-204">Para cada uno de los controles de validación, borre el `ForeColor` propiedad para que el `FooterStyle` color de primer plano blanco s de la clase CSS que se usará en lugar del predeterminado en rojo.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="c5a7c-205">Use también el `ErrorMessage` propiedad para obtener una descripción detallada, pero establece el `Text` propiedad en un asterisco.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="c5a7c-206">Para evitar que el texto del control s validación causando la interfaz de inserción para que se ajusten a dos líneas, establezca el `FooterStyle` s `Wrap` propiedad en false para cada uno de los `FooterTemplate` que utilizan un control de validación.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="c5a7c-207">Por último, agregue un control ValidationSummary bajo el control GridView y establezca su `ShowMessageBox` propiedad `True` y su `ShowSummary` propiedad `False`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="c5a7c-208">Al agregar un nuevo producto, se debe proporcionar el `CategoryID` y `SupplierID`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="c5a7c-209">Esta información se captura a través de las listas desplegables en las celdas de pie de página para el `CategoryName` y `SupplierName` campos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="c5a7c-210">He optado por usar estos campos en contraposición a la `CategoryID` y `SupplierID` TemplateFields porque en la cuadrícula s filas de datos del usuario es probablemente más interesado en ver los nombres de categoría y proveedor en lugar de los valores de identificador.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="c5a7c-211">Puesto que la `CategoryID` y `SupplierID` ahora se capturan los valores en el `CategoryName` y `SupplierName` interfaces Insertar s de campo, podemos quitar el `CategoryID` y `SupplierID` TemplateFields en el control GridView.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="c5a7c-212">De forma similar, el `ProductID` no se utiliza cuando se agrega un nuevo producto, por lo que el `ProductID` TemplateField también se puede quitar.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="c5a7c-213">Sin embargo, permitan s abandonar el `ProductID` campo en la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="c5a7c-214">Además de los cuadros de texto, listas desplegables, casillas y los controles de validación que componen la interfaz de inserción, necesitaremos también una Agregar botón que, al hacer clic, lleva a cabo la lógica para agregar el nuevo producto a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="c5a7c-215">En el paso 4, se debe incluir un botón Add en la interfaz de inserción en el `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="c5a7c-216">No dude en mejorar la apariencia de los distintos campos de GridView.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="c5a7c-217">Por ejemplo, desea dar formato a la `UnitPrice` valores como valores de moneda, Alinear a la derecha el `UnitsInStock`, `UnitsOnOrder`, y `ReorderLevel` campos y actualizar el `HeaderText` valores para el TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="c5a7c-218">Después de crear el montón de la inserción de las interfaces en el `FooterTemplate` s, quitando el `SupplierID`, y `CategoryID` TemplateFields y mejorar la estética de la cuadrícula a través de formato y la alineación del TemplateFields, la s GridView declarativa marcado debe tener un aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="c5a7c-219">Cuando se ve mediante un explorador, la fila de pie de página de GridView s ahora incluye completado insertar interfaz (consulte la figura 10).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="c5a7c-220">En este momento, la inserción t de interfaz son un medio para que el usuario indicar que s escribió los datos para el nuevo producto y desea insertar un nuevo registro en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="c5a7c-221">Además, se ve aún para abordar cómo los datos introducidos en el pie de página se traducirán en un nuevo registro en el `Products` base de datos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="c5a7c-222">En el paso 4, veremos cómo incluir un botón Add a la interfaz de inserción y cómo ejecutar código en el postback cuando lo s que se hizo clic.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="c5a7c-223">Paso 5 muestra cómo insertar un nuevo registro con los datos en el pie de página.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>

<span data-ttu-id="c5a7c-224">[![El pie de página de GridView proporciona una interfaz para agregar un nuevo registro](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="c5a7c-225">**Figura 10**: El pie de página de GridView proporciona una interfaz para agregar un nuevo registro ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>

## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="c5a7c-226">Paso 4: Incluir un botón Add en la interfaz de inserción</span><span class="sxs-lookup"><span data-stu-id="c5a7c-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="c5a7c-227">Es necesario incluir un botón Add en algún lugar en la interfaz de inserción porque la s de la fila de pie de página Insertar interfaz actualmente no tiene los medios para el usuario indicar que termine de escribir la nueva información de producto s.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="c5a7c-228">Esto se podría colocar en uno de los existentes `FooterTemplate` s o nos podríamos agregar una nueva columna a la cuadrícula para este propósito.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="c5a7c-229">Para este tutorial, s permiten colocar en el botón Agregar el `ProductID` TemplateField s `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="c5a7c-230">En el diseñador, haga clic en el vínculo Editar plantillas en la etiqueta inteligente de GridView s y, a continuación, elija el `ProductID` campo s `FooterTemplate` en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="c5a7c-231">Agregar un control de botón Web (o un LinkButton o ImageButton, si lo prefiere) a la plantilla, estableciendo su ID `AddProduct`, sus `CommandName` para Insert y su `Text` propiedad para agregar, como se muestra en la figura 11.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>

<span data-ttu-id="c5a7c-232">[![Coloque el botón Agregar en ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="c5a7c-233">**Figura 11**: Coloque el botón Agregar en el `ProductID` TemplateField s `FooterTemplate` ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>

<span data-ttu-id="c5a7c-234">Una vez que ha había incluido el botón Agregar, pruebe la página en un explorador.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="c5a7c-235">Tenga en cuenta que al hacer clic en el botón Agregar con datos no válidos en la interfaz de inserción, la devolución de datos se resumen de circuito y el control ValidationSummary indica que los datos no válidos (consulte la figura 12).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="c5a7c-236">Con los datos apropiados especificados, al hacer clic en el botón Agregar, se produce un postback.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="c5a7c-237">No hay ningún registro se agrega a la base de datos, sin embargo.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-237">No record is added to the database, however.</span></span> <span data-ttu-id="c5a7c-238">Deberá escribir un fragmento de código para llevar a cabo la inserción.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-238">We will need to write a bit of code to actually perform the insert.</span></span>

<span data-ttu-id="c5a7c-239">[![La s Agregar botón Postback es de circuito corto si no hay datos no válidos en la interfaz de inserción](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="c5a7c-240">**Figura 12**: La s de botón Agregar Postback es corto de circuito si no hay datos no válidos en la interfaz de inserción ([haga clic aquí para ver imagen en tamaño completo](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="c5a7c-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c5a7c-241">Los controles de validación en la interfaz de inserción no se han asignado a un grupo de validación.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="c5a7c-242">Esto funciona bien siempre y cuando la interfaz de inserción es el único conjunto de controles de validación en la página.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="c5a7c-243">Si, sin embargo, hay otros controles de validación en la página (por ejemplo, los controles de validación en la interfaz de edición de cuadrícula s), los controles de validación en la inserción de la interfaz y agregar botón s `ValidationGroup` propiedades se deben asignar el mismo valor de fin asociar estos controles a un grupo de validación determinado.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="c5a7c-244">Consulte [Disecar los controles de validación en ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) para obtener más información acerca de las particiones de los botones en una página y controles de validación en los grupos de validación.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>

## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="c5a7c-245">Paso 5: Insertar un nuevo registro en el`Products`tabla</span><span class="sxs-lookup"><span data-stu-id="c5a7c-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="c5a7c-246">Al utilizar las características de edición integradas del control GridView, el control GridView controla automáticamente todo el trabajo necesario para realizar la actualización.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="c5a7c-247">En concreto, cuando se hace clic en el botón Actualizar copia los valores especificados de la interfaz de edición para los parámetros en las operaciones de asignación ObjectDataSource `UpdateParameters` colección e inicia la actualización invocando la s ObjectDataSource `Update()` método.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="c5a7c-248">Puesto que el control GridView no proporciona esta funcionalidad integrada para insertar, debemos implementar código que llama a la s ObjectDataSource `Insert()` método y copia los valores de la inserción de la interfaz para el s ObjectDataSource `InsertParameters` colección .</span><span class="sxs-lookup"><span data-stu-id="c5a7c-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="c5a7c-249">Esta lógica de inserción se debe ejecutar después de que se ha hecho clic el botón Agregar.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="c5a7c-250">Como se describe en el [agregar y responder a los botones en un control GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, cada vez que un botón, LinkButton o ImageButton en un control GridView se hace clic en, la s GridView `RowCommand` desencadena el evento en el postback.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="c5a7c-251">Este evento se desencadena si el botón, LinkButton o ImageButton se ha agregado explícitamente como el botón Agregar en la fila de pie de página o si se agregó automáticamente por el control GridView (por ejemplo, el LinkButtons en la parte superior de cada columna cuando se selecciona la opción Enable Sorting, o LinkButtons en la interfaz de paginación cuando se selecciona Habilitar paginación).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="c5a7c-252">Por lo tanto, para responder al usuario hacer clic en el botón Agregar, es necesario crear un controlador de eventos para el s GridView `RowCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="c5a7c-253">Puesto que este evento se desencadena cada vez que *cualquier* se hace clic en Button, LinkButton o ImageButton en GridView, lo esencial que nos continuar solo con la lógica de inserción si s el `CommandName` propiedad pasa a las asignaciones de controlador de eventos para el `CommandName` valor del botón Agregar (Insertar).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="c5a7c-254">Además, debemos también solo continuamos si informan de los controles de validación de datos válidos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="c5a7c-255">Para dar cabida a esto, cree un controlador de eventos para el `RowCommand` evento con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="c5a7c-256">Quizás se pregunte por qué el controlador de eventos molesta comprobando el `Page.IsValid` propiedad.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="c5a7c-257">¿Después de todo, no se pueden suprimir la devolución de datos si se proporcionan los datos no válidos en la interfaz de inserción?</span><span class="sxs-lookup"><span data-stu-id="c5a7c-257">After all, won't the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="c5a7c-258">Esta suposición es correcta, siempre que el usuario no ha deshabilitado JavaScript o ha tomado medidas para evitar la lógica de validación del lado cliente.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="c5a7c-259">En resumen, uno nunca debería basarse estrictamente en la validación del lado cliente; siempre debe realizarse una comprobación del lado servidor para validez antes de trabajar con los datos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>

<span data-ttu-id="c5a7c-260">En el paso 1 se creó el `ProductsDataSource` ObjectDataSource tal que su `Insert()` método se asigna a la `ProductsBLL` clase s `AddProduct` método.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="c5a7c-261">Para insertar el nuevo registro en el `Products` tabla, que podemos llamar simplemente la s ObjectDataSource `Insert()` método:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="c5a7c-262">Ahora que la `Insert()` ha invocado al método, lo único que queda es copiar los valores de la interfaz de inserción a los parámetros pasados a la `ProductsBLL` clase s `AddProduct` método.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="c5a7c-263">Como vimos en el [examinando los eventos asociados con la inserción, actualización y eliminación](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, esto puede realizarse a través de las operaciones de asignación ObjectDataSource `Inserting` eventos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="c5a7c-264">En el `Inserting` eventos que necesitamos hacer referencia mediante programación a los controles de la `Products` pie de página de GridView s de fila y asignar los valores para el `e.InputParameters` colección.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="c5a7c-265">Si el usuario la omita un valor como dejando la `ReorderLevel` en blanco del cuadro de texto se debe especificar que el valor insertado en la base de datos debe ser `NULL`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="c5a7c-266">Puesto que la `AddProducts` método acepta los tipos que aceptan valores NULL para los campos que aceptan valores NULL de la base de datos, basta con usar un tipo que acepta valores NULL y establezca su valor en `Nothing` en el caso de que se omita la entrada del usuario.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="c5a7c-267">Con el `Inserting` completado un controlador de eventos, se pueden agregar nuevos registros a la `Products` tabla de base de datos a través de la fila de pie de página de GridView s.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="c5a7c-268">Siga adelante e intente agregar varios productos nuevos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="c5a7c-269">Mejorar y personalizar la operación de adición</span><span class="sxs-lookup"><span data-stu-id="c5a7c-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="c5a7c-270">Actualmente, al hacer clic en el botón Agregar agrega un nuevo registro a la tabla de base de datos pero no proporciona a ningún tipo de comentarios visuales que el registro se ha agregado correctamente.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="c5a7c-271">Idealmente, un cuadro de alerta de control o de cliente de Web de la etiqueta podría informar al usuario que se ha completado su inserción con éxito.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="c5a7c-272">Dejar como un ejercicio para el lector.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="c5a7c-273">GridView usada en este tutorial no aplica ningún criterio de ordenación para los productos enumerados, ni tampoco permite al usuario final ordenar los datos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="c5a7c-274">Por lo tanto, los registros se ordenan tal como están en la base de datos por su campo de clave principal.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="c5a7c-275">Puesto que cada nuevo registro tiene un `ProductID` valor mayor que la última de ellas, cada vez que se agrega un nuevo producto se ha agregado al final de la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="c5a7c-276">Por lo tanto, es posible que desee enviar automáticamente al usuario a la última página del control GridView después de agregar un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="c5a7c-277">Esto puede realizarse agregando la siguiente línea de código después de llamar a `ProductsDataSource.Insert()` en el `RowCommand` controlador de eventos para indicar que el usuario debe enviarse a la última página después de enlazar los datos en GridView:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="c5a7c-278">`SendUserToLastPage` es una variable booleana de nivel de página que inicialmente está asignada el valor `False`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="c5a7c-279">En la s GridView `DataBound` controlador de eventos, si `SendUserToLastPage` es false, el `PageIndex` propiedad se actualiza para enviar al usuario a la última página.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="c5a7c-280">La razón por la `PageIndex` propiedad está establecida el `DataBound` controlador de eventos (en contraposición al `RowCommand` controlador de eventos) es porque cuando el `RowCommand` controlador de eventos se activa se ve aún para agregar el nuevo registro a la `Products` tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="c5a7c-281">Por lo tanto, en el `RowCommand` el último índice de la página del controlador de eventos (`PageCount - 1`) representa el último índice de página *antes* se ha agregado el nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="c5a7c-282">Para la mayoría de los productos que se va a agregar el último índice de página es el mismo después de agregar el nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="c5a7c-283">Pero cuando el producto se ha agregado como resultado en un nuevo índice de página último, si se actualiza correctamente el `PageIndex` en el `RowCommand` controlador de eventos, a continuación, se le dirigirá a la segunda a la última página (el último índice de página antes de agregar el nuevo producto) en lugar de la última página nueva i ndice.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="c5a7c-284">Puesto que la `DataBound` controlador de eventos se activa una vez que se ha agregado el nuevo producto y enlazar los datos a la cuadrícula, estableciendo el `PageIndex` existe propiedad sabemos, sacando el último índice de página correcto.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="c5a7c-285">Finalmente, el control GridView usado en este tutorial es bastante amplia debido al número de campos que deben recopilarse para agregar un nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="c5a7c-286">Debido a este ancho, un diseño vertical de DetailsView s podría ser preferido.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="c5a7c-287">Las operaciones de asignación GridView ancho global podría reducirse mediante la recopilación de entradas menos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="c5a7c-288">Tal vez no vamos t necesidad de recopilar la `UnitsOnOrder`, `UnitsInStock`, y `ReorderLevel` campos cuando se agrega un nuevo producto, en cuyo caso se podrían quitar estos campos de GridView.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="c5a7c-289">Para ajustar los datos recopilados, podemos usar uno de estos dos enfoques:</span><span class="sxs-lookup"><span data-stu-id="c5a7c-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="c5a7c-290">Seguir usando el `AddProduct` método que espera valores para el `UnitsOnOrder`, `UnitsInStock`, y `ReorderLevel` campos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="c5a7c-291">En el `Inserting` controlador de eventos, proporcionar codificado de forma rígida, que se usará para estas entradas que se han quitado de la interfaz de insertar los valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="c5a7c-292">Crear una nueva sobrecarga de la `AddProduct` método en el `ProductsBLL` clase que no acepta entradas para el `UnitsOnOrder`, `UnitsInStock`, y `ReorderLevel` campos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="c5a7c-293">A continuación, en la página ASP.NET, configure el origen ObjectDataSource para usar esta nueva sobrecarga.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="c5a7c-294">Cualquiera de las opciones funcionará igual de bien.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-294">Either option will work equally as well.</span></span> <span data-ttu-id="c5a7c-295">En más allá de los tutoriales se usa esta última opción, crear varias sobrecargas para el `ProductsBLL` clase s `UpdateProduct` método.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="c5a7c-296">Resumen</span><span class="sxs-lookup"><span data-stu-id="c5a7c-296">Summary</span></span>

<span data-ttu-id="c5a7c-297">El control GridView carece de las capacidades integradas de inserción que se encuentra en el DetailsView y FormView, pero con un poco de esfuerzo de una interfaz de inserción se puede agregar a la fila de pie de página.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="c5a7c-298">Para mostrar la fila de pie de página en un control GridView simplemente establece su `ShowFooter` propiedad `True`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="c5a7c-299">El contenido de la fila de pie de página se puede personalizar para cada campo mediante la conversión del campo en TemplateField y agregar la inserción de la interfaz para el `FooterTemplate`.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="c5a7c-300">Como hemos visto en este tutorial, el `FooterTemplate` puede contener botones, cuadros de texto, listas desplegables, casillas, controles de origen de datos para rellenar los controles de Web controlada por datos (por ejemplo, listas desplegables) y los controles de validación.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="c5a7c-301">Junto con los controles para recopilar la entrada del usuario s, se necesita un botón de agregar, LinkButton o ImageButton.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="c5a7c-302">Cuando se presiona el botón Agregar, la s ObjectDataSource `Insert()` se invoca el método para iniciar el flujo de trabajo de inserción.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="c5a7c-303">El origen ObjectDataSource, a continuación, llamará al método de inserción configurado (el `ProductsBLL` clase s `AddProduct` método, en este tutorial).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="c5a7c-304">Debemos copiaremos los valores de inserción de interfaz al origen ObjectDataSource s GridView s `InsertParameters` colección antes de que se invoca el método de inserción.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="c5a7c-305">Esto puede realizarse mediante la referencia mediante programación a los controles Web de interfaz insertar en la s ObjectDataSource `Inserting` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="c5a7c-306">En este tutorial se completa nuestro aspecto en las técnicas para mejorar el aspecto de s GridView.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="c5a7c-307">El siguiente conjunto de tutoriales examinará los datos de los controles Web y de cómo trabajar con datos binarios tales como imágenes, archivos PDF, documentos de Word y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="c5a7c-308">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c5a7c-309">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="c5a7c-309">About the Author</span></span>

<span data-ttu-id="c5a7c-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), trabaja con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c5a7c-311">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c5a7c-312">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c5a7c-313">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c5a7c-314">o a través de su blog, que puede encontrarse en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c5a7c-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c5a7c-315">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="c5a7c-315">Special Thanks To</span></span>

<span data-ttu-id="c5a7c-316">Esta serie de tutoriales ha sido revisada por muchos revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c5a7c-317">Revisor de clientes potencial para este tutorial era Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="c5a7c-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="c5a7c-318">¿Está interesado en leer mi próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="c5a7c-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c5a7c-319">Si es así, envíeme una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c5a7c-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="c5a7c-320">Anterior</span><span class="sxs-lookup"><span data-stu-id="c5a7c-320">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)

---
uid: web-pages/overview/data/5-working-with-data
title: Introducción al trabajo con una base de datos en sitios de ASP.NET Web Pages (Razor) | Microsoft Docs
author: Rick-Anderson
description: En este capítulo se describe cómo obtener acceso a los datos de una base de datos y cómo mostrarlos mediante ASP.NET Web Pages.
ms.author: riande
ms.date: 02/18/2014
ms.assetid: 673d502f-2c16-4a6f-bb63-dbfd9a77ef47
msc.legacyurl: /web-pages/overview/data/5-working-with-data
msc.type: authoredcontent
ms.openlocfilehash: 45e988d037465e59ad352bb9444af2c69fd3cd70
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78474043"
---
# <a name="introduction-to-working-with-a-database-in-aspnet-web-pages-razor-sites"></a><span data-ttu-id="88be0-103">Introducción al trabajo con una base de datos en sitios de ASP.NET Web Pages (Razor)</span><span class="sxs-lookup"><span data-stu-id="88be0-103">Introduction to Working with a Database in ASP.NET Web Pages (Razor) Sites</span></span>

<span data-ttu-id="88be0-104">por [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="88be0-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="88be0-105">En este artículo se describe cómo usar las herramientas de Microsoft WebMatrix para crear una base de datos en un sitio web de ASP.NET Web Pages (Razor) y cómo crear páginas que le permitan Mostrar, agregar, editar y eliminar datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-105">This article describes how to use Microsoft WebMatrix tools to create a database in an ASP.NET Web Pages (Razor) website, and how to create pages that let you display, add, edit, and delete data.</span></span>
> 
> <span data-ttu-id="88be0-106">**Lo que aprenderá:**</span><span class="sxs-lookup"><span data-stu-id="88be0-106">**What you'll learn:**</span></span> 
> 
> - <span data-ttu-id="88be0-107">Cómo crear una base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-107">How to create a database.</span></span>
> - <span data-ttu-id="88be0-108">Cómo conectarse a una base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-108">How to connect to a database.</span></span>
> - <span data-ttu-id="88be0-109">Cómo mostrar los datos en una página web.</span><span class="sxs-lookup"><span data-stu-id="88be0-109">How to display data in a web page.</span></span>
> - <span data-ttu-id="88be0-110">Cómo insertar, actualizar y eliminar registros de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-110">How to insert, update, and delete database records.</span></span>
> 
> <span data-ttu-id="88be0-111">Estas son las características introducidas en el artículo:</span><span class="sxs-lookup"><span data-stu-id="88be0-111">These are the features introduced in the article:</span></span>
> 
> - <span data-ttu-id="88be0-112">Trabajar con una base de datos de Microsoft SQL Server Compact Edition.</span><span class="sxs-lookup"><span data-stu-id="88be0-112">Working with a Microsoft SQL Server Compact Edition database.</span></span>
> - <span data-ttu-id="88be0-113">Trabajar con consultas SQL.</span><span class="sxs-lookup"><span data-stu-id="88be0-113">Working with SQL queries.</span></span>
> - <span data-ttu-id="88be0-114">La clase `Database`.</span><span class="sxs-lookup"><span data-stu-id="88be0-114">The `Database` class.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="88be0-115">Versiones de software usadas en el tutorial</span><span class="sxs-lookup"><span data-stu-id="88be0-115">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="88be0-116">ASP.NET Web Pages (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="88be0-116">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="88be0-117">WebMatrix 2</span><span class="sxs-lookup"><span data-stu-id="88be0-117">WebMatrix 2</span></span>
>   
> 
> <span data-ttu-id="88be0-118">Este tutorial también funciona con WebMatrix 3.</span><span class="sxs-lookup"><span data-stu-id="88be0-118">This tutorial also works with WebMatrix 3.</span></span> <span data-ttu-id="88be0-119">Puede usar ASP.NET Web Pages 3 y Visual Studio 2013 (o Visual Studio Express 2013 para web); sin embargo, la interfaz de usuario será diferente.</span><span class="sxs-lookup"><span data-stu-id="88be0-119">You can use ASP.NET Web Pages 3 and Visual Studio 2013 (or Visual Studio Express 2013 for Web); however, the user interface will be different.</span></span>

## <a name="introduction-to-databases"></a><span data-ttu-id="88be0-120">Introducción a las bases de datos</span><span class="sxs-lookup"><span data-stu-id="88be0-120">Introduction to Databases</span></span>

<span data-ttu-id="88be0-121">Imagine una libreta de direcciones típica.</span><span class="sxs-lookup"><span data-stu-id="88be0-121">Imagine a typical address book.</span></span> <span data-ttu-id="88be0-122">Para cada entrada de la libreta de direcciones (es decir, para cada persona) tiene varios datos como el nombre, el apellido, la dirección, la dirección de correo electrónico y el número de teléfono.</span><span class="sxs-lookup"><span data-stu-id="88be0-122">For each entry in the address book (that is, for each person) you have several pieces of information such as first name, last name, address, email address, and phone number.</span></span>

<span data-ttu-id="88be0-123">Una forma habitual de imagen de datos como esta es como una tabla con filas y columnas.</span><span class="sxs-lookup"><span data-stu-id="88be0-123">A typical way to picture data like this is as a table with rows and columns.</span></span> <span data-ttu-id="88be0-124">En términos de base de datos, a menudo se hace referencia a cada fila como un registro.</span><span class="sxs-lookup"><span data-stu-id="88be0-124">In database terms, each row is often referred to as a record.</span></span> <span data-ttu-id="88be0-125">Cada columna (a veces denominada campos) contiene un valor para cada tipo de datos: el nombre, el apellido, etc.</span><span class="sxs-lookup"><span data-stu-id="88be0-125">Each column (sometimes referred to as fields) contains a value for each type of data: first name, last name, and so on.</span></span>

| <span data-ttu-id="88be0-126">**ID**</span><span class="sxs-lookup"><span data-stu-id="88be0-126">**ID**</span></span> | <span data-ttu-id="88be0-127">**FirstName**</span><span class="sxs-lookup"><span data-stu-id="88be0-127">**FirstName**</span></span> | <span data-ttu-id="88be0-128">**LastName**</span><span class="sxs-lookup"><span data-stu-id="88be0-128">**LastName**</span></span> | <span data-ttu-id="88be0-129">**Dirección**</span><span class="sxs-lookup"><span data-stu-id="88be0-129">**Address**</span></span> | <span data-ttu-id="88be0-130">**Correo electrónico**</span><span class="sxs-lookup"><span data-stu-id="88be0-130">**Email**</span></span> | <span data-ttu-id="88be0-131">**Teléfono**</span><span class="sxs-lookup"><span data-stu-id="88be0-131">**Phone**</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="88be0-132">1</span><span class="sxs-lookup"><span data-stu-id="88be0-132">1</span></span> | <span data-ttu-id="88be0-133">Jim</span><span class="sxs-lookup"><span data-stu-id="88be0-133">Jim</span></span> | <span data-ttu-id="88be0-134">Abrus</span><span class="sxs-lookup"><span data-stu-id="88be0-134">Abrus</span></span> | <span data-ttu-id="88be0-135">210 100th St SE Orcas WA 98031</span><span class="sxs-lookup"><span data-stu-id="88be0-135">210 100th St SE Orcas WA 98031</span></span> | jim@contoso.com | <span data-ttu-id="88be0-136">555 0100</span><span class="sxs-lookup"><span data-stu-id="88be0-136">555 0100</span></span> |
| <span data-ttu-id="88be0-137">2</span><span class="sxs-lookup"><span data-stu-id="88be0-137">2</span></span> | <span data-ttu-id="88be0-138">Terry</span><span class="sxs-lookup"><span data-stu-id="88be0-138">Terry</span></span> | <span data-ttu-id="88be0-139">Adams</span><span class="sxs-lookup"><span data-stu-id="88be0-139">Adams</span></span> | <span data-ttu-id="88be0-140">1234 Main St. Seattle WA 99011</span><span class="sxs-lookup"><span data-stu-id="88be0-140">1234 Main St. Seattle WA 99011</span></span> | terry@cohowinery.com | <span data-ttu-id="88be0-141">555 0101</span><span class="sxs-lookup"><span data-stu-id="88be0-141">555 0101</span></span> |

<span data-ttu-id="88be0-142">Para la mayoría de las tablas de base de datos, la tabla debe tener una columna que contenga un identificador único, como un número de cliente, un número de cuenta, etc. Esto se conoce como la *clave principal*de la tabla y se utiliza para identificar cada fila de la tabla.</span><span class="sxs-lookup"><span data-stu-id="88be0-142">For most database tables, the table has to have a column that contains a unique identifier, like a customer number, account number, etc. This is known as the table's *primary key*, and you use it to identify each row in the table.</span></span> <span data-ttu-id="88be0-143">En el ejemplo, la columna ID es la clave principal de la libreta de direcciones.</span><span class="sxs-lookup"><span data-stu-id="88be0-143">In the example, the ID column is the primary key for the address book.</span></span>

<span data-ttu-id="88be0-144">Con esta comprensión básica de las bases de datos, está listo para aprender a crear una base de datos simple y realizar operaciones como agregar, modificar y eliminar datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-144">With this basic understanding of databases, you're ready to learn how to create a simple database and perform operations such as adding, modifying, and deleting data.</span></span>

> [!TIP] 
> 
> <span data-ttu-id="88be0-145">**Bases de datos relacionales**</span><span class="sxs-lookup"><span data-stu-id="88be0-145">**Relational Databases**</span></span>
> 
> <span data-ttu-id="88be0-146">Puede almacenar datos de muchas maneras, como archivos de texto y hojas de cálculo.</span><span class="sxs-lookup"><span data-stu-id="88be0-146">You can store data in lots of ways, including text files and spreadsheets.</span></span> <span data-ttu-id="88be0-147">Sin embargo, para la mayoría de los usos empresariales, los datos se almacenan en una base de datos relacional.</span><span class="sxs-lookup"><span data-stu-id="88be0-147">For most business uses, though, data is stored in a relational database.</span></span>
> 
> <span data-ttu-id="88be0-148">Este artículo no profundiza en las bases de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-148">This article doesn't go very deeply into databases.</span></span> <span data-ttu-id="88be0-149">Sin embargo, es posible que le resulte útil comprender un poco.</span><span class="sxs-lookup"><span data-stu-id="88be0-149">However, you might find it useful to understand a little about them.</span></span> <span data-ttu-id="88be0-150">En una base de datos relacional, la información se divide lógicamente en tablas independientes.</span><span class="sxs-lookup"><span data-stu-id="88be0-150">In a relational database, information is logically divided into separate tables.</span></span> <span data-ttu-id="88be0-151">Por ejemplo, una base de datos para una escuela podría contener tablas independientes para estudiantes y para ofertas de clases.</span><span class="sxs-lookup"><span data-stu-id="88be0-151">For example, a database for a school might contain separate tables for students and for class offerings.</span></span> <span data-ttu-id="88be0-152">El software de base de datos (como SQL Server) admite comandos eficaces que permiten establecer dinámicamente las relaciones entre las tablas.</span><span class="sxs-lookup"><span data-stu-id="88be0-152">The database software (such as SQL Server) supports powerful commands that let you dynamically establish relationships between the tables.</span></span> <span data-ttu-id="88be0-153">Por ejemplo, puede utilizar la base de datos relacional para establecer una relación lógica entre los alumnos y las clases con el fin de crear una programación.</span><span class="sxs-lookup"><span data-stu-id="88be0-153">For example, you can use the relational database to establish a logical relationship between students and classes in order to create a schedule.</span></span> <span data-ttu-id="88be0-154">Almacenar datos en tablas independientes reduce la complejidad de la estructura de la tabla y reduce la necesidad de mantener los datos redundantes en las tablas.</span><span class="sxs-lookup"><span data-stu-id="88be0-154">Storing data in separate tables reduces the complexity of the table structure and reduces the need to keep redundant data in tables.</span></span>

## <a name="creating-a-database"></a><span data-ttu-id="88be0-155">Crear una base de datos</span><span class="sxs-lookup"><span data-stu-id="88be0-155">Creating a Database</span></span>

<span data-ttu-id="88be0-156">En este procedimiento se muestra cómo crear una base de datos denominada SmallBakery mediante la herramienta de diseño de base de datos SQL Server Compact que se incluye en WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="88be0-156">This procedure shows you how to create a database named SmallBakery by using the SQL Server Compact Database design tool that's included in WebMatrix.</span></span> <span data-ttu-id="88be0-157">Aunque puede crear una base de datos mediante código, es más habitual crear la base de datos y las tablas de base de datos mediante una herramienta de diseño como WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="88be0-157">Although you can create a database using code, it's more typical to create the database and database tables using a design tool like WebMatrix.</span></span>

1. <span data-ttu-id="88be0-158">Inicie WebMatrix y, en la página Inicio rápido, haga clic en **sitio desde plantilla**.</span><span class="sxs-lookup"><span data-stu-id="88be0-158">Start WebMatrix, and on the Quick Start page, click **Site From Template**.</span></span>
2. <span data-ttu-id="88be0-159">Seleccione **sitio vacío**y, en el cuadro **nombre del sitio** , escriba "SmallBakery" y, a continuación, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="88be0-159">Select **Empty Site**, and in the **Site Name** box enter "SmallBakery" and then click **OK**.</span></span> <span data-ttu-id="88be0-160">El sitio se crea y se muestra en WebMatrix.</span><span class="sxs-lookup"><span data-stu-id="88be0-160">The site is created and displayed in WebMatrix.</span></span>
3. <span data-ttu-id="88be0-161">En el panel izquierdo, haga clic en el área de trabajo **bases de datos** .</span><span class="sxs-lookup"><span data-stu-id="88be0-161">In the left pane, click the **Databases** workspace.</span></span>
4. <span data-ttu-id="88be0-162">En la cinta de opciones, haga clic en **nueva base de datos**.</span><span class="sxs-lookup"><span data-stu-id="88be0-162">In the ribbon, click **New Database**.</span></span> <span data-ttu-id="88be0-163">Se crea una base de datos vacía con el mismo nombre que el sitio.</span><span class="sxs-lookup"><span data-stu-id="88be0-163">An empty database is created with the same name as your site.</span></span>
5. <span data-ttu-id="88be0-164">En el panel izquierdo, expanda el nodo **SmallBakery. sdf** y, a continuación, haga clic en **tablas**.</span><span class="sxs-lookup"><span data-stu-id="88be0-164">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
6. <span data-ttu-id="88be0-165">En la cinta de opciones, haga clic en **nueva tabla**.</span><span class="sxs-lookup"><span data-stu-id="88be0-165">In the ribbon, click **New Table**.</span></span> <span data-ttu-id="88be0-166">WebMatrix abre el diseñador de tablas.</span><span class="sxs-lookup"><span data-stu-id="88be0-166">WebMatrix opens the table designer.</span></span>

    ![[imagen]](5-working-with-data/_static/image1.jpg)
7. <span data-ttu-id="88be0-168">Haga clic en la columna **nombre** y escriba &quot;ID&quot;.</span><span class="sxs-lookup"><span data-stu-id="88be0-168">Click in the **Name** column and enter &quot;Id&quot;.</span></span>
8. <span data-ttu-id="88be0-169">En la columna **tipo de datos** , seleccione **int**.</span><span class="sxs-lookup"><span data-stu-id="88be0-169">In the **Data Type** column, select **int**.</span></span>
9. <span data-ttu-id="88be0-170">Establezca la opción **¿es la clave principal?** y **es Identify?** en **sí**.</span><span class="sxs-lookup"><span data-stu-id="88be0-170">Set the **Is Primary Key?** and **Is Identify?** options to **Yes**.</span></span>

    <span data-ttu-id="88be0-171">Como sugiere el nombre, **is PRIMARY KEY** indica a la base de datos que será la clave principal de la tabla.</span><span class="sxs-lookup"><span data-stu-id="88be0-171">As the name suggests, **Is Primary Key** tells the database that this will be the table's primary key.</span></span> <span data-ttu-id="88be0-172">**Is Identity** indica a la base de datos que cree automáticamente un número de identificación para cada nuevo registro y lo asigne al siguiente número secuencial (empezando por 1).</span><span class="sxs-lookup"><span data-stu-id="88be0-172">**Is Identity** tells the database to automatically create an ID number for every new record and to assign it the next sequential number (starting at 1).</span></span>
10. <span data-ttu-id="88be0-173">Haga clic en la fila siguiente.</span><span class="sxs-lookup"><span data-stu-id="88be0-173">Click in the next row.</span></span> <span data-ttu-id="88be0-174">El editor inicia una nueva definición de columna.</span><span class="sxs-lookup"><span data-stu-id="88be0-174">The editor starts a new column definition.</span></span>
11. <span data-ttu-id="88be0-175">En el valor de nombre, escriba &quot;nombre&quot;.</span><span class="sxs-lookup"><span data-stu-id="88be0-175">For the Name value, enter &quot;Name&quot;.</span></span>
12. <span data-ttu-id="88be0-176">En **tipo de datos**, elija &quot;nvarchar&quot; y establezca la longitud en 50.</span><span class="sxs-lookup"><span data-stu-id="88be0-176">For **Data Type**, choose &quot;nvarchar&quot; and set the length to 50.</span></span> <span data-ttu-id="88be0-177">La parte *var* de `nvarchar` indica a la base de datos que los datos de esta columna serán una cadena cuyo tamaño puede variar de un registro a otro.</span><span class="sxs-lookup"><span data-stu-id="88be0-177">The *var* part of `nvarchar` tells the database that the data for this column will be a string whose size might vary from record to record.</span></span> <span data-ttu-id="88be0-178">(El prefijo *n* representa el *nacional*, lo que indica que el campo puede contener datos de caracteres que representan &#8212; cualquier alfabeto o sistema de escritura; es decir, que el campo contiene datos Unicode).</span><span class="sxs-lookup"><span data-stu-id="88be0-178">(The *n* prefix represents *national*, indicating that the field can hold character data that represents any alphabet or writing system &#8212; that is, that the field holds Unicode data.)</span></span>
13. <span data-ttu-id="88be0-179">Establezca la opción **permitir valores NULL** en **no**.</span><span class="sxs-lookup"><span data-stu-id="88be0-179">Set the **Allow Nulls** option to **No**.</span></span> <span data-ttu-id="88be0-180">Esto exigirá que la columna *nombre* no se deje en blanco.</span><span class="sxs-lookup"><span data-stu-id="88be0-180">This will enforce that the *Name* column is not left blank.</span></span>
14. <span data-ttu-id="88be0-181">Con este mismo proceso, cree una columna denominada *Description*.</span><span class="sxs-lookup"><span data-stu-id="88be0-181">Using this same process, create a column named *Description*.</span></span> <span data-ttu-id="88be0-182">Establezca **tipo de datos** en "nvarchar" y 50 para la longitud y establezca **permitir valores NULL** en false.</span><span class="sxs-lookup"><span data-stu-id="88be0-182">Set **Data Type** to "nvarchar" and 50 for the length, and set **Allow Nulls** to false.</span></span>
15. <span data-ttu-id="88be0-183">Cree una columna denominada *Price*.</span><span class="sxs-lookup"><span data-stu-id="88be0-183">Create a column named *Price*.</span></span> <span data-ttu-id="88be0-184">Establezca **tipo de datos en "Money"** y establezca **permitir valores NULL** en false.</span><span class="sxs-lookup"><span data-stu-id="88be0-184">Set **Data Type to "money"** and set **Allow Nulls** to false.</span></span>
16. <span data-ttu-id="88be0-185">En el cuadro de la parte superior, asigne a la tabla el nombre &quot;&quot;del producto.</span><span class="sxs-lookup"><span data-stu-id="88be0-185">In the box at the top, name the table &quot;Product&quot;.</span></span>

    <span data-ttu-id="88be0-186">Cuando haya terminado, la definición tendrá el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="88be0-186">When you're done, the definition will look like this:</span></span>

    ![[imagen]](5-working-with-data/_static/image2.png)
17. <span data-ttu-id="88be0-188">Presione CTRL + S para guardar la tabla.</span><span class="sxs-lookup"><span data-stu-id="88be0-188">Press Ctrl+S to save the table.</span></span>

## <a name="adding-data-to-the-database"></a><span data-ttu-id="88be0-189">Agregar datos a la base de datos</span><span class="sxs-lookup"><span data-stu-id="88be0-189">Adding Data to the Database</span></span>

<span data-ttu-id="88be0-190">Ahora puede agregar algunos datos de ejemplo a la base de datos con la que trabajará más adelante en el artículo.</span><span class="sxs-lookup"><span data-stu-id="88be0-190">Now you can add some sample data to your database that you'll work with later in the article.</span></span>

1. <span data-ttu-id="88be0-191">En el panel izquierdo, expanda el nodo **SmallBakery. sdf** y, a continuación, haga clic en **tablas**.</span><span class="sxs-lookup"><span data-stu-id="88be0-191">In the left pane, expand the **SmallBakery.sdf** node and then click **Tables**.</span></span>
2. <span data-ttu-id="88be0-192">Haga clic con el botón secundario en la tabla Product y, a continuación, haga clic en **datos**.</span><span class="sxs-lookup"><span data-stu-id="88be0-192">Right-click the Product table and then click **Data**.</span></span>
3. <span data-ttu-id="88be0-193">En el panel de edición, escriba los registros siguientes:</span><span class="sxs-lookup"><span data-stu-id="88be0-193">In the edit pane, enter the following records:</span></span>

    | <span data-ttu-id="88be0-194">**Name**</span><span class="sxs-lookup"><span data-stu-id="88be0-194">**Name**</span></span> | <span data-ttu-id="88be0-195">**Descripción**</span><span class="sxs-lookup"><span data-stu-id="88be0-195">**Description**</span></span> | <span data-ttu-id="88be0-196">**Tarifas**</span><span class="sxs-lookup"><span data-stu-id="88be0-196">**Price**</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="88be0-197">Pan</span><span class="sxs-lookup"><span data-stu-id="88be0-197">Bread</span></span> | <span data-ttu-id="88be0-198">Se ha incorporado cada día.</span><span class="sxs-lookup"><span data-stu-id="88be0-198">Baked fresh every day.</span></span> | <span data-ttu-id="88be0-199">2.99</span><span class="sxs-lookup"><span data-stu-id="88be0-199">2.99</span></span> |
    | <span data-ttu-id="88be0-200">Shortcake de fresa</span><span class="sxs-lookup"><span data-stu-id="88be0-200">Strawberry Shortcake</span></span> | <span data-ttu-id="88be0-201">Realizado con fresas orgánicas de nuestro jardín.</span><span class="sxs-lookup"><span data-stu-id="88be0-201">Made with organic strawberries from our garden.</span></span> | <span data-ttu-id="88be0-202">9.99</span><span class="sxs-lookup"><span data-stu-id="88be0-202">9.99</span></span> |
    | <span data-ttu-id="88be0-203">Gráfico circular de Apple</span><span class="sxs-lookup"><span data-stu-id="88be0-203">Apple Pie</span></span> | <span data-ttu-id="88be0-204">En segundo lugar, solo en el gráfico circular de su mamá.</span><span class="sxs-lookup"><span data-stu-id="88be0-204">Second only to your mom's pie.</span></span> | <span data-ttu-id="88be0-205">12.99</span><span class="sxs-lookup"><span data-stu-id="88be0-205">12.99</span></span> |
    | <span data-ttu-id="88be0-206">Pecan circular</span><span class="sxs-lookup"><span data-stu-id="88be0-206">Pecan Pie</span></span> | <span data-ttu-id="88be0-207">Si desea pecans, esto es así.</span><span class="sxs-lookup"><span data-stu-id="88be0-207">If you like pecans, this is for you.</span></span> | <span data-ttu-id="88be0-208">10.99</span><span class="sxs-lookup"><span data-stu-id="88be0-208">10.99</span></span> |
    | <span data-ttu-id="88be0-209">Círculo de limón</span><span class="sxs-lookup"><span data-stu-id="88be0-209">Lemon Pie</span></span> | <span data-ttu-id="88be0-210">Se realiza con los mejores limones del mundo.</span><span class="sxs-lookup"><span data-stu-id="88be0-210">Made with the best lemons in the world.</span></span> | <span data-ttu-id="88be0-211">11.99</span><span class="sxs-lookup"><span data-stu-id="88be0-211">11.99</span></span> |
    | <span data-ttu-id="88be0-212">Madalenas</span><span class="sxs-lookup"><span data-stu-id="88be0-212">Cupcakes</span></span> | <span data-ttu-id="88be0-213">Sus hijos y el niño que le encantarán.</span><span class="sxs-lookup"><span data-stu-id="88be0-213">Your kids and the kid in you will love these.</span></span> | <span data-ttu-id="88be0-214">7.99</span><span class="sxs-lookup"><span data-stu-id="88be0-214">7.99</span></span> |

    <span data-ttu-id="88be0-215">Recuerde que no tiene que escribir nada en la columna *ID* .</span><span class="sxs-lookup"><span data-stu-id="88be0-215">Remember that you don't have to enter anything for the *Id* column.</span></span> <span data-ttu-id="88be0-216">Al crear la columna *ID* , se establece su propiedad **is Identity** en true, lo que hace que se rellene automáticamente.</span><span class="sxs-lookup"><span data-stu-id="88be0-216">When you created the *Id* column, you set its **Is Identity** property to true, which causes it to automatically be filled in.</span></span>

    <span data-ttu-id="88be0-217">Cuando haya terminado de escribir los datos, el diseñador de tablas tendrá el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="88be0-217">When you're finished entering the data, the table designer will look like this:</span></span>

    ![[imagen]](5-working-with-data/_static/image3.jpg)
4. <span data-ttu-id="88be0-219">Cierre la pestaña que contiene los datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-219">Close the tab that contains the database data.</span></span>

## <a name="displaying-data-from-a-database"></a><span data-ttu-id="88be0-220">Mostrar datos de una base de datos</span><span class="sxs-lookup"><span data-stu-id="88be0-220">Displaying Data from a Database</span></span>

<span data-ttu-id="88be0-221">Una vez que tenga una base de datos con datos, puede mostrar los datos en una página web de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="88be0-221">Once you've got a database with data in it, you can display the data in an ASP.NET web page.</span></span> <span data-ttu-id="88be0-222">Para seleccionar las filas de la tabla que se van a mostrar, se usa una instrucción SQL, que es un comando que se pasa a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-222">To select the table rows to display, you use a SQL statement, which is a command that you pass to the database.</span></span>

1. <span data-ttu-id="88be0-223">En el panel izquierdo, haga clic en el área de trabajo **archivos** .</span><span class="sxs-lookup"><span data-stu-id="88be0-223">In the left pane, click the **Files** workspace.</span></span>
2. <span data-ttu-id="88be0-224">En la raíz del sitio web, cree una nueva página CSHTML denominada *ListProducts. CSHTML*.</span><span class="sxs-lookup"><span data-stu-id="88be0-224">In the root of the website, create a new CSHTML page named *ListProducts.cshtml*.</span></span>
3. <span data-ttu-id="88be0-225">Reemplace el marcado existente por lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-225">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample1.cshtml)]

    <span data-ttu-id="88be0-226">En el primer bloque de código, abra el archivo *SmallBakery. sdf* (base de datos) que creó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="88be0-226">In the first code block, you open the *SmallBakery.sdf* file (database) that you created earlier.</span></span> <span data-ttu-id="88be0-227">El método `Database.Open` supone que el archivo *. sdf* está en la carpeta de *datos* de la aplicación del sitio web\_.</span><span class="sxs-lookup"><span data-stu-id="88be0-227">The `Database.Open` method assumes that the *.sdf* file is in your website's *App\_Data* folder.</span></span> <span data-ttu-id="88be0-228">(Tenga en cuenta que no es necesario especificar la extensión &#8212; *. sdf* de hecho; si lo hace, no funcionará el método `Open`).</span><span class="sxs-lookup"><span data-stu-id="88be0-228">(Notice that you don't need to specify the *.sdf* extension &#8212; in fact, if you do, the `Open` method won't work.)</span></span>

    > [!NOTE]
    > <span data-ttu-id="88be0-229">La carpeta *App\_Data* es una carpeta especial de ASP.net que se usa para almacenar archivos de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-229">The *App\_Data* folder is a special folder in ASP.NET that's used to store data files.</span></span> <span data-ttu-id="88be0-230">Para obtener más información, vea [conectarse a una base de datos](#SB_ConnectingToADatabase) más adelante en este artículo.</span><span class="sxs-lookup"><span data-stu-id="88be0-230">For more information, see [Connecting to a Database](#SB_ConnectingToADatabase) later in this article.</span></span>

    <span data-ttu-id="88be0-231">A continuación, realice una solicitud para consultar la base de datos mediante la siguiente instrucción de SQL `Select`:</span><span class="sxs-lookup"><span data-stu-id="88be0-231">You then make a request to query the database using the following SQL `Select` statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample2.sql)]

    <span data-ttu-id="88be0-232">En la instrucción, `Product` identifica la tabla que se va a consultar.</span><span class="sxs-lookup"><span data-stu-id="88be0-232">In the statement, `Product` identifies the table to query.</span></span> <span data-ttu-id="88be0-233">El carácter `*` especifica que la consulta debe devolver todas las columnas de la tabla.</span><span class="sxs-lookup"><span data-stu-id="88be0-233">The `*` character specifies that the query should return all the columns from the table.</span></span> <span data-ttu-id="88be0-234">(También puede enumerar columnas individualmente, separadas por comas, si desea ver solo algunas de las columnas). La cláusula `Order By` indica cómo se deben ordenar los datos &#8212; en este caso por la columna *Name* .</span><span class="sxs-lookup"><span data-stu-id="88be0-234">(You could also list columns individually, separated by commas, if you wanted to see only some of the columns.) The `Order By` clause indicates how the data should be sorted &#8212; in this case, by the *Name* column.</span></span> <span data-ttu-id="88be0-235">Esto significa que los datos se ordenan alfabéticamente según el valor de la columna *nombre* de cada fila.</span><span class="sxs-lookup"><span data-stu-id="88be0-235">This means that the data is sorted alphabetically based on the value of the *Name* column for each row.</span></span>

    <span data-ttu-id="88be0-236">En el cuerpo de la página, el marcado crea una tabla HTML que se utilizará para mostrar los datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-236">In the body of the page, the markup creates an HTML table that will be used to display the data.</span></span> <span data-ttu-id="88be0-237">Dentro del elemento `<tbody>`, se usa un bucle de `foreach` para obtener individualmente cada fila de datos devuelta por la consulta.</span><span class="sxs-lookup"><span data-stu-id="88be0-237">Inside the `<tbody>` element, you use a `foreach` loop to individually get each data row that's returned by the query.</span></span> <span data-ttu-id="88be0-238">Para cada fila de datos, se crea una fila de tabla HTML (elemento`<tr>`).</span><span class="sxs-lookup"><span data-stu-id="88be0-238">For each data row, you create an HTML table row (`<tr>` element).</span></span> <span data-ttu-id="88be0-239">A continuación, cree las celdas de la tabla HTML (elementos`<td>`) para cada columna.</span><span class="sxs-lookup"><span data-stu-id="88be0-239">Then you create HTML table cells (`<td>` elements) for each column.</span></span> <span data-ttu-id="88be0-240">Cada vez que se recorre el bucle, la siguiente fila disponible de la base de datos se encuentra en la `row` variable (se configura en la instrucción `foreach`).</span><span class="sxs-lookup"><span data-stu-id="88be0-240">Each time you go through the loop, the next available row from the database is in the `row` variable (you set this up in the `foreach` statement).</span></span> <span data-ttu-id="88be0-241">Para obtener una columna individual de la fila, puede usar `row.Name` o `row.Description` o cualquier nombre de la columna que desee.</span><span class="sxs-lookup"><span data-stu-id="88be0-241">To get an individual column from the row, you can use `row.Name` or `row.Description` or whatever the name is of the column you want.</span></span>
4. <span data-ttu-id="88be0-242">Ejecute la página en un explorador.</span><span class="sxs-lookup"><span data-stu-id="88be0-242">Run the page in a browser.</span></span> <span data-ttu-id="88be0-243">(Asegúrese de que la página esté seleccionada en el área de trabajo **archivos** antes de ejecutarla). En la página se muestra una lista similar a la siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-243">(Make sure the page is selected in the **Files** workspace before you run it.) The page displays a list like the following:</span></span>

    ![[imagen]](5-working-with-data/_static/image4.jpg)

> [!TIP] 
> 
> <span data-ttu-id="88be0-245">**Lenguaje de consulta estructurado (SQL)**</span><span class="sxs-lookup"><span data-stu-id="88be0-245">**Structured Query Language (SQL)**</span></span>
> 
> <span data-ttu-id="88be0-246">SQL es un lenguaje que se usa en la mayoría de las bases de datos relacionales para administrar datos en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-246">SQL is a language that's used in most relational databases for managing data in a database.</span></span> <span data-ttu-id="88be0-247">Incluye comandos que permiten recuperar datos y actualizarlos, y que permiten crear, modificar y administrar tablas de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-247">It includes commands that let you retrieve data and update it, and that let you create, modify, and manage database tables.</span></span> <span data-ttu-id="88be0-248">SQL es diferente de un lenguaje de programación (como el que está usando en WebMatrix) porque con SQL, la idea es que indique a la base de datos lo que desea, y es el trabajo de la base de datos para averiguar cómo obtener los datos o realizar la tarea.</span><span class="sxs-lookup"><span data-stu-id="88be0-248">SQL is different than a programming language (like the one you're using in WebMatrix) because with SQL, the idea is that you tell the database what you want, and it's the database's job to figure out how to get the data or perform the task.</span></span> <span data-ttu-id="88be0-249">Estos son algunos ejemplos de algunos comandos SQL y lo que hacen:</span><span class="sxs-lookup"><span data-stu-id="88be0-249">Here are examples of some SQL commands and what they do:</span></span>
> 
> `SELECT Id, Name, Price FROM Product WHERE Price > 10.00 ORDER BY Name`
> 
> <span data-ttu-id="88be0-250">De esta forma se capturan las columnas de *identificador*, *nombre*y *precio* de los registros de la tabla *Product* si el valor del *precio* es superior a 10 y se devuelven los resultados en orden alfabético en función de los valores de la columna *nombre* .</span><span class="sxs-lookup"><span data-stu-id="88be0-250">This fetches the *Id*, *Name*, and *Price* columns from records in the *Product* table if the value of *Price* is more than 10, and returns the results in alphabetical order based on the values of the *Name* column.</span></span> <span data-ttu-id="88be0-251">Este comando devolverá un conjunto de resultados que contiene los registros que cumplen los criterios, o un conjunto vacío si no coinciden los registros.</span><span class="sxs-lookup"><span data-stu-id="88be0-251">This command will return a result set that contains the records that meet the criteria, or an empty set if no records match.</span></span>
> 
> `INSERT INTO Product (Name, Description, Price) VALUES ("Croissant", "A flaky delight", 1.99)`
> 
> <span data-ttu-id="88be0-252">Esto inserta un nuevo registro en la tabla *Product* , estableciendo la columna *Name* en &quot;croissant&quot;, la columna *Description* para &quot;una alegría&quot;y el precio en 1,99.</span><span class="sxs-lookup"><span data-stu-id="88be0-252">This inserts a new record into the *Product* table, setting the *Name* column to &quot;Croissant&quot;, the *Description* column to &quot;A flaky delight&quot;, and the price to 1.99.</span></span>
> 
> `DELETE FROM Product WHERE ExpirationDate < "01/01/2008"`
> 
> <span data-ttu-id="88be0-253">Este comando elimina los registros de la tabla *Product* cuya columna fecha de expiración sea anterior al 1 de enero de 2008.</span><span class="sxs-lookup"><span data-stu-id="88be0-253">This command deletes records in the *Product* table whose expiration date column is earlier than January 1, 2008.</span></span> <span data-ttu-id="88be0-254">(Esto supone que la tabla *Product* tiene una columna de este tipo, por supuesto). La fecha se escribe aquí en formato MM/DD/AAAA, pero debe escribirse en el formato que se usa para la configuración regional.</span><span class="sxs-lookup"><span data-stu-id="88be0-254">(This assumes that the *Product* table has such a column, of course.) The date is entered here in MM/DD/YYYY format, but it should be entered in the format that's used for your locale.</span></span>
> 
> <span data-ttu-id="88be0-255">Los comandos `Insert Into` y `Delete` no devuelven conjuntos de resultados.</span><span class="sxs-lookup"><span data-stu-id="88be0-255">The `Insert Into` and `Delete` commands don't return result sets.</span></span> <span data-ttu-id="88be0-256">En su lugar, devuelven un número que indica cuántos registros se vieron afectados por el comando.</span><span class="sxs-lookup"><span data-stu-id="88be0-256">Instead, they return a number that tells you how many records were affected by the command.</span></span>
> 
> <span data-ttu-id="88be0-257">En algunas de estas operaciones (como la inserción y eliminación de registros), el proceso que solicita la operación debe tener los permisos adecuados en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-257">For some of these operations (like inserting and deleting records), the process that's requesting the operation has to have appropriate permissions in the database.</span></span> <span data-ttu-id="88be0-258">Por este motivo, en el caso de las bases de datos de producción, a menudo tiene que proporcionar un nombre de usuario y una contraseña al conectarse a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-258">This is why for production databases you often have to supply a username and password when you connect to the database.</span></span>
> 
> <span data-ttu-id="88be0-259">Hay docenas de comandos SQL, pero todos siguen un patrón similar al siguiente.</span><span class="sxs-lookup"><span data-stu-id="88be0-259">There are dozens of SQL commands, but they all follow a pattern like this.</span></span> <span data-ttu-id="88be0-260">Puede usar comandos SQL para crear tablas de base de datos, contar el número de registros de una tabla, calcular precios y realizar muchas más operaciones.</span><span class="sxs-lookup"><span data-stu-id="88be0-260">You can use SQL commands to create database tables, count the number of records in a table, calculate prices, and perform many more operations.</span></span>

## <a name="inserting-data-in-a-database"></a><span data-ttu-id="88be0-261">Insertar datos en una base de datos</span><span class="sxs-lookup"><span data-stu-id="88be0-261">Inserting Data in a Database</span></span>

<span data-ttu-id="88be0-262">En esta sección se muestra cómo crear una página que permite a los usuarios agregar un nuevo producto a la tabla de la base de datos de *productos* .</span><span class="sxs-lookup"><span data-stu-id="88be0-262">This section shows how to create a page that lets users add a new product to the *Product* database table.</span></span> <span data-ttu-id="88be0-263">Después de insertar un nuevo registro de producto, la página muestra la tabla actualizada mediante la página *ListProducts. cshtml* que creó en la sección anterior.</span><span class="sxs-lookup"><span data-stu-id="88be0-263">After a new product record is inserted, the page displays the updated table using the *ListProducts.cshtml* page that you created in the previous section.</span></span>

<span data-ttu-id="88be0-264">La página incluye validación para asegurarse de que los datos especificados por el usuario son válidos para la base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-264">The page includes validation to make sure that the data that the user enters is valid for the database.</span></span> <span data-ttu-id="88be0-265">Por ejemplo, el código de la página se asegura de que se ha especificado un valor para todas las columnas necesarias.</span><span class="sxs-lookup"><span data-stu-id="88be0-265">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>

1. <span data-ttu-id="88be0-266">En el sitio web, cree un nuevo archivo CSHTML llamado *InsertProducts. CSHTML*.</span><span class="sxs-lookup"><span data-stu-id="88be0-266">In the website, create a new CSHTML file named *InsertProducts.cshtml*.</span></span>
2. <span data-ttu-id="88be0-267">Reemplace el marcado existente por lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-267">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample3.cshtml)]

    <span data-ttu-id="88be0-268">El cuerpo de la página contiene un formulario HTML con tres cuadros de texto que permiten a los usuarios escribir un nombre, una descripción y un precio.</span><span class="sxs-lookup"><span data-stu-id="88be0-268">The body of the page contains an HTML form with three text boxes that let users enter a name, description, and price.</span></span> <span data-ttu-id="88be0-269">Cuando los usuarios hacen clic en el botón **Insertar** , el código de la parte superior de la página abre una conexión a la base de datos *SmallBakery. sdf* .</span><span class="sxs-lookup"><span data-stu-id="88be0-269">When users click the **Insert** button, the code at the top of the page opens a connection to the *SmallBakery.sdf* database.</span></span> <span data-ttu-id="88be0-270">A continuación, obtiene los valores que el usuario ha enviado mediante el `Request` objeto y asigna esos valores a las variables locales.</span><span class="sxs-lookup"><span data-stu-id="88be0-270">You then get the values that the user has submitted by using the `Request` object and assign those values to local variables.</span></span>

    <span data-ttu-id="88be0-271">Para validar que el usuario ha especificado un valor para cada columna necesaria, registre cada `<input>` elemento que desea validar:</span><span class="sxs-lookup"><span data-stu-id="88be0-271">To validate that the user entered a value for each required column, you register each `<input>` element that you want to validate:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample4.cs)]

    <span data-ttu-id="88be0-272">La aplicación auxiliar de `Validation` comprueba que hay un valor en cada uno de los campos que ha registrado.</span><span class="sxs-lookup"><span data-stu-id="88be0-272">The `Validation` helper checks that there is a value in each of the fields that you've registered.</span></span> <span data-ttu-id="88be0-273">Puede comprobar si todos los campos pasaron la validación comprobando `Validation.IsValid()`, que normalmente se realizan antes de procesar la información que se obtiene del usuario:</span><span class="sxs-lookup"><span data-stu-id="88be0-273">You can test whether all the fields passed validation by checking `Validation.IsValid()`, which you typically do before you process the information you get from the user:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample5.cs)]

    <span data-ttu-id="88be0-274">(El operador `&&` significa y: esta prueba es *si se trata de un envío de formulario y todos los campos han superado la validación*).</span><span class="sxs-lookup"><span data-stu-id="88be0-274">(The `&&` operator means AND — this test is *If this is a form submission AND all the fields have passed validation*.)</span></span>

    <span data-ttu-id="88be0-275">Si todas las columnas validadas (ninguna está vacía), continúe y cree una instrucción SQL para insertar los datos y, a continuación, ejecútelo como se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="88be0-275">If all the columns validated (none were empty), you go ahead and create a SQL statement to insert the data and then execute it as shown next:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample6.cs)]

    <span data-ttu-id="88be0-276">En el caso de los valores que se van a insertar, se incluyen los marcadores de posición de los parámetros (`@0`, `@1`, `@2`).</span><span class="sxs-lookup"><span data-stu-id="88be0-276">For the values to insert, you include parameter placeholders (`@0`, `@1`, `@2`).</span></span>

    > [!NOTE]
    > <span data-ttu-id="88be0-277">Como medida de seguridad, pase siempre los valores a una instrucción SQL con parámetros, como se ve en el ejemplo anterior.</span><span class="sxs-lookup"><span data-stu-id="88be0-277">As a security precaution, always pass values to a SQL statement using parameters, as you see in the preceding example.</span></span> <span data-ttu-id="88be0-278">Esto le ofrece la oportunidad de validar los datos del usuario, además de ayudarle a protegerse contra los intentos de enviar comandos malintencionados a la base de datos (a veces denominados ataques por inyección de SQL).</span><span class="sxs-lookup"><span data-stu-id="88be0-278">This gives you a chance to validate the user's data, plus it helps protect against attempts to send malicious commands to your database (sometimes referred to as SQL injection attacks).</span></span>

    <span data-ttu-id="88be0-279">Para ejecutar la consulta, use esta instrucción, pasándole las variables que contienen los valores que se van a sustituir para los marcadores de posición:</span><span class="sxs-lookup"><span data-stu-id="88be0-279">To execute the query, you use this statement, passing to it the variables that contain the values to substitute for the placeholders:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample7.cs)]

    <span data-ttu-id="88be0-280">Una vez que se ha ejecutado la instrucción `Insert Into`, se envía al usuario a la página que muestra los productos mediante esta línea:</span><span class="sxs-lookup"><span data-stu-id="88be0-280">After the `Insert Into` statement has executed, you send the user to the page that lists the products using this line:</span></span>

    [!code-javascript[Main](5-working-with-data/samples/sample8.js)]

    <span data-ttu-id="88be0-281">Si la validación no se realizó correctamente, se omite la inserción.</span><span class="sxs-lookup"><span data-stu-id="88be0-281">If validation didn't succeed, you skip the insert.</span></span> <span data-ttu-id="88be0-282">En su lugar, tiene una aplicación auxiliar en la página que puede mostrar los mensajes de error acumulados (si existen):</span><span class="sxs-lookup"><span data-stu-id="88be0-282">Instead, you have a helper in the page that can display the accumulated error messages (if any):</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample9.cshtml)]

    <span data-ttu-id="88be0-283">Observe que el bloque de estilo del marcado incluye una definición de clase CSS denominada `.validation-summary-errors`.</span><span class="sxs-lookup"><span data-stu-id="88be0-283">Notice that the style block in the markup includes a CSS class definition named `.validation-summary-errors`.</span></span> <span data-ttu-id="88be0-284">Es el nombre de la clase CSS que se utiliza de forma predeterminada para el elemento `<div>` que contiene los errores de validación.</span><span class="sxs-lookup"><span data-stu-id="88be0-284">This is the name of the CSS class that's used by default for the `<div>` element that contains any validation errors.</span></span> <span data-ttu-id="88be0-285">En este caso, la clase CSS especifica que los errores de Resumen de validación se muestran en rojo y en negrita, pero puede definir la clase `.validation-summary-errors` para mostrar el formato que desee.</span><span class="sxs-lookup"><span data-stu-id="88be0-285">In this case, the CSS class specifies that validation summary errors are displayed in red and in bold, but you can define the `.validation-summary-errors` class to display any formatting you like.</span></span>

### <a name="testing-the-insert-page"></a><span data-ttu-id="88be0-286">Probar la página de inserción</span><span class="sxs-lookup"><span data-stu-id="88be0-286">Testing the Insert Page</span></span>

1. <span data-ttu-id="88be0-287">Vea la página en un explorador.</span><span class="sxs-lookup"><span data-stu-id="88be0-287">View the page in a browser.</span></span> <span data-ttu-id="88be0-288">La página muestra un formulario similar al que se muestra en la siguiente ilustración.</span><span class="sxs-lookup"><span data-stu-id="88be0-288">The page displays a form that's similar to the one that's shown in the following illustration.</span></span>

    ![[imagen]](5-working-with-data/_static/image5.jpg)
2. <span data-ttu-id="88be0-290">Escriba valores para todas las columnas, pero asegúrese de dejar la columna *Price* en blanco.</span><span class="sxs-lookup"><span data-stu-id="88be0-290">Enter values for all the columns, but make sure that you leave the *Price* column blank.</span></span>
3. <span data-ttu-id="88be0-291">Haga clic en **Insertar**.</span><span class="sxs-lookup"><span data-stu-id="88be0-291">Click **Insert**.</span></span> <span data-ttu-id="88be0-292">La página muestra un mensaje de error, tal y como se muestra en la siguiente ilustración.</span><span class="sxs-lookup"><span data-stu-id="88be0-292">The page displays an error message, as shown in the following illustration.</span></span> <span data-ttu-id="88be0-293">(No se crea ningún registro nuevo).</span><span class="sxs-lookup"><span data-stu-id="88be0-293">(No new record is created.)</span></span>

    ![[imagen]](5-working-with-data/_static/image6.jpg)
4. <span data-ttu-id="88be0-295">Rellene el formulario completamente y, a continuación, haga clic en **Insertar**.</span><span class="sxs-lookup"><span data-stu-id="88be0-295">Fill the form out completely, and then click **Insert**.</span></span> <span data-ttu-id="88be0-296">Esta vez, se muestra la página *ListProducts. cshtml* y se muestra el nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="88be0-296">This time, the *ListProducts.cshtml* page is displayed and shows the new record.</span></span>

## <a name="updating-data-in-a-database"></a><span data-ttu-id="88be0-297">Actualizar datos en una base de datos</span><span class="sxs-lookup"><span data-stu-id="88be0-297">Updating Data in a Database</span></span>

<span data-ttu-id="88be0-298">Una vez especificados los datos en una tabla, es posible que tenga que actualizarlos.</span><span class="sxs-lookup"><span data-stu-id="88be0-298">After data has been entered into a table, you might need to update it.</span></span> <span data-ttu-id="88be0-299">En este procedimiento se muestra cómo crear dos páginas que son similares a las que creó anteriormente para la inserción de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-299">This procedure shows you how to create two pages that are similar to the ones you created for data insertion earlier.</span></span> <span data-ttu-id="88be0-300">La primera página muestra productos y permite a los usuarios seleccionar uno para cambiar.</span><span class="sxs-lookup"><span data-stu-id="88be0-300">The first page displays products and lets users select one to change.</span></span> <span data-ttu-id="88be0-301">La segunda página permite que los usuarios realicen realmente las modificaciones y las guarden.</span><span class="sxs-lookup"><span data-stu-id="88be0-301">The second page lets the users actually make the edits and save them.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="88be0-302">**Importante** En un sitio web de producción, normalmente se restringe quién tiene permiso para realizar cambios en los datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-302">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="88be0-303">Para obtener información acerca de cómo configurar la pertenencia y sobre cómo autorizar a los usuarios para que realicen tareas en el sitio, consulte [adición de seguridad y pertenencia a un sitio de ASP.NET Web pages](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="88be0-303">For information about how to set up membership and about ways to authorize users to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>

1. <span data-ttu-id="88be0-304">En el sitio web, cree un nuevo archivo CSHTML llamado *EditProducts. CSHTML*.</span><span class="sxs-lookup"><span data-stu-id="88be0-304">In the website, create a new CSHTML file named *EditProducts.cshtml*.</span></span>
2. <span data-ttu-id="88be0-305">Reemplace el marcado existente en el archivo por lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-305">Replace the existing markup in the file with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample10.cshtml)]

    <span data-ttu-id="88be0-306">La única diferencia entre esta página y la página *ListProducts. cshtml* anterior es que la tabla HTML de esta página incluye una columna adicional que muestra un vínculo de **edición** .</span><span class="sxs-lookup"><span data-stu-id="88be0-306">The only difference between this page and the *ListProducts.cshtml* page from earlier is that the HTML table in this page includes an extra column that displays an **Edit** link.</span></span> <span data-ttu-id="88be0-307">Al hacer clic en este vínculo, se le remite a la página *UpdateProducts. cshtml* (que creará a continuación), donde puede editar el registro seleccionado.</span><span class="sxs-lookup"><span data-stu-id="88be0-307">When you click this link, it takes you to the *UpdateProducts.cshtml* page (which you'll create next) where you can edit the selected record.</span></span>

    <span data-ttu-id="88be0-308">Examine el código que crea el vínculo de **edición** :</span><span class="sxs-lookup"><span data-stu-id="88be0-308">Look at the code that creates the **Edit** link:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample11.cshtml)]

    <span data-ttu-id="88be0-309">Esto crea un elemento de `<a>` HTML cuyo atributo de `href` se establece dinámicamente.</span><span class="sxs-lookup"><span data-stu-id="88be0-309">This creates an HTML `<a>` element whose `href` attribute is set dynamically.</span></span> <span data-ttu-id="88be0-310">El atributo `href` especifica la página que se va a mostrar cuando el usuario haga clic en el vínculo.</span><span class="sxs-lookup"><span data-stu-id="88be0-310">The `href` attribute specifies the page to display when the user clicks the link.</span></span> <span data-ttu-id="88be0-311">También pasa el valor `Id` de la fila actual al vínculo.</span><span class="sxs-lookup"><span data-stu-id="88be0-311">It also passes the `Id` value of the current row to the link.</span></span> <span data-ttu-id="88be0-312">Cuando se ejecuta la página, el origen de la página podría contener vínculos como estos:</span><span class="sxs-lookup"><span data-stu-id="88be0-312">When the page runs, the page source might contain links like these:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample12.html)]

    <span data-ttu-id="88be0-313">Observe que el atributo `href` está establecido en `UpdateProducts/n`, donde *n* es un número de producto.</span><span class="sxs-lookup"><span data-stu-id="88be0-313">Notice that the `href` attribute is set to `UpdateProducts/n`, where *n* is a product number.</span></span> <span data-ttu-id="88be0-314">Cuando un usuario hace clic en uno de estos vínculos, la dirección URL resultante tendrá un aspecto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-314">When a user clicks one of these links, the resulting URL will look something like this:</span></span>

    `http://localhost:18816/UpdateProducts/6`

    <span data-ttu-id="88be0-315">En otras palabras, el número de producto que se va a editar se pasará en la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="88be0-315">In other words, the product number to be edited will be passed in the URL.</span></span>
3. <span data-ttu-id="88be0-316">Vea la página en un explorador.</span><span class="sxs-lookup"><span data-stu-id="88be0-316">View the page in a browser.</span></span> <span data-ttu-id="88be0-317">La página muestra los datos en un formato similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-317">The page displays the data in a format like this:</span></span>

    ![[imagen]](5-working-with-data/_static/image7.jpg)

    <span data-ttu-id="88be0-319">A continuación, creará la página que permite a los usuarios actualizar realmente los datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-319">Next, you'll create the page that lets users actually update the data.</span></span> <span data-ttu-id="88be0-320">La página de actualización incluye validación para validar los datos especificados por el usuario.</span><span class="sxs-lookup"><span data-stu-id="88be0-320">The update page includes validation to validate the data that the user enters.</span></span> <span data-ttu-id="88be0-321">Por ejemplo, el código de la página se asegura de que se ha especificado un valor para todas las columnas necesarias.</span><span class="sxs-lookup"><span data-stu-id="88be0-321">For example, code in the page makes sure that a value has been entered for all required columns.</span></span>
4. <span data-ttu-id="88be0-322">En el sitio web, cree un nuevo archivo CSHTML llamado *UpdateProducts. CSHTML*.</span><span class="sxs-lookup"><span data-stu-id="88be0-322">In the website, create a new CSHTML file named *UpdateProducts.cshtml*.</span></span>
5. <span data-ttu-id="88be0-323">Reemplace el marcado existente en el archivo por lo siguiente.</span><span class="sxs-lookup"><span data-stu-id="88be0-323">Replace the existing markup in the file with the following.</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample13.cshtml)]

    <span data-ttu-id="88be0-324">El cuerpo de la página contiene un formulario HTML en el que se muestra un producto y donde los usuarios pueden modificarlo.</span><span class="sxs-lookup"><span data-stu-id="88be0-324">The body of the page contains an HTML form where a product is displayed and where users can edit it.</span></span> <span data-ttu-id="88be0-325">Para ver el producto que se va a mostrar, use esta instrucción SQL:</span><span class="sxs-lookup"><span data-stu-id="88be0-325">To get the product to display, you use this SQL statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample14.sql)]

    <span data-ttu-id="88be0-326">Se seleccionará el producto cuyo identificador coincida con el valor que se pasa en el parámetro `@0`.</span><span class="sxs-lookup"><span data-stu-id="88be0-326">This will select the product whose ID matches the value that's passed in the `@0` parameter.</span></span> <span data-ttu-id="88be0-327">(Dado que el *identificador* es la clave principal y, por tanto, debe ser único, solo se puede seleccionar un registro de producto de esta manera). Para obtener el valor de identificador que se va a pasar a esta instrucción `Select`, puede leer el valor que se pasa a la página como parte de la dirección URL con la siguiente sintaxis:</span><span class="sxs-lookup"><span data-stu-id="88be0-327">(Because *Id* is the primary key and therefore must be unique, only one product record can ever be selected this way.) To get the ID value to pass to this `Select` statement, you can read the value that's passed to the page as part of the URL, using the following syntax:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample15.cs)]

    <span data-ttu-id="88be0-328">Para obtener realmente el registro del producto, use el método `QuerySingle`, que devolverá solo un registro:</span><span class="sxs-lookup"><span data-stu-id="88be0-328">To actually fetch the product record, you use the `QuerySingle` method, which will return just one record:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample16.cs)]

    <span data-ttu-id="88be0-329">La única fila se devuelve a la variable `row`.</span><span class="sxs-lookup"><span data-stu-id="88be0-329">The single row is returned into the `row` variable.</span></span> <span data-ttu-id="88be0-330">Puede obtener datos de cada columna y asignarlos a variables locales de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="88be0-330">You can get data out of each column and assign it to local variables like this:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample17.cs)]

    <span data-ttu-id="88be0-331">En el marcado del formulario, estos valores se muestran automáticamente en cuadros de texto individuales mediante el uso de código incrustado como el siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-331">In the markup for the form, these values are displayed automatically in individual text boxes by using embedded code like the following:</span></span>

    [!code-html[Main](5-working-with-data/samples/sample18.html)]

    <span data-ttu-id="88be0-332">Esa parte del código muestra el registro del producto que se va a actualizar.</span><span class="sxs-lookup"><span data-stu-id="88be0-332">That part of the code displays the product record to be updated.</span></span> <span data-ttu-id="88be0-333">Una vez que se muestra el registro, el usuario puede editar columnas individuales.</span><span class="sxs-lookup"><span data-stu-id="88be0-333">Once the record has been displayed, the user can edit individual columns.</span></span>

    <span data-ttu-id="88be0-334">Cuando el usuario envía el formulario haciendo clic en el botón **Actualizar** , se ejecuta el código del bloque `if(IsPost)`.</span><span class="sxs-lookup"><span data-stu-id="88be0-334">When the user submits the form by clicking the **Update** button, the code in the `if(IsPost)` block runs.</span></span> <span data-ttu-id="88be0-335">Esto obtiene los valores del usuario del objeto `Request`, almacena los valores en las variables y comprueba que se ha rellenado cada columna.</span><span class="sxs-lookup"><span data-stu-id="88be0-335">This gets the user's values from the `Request` object, stores the values in variables, and validates that each column has been filled in.</span></span> <span data-ttu-id="88be0-336">Si la validación es correcta, el código crea la siguiente instrucción UPDATE de SQL:</span><span class="sxs-lookup"><span data-stu-id="88be0-336">If validation passes, the code creates the following SQL Update statement:</span></span>

    [!code-sql[Main](5-working-with-data/samples/sample19.sql)]

    <span data-ttu-id="88be0-337">En una instrucción de `Update` de SQL, se especifica cada columna que se va a actualizar y el valor en el que se va a establecer.</span><span class="sxs-lookup"><span data-stu-id="88be0-337">In a SQL `Update` statement, you specify each column to update and the value to set it to.</span></span> <span data-ttu-id="88be0-338">En este código, los valores se especifican mediante los marcadores de posición de parámetro `@0`, `@1`, `@2`, etc.</span><span class="sxs-lookup"><span data-stu-id="88be0-338">In this code, the values are specified using the parameter placeholders `@0`, `@1`, `@2`, and so on.</span></span> <span data-ttu-id="88be0-339">(Como se indicó anteriormente, para la seguridad, siempre debe pasar valores a una instrucción SQL mediante parámetros).</span><span class="sxs-lookup"><span data-stu-id="88be0-339">(As noted earlier, for security, you should always pass values to a SQL statement by using parameters.)</span></span>

    <span data-ttu-id="88be0-340">Cuando se llama al método `db.Execute`, se pasan las variables que contienen los valores en el orden que corresponde a los parámetros de la instrucción SQL:</span><span class="sxs-lookup"><span data-stu-id="88be0-340">When you call the `db.Execute` method, you pass the variables that contain the values in the order that corresponds to the parameters in the SQL statement:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample20.cs)]

    <span data-ttu-id="88be0-341">Una vez ejecutada la instrucción `Update`, se llama al método siguiente para redirigir al usuario de nuevo a la página de edición:</span><span class="sxs-lookup"><span data-stu-id="88be0-341">After the `Update` statement has been executed, you call the following method in order to redirect the user back to the edit page:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample21.cshtml)]

    <span data-ttu-id="88be0-342">El efecto es que el usuario ve una lista actualizada de los datos en la base de datos y puede editar otro producto.</span><span class="sxs-lookup"><span data-stu-id="88be0-342">The effect is that the user sees an updated listing of the data in the database and can edit another product.</span></span>
6. <span data-ttu-id="88be0-343">Guarde la página.</span><span class="sxs-lookup"><span data-stu-id="88be0-343">Save the page.</span></span>
7. <span data-ttu-id="88be0-344">Ejecute la página *EditProducts. cshtml* (no la página actualizar) y, a continuación, haga clic en **Editar** para seleccionar un producto para editarlo.</span><span class="sxs-lookup"><span data-stu-id="88be0-344">Run the *EditProducts.cshtml* page (not the update page) and then click **Edit** to select a product to edit.</span></span> <span data-ttu-id="88be0-345">Se muestra la página *UpdateProducts. cshtml* , en la que se muestra el registro que ha seleccionado.</span><span class="sxs-lookup"><span data-stu-id="88be0-345">The *UpdateProducts.cshtml* page is displayed, showing the record you selected.</span></span>

    ![[imagen]](5-working-with-data/_static/image8.jpg)
8. <span data-ttu-id="88be0-347">Realice un cambio y haga clic en **Actualizar**.</span><span class="sxs-lookup"><span data-stu-id="88be0-347">Make a change and click **Update**.</span></span> <span data-ttu-id="88be0-348">La lista de productos se muestra de nuevo con los datos actualizados.</span><span class="sxs-lookup"><span data-stu-id="88be0-348">The products list is shown again with your updated data.</span></span>

## <a name="deleting-data-in-a-database"></a><span data-ttu-id="88be0-349">Eliminar datos en una base de datos</span><span class="sxs-lookup"><span data-stu-id="88be0-349">Deleting Data in a Database</span></span>

<span data-ttu-id="88be0-350">En esta sección se muestra cómo permitir que los usuarios eliminen un producto de la tabla de la base de datos *Product* .</span><span class="sxs-lookup"><span data-stu-id="88be0-350">This section shows how to let users delete a product from the *Product* database table.</span></span> <span data-ttu-id="88be0-351">El ejemplo consta de dos páginas.</span><span class="sxs-lookup"><span data-stu-id="88be0-351">The example consists of two pages.</span></span> <span data-ttu-id="88be0-352">En la primera página, los usuarios seleccionan un registro para eliminar.</span><span class="sxs-lookup"><span data-stu-id="88be0-352">In the first page, users select a record to delete.</span></span> <span data-ttu-id="88be0-353">El registro que se va a eliminar se muestra en una segunda página que les permite confirmar que desea eliminar el registro.</span><span class="sxs-lookup"><span data-stu-id="88be0-353">The record to be deleted is then displayed in a second page that lets them confirm that they want to delete the record.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="88be0-354">**Importante** En un sitio web de producción, normalmente se restringe quién tiene permiso para realizar cambios en los datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-354">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="88be0-355">Para obtener información acerca de cómo configurar la pertenencia y acerca de cómo autorizar a los usuarios para que realicen tareas en el sitio, consulte [adición de seguridad y pertenencia a un sitio de ASP.NET Web pages](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="88be0-355">For information about how to set up membership and about ways to authorize user to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>

1. <span data-ttu-id="88be0-356">En el sitio web, cree un nuevo archivo CSHTML llamado *ListProductsForDelete. CSHTML*.</span><span class="sxs-lookup"><span data-stu-id="88be0-356">In the website, create a new CSHTML file named *ListProductsForDelete.cshtml*.</span></span>
2. <span data-ttu-id="88be0-357">Reemplace el marcado existente por lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-357">Replace the existing markup with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample22.cshtml)]

    <span data-ttu-id="88be0-358">Esta página es similar a la página *EditProducts. cshtml* anterior.</span><span class="sxs-lookup"><span data-stu-id="88be0-358">This page is similar to the *EditProducts.cshtml* page from earlier.</span></span> <span data-ttu-id="88be0-359">Sin embargo, en lugar de mostrar un vínculo de **edición** para cada producto, muestra un vínculo de **eliminación** .</span><span class="sxs-lookup"><span data-stu-id="88be0-359">However, instead of displaying an **Edit** link for each product, it displays a **Delete** link.</span></span> <span data-ttu-id="88be0-360">El vínculo de **eliminación** se crea con el siguiente código incrustado en el marcado:</span><span class="sxs-lookup"><span data-stu-id="88be0-360">The **Delete** link is created using the following embedded code in the markup:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample23.cshtml)]

    <span data-ttu-id="88be0-361">Esto crea una dirección URL que tiene este aspecto cuando los usuarios hacen clic en el vínculo:</span><span class="sxs-lookup"><span data-stu-id="88be0-361">This creates a URL that looks like this when users click the link:</span></span>

    `http://<server>/DeleteProduct/4`

    <span data-ttu-id="88be0-362">La dirección URL llama a una página denominada *DeleteProduct. cshtml* (que creará a continuación) y le pasa el identificador del producto que se va a eliminar (aquí, 4).</span><span class="sxs-lookup"><span data-stu-id="88be0-362">The URL calls a page named *DeleteProduct.cshtml* (which you'll create next) and passes it the ID of the product to delete (here, 4).</span></span>
3. <span data-ttu-id="88be0-363">Guarde el archivo, pero déjelo abierto.</span><span class="sxs-lookup"><span data-stu-id="88be0-363">Save the file, but leave it open.</span></span>
4. <span data-ttu-id="88be0-364">Cree otro archivo CHTML llamado *DeleteProduct. cshtml*.</span><span class="sxs-lookup"><span data-stu-id="88be0-364">Create another CHTML file named *DeleteProduct.cshtml*.</span></span> <span data-ttu-id="88be0-365">Reemplace el contenido existente por lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-365">Replace the existing content with the following:</span></span>

    [!code-cshtml[Main](5-working-with-data/samples/sample24.cshtml)]

    <span data-ttu-id="88be0-366">*ListProductsForDelete. cshtml* llama a esta página y permite a los usuarios confirmar que desean eliminar un producto.</span><span class="sxs-lookup"><span data-stu-id="88be0-366">This page is called by *ListProductsForDelete.cshtml* and lets users confirm that they want to delete a product.</span></span> <span data-ttu-id="88be0-367">Para enumerar el producto que se va a eliminar, obtenga el identificador del producto que se va a eliminar de la dirección URL mediante el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-367">To list the product to be deleted, you get the ID of the product to delete from the URL using the following code:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample25.cs)]

    <span data-ttu-id="88be0-368">A continuación, la página pide al usuario que haga clic en un botón para eliminar realmente el registro.</span><span class="sxs-lookup"><span data-stu-id="88be0-368">The page then asks the user to click a button to actually delete the record.</span></span> <span data-ttu-id="88be0-369">Esta es una medida de seguridad importante: al realizar operaciones confidenciales en el sitio web como actualizar o eliminar datos, estas operaciones se deben realizar siempre mediante una operación POST, no una operación GET.</span><span class="sxs-lookup"><span data-stu-id="88be0-369">This is an important security measure: when you perform sensitive operations in your website like updating or deleting data, these operations should always be done using a POST operation, not a GET operation.</span></span> <span data-ttu-id="88be0-370">Si el sitio está configurado para que se pueda realizar una operación de eliminación mediante una operación GET, cualquiera puede pasar una dirección URL como `http://<server>/DeleteProduct/4` y eliminar todo lo que desee de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-370">If your site is set up so that a delete operation can be performed using a GET operation, anyone can pass a URL like `http://<server>/DeleteProduct/4` and delete anything they want from your database.</span></span> <span data-ttu-id="88be0-371">Agregando la confirmación y codificando la página para que la eliminación pueda realizarse solo mediante una publicación, agregue una medida de seguridad a su sitio.</span><span class="sxs-lookup"><span data-stu-id="88be0-371">By adding the confirmation and coding the page so that the deletion can be performed only by using a POST, you add a measure of security to your site.</span></span>

    <span data-ttu-id="88be0-372">La operación de eliminación real se realiza mediante el código siguiente, que primero confirma que se trata de una operación post y que el identificador no está vacío:</span><span class="sxs-lookup"><span data-stu-id="88be0-372">The actual delete operation is performed using the following code, which first confirms that this is a post operation and that the ID isn't empty:</span></span>

    [!code-csharp[Main](5-working-with-data/samples/sample26.cs)]

    <span data-ttu-id="88be0-373">El código ejecuta una instrucción SQL que elimina el registro especificado y, a continuación, redirige al usuario a la página de lista.</span><span class="sxs-lookup"><span data-stu-id="88be0-373">The code runs a SQL statement that deletes the specified record and then redirects the user back to the listing page.</span></span>
5. <span data-ttu-id="88be0-374">Ejecute *ListProductsForDelete. cshtml* en un explorador.</span><span class="sxs-lookup"><span data-stu-id="88be0-374">Run *ListProductsForDelete.cshtml* in a browser.</span></span>

    ![[imagen]](5-working-with-data/_static/image9.jpg)
6. <span data-ttu-id="88be0-376">Haga clic en el vínculo **eliminar** de uno de los productos.</span><span class="sxs-lookup"><span data-stu-id="88be0-376">Click the **Delete** link for one of the products.</span></span> <span data-ttu-id="88be0-377">Se muestra la página *DeleteProduct. cshtml* para confirmar que desea eliminar ese registro.</span><span class="sxs-lookup"><span data-stu-id="88be0-377">The *DeleteProduct.cshtml* page is displayed to confirm that you want to delete that record.</span></span>
7. <span data-ttu-id="88be0-378">Haga clic en el botón **Eliminar** .</span><span class="sxs-lookup"><span data-stu-id="88be0-378">Click the **Delete** button.</span></span> <span data-ttu-id="88be0-379">Se elimina el registro del producto y se actualiza la página con una lista de productos actualizada.</span><span class="sxs-lookup"><span data-stu-id="88be0-379">The product record is deleted and the page is refreshed with an updated product listing.</span></span>

> [!TIP]
> 
> <a id="SB_ConnectingToADatabase"></a>
> ### <a name="connecting-to-a-database"></a><span data-ttu-id="88be0-380">Conectar a una base de datos</span><span class="sxs-lookup"><span data-stu-id="88be0-380">Connecting to a Database</span></span>
> 
> <span data-ttu-id="88be0-381">Puede conectarse a una base de datos de dos maneras.</span><span class="sxs-lookup"><span data-stu-id="88be0-381">You can connect to a database in two ways.</span></span> <span data-ttu-id="88be0-382">La primera es usar el método `Database.Open` y especificar el nombre del archivo de base de datos (menos la extensión *. sdf* ):</span><span class="sxs-lookup"><span data-stu-id="88be0-382">The first is to use the `Database.Open` method and to specify the name of the database file (less the *.sdf* extension):</span></span>
> 
> `var db = Database.Open("SmallBakery");`
> 
> <span data-ttu-id="88be0-383">El método `Open` supone que. el archivo *SDF* está en la carpeta de\_de la *aplicación* del sitio Web.</span><span class="sxs-lookup"><span data-stu-id="88be0-383">The `Open` method assumes that the .*sdf* file is in the website's *App\_Data* folder.</span></span> <span data-ttu-id="88be0-384">Esta carpeta está diseñada específicamente para contener datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-384">This folder is designed specifically for holding data.</span></span> <span data-ttu-id="88be0-385">Por ejemplo, tiene los permisos adecuados para permitir que el sitio web Lea y escriba datos, y como medida de seguridad, WebMatrix no permite el acceso a los archivos de esta carpeta.</span><span class="sxs-lookup"><span data-stu-id="88be0-385">For example, it has appropriate permissions to allow the website to read and write data, and as a security measure, WebMatrix does not allow access to files from this folder.</span></span>
> 
> <span data-ttu-id="88be0-386">La segunda manera es usar una cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="88be0-386">The second way is to use a connection string.</span></span> <span data-ttu-id="88be0-387">Una cadena de conexión contiene información sobre cómo conectarse a una base de datos.</span><span class="sxs-lookup"><span data-stu-id="88be0-387">A connection string contains information about how to connect to a database.</span></span> <span data-ttu-id="88be0-388">Esto puede incluir una ruta de acceso de archivo o puede incluir el nombre de una SQL Server base de datos en un servidor local o remoto, junto con un nombre de usuario y una contraseña para conectarse a ese servidor.</span><span class="sxs-lookup"><span data-stu-id="88be0-388">This can include a file path, or it can include the name of a SQL Server database on a local or remote server, along with a user name and password to connect to that server.</span></span> <span data-ttu-id="88be0-389">(Si mantiene los datos en una versión administrada centralmente de SQL Server, como en el sitio de un proveedor de hospedaje, siempre se usa una cadena de conexión para especificar la información de conexión a la base de datos).</span><span class="sxs-lookup"><span data-stu-id="88be0-389">(If you keep data in a centrally managed version of SQL Server, such as on a hosting provider's site, you always use a connection string to specify the database connection information.)</span></span>
> 
> <span data-ttu-id="88be0-390">En WebMatrix, las cadenas de conexión suelen almacenarse en un archivo XML denominado *Web. config*. Como implica el nombre, puede usar un archivo *Web. config* en la raíz de su sitio web para almacenar la información de configuración del sitio, incluidas las cadenas de conexión que el sitio pueda necesitar.</span><span class="sxs-lookup"><span data-stu-id="88be0-390">In WebMatrix, connection strings are usually stored in an XML file named *Web.config*. As the name implies, you can use a *Web.config* file in the root of your website to store the site's configuration information, including any connection strings that your site might require.</span></span> <span data-ttu-id="88be0-391">Un ejemplo de una cadena de conexión en un archivo *Web. config* podría ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="88be0-391">An example of a connection string in a *Web.config* file might look like the following:</span></span>
> 
> [!code-xml[Main](5-working-with-data/samples/sample27.xml)]
> 
> <span data-ttu-id="88be0-392">En el ejemplo, la cadena de conexión apunta a una base de datos en una instancia de SQL Server que se ejecuta en un servidor en algún lugar (en lugar de un archivo *. sdf* local).</span><span class="sxs-lookup"><span data-stu-id="88be0-392">In the example, the connection string points to a database in an instance of SQL Server that's running on a server somewhere (as opposed to a local *.sdf* file).</span></span> <span data-ttu-id="88be0-393">Deberá sustituir los nombres adecuados por `myServer` y `myDatabase`, y especificar SQL Server valores de inicio de sesión para `username` y `password`.</span><span class="sxs-lookup"><span data-stu-id="88be0-393">You would need to substitute the appropriate names for `myServer` and `myDatabase`, and specify SQL Server login values for `username` and `password`.</span></span> <span data-ttu-id="88be0-394">(Los valores de nombre de usuario y contraseña no son necesariamente los mismos que las credenciales de Windows o como los valores que el proveedor de hospedaje le ha dado para iniciar sesión en sus servidores.</span><span class="sxs-lookup"><span data-stu-id="88be0-394">(The username and password values are not necessarily the same as your Windows credentials or as the values that your hosting provider has given you for logging in to their servers.</span></span> <span data-ttu-id="88be0-395">Consulte con el administrador los valores exactos que necesita).</span><span class="sxs-lookup"><span data-stu-id="88be0-395">Check with the administrator for the exact values you need.)</span></span>
> 
> <span data-ttu-id="88be0-396">El método `Database.Open` es flexible, porque le permite pasar el nombre de un archivo *. sdf* de base de datos o el nombre de una cadena de conexión que se almacena en el archivo *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="88be0-396">The `Database.Open` method is flexible, because it lets you pass either the name of a database *.sdf* file or the name of a connection string that's stored in the *Web.config* file.</span></span> <span data-ttu-id="88be0-397">En el ejemplo siguiente se muestra cómo conectarse a la base de datos mediante la cadena de conexión que se muestra en el ejemplo anterior:</span><span class="sxs-lookup"><span data-stu-id="88be0-397">The following example shows how to connect to the database using the connection string illustrated in the previous example:</span></span>
> 
> [!code-cshtml[Main](5-working-with-data/samples/sample28.cshtml)]
> 
> <span data-ttu-id="88be0-398">Como se indicó, el método `Database.Open` le permite pasar un nombre de base de datos o una cadena de conexión y descubrirá cuál usar.</span><span class="sxs-lookup"><span data-stu-id="88be0-398">As noted, the `Database.Open` method lets you pass either a database name or a connection string, and it'll figure out which to use.</span></span> <span data-ttu-id="88be0-399">Esto resulta muy útil al implementar (publicar) el sitio Web.</span><span class="sxs-lookup"><span data-stu-id="88be0-399">This is very useful when you deploy (publish) your website.</span></span> <span data-ttu-id="88be0-400">Puede usar un archivo *. sdf* en la carpeta *App\_Data* al desarrollar y probar el sitio.</span><span class="sxs-lookup"><span data-stu-id="88be0-400">You can use an *.sdf* file in the *App\_Data* folder when you're developing and testing your site.</span></span> <span data-ttu-id="88be0-401">Después, cuando mueva el sitio a un servidor de producción, puede usar una cadena de conexión en el archivo *Web. config* que tenga el mismo nombre que el archivo *. sdf* , pero que apunte a la base de &#8212; datos del proveedor de hospedaje sin tener que cambiar el código.</span><span class="sxs-lookup"><span data-stu-id="88be0-401">Then when you move your site to a production server, you can use a connection string in the *Web.config* file that has the same name as your *.sdf* file but that points to the hosting provider's database &#8212; all without having to change your code.</span></span>
> 
> <span data-ttu-id="88be0-402">Por último, si desea trabajar directamente con una cadena de conexión, puede llamar al método `Database.OpenConnectionString` y pasar la cadena de conexión real en lugar de simplemente el nombre de una en el archivo *Web. config* .</span><span class="sxs-lookup"><span data-stu-id="88be0-402">Finally, if you want to work directly with a connection string, you can call the `Database.OpenConnectionString` method and pass it the actual connection string instead of just the name of one in the *Web.config* file.</span></span> <span data-ttu-id="88be0-403">Esto puede resultar útil en situaciones en las que, por algún motivo, no se tiene acceso a la cadena de conexión (o a los valores que contiene, como el nombre de archivo *. sdf* ) hasta que se ejecuta la página.</span><span class="sxs-lookup"><span data-stu-id="88be0-403">This might be useful in situations where for some reason you don't have access to the connection string (or values in it, such as the *.sdf* file name) until the page is running.</span></span> <span data-ttu-id="88be0-404">Sin embargo, para la mayoría de los escenarios, puede usar `Database.Open` tal y como se describe en este artículo.</span><span class="sxs-lookup"><span data-stu-id="88be0-404">However, for most scenarios, you can use `Database.Open` as described in this article.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="88be0-405">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="88be0-405">Additional Resources</span></span>

- [<span data-ttu-id="88be0-406">SQL Server Compact</span><span class="sxs-lookup"><span data-stu-id="88be0-406">SQL Server Compact</span></span>](https://www.microsoft.com/sqlserver/2008/en/us/compact.aspx)
- [<span data-ttu-id="88be0-407">Conexión a una base de datos SQL Server o MySQL en WebMatrix</span><span class="sxs-lookup"><span data-stu-id="88be0-407">Connecting to a SQL Server or MySQL Database in WebMatrix</span></span>](https://go.microsoft.com/fwlink/?LinkId=208661)
- [<span data-ttu-id="88be0-408">Validar la entrada del usuario en los sitios de ASP.NET Web Pages</span><span class="sxs-lookup"><span data-stu-id="88be0-408">Validating User Input in ASP.NET Web Pages Sites</span></span>](https://go.microsoft.com/fwlink/?LinkId=253002)

---
uid: web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
title: Agregar una columna GridView de casillas (VB) | Microsoft Docs
author: rick-anderson
description: En este tutorial se examina cómo agregar una columna de casillas de verificación a un control GridView para proporcionar al usuario una manera intuitiva de seleccionar varias filas de la...
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 39253d05-75c0-41c7-b9d4-a6c58ecf69ce
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
msc.type: authoredcontent
ms.openlocfilehash: c620b2eac5844d4030c1309b45e7d6a72d1f386a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78491887"
---
# <a name="adding-a-gridview-column-of-checkboxes-vb"></a><span data-ttu-id="62a93-103">Agregar una columna GridView de casillas de verificación (VB)</span><span class="sxs-lookup"><span data-stu-id="62a93-103">Adding a GridView Column of Checkboxes (VB)</span></span>

<span data-ttu-id="62a93-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="62a93-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="62a93-105">[Descarga](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe) de la aplicación de ejemplo o [descarga de PDF](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="62a93-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe) or [Download PDF](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span></span>

> <span data-ttu-id="62a93-106">En este tutorial se examina cómo agregar una columna de casillas de verificación a un control GridView para proporcionar al usuario una manera intuitiva de seleccionar varias filas de GridView.</span><span class="sxs-lookup"><span data-stu-id="62a93-106">This tutorial looks at how to add a column of check boxes to a GridView control to provide the user with an intuitive way of selecting multiple rows of the GridView.</span></span>

## <a name="introduction"></a><span data-ttu-id="62a93-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="62a93-107">Introduction</span></span>

<span data-ttu-id="62a93-108">En el tutorial anterior, hemos examinado cómo agregar una columna de botones de radio a GridView con el fin de seleccionar un registro determinado.</span><span class="sxs-lookup"><span data-stu-id="62a93-108">In the preceding tutorial we examined how to add a column of radio buttons to the GridView for the purpose of selecting a particular record.</span></span> <span data-ttu-id="62a93-109">Una columna de botones de radio es una interfaz de usuario adecuada cuando el usuario está limitado a elegir como máximo un elemento de la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="62a93-109">A column of radio buttons is a suitable user interface when the user is limited to choosing at most one item from the grid.</span></span> <span data-ttu-id="62a93-110">Sin embargo, en ocasiones, es posible que desee permitir que el usuario seleccione un número arbitrario de elementos de la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="62a93-110">At times, however, we may want to allow the user to pick an arbitrary number of items from the grid.</span></span> <span data-ttu-id="62a93-111">Los clientes de correo electrónico basados en Web, por ejemplo, suelen mostrar la lista de mensajes con una columna de casillas.</span><span class="sxs-lookup"><span data-stu-id="62a93-111">Web-based email clients, for example, typically display the list of messages with a column of checkboxes.</span></span> <span data-ttu-id="62a93-112">El usuario puede seleccionar un número arbitrario de mensajes y, a continuación, realizar alguna acción, como mover los mensajes de correo electrónico a otra carpeta o eliminarlos.</span><span class="sxs-lookup"><span data-stu-id="62a93-112">The user can select an arbitrary number of messages and then perform some action, such as moving the emails to another folder or deleting them.</span></span>

<span data-ttu-id="62a93-113">En este tutorial, veremos cómo agregar una columna de casillas y cómo determinar qué casillas se comprobó en el PostBack.</span><span class="sxs-lookup"><span data-stu-id="62a93-113">In this tutorial we will see how to add a column of checkboxes and how to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="62a93-114">En concreto, vamos a crear un ejemplo que imita la interfaz de usuario del cliente de correo electrónico basado en Web.</span><span class="sxs-lookup"><span data-stu-id="62a93-114">In particular, we'll build an example that closely mimics the web-based email client user interface.</span></span> <span data-ttu-id="62a93-115">En nuestro ejemplo se incluye un control GridView paginado que muestra los productos de la tabla de base de datos `Products` con una casilla en cada fila (vea la ilustración 1).</span><span class="sxs-lookup"><span data-stu-id="62a93-115">Our example will include a paged GridView listing the products in the `Products` database table with a checkbox in each row (see Figure 1).</span></span> <span data-ttu-id="62a93-116">Al hacer clic en el botón eliminar productos seleccionados, se eliminarán los productos seleccionados.</span><span class="sxs-lookup"><span data-stu-id="62a93-116">A Delete Selected Products button, when clicked, will delete those products selected.</span></span>

<span data-ttu-id="62a93-117">[![cada fila de producto incluye una casilla](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="62a93-117">[![Each Product Row Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span></span>

<span data-ttu-id="62a93-118">**Figura 1**: cada fila de producto incluye una casilla ([haga clic para ver la imagen de tamaño completo](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="62a93-118">**Figure 1**: Each Product Row Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png))</span></span>

## <a name="step-1-adding-a-paged-gridview-that-lists-product-information"></a><span data-ttu-id="62a93-119">Paso 1: agregar un control GridView paginado que muestra información del producto</span><span class="sxs-lookup"><span data-stu-id="62a93-119">Step 1: Adding a Paged GridView that Lists Product Information</span></span>

<span data-ttu-id="62a93-120">Antes de preocuparnos por agregar una columna de casillas, deje que se Centre primero en enumerar los productos en un control GridView que admita la paginación.</span><span class="sxs-lookup"><span data-stu-id="62a93-120">Before we worry about adding a column of checkboxes, let s first focus on listing the products in a GridView that supports paging.</span></span> <span data-ttu-id="62a93-121">Comience abriendo la página `CheckBoxField.aspx` en la carpeta `EnhancedGridView` y arrastre un control GridView desde el cuadro de herramientas hasta el diseñador, estableciendo su `ID` en `Products`.</span><span class="sxs-lookup"><span data-stu-id="62a93-121">Start by opening the `CheckBoxField.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` to `Products`.</span></span> <span data-ttu-id="62a93-122">A continuación, elija enlazar GridView a un nuevo ObjectDataSource denominado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="62a93-122">Next, choose to bind the GridView to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="62a93-123">Configure ObjectDataSource para usar la clase `ProductsBLL`, llamando al método `GetProducts()` para devolver los datos.</span><span class="sxs-lookup"><span data-stu-id="62a93-123">Configure the ObjectDataSource to use the `ProductsBLL` class, calling the `GetProducts()` method to return the data.</span></span> <span data-ttu-id="62a93-124">Puesto que este GridView será de solo lectura, establezca las listas desplegables de las pestañas actualizar, insertar y eliminar en (ninguna).</span><span class="sxs-lookup"><span data-stu-id="62a93-124">Since this GridView will be read-only, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="62a93-125">[![crear un nuevo ObjectDataSource denominado ProductsDataSource](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="62a93-125">[![Create a New ObjectDataSource Named ProductsDataSource](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span></span>

<span data-ttu-id="62a93-126">**Figura 2**: creación de un nuevo ObjectDataSource denominado `ProductsDataSource` ([haga clic para ver la imagen de tamaño completo](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="62a93-126">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png))</span></span>

<span data-ttu-id="62a93-127">[![configurar ObjectDataSource para recuperar datos mediante el método GetProducts ()](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="62a93-127">[![Configure the ObjectDataSource to Retrieve Data Using the GetProducts() Method](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span></span>

<span data-ttu-id="62a93-128">**Figura 3**: configuración de ObjectDataSource para recuperar datos con el método `GetProducts()` ([haga clic para ver la imagen de tamaño completo](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="62a93-128">**Figure 3**: Configure the ObjectDataSource to Retrieve Data Using the `GetProducts()` Method ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png))</span></span>

<span data-ttu-id="62a93-129">[![establecer las listas desplegables de las pestañas actualizar, insertar y eliminar en (ninguna)](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="62a93-129">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span></span>

<span data-ttu-id="62a93-130">**Figura 4**: establecer las listas desplegables de las pestañas actualizar, insertar y eliminar en (ninguna) ([haga clic para ver la imagen a tamaño completo](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="62a93-130">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png))</span></span>

<span data-ttu-id="62a93-131">Después de completar el Asistente para configurar orígenes de datos, Visual Studio creará automáticamente BoundColumns y CheckBoxColumn para los campos de datos relacionados con el producto.</span><span class="sxs-lookup"><span data-stu-id="62a93-131">After completing the Configure Data Source wizard, Visual Studio will automatically create BoundColumns and a CheckBoxColumn for the product-related data fields.</span></span> <span data-ttu-id="62a93-132">Como hicimos en el tutorial anterior, elimine todos los `ProductName`, `CategoryName`y `UnitPrice` BoundFields, y cambie las propiedades de `HeaderText` a product, Category y price.</span><span class="sxs-lookup"><span data-stu-id="62a93-132">Like we did in the previous tutorial, remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields, and change the `HeaderText` properties to Product, Category, and Price.</span></span> <span data-ttu-id="62a93-133">Configure el `UnitPrice` BoundField para que su valor tenga el formato de moneda.</span><span class="sxs-lookup"><span data-stu-id="62a93-133">Configure the `UnitPrice` BoundField so that its value is formatted as a currency.</span></span> <span data-ttu-id="62a93-134">Configure también GridView para que admita la paginación. para ello, active la casilla habilitar paginación en la etiqueta inteligente.</span><span class="sxs-lookup"><span data-stu-id="62a93-134">Also configure the GridView to support paging by checking the Enable Paging checkbox from the smart tag.</span></span>

<span data-ttu-id="62a93-135">Vamos a agregar también la interfaz de usuario para eliminar los productos seleccionados.</span><span class="sxs-lookup"><span data-stu-id="62a93-135">Let s also add the user interface for deleting the selected products.</span></span> <span data-ttu-id="62a93-136">Agregue un control Web Button debajo de GridView, estableciendo su `ID` en `DeleteSelectedProducts` y su propiedad `Text` para eliminar los productos seleccionados.</span><span class="sxs-lookup"><span data-stu-id="62a93-136">Add a Button Web control beneath the GridView, setting its `ID` to `DeleteSelectedProducts` and its `Text` property to Delete Selected Products.</span></span> <span data-ttu-id="62a93-137">En lugar de eliminar realmente los productos de la base de datos, en este ejemplo solo se mostrará un mensaje que indica los productos que se habrían eliminado.</span><span class="sxs-lookup"><span data-stu-id="62a93-137">Rather than actually deleting products from the database, for this example we'll just display a message stating the products that would have been deleted.</span></span> <span data-ttu-id="62a93-138">Para ello, agregue un control Web de etiqueta debajo del botón.</span><span class="sxs-lookup"><span data-stu-id="62a93-138">To accommodate this, add a Label Web control beneath the Button.</span></span> <span data-ttu-id="62a93-139">Establezca su identificador en `DeleteResults`, borre su propiedad `Text` y establezca sus propiedades `Visible` y `EnableViewState` en `False`.</span><span class="sxs-lookup"><span data-stu-id="62a93-139">Set its ID to `DeleteResults`, clear out its `Text` property, and set its `Visible` and `EnableViewState` properties to `False`.</span></span>

<span data-ttu-id="62a93-140">Después de realizar estos cambios, el marcado declarativo GridView, ObjectDataSource, Button y Label s debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="62a93-140">After making these changes, the GridView, ObjectDataSource, Button, and Label s declarative markup should similar to the following:</span></span>

[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample1.aspx)]

<span data-ttu-id="62a93-141">Tómese un momento para ver la página en un explorador (vea la figura 5).</span><span class="sxs-lookup"><span data-stu-id="62a93-141">Take a moment to view the page in a browser (see Figure 5).</span></span> <span data-ttu-id="62a93-142">En este punto, debería ver el nombre, la categoría y el precio de los diez primeros productos.</span><span class="sxs-lookup"><span data-stu-id="62a93-142">At this point you should see the name, category, and price of the first ten products.</span></span>

<span data-ttu-id="62a93-143">[![el nombre, la categoría y el precio de los diez primeros productos se muestran](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="62a93-143">[![The Name, Category, and Price of the First Ten Products are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span></span>

<span data-ttu-id="62a93-144">**Figura 5**: se enumeran el nombre, la categoría y el precio de los primeros diez productos ([haga clic para ver la imagen de tamaño completo](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="62a93-144">**Figure 5**: The Name, Category, and Price of the First Ten Products are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-column-of-checkboxes"></a><span data-ttu-id="62a93-145">Paso 2: agregar una columna de casillas</span><span class="sxs-lookup"><span data-stu-id="62a93-145">Step 2: Adding a Column of Checkboxes</span></span>

<span data-ttu-id="62a93-146">Como ASP.NET 2,0 incluye un CheckBoxField, es posible que se pueda usar para agregar una columna de casillas a un control GridView.</span><span class="sxs-lookup"><span data-stu-id="62a93-146">Since ASP.NET 2.0 includes a CheckBoxField, one might think that it could be used to add a column of checkboxes to a GridView.</span></span> <span data-ttu-id="62a93-147">Desafortunadamente, no es el caso, ya que CheckBoxField está diseñado para trabajar con un campo de datos booleano.</span><span class="sxs-lookup"><span data-stu-id="62a93-147">Unfortunately, that is not the case, as the CheckBoxField is designed to work with a Boolean data field.</span></span> <span data-ttu-id="62a93-148">Es decir, para poder usar CheckBoxField, se debe especificar el campo de datos subyacente cuyo valor se consulta para determinar si la casilla representada está activada.</span><span class="sxs-lookup"><span data-stu-id="62a93-148">That is, in order to use the CheckBoxField we must specify the underlying data field whose value is consulted to determine whether the rendered checkbox is checked.</span></span> <span data-ttu-id="62a93-149">No se puede usar CheckBoxField para incluir solo una columna de casillas no comprobadas.</span><span class="sxs-lookup"><span data-stu-id="62a93-149">We cannot use the CheckBoxField to just include a column of unchecked checkboxes.</span></span>

<span data-ttu-id="62a93-150">En su lugar, debemos agregar un TemplateField y agregar un control Web CheckBox a su `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="62a93-150">Instead, we must add a TemplateField and add a CheckBox Web control to its `ItemTemplate`.</span></span> <span data-ttu-id="62a93-151">Continúe y agregue un TemplateField al `Products` GridView y conviértalo en el primer campo (extremo izquierdo).</span><span class="sxs-lookup"><span data-stu-id="62a93-151">Go ahead and add a TemplateField to the `Products` GridView and make it the first (far-left) field.</span></span> <span data-ttu-id="62a93-152">En la etiqueta inteligente de GridView s, haga clic en el vínculo editar plantillas y, a continuación, arrastre un control Web CheckBox desde el cuadro de herramientas hasta el `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="62a93-152">From the GridView s smart tag, click on the Edit Templates link and then drag a CheckBox Web control from the Toolbox into the `ItemTemplate`.</span></span> <span data-ttu-id="62a93-153">Establezca la propiedad CheckBox s `ID` en `ProductSelector`.</span><span class="sxs-lookup"><span data-stu-id="62a93-153">Set this CheckBox s `ID` property to `ProductSelector`.</span></span>

<span data-ttu-id="62a93-154">[![agregar un control Web CheckBox denominado ProductSelector a TemplateField s ItemTemplate](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="62a93-154">[![Add a CheckBox Web Control Named ProductSelector to the TemplateField s ItemTemplate](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span></span>

<span data-ttu-id="62a93-155">**Figura 6**: agregar un control Web CheckBox denominado `ProductSelector` al `ItemTemplate` TemplateField s ([haga clic para ver la imagen de tamaño completo](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="62a93-155">**Figure 6**: Add a CheckBox Web Control Named `ProductSelector` to the TemplateField s `ItemTemplate` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png))</span></span>

<span data-ttu-id="62a93-156">Con el control Web TemplateField y CheckBox agregado, cada fila incluye ahora una casilla.</span><span class="sxs-lookup"><span data-stu-id="62a93-156">With the TemplateField and CheckBox Web control added, each row now includes a checkbox.</span></span> <span data-ttu-id="62a93-157">En la figura 7 se muestra esta página, cuando se ve a través de un explorador, después de haber agregado TemplateField y CheckBox.</span><span class="sxs-lookup"><span data-stu-id="62a93-157">Figure 7 shows this page, when viewed through a browser, after the TemplateField and CheckBox have been added.</span></span>

<span data-ttu-id="62a93-158">[![cada fila de producto incluye ahora una casilla](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="62a93-158">[![Each Product Row Now Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span></span>

<span data-ttu-id="62a93-159">**Figura 7**: ahora cada fila de producto incluye una casilla ([haga clic para ver la imagen de tamaño completo](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="62a93-159">**Figure 7**: Each Product Row Now Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png))</span></span>

## <a name="step-3-determining-what-checkboxes-were-checked-on-postback"></a><span data-ttu-id="62a93-160">Paso 3: determinar qué casillas se comprobó en el PostBack</span><span class="sxs-lookup"><span data-stu-id="62a93-160">Step 3: Determining What Checkboxes Were Checked On Postback</span></span>

<span data-ttu-id="62a93-161">En este punto, tenemos una columna de casillas pero no hay forma de determinar qué casillas se comprobó en el PostBack.</span><span class="sxs-lookup"><span data-stu-id="62a93-161">At this point we have a column of checkboxes but no way to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="62a93-162">Sin embargo, cuando se hace clic en el botón eliminar productos seleccionados, es necesario saber qué casillas se comprobó para eliminar esos productos.</span><span class="sxs-lookup"><span data-stu-id="62a93-162">When the Delete Selected Products button is clicked, though, we need to know what checkboxes were checked in order to delete those products.</span></span>

<span data-ttu-id="62a93-163">La propiedad GridView s [`Rows`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx) proporciona acceso a las filas de datos de GridView.</span><span class="sxs-lookup"><span data-stu-id="62a93-163">The GridView s [`Rows` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx) provides access to the data rows in the GridView.</span></span> <span data-ttu-id="62a93-164">Podemos recorrer en iteración estas filas, tener acceso mediante programación al control CheckBox y, a continuación, consultar su propiedad `Checked` para determinar si se ha seleccionado la casilla.</span><span class="sxs-lookup"><span data-stu-id="62a93-164">We can iterate through these rows, programmatically access the CheckBox control, and then consult its `Checked` property to determine whether the CheckBox has been selected.</span></span>

<span data-ttu-id="62a93-165">Cree un controlador de eventos para el evento de control Web Button `DeleteSelectedProducts` `Click` y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="62a93-165">Create an event handler for the `DeleteSelectedProducts` Button Web control s `Click` event and add the following code:</span></span>

[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample2.vb)]

<span data-ttu-id="62a93-166">La propiedad `Rows` devuelve una colección de instancias de `GridViewRow` que estructuran las filas de datos de GridView.</span><span class="sxs-lookup"><span data-stu-id="62a93-166">The `Rows` property returns a collection of `GridViewRow` instances that makeup the GridView s data rows.</span></span> <span data-ttu-id="62a93-167">El bucle `For Each` aquí enumera esta colección.</span><span class="sxs-lookup"><span data-stu-id="62a93-167">The `For Each` loop here enumerates this collection.</span></span> <span data-ttu-id="62a93-168">Para cada `GridViewRow` objeto, se tiene acceso mediante programación a la casilla Row s mediante `row.FindControl("controlID")`.</span><span class="sxs-lookup"><span data-stu-id="62a93-168">For each `GridViewRow` object, the row s CheckBox is programmatically accessed using `row.FindControl("controlID")`.</span></span> <span data-ttu-id="62a93-169">Si la casilla está activada, la fila correspondiente `ProductID` valor se recupera de la colección `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="62a93-169">If the CheckBox is checked, the row s corresponding `ProductID` value is retrieved from the `DataKeys` collection.</span></span> <span data-ttu-id="62a93-170">En este ejercicio, simplemente se muestra un mensaje informativo en la etiqueta `DeleteResults`, aunque en una aplicación en funcionamiento, se realiza una llamada al método `DeleteProduct(productID)` de la clase `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="62a93-170">In this exercise, we simply display an informative message in the `DeleteResults` Label, although in a working application we d instead make a call to the `ProductsBLL` class s `DeleteProduct(productID)` method.</span></span>

<span data-ttu-id="62a93-171">Con la adición de este controlador de eventos, al hacer clic en el botón eliminar productos seleccionados ahora se muestran los `ProductID` s de los productos seleccionados.</span><span class="sxs-lookup"><span data-stu-id="62a93-171">With the addition of this event handler, clicking the Delete Selected Products button now displays the `ProductID` s of the selected products.</span></span>

<span data-ttu-id="62a93-172">[![cuando se hace clic en el botón eliminar productos seleccionados, se muestran los productos seleccionados ProductIDs](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="62a93-172">[![When the Delete Selected Products Button is Clicked the Selected Products ProductIDs are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span></span>

<span data-ttu-id="62a93-173">**Figura 8**: cuando se hace clic en el botón eliminar productos seleccionados, se muestran los productos seleccionados `ProductID` s ([haga clic para ver la imagen a tamaño completo](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="62a93-173">**Figure 8**: When the Delete Selected Products Button is Clicked the Selected Products `ProductID` s are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png))</span></span>

## <a name="step-4-adding-check-all-and-uncheck-all-buttons"></a><span data-ttu-id="62a93-174">Paso 4: agregar los botones marcar todo y desactivar todos</span><span class="sxs-lookup"><span data-stu-id="62a93-174">Step 4: Adding Check All and Uncheck All Buttons</span></span>

<span data-ttu-id="62a93-175">Si un usuario desea eliminar todos los productos de la página actual, deben comprobar cada una de las diez casillas.</span><span class="sxs-lookup"><span data-stu-id="62a93-175">If a user wants to delete all products on the current page, they must check each of the ten checkboxes.</span></span> <span data-ttu-id="62a93-176">Podemos ayudarle a acelerar este proceso agregando un botón comprobar todo que, al hacer clic en él, selecciona todas las casillas de la cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="62a93-176">We can help expedite this process by adding a Check All button that, when clicked, selects all of the checkboxes in the grid.</span></span> <span data-ttu-id="62a93-177">Un botón desactivar todo sería igualmente útil.</span><span class="sxs-lookup"><span data-stu-id="62a93-177">An Uncheck All button would be equally helpful.</span></span>

<span data-ttu-id="62a93-178">Agregue dos controles Web de botón a la página y colóquelos encima de GridView.</span><span class="sxs-lookup"><span data-stu-id="62a93-178">Add two Button Web controls to the page, placing them above the GridView.</span></span> <span data-ttu-id="62a93-179">Establezca los primeros `ID` en `CheckAll` y su propiedad `Text` en comprobar todo; Establezca la segunda `ID` s en `UncheckAll` y su propiedad `Text` en desactive todo.</span><span class="sxs-lookup"><span data-stu-id="62a93-179">Set the first one s `ID` to `CheckAll` and its `Text` property to Check All ; set the second one s `ID` to `UncheckAll` and its `Text` property to Uncheck All .</span></span>

[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample3.aspx)]

<span data-ttu-id="62a93-180">A continuación, cree un método en la clase de código subyacente denominado `ToggleCheckState(checkState)` que, cuando se invoca, enumera la colección `Products` GridView s `Rows` y establece cada propiedad CheckBox s `Checked` en el valor del parámetro *checkState* pasado.</span><span class="sxs-lookup"><span data-stu-id="62a93-180">Next, create a method in the code-behind class named `ToggleCheckState(checkState)` that, when invoked, enumerates the `Products` GridView s `Rows` collection and sets each CheckBox s `Checked` property to the value of the passed in *checkState* parameter.</span></span>

[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample4.vb)]

<span data-ttu-id="62a93-181">A continuación, cree `Click` controladores de eventos para los botones `CheckAll` y `UncheckAll`.</span><span class="sxs-lookup"><span data-stu-id="62a93-181">Next, create `Click` event handlers for the `CheckAll` and `UncheckAll` buttons.</span></span> <span data-ttu-id="62a93-182">En el controlador de eventos `CheckAll` s, simplemente llame a `ToggleCheckState(True)`; en `UncheckAll`, llame a `ToggleCheckState(False)`.</span><span class="sxs-lookup"><span data-stu-id="62a93-182">In `CheckAll` s event handler, simply call `ToggleCheckState(True)`; in `UncheckAll`, call `ToggleCheckState(False)`.</span></span>

[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample5.vb)]

<span data-ttu-id="62a93-183">Con este código, al hacer clic en el botón comprobar todo se produce un postback y se comprueban todas las casillas en GridView.</span><span class="sxs-lookup"><span data-stu-id="62a93-183">With this code, clicking the Check All button causes a postback and checks all of the checkboxes in the GridView.</span></span> <span data-ttu-id="62a93-184">Del mismo modo, al hacer clic en desactive todas las casillas.</span><span class="sxs-lookup"><span data-stu-id="62a93-184">Likewise, clicking Uncheck All unselects all checkboxes.</span></span> <span data-ttu-id="62a93-185">En la ilustración 9 se muestra la pantalla después de que se haya activado el botón comprobar todo.</span><span class="sxs-lookup"><span data-stu-id="62a93-185">Figure 9 shows the screen after the Check All button has been checked.</span></span>

<span data-ttu-id="62a93-186">[![hacer clic en el botón marcar todo selecciona todas las casillas](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="62a93-186">[![Clicking the Check All Button Selects All Checkboxes](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span></span>

<span data-ttu-id="62a93-187">**Figura 9**: al hacer clic en el botón marcar todo, se seleccionan todas las casillas de verificación ([haga clic para ver la imagen de tamaño completo](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="62a93-187">**Figure 9**: Clicking the Check All Button Selects All Checkboxes ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="62a93-188">Al mostrar una columna de casillas, una opción para seleccionar o anular la selección de todas las casillas se realiza a través de una casilla en la fila de encabezado.</span><span class="sxs-lookup"><span data-stu-id="62a93-188">When displaying a column of checkboxes, one approach for selecting or unselecting all of the checkboxes is through a checkbox in the header row.</span></span> <span data-ttu-id="62a93-189">Además, la marca de verificación actual All/uncheck All Implementation requiere un postback.</span><span class="sxs-lookup"><span data-stu-id="62a93-189">Moreover, the current Check All / Uncheck All implementation requires a postback.</span></span> <span data-ttu-id="62a93-190">Sin embargo, las casillas se pueden activar o desactivar, en su totalidad mediante script de cliente, lo que proporciona una experiencia de usuario de snappier.</span><span class="sxs-lookup"><span data-stu-id="62a93-190">The checkboxes can be checked or unchecked, however, entirely through client-side script, thereby providing a snappier user experience.</span></span> <span data-ttu-id="62a93-191">Para explorar el uso de una casilla fila de encabezado para marcar todo y desproteger todo en detalle, junto con una explicación sobre el uso de las técnicas del lado cliente, consulte [activar todas las casillas en un control GridView mediante el script del lado cliente y una casilla Seleccionar todo](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="62a93-191">To explore using a header row checkbox for Check All and Uncheck All in detail, along with a discussion on using client-side techniques, check out [Checking All CheckBoxes in a GridView Using Client-Side Script and a Check All CheckBox](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx).</span></span>

## <a name="summary"></a><span data-ttu-id="62a93-192">Resumen</span><span class="sxs-lookup"><span data-stu-id="62a93-192">Summary</span></span>

<span data-ttu-id="62a93-193">En los casos en los que debe permitir que los usuarios elijan un número arbitrario de filas de un control GridView antes de continuar, la adición de una columna de casillas es una opción.</span><span class="sxs-lookup"><span data-stu-id="62a93-193">In cases where you need to let users choose an arbitrary number of rows from a GridView before proceeding, adding a column of checkboxes is one option.</span></span> <span data-ttu-id="62a93-194">Como vimos en este tutorial, la inclusión de una columna de casillas en GridView implica agregar un TemplateField con un control Web CheckBox.</span><span class="sxs-lookup"><span data-stu-id="62a93-194">As we saw in this tutorial, including a column of checkboxes in the GridView entails adding a TemplateField with a CheckBox Web control.</span></span> <span data-ttu-id="62a93-195">Mediante el uso de un control Web (e inyección de marcado directamente en la plantilla, como hicimos en el tutorial anterior) ASP.NET recuerda automáticamente qué casillas de verificación eran y no se comprobó en el PostBack.</span><span class="sxs-lookup"><span data-stu-id="62a93-195">By using a Web control (versus injecting markup directly into the template, as we did in the previous tutorial) ASP.NET automatically remembers what CheckBoxes were and were not checked across postback.</span></span> <span data-ttu-id="62a93-196">También se puede tener acceso mediante programación a las casillas del código para determinar si una casilla determinada está activada o para cambiar el estado de activación.</span><span class="sxs-lookup"><span data-stu-id="62a93-196">We can also programmatically access the CheckBoxes in code to determine whether a given CheckBox is checked, or to change the checked state.</span></span>

<span data-ttu-id="62a93-197">En este tutorial y en el último se ha examinado la adición de una columna de selector de filas a GridView.</span><span class="sxs-lookup"><span data-stu-id="62a93-197">This tutorial and the last one looked at adding a row selector column to the GridView.</span></span> <span data-ttu-id="62a93-198">En el siguiente tutorial, veremos cómo, con un poco de trabajo, podemos agregar funcionalidades de inserción a GridView.</span><span class="sxs-lookup"><span data-stu-id="62a93-198">In our next tutorial we'll examine how, with a bit of work, we can add inserting capabilities to the GridView.</span></span>

<span data-ttu-id="62a93-199">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="62a93-199">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="62a93-200">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="62a93-200">About the Author</span></span>

<span data-ttu-id="62a93-201">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros de ASP/ASP. net y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="62a93-201">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="62a93-202">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="62a93-202">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="62a93-203">Su último libro se [*enseña a ASP.NET 2,0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="62a93-203">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="62a93-204">Puede ponerse en contacto con usted en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="62a93-204">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="62a93-205">o a través de su blog, que encontrará en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="62a93-205">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="62a93-206">[Anterior](adding-a-gridview-column-of-radio-buttons-vb.md)
> [Siguiente](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span><span class="sxs-lookup"><span data-stu-id="62a93-206">[Previous](adding-a-gridview-column-of-radio-buttons-vb.md)
[Next](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span></span>

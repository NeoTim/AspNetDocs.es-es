---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-cs
title: Configuración de un sitio web que usaC#servicios de aplicación () | Microsoft Docs
author: rick-anderson
description: La versión 2,0 de ASP.NET presentó una serie de servicios de aplicación, que forman parte de la .NET Framework y actúan como un conjunto de servicios de bloques de creación que yo...
ms.author: riande
ms.date: 04/23/2009
ms.assetid: 1e33d1c6-3f9f-4c26-81e2-2a8f8907bb05
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-a-website-that-uses-application-services-cs
msc.type: authoredcontent
ms.openlocfilehash: 72aaca84b8c8d6e558d4c946faa57fa999d48bf8
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78511783"
---
# <a name="configuring-a-website-that-uses-application-services-c"></a><span data-ttu-id="69cc8-103">Configurar un sitio web que usa servicios de aplicaciones (C#)</span><span class="sxs-lookup"><span data-stu-id="69cc8-103">Configuring a Website that Uses Application Services (C#)</span></span>

<span data-ttu-id="69cc8-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="69cc8-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="69cc8-105">[Descargar código](https://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_CS.zip) o [Descargar PDF](https://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="69cc8-105">[Download Code](https://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_09_CS.zip) or [Download PDF](https://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial09_AppServicesConfig_cs.pdf)</span></span>

> <span data-ttu-id="69cc8-106">La versión 2,0 de ASP.NET presentó una serie de servicios de aplicación, que forman parte de la .NET Framework y sirven como conjunto de servicios de bloques de creación que puede usar para agregar una funcionalidad enriquecida a su aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="69cc8-106">ASP.NET version 2.0 introduced a series of application services, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="69cc8-107">En este tutorial se explica cómo configurar un sitio web en el entorno de producción para usar servicios de aplicación y se abordan los problemas comunes relacionados con la administración de las cuentas de usuario y los roles en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-107">This tutorial explores how to configure a website in the production environment to use application services and addresses common issues with managing user accounts and roles on the production environment.</span></span>

## <a name="introduction"></a><span data-ttu-id="69cc8-108">Introducción</span><span class="sxs-lookup"><span data-stu-id="69cc8-108">Introduction</span></span>

<span data-ttu-id="69cc8-109">La versión 2,0 de ASP.NET presentó una serie de *servicios de aplicación*, que forman parte de la .NET Framework y sirven como conjunto de servicios de bloques de creación que puede usar para agregar una funcionalidad enriquecida a su aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="69cc8-109">ASP.NET version 2.0 introduced a series of *application services*, which are part of the .NET Framework and serve as a suite of building block services that you can use to add rich functionality to your web application.</span></span> <span data-ttu-id="69cc8-110">Los servicios de aplicación incluyen:</span><span class="sxs-lookup"><span data-stu-id="69cc8-110">The application services include:</span></span>

- <span data-ttu-id="69cc8-111">**Pertenencia** : una API para crear y administrar cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="69cc8-111">**Membership** - an API for creating and managing user accounts.</span></span>
- <span data-ttu-id="69cc8-112">**Roles** : una API para clasificar los usuarios en grupos.</span><span class="sxs-lookup"><span data-stu-id="69cc8-112">**Roles** - an API for categorizing users into groups.</span></span>
- <span data-ttu-id="69cc8-113">**Profile** : una API para almacenar contenido personalizado específico del usuario.</span><span class="sxs-lookup"><span data-stu-id="69cc8-113">**Profile** - an API for storing custom, user-specific content.</span></span>
- <span data-ttu-id="69cc8-114">**Mapa del sitio** : una API para definir una estructura lógica del sitio en forma de una jerarquía, que se puede mostrar a continuación a través de controles de navegación, como menús y rutas de navegación.</span><span class="sxs-lookup"><span data-stu-id="69cc8-114">**Site Map** - an API for defining a site s logical structure in the form of a hierarchy, which can then be displayed via navigation controls, such as menus and breadcrumbs.</span></span>
- <span data-ttu-id="69cc8-115">**Personalización** : una API para mantener las preferencias de personalización, que suele usarse con [*elementos Web*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span><span class="sxs-lookup"><span data-stu-id="69cc8-115">**Personalization** - an API for maintaining customization preferences, most often used with [*WebParts*](https://msdn.microsoft.com/library/e0s9t4ck.aspx).</span></span>
- <span data-ttu-id="69cc8-116">**Seguimiento de estado** : una API para supervisar el rendimiento, la seguridad, los errores y otras métricas de mantenimiento del sistema para una aplicación web en ejecución.</span><span class="sxs-lookup"><span data-stu-id="69cc8-116">**Health Monitoring** - an API for monitoring performance, security, errors, and other system health metrics for a running web application.</span></span>

<span data-ttu-id="69cc8-117">Las API de servicios de aplicación no están asociadas a una implementación específica.</span><span class="sxs-lookup"><span data-stu-id="69cc8-117">The application services APIs are not tied to a specific implementation.</span></span> <span data-ttu-id="69cc8-118">En su lugar, se indica a los servicios de aplicación que usen un *proveedor*determinado y ese proveedor implementa el servicio mediante una tecnología determinada.</span><span class="sxs-lookup"><span data-stu-id="69cc8-118">Instead, you instruct the application services to use a particular *provider*, and that provider implements the service using a particular technology.</span></span> <span data-ttu-id="69cc8-119">Los proveedores que se usan con más frecuencia para las aplicaciones web basadas en Internet hospedadas en una empresa de hospedaje web son aquellos proveedores que usan una implementación de base de datos SQL Server.</span><span class="sxs-lookup"><span data-stu-id="69cc8-119">The most commonly used providers for Internet-based web applications hosted at a web hosting company are those providers that use a SQL Server database implementation.</span></span> <span data-ttu-id="69cc8-120">Por ejemplo, el `SqlMembershipProvider` es un proveedor de la API de pertenencia que almacena la información de la cuenta de usuario en una base de datos de Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="69cc8-120">For example, the `SqlMembershipProvider` is a provider for the Membership API that stores user account information in a Microsoft SQL Server database.</span></span>

<span data-ttu-id="69cc8-121">El uso de los proveedores de servicios de aplicaciones y SQL Server agrega algunos desafíos al implementar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69cc8-121">Using the application services and SQL Server providers adds some challenges when deploying the application.</span></span> <span data-ttu-id="69cc8-122">En el caso de los iniciadores, los objetos de base de datos de servicios de aplicación deben crearse correctamente en las bases de datos de desarrollo y de producción y inicializarse de manera adecuada.</span><span class="sxs-lookup"><span data-stu-id="69cc8-122">For starters, the application services database objects must be properly created on both the development and production databases and appropriately initialized.</span></span> <span data-ttu-id="69cc8-123">También hay opciones de configuración importantes que se deben realizar.</span><span class="sxs-lookup"><span data-stu-id="69cc8-123">There are also important configuration settings that need to be made.</span></span>

> [!NOTE]
> <span data-ttu-id="69cc8-124">Las API de servicios de aplicación se diseñaron con el [*modelo de proveedor*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), un modelo de diseño que permite proporcionar los detalles de implementación de la API s en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="69cc8-124">The application services APIs were designed using the [*provider model*](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), a design pattern that allows for an API s implementation details to be provided at runtime.</span></span> <span data-ttu-id="69cc8-125">El .NET Framework se suministra con varios proveedores de servicios de aplicaciones que se pueden usar, como el `SqlMembershipProvider` y el `SqlRoleProvider`, que son proveedores de las API de pertenencia y roles que usan una implementación de base de datos SQL Server.</span><span class="sxs-lookup"><span data-stu-id="69cc8-125">The .NET Framework ships with a number of application service providers that can be used, such as the `SqlMembershipProvider` and `SqlRoleProvider`, which are providers for the Membership and Roles APIs that use a SQL Server database implementation.</span></span> <span data-ttu-id="69cc8-126">También puede crear y complementar un proveedor personalizado.</span><span class="sxs-lookup"><span data-stu-id="69cc8-126">You can also create and plug-in a custom provider.</span></span> <span data-ttu-id="69cc8-127">De hecho, la aplicación Web de reseñas de libros ya contiene un proveedor personalizado para la API del mapa del sitio (`ReviewSiteMapProvider`), que construye el mapa del sitio a partir de los datos de las tablas `Genres` y `Books` de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="69cc8-127">In fact, the Book Reviews web application already contains a custom provider for the Site Map API (`ReviewSiteMapProvider`), which constructs the site map from the data in the `Genres` and `Books` tables in the database.</span></span>

<span data-ttu-id="69cc8-128">En este tutorial se empieza con una visión de cómo amplié la aplicación Web de reseñas de libros para usar las API de pertenencia y roles.</span><span class="sxs-lookup"><span data-stu-id="69cc8-128">This tutorial starts with a look at how I extended the Book Reviews web application to use the Membership and Roles APIs.</span></span> <span data-ttu-id="69cc8-129">A continuación, se describe la implementación de una aplicación web que usa servicios de aplicación con una implementación de base de datos de SQL Server, y concluye por solucionar problemas comunes relacionados con la administración de roles y cuentas de usuario en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-129">It then walks through deploying a web application that uses application services with a SQL Server database implementation, and concludes by addressing common issues with managing user accounts and roles on the production environment.</span></span>

## <a name="updates-to-the-book-reviews-application"></a><span data-ttu-id="69cc8-130">Actualizaciones de la aplicación de revisiones del libro</span><span class="sxs-lookup"><span data-stu-id="69cc8-130">Updates to the Book Reviews Application</span></span>

<span data-ttu-id="69cc8-131">En los últimos dos tutoriales, la aplicación Web de reseñas de libros se actualizó desde un sitio Web estático a una aplicación web dinámica controlada por datos completada con un conjunto de páginas de administración para administrar géneros y revisiones.</span><span class="sxs-lookup"><span data-stu-id="69cc8-131">Over the past couple tutorials the Book Reviews web application was updated from a static website to a dynamic, data-driven web application complete with a set of administration pages for managing genres and reviews.</span></span> <span data-ttu-id="69cc8-132">Sin embargo, esta sección de administración no está protegida actualmente: cualquier usuario que sepa (o adivine) la dirección URL de la página de administración puede Waltz en el sitio y crear, editar o eliminar revisiones en nuestro sitio.</span><span class="sxs-lookup"><span data-stu-id="69cc8-132">However, this administration section is currently not protected - any user who knows (or guesses) the administration page URL can waltz in and create, edit, or delete reviews on our site.</span></span> <span data-ttu-id="69cc8-133">Una forma común de proteger determinadas partes de un sitio web es implementar cuentas de usuario y, a continuación, usar reglas de autorización de URL para restringir el acceso a determinados usuarios o roles.</span><span class="sxs-lookup"><span data-stu-id="69cc8-133">A common way to protect certain portions of a website is to implement user accounts and then use URL authorization rules to restrict access to certain users or roles.</span></span> <span data-ttu-id="69cc8-134">La aplicación Web de reseñas de libros disponible para su descarga con este tutorial es compatible con las cuentas de usuario y los roles.</span><span class="sxs-lookup"><span data-stu-id="69cc8-134">The Book Reviews web application available for download with this tutorial supports user accounts and roles.</span></span> <span data-ttu-id="69cc8-135">Tiene un rol único definido como admin y solo los usuarios de este rol pueden tener acceso a las páginas de administración.</span><span class="sxs-lookup"><span data-stu-id="69cc8-135">It has a single role defined named Admin and only users in this role can access the administration pages.</span></span>

> [!NOTE]
> <span data-ttu-id="69cc8-136">He creado tres cuentas de usuario en el libro Reviews Web Application: Scott, Jisun y Alice.</span><span class="sxs-lookup"><span data-stu-id="69cc8-136">I ve created three user accounts in the Book Reviews web application: Scott, Jisun, and Alice.</span></span> <span data-ttu-id="69cc8-137">Los tres usuarios tienen la misma contraseña: **contraseña.**</span><span class="sxs-lookup"><span data-stu-id="69cc8-137">All three users have the same password: **password!**</span></span> <span data-ttu-id="69cc8-138">Scott y Jisun están en el rol de administrador, Alicia no lo está.</span><span class="sxs-lookup"><span data-stu-id="69cc8-138">Scott and Jisun are in the Admin role, Alice is not.</span></span> <span data-ttu-id="69cc8-139">Las páginas de sitios que no son de administración siguen siendo accesibles para los usuarios anónimos.</span><span class="sxs-lookup"><span data-stu-id="69cc8-139">The site s non-administration pages are still accessible to anonymous users.</span></span> <span data-ttu-id="69cc8-140">Es decir, no es necesario iniciar sesión para visitar el sitio, a menos que desee administrarlo, en cuyo caso debe iniciar sesión como usuario en el rol de administrador.</span><span class="sxs-lookup"><span data-stu-id="69cc8-140">That is, you do not need to sign in to visit the site, unless you want to administer it, in which case you must sign in as a user in the Admin role.</span></span>

<span data-ttu-id="69cc8-141">El libro revisa la página maestra de la aplicación se ha actualizado para incluir una interfaz de usuario diferente para los usuarios autenticados y anónimos.</span><span class="sxs-lookup"><span data-stu-id="69cc8-141">The Book Reviews application s master page has been updated to include a different user interface for authenticated and anonymous users.</span></span> <span data-ttu-id="69cc8-142">Si un usuario anónimo visita el sitio, ve un vínculo de inicio de sesión en la esquina superior derecha.</span><span class="sxs-lookup"><span data-stu-id="69cc8-142">If an anonymous user visits the site she sees a Login link in the upper right corner.</span></span> <span data-ttu-id="69cc8-143">Un usuario autenticado Ve el mensaje "Bienvenido atrás, *nombre de usuario*".</span><span class="sxs-lookup"><span data-stu-id="69cc8-143">An authenticated user sees the message, "Welcome back, *username*!"</span></span> <span data-ttu-id="69cc8-144">y un vínculo para cerrar la sesión. También hay una página de inicio de sesión (`~/Login.aspx`), que contiene un control Web de inicio de sesión que proporciona la interfaz de usuario y la lógica para autenticar a un visitante.</span><span class="sxs-lookup"><span data-stu-id="69cc8-144">and a link to log out. There s also a login page (`~/Login.aspx`), which contains a Login Web control that provides the user interface and logic for authenticating a visitor.</span></span> <span data-ttu-id="69cc8-145">Solo los administradores pueden crear nuevas cuentas.</span><span class="sxs-lookup"><span data-stu-id="69cc8-145">Only administrators can create new accounts.</span></span> <span data-ttu-id="69cc8-146">(Hay páginas para crear y administrar cuentas de usuario en la carpeta `~/Admin`).</span><span class="sxs-lookup"><span data-stu-id="69cc8-146">(There are pages for creating and managing user accounts in the `~/Admin` folder.)</span></span>

### <a name="configuring-the-membership-and-roles-apis"></a><span data-ttu-id="69cc8-147">Configuración de las API de pertenencia y roles</span><span class="sxs-lookup"><span data-stu-id="69cc8-147">Configuring the Membership and Roles APIs</span></span>

<span data-ttu-id="69cc8-148">La aplicación Web de reseñas de libros utiliza las API de pertenencia y roles para admitir las cuentas de usuario y agrupar esos usuarios en roles (es decir, el rol de administrador).</span><span class="sxs-lookup"><span data-stu-id="69cc8-148">The Book Reviews web application uses the Membership and Roles APIs to support user accounts and to group those users into roles (namely, the Admin role).</span></span> <span data-ttu-id="69cc8-149">Se usan las clases de proveedor `SqlMembershipProvider` y `SqlRoleProvider` porque queremos almacenar la información de la cuenta y el rol en una base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="69cc8-149">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes are used because we want to store account and role information in a SQL Server database.</span></span>

> [!NOTE]
> <span data-ttu-id="69cc8-150">Este tutorial no pretende ser un examen detallado de la configuración de una aplicación web para admitir las API de pertenencia y roles.</span><span class="sxs-lookup"><span data-stu-id="69cc8-150">This tutorial is not intended to be a detailed examination at configuring a web application to support the Membership and Roles APIs.</span></span> <span data-ttu-id="69cc8-151">Para obtener una visión detallada de estas API y los pasos que debe seguir para configurar un sitio web para usarlas, consulte los [*tutoriales de seguridad de mi sitio web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="69cc8-151">For a thorough look at these APIs and the steps you need to take to configure a website to use them, please read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

<span data-ttu-id="69cc8-152">Para usar los servicios de aplicación con una base de datos de SQL Server, primero debe agregar los objetos de base de datos usados por estos proveedores a la base de datos en la que desea almacenar la información de la cuenta de usuario y el rol.</span><span class="sxs-lookup"><span data-stu-id="69cc8-152">To use the application services with a SQL Server database you must first add the database objects used by these providers to the database where you want the user account and role information stored.</span></span> <span data-ttu-id="69cc8-153">Estos objetos de base de datos necesarios incluyen una variedad de tablas, vistas y procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="69cc8-153">These requisite database objects include a variety of tables, views, and stored procedures.</span></span> <span data-ttu-id="69cc8-154">A menos que se especifique lo contrario, las clases de proveedor `SqlMembershipProvider` y `SqlRoleProvider` usan una base de datos de la edición SQL Server Express denominada `ASPNETDB` ubicada en la carpeta Application s `App_Data`; Si no existe una base de datos de este tipo, estos proveedores se crean automáticamente con los objetos de base de datos necesarios en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="69cc8-154">Unless specified otherwise, the `SqlMembershipProvider` and `SqlRoleProvider` provider classes use a SQL Server Express Edition database named `ASPNETDB` located in the application s `App_Data` folder; if such a database does not exist, it is automatically created with the necessary database objects by these providers at runtime.</span></span>

<span data-ttu-id="69cc8-155">Es posible, y normalmente ideal, crear los objetos de base de datos de servicios de aplicación en la misma base de datos donde se almacenan los datos específicos de la aplicación del sitio Web.</span><span class="sxs-lookup"><span data-stu-id="69cc8-155">It is possible, and usually ideal, to create the application services database objects in the same database where the website s application-specific data is stored.</span></span> <span data-ttu-id="69cc8-156">El .NET Framework se suministra con una herramienta denominada `aspnet_regsql.exe` que instala los objetos de base de datos en una base de datos especificada.</span><span class="sxs-lookup"><span data-stu-id="69cc8-156">The .NET Framework ships with a tool named `aspnet_regsql.exe` that installs the database objects on a specified database.</span></span> <span data-ttu-id="69cc8-157">He dejado de usar esta herramienta para agregar estos objetos a la `Reviews.mdf` base de datos en la carpeta `App_Data` (la base de datos de desarrollo).</span><span class="sxs-lookup"><span data-stu-id="69cc8-157">I have gone ahead and used this tool to add these objects to the `Reviews.mdf` database in the `App_Data` folder (the development database).</span></span> <span data-ttu-id="69cc8-158">Veremos cómo usar esta herramienta más adelante en este tutorial cuando agreguemos estos objetos a la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-158">We'll see how to use this tool later in this tutorial when we add these objects to the production database.</span></span>

<span data-ttu-id="69cc8-159">Si agrega los objetos de base de datos de servicios de aplicación a una base de datos que no sea `ASPNETDB` deberá personalizar las configuraciones de las clases de proveedor `SqlMembershipProvider` y `SqlRoleProvider` para que usen la base de datos adecuada.</span><span class="sxs-lookup"><span data-stu-id="69cc8-159">If you add the application services database objects to a database other than `ASPNETDB` you will need to customize the `SqlMembershipProvider` and `SqlRoleProvider` provider classes configurations so that they use the appropriate database.</span></span> <span data-ttu-id="69cc8-160">Para personalizar el proveedor de pertenencia, agregue un [*elemento&lt;Membership&gt;* ](https://msdn.microsoft.com/library/1b9hw62f.aspx) dentro de la sección `<system.web>` en `Web.config`; Use el [*elemento&lt;roleManager&gt;* ](https://msdn.microsoft.com/library/ms164660.aspx) para configurar el proveedor de funciones.</span><span class="sxs-lookup"><span data-stu-id="69cc8-160">To customize the Membership provider add a [*&lt;membership&gt; element*](https://msdn.microsoft.com/library/1b9hw62f.aspx) within the `<system.web>` section in `Web.config`; use the [*&lt;roleManager&gt; element*](https://msdn.microsoft.com/library/ms164660.aspx) to configure the Roles provider.</span></span> <span data-ttu-id="69cc8-161">El siguiente fragmento de código se toma del libro Reviews Application s `Web.config` y muestra los valores de configuración de las API de pertenencia y roles.</span><span class="sxs-lookup"><span data-stu-id="69cc8-161">The following snippet is taken from the Book Reviews application s `Web.config` and shows the configure settings for the Membership and Roles APIs.</span></span> <span data-ttu-id="69cc8-162">Tenga en cuenta que ambos registran un nuevo proveedor-`ReviewMembership` y `ReviewRole`, que usan los proveedores `SqlMembershipProvider` y `SqlRoleProvider`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="69cc8-162">Note that both register a new provider - `ReviewMembership` and `ReviewRole` - that use the `SqlMembershipProvider` and `SqlRoleProvider` providers, respectively.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample1.xml)]

<span data-ttu-id="69cc8-163">El elemento `Web.config` File s `<authentication>` también se ha configurado para admitir la autenticación basada en formularios.</span><span class="sxs-lookup"><span data-stu-id="69cc8-163">The `Web.config` file s `<authentication>` element has also been configured to support forms-based authentication.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample2.xml)]

### <a name="limiting-access-to-the-administration-pages"></a><span data-ttu-id="69cc8-164">Limitar el acceso a las páginas de administración</span><span class="sxs-lookup"><span data-stu-id="69cc8-164">Limiting Access to the Administration Pages</span></span>

<span data-ttu-id="69cc8-165">ASP.NET facilita la concesión o denegación de acceso a un archivo o carpeta determinados por usuario o por rol a través de su característica de *autorización de URL* .</span><span class="sxs-lookup"><span data-stu-id="69cc8-165">ASP.NET makes it easy to grant or deny access to a particular file or folder by user or by role via its *URL authorization* feature.</span></span> <span data-ttu-id="69cc8-166">(Se describe brevemente la autorización de direcciones URL en las *diferencias principales entre IIS y el servidor de desarrollo de ASP.net* tutorial y se ha mostrado cómo IIS y el servidor de desarrollo de ASP.net aplicar las reglas de autorización de URL de forma diferente para el contenido estático y dinámico). Dado que queremos prohibir el acceso a la carpeta `~/Admin` excepto a los usuarios del rol de administrador, es necesario agregar reglas de autorización de URL a esta carpeta.</span><span class="sxs-lookup"><span data-stu-id="69cc8-166">(We briefly discussed URL authorization in the *Core Differences Between IIS and the ASP.NET Development Server* tutorial and showed how IIS and the ASP.NET Development Server apply URL authorization rules differently for static versus dynamic content.) Because we want to prohibit access to the `~/Admin` folder except for those users in the Admin role, we need to add URL authorization rules to this folder.</span></span> <span data-ttu-id="69cc8-167">En concreto, las reglas de autorización de URL deben permitir a los usuarios con el rol de administrador y denegar a todos los demás usuarios.</span><span class="sxs-lookup"><span data-stu-id="69cc8-167">Specifically, the URL authorization rules need to allow users in the Admin role and deny all other users.</span></span> <span data-ttu-id="69cc8-168">Esto se logra agregando un archivo `Web.config` a la carpeta `~/Admin` con el siguiente contenido:</span><span class="sxs-lookup"><span data-stu-id="69cc8-168">This is accomplished by adding a `Web.config` file to the `~/Admin` folder with the following contents:</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample3.xml)]

<span data-ttu-id="69cc8-169">Para obtener más información acerca de la característica de autorización de URL de ASP.NET s y cómo usarla para deletrear las reglas de autorización para los usuarios y los roles, asegúrese de leer los tutoriales de autorización basada en [*roles*](../../older-versions-security/roles/role-based-authorization-cs.md) y [*autorización basada*](../../older-versions-security/membership/user-based-authorization-cs.md) en el usuario de los [*tutoriales de seguridad de los sitios web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="69cc8-169">For more information on ASP.NET s URL authorization feature and how to use it to spell out authorization rules for users and for roles, be sure to read the [*User-Based Authorization*](../../older-versions-security/membership/user-based-authorization-cs.md) and [*Role-Based Authorization*](../../older-versions-security/roles/role-based-authorization-cs.md) tutorials from my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

## <a name="deploying-a-web-application-that-uses-application-services"></a><span data-ttu-id="69cc8-170">Implementar una aplicación web que usa Servicios de aplicación</span><span class="sxs-lookup"><span data-stu-id="69cc8-170">Deploying a Web Application That Uses Application Services</span></span>

<span data-ttu-id="69cc8-171">Al implementar un sitio web que usa servicios de aplicación y un proveedor que almacena la información de los servicios de aplicación en una base de datos, es imperativo que los objetos de base de datos necesarios para los servicios de la aplicación se creen en la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-171">When deploying a website that uses application services and a provider that stores the application services information in a database, it is imperative that the database objects needed by the application services be created on the production database.</span></span> <span data-ttu-id="69cc8-172">Inicialmente, la base de datos de producción no contiene estos objetos, por lo que cuando la aplicación se implementa por primera vez (o cuando se implementa por primera vez después de que se han agregado servicios de aplicación), debe realizar pasos adicionales para obtener estos objetos de base de datos necesarios en el base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-172">Initially the production database does not contain these objects, so when the application is first deployed (or when it is deployed for the first time after application services have been added), you must take extra steps to get these requisite database objects on the production database.</span></span>

<span data-ttu-id="69cc8-173">Otro reto puede surgir al implementar un sitio web que usa servicios de aplicaciones si desea replicar las cuentas de usuario creadas en el entorno de desarrollo en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-173">Another challenge can arise when deploying a website that uses application services if you intend to replicate the user accounts created in the development environment to the production environment.</span></span> <span data-ttu-id="69cc8-174">En función de la configuración de pertenencia y roles, es posible que, aunque se copien correctamente las cuentas de usuario que se crearon en el entorno de desarrollo en la base de datos de producción, estos usuarios no puedan iniciar sesión en la aplicación web en producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-174">Depending on the Membership and Roles configuration, it is possible that even if you successfully copy the user accounts that were created in the development environment to the production database, these users cannot sign into the web application in production.</span></span> <span data-ttu-id="69cc8-175">Veremos la causa de este problema y veremos cómo evitar que se produzca.</span><span class="sxs-lookup"><span data-stu-id="69cc8-175">We'll look at the cause of this issue and discuss how to prevent it from happening.</span></span>

<span data-ttu-id="69cc8-176">ASP.NET se suministra con una atractiva [*herramienta de administración de sitios web (WSAT)* ](https://msdn.microsoft.com/library/yy40ytx0.aspx) que se puede iniciar desde Visual Studio y permite que la cuenta de usuario, los roles y las reglas de autorización se administren mediante una interfaz basada en Web.</span><span class="sxs-lookup"><span data-stu-id="69cc8-176">ASP.NET ships with a nice [*Web Site Administration Tool (WSAT)*](https://msdn.microsoft.com/library/yy40ytx0.aspx) that can be launched from Visual Studio and allows the user account, roles, and authorization rules to be managed through a web-based interface.</span></span> <span data-ttu-id="69cc8-177">Desafortunadamente, el WSAT solo funciona para sitios web locales, lo que significa que no se puede usar para administrar de forma remota las cuentas de usuario, los roles y las reglas de autorización para la aplicación web en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-177">Unfortunately, the WSAT only works for local websites, meaning that it cannot be used to remotely manage user accounts, roles, and authorization rules for the web application in the production environment.</span></span> <span data-ttu-id="69cc8-178">Veremos diferentes maneras de implementar el comportamiento similar a WSAT desde el sitio web de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-178">We'll look at different ways to implement WSAT-like behavior from your production website.</span></span>

### <a name="adding-the-database-objects-using-aspnet_regsqlexe"></a><span data-ttu-id="69cc8-179">Agregar los objetos de base de datos mediante ASPNET\_regsql. exe</span><span class="sxs-lookup"><span data-stu-id="69cc8-179">Adding the Database Objects Using aspnet\_regsql.exe</span></span>

<span data-ttu-id="69cc8-180">En el tutorial *implementación de una base* de datos se ha mostrado cómo copiar las tablas y los datos de la base de datos de desarrollo en la base de datos de producción, y estas técnicas se pueden usar con seguridad para copiar los objetos de base de datos de servicios de aplicación en la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-180">The *Deploying a Database* tutorial showed how to copy the tables and data from the development database to the production database, and these techniques can certainly be used to copy the application services database objects to the production database.</span></span> <span data-ttu-id="69cc8-181">Otra opción es la herramienta de `aspnet_regsql.exe`, que agrega o quita los objetos de base de datos de servicios de aplicación de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="69cc8-181">Another option is the `aspnet_regsql.exe` tool, which adds or removes the application services database objects from a database.</span></span>

> [!NOTE]
> <span data-ttu-id="69cc8-182">La herramienta `aspnet_regsql.exe` crea los objetos de base de datos en una base de datos especificada.</span><span class="sxs-lookup"><span data-stu-id="69cc8-182">The `aspnet_regsql.exe` tool creates the database objects on a specified database.</span></span> <span data-ttu-id="69cc8-183">No migra datos de estos objetos de base de datos de desarrollo a la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-183">It does not migrate data in those database objects from the development database to the production database.</span></span> <span data-ttu-id="69cc8-184">Si quiere copiar la información de la cuenta de usuario y de los roles de la base de datos de desarrollo en la base de datos de producción, use las técnicas que se describen en el tutorial *implementación de una base de datos* .</span><span class="sxs-lookup"><span data-stu-id="69cc8-184">If you mean to copy the user account and role information in the development database to the production database use the techniques covered in the *Deploying a Database* tutorial.</span></span>

<span data-ttu-id="69cc8-185">Echemos un vistazo a cómo agregar los objetos de base de datos a la base de datos de producción mediante la herramienta `aspnet_regsql.exe`.</span><span class="sxs-lookup"><span data-stu-id="69cc8-185">Let s look at how to add the database objects to the production database using the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="69cc8-186">Para empezar, abra el explorador de Windows y vaya al directorio .NET Framework versión 2,0 del equipo,% WINDIR% \ Microsoft. NET\Framework\v2.0.50727.</span><span class="sxs-lookup"><span data-stu-id="69cc8-186">Start by opening Windows Explorer and navigating to the .NET Framework version 2.0 directory on your computer, %WINDIR%\ Microsoft.NET\Framework\v2.0.50727.</span></span> <span data-ttu-id="69cc8-187">Allí debe encontrar la herramienta `aspnet_regsql.exe`.</span><span class="sxs-lookup"><span data-stu-id="69cc8-187">There you should find the `aspnet_regsql.exe` tool.</span></span> <span data-ttu-id="69cc8-188">Esta herramienta se puede usar desde la línea de comandos, pero también incluye una interfaz gráfica de usuario. Haga doble clic en el archivo de `aspnet_regsql.exe` para iniciar su componente gráfico.</span><span class="sxs-lookup"><span data-stu-id="69cc8-188">This tool can be used from the command-line, but it also includes a graphical user interface; double-click the `aspnet_regsql.exe` file to launch its graphical component.</span></span>

<span data-ttu-id="69cc8-189">La herramienta se inicia mostrando una pantalla de presentación que explica su propósito.</span><span class="sxs-lookup"><span data-stu-id="69cc8-189">The tool starts by displaying a splash screen explaining its purpose.</span></span> <span data-ttu-id="69cc8-190">Haga clic en siguiente para avanzar a la pantalla "seleccionar una opción de instalación", que se muestra en la figura 1.</span><span class="sxs-lookup"><span data-stu-id="69cc8-190">Click Next to advance to the "Select a Setup Option" screen, which is shown in Figure 1.</span></span> <span data-ttu-id="69cc8-191">Desde aquí puede elegir agregar los objetos de base de datos de servicios de aplicación o quitarlos de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="69cc8-191">From here you can choose to add the application services database objects or remove them from a database.</span></span> <span data-ttu-id="69cc8-192">Dado que deseamos agregar estos objetos a la base de datos de producción, seleccione la opción "configurar SQL Server para servicios de aplicación" y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="69cc8-192">Because we want to add these objects to the production database, select the "Configure SQL Server for application services" option and click Next.</span></span>

<span data-ttu-id="69cc8-193">[![optar por configurar SQL Server para Servicios de aplicación](configuring-a-website-that-uses-application-services-cs/_static/image2.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="69cc8-193">[![Choose to Configure SQL Server for Application Services](configuring-a-website-that-uses-application-services-cs/_static/image2.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image1.jpg)</span></span>

<span data-ttu-id="69cc8-194">**Figura 1**: configuración de SQL Server para servicios de aplicación ([haga clic para ver la imagen de tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image3.jpg))</span><span class="sxs-lookup"><span data-stu-id="69cc8-194">**Figure 1**: Choose to Configure SQL Server for Application Services ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image3.jpg))</span></span>

<span data-ttu-id="69cc8-195">En la pantalla "seleccionar el servidor y la base de datos", se solicita información para conectarse a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="69cc8-195">In "Select the Server and Database" screen prompts for information to connect to the database.</span></span> <span data-ttu-id="69cc8-196">Escriba el servidor de base de datos, las credenciales de seguridad y el nombre de la base de datos que le proporcionó su empresa de hospedaje web y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="69cc8-196">Enter the database server, the security credentials, and the database name supplied to you by your web hosting company and click Next.</span></span>

> [!NOTE]
> <span data-ttu-id="69cc8-197">Después de especificar el servidor de base de datos y las credenciales, puede obtener un error al expandir la lista desplegable base de datos.</span><span class="sxs-lookup"><span data-stu-id="69cc8-197">After entering your database server and credentials you may get an error when expanding the database drop-down list.</span></span> <span data-ttu-id="69cc8-198">La herramienta `aspnet_regsql.exe` consulta la tabla del sistema `sysdatabases` para recuperar una lista de bases de datos en el servidor, pero algunas empresas de hospedaje web bloquean sus servidores de bases de datos para que esta información no esté disponible públicamente.</span><span class="sxs-lookup"><span data-stu-id="69cc8-198">The `aspnet_regsql.exe` tool queries the `sysdatabases` system table to retrieve a list of databases on the server, but some web hosting companies lock down their database servers so that this information is not publicly available.</span></span> <span data-ttu-id="69cc8-199">Si obtiene este error, puede escribir el nombre de la base de datos directamente en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="69cc8-199">If you get this error you can type the database name directly into the drop-down list.</span></span>

<span data-ttu-id="69cc8-200">[![proporcionar la herramienta con la información de conexión de la base de datos](configuring-a-website-that-uses-application-services-cs/_static/image5.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="69cc8-200">[![Supply the Tool With Your Database s Connection Information](configuring-a-website-that-uses-application-services-cs/_static/image5.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image4.jpg)</span></span>

<span data-ttu-id="69cc8-201">**Figura 2**: proporcione la herramienta con la información de conexión de la base de datos ([haga clic para ver la imagen de tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image6.jpg))</span><span class="sxs-lookup"><span data-stu-id="69cc8-201">**Figure 2**: Supply the Tool With Your Database s Connection Information ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image6.jpg))</span></span>

<span data-ttu-id="69cc8-202">En la pantalla siguiente se resumen las acciones que se van a realizar, es decir, que los objetos de base de datos de servicios de aplicación se van a agregar a la base de datos especificada.</span><span class="sxs-lookup"><span data-stu-id="69cc8-202">The subsequent screen summarizes the actions that are about to take place, namely that the application services database objects are going to be added to the specified database.</span></span> <span data-ttu-id="69cc8-203">Haga clic en siguiente para completar esta acción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-203">Click Next to complete this action.</span></span> <span data-ttu-id="69cc8-204">Transcurridos unos instantes, se muestra la pantalla final, teniendo en cuenta que se han agregado los objetos de base de datos (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="69cc8-204">After a few moments, the final screen is displayed, noting that the database objects have been added (see Figure 3).</span></span>

<span data-ttu-id="69cc8-205">[![correcto. Los objetos de base de datos de Servicios de aplicación se agregaron a la base de datos de producción](configuring-a-website-that-uses-application-services-cs/_static/image8.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="69cc8-205">[![Success! The Application Services Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-cs/_static/image8.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image7.jpg)</span></span>

<span data-ttu-id="69cc8-206">**Figura 3**: correcto.</span><span class="sxs-lookup"><span data-stu-id="69cc8-206">**Figure 3**: Success!</span></span> <span data-ttu-id="69cc8-207">Los objetos de base de datos de Servicios de aplicación se agregaron a la base de datos de producción ([haga clic para ver la imagen de tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image9.jpg))</span><span class="sxs-lookup"><span data-stu-id="69cc8-207">The Application Services Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image9.jpg))</span></span>

<span data-ttu-id="69cc8-208">Para comprobar que los objetos de base de datos de servicios de aplicación se agregaron correctamente a la base de datos de producción, abra SQL Server Management Studio y conéctese a la base de datos de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-208">To verify that the application services database objects were successfully added to the production database, open SQL Server Management Studio and connect to your production database.</span></span> <span data-ttu-id="69cc8-209">Como se muestra en la figura 4, ahora debería ver las tablas de base de datos de servicios de aplicación en la base de datos, `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`, etc.</span><span class="sxs-lookup"><span data-stu-id="69cc8-209">As Figure 4 shows, you should now see the application services database tables in your database, `aspnet_Applications`, `aspnet_Membership`, `aspnet_Users`, and so forth.</span></span>

<span data-ttu-id="69cc8-210">[![confirmar que los objetos de base de datos se agregaron a la base de datos de producción](configuring-a-website-that-uses-application-services-cs/_static/image11.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image10.jpg)</span><span class="sxs-lookup"><span data-stu-id="69cc8-210">[![Confirm That the Database Objects Were Added to the Production Database](configuring-a-website-that-uses-application-services-cs/_static/image11.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image10.jpg)</span></span>

<span data-ttu-id="69cc8-211">**Ilustración 4**: confirmar que los objetos de base de datos se agregaron a la base de datos de producción ([haga clic para ver la imagen de tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image12.jpg))</span><span class="sxs-lookup"><span data-stu-id="69cc8-211">**Figure 4**: Confirm That the Database Objects Were Added to the Production Database ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image12.jpg))</span></span>

<span data-ttu-id="69cc8-212">Solo tendrá que usar la herramienta `aspnet_regsql.exe` al implementar la aplicación web por primera vez o por primera vez después de haber empezado a usar los servicios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="69cc8-212">You will only need to use the `aspnet_regsql.exe` tool when deploying your web application for the first time or for the first time after you have started using the application services.</span></span> <span data-ttu-id="69cc8-213">Una vez que estos objetos de base de datos se encuentran en la base de datos de producción, no es necesario volver a agregar o modificar.</span><span class="sxs-lookup"><span data-stu-id="69cc8-213">Once these database objects are on the production database they won't need to be re-added or modified.</span></span>

### <a name="copying-user-accounts-from-development-to-production"></a><span data-ttu-id="69cc8-214">Copia de cuentas de usuario desde el desarrollo hasta el entorno de producción</span><span class="sxs-lookup"><span data-stu-id="69cc8-214">Copying User Accounts from Development to Production</span></span>

<span data-ttu-id="69cc8-215">Al utilizar las clases de proveedor `SqlMembershipProvider` y `SqlRoleProvider` para almacenar la información de servicios de aplicación en una base de datos de SQL Server, la información de la cuenta de usuario y el rol se almacena en diversas tablas de base de datos, como `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`y `aspnet_UsersInRoles`, entre otros.</span><span class="sxs-lookup"><span data-stu-id="69cc8-215">When using the `SqlMembershipProvider` and `SqlRoleProvider` provider classes to store the application services information in a SQL Server database, the user account and role information is stored in a variety of database tables, including `aspnet_Users`, `aspnet_Membership`, `aspnet_Roles`, and `aspnet_UsersInRoles`, among others.</span></span> <span data-ttu-id="69cc8-216">Si durante el desarrollo crea cuentas de usuario en el entorno de desarrollo, puede replicar esas cuentas de usuario en producción copiando los registros correspondientes de las tablas de base de datos aplicables.</span><span class="sxs-lookup"><span data-stu-id="69cc8-216">If during development you create user accounts in the development environment you can replicate those user accounts in production by copying the corresponding records from the applicable database tables.</span></span> <span data-ttu-id="69cc8-217">Si utilizó el Asistente para la publicación de bases de datos para implementar los objetos de base de datos de servicios de aplicación, puede que también haya elegido copiar los registros, lo que daría lugar a que las cuentas de usuario creadas en desarrollo también estén en producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-217">If you used the Database Publishing Wizard to deploy the application services database objects you may have also elected to copy the records, which would result in the user accounts created in development to also be on production.</span></span> <span data-ttu-id="69cc8-218">Sin embargo, en función de los valores de configuración, es posible que los usuarios cuyas cuentas se crearon en desarrollo y se copien en producción no puedan iniciar sesión en el sitio web de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-218">But, depending on your configuration settings, you may find that those users whose accounts were created in development and copied to production are unable to login from the production website.</span></span> <span data-ttu-id="69cc8-219">¿Qué ventajas aporta?</span><span class="sxs-lookup"><span data-stu-id="69cc8-219">What gives?</span></span>

<span data-ttu-id="69cc8-220">Las clases de proveedor `SqlMembershipProvider` y `SqlRoleProvider` se diseñaron de forma que una sola base de datos podría servir como almacén de usuario para varias aplicaciones, donde cada aplicación podría, en teoría, tener usuarios con nombres de usuario y roles superpuestos con el mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="69cc8-220">The `SqlMembershipProvider` and `SqlRoleProvider` provider classes were designed such that a single database could serve as a user store for multiple applications, where each application could, in theory, have users with overlapping usernames and roles with the same name.</span></span> <span data-ttu-id="69cc8-221">Para permitir esta flexibilidad, la base de datos mantiene una lista de aplicaciones en la tabla de `aspnet_Applications` y cada usuario está asociado a una de estas aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="69cc8-221">To allow for this flexibility, the database maintains a list of applications in the `aspnet_Applications` table, and each user is associated with one of these applications.</span></span> <span data-ttu-id="69cc8-222">En concreto, la tabla `aspnet_Users` tiene una columna `ApplicationId` que une cada usuario a un registro de la tabla `aspnet_Applications`.</span><span class="sxs-lookup"><span data-stu-id="69cc8-222">Specifically, the `aspnet_Users` table has an `ApplicationId` column that ties each user to a record in the `aspnet_Applications` table.</span></span>

<span data-ttu-id="69cc8-223">Además de la columna `ApplicationId`, la tabla `aspnet_Applications` incluye también una columna `ApplicationName`, que proporciona un nombre más descriptivo para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="69cc8-223">In addition to the `ApplicationId` column, the `aspnet_Applications` table also includes an `ApplicationName` column, which provides a more human-friendly name for the application.</span></span> <span data-ttu-id="69cc8-224">Cuando un sitio web intenta trabajar con una cuenta de usuario, como la validación de las credenciales de un usuario desde la página de inicio de sesión, debe indicar a la clase de `SqlMembershipProvider` la aplicación con la que se va a trabajar.</span><span class="sxs-lookup"><span data-stu-id="69cc8-224">When a website attempts to work with a user account, such as validating a user s credentials from the login page, it must tell the `SqlMembershipProvider` class what application to work with.</span></span> <span data-ttu-id="69cc8-225">Normalmente esto lo hace proporcionando el nombre de la aplicación y este valor procede de la configuración del proveedor en `Web.config`, específicamente a través del atributo `applicationName`.</span><span class="sxs-lookup"><span data-stu-id="69cc8-225">It usually does this by supplying the application name, and the this value comes from the provider s configuration in `Web.config` - specifically via the `applicationName` attribute.</span></span>

<span data-ttu-id="69cc8-226">Pero ¿qué ocurre si el atributo `applicationName` no se especifica en `Web.config`?</span><span class="sxs-lookup"><span data-stu-id="69cc8-226">But what happens if the `applicationName` attribute is not specified in `Web.config`?</span></span> <span data-ttu-id="69cc8-227">En tal caso, el sistema de pertenencia utiliza la ruta de acceso raíz de la aplicación como el valor `applicationName`.</span><span class="sxs-lookup"><span data-stu-id="69cc8-227">In such a case the Membership system uses the application root path as the `applicationName` value.</span></span> <span data-ttu-id="69cc8-228">Si el atributo `applicationName` no se establece explícitamente en `Web.config`, existe la posibilidad de que el entorno de desarrollo y el entorno de producción utilicen una raíz de aplicación diferente y, por tanto, se asociarán a distintos nombres de aplicación en los servicios de aplicación.</span><span class="sxs-lookup"><span data-stu-id="69cc8-228">If the `applicationName` attribute is not explicitly set in `Web.config`, then, there is the possibility that the development environment and production environment use a different application root and therefore will be associated with different application names in the application services.</span></span> <span data-ttu-id="69cc8-229">Si se produce un error de coincidencia, los usuarios creados en el entorno de desarrollo tendrán un valor `ApplicationId` que no coincide con el valor `ApplicationId` para el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-229">If such a mismatch occurs then those users created in the development environment will have an `ApplicationId` value that does not match with the `ApplicationId` value for the production environment.</span></span> <span data-ttu-id="69cc8-230">El resultado neto es que esos usuarios no podrán iniciar sesión.</span><span class="sxs-lookup"><span data-stu-id="69cc8-230">The net result is that those users won't be able to login.</span></span>

> [!NOTE]
> <span data-ttu-id="69cc8-231">Si se encuentra en esta situación, con las cuentas de usuario copiadas en producción con un valor de `ApplicationId` no coincidente: puede escribir una consulta para actualizar estos valores `ApplicationId` incorrectos a los `ApplicationId` utilizados en producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-231">If you find yourself in this situation - with user accounts copied to production with a mismatched `ApplicationId` value - you could write a query to update these incorrect `ApplicationId` values to the `ApplicationId` used on production.</span></span> <span data-ttu-id="69cc8-232">Una vez actualizados, los usuarios cuyas cuentas se crearon en el entorno de desarrollo ahora podrán iniciar sesión en la aplicación web en producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-232">Once updated, the users whose accounts were created on the development environment would now be able to sign into the web application on production.</span></span>

<span data-ttu-id="69cc8-233">La buena noticia es que hay un paso sencillo que puede realizar para asegurarse de que los dos entornos usan el mismo `ApplicationId`: establezca explícitamente el atributo de `applicationName` en `Web.config` para todos los proveedores de servicios de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="69cc8-233">The good news is that there is a simple step you can take to ensure that the two environments use the same `ApplicationId` - explicitly set the `applicationName` attribute in `Web.config` for all of your application services providers.</span></span> <span data-ttu-id="69cc8-234">Establezca explícitamente el atributo `applicationName` en "BookReviews" en los elementos `<membership>` y `<roleManager>` como este fragmento de código de `Web.config` muestra.</span><span class="sxs-lookup"><span data-stu-id="69cc8-234">I explicitly set the `applicationName` attribute to "BookReviews" in the `<membership>` and `<roleManager>` elements as this snippet from `Web.config` shows.</span></span>

[!code-xml[Main](configuring-a-website-that-uses-application-services-cs/samples/sample4.xml)]

<span data-ttu-id="69cc8-235">Para obtener más información sobre cómo establecer el atributo de `applicationName` y la lógica subyacente, consulte la entrada de blog de [*Scott Guthrie*](https://weblogs.asp.net/scottgu/) s y [*establezca siempre la propiedad ApplicationName al configurar la pertenencia a ASP.net y otros proveedores*](https://weblogs.asp.net/scottgu/443634).</span><span class="sxs-lookup"><span data-stu-id="69cc8-235">For more discussion on setting the `applicationName` attribute and the rationale behind it, refer to [*Scott Guthrie*](https://weblogs.asp.net/scottgu/) s blog post, [*Always set the applicationName property when configuring ASP.NET Membership and other Providers*](https://weblogs.asp.net/scottgu/443634).</span></span>

### <a name="managing-user-accounts-in-the-production-environment"></a><span data-ttu-id="69cc8-236">Administrar cuentas de usuario en el entorno de producción</span><span class="sxs-lookup"><span data-stu-id="69cc8-236">Managing User Accounts in the Production Environment</span></span>

<span data-ttu-id="69cc8-237">La herramienta de administración de sitios web (WSAT) de ASP.NET facilita la creación y administración de cuentas de usuario, la definición y la aplicación de roles, y la escritura de reglas de autorización basadas en roles y usuarios.</span><span class="sxs-lookup"><span data-stu-id="69cc8-237">The ASP.NET Web Site Administration Tool (WSAT) makes it easy to create and manage user accounts, define and apply roles, and spell out user- and role-based authorization rules.</span></span> <span data-ttu-id="69cc8-238">Puede iniciar el WSAT desde Visual Studio; para ello, vaya a la Explorador de soluciones y haga clic en el icono de configuración de ASP.NET o vaya a los menús del sitio web o proyecto y seleccione el elemento de menú configuración de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="69cc8-238">You can launch the WSAT from Visual Studio by going to the Solution Explorer and clicking the ASP.NET Configuration icon or by going to the Website or Project menus and selecting the ASP.NET Configuration menu item.</span></span> <span data-ttu-id="69cc8-239">Desafortunadamente, el WSAT solo puede funcionar con sitios web locales.</span><span class="sxs-lookup"><span data-stu-id="69cc8-239">Unfortunately, the WSAT can only work with local websites.</span></span> <span data-ttu-id="69cc8-240">Por lo tanto, no puede usar el WSAT de su estación de trabajo para administrar el sitio web en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-240">Therefore, you cannot use the WSAT from your workstation to manage the website in the production environment.</span></span>

<span data-ttu-id="69cc8-241">La buena noticia es que todas las funcionalidades expuestas que proporciona WSAT están disponibles mediante programación a través de las API de pertenencia y roles. Además, muchas de las pantallas de WSAT usan los controles estándar relacionados con el inicio de sesión de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="69cc8-241">The good news is that all of the functionality exposed provided by the WSAT is available programmatically through the Membership and Roles APIs; furthermore, many of the WSAT screens use the standard ASP.NET Login-related controls.</span></span> <span data-ttu-id="69cc8-242">En Resumen, puede agregar páginas ASP.NET a su sitio web que ofrezcan las capacidades de administración necesarias.</span><span class="sxs-lookup"><span data-stu-id="69cc8-242">In short, you can add ASP.NET pages to your website that offer the necessary management capabilities.</span></span>

<span data-ttu-id="69cc8-243">Recuerde que en un tutorial anterior se ha actualizado la aplicación web revisar el libro para incluir una `~/Admin` carpeta y que esta carpeta se ha configurado para permitir solo los usuarios con el rol administrador.</span><span class="sxs-lookup"><span data-stu-id="69cc8-243">Recall that an earlier tutorial updated the Book Reviews web application to include an `~/Admin` folder, and this folder has been configured to only allow users in the Admin role.</span></span> <span data-ttu-id="69cc8-244">He agregado una página a esa carpeta llamada `CreateAccount.aspx` desde la que un administrador puede crear una nueva cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="69cc8-244">I added a page to that folder named `CreateAccount.aspx` from which an administrator can create a new user account.</span></span> <span data-ttu-id="69cc8-245">En esta página se usa el control CreateUserWizard para mostrar la interfaz de usuario y la lógica de back-end para crear una nueva cuenta de usuario.</span><span class="sxs-lookup"><span data-stu-id="69cc8-245">This page uses the CreateUserWizard control to display the user interface and backend logic for creating a new user account.</span></span> <span data-ttu-id="69cc8-246">Lo que es más, personalizó el control para que incluya una casilla que le pregunte si el nuevo usuario también debe agregarse al rol de administrador (vea la figura 5).</span><span class="sxs-lookup"><span data-stu-id="69cc8-246">What s more, I customized the control to include a CheckBox that prompts whether the new user should also be added to the Admin role (see Figure 5).</span></span> <span data-ttu-id="69cc8-247">Con un poco de trabajo puede crear un conjunto personalizado de páginas que implementa las tareas relacionadas con la administración de usuarios y roles que, de lo contrario, proporcionaría el WSAT.</span><span class="sxs-lookup"><span data-stu-id="69cc8-247">With a little bit of work you can build a custom set of pages that implements the user and role management-related tasks that would otherwise be provided by the WSAT.</span></span>

> [!NOTE]
> <span data-ttu-id="69cc8-248">Para obtener más información sobre el uso de las API de pertenencia y roles junto con los controles Web de ASP.NET relacionados con el inicio de sesión, asegúrese de leer los [*tutoriales de seguridad de los sitios web*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="69cc8-248">For more information on using the Membership and Roles APIs along with the Login-related ASP.NET Web controls, be sure to read my [*Website Security Tutorials*](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span> <span data-ttu-id="69cc8-249">Para obtener más información sobre cómo personalizar el control CreateUserWizard, consulte los tutoriales [*creación de cuentas de usuario*](../../older-versions-security/membership/creating-user-accounts-cs.md) y almacenamiento de información de [*usuario adicional*](../../older-versions-security/membership/storing-additional-user-information-cs.md) , o consulte [*Erich Peterson*](http://www.erichpeterson.com/) s article, [*Personalización del control CreateUserWizard*](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="69cc8-249">For more on customizing the CreateUserWizard control refer to the [*Creating User Accounts*](../../older-versions-security/membership/creating-user-accounts-cs.md) and [*Storing Additional User Information*](../../older-versions-security/membership/storing-additional-user-information-cs.md) tutorials, or check out [*Erich Peterson*](http://www.erichpeterson.com/) s article, [*Customizing the CreateUserWizard Control*](http://aspnet.4guysfromrolla.com/articles/070506-1.aspx).</span></span>

<span data-ttu-id="69cc8-250">[![los administradores pueden crear nuevas cuentas de usuario](configuring-a-website-that-uses-application-services-cs/_static/image14.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image13.jpg)</span><span class="sxs-lookup"><span data-stu-id="69cc8-250">[![Administrators Can Create New User Accounts](configuring-a-website-that-uses-application-services-cs/_static/image14.jpg)](configuring-a-website-that-uses-application-services-cs/_static/image13.jpg)</span></span>

<span data-ttu-id="69cc8-251">**Figura 5**: los administradores pueden crear nuevas cuentas de usuario ([haga clic para ver la imagen a tamaño completo](configuring-a-website-that-uses-application-services-cs/_static/image15.jpg))</span><span class="sxs-lookup"><span data-stu-id="69cc8-251">**Figure 5**: Administrators Can Create New User Accounts ([Click to view full-size image](configuring-a-website-that-uses-application-services-cs/_static/image15.jpg))</span></span>

<span data-ttu-id="69cc8-252">Si necesita la funcionalidad completa de WSAT, consulte el tema sobre la creación de una [*herramienta de administración de sitios web*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)en la que Author dan Clem le guía por el proceso de creación de una herramienta de tipo WSAT personalizada.</span><span class="sxs-lookup"><span data-stu-id="69cc8-252">If you need the full functionality of the WSAT check out [*Rolling Your Own Web Site Administration Tool*](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx), in which author Dan Clem walks through the process of building a custom WSAT-like tool.</span></span> <span data-ttu-id="69cc8-253">Juan comparte el código fuente de la aplicación ( C#en) y proporciona instrucciones paso a paso para agregarlo al sitio web hospedado.</span><span class="sxs-lookup"><span data-stu-id="69cc8-253">Dan shares his application s source code (in C#) and provides step-by-step instructions for adding it to your hosted website.</span></span>

## <a name="summary"></a><span data-ttu-id="69cc8-254">Resumen</span><span class="sxs-lookup"><span data-stu-id="69cc8-254">Summary</span></span>

<span data-ttu-id="69cc8-255">Al implementar una aplicación web que usa la implementación de base de datos de servicios de aplicación, primero debe asegurarse de que la base de datos de producción tenga los objetos de base de datos necesarios.</span><span class="sxs-lookup"><span data-stu-id="69cc8-255">When deploying a web application that uses the application services database implementation you must first ensure that the production database has the requisite database objects.</span></span> <span data-ttu-id="69cc8-256">Estos objetos se pueden agregar mediante las técnicas que se describen en el tutorial *implementación de una base de datos* ; como alternativa, puede usar la herramienta de `aspnet_regsql.exe`, como vimos en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="69cc8-256">These objects can be added using the techniques discussed in the *Deploying a Database* tutorial; alternatively, you can use the `aspnet_regsql.exe` tool, as we saw in this tutorial.</span></span> <span data-ttu-id="69cc8-257">Otros desafíos que hemos tratado en el centro sobre la sincronización del nombre de la aplicación que se usa en los entornos de desarrollo y producción (que es importante si desea que los usuarios y los roles creados en el entorno de desarrollo sean válidos en producción) y técnicas para administrar los usuarios y los roles en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="69cc8-257">Other challenges we touched on center around synchronizing the application name used in the development and production environments (which is important if you want users and roles created in the development environment to be valid on production) and techniques for managing the users and roles in the production environment.</span></span>

<span data-ttu-id="69cc8-258">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="69cc8-258">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="69cc8-259">Información adicional</span><span class="sxs-lookup"><span data-stu-id="69cc8-259">Further Reading</span></span>

<span data-ttu-id="69cc8-260">Para obtener más información sobre los temas descritos en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="69cc8-260">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="69cc8-261">*Herramienta de registro de SQL Server de ASP.NET (aspnet_regsql. exe)* </span><span class="sxs-lookup"><span data-stu-id="69cc8-261">*ASP.NET SQL Server Registration Tool (aspnet_regsql.exe)*</span></span>](https://msdn.microsoft.com/library/ms229862.aspx)
- [<span data-ttu-id="69cc8-262">*Crear la base de datos de Servicios de aplicación para SQL Server*</span><span class="sxs-lookup"><span data-stu-id="69cc8-262">*Creating the Application Services Database for SQL Server*</span></span>](https://msdn.microsoft.com/library/x28wfk74.aspx)
- [<span data-ttu-id="69cc8-263">*Crear el esquema de pertenencia en SQL Server*</span><span class="sxs-lookup"><span data-stu-id="69cc8-263">*Creating the Membership Schema in SQL Server*</span></span>](../../older-versions-security/membership/creating-the-membership-schema-in-sql-server-cs.md)
- [<span data-ttu-id="69cc8-264">*Examen de la pertenencia, los roles y el perfil de ASP.NET s*</span><span class="sxs-lookup"><span data-stu-id="69cc8-264">*Examining ASP.NET s Membership, Roles, and Profile*</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="69cc8-265">*Implementar su propia herramienta de administración de sitios web*</span><span class="sxs-lookup"><span data-stu-id="69cc8-265">*Rolling Your Own Web Site Administration Tool*</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="69cc8-266">*Tutoriales de seguridad de sitios web*</span><span class="sxs-lookup"><span data-stu-id="69cc8-266">*Website Security Tutorials*</span></span>](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md)
- [<span data-ttu-id="69cc8-267">*Información general de la herramienta de administración de sitios web*</span><span class="sxs-lookup"><span data-stu-id="69cc8-267">*Web Site Administration Tool Overview*</span></span>](https://msdn.microsoft.com/library/yy40ytx0.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="69cc8-268">[Anterior](configuring-the-production-web-application-to-use-the-production-database-cs.md)
> [Siguiente](strategies-for-database-development-and-deployment-cs.md)</span><span class="sxs-lookup"><span data-stu-id="69cc8-268">[Previous](configuring-the-production-web-application-to-use-the-production-database-cs.md)
[Next](strategies-for-database-development-and-deployment-cs.md)</span></span>

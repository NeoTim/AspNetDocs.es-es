---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
title: Actualizar TableAdapter para usar Join (C#) | Microsoft Docs
author: rick-anderson
description: Cuando se trabaja con una base de datos es común a los datos de solicitud que se reparten entre varias tablas. Para recuperar datos de dos tablas diferentes podemos usar ya sea...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 675531a7-cb54-4dd6-89ac-2636e4c285a5
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
msc.type: authoredcontent
ms.openlocfilehash: d5b69b502cf650a477b2841c25ad3f1ab5f8da93
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/01/2019
ms.locfileid: "57050632"
---
<a name="updating-the-tableadapter-to-use-joins-c"></a><span data-ttu-id="fa631-104">Actualizar TableAdapter para usar JOIN (C#)</span><span class="sxs-lookup"><span data-stu-id="fa631-104">Updating the TableAdapter to Use JOINs (C#)</span></span>
====================
<span data-ttu-id="fa631-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="fa631-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="fa631-106">[Descargar código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) o [descargar PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="fa631-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span></span>

> <span data-ttu-id="fa631-107">Cuando se trabaja con una base de datos es común a los datos de solicitud que se reparten entre varias tablas.</span><span class="sxs-lookup"><span data-stu-id="fa631-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="fa631-108">Podemos usar una subconsulta correlacionada o una operación de combinación para recuperar datos de dos tablas diferentes.</span><span class="sxs-lookup"><span data-stu-id="fa631-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="fa631-109">En este tutorial se compare subconsultas correlacionadas y la sintaxis de combinación antes de ver cómo crear un TableAdapter que incluye una combinación de la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="fa631-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="fa631-110">Introducción</span><span class="sxs-lookup"><span data-stu-id="fa631-110">Introduction</span></span>

<span data-ttu-id="fa631-111">Con bases de datos relacionales los datos que está interesados en trabajar con frecuencia se reparten entre varias tablas.</span><span class="sxs-lookup"><span data-stu-id="fa631-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="fa631-112">Por ejemplo, al mostrar información de producto es probable que queremos mostrar cada categoría de producto s correspondiente y los nombres de proveedor s.</span><span class="sxs-lookup"><span data-stu-id="fa631-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="fa631-113">El `Products` tabla tiene `CategoryID` y `SupplierID` valores, pero los nombres de categoría y el proveedor reales se encuentran en el `Categories` y `Suppliers` tablas, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="fa631-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="fa631-114">Para recuperar información de otra tabla relacionada, se puede usar *subconsultas correlacionadas* o `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="fa631-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="fa631-115">Una subconsulta correlacionada está anidada `SELECT` consulta que hace referencia a columnas de la consulta externa.</span><span class="sxs-lookup"><span data-stu-id="fa631-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="fa631-116">Por ejemplo, en el [crear una capa de acceso a datos](../introduction/creating-a-data-access-layer-cs.md) tutorial hemos usado dos subconsultas correlacionadas en el `ProductsTableAdapter` consulta principal de s para devolver los nombres de categoría y el proveedor para cada producto.</span><span class="sxs-lookup"><span data-stu-id="fa631-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="fa631-117">Un `JOIN` es una construcción SQL que combina las filas relacionadas de dos tablas diferentes.</span><span class="sxs-lookup"><span data-stu-id="fa631-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="fa631-118">Hemos usado un `JOIN` en el [consultar datos con el SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial para mostrar información de categoría junto con cada producto.</span><span class="sxs-lookup"><span data-stu-id="fa631-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="fa631-119">El motivo nos hemos abstención utilizasen `JOIN` s con los TableAdapters es debido a limitaciones en el Asistente para la s de TableAdapter para generar automáticamente correspondiente `INSERT`, `UPDATE`, y `DELETE` instrucciones.</span><span class="sxs-lookup"><span data-stu-id="fa631-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="fa631-120">Más concretamente, si la consulta principal de TableAdapter s contiene cualquier `JOIN` s, TableAdapter no puede crear automáticamente las instrucciones SQL ad hoc o los procedimientos almacenados para su `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades.</span><span class="sxs-lookup"><span data-stu-id="fa631-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="fa631-121">En este tutorial se comparará brevemente y contraste las subconsultas correlacionadas y `JOIN` s antes de explorar cómo crear un TableAdapter que incluye `JOIN` s en su consulta principal.</span><span class="sxs-lookup"><span data-stu-id="fa631-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="fa631-122">Comparar y contrastar las subconsultas correlacionadas y`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="fa631-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="fa631-123">Recuerde que el `ProductsTableAdapter` creado en el primer tutorial de la `Northwind` conjunto de datos utiliza las subconsultas correlativas para devolver cada nombre producto s de categoría y el proveedor correspondiente.</span><span class="sxs-lookup"><span data-stu-id="fa631-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="fa631-124">El `ProductsTableAdapter` consulta principal s se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="fa631-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample1.sql)]

<span data-ttu-id="fa631-125">Los dos correlacionado subconsultas - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` y `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` -son `SELECT` consultas que devuelven un único valor por el producto como una columna adicional en el exterior `SELECT` lista de columnas de la instrucción s.</span><span class="sxs-lookup"><span data-stu-id="fa631-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="fa631-126">Como alternativa, un `JOIN` puede usarse para devolver cada nombre de proveedor y categoría de producto s.</span><span class="sxs-lookup"><span data-stu-id="fa631-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="fa631-127">La siguiente consulta devuelve el mismo resultado que lo anterior, pero utiliza `JOIN` s en lugar de subconsultas:</span><span class="sxs-lookup"><span data-stu-id="fa631-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample2.sql)]

<span data-ttu-id="fa631-128">Un `JOIN` combina los registros de una tabla con registros de otra tabla según algunos criterios.</span><span class="sxs-lookup"><span data-stu-id="fa631-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="fa631-129">En la consulta anterior, por ejemplo, el `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` indica a SQL Server para combinar cada registro del producto con la categoría de registro cuya `CategoryID` valor coincide con el producto s `CategoryID` valor.</span><span class="sxs-lookup"><span data-stu-id="fa631-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="fa631-130">El resultado combinado nos permite trabajar con los campos de categoría correspondiente para cada producto (como `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="fa631-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="fa631-131">`JOIN` s se usan normalmente cuando se consultan datos desde bases de datos relacionales.</span><span class="sxs-lookup"><span data-stu-id="fa631-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="fa631-132">Si está familiarizado con el `JOIN` sintaxis o necesidad repasarlo un poco acerca de su uso, d recomiendo el [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) en [W3 Schools](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="fa631-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="fa631-133">También vale la pena leer son la [ `JOIN` Fundamentos](https://msdn.microsoft.com/library/ms191517.aspx) y [conceptos básicos de subconsultas](https://msdn.microsoft.com/library/ms189575.aspx) secciones de la [libros en pantalla de SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="fa631-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="fa631-134">Puesto que `JOIN` s y subconsultas correlacionadas ambos sirve para recuperar datos relacionados de otras tablas, muchos desarrolladores quedan arañazos sus encabezados y se pregunta qué aproximación utilizar.</span><span class="sxs-lookup"><span data-stu-id="fa631-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="fa631-135">Todos los gurús de SQL se ve hablado han dicho aproximadamente lo mismo que TI t importa realmente en cuanto al rendimiento como SQL Server generará los planes de ejecución casi idénticos.</span><span class="sxs-lookup"><span data-stu-id="fa631-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="fa631-136">A continuación, sus consejos, es usar la técnica que usted y su equipo se sienta más cómodos.</span><span class="sxs-lookup"><span data-stu-id="fa631-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="fa631-137">Merece teniendo en cuenta que después de transmitir este Consejo estos expertos inmediatamente expresan sus preferencias de `JOIN` s a lo largo de las subconsultas correlativas.</span><span class="sxs-lookup"><span data-stu-id="fa631-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="fa631-138">Cuando se crea una capa de acceso a datos mediante conjuntos de datos con tipo, las herramientas funcionan mejor cuando el uso de subconsultas.</span><span class="sxs-lookup"><span data-stu-id="fa631-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="fa631-139">En concreto, el Asistente para la s de TableAdapter no generará automáticamente correspondiente `INSERT`, `UPDATE`, y `DELETE` instrucciones si la consulta principal contiene cualquier `JOIN` s, pero generará automáticamente estas instrucciones cuando están correlacionados subconsultas se usan.</span><span class="sxs-lookup"><span data-stu-id="fa631-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="fa631-140">Para explorar este inconveniente, crear un conjunto de datos de tipo temporal en el `~/App_Code/DAL` carpeta.</span><span class="sxs-lookup"><span data-stu-id="fa631-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="fa631-141">Durante el Asistente para configuración de TableAdapter, optar por usar instrucciones SQL ad hoc y escriba lo siguiente `SELECT` consulta (consulte la figura 1):</span><span class="sxs-lookup"><span data-stu-id="fa631-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample3.sql)]


<span data-ttu-id="fa631-142">[![Escriba una consulta principal que contiene las combinaciones](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span></span>

<span data-ttu-id="fa631-143">**Figura 1**: Escriba una consulta principal que contiene `JOIN` s ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span></span>


<span data-ttu-id="fa631-144">De forma predeterminada, se creará automáticamente el TableAdapter `INSERT`, `UPDATE`, y `DELETE` las instrucciones en función de la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="fa631-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="fa631-145">Si hace clic en el botón Opciones avanzadas, que puede ver que esta característica está habilitada.</span><span class="sxs-lookup"><span data-stu-id="fa631-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="fa631-146">A pesar de esta configuración, lo TableAdapter no podrá crear el `INSERT`, `UPDATE`, y `DELETE` instrucciones porque la consulta principal contiene un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fa631-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Escriba una consulta principal que contiene las combinaciones](updating-the-tableadapter-to-use-joins-cs/_static/image4.png)

<span data-ttu-id="fa631-148">**Figura 2**: Escriba una consulta principal que contenga `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="fa631-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="fa631-149">Haga clic en Finalizar para completar al asistente.</span><span class="sxs-lookup"><span data-stu-id="fa631-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="fa631-150">En este momento su diseñador de DataSet s incluirá un solo TableAdapter con un objeto DataTable con columnas para cada uno de los campos devueltos en el `SELECT` lista de columnas de la consulta s.</span><span class="sxs-lookup"><span data-stu-id="fa631-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="fa631-151">Esto incluye la `CategoryName` y `SupplierName`, como se muestra en la figura 3.</span><span class="sxs-lookup"><span data-stu-id="fa631-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![La tabla de datos incluye una columna para cada campo devuelto en la lista de columnas](updating-the-tableadapter-to-use-joins-cs/_static/image5.png)

<span data-ttu-id="fa631-153">**Figura 3**: La tabla de datos incluye una columna para cada campo devuelto en la lista de columnas</span><span class="sxs-lookup"><span data-stu-id="fa631-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="fa631-154">Aunque la tabla de datos tiene las columnas apropiadas, TableAdapter le faltan valores para su `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades.</span><span class="sxs-lookup"><span data-stu-id="fa631-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="fa631-155">Para confirmarlo, haga clic en el TableAdapter en el diseñador y, a continuación, vaya a la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="fa631-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="fa631-156">Allí verá el `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades se establecen en (None).</span><span class="sxs-lookup"><span data-stu-id="fa631-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="fa631-157">[![El InsertCommand, UpdateCommand y DeleteCommand propiedades se establecen en (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span></span>

<span data-ttu-id="fa631-158">**Figura 4**: El `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades se establecen en (None) ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span></span>


<span data-ttu-id="fa631-159">Para evitar este inconveniente, podemos proporcionar manualmente las instrucciones SQL y parámetros para el `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades a través de la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="fa631-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="fa631-160">Como alternativa, podríamos comenzar mediante la configuración de la consulta principal de TableAdapter s a *no* incluir cualquiera `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="fa631-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="fa631-161">Esto permitirá que el `INSERT`, `UPDATE`, y `DELETE` instrucciones al generarse automáticamente para nosotros.</span><span class="sxs-lookup"><span data-stu-id="fa631-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="fa631-162">Después de completar el asistente, nos podríamos, a continuación, actualizar manualmente los TableAdapter s `SelectCommand` desde la ventana Propiedades, por lo que incluye el `JOIN` sintaxis.</span><span class="sxs-lookup"><span data-stu-id="fa631-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="fa631-163">Aunque este enfoque funciona, es muy complicado cuando el uso de consultas SQL ad hoc porque cada vez que la consulta principal de TableAdapter s es volver a configurar mediante el asistente, el generado automáticamente `INSERT`, `UPDATE`, y `DELETE` se vuelven a crear instrucciones.</span><span class="sxs-lookup"><span data-stu-id="fa631-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="fa631-164">Esto significa que todas las personalizaciones se realizan más adelante se perderían si de había hecho en el TableAdapter, ha elegido configurar en el menú contextual y completar al Asistente para nuevo.</span><span class="sxs-lookup"><span data-stu-id="fa631-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="fa631-165">La fragilidad de las operaciones de asignación TableAdapter generadas automáticamente `INSERT`, `UPDATE`, y `DELETE` instrucciones es, Afortunadamente, limitada a instrucciones SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="fa631-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="fa631-166">Si el TableAdapter utiliza los procedimientos almacenados, puede personalizar el `SelectCommand`, `InsertCommand`, `UpdateCommand`, o `DeleteCommand` procedimientos almacenados y vuelva a ejecutar el Asistente para configuración de TableAdapter sin necesidad de miedo que será los procedimientos almacenados puede modificar.</span><span class="sxs-lookup"><span data-stu-id="fa631-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="fa631-167">En los próximos varios pasos que se creará un TableAdapter que, inicialmente, utiliza una consulta principal que omite cualquier `JOIN` s para que el correspondiente a insertar, actualizar y procedimientos almacenados de eliminación será generado automáticamente.</span><span class="sxs-lookup"><span data-stu-id="fa631-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="fa631-168">A continuación, actualizaremos la `SelectCommand` hasta que se usa un `JOIN` que devuelve más columnas de las tablas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="fa631-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="fa631-169">Por último, crearemos una clase correspondiente de la capa de lógica empresarial y muestran cómo utilizar el TableAdapter en una página web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="fa631-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="fa631-170">Paso 1: Creación de TableAdapter mediante una consulta principal simplificada</span><span class="sxs-lookup"><span data-stu-id="fa631-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="fa631-171">En este tutorial se agregará a un TableAdapter y DataTable fuertemente tipados para la `Employees` tabla el `NorthwindWithSprocs` conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="fa631-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="fa631-172">El `Employees` tabla contiene un `ReportsTo` campo que especifica el `EmployeeID` del Administrador de empleado s.</span><span class="sxs-lookup"><span data-stu-id="fa631-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="fa631-173">Por ejemplo, los empleados Anne Dodsworth tiene un `ReportTo` valor de 5, que es el `EmployeeID` de Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="fa631-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="fa631-174">Por lo tanto, Anne informa a Steven, su administrador.</span><span class="sxs-lookup"><span data-stu-id="fa631-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="fa631-175">Junto con informes de cada empleado s `ReportsTo` valor, también deseamos recuperar el nombre de su jefe.</span><span class="sxs-lookup"><span data-stu-id="fa631-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="fa631-176">Esto puede realizarse mediante un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fa631-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="fa631-177">Pero al usar un `JOIN` al crear inicialmente el TableAdapter impide que el Asistente para generar automáticamente la inserción correspondiente, actualizar y eliminar las capacidades.</span><span class="sxs-lookup"><span data-stu-id="fa631-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="fa631-178">Por lo tanto, comenzaremos por crear un objeto TableAdapter cuya consulta principal no contiene ningún `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="fa631-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="fa631-179">A continuación, en el paso 2, actualizaremos el procedimiento almacenado la consulta principal para recuperar el nombre del administrador s a través de un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fa631-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="fa631-180">Comience abriendo la `NorthwindWithSprocs` conjunto de datos en el `~/App_Code/DAL` carpeta.</span><span class="sxs-lookup"><span data-stu-id="fa631-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="fa631-181">Haga doble clic en el diseñador, seleccione la opción Agregar en el menú contextual y elegir el elemento de menú de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fa631-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="fa631-182">Esto iniciará al Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fa631-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="fa631-183">Tal y como se muestra en la figura 5, que el asistente cree nuevos procedimientos almacenados y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="fa631-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="fa631-184">Para hacer un repaso sobre la creación de nuevos procedimientos almacenados desde el Asistente para la s de TableAdapter, consulte el [crear procedimientos almacenados nuevo para la s de conjunto de datos con tipo TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="fa631-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>


<span data-ttu-id="fa631-185">[![Seleccione los procedimientos almacenados nueva opción de crear](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span></span>

<span data-ttu-id="fa631-186">**Figura 5**: Seleccione Create new almacenados procedures (opción) ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span></span>


<span data-ttu-id="fa631-187">Use el siguiente `SELECT` instrucción para la consulta principal de TableAdapter s:</span><span class="sxs-lookup"><span data-stu-id="fa631-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample4.sql)]

<span data-ttu-id="fa631-188">Puesto que esta consulta no incluye ningún `JOIN` s, el Asistente de TableAdapter creará automáticamente los procedimientos almacenados con el correspondiente `INSERT`, `UPDATE`, y `DELETE` instrucciones, así como un procedimiento almacenado para ejecutar el método main consulta.</span><span class="sxs-lookup"><span data-stu-id="fa631-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="fa631-189">El siguiente paso nos permite nombrar los procedimientos almacenados de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fa631-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="fa631-190">Use los nombres `Employees_Select`, `Employees_Insert`, `Employees_Update`, y `Employees_Delete`, como se muestra en la figura 6.</span><span class="sxs-lookup"><span data-stu-id="fa631-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="fa631-191">[![Nombre de los procedimientos almacenados de TableAdapter](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span></span>

<span data-ttu-id="fa631-192">**Figura 6**: Nombre de los procedimientos almacenados de TableAdapter s ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span></span>


<span data-ttu-id="fa631-193">El último paso nos pedirá un nombre de los métodos de TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="fa631-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="fa631-194">Use `Fill` y `GetEmployees` como los nombres de método.</span><span class="sxs-lookup"><span data-stu-id="fa631-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="fa631-195">Además, asegúrese de dejar el crear métodos para enviar actualizaciones directamente a la casilla de la base de datos (GenerateDBDirectMethods) activada.</span><span class="sxs-lookup"><span data-stu-id="fa631-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="fa631-196">[![Nombre del relleno de los métodos de TableAdapter s y GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span></span>

<span data-ttu-id="fa631-197">**Figura 7**: Nombre de los métodos de TableAdapter s `Fill` y `GetEmployees` ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span></span>


<span data-ttu-id="fa631-198">Después de completar al asistente, dedique un momento a examinar los procedimientos almacenados en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="fa631-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="fa631-199">Debería ver cuatro nuevas: `Employees_Select`, `Employees_Insert`, `Employees_Update`, y `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="fa631-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="fa631-200">A continuación, inspeccione el `EmployeesDataTable` y `EmployeesTableAdapter` acaba de crear.</span><span class="sxs-lookup"><span data-stu-id="fa631-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="fa631-201">La tabla de datos contiene una columna para cada campo devuelto por la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="fa631-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="fa631-202">Haga clic en el TableAdapter y, a continuación, vaya a la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="fa631-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="fa631-203">Allí verá el `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades están configuradas correctamente para llamar a los procedimientos almacenados correspondientes.</span><span class="sxs-lookup"><span data-stu-id="fa631-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="fa631-204">[![El TableAdapter incluye Insertar, actualizar y eliminar las capacidades](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span></span>

<span data-ttu-id="fa631-205">**Figura 8**: El TableAdapter incluye Insert, Update y eliminar capacidades ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span></span>


<span data-ttu-id="fa631-206">Al insertar, actualizar y eliminar procedimientos almacenados que se crean automáticamente y la `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades configuradas correctamente, estamos preparados para personalizar el `SelectCommand` s procedimiento almacenado para devolver adicionales información acerca de cada empleado s Administrador.</span><span class="sxs-lookup"><span data-stu-id="fa631-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="fa631-207">En concreto, deberá actualizar el `Employees_Select` procedimiento almacenado para usar un `JOIN` y devolver el Administrador de s `FirstName` y `LastName` valores.</span><span class="sxs-lookup"><span data-stu-id="fa631-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="fa631-208">Después de que se ha actualizado el procedimiento almacenado, necesitamos actualizar la tabla de datos para que incluya estas columnas adicionales.</span><span class="sxs-lookup"><span data-stu-id="fa631-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="fa631-209">Trataremos estas dos tareas en los pasos 2 y 3.</span><span class="sxs-lookup"><span data-stu-id="fa631-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="fa631-210">Paso 2: Personalizar el procedimiento almacenado para incluir un`JOIN`</span><span class="sxs-lookup"><span data-stu-id="fa631-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="fa631-211">Empiece por ir en el Explorador de servidores, profundizar en la carpeta de procedimientos almacenados de s de la base de datos Northwind y abrir el `Employees_Select` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="fa631-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="fa631-212">Si no ve este procedimiento almacenado, haga doble clic en la carpeta procedimientos almacenados y elija actualizar.</span><span class="sxs-lookup"><span data-stu-id="fa631-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="fa631-213">Actualizar el procedimiento almacenado para que utilice un `LEFT JOIN` para devolver el Administrador de s primero el nombre y apellido:</span><span class="sxs-lookup"><span data-stu-id="fa631-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample5.sql)]

<span data-ttu-id="fa631-214">Después de actualizar el `SELECT` instrucción, guarde los cambios, vaya al menú archivo y elegir guardar `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="fa631-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="fa631-215">Como alternativa, puede haga clic en el icono Guardar en la barra de herramientas o presione CTRL+s.</span><span class="sxs-lookup"><span data-stu-id="fa631-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="fa631-216">Después de guardar los cambios, haga doble clic en el `Employees_Select` procedimiento almacenado en el Explorador de servidores y elija ejecutar.</span><span class="sxs-lookup"><span data-stu-id="fa631-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="fa631-217">Esto ejecutará el procedimiento almacenado y mostrar sus resultados en la ventana de salida (consulte la figura 9).</span><span class="sxs-lookup"><span data-stu-id="fa631-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="fa631-218">[![Los resultados de los procedimientos almacenados se muestran en la ventana de salida](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span></span>

<span data-ttu-id="fa631-219">**Figura 9**: Los resultados de los procedimientos almacenados se muestran en la ventana de salida ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="fa631-220">Paso 3: Actualizando las columnas de DataTable s</span><span class="sxs-lookup"><span data-stu-id="fa631-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="fa631-221">En este momento, el `Employees_Select` procedimiento almacenado devuelve `ManagerFirstName` y `ManagerLastName` valores, pero la `EmployeesDataTable` no tiene estas columnas.</span><span class="sxs-lookup"><span data-stu-id="fa631-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="fa631-222">Estas columnas que faltan pueden agregarse a la DataTable de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="fa631-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="fa631-223">**Manualmente** : haga doble clic en la DataTable en el Diseñador de DataSet y, en el menú Agregar, elija la columna.</span><span class="sxs-lookup"><span data-stu-id="fa631-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="fa631-224">Puede, a continuación, la columna de nombre y establezca sus propiedades según corresponda.</span><span class="sxs-lookup"><span data-stu-id="fa631-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="fa631-225">**Automáticamente** -el Asistente para configuración de TableAdapter actualizará las columnas de DataTable s para reflejar los campos devueltos por la `SelectCommand` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="fa631-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="fa631-226">Al usar instrucciones SQL ad hoc, el asistente también quitará el `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades desde el `SelectCommand` contiene ahora un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="fa631-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="fa631-227">Pero cuando se utilizan procedimientos almacenados, estas propiedades de comando permanecen intactas.</span><span class="sxs-lookup"><span data-stu-id="fa631-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="fa631-228">Agregar manualmente las columnas de DataTable se han analizado en los tutoriales anteriores, incluidos [maestro/detalle con una lista con viñetas de registros maestros con un control DataList de detalles](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) y [cargar archivos](../working-with-binary-files/uploading-files-cs.md), y le enviaremos Examine este proceso nuevo con más detalle en nuestro tutorial siguiente.</span><span class="sxs-lookup"><span data-stu-id="fa631-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) and [Uploading Files](../working-with-binary-files/uploading-files-cs.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="fa631-229">Para este tutorial, sin embargo, permiten s usar el enfoque automático mediante el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fa631-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="fa631-230">Iniciar con el botón secundario en el `EmployeesTableAdapter` y seleccione Configurar en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="fa631-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="fa631-231">Se abrirá el Asistente para configuración de TableAdapter, que enumera los procedimientos almacenados utilizados para seleccionar, insertar, actualizar y eliminar, junto con sus valores devueltos y parámetros (si existe).</span><span class="sxs-lookup"><span data-stu-id="fa631-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="fa631-232">Figura 10 muestra a este asistente.</span><span class="sxs-lookup"><span data-stu-id="fa631-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="fa631-233">Aquí podemos ver que el `Employees_Select` procedimiento almacenado ahora devuelve el `ManagerFirstName` y `ManagerLastName` campos.</span><span class="sxs-lookup"><span data-stu-id="fa631-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="fa631-234">[![Se muestra en el Asistente para la lista de columnas actualizadas para el Employees_Select de procedimiento almacenado](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span></span>

<span data-ttu-id="fa631-235">**Figura 10**: El asistente muestra la lista de columnas actualizado para el `Employees_Select` Stored Procedure ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span></span>


<span data-ttu-id="fa631-236">Complete el asistente, haga clic en Finalizar.</span><span class="sxs-lookup"><span data-stu-id="fa631-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="fa631-237">Al volver al diseñador de DataSet, el `EmployeesDataTable` incluye dos columnas adicionales: `ManagerFirstName` y `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="fa631-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="fa631-238">[![El EmployeesDataTable contiene dos nuevas columnas](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span></span>

<span data-ttu-id="fa631-239">**Figura 11**: El `EmployeesDataTable` contiene dos nuevas columnas ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span></span>


<span data-ttu-id="fa631-240">Para ilustrar que la actualización `Employees_Select` procedimiento almacenado está activo y que la inserción, actualizar y eliminar las capacidades del TableAdapter siguen siendo funcionales, permiten s crear una página web que permite a los usuarios ver y eliminar los empleados.</span><span class="sxs-lookup"><span data-stu-id="fa631-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="fa631-241">Antes de crear una página, sin embargo, debemos crear una nueva clase primero en la capa de lógica empresarial para trabajar con los empleados de la `NorthwindWithSprocs` conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="fa631-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="fa631-242">En el paso 4, se creará un `EmployeesBLLWithSprocs` clase.</span><span class="sxs-lookup"><span data-stu-id="fa631-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="fa631-243">En el paso 5, usamos esta clase desde una página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="fa631-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="fa631-244">Paso 4: Implementación de la capa de lógica de negocios</span><span class="sxs-lookup"><span data-stu-id="fa631-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="fa631-245">Cree un nuevo archivo de clase en el `~/App_Code/BLL` carpeta denominada `EmployeesBLLWithSprocs.cs`.</span><span class="sxs-lookup"><span data-stu-id="fa631-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.cs`.</span></span> <span data-ttu-id="fa631-246">Esta clase imita la semántica de las existentes `EmployeesBLL` (clase), solo esta nueva uno proporciona menos métodos y usa el `NorthwindWithSprocs` conjunto de datos (en lugar de la `Northwind` conjunto de datos).</span><span class="sxs-lookup"><span data-stu-id="fa631-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="fa631-247">Agregue el código siguiente a la clase `EmployeesBLLWithSprocs` .</span><span class="sxs-lookup"><span data-stu-id="fa631-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-csharp[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample6.cs)]

<span data-ttu-id="fa631-248">El `EmployeesBLLWithSprocs` clase s `Adapter` propiedad devuelve una instancia de la `NorthwindWithSprocs` s de conjunto de datos `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="fa631-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="fa631-249">Esto se usa la clase s `GetEmployees` y `DeleteEmployee` métodos.</span><span class="sxs-lookup"><span data-stu-id="fa631-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="fa631-250">El `GetEmployees` llamadas al método el `EmployeesTableAdapter` s correspondiente `GetEmployees` método, que invoca la `Employees_Select` procedimiento almacenado y rellena los resultados en un `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="fa631-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="fa631-251">El `DeleteEmployee` llama de forma similar a método la `EmployeesTableAdapter` s `Delete` método, que invoca la `Employees_Delete` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="fa631-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="fa631-252">Paso 5: Trabajar con los datos de la capa de presentación</span><span class="sxs-lookup"><span data-stu-id="fa631-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="fa631-253">Con el `EmployeesBLLWithSprocs` clase completa, que está listo para trabajar con datos de empleados a través de una página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="fa631-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="fa631-254">Abra el `JOINs.aspx` página en el `AdvancedDAL` carpeta y arrastre un control GridView del cuadro de herramientas hasta el diseñador, establecer su `ID` propiedad a `Employees`.</span><span class="sxs-lookup"><span data-stu-id="fa631-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="fa631-255">A continuación, en la etiqueta inteligente s GridView, enlazar la cuadrícula para un nuevo control ObjectDataSource denominado `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="fa631-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="fa631-256">Configurar el origen ObjectDataSource para usar el `EmployeesBLLWithSprocs` clase y, desde las pestañas de seleccionar y eliminar, asegúrese de que el `GetEmployees` y `DeleteEmployee` se seleccionan los métodos de las listas desplegables.</span><span class="sxs-lookup"><span data-stu-id="fa631-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="fa631-257">Haga clic en Finalizar para completar la configuración ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="fa631-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="fa631-258">[![Configurar el origen ObjectDataSource para usar la clase EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span></span>

<span data-ttu-id="fa631-259">**Figura 12**: Configurar el origen ObjectDataSource que se usarán el `EmployeesBLLWithSprocs` clase ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span></span>


<span data-ttu-id="fa631-260">[![Tiene el uso de ObjectDataSource los métodos de DeleteEmployee y GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span></span>

<span data-ttu-id="fa631-261">**Figura 13**: Usar ObjectDataSource el `GetEmployees` y `DeleteEmployee` métodos ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span></span>


<span data-ttu-id="fa631-262">Visual Studio agregará BoundField en GridView para cada uno de los `EmployeesDataTable` columnas s.</span><span class="sxs-lookup"><span data-stu-id="fa631-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="fa631-263">Quitar todos estos BoundFields excepto `Title`, `LastName`, `FirstName`, `ManagerFirstName`, y `ManagerLastName` y cambiar el nombre de la `HeaderText` las propiedades de los cuatro últimos BoundFields apellido, nombre, nombre Manager s, y Administrador de s Last Name, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="fa631-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="fa631-264">Para permitir a los usuarios eliminar a empleados desde esta página, necesitamos hacer dos cosas.</span><span class="sxs-lookup"><span data-stu-id="fa631-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="fa631-265">En primer lugar, indique a GridView para proporcionar capacidades de eliminación activando la opción Habilitar eliminación desde su etiqueta inteligente.</span><span class="sxs-lookup"><span data-stu-id="fa631-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="fa631-266">En segundo lugar, cambie la s ObjectDataSource `OldValuesParameterFormatString` propiedad del valor establecido por el ObjectDataSource wizard (`original_{0}`) en su valor predeterminado (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="fa631-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="fa631-267">Después de realizar estos cambios, el marcado declarativo de s GridView y ObjectDataSource debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="fa631-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample7.aspx)]

<span data-ttu-id="fa631-268">Pruebe la página visitando a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="fa631-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="fa631-269">Como se muestra en la figura 14, mostrará la página de cada empleado y su propio nombre s manager (suponiendo que tengan uno).</span><span class="sxs-lookup"><span data-stu-id="fa631-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="fa631-270">[![La combinación en el Employees_Select procedimiento almacenado devuelve el nombre del administrador s](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span></span>

<span data-ttu-id="fa631-271">**Figura 14**: El `JOIN` en el `Employees_Select` procedimiento almacenado devuelve el Administrador de s nombre ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span></span>


<span data-ttu-id="fa631-272">Al hacer clic en el botón Eliminar se inicia el flujo de trabajo eliminando que culmina en la ejecución de la `Employees_Delete` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="fa631-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="fa631-273">Sin embargo, el intento `DELETE` instrucción en el procedimiento almacenado produce un error debido a una infracción de restricción de clave externa (consulte la figura 15).</span><span class="sxs-lookup"><span data-stu-id="fa631-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="fa631-274">En concreto, cada empleado tiene uno o más registros el `Orders` tabla, provocando la eliminación de un error.</span><span class="sxs-lookup"><span data-stu-id="fa631-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="fa631-275">[![Eliminación de un empleado que tiene resultados pedidos correspondientes a una infracción de restricción de clave externa](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="fa631-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span></span>

<span data-ttu-id="fa631-276">**Figura 15**: Eliminación de un empleado que tiene resultados pedidos correspondientes a una infracción de restricción de clave externa ([haga clic aquí para ver imagen en tamaño completo](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="fa631-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span></span>


<span data-ttu-id="fa631-277">Para permitir que un empleado elimina, puede:</span><span class="sxs-lookup"><span data-stu-id="fa631-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="fa631-278">Actualización de la restricción de clave externa en cascada eliminaciones,</span><span class="sxs-lookup"><span data-stu-id="fa631-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="fa631-279">Elimine manualmente los registros desde el `Orders` tabla para los empleados que desea eliminar, o</span><span class="sxs-lookup"><span data-stu-id="fa631-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="fa631-280">Actualización de la `Employees_Delete` procedimiento almacenado para eliminar los registros relacionados de la `Orders` tabla antes de eliminar el `Employees` registro.</span><span class="sxs-lookup"><span data-stu-id="fa631-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="fa631-281">Analizamos esta técnica en el [utilizando procedimientos almacenados existentes para la s de conjunto de datos con tipo TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="fa631-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="fa631-282">Dejar como un ejercicio para el lector.</span><span class="sxs-lookup"><span data-stu-id="fa631-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="fa631-283">Resumen</span><span class="sxs-lookup"><span data-stu-id="fa631-283">Summary</span></span>

<span data-ttu-id="fa631-284">Cuando se trabaja con bases de datos relacionales, es habitual que las consultas extraer los datos de varias tablas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="fa631-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="fa631-285">Subconsultas correlacionadas y `JOIN` proporcionan dos técnicas distintas para tener acceso a datos de las tablas relacionadas en una consulta.</span><span class="sxs-lookup"><span data-stu-id="fa631-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="fa631-286">En tutoriales anteriores se realizan con más frecuencia usan de subconsultas correlacionadas porque el TableAdapter no Autogenerar `INSERT`, `UPDATE`, y `DELETE` instrucciones para las consultas que implican `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="fa631-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="fa631-287">Aunque estos valores se pueden proporcionar manualmente, al usar instrucciones SQL ad hoc se sobrescribirán las personalizaciones cuando se complete el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fa631-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="fa631-288">Afortunadamente, los TableAdapters creados mediante los procedimientos almacenados no sufren la fragilidad misma como los creados mediante instrucciones SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="fa631-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="fa631-289">Por lo tanto, es posible crear un TableAdapter cuya consulta principal utiliza un `JOIN` al utilizar procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="fa631-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="fa631-290">En este tutorial hemos visto cómo crear este tipo de un TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="fa631-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="fa631-291">Se inició mediante un `JOIN`-menos `SELECT` de consulta para la consulta principal de TableAdapter s para que el correspondiente insert, update y procedimientos almacenados de eliminación sería creado automáticamente.</span><span class="sxs-lookup"><span data-stu-id="fa631-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="fa631-292">TableAdapter s inicial haya completado la configuración, hemos ampliado la `SelectCommand` procedimiento almacenado para usar un `JOIN` y volver a ejecutar el Asistente de configuración de TableAdapter para actualizar el `EmployeesDataTable` columnas s.</span><span class="sxs-lookup"><span data-stu-id="fa631-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="fa631-293">Volver a ejecutar el Asistente de configuración de TableAdapter actualizado automáticamente el `EmployeesDataTable` columnas para reflejar los campos de datos devueltos por la `Employees_Select` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="fa631-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="fa631-294">Como alternativa, podríamos haber agregamos estas columnas manualmente a la DataTable.</span><span class="sxs-lookup"><span data-stu-id="fa631-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="fa631-295">Exploraremos manualmente agrega columnas a la DataTable en el siguiente tutorial.</span><span class="sxs-lookup"><span data-stu-id="fa631-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="fa631-296">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="fa631-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="fa631-297">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="fa631-297">About the Author</span></span>

<span data-ttu-id="fa631-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), trabaja con tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="fa631-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="fa631-299">Scott trabaja como consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="fa631-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="fa631-300">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="fa631-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="fa631-301">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fa631-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="fa631-302">o a través de su blog, que puede encontrarse en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="fa631-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="fa631-303">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="fa631-303">Special Thanks To</span></span>

<span data-ttu-id="fa631-304">Esta serie de tutoriales ha sido revisada por muchos revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="fa631-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="fa631-305">Los revisores para este tutorial fueron Teresa Murphy, David Suru y Hilton Geisenow.</span><span class="sxs-lookup"><span data-stu-id="fa631-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="fa631-306">¿Está interesado en leer mi próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="fa631-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="fa631-307">Si es así, envíeme una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="fa631-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="fa631-308">[Anterior](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [Siguiente](adding-additional-datatable-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="fa631-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](adding-additional-datatable-columns-cs.md)</span></span>

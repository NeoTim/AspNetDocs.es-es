---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
title: Trabajar con columnas calculadas (VB) | Microsoft Docs
author: rick-anderson
description: Al crear una tabla de base de datos, Microsoft SQL Server permite definir una columna calculada cuyo valor se calcula a partir de una expresión que normalmente hace referencia a...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 5811b8ff-ed56-40fc-9397-6b69ae09a8f6
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: e425d7363c2cdea6efb0ba51f3fc2b6a5330bf2a
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2019
ms.locfileid: "74603125"
---
# <a name="working-with-computed-columns-vb"></a><span data-ttu-id="d90f3-103">Trabajar con columnas calculadas (VB)</span><span class="sxs-lookup"><span data-stu-id="d90f3-103">Working with Computed Columns (VB)</span></span>

<span data-ttu-id="d90f3-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d90f3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d90f3-105">[Descargar código](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) o [Descargar PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d90f3-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) or [Download PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span></span>

> <span data-ttu-id="d90f3-106">Al crear una tabla de base de datos, Microsoft SQL Server permite definir una columna calculada cuyo valor se calcula a partir de una expresión que normalmente hace referencia a otros valores del mismo registro de base de datos.</span><span class="sxs-lookup"><span data-stu-id="d90f3-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="d90f3-107">Estos valores son de solo lectura en la base de datos, lo que requiere consideraciones especiales al trabajar con TableAdapters.</span><span class="sxs-lookup"><span data-stu-id="d90f3-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="d90f3-108">En este tutorial, aprenderá a cumplir los desafíos planteados por las columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="d90f3-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="d90f3-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="d90f3-109">Introduction</span></span>

<span data-ttu-id="d90f3-110">Microsoft SQL Server permite *[columnas calculadas](https://msdn.microsoft.com/library/ms191250.aspx)* , que son columnas cuyos valores se calculan a partir de una expresión que normalmente hace referencia a los valores de otras columnas de la misma tabla.</span><span class="sxs-lookup"><span data-stu-id="d90f3-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="d90f3-111">Por ejemplo, un modelo de datos de seguimiento de tiempo puede tener una tabla denominada `ServiceLog` con columnas que incluyen `ServicePerformed`, `EmployeeID`, `Rate`y `Duration`, entre otros.</span><span class="sxs-lookup"><span data-stu-id="d90f3-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="d90f3-112">Mientras que la cantidad debida por elemento de servicio (que se multiplica por el número de la duración) puede calcularse a través de una página web o de otra interfaz de programación, puede resultar útil incluir una columna en la tabla de `ServiceLog` denominada `AmountDue` que ha comunicado esta información.</span><span class="sxs-lookup"><span data-stu-id="d90f3-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="d90f3-113">Esta columna se puede crear como una columna normal, pero debe actualizarse en cualquier momento en que cambien los valores de las columnas `Rate` o `Duration`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="d90f3-114">Un mejor enfoque sería convertir la columna de `AmountDue` en una columna calculada mediante el `Rate * Duration`de expresión.</span><span class="sxs-lookup"><span data-stu-id="d90f3-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="d90f3-115">Si lo hace, SQL Server calcular automáticamente el valor de la columna `AmountDue` cada vez que se hace referencia a él en una consulta.</span><span class="sxs-lookup"><span data-stu-id="d90f3-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="d90f3-116">Dado que el valor de una columna calculada está determinado por una expresión, estas columnas son de solo lectura y, por lo tanto, no pueden tener valores asignados en `INSERT` o `UPDATE` instrucciones.</span><span class="sxs-lookup"><span data-stu-id="d90f3-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="d90f3-117">Sin embargo, cuando las columnas calculadas forman parte de la consulta principal para un TableAdapter que usa instrucciones SQL ad hoc, se incluyen automáticamente en las instrucciones de `UPDATE` y `INSERT` generadas automáticamente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="d90f3-118">Por consiguiente, las consultas `INSERT` y `UPDATE` de TableAdapter s y las propiedades `InsertCommand` y `UpdateCommand` deben actualizarse para quitar las referencias a las columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="d90f3-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="d90f3-119">Un desafío del uso de las columnas calculadas con un TableAdapter que usa instrucciones SQL ad hoc es que las consultas de TableAdapter s `INSERT` y `UPDATE` se vuelven a generar automáticamente cada vez que se completa el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="d90f3-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="d90f3-120">Por lo tanto, las columnas calculadas quitadas manualmente de las consultas `INSERT` y `UPDATE` volverán a aparecer si se vuelve a ejecutar el asistente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="d90f3-121">Aunque los TableAdapters que usan procedimientos almacenados no sufren esta fragilidad, tienen sus propias peculiaridades que abordaremos en el paso 3.</span><span class="sxs-lookup"><span data-stu-id="d90f3-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="d90f3-122">En este tutorial se agregará una columna calculada a la tabla `Suppliers` de la base de datos Northwind y, a continuación, se creará el TableAdapter correspondiente para trabajar con esta tabla y su columna calculada.</span><span class="sxs-lookup"><span data-stu-id="d90f3-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="d90f3-123">El TableAdapter utilizará procedimientos almacenados en lugar de instrucciones SQL ad hoc para que las personalizaciones no se pierdan cuando se use el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="d90f3-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="d90f3-124">Vamos a empezar a trabajar.</span><span class="sxs-lookup"><span data-stu-id="d90f3-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="d90f3-125">Paso 1: agregar una columna calculada a la tabla`Suppliers`</span><span class="sxs-lookup"><span data-stu-id="d90f3-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="d90f3-126">La base de datos Northwind no tiene ninguna columna calculada, por lo que tendremos que agregar una.</span><span class="sxs-lookup"><span data-stu-id="d90f3-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="d90f3-127">En este tutorial, vamos a agregar una columna calculada a la tabla `Suppliers` denominada `FullContactName` que devuelve el nombre de contacto, el título y la empresa para la que trabajan en el siguiente formato: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="d90f3-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="d90f3-128">Esta columna calculada se puede utilizar en los informes cuando se muestra información acerca de los proveedores.</span><span class="sxs-lookup"><span data-stu-id="d90f3-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="d90f3-129">Para empezar, abra la definición de la tabla `Suppliers` haciendo clic con el botón secundario en la tabla de `Suppliers` de la Explorador de servidores y elija Abrir definición de tabla en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="d90f3-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="d90f3-130">Se mostrarán las columnas de la tabla y sus propiedades, como su tipo de datos, si permiten `NULL` s, etc.</span><span class="sxs-lookup"><span data-stu-id="d90f3-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="d90f3-131">Para agregar una columna calculada, empiece por escribir el nombre de la columna en la definición de la tabla.</span><span class="sxs-lookup"><span data-stu-id="d90f3-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="d90f3-132">A continuación, escriba su expresión en el cuadro de texto (fórmula) bajo la sección especificación de la columna calculada en la columna ventana Propiedades (vea la ilustración 1).</span><span class="sxs-lookup"><span data-stu-id="d90f3-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="d90f3-133">Asigne a la columna calculada el nombre `FullContactName` y utilice la siguiente expresión:</span><span class="sxs-lookup"><span data-stu-id="d90f3-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample1.sql)]

<span data-ttu-id="d90f3-134">Tenga en cuenta que las cadenas se pueden concatenar en SQL mediante el operador `+`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="d90f3-135">La instrucción `CASE` se puede usar como un condicional en un lenguaje de programación tradicional.</span><span class="sxs-lookup"><span data-stu-id="d90f3-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="d90f3-136">En la expresión anterior, la instrucción `CASE` se puede leer como: si `ContactTitle` no `NULL` a continuación, se genera el valor de `ContactTitle` concatenado con una coma, de lo contrario no se emite nada.</span><span class="sxs-lookup"><span data-stu-id="d90f3-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="d90f3-137">Para obtener más información sobre la utilidad de la instrucción `CASE`, vea [la eficacia de las instrucciones SQL `CASE`](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="d90f3-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="d90f3-138">En lugar de usar una instrucción `CASE` aquí, podríamos haber usado de forma alternativa `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="d90f3-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) devuelve *checkExpression* si no es null; en caso contrario, devuelve *replacementValue*.</span><span class="sxs-lookup"><span data-stu-id="d90f3-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="d90f3-140">Aunque `ISNULL` o `CASE` funcionarán en esta instancia, hay escenarios más complejos en los que la flexibilidad de la instrucción `CASE` no puede coincidir con `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="d90f3-141">Después de agregar esta columna calculada, la pantalla debe ser similar a la captura de pantalla de la ilustración 1.</span><span class="sxs-lookup"><span data-stu-id="d90f3-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="d90f3-142">[![agregar una columna calculada denominada FullContactName a la tabla Suppliers](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="d90f3-143">**Figura 1**: agregar una columna calculada denominada `FullContactName` a la tabla `Suppliers` ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="d90f3-144">Después de asignar un nombre a la columna calculada y escribir su expresión, guarde los cambios en la tabla haciendo clic en el icono guardar en la barra de herramientas; para ello, presione Ctrl + S o vaya al menú Archivo y elija guardar `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="d90f3-145">Al guardar la tabla, se debe actualizar el Explorador de servidores, incluida la columna recién agregada de la lista de columnas de la tabla `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="d90f3-146">Además, la expresión especificada en el cuadro de texto (fórmula) se ajustará automáticamente a una expresión equivalente que elimine los espacios en blanco innecesarios, rodea los nombres de columna entre corchetes (`[]`) e incluye paréntesis para mostrar más explícitamente el orden de las operaciones:</span><span class="sxs-lookup"><span data-stu-id="d90f3-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample2.sql)]

<span data-ttu-id="d90f3-147">Para obtener más información sobre las columnas calculadas en Microsoft SQL Server, consulte la [documentación técnica](https://msdn.microsoft.com/library/ms191250.aspx)de.</span><span class="sxs-lookup"><span data-stu-id="d90f3-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="d90f3-148">Consulte también [Cómo: especificar columnas calculadas](https://msdn.microsoft.com/library/ms188300.aspx) para obtener un tutorial paso a paso sobre la creación de columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="d90f3-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="d90f3-149">De forma predeterminada, las columnas calculadas no se almacenan físicamente en la tabla, sino que se vuelven a calcular cada vez que se hace referencia a ellas en una consulta.</span><span class="sxs-lookup"><span data-stu-id="d90f3-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="d90f3-150">No obstante, si activa la casilla es persistente, puede indicar a SQL Server que almacene físicamente la columna calculada en la tabla.</span><span class="sxs-lookup"><span data-stu-id="d90f3-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="d90f3-151">Esto permite crear un índice en la columna calculada, lo que puede mejorar el rendimiento de las consultas que usan el valor de la columna calculada en sus cláusulas `WHERE`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="d90f3-152">Vea [crear índices en columnas calculadas](https://msdn.microsoft.com/library/ms189292.aspx) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="d90f3-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="d90f3-153">Paso 2: ver los valores de las columnas calculadas</span><span class="sxs-lookup"><span data-stu-id="d90f3-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="d90f3-154">Antes de empezar a trabajar en el nivel de acceso a datos, deje que se tarde un minuto en ver los valores de `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="d90f3-155">En el Explorador de servidores, haga clic con el botón derecho en el nombre de la tabla `Suppliers` y elija nueva consulta en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="d90f3-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="d90f3-156">Se abrirá una ventana de consulta que le pide que elija las tablas que desea incluir en la consulta.</span><span class="sxs-lookup"><span data-stu-id="d90f3-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="d90f3-157">Agregue el `Suppliers` tabla y haga clic en cerrar.</span><span class="sxs-lookup"><span data-stu-id="d90f3-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="d90f3-158">A continuación, compruebe las columnas `CompanyName`, `ContactName`, `ContactTitle`y `FullContactName` de la tabla proveedores.</span><span class="sxs-lookup"><span data-stu-id="d90f3-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="d90f3-159">Por último, haga clic en el icono de signo de exclamación rojo en la barra de herramientas para ejecutar la consulta y ver los resultados.</span><span class="sxs-lookup"><span data-stu-id="d90f3-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="d90f3-160">Como se muestra en la figura 2, los resultados incluyen `FullContactName`, que enumera las columnas `CompanyName`, `ContactName`y `ContactTitle` con el formato `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="d90f3-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="d90f3-161">[![FullContactName usa el formato ContactName (del que se va a usar, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="d90f3-162">**Figura 2**: el `FullContactName` usa el formato `ContactName` (`ContactTitle`, `CompanyName`) ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-vb/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="d90f3-163">Paso 3: agregar el`SuppliersTableAdapter`a la capa de acceso a datos</span><span class="sxs-lookup"><span data-stu-id="d90f3-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="d90f3-164">Para trabajar con la información del proveedor en nuestra aplicación, es necesario crear primero un TableAdapter y DataTable en la capa DAL.</span><span class="sxs-lookup"><span data-stu-id="d90f3-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="d90f3-165">Idealmente, esto se llevaría a cabo con los mismos pasos sencillos examinados en los tutoriales anteriores.</span><span class="sxs-lookup"><span data-stu-id="d90f3-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="d90f3-166">Sin embargo, trabajar con columnas calculadas presenta algunas arrugas que merecen la explicación.</span><span class="sxs-lookup"><span data-stu-id="d90f3-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="d90f3-167">Si utiliza un TableAdapter que usa instrucciones SQL ad hoc, puede incluir simplemente la columna calculada en la consulta principal de TableAdapter s a través del Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="d90f3-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="d90f3-168">Sin embargo, esto generará automáticamente `INSERT` y `UPDATE` instrucciones que incluyan la columna calculada.</span><span class="sxs-lookup"><span data-stu-id="d90f3-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="d90f3-169">Si intenta ejecutar uno de estos métodos, una `SqlException` con el mensaje la columna *columnName* no se puede modificar porque es una columna calculada o es el resultado de un operador Union.</span><span class="sxs-lookup"><span data-stu-id="d90f3-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="d90f3-170">Aunque la instrucción `INSERT` y `UPDATE` se puede ajustar manualmente mediante las propiedades `InsertCommand` y `UpdateCommand` de TableAdapter, se perderán estas personalizaciones cada vez que se vuelva a ejecutar el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="d90f3-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="d90f3-171">Debido a la fragilidad de los TableAdapters que usan instrucciones SQL ad hoc, se recomienda usar procedimientos almacenados al trabajar con columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="d90f3-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="d90f3-172">Si está utilizando procedimientos almacenados existentes, simplemente configure el TableAdapter como se describe en el tutorial [uso de procedimientos almacenados existentes para los TableAdapters del conjunto de](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) elementos con tipo.</span><span class="sxs-lookup"><span data-stu-id="d90f3-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="d90f3-173">Sin embargo, si el Asistente para TableAdapter crea los procedimientos almacenados, es importante omitir inicialmente las columnas calculadas de la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="d90f3-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="d90f3-174">Si incluye una columna calculada en la consulta principal, el Asistente para configuración de TableAdapter le informará de que, al finalizar, no podrá crear los procedimientos almacenados correspondientes.</span><span class="sxs-lookup"><span data-stu-id="d90f3-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="d90f3-175">En Resumen, es necesario configurar inicialmente el TableAdapter con una consulta principal sin columnas calculadas y, a continuación, actualizar manualmente el procedimiento almacenado correspondiente y el `SelectCommand` TableAdapter s para incluir la columna calculada.</span><span class="sxs-lookup"><span data-stu-id="d90f3-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="d90f3-176">Este enfoque es similar al que se usa en el tutorial [actualizar el TableAdapter para usar](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* .</span><span class="sxs-lookup"><span data-stu-id="d90f3-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="d90f3-177">En este tutorial, vamos a agregar un nuevo TableAdapter y hacer que cree automáticamente los procedimientos almacenados para nosotros.</span><span class="sxs-lookup"><span data-stu-id="d90f3-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="d90f3-178">Por lo tanto, es necesario omitir inicialmente la `FullContactName` columna calculada de la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="d90f3-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="d90f3-179">Para empezar, abra el conjunto de `NorthwindWithSprocs` en la carpeta `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="d90f3-180">Haga clic con el botón secundario en el diseñador y, en el menú contextual, elija Agregar un nuevo TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="d90f3-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="d90f3-181">Se iniciará el Asistente para la configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="d90f3-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="d90f3-182">Especifique la base de datos de la que se van a consultar los datos (`NORTHWNDConnectionString` de `Web.config`) y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="d90f3-183">Puesto que aún no hemos creado ningún procedimiento almacenado para consultar o modificar la tabla `Suppliers`, seleccione la opción crear nuevos procedimientos almacenados para que el asistente las cree para nosotros y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="d90f3-184">[![elegir la opción crear nuevos procedimientos almacenados](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="d90f3-185">**Figura 3**: elija la opción crear nuevos procedimientos almacenados ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="d90f3-186">El paso siguiente nos solicita la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="d90f3-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="d90f3-187">Escriba la siguiente consulta, que devuelve las columnas `SupplierID`, `CompanyName`, `ContactName`y `ContactTitle` de cada proveedor.</span><span class="sxs-lookup"><span data-stu-id="d90f3-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="d90f3-188">Tenga en cuenta que esta consulta omite intencionadamente la columna calculada (`FullContactName`); actualizaremos el procedimiento almacenado correspondiente para incluir esta columna en el paso 4.</span><span class="sxs-lookup"><span data-stu-id="d90f3-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample3.sql)]

<span data-ttu-id="d90f3-189">Después de escribir la consulta principal y hacer clic en siguiente, el asistente nos permite nombrar los cuatro procedimientos almacenados que generará.</span><span class="sxs-lookup"><span data-stu-id="d90f3-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="d90f3-190">Asigne a estos procedimientos almacenados el nombre `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`y `Suppliers_Delete`, como se muestra en la figura 4.</span><span class="sxs-lookup"><span data-stu-id="d90f3-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="d90f3-191">[![personalizar los nombres de los procedimientos almacenados generados automáticamente](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="d90f3-192">**Figura 4**: personalización de los nombres de los procedimientos almacenados generados automáticamente ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="d90f3-193">El siguiente paso del asistente nos permite asignar un nombre a los métodos de TableAdapter y especificar los patrones que se usan para obtener acceso a los datos y actualizarlos.</span><span class="sxs-lookup"><span data-stu-id="d90f3-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="d90f3-194">Deje activadas las tres casillas, pero cambie el nombre del método `GetData` a `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="d90f3-195">Haga clic en Finalizar para completar el asistente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="d90f3-196">[![cambiar el nombre del método GetData a GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="d90f3-197">**Figura 5**: cambiar el nombre del método `GetData` a `GetSuppliers` ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="d90f3-198">Al hacer clic en finalizar, el asistente creará los cuatro procedimientos almacenados y agregará el TableAdapter y el DataTable correspondiente al conjunto de DataSet con tipo.</span><span class="sxs-lookup"><span data-stu-id="d90f3-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="d90f3-199">Paso 4: incluir la columna calculada en la consulta principal de TableAdapter s</span><span class="sxs-lookup"><span data-stu-id="d90f3-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="d90f3-200">Ahora es necesario actualizar el TableAdapter y el DataTable creados en el paso 3 para incluir la `FullContactName` columna calculada.</span><span class="sxs-lookup"><span data-stu-id="d90f3-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="d90f3-201">Esto implica dos pasos:</span><span class="sxs-lookup"><span data-stu-id="d90f3-201">This involves two steps:</span></span>

1. <span data-ttu-id="d90f3-202">Actualizar el `Suppliers_Select` procedimiento almacenado para devolver el `FullContactName` columna calculada y</span><span class="sxs-lookup"><span data-stu-id="d90f3-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="d90f3-203">Actualizar DataTable para incluir una columna de `FullContactName` correspondiente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="d90f3-204">Para empezar, vaya a la Explorador de servidores y explore en profundidad la carpeta procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="d90f3-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="d90f3-205">Abra el `Suppliers_Select` procedimiento almacenado y actualice el `SELECT` consulta para incluir la `FullContactName` columna calculada:</span><span class="sxs-lookup"><span data-stu-id="d90f3-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample4.sql)]

<span data-ttu-id="d90f3-206">Guarde los cambios realizados en el procedimiento almacenado; para ello, haga clic en el icono guardar de la barra de herramientas, presione Ctrl + S o elija la opción Guardar `Suppliers_Select` en el menú archivo.</span><span class="sxs-lookup"><span data-stu-id="d90f3-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="d90f3-207">A continuación, vuelva al diseñador de DataSet, haga clic con el botón derecho en el `SuppliersTableAdapter`y elija configurar en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="d90f3-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="d90f3-208">Tenga en cuenta que la columna `Suppliers_Select` incluye ahora la columna `FullContactName` en su colección de columnas de datos.</span><span class="sxs-lookup"><span data-stu-id="d90f3-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="d90f3-209">[![ejecutar el Asistente para configuración de TableAdapter s para actualizar las columnas DataTable s](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="d90f3-210">**Figura 6**: ejecutar el Asistente para la configuración de TableAdapter s para actualizar las columnas DataTable s ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="d90f3-211">Haga clic en Finalizar para completar el asistente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="d90f3-212">Esto agregará automáticamente una columna correspondiente a la `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="d90f3-213">El Asistente para TableAdapter es lo suficientemente inteligente como para detectar que el `FullContactName` columna es una columna calculada y, por tanto, es de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="d90f3-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="d90f3-214">Por consiguiente, establece la propiedad Column s `ReadOnly` en `true`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="d90f3-215">Para comprobarlo, seleccione la columna en el `SuppliersDataTable` y, a continuación, vaya al ventana Propiedades (consulte la figura 7).</span><span class="sxs-lookup"><span data-stu-id="d90f3-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="d90f3-216">Tenga en cuenta que las propiedades `FullContactName` Column s `DataType` y `MaxLength` también se establecen como corresponda.</span><span class="sxs-lookup"><span data-stu-id="d90f3-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="d90f3-217">[![la columna FullContactName está marcada como de solo lectura](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span></span>

<span data-ttu-id="d90f3-218">**Figura 7**: el `FullContactName` columna está marcado como de solo lectura ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-vb/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="d90f3-219">Paso 5: agregar un método`GetSupplierBySupplierID`a TableAdapter</span><span class="sxs-lookup"><span data-stu-id="d90f3-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="d90f3-220">En este tutorial, se creará una página ASP.NET que muestra los proveedores en una cuadrícula actualizable.</span><span class="sxs-lookup"><span data-stu-id="d90f3-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="d90f3-221">En los tutoriales anteriores hemos actualizado un solo registro de la capa de lógica de negocios mediante la recuperación de ese registro concreto de la capa DAL como DataTable fuertemente tipada, la actualización de sus propiedades y, a continuación, el envío de la DataTable actualizada de nuevo a la capa DAL para propagar los cambios a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d90f3-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="d90f3-222">Para realizar este primer paso: recuperar el registro que se está actualizando desde la capa DAL, primero es necesario agregar un método `GetSupplierBySupplierID(supplierID)` a la capa DAL.</span><span class="sxs-lookup"><span data-stu-id="d90f3-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="d90f3-223">Haga clic con el botón derecho en el `SuppliersTableAdapter` en el diseño del conjunto de DataSet y elija la opción Agregar consulta en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="d90f3-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="d90f3-224">Como hicimos en el paso 3, deje que el asistente genere un nuevo procedimiento almacenado para nosotros seleccionando la opción Crear nuevo procedimiento almacenado (consulte la figura 3 para obtener una captura de pantalla de este paso del asistente).</span><span class="sxs-lookup"><span data-stu-id="d90f3-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="d90f3-225">Dado que este método devolverá un registro con varias columnas, indique que deseamos usar una consulta SQL que sea una selección que devuelva filas y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="d90f3-226">[![elegir la opción seleccionar qué devuelve filas](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span></span>

<span data-ttu-id="d90f3-227">**Figura 8**: elija la opción seleccionar qué devuelve las filas ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image24.png))</span></span>

<span data-ttu-id="d90f3-228">El paso siguiente nos solicita la consulta que se va a usar para este método.</span><span class="sxs-lookup"><span data-stu-id="d90f3-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="d90f3-229">Escriba lo siguiente, que devuelve los mismos campos de datos que la consulta principal, pero para un proveedor determinado.</span><span class="sxs-lookup"><span data-stu-id="d90f3-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample5.sql)]

<span data-ttu-id="d90f3-230">La siguiente pantalla nos pide asignar un nombre al procedimiento almacenado que se generará automáticamente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="d90f3-231">Asigne a este procedimiento almacenado el nombre `Suppliers_SelectBySupplierID` y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="d90f3-232">[![el nombre del procedimiento almacenado Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span></span>

<span data-ttu-id="d90f3-233">**Figura 9**: asigne un nombre al procedimiento almacenado `Suppliers_SelectBySupplierID` ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image27.png))</span></span>

<span data-ttu-id="d90f3-234">Por último, el asistente nos pide los patrones de acceso a datos y los nombres de método que se usarán para el TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="d90f3-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="d90f3-235">Deje activadas las dos casillas, pero cambie el nombre de los métodos `FillBy` y `GetDataBy` a `FillBySupplierID` y `GetSupplierBySupplierID`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="d90f3-236">[![el nombre de los métodos de TableAdapter FillBySupplierID y GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span></span>

<span data-ttu-id="d90f3-237">**Figura 10**: asigne un nombre a los métodos de TableAdapter `FillBySupplierID` y `GetSupplierBySupplierID` ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image30.png))</span></span>

<span data-ttu-id="d90f3-238">Haga clic en Finalizar para completar el asistente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="d90f3-239">Paso 6: crear el nivel de lógica de negocios</span><span class="sxs-lookup"><span data-stu-id="d90f3-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="d90f3-240">Antes de crear una página ASP.NET que usa la columna calculada creada en el paso 1, primero debemos agregar los métodos correspondientes en el BLL.</span><span class="sxs-lookup"><span data-stu-id="d90f3-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="d90f3-241">Nuestra página de ASP.NET, que crearemos en el paso 7, permitirá a los usuarios ver y editar proveedores.</span><span class="sxs-lookup"><span data-stu-id="d90f3-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="d90f3-242">Por lo tanto, necesitamos que el BLL proporcione, como mínimo, un método para obtener todos los proveedores y otro para actualizar un proveedor determinado.</span><span class="sxs-lookup"><span data-stu-id="d90f3-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="d90f3-243">Cree un nuevo archivo de clase denominado `SuppliersBLLWithSprocs` en la carpeta `~/App_Code/BLL` y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="d90f3-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-vb[Main](working-with-computed-columns-vb/samples/sample6.vb)]

<span data-ttu-id="d90f3-244">Al igual que las demás clases de BLL, `SuppliersBLLWithSprocs` tiene una propiedad `Protected` `Adapter` que devuelve una instancia de la clase `SuppliersTableAdapter` junto con dos métodos `Public`: `GetSuppliers` y `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `Protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `Public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="d90f3-245">El método `GetSuppliers` llama a y devuelve el `SuppliersDataTable` devuelto por el método `GetSupplier` correspondiente en la capa de acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="d90f3-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="d90f3-246">El método `UpdateSupplier` recupera información sobre el proveedor determinado que se está actualizando a través de una llamada al método de `GetSupplierBySupplierID(supplierID)` de DAL.</span><span class="sxs-lookup"><span data-stu-id="d90f3-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="d90f3-247">A continuación, actualiza las propiedades `CategoryName`, `ContactName`y `ContactTitle` y confirma estos cambios en la base de datos llamando al método Data Access Layer s `Update`, pasando el objeto `SuppliersRow` modificado.</span><span class="sxs-lookup"><span data-stu-id="d90f3-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="d90f3-248">A excepción de `SupplierID` y `CompanyName`, todas las columnas de la tabla Suppliers permiten valores `NULL`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="d90f3-249">Por lo tanto, si los parámetros pass-in `contactName` o `contactTitle` son `Nothing` es necesario establecer las propiedades `ContactName` y `ContactTitle` correspondientes en un valor de base de datos `NULL` mediante los métodos `SetContactNameNull` y `SetContactTitleNull`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `Nothing` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="d90f3-250">Paso 7: trabajar con la columna calculada desde el nivel de presentación</span><span class="sxs-lookup"><span data-stu-id="d90f3-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="d90f3-251">Con la columna calculada agregada a la tabla de `Suppliers` y la capa DAL y BLL actualizada en consecuencia, estamos preparados para compilar una página ASP.NET que funcione con la `FullContactName` columna calculada.</span><span class="sxs-lookup"><span data-stu-id="d90f3-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="d90f3-252">Comience abriendo la página `ComputedColumns.aspx` en la carpeta `AdvancedDAL` y arrastre un control GridView desde el cuadro de herramientas hasta el diseñador.</span><span class="sxs-lookup"><span data-stu-id="d90f3-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="d90f3-253">Establezca la propiedad GridView s `ID` en `Suppliers` y, desde su etiqueta inteligente, enlácelo a un nuevo ObjectDataSource denominado `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="d90f3-254">Configure el origen de datos para que use la clase `SuppliersBLLWithSprocs` que hemos agregado en el paso 6 y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="d90f3-255">[![configurar ObjectDataSource para usar la clase SuppliersBLLWithSprocs](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span></span>

<span data-ttu-id="d90f3-256">**Figura 11**: configuración de ObjectDataSource para usar la clase `SuppliersBLLWithSprocs` ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-vb/_static/image33.png))</span></span>

<span data-ttu-id="d90f3-257">Solo hay dos métodos definidos en la clase `SuppliersBLLWithSprocs`: `GetSuppliers` y `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="d90f3-258">Asegúrese de que estos dos métodos se especifican en las pestañas seleccionar y actualizar, respectivamente, y haga clic en finalizar para completar la configuración de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="d90f3-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="d90f3-259">Una vez finalizado el Asistente para la configuración de orígenes de datos, Visual Studio agregará BoundField para cada uno de los campos de datos devueltos.</span><span class="sxs-lookup"><span data-stu-id="d90f3-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="d90f3-260">Quite el `SupplierID` BoundField y cambie las propiedades `HeaderText` de los `CompanyName`, `ContactName`, `ContactTitle`y `FullContactName` BoundFields a Company, nombre de contacto, título y nombre de contacto completo, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="d90f3-261">En la etiqueta inteligente, active la casilla habilitar edición para activar las funciones de edición integradas de GridView.</span><span class="sxs-lookup"><span data-stu-id="d90f3-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="d90f3-262">Además de agregar BoundFields a GridView, la finalización del Asistente para orígenes de datos también hace que Visual Studio establezca la propiedad ObjectDataSource s `OldValuesParameterFormatString` en el {0}de\_original.</span><span class="sxs-lookup"><span data-stu-id="d90f3-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="d90f3-263">Vuelva a revertir esta configuración a su valor predeterminado, {0}.</span><span class="sxs-lookup"><span data-stu-id="d90f3-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="d90f3-264">Después de hacer estas modificaciones en GridView e ObjectDataSource, su marcado declarativo debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="d90f3-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-vb/samples/sample7.aspx)]

<span data-ttu-id="d90f3-265">A continuación, visite esta página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="d90f3-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="d90f3-266">Como se muestra en la figura 12, cada proveedor aparece en una cuadrícula que incluye el `FullContactName` columna, cuyo valor es simplemente la concatenación de las otras tres columnas con el formato `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="d90f3-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="d90f3-267">[![cada proveedor aparece en la cuadrícula](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span></span>

<span data-ttu-id="d90f3-268">**Figura 12**: cada proveedor aparece en la cuadrícula ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-vb/_static/image36.png))</span></span>

<span data-ttu-id="d90f3-269">Al hacer clic en el botón Editar de un proveedor determinado, se genera un postback y esa fila se representa en la interfaz de edición (vea la figura 13).</span><span class="sxs-lookup"><span data-stu-id="d90f3-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="d90f3-270">Las tres primeras columnas se representan en su interfaz de edición predeterminada: un control de cuadro de texto cuya propiedad `Text` está establecida en el valor del campo de datos.</span><span class="sxs-lookup"><span data-stu-id="d90f3-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="d90f3-271">Sin embargo, la columna `FullContactName` permanece como texto.</span><span class="sxs-lookup"><span data-stu-id="d90f3-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="d90f3-272">Cuando el BoundFields se agregó a GridView al finalizar el Asistente para la configuración de orígenes de datos, la propiedad `FullContactName` BoundField s `ReadOnly` se estableció en `True` porque la columna de `FullContactName` correspondiente del `SuppliersDataTable` tiene su propiedad `ReadOnly` establecida en `True`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `True` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `True`.</span></span> <span data-ttu-id="d90f3-273">Como se indicó en el paso 4, la propiedad `FullContactName` s `ReadOnly` se estableció en `True` porque el TableAdapter detectó que la columna era una columna calculada.</span><span class="sxs-lookup"><span data-stu-id="d90f3-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `True` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="d90f3-274">[![la columna FullContactName no es editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="d90f3-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span></span>

<span data-ttu-id="d90f3-275">**Figura 13**: la columna `FullContactName` no es editable ([haga clic para ver la imagen de tamaño completo](working-with-computed-columns-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="d90f3-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-vb/_static/image39.png))</span></span>

<span data-ttu-id="d90f3-276">Continúe y actualice el valor de una o varias columnas editables y haga clic en actualizar.</span><span class="sxs-lookup"><span data-stu-id="d90f3-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="d90f3-277">Observe cómo se actualiza automáticamente el valor de `FullContactName` s para reflejar el cambio.</span><span class="sxs-lookup"><span data-stu-id="d90f3-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="d90f3-278">GridView actualmente usa BoundFields para los campos modificables, lo que da lugar a la interfaz de edición predeterminada.</span><span class="sxs-lookup"><span data-stu-id="d90f3-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="d90f3-279">Dado que el campo `CompanyName` es obligatorio, debe convertirse en TemplateField que incluya un RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="d90f3-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="d90f3-280">Dejo esto como un ejercicio para el lector interesado.</span><span class="sxs-lookup"><span data-stu-id="d90f3-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="d90f3-281">Consulte el tutorial [Agregar controles de validación al editor de interfaces de edición e inserción](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) para obtener instrucciones paso a paso sobre cómo convertir un BoundField en TemplateField y agregar controles de validación.</span><span class="sxs-lookup"><span data-stu-id="d90f3-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="d90f3-282">Resumen</span><span class="sxs-lookup"><span data-stu-id="d90f3-282">Summary</span></span>

<span data-ttu-id="d90f3-283">Al definir el esquema de una tabla, Microsoft SQL Server permite la inclusión de columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="d90f3-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="d90f3-284">Se trata de columnas cuyos valores se calculan a partir de una expresión que normalmente hace referencia a los valores de otras columnas del mismo registro.</span><span class="sxs-lookup"><span data-stu-id="d90f3-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="d90f3-285">Dado que los valores de las columnas calculadas se basan en una expresión, son de solo lectura y no se puede asignar un valor a una instrucción `INSERT` o `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="d90f3-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="d90f3-286">Esto presenta desafíos cuando se usa una columna calculada en la consulta principal de un TableAdapter que intenta generar automáticamente las instrucciones `INSERT`, `UPDATE`y `DELETE` correspondientes.</span><span class="sxs-lookup"><span data-stu-id="d90f3-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="d90f3-287">En este tutorial se han analizado técnicas para eludir los desafíos planteados por las columnas calculadas.</span><span class="sxs-lookup"><span data-stu-id="d90f3-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="d90f3-288">En concreto, usamos procedimientos almacenados en el TableAdapter para superar la fragilidad inherente a los TableAdapters que usan instrucciones SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="d90f3-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="d90f3-289">Cuando el Asistente para TableAdapter crea nuevos procedimientos almacenados, es importante que la consulta principal omita inicialmente las columnas calculadas porque su presencia impide que se generen los procedimientos almacenados de modificación de datos.</span><span class="sxs-lookup"><span data-stu-id="d90f3-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="d90f3-290">Una vez configurado inicialmente el TableAdapter, su `SelectCommand` procedimiento almacenado se puede volver a usar para incluir cualquier columna calculada.</span><span class="sxs-lookup"><span data-stu-id="d90f3-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="d90f3-291">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="d90f3-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="d90f3-292">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="d90f3-292">About the Author</span></span>

<span data-ttu-id="d90f3-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros de ASP/ASP. net y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="d90f3-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d90f3-294">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="d90f3-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d90f3-295">Su último libro se [*enseña a ASP.NET 2,0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d90f3-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d90f3-296">Puede ponerse en contacto con usted en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d90f3-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="d90f3-297">o a través de su blog, que encontrará en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d90f3-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d90f3-298">Agradecimiento especial a</span><span class="sxs-lookup"><span data-stu-id="d90f3-298">Special Thanks To</span></span>

<span data-ttu-id="d90f3-299">Muchos revisores útiles revisaron esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="d90f3-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d90f3-300">Los revisores responsables de este tutorial eran Hilton Geisenow y Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="d90f3-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="d90f3-301">¿Está interesado en revisar los próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="d90f3-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d90f3-302">En caso afirmativo, suéltelo en [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d90f3-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="d90f3-303">[Anterior](adding-additional-datatable-columns-vb.md)
> [Siguiente](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d90f3-303">[Previous](adding-additional-datatable-columns-vb.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span></span>

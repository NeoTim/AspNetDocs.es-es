---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
title: Crear la capa de acceso a datos | Microsoft Docs
author: Erikre
description: Esta serie de tutoriales aprenderá los conceptos básicos de la creación de una aplicación de formularios Web Forms ASP.NET con ASP.NET 4.5 y Microsoft Visual Studio Express 2013 para se...
ms.author: riande
ms.date: 09/08/2014
ms.assetid: 0bbf7a6e-d7eb-4091-91e4-fff892777f32
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
msc.type: authoredcontent
ms.openlocfilehash: e6ec385c6a4a5507ffae726157f7d52e9c5605da
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/01/2019
ms.locfileid: "57036932"
---
<a name="create-the-data-access-layer"></a><span data-ttu-id="2cf57-103">Crear la capa de acceso a datos</span><span class="sxs-lookup"><span data-stu-id="2cf57-103">Create the Data Access Layer</span></span>
====================
<span data-ttu-id="2cf57-104">por [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="2cf57-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="2cf57-105">[Descargar el proyecto de ejemplo de Wingtip Toys (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) o [descargar eBook (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="2cf57-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="2cf57-106">Esta serie de tutoriales aprenderá los conceptos básicos de la creación de una aplicación de formularios Web Forms ASP.NET con ASP.NET 4.5 y Microsoft Visual Studio Express 2013 para Web.</span><span class="sxs-lookup"><span data-stu-id="2cf57-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="2cf57-107">Un Visual Studio 2013 [proyecto con código fuente de C#](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) está disponible para acompañar esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="2cf57-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="2cf57-108">Este tutorial describe cómo crear, acceder y revisar los datos de una base de datos con formularios Web Forms ASP.NET y Entity Framework Code First.</span><span class="sxs-lookup"><span data-stu-id="2cf57-108">This tutorial describes how to create, access, and review data from a database using ASP.NET Web Forms and Entity Framework Code First.</span></span> <span data-ttu-id="2cf57-109">Este tutorial se basa en el tutorial anterior, "Crear el proyecto" y forma parte de la serie de tutoriales de Wingtip Toys Store.</span><span class="sxs-lookup"><span data-stu-id="2cf57-109">This tutorial builds on the previous tutorial "Create the Project" and is part of the Wingtip Toy Store tutorial series.</span></span> <span data-ttu-id="2cf57-110">Cuando haya completado este tutorial, habrá creado un grupo de clases de acceso a datos que se encuentran en el *modelos* carpeta del proyecto.</span><span class="sxs-lookup"><span data-stu-id="2cf57-110">When you've completed this tutorial, you will have built a group of data-access classes that are in the *Models* folder of the project.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="2cf57-111">Lo que aprenderá:</span><span class="sxs-lookup"><span data-stu-id="2cf57-111">What you'll learn:</span></span>

- <span data-ttu-id="2cf57-112">Cómo crear los modelos de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-112">How to create the data models.</span></span>
- <span data-ttu-id="2cf57-113">Cómo inicializar y propagar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-113">How to initialize and seed the database.</span></span>
- <span data-ttu-id="2cf57-114">Cómo actualizar y configurar la aplicación para admitir la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-114">How to update and configure the application to support the database.</span></span>

### <a name="these-are-the-features-introduced-in-the-tutorial"></a><span data-ttu-id="2cf57-115">Estas son las características introducidas en el tutorial:</span><span class="sxs-lookup"><span data-stu-id="2cf57-115">These are the features introduced in the tutorial:</span></span>

- <span data-ttu-id="2cf57-116">Entity Framework Code First</span><span class="sxs-lookup"><span data-stu-id="2cf57-116">Entity Framework Code First</span></span>
- <span data-ttu-id="2cf57-117">LocalDB</span><span class="sxs-lookup"><span data-stu-id="2cf57-117">LocalDB</span></span>
- <span data-ttu-id="2cf57-118">Anotaciones de datos</span><span class="sxs-lookup"><span data-stu-id="2cf57-118">Data Annotations</span></span>

## <a name="creating-the-data-models"></a><span data-ttu-id="2cf57-119">Creación de los modelos de datos</span><span class="sxs-lookup"><span data-stu-id="2cf57-119">Creating the Data Models</span></span>

<span data-ttu-id="2cf57-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) es un marco de asignación relacional de objetos (ORM).</span><span class="sxs-lookup"><span data-stu-id="2cf57-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) is an object-relational mapping (ORM) framework.</span></span> <span data-ttu-id="2cf57-121">Permite trabajar con datos relacionales como objetos, lo que elimina gran parte del código de acceso a datos que normalmente tendría que escribir.</span><span class="sxs-lookup"><span data-stu-id="2cf57-121">It lets you work with relational data as objects, eliminating most of the data-access code that you'd usually need to write.</span></span> <span data-ttu-id="2cf57-122">Con Entity Framework, puede emitir consultas mediante [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), a continuación, recuperar y manipular los datos como objetos fuertemente tipados.</span><span class="sxs-lookup"><span data-stu-id="2cf57-122">Using Entity Framework, you can issue queries using [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), then retrieve and manipulate data as strongly typed objects.</span></span> <span data-ttu-id="2cf57-123">LINQ proporciona patrones para consultar y actualizar datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-123">LINQ provides patterns for querying and updating data.</span></span> <span data-ttu-id="2cf57-124">Con Entity Framework le permite centrarse en crear el resto de la aplicación, en lugar de centrarse en los datos de Fundamentos de acceso.</span><span class="sxs-lookup"><span data-stu-id="2cf57-124">Using Entity Framework allows you to focus on creating the rest of your application, rather than focusing on the data access fundamentals.</span></span> <span data-ttu-id="2cf57-125">Más adelante en esta serie de tutoriales, le mostraremos cómo usar los datos para rellenar las consultas de navegación y producto.</span><span class="sxs-lookup"><span data-stu-id="2cf57-125">Later in this tutorial series, we'll show you how to use the data to populate navigation and product queries.</span></span>

<span data-ttu-id="2cf57-126">Entity Framework admite un paradigma de desarrollo llama *Code First*.</span><span class="sxs-lookup"><span data-stu-id="2cf57-126">Entity Framework supports a development paradigm called *Code First*.</span></span> <span data-ttu-id="2cf57-127">Code First le permite definir los modelos de datos mediante las clases.</span><span class="sxs-lookup"><span data-stu-id="2cf57-127">Code First lets you define your data models using classes.</span></span> <span data-ttu-id="2cf57-128">Una clase es una construcción que le permite crear sus propios tipos personalizados agrupando las variables de otros tipos, métodos y eventos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-128">A class is a construct that enables you to create your own custom types by grouping together variables of other types, methods and events.</span></span> <span data-ttu-id="2cf57-129">Puede asignar clases a una base de datos existente o usarlas para generar una base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-129">You can map classes to an existing database or use them to generate a database.</span></span> <span data-ttu-id="2cf57-130">En este tutorial, creará los modelos de datos mediante la escritura de las clases de modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-130">In this tutorial, you'll create the data models by writing data model classes.</span></span> <span data-ttu-id="2cf57-131">A continuación, deberá dejar que Entity Framework crea la base de datos sobre la marcha a partir de estas nuevas clases.</span><span class="sxs-lookup"><span data-stu-id="2cf57-131">Then, you'll let Entity Framework create the database on the fly from these new classes.</span></span>

<span data-ttu-id="2cf57-132">Se iniciará mediante la creación de las clases de entidad que definen los modelos de datos para la aplicación de formularios Web Forms.</span><span class="sxs-lookup"><span data-stu-id="2cf57-132">You will begin by creating the entity classes that define the data models for the Web Forms application.</span></span> <span data-ttu-id="2cf57-133">A continuación, creará una clase de contexto que administra las clases de entidad y proporciona acceso a datos en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-133">Then you will create a context class that manages the entity classes and provides data access to the database.</span></span> <span data-ttu-id="2cf57-134">También creará una clase de inicializador que va a utilizar para rellenar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-134">You will also create an initializer class that you will use to populate the database.</span></span>

### <a name="entity-framework-and-references"></a><span data-ttu-id="2cf57-135">Referencias y entity Framework</span><span class="sxs-lookup"><span data-stu-id="2cf57-135">Entity Framework and References</span></span>

<span data-ttu-id="2cf57-136">De forma predeterminada, Entity Framework se incluye cuando se crea un nuevo **aplicación Web ASP.NET** utilizando el **formularios Web Forms** plantilla.</span><span class="sxs-lookup"><span data-stu-id="2cf57-136">By default, Entity Framework is included when you create a new **ASP.NET Web Application** using the **Web Forms** template.</span></span> <span data-ttu-id="2cf57-137">Entity Framework se pueda instalar, desinstalar y actualizado como un paquete de NuGet.</span><span class="sxs-lookup"><span data-stu-id="2cf57-137">Entity Framework can be installed, uninstalled, and updated as a NuGet package.</span></span>

<span data-ttu-id="2cf57-138">Este paquete de NuGet incluye lo siguiente **en tiempo de ejecución** ensamblados dentro del proyecto:</span><span class="sxs-lookup"><span data-stu-id="2cf57-138">This NuGet package includes the following **runtime** assemblies within your project:</span></span>

- <span data-ttu-id="2cf57-139">EntityFramework.dll: todo el código de tiempo de ejecución común utilizado por Entity Framework</span><span class="sxs-lookup"><span data-stu-id="2cf57-139">EntityFramework.dll – All the common runtime code used by Entity Framework</span></span>
- <span data-ttu-id="2cf57-140">EntityFramework.SqlServer.dll: el proveedor de Microsoft SQL Server para Entity Framework</span><span class="sxs-lookup"><span data-stu-id="2cf57-140">EntityFramework.SqlServer.dll – The Microsoft SQL Server provider for Entity Framework</span></span>

### <a name="entity-classes"></a><span data-ttu-id="2cf57-141">Clases de entidad</span><span class="sxs-lookup"><span data-stu-id="2cf57-141">Entity Classes</span></span>

<span data-ttu-id="2cf57-142">Las clases que cree para definir el esquema de los datos se denominan clases de entidad.</span><span class="sxs-lookup"><span data-stu-id="2cf57-142">The classes you create to define the schema of the data are called entity classes.</span></span> <span data-ttu-id="2cf57-143">Si está familiarizado con el diseño de la base de datos, considere las clases de entidad como definiciones de tabla de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-143">If you're new to database design, think of the entity classes as table definitions of a database.</span></span> <span data-ttu-id="2cf57-144">Cada propiedad de la clase especifica una columna en la tabla de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-144">Each property in the class specifies a column in the table of the database.</span></span> <span data-ttu-id="2cf57-145">Estas clases proporcionan una interfaz sencilla y relacional de objetos entre código orientado a objetos y la estructura de tabla relacional de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-145">These classes provide a lightweight, object-relational interface between object-oriented code and the relational table structure of the database.</span></span>

<span data-ttu-id="2cf57-146">En este tutorial, empezará mediante la adición de clases de entidad simple que representan los esquemas de productos y categorías.</span><span class="sxs-lookup"><span data-stu-id="2cf57-146">In this tutorial, you'll start out by adding simple entity classes representing the schemas for products and categories.</span></span> <span data-ttu-id="2cf57-147">La clase products contendrá definiciones para cada producto.</span><span class="sxs-lookup"><span data-stu-id="2cf57-147">The products class will contain definitions for each product.</span></span> <span data-ttu-id="2cf57-148">El nombre de cada uno de los miembros de la clase product será `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`, y `Category`.</span><span class="sxs-lookup"><span data-stu-id="2cf57-148">The name of each of the members of the product class will be `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`, and `Category`.</span></span> <span data-ttu-id="2cf57-149">La clase de categoría contiene definiciones para cada categoría de un producto puede pertenecer a, como coche, barco o plano.</span><span class="sxs-lookup"><span data-stu-id="2cf57-149">The category class will contain definitions for each category that a product can belong to, such as Car, Boat, or Plane.</span></span> <span data-ttu-id="2cf57-150">El nombre de cada uno de los miembros de la clase de categoría será `CategoryID`, `CategoryName`, `Description`, y `Products`.</span><span class="sxs-lookup"><span data-stu-id="2cf57-150">The name of each of the members of the category class will be `CategoryID`, `CategoryName`, `Description`, and `Products`.</span></span> <span data-ttu-id="2cf57-151">Cada producto pertenece a una de las categorías.</span><span class="sxs-lookup"><span data-stu-id="2cf57-151">Each product will belong to one of the categories.</span></span> <span data-ttu-id="2cf57-152">Estas clases de entidad se agregará el proyecto existente *modelos* carpeta.</span><span class="sxs-lookup"><span data-stu-id="2cf57-152">These entity classes will be added to the project's existing *Models* folder.</span></span>

1. <span data-ttu-id="2cf57-153">En **el Explorador de soluciones**, haga clic en el *modelos* carpeta y, a continuación, seleccione **agregar**  - &gt; **nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="2cf57-153">In **Solution Explorer**, right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span> 

    ![Crear nuevo menú de elemento de la capa de acceso a datos:](create_the_data_access_layer/_static/image1.png)

   <span data-ttu-id="2cf57-155">Se abrirá el cuadro de diálogo **Agregar nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="2cf57-155">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="2cf57-156">En **Visual C#** desde el **instalado** panel de la izquierda, seleccione **código**.</span><span class="sxs-lookup"><span data-stu-id="2cf57-156">Under **Visual C#** from the **Installed** pane on the left, select **Code**.</span></span> 

    ![Crear nuevo menú de elemento de la capa de acceso a datos:](create_the_data_access_layer/_static/image2.png)
3. <span data-ttu-id="2cf57-158">Seleccione **clase** desde el panel central y el nombre de esta nueva clase *Product.cs*.</span><span class="sxs-lookup"><span data-stu-id="2cf57-158">Select **Class** from the middle pane and name this new class *Product.cs*.</span></span>
4. <span data-ttu-id="2cf57-159">Haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="2cf57-159">Click **Add**.</span></span>  
   <span data-ttu-id="2cf57-160">El nuevo archivo de clase se muestra en el editor.</span><span class="sxs-lookup"><span data-stu-id="2cf57-160">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="2cf57-161">Reemplace el código predeterminado con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="2cf57-161">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample1.cs)]
6. <span data-ttu-id="2cf57-162">Cree otra clase repitiendo los pasos 1 a 4, sin embargo, la nueva clase el nombre *Category.cs* y reemplace el código predeterminado con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="2cf57-162">Create another class by repeating steps 1 through 4, however, name the new class *Category.cs* and replace the default code with the following code:</span></span>  

    [!code-csharp[Main](create_the_data_access_layer/samples/sample2.cs)]

<span data-ttu-id="2cf57-163">Como se mencionó anteriormente, el `Category` clase representa el tipo de producto que la aplicación está diseñada para vender (como <a id="a"> </a> &quot;automóviles&quot;, &quot;barcos&quot;, &quot;Cohetes&quot;, y así sucesivamente) y el `Product` clase representa los productos individuales (toys) en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-163">As previously mentioned, the `Category` class represents the type of product that the application is designed to sell (such as <a id="a"></a>&quot;Cars&quot;, &quot;Boats&quot;, &quot;Rockets&quot;, and so on), and the `Product` class represents the individual products (toys) in the database.</span></span> <span data-ttu-id="2cf57-164">Cada instancia de un `Product` objeto corresponderá a una fila dentro de una tabla de base de datos relacional, y cada propiedad de la clase de producto se asignará a una columna en la tabla de base de datos relacional.</span><span class="sxs-lookup"><span data-stu-id="2cf57-164">Each instance of a `Product` object will correspond to a row within a relational database table, and each property of the Product class will map to a column in the relational database table.</span></span> <span data-ttu-id="2cf57-165">Más adelante en este tutorial, revisará los datos de productos incluidos en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-165">Later in this tutorial, you'll review the product data contained in the database.</span></span>

### <a name="data-annotations"></a><span data-ttu-id="2cf57-166">Anotaciones de datos</span><span class="sxs-lookup"><span data-stu-id="2cf57-166">Data Annotations</span></span>

<span data-ttu-id="2cf57-167">Es podrán que haya observado que determinados miembros de las clases tienen los atributos que especifican los detalles sobre el miembro, como `[ScaffoldColumn(false)]`.</span><span class="sxs-lookup"><span data-stu-id="2cf57-167">You may have noticed that certain members of the classes have attributes specifying details about the member, such as `[ScaffoldColumn(false)]`.</span></span> <span data-ttu-id="2cf57-168">Estos son *anotaciones de datos*.</span><span class="sxs-lookup"><span data-stu-id="2cf57-168">These are *data annotations*.</span></span> <span data-ttu-id="2cf57-169">Los atributos de anotación de datos pueden describir cómo validar la entrada de usuario para ese miembro, para especificar un formato y especificar cómo se se modela cuando se crea la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-169">The data annotation attributes can describe how to validate user input for that member, to specify formatting for it, and to specify how it is modeled when the database is created.</span></span>

### <a name="context-class"></a><span data-ttu-id="2cf57-170">Context (Clase)</span><span class="sxs-lookup"><span data-stu-id="2cf57-170">Context Class</span></span>

<span data-ttu-id="2cf57-171">Para empezar a usar las clases de acceso a datos, debe definir una clase de contexto.</span><span class="sxs-lookup"><span data-stu-id="2cf57-171">To start using the classes for data access, you must define a context class.</span></span> <span data-ttu-id="2cf57-172">Como se mencionó anteriormente, la clase de contexto administra las clases de entidad (como el `Product` clase y el `Category` clase) y proporciona acceso a datos en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-172">As mentioned previously, the context class manages the entity classes (such as the `Product` class and the `Category` class) and provides data access to the database.</span></span>

<span data-ttu-id="2cf57-173">Este procedimiento agrega una nueva clase de contexto C# para el *modelos* carpeta.</span><span class="sxs-lookup"><span data-stu-id="2cf57-173">This procedure adds a new C# context class to the *Models* folder.</span></span>

1. <span data-ttu-id="2cf57-174">Haga clic en el *modelos* carpeta y, a continuación, seleccione **agregar**  - &gt; **nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="2cf57-174">Right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="2cf57-175">Se abrirá el cuadro de diálogo **Agregar nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="2cf57-175">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="2cf57-176">Seleccione **clase** desde el panel central, asígnele el nombre *ProductContext.cs* y haga clic en **agregar**.</span><span class="sxs-lookup"><span data-stu-id="2cf57-176">Select **Class** from the middle pane, name it *ProductContext.cs* and click **Add**.</span></span>
3. <span data-ttu-id="2cf57-177">Reemplace el código predeterminado contenido en la clase con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="2cf57-177">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample3.cs)]

<span data-ttu-id="2cf57-178">Este código agrega el `System.Data.Entity` espacio de nombres para que tengan acceso a toda la funcionalidad núcleo de Entity Framework, que incluye la capacidad para consultar, insertar, actualizar y eliminar datos trabajando con objetos fuertemente tipados.</span><span class="sxs-lookup"><span data-stu-id="2cf57-178">This code adds the `System.Data.Entity` namespace so that you have access to all the core functionality of Entity Framework, which includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span>

<span data-ttu-id="2cf57-179">El `ProductContext` clase representa el contexto de base de datos de producto de Entity Framework, que se encarga de capturar, almacenar y actualizar `Product` instancias en la base de datos de clase.</span><span class="sxs-lookup"><span data-stu-id="2cf57-179">The `ProductContext` class represents Entity Framework product database context, which handles fetching, storing, and updating `Product` class instances in the database.</span></span> <span data-ttu-id="2cf57-180">El `ProductContext` clase se deriva de la `DbContext` proporcionado por Entity Framework de clase base.</span><span class="sxs-lookup"><span data-stu-id="2cf57-180">The `ProductContext` class derives from the `DbContext` base class provided by Entity Framework.</span></span>

### <a name="initializer-class"></a><span data-ttu-id="2cf57-181">Clase de inicializador</span><span class="sxs-lookup"><span data-stu-id="2cf57-181">Initializer Class</span></span>

<span data-ttu-id="2cf57-182">Deberá ejecutar alguna lógica personalizada para inicializar el tiempo de la base de datos la primera que se usa el contexto.</span><span class="sxs-lookup"><span data-stu-id="2cf57-182">You will need to run some custom logic to initialize the database the first time the context is used.</span></span> <span data-ttu-id="2cf57-183">Esto permitirá que los datos de inicialización que se agregarán a la base de datos para que inmediatamente puede mostrar categorías y productos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-183">This will allow seed data to be added to the database so that you can immediately display products and categories.</span></span>

<span data-ttu-id="2cf57-184">Este procedimiento agrega una nueva clase inicializador C# para el *modelos* carpeta.</span><span class="sxs-lookup"><span data-stu-id="2cf57-184">This procedure adds a new C# initializer class to the *Models* folder.</span></span>

1. <span data-ttu-id="2cf57-185">Crear otro `Class` en el *modelos* carpeta y asígnele el nombre *ProductDatabaseInitializer.cs*.</span><span class="sxs-lookup"><span data-stu-id="2cf57-185">Create another `Class` in the *Models* folder and name it *ProductDatabaseInitializer.cs*.</span></span>
2. <span data-ttu-id="2cf57-186">Reemplace el código predeterminado contenido en la clase con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="2cf57-186">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample4.cs)]

<span data-ttu-id="2cf57-187">Como puede ver en el código anterior, cuando la base de datos se crea e inicializa, el `Seed` propiedad se invalida y establecer.</span><span class="sxs-lookup"><span data-stu-id="2cf57-187">As you can see from the above code, when the database is created and initialized, the `Seed` property is overridden and set.</span></span> <span data-ttu-id="2cf57-188">Cuando el `Seed` propiedad está establecida, los valores de las categorías y productos se usan para rellenar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-188">When the `Seed` property is set, the values from the categories and products are used to populate the database.</span></span> <span data-ttu-id="2cf57-189">Si se intenta actualizar los datos de inicialización modificando el código anterior una vez creada la base de datos, no verá las actualizaciones al ejecutar la aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="2cf57-189">If you attempt to update the seed data by modifying the above code after the database has been created, you won't see any updates when you run the Web application.</span></span> <span data-ttu-id="2cf57-190">La razón es que el código anterior usa una implementación de la `DropCreateDatabaseIfModelChanges` clase para que reconozca si ha cambiado el modelo (esquema) antes de restablecer los datos de inicialización.</span><span class="sxs-lookup"><span data-stu-id="2cf57-190">The reason is the above code uses an implementation of the `DropCreateDatabaseIfModelChanges` class to recognize if the model (schema) has changed before resetting the seed data.</span></span> <span data-ttu-id="2cf57-191">Si se realiza ningún cambio a la `Category` y `Product` no se reinicializarán las clases de entidad, la base de datos con los datos de inicialización.</span><span class="sxs-lookup"><span data-stu-id="2cf57-191">If no changes are made to the `Category` and `Product` entity classes, the database will not be reinitialized with the seed data.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="2cf57-192">Si desea que la base de datos se vuelven a crear cada vez ejecutó la aplicación, podría utilizar el `DropCreateDatabaseAlways` clase en lugar de la `DropCreateDatabaseIfModelChanges` clase.</span><span class="sxs-lookup"><span data-stu-id="2cf57-192">If you wanted the database to be recreated every time you ran the application, you could use the `DropCreateDatabaseAlways` class instead of the `DropCreateDatabaseIfModelChanges` class.</span></span> <span data-ttu-id="2cf57-193">Sin embargo, para esta serie de tutoriales, use la `DropCreateDatabaseIfModelChanges` clase.</span><span class="sxs-lookup"><span data-stu-id="2cf57-193">However for this tutorial series, use the `DropCreateDatabaseIfModelChanges` class.</span></span>


<span data-ttu-id="2cf57-194">En este momento en este tutorial, tendrá un *modelos* carpeta con cuatro nuevas clases y una clase predefinida:</span><span class="sxs-lookup"><span data-stu-id="2cf57-194">At this point in this tutorial, you will have a *Models* folder with four new classes and one default class:</span></span>

![Crear carpeta modelos de la capa de acceso a datos:](create_the_data_access_layer/_static/image3.png)

### <a name="configuring-the-application-to-use-the-data-model"></a><span data-ttu-id="2cf57-196">Configurar la aplicación para usar el modelo de datos</span><span class="sxs-lookup"><span data-stu-id="2cf57-196">Configuring the Application to Use the Data Model</span></span>

<span data-ttu-id="2cf57-197">Ahora que ha creado las clases que representan los datos, debe configurar la aplicación para usar las clases.</span><span class="sxs-lookup"><span data-stu-id="2cf57-197">Now that you've created the classes that represent the data, you must configure the application to use the classes.</span></span> <span data-ttu-id="2cf57-198">En el *Global.asax* archivo, agrega código que inicializa el modelo.</span><span class="sxs-lookup"><span data-stu-id="2cf57-198">In the *Global.asax* file, you add code that initializes the model.</span></span> <span data-ttu-id="2cf57-199">En el *Web.config* archivo agregar la información que indica que la aplicación lo que la base de datos usará para almacenar los datos que se representan mediante las nuevas clases de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-199">In the *Web.config* file you add information that tells the application what database you'll use to store the data that's represented by the new data classes.</span></span> <span data-ttu-id="2cf57-200">El *Global.asax* archivo puede usarse para controlar eventos de aplicación o los métodos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-200">The *Global.asax* file can be used to handle application events or methods.</span></span> <span data-ttu-id="2cf57-201">El *Web.config* archivo le permite controlar la configuración de la aplicación web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="2cf57-201">The *Web.config* file allows you to control the configuration of your ASP.NET web application.</span></span>

#### <a name="updating-the-globalasax-file"></a><span data-ttu-id="2cf57-202">Actualizando el archivo Global.asax</span><span class="sxs-lookup"><span data-stu-id="2cf57-202">Updating the Global.asax file</span></span>

<span data-ttu-id="2cf57-203">Para inicializar los modelos de datos cuando se inicia la aplicación, actualizará la `Application_Start` controlador en el *Global.asax.cs* archivo.</span><span class="sxs-lookup"><span data-stu-id="2cf57-203">To initialize the data models when the application starts, you will update the `Application_Start` handler in the *Global.asax.cs* file.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="2cf57-204">En el Explorador de soluciones, seleccione el *Global.asax* archivo o la *Global.asax.cs* archivo para editar el *Global.asax.cs* archivo.</span><span class="sxs-lookup"><span data-stu-id="2cf57-204">In Solution Explorer, you can select either the *Global.asax* file or the *Global.asax.cs* file to edit the *Global.asax.cs* file.</span></span>


1. <span data-ttu-id="2cf57-205">Agregue el siguiente código resaltado en amarillo en la `Application_Start` método en el *Global.asax.cs* archivo.</span><span class="sxs-lookup"><span data-stu-id="2cf57-205">Add the following code highlighted in yellow to the `Application_Start` method in the *Global.asax.cs* file.</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample5.cs?highlight=9-10,22-23)]

> [!NOTE] 
> 
> <span data-ttu-id="2cf57-206">El explorador debe admitir HTML5 para ver el código resaltado en amarillo cuando vea esta serie de tutoriales en un explorador.</span><span class="sxs-lookup"><span data-stu-id="2cf57-206">Your browser must support HTML5 to view the code highlighted in yellow when viewing this tutorial series in a browser.</span></span>


<span data-ttu-id="2cf57-207">Como se muestra en el código anterior, cuando se inicia la aplicación, la aplicación especifica el inicializador que se ejecutará durante la primera vez que los datos se tiene acceso.</span><span class="sxs-lookup"><span data-stu-id="2cf57-207">As shown in the above code, when the application starts, the application specifies the initializer that will run during the first time the data is accessed.</span></span> <span data-ttu-id="2cf57-208">Los dos espacios de nombres adicionales son necesarios para tener acceso a la `Database` objeto y el `ProductDatabaseInitializer` objeto.</span><span class="sxs-lookup"><span data-stu-id="2cf57-208">The two additional namespaces are required to access the `Database` object and the `ProductDatabaseInitializer` object.</span></span>

 <span data-ttu-id="2cf57-209">Modificar el archivo Web.Config</span><span class="sxs-lookup"><span data-stu-id="2cf57-209">Modifying the Web.Config File</span></span> 

<span data-ttu-id="2cf57-210">Aunque Entity Framework Code First generará una base de datos de en una ubicación predeterminada cuando la base de datos se rellena con datos de inicialización, agregar su propia información de conexión a la aplicación le ofrece control de la ubicación de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-210">Although Entity Framework Code First will generate a database for you in a default location when the database is populated with seed data, adding your own connection information to your application gives you control of the database location.</span></span> <span data-ttu-id="2cf57-211">Especifique esta conexión de base de datos usando una cadena de conexión en la aplicación *Web.config* archivo en la raíz del proyecto.</span><span class="sxs-lookup"><span data-stu-id="2cf57-211">You specify this database connection using a connection string in the application's *Web.config* file at the root of the project.</span></span> <span data-ttu-id="2cf57-212">Al agregar una nueva cadena de conexión, puede dirigir la ubicación de la base de datos (*wingtiptoys.mdf*) que se crea en el directorio de datos de la aplicación (*aplicación\_datos*), en lugar de su valor predeterminado ubicación.</span><span class="sxs-lookup"><span data-stu-id="2cf57-212">By adding a new connection string, you can direct the location of the database (*wingtiptoys.mdf*) to be built in the application's data directory (*App\_Data*), rather than its default location.</span></span> <span data-ttu-id="2cf57-213">Realizar este cambio, podrá encontrar e inspeccione el archivo de base de datos más adelante en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="2cf57-213">Making this change will allow you to find and inspect the database file later in this tutorial.</span></span>

1. <span data-ttu-id="2cf57-214">En **el Explorador de soluciones**, busque y abra el *Web.config* archivo.</span><span class="sxs-lookup"><span data-stu-id="2cf57-214">In **Solution Explorer**, find and open the *Web.config* file.</span></span>
2. <span data-ttu-id="2cf57-215">Agregue la cadena de conexión que se resaltan en amarillo en la `<connectionStrings>` sección de la *Web.config* archivo como sigue:</span><span class="sxs-lookup"><span data-stu-id="2cf57-215">Add the connection string highlighted in yellow to the `<connectionStrings>` section of the *Web.config* file as follows:</span></span>  

    [!code-xml[Main](create_the_data_access_layer/samples/sample6.xml?highlight=4-7)]

<span data-ttu-id="2cf57-216">Cuando se ejecuta la aplicación por primera vez, creará la base de datos en la ubicación especificada por la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="2cf57-216">When the application is run for the first time, it will build the database at the location specified by the connection string.</span></span> <span data-ttu-id="2cf57-217">Pero antes de ejecutar la aplicación, vamos a compilarla primero.</span><span class="sxs-lookup"><span data-stu-id="2cf57-217">But before running the application, let's build it first.</span></span>

## <a name="building-the-application"></a><span data-ttu-id="2cf57-218">Compilar la aplicación</span><span class="sxs-lookup"><span data-stu-id="2cf57-218">Building the Application</span></span>

<span data-ttu-id="2cf57-219">Para asegurarse de que todas las clases y los cambios en la aplicación Web funcionen, debe compilar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2cf57-219">To make sure that all the classes and changes to your Web application work, you should build the application.</span></span>

1. <span data-ttu-id="2cf57-220">Desde el **depurar** menú, seleccione **WingtipToys compilar**.</span><span class="sxs-lookup"><span data-stu-id="2cf57-220">From the **Debug** menu, select **Build WingtipToys**.</span></span>  
 <span data-ttu-id="2cf57-221">El **salida** se muestra la ventana y, si todo ha ido bien, verá un *se realizó correctamente* mensaje.</span><span class="sxs-lookup"><span data-stu-id="2cf57-221">The **Output** window is displayed, and if all went well, you see a *succeeded* message.</span></span>  

    ![Crear la capa de acceso a datos - Windows de salida](create_the_data_access_layer/_static/image4.png)

<span data-ttu-id="2cf57-223">Si experimenta un error, vuelva a comprobar los pasos anteriores.</span><span class="sxs-lookup"><span data-stu-id="2cf57-223">If you run into an error, re-check the above steps.</span></span> <span data-ttu-id="2cf57-224">La información de la **salida** ventana le indicará qué archivo tiene un problema y donde se requiere un cambio en el archivo.</span><span class="sxs-lookup"><span data-stu-id="2cf57-224">The information in the **Output** window will indicate which file has a problem and where in the file a change is required.</span></span> <span data-ttu-id="2cf57-225">Esta información le permitirá determinar qué parte de los pasos anteriores deben revisarse y se ha corregido en el proyecto.</span><span class="sxs-lookup"><span data-stu-id="2cf57-225">This information will enable you to determine what part of the above steps need to be reviewed and fixed in your project.</span></span>

## <a name="summary"></a><span data-ttu-id="2cf57-226">Resumen</span><span class="sxs-lookup"><span data-stu-id="2cf57-226">Summary</span></span>

<span data-ttu-id="2cf57-227">En este tutorial de la serie se ha creado el modelo de datos, así como, agregué el código que se usará para inicializar y propagar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-227">In this tutorial of the series you have created the data model, as well as, added the code that will be used to initialize and seed the database.</span></span> <span data-ttu-id="2cf57-228">También ha configurado la aplicación para usar los modelos de datos cuando se ejecuta la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2cf57-228">You have also configured the application to use the data models when the application is run.</span></span>

<span data-ttu-id="2cf57-229">En el siguiente tutorial, deberá actualizar la interfaz de usuario, Agregar navegación y recuperar datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2cf57-229">In the next tutorial, you'll update the UI, add navigation, and retrieve data from the database.</span></span> <span data-ttu-id="2cf57-230">Esto dará como resultado de la base de datos que se crean automáticamente en función de las clases de entidad que creó en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="2cf57-230">This will result in the database being automatically created based on the entity classes that you created in this tutorial.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="2cf57-231">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="2cf57-231">Additional Resources</span></span>

<span data-ttu-id="2cf57-232">[Introducción a Entity Framework](https://msdn.microsoft.com/library/bb399567.aspx) </span><span class="sxs-lookup"><span data-stu-id="2cf57-232">[Entity Framework Overview](https://msdn.microsoft.com/library/bb399567.aspx) </span></span>  
<span data-ttu-id="2cf57-233">[Guía para principiantes para ADO.NET Entity Framework](https://msdn.microsoft.com/data/ee712907) </span><span class="sxs-lookup"><span data-stu-id="2cf57-233">[Beginner's Guide to the ADO.NET Entity Framework](https://msdn.microsoft.com/data/ee712907) </span></span>  
<span data-ttu-id="2cf57-234">[Desarrollo de primera con Entity Framework de código](http://www.msteched.com/2010/Europe/DEV212) (vídeo)</span><span class="sxs-lookup"><span data-stu-id="2cf57-234">[Code First Development with Entity Framework](http://www.msteched.com/2010/Europe/DEV212) (video)</span></span>   
<span data-ttu-id="2cf57-235">[API Fluent de Code First de relaciones](https://msdn.microsoft.com/data/hh134698) </span><span class="sxs-lookup"><span data-stu-id="2cf57-235">[Code First Relationships Fluent API](https://msdn.microsoft.com/data/hh134698) </span></span>  
[<span data-ttu-id="2cf57-236">Anotaciones de datos de Code First</span><span class="sxs-lookup"><span data-stu-id="2cf57-236">Code First Data Annotations</span></span>](https://msdn.microsoft.com/data/gg193958)  
[<span data-ttu-id="2cf57-237">Mejoras de productividad para Entity Framework</span><span class="sxs-lookup"><span data-stu-id="2cf57-237">Productivity Improvements for the Entity Framework</span></span>](https://blogs.msdn.com/b/efdesign/archive/2010/06/21/productivity-improvements-for-the-entity-framework.aspx?wa=wsignin1.0)

> [!div class="step-by-step"]
> <span data-ttu-id="2cf57-238">[Anterior](create-the-project.md)
> [Siguiente](ui_and_navigation.md)</span><span class="sxs-lookup"><span data-stu-id="2cf57-238">[Previous](create-the-project.md)
[Next](ui_and_navigation.md)</span></span>

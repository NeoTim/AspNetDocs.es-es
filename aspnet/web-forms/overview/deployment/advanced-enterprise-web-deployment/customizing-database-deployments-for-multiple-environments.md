---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments
title: Personalización de implementaciones de base de datos para varios entornos | Microsoft Docs
author: jrjlee
description: 'En este tema se describe cómo adaptar las propiedades de una base de datos a entornos de destino específicos como parte del proceso de implementación. Nota: el tema supone que...'
ms.author: riande
ms.date: 05/04/2012
ms.assetid: a172979a-1318-4318-a9c6-4f9560d26267
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/customizing-database-deployments-for-multiple-environments
msc.type: authoredcontent
ms.openlocfilehash: 8ae8cb1a322afb95c5d2e8d5e73c7825c7b2fe5a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2020
ms.locfileid: "78489037"
---
# <a name="customizing-database-deployments-for-multiple-environments"></a><span data-ttu-id="6be8d-104">Personalizar las implementaciones de la base de datos para varios entornos</span><span class="sxs-lookup"><span data-stu-id="6be8d-104">Customizing Database Deployments for Multiple Environments</span></span>

<span data-ttu-id="6be8d-105">por [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="6be8d-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="6be8d-106">Descargar PDF</span><span class="sxs-lookup"><span data-stu-id="6be8d-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="6be8d-107">En este tema se describe cómo adaptar las propiedades de una base de datos a entornos de destino específicos como parte del proceso de implementación.</span><span class="sxs-lookup"><span data-stu-id="6be8d-107">This topic describes how to tailor the properties of a database to specific target environments as part of the deployment process.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="6be8d-108">En el tema se supone que está implementando un proyecto de base de datos de Visual Studio 2010 con MSBuild. exe y VSDBCMD. exe.</span><span class="sxs-lookup"><span data-stu-id="6be8d-108">The topic assumes that you're deploying a Visual Studio 2010 database project using MSBuild.exe and VSDBCMD.exe.</span></span> <span data-ttu-id="6be8d-109">Para obtener más información sobre por qué podría elegir este enfoque, vea [implementación web en los proyectos de](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md) [base de datos](../web-deployment-in-the-enterprise/deploying-database-projects.md)Enterprise e implementar.</span><span class="sxs-lookup"><span data-stu-id="6be8d-109">For more information on why you might choose this approach, see [Web Deployment in the Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md) and [Deploying Database Projects](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span></span>
> 
> 
> <span data-ttu-id="6be8d-110">Al implementar un proyecto de base de datos en varios destinos, a menudo querrá personalizar las propiedades de implementación de la base de datos para cada entorno de destino.</span><span class="sxs-lookup"><span data-stu-id="6be8d-110">When you deploy a database project to multiple destinations, you'll often want to customize the database deployment properties for each target environment.</span></span> <span data-ttu-id="6be8d-111">Por ejemplo, en entornos de prueba, normalmente se vuelve a crear la base de datos en cada implementación, mientras que en entornos de ensayo o de producción es mucho más probable que se realicen actualizaciones incrementales para conservar los datos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-111">For example, in test environments you'd typically recreate the database on every deployment, whereas in staging or production environments you'd be a lot more likely to make incremental updates to preserve your data.</span></span>
> 
> <span data-ttu-id="6be8d-112">En un proyecto de base de datos de Visual Studio 2010, la configuración de implementación se encuentra dentro de un archivo de configuración de implementación (. sqldeployment).</span><span class="sxs-lookup"><span data-stu-id="6be8d-112">In a Visual Studio 2010 database project, deployment settings are contained within a deployment configuration (.sqldeployment) file.</span></span> <span data-ttu-id="6be8d-113">En este tema se muestra cómo crear archivos de configuración de implementación específicos del entorno y cómo especificar el que quiere usar como parámetro de VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="6be8d-113">This topic will show you how to create environment-specific deployment configuration files and specify the one you want to use as a VSDBCMD parameter.</span></span>

<span data-ttu-id="6be8d-114">Este tema forma parte de una serie de tutoriales basados en los requisitos de implementación empresarial de una empresa ficticia denominada Fabrikam, Inc. En esta serie de tutoriales se&#x2014;usa una solución de ejemplo de la&#x2014; [solución Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)para representar una aplicación web con un nivel de complejidad realista, como una aplicación ASP.NET MVC 3, un servicio Windows Communication Foundation (WCF) y un proyecto de base de datos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-114">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="6be8d-115">El método de implementación que se encuentra en el corazón de estos tutoriales se basa en el enfoque de archivo de proyecto dividido que se describe en [Descripción del archivo de proyecto](../web-deployment-in-the-enterprise/understanding-the-project-file.md), en el&#x2014;que el proceso de compilación se controla mediante dos archivos de proyecto que contiene instrucciones de compilación que se aplican a cada entorno de destino y uno que contiene la configuración de compilación e implementación específica del entorno.</span><span class="sxs-lookup"><span data-stu-id="6be8d-115">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="6be8d-116">En tiempo de compilación, el archivo de proyecto específico del entorno se combina en el archivo de proyecto independiente del entorno para formar un conjunto completo de instrucciones de compilación.</span><span class="sxs-lookup"><span data-stu-id="6be8d-116">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="6be8d-117">Información general sobre tareas</span><span class="sxs-lookup"><span data-stu-id="6be8d-117">Task Overview</span></span>

<span data-ttu-id="6be8d-118">En este tema se supone que:</span><span class="sxs-lookup"><span data-stu-id="6be8d-118">This topic assumes that:</span></span>

- <span data-ttu-id="6be8d-119">El enfoque de archivo de proyecto dividido se usa para la implementación de soluciones, como se describe en [Descripción del archivo de proyecto](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span><span class="sxs-lookup"><span data-stu-id="6be8d-119">You use the split project file approach to solution deployment, as described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span>
- <span data-ttu-id="6be8d-120">Llame a VSDBCMD desde el archivo de proyecto para implementar el proyecto de base de datos, como se describe en [Descripción del proceso de compilación](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="6be8d-120">You call VSDBCMD from the project file to deploy your database project, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

<span data-ttu-id="6be8d-121">Para crear un sistema de implementación que admita variables de implementación de base de datos entre entornos de destino, deberá:</span><span class="sxs-lookup"><span data-stu-id="6be8d-121">To create a deployment system that supports varying the database deployment properties between target environments, you'll need to:</span></span>

- <span data-ttu-id="6be8d-122">Cree un archivo de configuración de implementación (. sqldeployment) para cada entorno de destino.</span><span class="sxs-lookup"><span data-stu-id="6be8d-122">Create a deployment configuration (.sqldeployment) file for each target environment.</span></span>
- <span data-ttu-id="6be8d-123">Cree un comando de VSDBCMD que especifique el archivo de configuración de implementación como un modificador de la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-123">Create a VSDBCMD command that specifies the deployment configuration file as a command-line switch.</span></span>
- <span data-ttu-id="6be8d-124">Parametrizar el comando VSDBCMD en un archivo de proyecto de Microsoft Build Engine (MSBuild), de modo que las opciones de VSDBCMD sean adecuadas para el entorno de destino.</span><span class="sxs-lookup"><span data-stu-id="6be8d-124">Parameterize the VSDBCMD command in a Microsoft Build Engine (MSBuild) project file, so that the VSDBCMD options are appropriate to the target environment.</span></span>

<span data-ttu-id="6be8d-125">En este tema se muestra cómo realizar cada uno de estos procedimientos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-125">This topic will show you how to perform each of these procedures.</span></span>

## <a name="creating-environment-specific-deployment-configuration-files"></a><span data-ttu-id="6be8d-126">Crear archivos de configuración de implementación específicos del entorno</span><span class="sxs-lookup"><span data-stu-id="6be8d-126">Creating Environment-Specific Deployment Configuration Files</span></span>

<span data-ttu-id="6be8d-127">De forma predeterminada, un proyecto de base de datos contiene un archivo de configuración de implementación único denominado *Database. sqldeployment*.</span><span class="sxs-lookup"><span data-stu-id="6be8d-127">By default, a database project contains a single deployment configuration file named *Database.sqldeployment*.</span></span> <span data-ttu-id="6be8d-128">Si abre este archivo en Visual Studio 2010, puede ver las distintas opciones de implementación disponibles:</span><span class="sxs-lookup"><span data-stu-id="6be8d-128">If you open this file in Visual Studio 2010, you can see the different deployment options that are available to you:</span></span>

- <span data-ttu-id="6be8d-129">**Intercalación**de la comparación de implementación.</span><span class="sxs-lookup"><span data-stu-id="6be8d-129">**Deployment comparison collation**.</span></span> <span data-ttu-id="6be8d-130">Esto le permite elegir si desea usar la intercalación de base de datos del proyecto (la intercalación de *origen* ) o la intercalación de base de datos del servidor de destino (la intercalación de *destino* ).</span><span class="sxs-lookup"><span data-stu-id="6be8d-130">This lets you choose whether to use the database collation of your project (the *source* collation) or the database collation of your destination server (the *target* collation).</span></span> <span data-ttu-id="6be8d-131">En la mayoría de los casos, querrá usar la intercalación de origen al realizar la implementación en un entorno de desarrollo o de prueba.</span><span class="sxs-lookup"><span data-stu-id="6be8d-131">In most cases, you'll want to use the source collation when you deploy to a development or test environment.</span></span> <span data-ttu-id="6be8d-132">Al realizar la implementación en un entorno de ensayo o de producción, normalmente querrá dejar la intercalación de destino sin cambios para evitar problemas de interoperabilidad.</span><span class="sxs-lookup"><span data-stu-id="6be8d-132">When you deploy to a staging or production environment, you'll usually want to leave the target collation unchanged to avoid any interoperability issues.</span></span>
- <span data-ttu-id="6be8d-133">**Implementar propiedades de base de datos**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-133">**Deploy database properties**.</span></span> <span data-ttu-id="6be8d-134">Esto le permite elegir si desea aplicar las propiedades de la base de datos, tal y como se define en el archivo *Database. sqlsettings* .</span><span class="sxs-lookup"><span data-stu-id="6be8d-134">This lets you choose whether to apply the database properties, as defined in the *Database.sqlsettings* file.</span></span> <span data-ttu-id="6be8d-135">Cuando implemente una base de datos por primera vez, debe implementar las propiedades de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-135">When you deploy a database for the first time, you should deploy the database properties.</span></span> <span data-ttu-id="6be8d-136">Si está actualizando una base de datos existente, las propiedades ya deben estar en su lugar y no debe volver a implementarlas.</span><span class="sxs-lookup"><span data-stu-id="6be8d-136">If you're updating an existing database, the properties should already be in place, and you shouldn't need to deploy them again.</span></span>
- <span data-ttu-id="6be8d-137">**Vuelva a crear siempre la base de datos**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-137">**Always re-create database**.</span></span> <span data-ttu-id="6be8d-138">Esto le permite elegir si desea volver a crear la base de datos de destino cada vez que implemente o realice cambios incrementales para poner la base de datos de destino al día con el esquema.</span><span class="sxs-lookup"><span data-stu-id="6be8d-138">This lets you choose whether to re-create the target database every time you deploy or make incremental changes to bring the target database up to date with your schema.</span></span> <span data-ttu-id="6be8d-139">Si vuelve a crear la base de datos, perderá los datos de la base de datos existente.</span><span class="sxs-lookup"><span data-stu-id="6be8d-139">If you re-create the database, you'll lose any data in the existing database.</span></span> <span data-ttu-id="6be8d-140">Por lo tanto, normalmente debe establecer este valor en **false** para las implementaciones en entornos de ensayo o de producción.</span><span class="sxs-lookup"><span data-stu-id="6be8d-140">As such, you should usually set this to **false** for deployments to staging or production environments.</span></span>
- <span data-ttu-id="6be8d-141">**Bloquear la implementación incremental si puede producirse la pérdida de datos**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-141">**Block incremental deployment if data loss might occur**.</span></span> <span data-ttu-id="6be8d-142">Esto le permite elegir si la implementación debe detenerse si un cambio en el esquema de la base de datos provocará la pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-142">This lets you choose whether deployment should stop if a change to the database schema will cause the loss of data.</span></span> <span data-ttu-id="6be8d-143">Normalmente, se establece en **true** para una implementación en un entorno de producción, para ofrecer la oportunidad de intervenir y proteger los datos importantes.</span><span class="sxs-lookup"><span data-stu-id="6be8d-143">You typically set this to **true** for a deployment to a production environment, to give you the opportunity to intervene and protect any important data.</span></span> <span data-ttu-id="6be8d-144">Si ha establecido **volver a crear siempre la base de datos** en **false**, esta configuración no tendrá ningún efecto.</span><span class="sxs-lookup"><span data-stu-id="6be8d-144">If you have set **Always re-create database** to **false**, this setting will have no effect.</span></span>
- <span data-ttu-id="6be8d-145">**Ejecutar la implementación en modo de usuario único**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-145">**Execute deployment in single-user mode**.</span></span> <span data-ttu-id="6be8d-146">Esto no suele ser un problema en los entornos de desarrollo o pruebas.</span><span class="sxs-lookup"><span data-stu-id="6be8d-146">This is not usually an issue in development or test environments.</span></span> <span data-ttu-id="6be8d-147">Sin embargo, normalmente debería establecerlo en **true** para las implementaciones en entornos de ensayo o de producción.</span><span class="sxs-lookup"><span data-stu-id="6be8d-147">However, you should typically set this to **true** for deployments to staging or production environments.</span></span> <span data-ttu-id="6be8d-148">Esto impide que los usuarios realicen cambios en la base de datos mientras se está llevando a cabo la implementación.</span><span class="sxs-lookup"><span data-stu-id="6be8d-148">This prevents users from making changes to the database while the deployment is underway.</span></span>
- <span data-ttu-id="6be8d-149">**Copia de seguridad de la base de datos antes de la implementación**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-149">**Back up database before deployment**.</span></span> <span data-ttu-id="6be8d-150">Normalmente, se establece en **true** cuando se implementa en un entorno de producción, como precaución contra la pérdida de datos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-150">You typically set this to **true** when you deploy to a production environment, as a precaution against data loss.</span></span> <span data-ttu-id="6be8d-151">También puede establecerlo en **true** al realizar la implementación en un entorno de ensayo, si la base de datos provisional contiene muchos datos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-151">You may also want to set it to **true** when you deploy to a staging environment, if your staging database contains a lot of data.</span></span>
- <span data-ttu-id="6be8d-152">**Generar instrucciones Drop para objetos que se encuentran en la base de datos de destino, pero que no están en el proyecto de base de datos**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-152">**Generate DROP statements for objects that are in the target database but that are not in the database project**.</span></span> <span data-ttu-id="6be8d-153">En la mayoría de los casos, se trata de una parte integral y esencial de realizar cambios incrementales en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-153">In most cases, this is an integral and essential part of making incremental changes to a database.</span></span> <span data-ttu-id="6be8d-154">Si ha establecido **volver a crear siempre la base de datos** en **false**, esta configuración no tendrá ningún efecto.</span><span class="sxs-lookup"><span data-stu-id="6be8d-154">If you have set **Always re-create database** to **false**, this setting will have no effect.</span></span>
- <span data-ttu-id="6be8d-155">**No utilice instrucciones Alter Assembly para actualizar tipos CLR**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-155">**Do not use ALTER ASSEMBLY statements to update CLR types**.</span></span> <span data-ttu-id="6be8d-156">Esta configuración determina el modo en que SQL Server debe actualizar los tipos de Common Language Runtime (CLR) a las versiones de ensamblado más recientes.</span><span class="sxs-lookup"><span data-stu-id="6be8d-156">This setting determines how SQL Server should update common language runtime (CLR) types to newer assembly versions.</span></span> <span data-ttu-id="6be8d-157">Debe establecerse en **false** en la mayoría de los escenarios.</span><span class="sxs-lookup"><span data-stu-id="6be8d-157">This should be set to **false** in most scenarios.</span></span>

<span data-ttu-id="6be8d-158">En esta tabla se muestra la configuración típica de implementación para distintos entornos de destino.</span><span class="sxs-lookup"><span data-stu-id="6be8d-158">This table shows typical deployment settings for different destination environments.</span></span> <span data-ttu-id="6be8d-159">Sin embargo, la configuración puede variar en función de los requisitos exactos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-159">However, your settings may be different depending on your exact requirements.</span></span>

|  | <span data-ttu-id="6be8d-160">Desarrollador/prueba</span><span class="sxs-lookup"><span data-stu-id="6be8d-160">Developer/Test</span></span> | <span data-ttu-id="6be8d-161">Almacenamiento provisional/integración</span><span class="sxs-lookup"><span data-stu-id="6be8d-161">Staging/Integration</span></span> | <span data-ttu-id="6be8d-162">Producción</span><span class="sxs-lookup"><span data-stu-id="6be8d-162">Production</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="6be8d-163">**Intercalación de comparación de implementación**</span><span class="sxs-lookup"><span data-stu-id="6be8d-163">**Deployment comparison collation**</span></span> | <span data-ttu-id="6be8d-164">Origen</span><span class="sxs-lookup"><span data-stu-id="6be8d-164">Source</span></span> | <span data-ttu-id="6be8d-165">Destino</span><span class="sxs-lookup"><span data-stu-id="6be8d-165">Target</span></span> | <span data-ttu-id="6be8d-166">Destino</span><span class="sxs-lookup"><span data-stu-id="6be8d-166">Target</span></span> |
| <span data-ttu-id="6be8d-167">**Implementar propiedades de base de datos**</span><span class="sxs-lookup"><span data-stu-id="6be8d-167">**Deploy database properties**</span></span> | <span data-ttu-id="6be8d-168">True</span><span class="sxs-lookup"><span data-stu-id="6be8d-168">True</span></span> | <span data-ttu-id="6be8d-169">Solo la primera vez</span><span class="sxs-lookup"><span data-stu-id="6be8d-169">First time only</span></span> | <span data-ttu-id="6be8d-170">Solo la primera vez</span><span class="sxs-lookup"><span data-stu-id="6be8d-170">First time only</span></span> |
| <span data-ttu-id="6be8d-171">**Volver a crear siempre la base de datos**</span><span class="sxs-lookup"><span data-stu-id="6be8d-171">**Always re-create database**</span></span> | <span data-ttu-id="6be8d-172">True</span><span class="sxs-lookup"><span data-stu-id="6be8d-172">True</span></span> | <span data-ttu-id="6be8d-173">False</span><span class="sxs-lookup"><span data-stu-id="6be8d-173">False</span></span> | <span data-ttu-id="6be8d-174">False</span><span class="sxs-lookup"><span data-stu-id="6be8d-174">False</span></span> |
| <span data-ttu-id="6be8d-175">**Bloquear la implementación incremental si se pueden perder datos**</span><span class="sxs-lookup"><span data-stu-id="6be8d-175">**Block incremental deployment if data loss might occur**</span></span> | <span data-ttu-id="6be8d-176">False</span><span class="sxs-lookup"><span data-stu-id="6be8d-176">False</span></span> | <span data-ttu-id="6be8d-177">Es posible</span><span class="sxs-lookup"><span data-stu-id="6be8d-177">Maybe</span></span> | <span data-ttu-id="6be8d-178">True</span><span class="sxs-lookup"><span data-stu-id="6be8d-178">True</span></span> |
| <span data-ttu-id="6be8d-179">**Ejecutar script de implementación en modo de usuario único**</span><span class="sxs-lookup"><span data-stu-id="6be8d-179">**Execute deployment script in single-user mode**</span></span> | <span data-ttu-id="6be8d-180">False</span><span class="sxs-lookup"><span data-stu-id="6be8d-180">False</span></span> | <span data-ttu-id="6be8d-181">True</span><span class="sxs-lookup"><span data-stu-id="6be8d-181">True</span></span> | <span data-ttu-id="6be8d-182">True</span><span class="sxs-lookup"><span data-stu-id="6be8d-182">True</span></span> |
| <span data-ttu-id="6be8d-183">**Copia de seguridad de base de datos antes de la implementación**</span><span class="sxs-lookup"><span data-stu-id="6be8d-183">**Back up database before deployment**</span></span> | <span data-ttu-id="6be8d-184">False</span><span class="sxs-lookup"><span data-stu-id="6be8d-184">False</span></span> | <span data-ttu-id="6be8d-185">Es posible</span><span class="sxs-lookup"><span data-stu-id="6be8d-185">Maybe</span></span> | <span data-ttu-id="6be8d-186">True</span><span class="sxs-lookup"><span data-stu-id="6be8d-186">True</span></span> |
| <span data-ttu-id="6be8d-187">**Generar instrucciones DROP para objetos que se encuentran en la base de datos de destino pero que no están en el proyecto de base de datos**</span><span class="sxs-lookup"><span data-stu-id="6be8d-187">**Generate DROP statements for objects that are in the target database but that are not in the database project**</span></span> | <span data-ttu-id="6be8d-188">False</span><span class="sxs-lookup"><span data-stu-id="6be8d-188">False</span></span> | <span data-ttu-id="6be8d-189">True</span><span class="sxs-lookup"><span data-stu-id="6be8d-189">True</span></span> | <span data-ttu-id="6be8d-190">True</span><span class="sxs-lookup"><span data-stu-id="6be8d-190">True</span></span> |
| <span data-ttu-id="6be8d-191">**No usar instrucciones ALTER ASSEMBLy para actualizar tipos CLR**</span><span class="sxs-lookup"><span data-stu-id="6be8d-191">**Do not use ALTER ASSEMBLY statements to update CLR types**</span></span> | <span data-ttu-id="6be8d-192">False</span><span class="sxs-lookup"><span data-stu-id="6be8d-192">False</span></span> | <span data-ttu-id="6be8d-193">False</span><span class="sxs-lookup"><span data-stu-id="6be8d-193">False</span></span> | <span data-ttu-id="6be8d-194">False</span><span class="sxs-lookup"><span data-stu-id="6be8d-194">False</span></span> |

> [!NOTE]
> <span data-ttu-id="6be8d-195">Para obtener más información sobre las propiedades de implementación de bases de datos y consideraciones de entorno, vea [información general sobre la configuración del proyecto de base de](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx)datos, [Cómo: configurar propiedades para detalles de implementación](https://msdn.microsoft.com/library/dd172125.aspx), [generar e implementar una base de datos en un entorno de desarrollo aislado](https://msdn.microsoft.com/library/dd193409.aspx)y [compilar e implementar bases de datos en un entorno de ensayo o de producción](https://msdn.microsoft.com/library/dd193413.aspx).</span><span class="sxs-lookup"><span data-stu-id="6be8d-195">For more information on database deployment properties and environment considerations, see [An Overview of Database Project Settings](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx), [How to: Configure Properties for Deployment Details](https://msdn.microsoft.com/library/dd172125.aspx), [Build and Deploy Database to an Isolated Development Environment](https://msdn.microsoft.com/library/dd193409.aspx), and [Build and Deploy Databases to a Staging or Production Environment](https://msdn.microsoft.com/library/dd193413.aspx).</span></span>

<span data-ttu-id="6be8d-196">Para admitir la implementación de un proyecto de base de datos en varios destinos, debe crear un archivo de configuración de implementación para cada entorno de destino.</span><span class="sxs-lookup"><span data-stu-id="6be8d-196">To support the deployment of a database project to multiple destinations, you should create a deployment configuration file for each target environment.</span></span>

<span data-ttu-id="6be8d-197">**Para crear un archivo de configuración específico del entorno**</span><span class="sxs-lookup"><span data-stu-id="6be8d-197">**To create an environment-specific configuration file**</span></span>

1. <span data-ttu-id="6be8d-198">En Visual Studio 2010, en la ventana de **Explorador de soluciones** , haga clic con el botón secundario en el proyecto de base de datos y, a continuación, haga clic en **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-198">In Visual Studio 2010, in the **Solution Explorer** window, right-click your database project, and then click **Properties**.</span></span>
2. <span data-ttu-id="6be8d-199">En la página Propiedades del proyecto de base de datos, en la pestaña **implementar** , en la fila **archivo de configuración de implementación** , haga clic en **nuevo**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-199">On the database project properties page, on the **Deploy** tab, in the **Deployment configuration file** row, click **New**.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image1.png)
3. <span data-ttu-id="6be8d-200">En el cuadro de diálogo **nuevo archivo de configuración de implementación** , asigne al archivo un nombre descriptivo (por ejemplo, **TestEnvironment. sqldeployment**) y, a continuación, haga clic en **Guardar**.</span><span class="sxs-lookup"><span data-stu-id="6be8d-200">In the **New Deployment Configuration File** dialog box, give the file a meaningful name (for example, **TestEnvironment.sqldeployment**), and then click **Save**.</span></span>
4. <span data-ttu-id="6be8d-201">En la página \*[FILENAME] \* \*. sqldeployment\*\*, establezca las propiedades de implementación para que coincidan con los requisitos de su entorno de destino y, a continuación, guarde el archivo.</span><span class="sxs-lookup"><span data-stu-id="6be8d-201">On the *[Filename]\*\*\*.sqldeployment*\* page, set the deployment properties to match the requirements of your destination environment, and then save the file.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image2.png)
5. <span data-ttu-id="6be8d-202">Tenga en cuenta que el nuevo archivo se agrega a la carpeta Propiedades del proyecto de base de datos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-202">Notice that the new file is added to the Properties folder in your database project.</span></span>

    ![](customizing-database-deployments-for-multiple-environments/_static/image3.png)

## <a name="specifying-the-deployment-configuration-file-in-vsdbcmd"></a><span data-ttu-id="6be8d-203">Especificar el archivo de configuración de implementación en VSDBCMD</span><span class="sxs-lookup"><span data-stu-id="6be8d-203">Specifying the Deployment Configuration File in VSDBCMD</span></span>

<span data-ttu-id="6be8d-204">Al usar configuraciones de soluciones (como depuración y lanzamiento) en Visual Studio 2010, puede asociar un archivo de configuración de implementación con cada configuración.</span><span class="sxs-lookup"><span data-stu-id="6be8d-204">When you use solution configurations (like Debug and Release) within Visual Studio 2010, you can associate a deployment configuration file with each configuration.</span></span> <span data-ttu-id="6be8d-205">Al compilar una configuración determinada, el proceso de compilación genera un archivo de manifiesto de implementación específico de la configuración que apunta al archivo de configuración de implementación específico de la configuración.</span><span class="sxs-lookup"><span data-stu-id="6be8d-205">When you build a particular configuration, the build process generates a configuration-specific deployment manifest file that points to the configuration-specific deployment configuration file.</span></span> <span data-ttu-id="6be8d-206">Sin embargo, uno de los principales objetivos del enfoque de implementación que se describe en estos tutoriales es proporcionar a los usuarios la capacidad de controlar el proceso de implementación sin usar Visual Studio 2010 y configuraciones de soluciones.</span><span class="sxs-lookup"><span data-stu-id="6be8d-206">However, one of the main aims of the approach to deployment described in these tutorials is to give people the ability to control the deployment process without using Visual Studio 2010 and solution configurations.</span></span> <span data-ttu-id="6be8d-207">En este enfoque, la configuración de la solución es la misma independientemente del entorno de implementación de destino.</span><span class="sxs-lookup"><span data-stu-id="6be8d-207">In this approach, the solution configuration is the same regardless of the target deployment environment.</span></span> <span data-ttu-id="6be8d-208">Para personalizar la implementación de la base de datos en un entorno de destino específico, puede usar las opciones de línea de comandos de VSDBCMD para especificar el archivo de configuración de implementación.</span><span class="sxs-lookup"><span data-stu-id="6be8d-208">To tailor your database deployment to a specific destination environment, you can use the VSDBCMD command-line options to specify your deployment configuration file.</span></span>

<span data-ttu-id="6be8d-209">Para especificar un archivo de configuración de implementación en VSDBCMD, use el modificador **p:/DeploymentConfigurationFile** y proporcione la ruta de acceso completa al archivo.</span><span class="sxs-lookup"><span data-stu-id="6be8d-209">To specify a deployment configuration file in your VSDBCMD, use the **p:/DeploymentConfigurationFile** switch and provide the full path to your file.</span></span> <span data-ttu-id="6be8d-210">Esto invalidará el archivo de configuración de implementación que identifica el manifiesto de implementación.</span><span class="sxs-lookup"><span data-stu-id="6be8d-210">This will override the deployment configuration file that the deployment manifest identifies.</span></span> <span data-ttu-id="6be8d-211">Por ejemplo, podría usar este comando de VSDBCMD para implementar la base de datos **ContactManager** en un entorno de prueba:</span><span class="sxs-lookup"><span data-stu-id="6be8d-211">For example, you could use this VSDBCMD command to deploy the **ContactManager** database to a test environment:</span></span>

[!code-console[Main](customizing-database-deployments-for-multiple-environments/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="6be8d-212">Tenga en cuenta que el proceso de compilación puede cambiar el nombre del archivo. sqldeployment cuando copia el archivo en el directorio de salida.</span><span class="sxs-lookup"><span data-stu-id="6be8d-212">Note that the build process may rename your .sqldeployment file when it copies the file to the output directory.</span></span>

<span data-ttu-id="6be8d-213">Si usa variables de comandos SQL en los scripts SQL anteriores o posteriores a la implementación, puede usar un enfoque similar para asociar un archivo. sqlcmdvars específico del entorno a la implementación.</span><span class="sxs-lookup"><span data-stu-id="6be8d-213">If you use SQL command variables in your pre-deployment or post-deployment SQL scripts, you can use a similar approach to associate an environment-specific .sqlcmdvars file with your deployment.</span></span> <span data-ttu-id="6be8d-214">En este caso, se usa el modificador **p:/SqlCommandVariablesFile** para identificar el archivo. sqlcmdvars.</span><span class="sxs-lookup"><span data-stu-id="6be8d-214">In this case, you use the **p:/SqlCommandVariablesFile** switch to identify your .sqlcmdvars file.</span></span>

## <a name="running-the-vsdbcmd-command-from-an-msbuild-project-file"></a><span data-ttu-id="6be8d-215">Ejecutar el comando VSDBCMD desde un archivo de proyecto de MSBuild</span><span class="sxs-lookup"><span data-stu-id="6be8d-215">Running the VSDBCMD Command from an MSBuild Project File</span></span>

<span data-ttu-id="6be8d-216">Puede invocar un comando de VSDBCMD desde un archivo de proyecto de MSBuild mediante una tarea **exec** dentro de un destino de MSBuild.</span><span class="sxs-lookup"><span data-stu-id="6be8d-216">You can invoke a VSDBCMD command from an MSBuild project file by using an **Exec** task within an MSBuild target.</span></span> <span data-ttu-id="6be8d-217">En su forma más sencilla, tendría el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="6be8d-217">In its simplest form, it would look like this:</span></span>

[!code-xml[Main](customizing-database-deployments-for-multiple-environments/samples/sample2.xml)]

- <span data-ttu-id="6be8d-218">En la práctica, para facilitar la lectura y la reutilización de los archivos de proyecto, querrá crear propiedades para almacenar los distintos parámetros de la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-218">In practice, to make your project files easy to read and reuse, you'll want to create properties to store the various command-line parameters.</span></span> <span data-ttu-id="6be8d-219">Esto facilita a los usuarios proporcionar valores de propiedad en un archivo de proyecto específico del entorno o reemplazar los valores predeterminados de la línea de comandos de MSBuild.</span><span class="sxs-lookup"><span data-stu-id="6be8d-219">This makes it easier for users to provide property values in an environment-specific project file or to override default values from the MSBuild command line.</span></span> <span data-ttu-id="6be8d-220">Si usa el enfoque de archivo de proyecto dividido descrito en [Descripción del archivo de proyecto](../web-deployment-in-the-enterprise/understanding-the-project-file.md), debe dividir las instrucciones de compilación y las propiedades entre los dos archivos según corresponda:</span><span class="sxs-lookup"><span data-stu-id="6be8d-220">If you use the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), you should divide your build instructions and properties between the two files accordingly:</span></span>
- <span data-ttu-id="6be8d-221">La configuración específica del entorno, como el nombre de archivo de configuración de implementación, la cadena de conexión de base de datos y el nombre de la base de datos de destino, debe ir en el archivo de proyecto específico del entorno.</span><span class="sxs-lookup"><span data-stu-id="6be8d-221">Environment-specific settings, like the deployment configuration filename, the database connection string, and the target database name, should go in the environment-specific project file.</span></span>
- <span data-ttu-id="6be8d-222">El destino de MSBuild que ejecuta el comando VSDBCMD, junto con cualquier propiedad universal como la ubicación del ejecutable de VSDBCMD, debe ir en el archivo de proyecto universal.</span><span class="sxs-lookup"><span data-stu-id="6be8d-222">The MSBuild target that runs the VSDBCMD command, together with any universal properties like the location of the VSDBCMD executable, should go in the universal project file.</span></span>

<span data-ttu-id="6be8d-223">También debe asegurarse de que compila el proyecto de base de datos antes de invocar a VSDBCMD para que se cree el archivo. DeployManifest y esté listo para usarse.</span><span class="sxs-lookup"><span data-stu-id="6be8d-223">You should also ensure that you build the database project before you invoke VSDBCMD so that the .deploymanifest file is created and ready to use.</span></span> <span data-ttu-id="6be8d-224">Puede ver un ejemplo completo de este enfoque en el tema [Descripción del proceso de compilación](../web-deployment-in-the-enterprise/understanding-the-build-process.md), que le guía por los archivos de proyecto de la [solución de ejemplo Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md).</span><span class="sxs-lookup"><span data-stu-id="6be8d-224">You can see a full example of this approach in the topic [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), which walks you through the project files in the [Contact Manager sample solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="6be8d-225">Conclusión</span><span class="sxs-lookup"><span data-stu-id="6be8d-225">Conclusion</span></span>

<span data-ttu-id="6be8d-226">En este tema se describe cómo se pueden adaptar las propiedades de base de datos a diferentes entornos de destino cuando se implementan proyectos de base de datos con MSBuild y VSDBCMD.</span><span class="sxs-lookup"><span data-stu-id="6be8d-226">This topic described how you can tailor database properties to different destination environments when you deploy database projects using MSBuild and VSDBCMD.</span></span> <span data-ttu-id="6be8d-227">Este enfoque es útil cuando se necesita implementar proyectos de base de datos como parte de soluciones de escala empresarial más grandes.</span><span class="sxs-lookup"><span data-stu-id="6be8d-227">This approach is useful when you need to deploy database projects as part of larger, enterprise-scale solutions.</span></span> <span data-ttu-id="6be8d-228">Estas soluciones se suelen implementar en varios destinos, como entornos de desarrollo o pruebas en espacio aislado, plataformas de ensayo o integración, y entornos de producción o en vivo.</span><span class="sxs-lookup"><span data-stu-id="6be8d-228">These solutions are often deployed to multiple destinations, like sandboxed development or test environments, staging or integration platforms, and production or live environments.</span></span> <span data-ttu-id="6be8d-229">Cada uno de estos entornos de destino normalmente requiere un conjunto único de propiedades de implementación de base de datos.</span><span class="sxs-lookup"><span data-stu-id="6be8d-229">Each of these target environments typically requires a unique set of database deployment properties.</span></span>

## <a name="further-reading"></a><span data-ttu-id="6be8d-230">Información adicional</span><span class="sxs-lookup"><span data-stu-id="6be8d-230">Further Reading</span></span>

<span data-ttu-id="6be8d-231">Para obtener más información sobre la implementación de proyectos de base de datos mediante VSDBCMD. exe, vea [implementar proyectos de base de datos](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span><span class="sxs-lookup"><span data-stu-id="6be8d-231">For more information on deploying database projects using VSDBCMD.exe, see [Deploying Database Projects](../web-deployment-in-the-enterprise/deploying-database-projects.md).</span></span> <span data-ttu-id="6be8d-232">Para obtener más información sobre el uso de archivos de proyecto de MSBuild personalizados para controlar el proceso de implementación, vea [Descripción del archivo de proyecto](../web-deployment-in-the-enterprise/understanding-the-project-file.md) y [Descripción del proceso de compilación](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="6be8d-232">For more information on using custom MSBuild project files to control the deployment process, see [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md) and [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>

<span data-ttu-id="6be8d-233">En estos artículos de MSDN se proporcionan más instrucciones generales sobre la implementación de bases de datos:</span><span class="sxs-lookup"><span data-stu-id="6be8d-233">These articles on MSDN provide more general guidance on database deployment:</span></span>

- <span data-ttu-id="6be8d-234">[Información general sobre la configuración del proyecto de base de datos](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="6be8d-234">[An Overview of Database Project Settings](https://msdn.microsoft.com/library/aa833291(v=VS.100).aspx)</span></span>
- [<span data-ttu-id="6be8d-235">Cómo: configurar propiedades para los detalles de la implementación</span><span class="sxs-lookup"><span data-stu-id="6be8d-235">How to: Configure Properties for Deployment Details</span></span>](https://msdn.microsoft.com/library/dd172125.aspx)
- [<span data-ttu-id="6be8d-236">Crear e implementar bases de datos en un entorno de desarrollo aislado</span><span class="sxs-lookup"><span data-stu-id="6be8d-236">Build and Deploy Databases to an Isolated Development Environment</span></span>](https://msdn.microsoft.com/library/dd193409.aspx)
- [<span data-ttu-id="6be8d-237">Crear e implementar bases de datos en un entorno de ensayo o de producción</span><span class="sxs-lookup"><span data-stu-id="6be8d-237">Build and Deploy Databases to a Staging or Production Environment</span></span>](https://msdn.microsoft.com/library/dd193413.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="6be8d-238">[Anterior](performing-a-what-if-deployment.md)
> [Siguiente](deploying-database-role-memberships-to-test-environments.md)</span><span class="sxs-lookup"><span data-stu-id="6be8d-238">[Previous](performing-a-what-if-deployment.md)
[Next](deploying-database-role-memberships-to-test-environments.md)</span></span>

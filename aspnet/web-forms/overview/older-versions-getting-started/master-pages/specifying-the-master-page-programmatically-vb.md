---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
title: Especificar la página maestra mediante programación (VB) | Microsoft Docs
author: rick-anderson
description: Examina la configuración de la página maestra de la página de contenido mediante programación a través del controlador de eventos PreInit.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 0edcd653-f24a-41aa-aef4-75f868fe5ac2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
msc.type: authoredcontent
ms.openlocfilehash: 3b039b22bef38ae6ebf80be070820dc1638f87f4
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/28/2019
ms.locfileid: "74618645"
---
# <a name="specifying-the-master-page-programmatically-vb"></a><span data-ttu-id="ae5a4-103">Especificar la página maestra mediante programación (VB)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-103">Specifying the Master Page Programmatically (VB)</span></span>

<span data-ttu-id="ae5a4-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ae5a4-105">[Descargar código](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) o [Descargar PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span></span>

> <span data-ttu-id="ae5a4-106">Examina la configuración de la página maestra de la página de contenido mediante programación a través del controlador de eventos PreInit.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-106">Looks at setting the content page's master page programmatically via the PreInit event handler.</span></span>

## <a name="introduction"></a><span data-ttu-id="ae5a4-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="ae5a4-107">Introduction</span></span>

<span data-ttu-id="ae5a4-108">Como en el ejemplo inaugural de la [*creación de un diseño de todo el sitio mediante páginas maestras*](creating-a-site-wide-layout-using-master-pages-vb.md), todas las páginas de contenido hacían referencia a la página maestra mediante declaración a través del atributo `MasterPageFile` en la Directiva `@Page`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-108">Since the inaugural example in [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md), all content pages have referenced their master page declaratively via the `MasterPageFile` attribute in the `@Page` directive.</span></span> <span data-ttu-id="ae5a4-109">Por ejemplo, la siguiente directiva de `@Page` vincula la página de contenido a la página maestra `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-109">For example, the following `@Page` directive links the content page to the master page `Site.master`:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample1.aspx)]

<span data-ttu-id="ae5a4-110">La [clase`Page`](https://msdn.microsoft.com/library/system.web.ui.page.aspx) del espacio de nombres `System.Web.UI` incluye una [propiedad`MasterPageFile`](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) que devuelve la ruta de acceso a la página maestra de la página de contenido; Esta propiedad se establece mediante la Directiva `@Page`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-110">The [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx) in the `System.Web.UI` namespace includes a [`MasterPageFile` property](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) that returns the path to the content page's master page; it is this property that is set by the `@Page` directive.</span></span> <span data-ttu-id="ae5a4-111">Esta propiedad también se puede usar para especificar mediante programación la página maestra de la página de contenido.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-111">This property can also be used to programmatically specify the content page's master page.</span></span> <span data-ttu-id="ae5a4-112">Este enfoque es útil si desea asignar dinámicamente la página maestra en función de factores externos, como el usuario que visita la página.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-112">This approach is useful if you want to dynamically assign the master page based on external factors, such as the user visiting the page.</span></span>

<span data-ttu-id="ae5a4-113">En este tutorial se agregará una segunda página maestra a nuestro sitio web y se decidirá dinámicamente qué página maestra se va a usar en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-113">In this tutorial we add a second master page to our website and dynamically decide which master page to use at runtime.</span></span>

## <a name="step-1-a-look-at-the-page-lifecycle"></a><span data-ttu-id="ae5a4-114">Paso 1: echar un vistazo al ciclo de vida de la página</span><span class="sxs-lookup"><span data-stu-id="ae5a4-114">Step 1: A Look at the Page Lifecycle</span></span>

<span data-ttu-id="ae5a4-115">Siempre que una solicitud llega al servidor web para una página de ASP.NET que es una página de contenido, el motor de ASP.NET debe confundir los controles de contenido de la página en los controles ContentPlaceHolder correspondientes de la página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-115">Whenever a request arrives at the web server for an ASP.NET page that is a content page, the ASP.NET engine must fuse the page's Content controls into the master page's corresponding ContentPlaceHolder controls.</span></span> <span data-ttu-id="ae5a4-116">Esta fusión crea una jerarquía de control única que puede continuar a lo largo del ciclo de vida de la página habitual.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-116">This fusion creates a single control hierarchy that can then proceed through the typical page lifecycle.</span></span>

<span data-ttu-id="ae5a4-117">En la ilustración 1 se muestra esta fusión.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-117">Figure 1 illustrates this fusion.</span></span> <span data-ttu-id="ae5a4-118">En el paso 1 de la figura 1 se muestran las jerarquías de control de contenido inicial y página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-118">Step 1 in Figure 1 shows the initial content and master page control hierarchies.</span></span> <span data-ttu-id="ae5a4-119">En el final de la fase de preinicialización, los controles de contenido de la página se agregan al ContentPlaceHolders correspondiente en la página maestra (paso 2).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-119">At the tail end of the PreInit stage the Content controls in the page are added to the corresponding ContentPlaceHolders in the master page (Step 2).</span></span> <span data-ttu-id="ae5a4-120">Después de esta fusión, la página maestra actúa como la raíz de la jerarquía de controles fusionados.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-120">After this fusion, the master page serves as the root of the fused control hierarchy.</span></span> <span data-ttu-id="ae5a4-121">A continuación, esta jerarquía de control fusionada se agrega a la página para generar la jerarquía de controles finalizada (paso 3).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-121">This fused control hierarchy is then added to the page to produce the finalized control hierarchy (Step 3).</span></span> <span data-ttu-id="ae5a4-122">El resultado neto es que la jerarquía de control de la página incluye la jerarquía de controles fusionados.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-122">The net result is that the page's control hierarchy includes the fused control hierarchy.</span></span>

<span data-ttu-id="ae5a4-123">[![la página maestra y las jerarquías de control de la página de contenido se fusionan en conjunto durante la fase de PreInit](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-123">[![The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span></span>

<span data-ttu-id="ae5a4-124">**Figura 01**: la página maestra y las jerarquías de control de la página de contenido se fusionan conjuntamente durante la fase de PreInit ([haga clic para ver la imagen de tamaño completo](specifying-the-master-page-programmatically-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ae5a4-124">**Figure 01**: The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image3.png))</span></span>

## <a name="step-2-setting-themasterpagefileproperty-from-code"></a><span data-ttu-id="ae5a4-125">Paso 2: establecer la propiedad`MasterPageFile`desde el código</span><span class="sxs-lookup"><span data-stu-id="ae5a4-125">Step 2: Setting the`MasterPageFile`Property from Code</span></span>

<span data-ttu-id="ae5a4-126">La partakes de la página maestra de esta fusión depende del valor de la propiedad `MasterPageFile` del objeto `Page`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-126">What master page partakes in this fusion depends on the value of the `Page` object's `MasterPageFile` property.</span></span> <span data-ttu-id="ae5a4-127">Establecer el atributo `MasterPageFile` en la Directiva `@Page` tiene el efecto neto de asignar la propiedad `MasterPageFile` del `Page`durante la fase de inicialización, que es la primera fase del ciclo de vida de la página.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-127">Setting the `MasterPageFile` attribute in the `@Page` directive has the net effect of assigning the `Page`'s `MasterPageFile` property during the Initialization stage, which is the very first stage of the page's lifecycle.</span></span> <span data-ttu-id="ae5a4-128">También podemos establecer esta propiedad mediante programación.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-128">We can alternatively set this property programmatically.</span></span> <span data-ttu-id="ae5a4-129">Sin embargo, es imperativo que esta propiedad se establezca antes de que tenga lugar la fusión de la figura 1.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-129">However, it is imperative that this property be set before the fusion in Figure 1 takes place.</span></span>

<span data-ttu-id="ae5a4-130">Al principio de la fase de PreInit, el objeto `Page` genera su [evento`PreInit`](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) y llama a su [método`OnPreInit`](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-130">At the start of the PreInit stage the `Page` object raises its [`PreInit` event](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) and calls its [`OnPreInit` method](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span></span> <span data-ttu-id="ae5a4-131">Para establecer la página maestra mediante programación, podemos crear un controlador de eventos para el evento `PreInit` o invalidar el método `OnPreInit`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-131">To set the master page programmatically, then, we can either create an event handler for the `PreInit` event or override the `OnPreInit` method.</span></span> <span data-ttu-id="ae5a4-132">Echemos un vistazo a ambos enfoques.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-132">Let's look at both approaches.</span></span>

<span data-ttu-id="ae5a4-133">Comience abriendo `Default.aspx.vb`, el archivo de clase de código subyacente para la Página principal de nuestro sitio.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-133">Start by opening `Default.aspx.vb`, the code-behind class file for our site's homepage.</span></span> <span data-ttu-id="ae5a4-134">Agregue un controlador de eventos para el evento de `PreInit` de la página escribiendo en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-134">Add an event handler for the page's `PreInit` event by typing in the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample2.vb)]

<span data-ttu-id="ae5a4-135">Aquí se puede establecer la propiedad `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-135">From here we can set the `MasterPageFile` property.</span></span> <span data-ttu-id="ae5a4-136">Actualice el código para que asigne el valor "~/site.Master" a la propiedad `MasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-136">Update the code so that it assigns the value "~/Site.master" to the `MasterPageFile` property.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample3.vb)]

<span data-ttu-id="ae5a4-137">Si establece un punto de interrupción y comienza con la depuración, verá que cada vez que se visita la página `Default.aspx` o cuando hay un postback en esta página, se ejecuta el controlador de eventos `Page_PreInit` y se asigna la propiedad `MasterPageFile` a "~/site.Master".</span><span class="sxs-lookup"><span data-stu-id="ae5a4-137">If you set a breakpoint and start with debugging you'll see that whenever the `Default.aspx` page is visited or whenever there's a postback to this page, the `Page_PreInit` event handler executes and the `MasterPageFile` property is assigned to "~/Site.master".</span></span>

<span data-ttu-id="ae5a4-138">Como alternativa, puede invalidar el método `OnPreInit` de la clase `Page` y establecer la propiedad `MasterPageFile` aquí.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-138">Alternatively, you can override the `Page` class's `OnPreInit` method and set the `MasterPageFile` property there.</span></span> <span data-ttu-id="ae5a4-139">En este ejemplo, vamos a establecer la página maestra en una página determinada, pero en lugar de `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-139">For this example, let's not set the master page in a particular page, but rather from `BasePage`.</span></span> <span data-ttu-id="ae5a4-140">Recuerde que hemos creado una clase de página base personalizada (`BasePage`) en el tutorial [*especificar el título, las etiquetas meta y otros encabezados HTML en la página maestra*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="ae5a4-140">Recall that we created a custom base page class (`BasePage`) back in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial.</span></span> <span data-ttu-id="ae5a4-141">Actualmente `BasePage` invalida el método `OnLoadComplete` de la clase `Page`, donde establece la propiedad `Title` de la página en función de los datos del mapa del sitio.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-141">Currently `BasePage` overrides the `Page` class's `OnLoadComplete` method, where it sets the page's `Title` property based on the site map data.</span></span> <span data-ttu-id="ae5a4-142">Vamos a actualizar `BasePage` para reemplazar también el método `OnPreInit` con el fin de especificar mediante programación la página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-142">Let's update `BasePage` to also override the `OnPreInit` method to programmatically specify the master page.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample4.vb)]

<span data-ttu-id="ae5a4-143">Dado que todas las páginas de contenido se derivan de `BasePage`, todas tienen ahora su página maestra asignada mediante programación.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-143">Because all our content pages derive from `BasePage`, all of them now have their master page programmatically assigned.</span></span> <span data-ttu-id="ae5a4-144">En este momento, el controlador de eventos `PreInit` de `Default.aspx.vb` es superfluo; no dude en quitarlo.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-144">At this point the `PreInit` event handler in `Default.aspx.vb` is superfluous; feel free to remove it.</span></span>

### <a name="what-about-thepagedirective"></a><span data-ttu-id="ae5a4-145">¿Qué ocurre con la Directiva de`@Page`?</span><span class="sxs-lookup"><span data-stu-id="ae5a4-145">What About the`@Page`Directive?</span></span>

<span data-ttu-id="ae5a4-146">Lo que puede ser un poco confuso es que las propiedades de las páginas de contenido `MasterPageFile` se especifican ahora en dos lugares: mediante programación en el método `OnPreInit` de la clase `BasePage`, así como a través del atributo `MasterPageFile` en la Directiva `@Page` de cada página de contenido.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-146">What may be a little confusing is that the content pages' `MasterPageFile` properties are now being specified in two places: programmatically in the `BasePage` class's `OnPreInit` method as well as through the `MasterPageFile` attribute in each content page's `@Page` directive.</span></span>

<span data-ttu-id="ae5a4-147">La primera fase del ciclo de vida de la página es la fase de inicialización.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-147">The first stage in the page lifecycle is the Initialization stage.</span></span> <span data-ttu-id="ae5a4-148">Durante esta fase, se asigna a la propiedad `MasterPageFile` del objeto `Page` el valor del atributo `MasterPageFile` en la Directiva de `@Page` (si se proporciona).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-148">During this stage the `Page` object's `MasterPageFile` property is assigned the value of the `MasterPageFile` attribute in the `@Page` directive (if it is provided).</span></span> <span data-ttu-id="ae5a4-149">La fase de preinicialización sigue a la fase de inicialización y aquí es donde se establece mediante programación la propiedad `MasterPageFile` del objeto `Page`, con lo que se sobrescribe el valor asignado de la Directiva `@Page`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-149">The PreInit stage follows the Initialization stage, and it is here where we programmatically set the `Page` object's `MasterPageFile` property, thereby overwriting the value assigned from the `@Page` directive.</span></span> <span data-ttu-id="ae5a4-150">Dado que estamos estableciendo la propiedad `MasterPageFile` del objeto `Page` mediante programación, podríamos quitar el atributo `MasterPageFile` de la Directiva `@Page` sin que ello afecte a la experiencia del usuario final.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-150">Because we are setting the `Page` object's `MasterPageFile` property programmatically, we could remove the `MasterPageFile` attribute from the `@Page` directive without affecting the end user's experience.</span></span> <span data-ttu-id="ae5a4-151">Para convencerse, continúe y quite el `MasterPageFile` atributo de la Directiva `@Page` en `Default.aspx` y, a continuación, visite la página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-151">To convince yourself of this, go ahead and remove the `MasterPageFile` attribute from the `@Page` directive in `Default.aspx` and then visit the page through a browser.</span></span> <span data-ttu-id="ae5a4-152">Como cabría esperar, la salida es la misma que antes de que se quitara el atributo.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-152">As you would expect, the output is the same as before the attribute was removed.</span></span>

<span data-ttu-id="ae5a4-153">El hecho de que la propiedad `MasterPageFile` se establezca a través de la Directiva `@Page` o mediante programación es insignificante de la experiencia del usuario final.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-153">Whether the `MasterPageFile` property is set via the `@Page` directive or programmatically is inconsequential to the end user's experience.</span></span> <span data-ttu-id="ae5a4-154">Sin embargo, Visual Studio usa el atributo `MasterPageFile` de la Directiva `@Page` durante el tiempo de diseño para generar la vista WYSIWYG en el diseñador.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-154">However, the `MasterPageFile` attribute in the `@Page` directive is used by Visual Studio during design-time to produce the WYSIWYG view in the Designer.</span></span> <span data-ttu-id="ae5a4-155">Si vuelve a `Default.aspx` en Visual Studio y navega hasta el diseñador, verá el mensaje "error de página maestra: la página tiene controles que requieren una referencia a una página maestra, pero no se especifica ninguno" (vea la figura 2).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-155">If you return to `Default.aspx` in Visual Studio and navigate to the Designer you'll see the message, "Master Page error: The page has controls that require a Master Page reference, but none is specified" (see Figure 2).</span></span>

<span data-ttu-id="ae5a4-156">En Resumen, debe dejar el atributo `MasterPageFile` en la Directiva `@Page` para disfrutar de una experiencia enriquecida en tiempo de diseño en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-156">In short, you need to leave the `MasterPageFile` attribute in the `@Page` directive to enjoy a rich design-time experience in Visual Studio.</span></span>

<span data-ttu-id="ae5a4-157">[![Visual Studio usa el atributo MasterPageFile de la Directiva de @Page para presentar la vista de diseño](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-157">[![Visual Studio Uses the @Page Directive's MasterPageFile Attribute to Render the Design View](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span></span>

<span data-ttu-id="ae5a4-158">**Figura 02**: Visual Studio usa el atributo `MasterPageFile` de la directiva de `@Page` para representar la vista de diseño ([haga clic para ver la imagen de tamaño completo](specifying-the-master-page-programmatically-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ae5a4-158">**Figure 02**: Visual Studio Uses the `@Page` Directive's `MasterPageFile` Attribute to Render the Design View  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image6.png))</span></span>

## <a name="step-3-creating-an-alternative-master-page"></a><span data-ttu-id="ae5a4-159">Paso 3: crear una página maestra alternativa</span><span class="sxs-lookup"><span data-stu-id="ae5a4-159">Step 3: Creating an Alternative Master Page</span></span>

<span data-ttu-id="ae5a4-160">Dado que la página maestra de una página de contenido se puede establecer mediante programación en tiempo de ejecución, es posible cargar dinámicamente una página maestra determinada basándose en algunos criterios externos.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-160">Because a content page's master page can be set programmatically at runtime it's possible to dynamically load a particular master page based on some external criteria.</span></span> <span data-ttu-id="ae5a4-161">Esta funcionalidad puede ser útil en situaciones en las que el diseño del sitio debe variar en función del usuario.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-161">This functionality can be useful in situations where the site's layout needs to vary based on the user.</span></span> <span data-ttu-id="ae5a4-162">Por ejemplo, una aplicación web del motor de blog puede permitir a los usuarios elegir un diseño para su blog, donde cada diseño está asociado a una página maestra diferente.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-162">For instance, a blog engine web application may allow its users to choose a layout for their blog, where each layout is associated with a different master page.</span></span> <span data-ttu-id="ae5a4-163">En tiempo de ejecución, cuando un visitante está viendo el blog de un usuario, la aplicación web necesitaría determinar el diseño del blog y asociar dinámicamente la página maestra correspondiente a la página de contenido.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-163">At runtime, when a visitor is viewing a user's blog, the web application would need to determine the blog's layout and dynamically associate the corresponding master page with the content page.</span></span>

<span data-ttu-id="ae5a4-164">Vamos a examinar cómo cargar dinámicamente una página maestra en tiempo de ejecución en función de algunos criterios externos.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-164">Let's examine how to dynamically load a master page at runtime based on some external criteria.</span></span> <span data-ttu-id="ae5a4-165">Nuestro sitio web contiene una sola página maestra (`Site.master`).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-165">Our website currently contains just one master page (`Site.master`).</span></span> <span data-ttu-id="ae5a4-166">Necesitamos otra página maestra para ilustrar la elección de una página maestra en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-166">We need another master page to illustrate choosing a master page at runtime.</span></span> <span data-ttu-id="ae5a4-167">Este paso se centra en la creación y configuración de la nueva página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-167">This step focuses on creating and configuring the new master page.</span></span> <span data-ttu-id="ae5a4-168">En el paso 4 se examina la determinación de la página maestra que se va a usar en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-168">Step 4 looks at determining what master page to use at runtime.</span></span>

<span data-ttu-id="ae5a4-169">Cree una nueva página maestra en la carpeta raíz denominada `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-169">Create a new master page in the root folder named `Alternate.master`.</span></span> <span data-ttu-id="ae5a4-170">Agregue también una nueva hoja de estilos al sitio web denominado `AlternateStyles.css`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-170">Also add a new style sheet to the website named `AlternateStyles.css`.</span></span>

<span data-ttu-id="ae5a4-171">[![agregar otra página maestra y un archivo CSS al sitio web](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-171">[![Add Another Master Page and CSS File to the Website](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span></span>

<span data-ttu-id="ae5a4-172">**Figura 03**: agregar otra página maestra y un archivo CSS al sitio web ([haga clic para ver la imagen de tamaño completo](specifying-the-master-page-programmatically-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ae5a4-172">**Figure 03**: Add Another Master Page and CSS File to the Website  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image9.png))</span></span>

<span data-ttu-id="ae5a4-173">He diseñado la página maestra de `Alternate.master` para que el título se muestre en la parte superior de la página, centrado y en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-173">I've designed the `Alternate.master` master page to have the title displayed at the top of the page, centered and on a navy background.</span></span> <span data-ttu-id="ae5a4-174">He dispensado de la columna izquierda y he colocado el contenido debajo del `MainContent` control ContentPlaceHolder, que ahora abarca todo el ancho de la página.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-174">I've dispensed of the left column and moved that content beneath the `MainContent` ContentPlaceHolder control, which now spans the entire width of the page.</span></span> <span data-ttu-id="ae5a4-175">Además, nixed la lista de lecciones sin ordenar y la reemplazamos por una lista horizontal arriba `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-175">Furthermore, I nixed the unordered Lessons list and replaced it with a horizontal list above `MainContent`.</span></span> <span data-ttu-id="ae5a4-176">También se actualizaron las fuentes y los colores usados por la página maestra (y, por extensión, sus páginas de contenido).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-176">I also updated the fonts and colors used by the master page (and, by extension, its content pages).</span></span> <span data-ttu-id="ae5a4-177">La figura 4 muestra `Default.aspx` cuando se usa la página maestra de `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-177">Figure 4 shows `Default.aspx` when using the `Alternate.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="ae5a4-178">ASP.NET incluye la capacidad de definir *temas*.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-178">ASP.NET includes the ability to define *Themes*.</span></span> <span data-ttu-id="ae5a4-179">Un tema es una colección de imágenes, archivos CSS y valores de propiedad de control Web relacionados con el estilo que se pueden aplicar a una página en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-179">A Theme is a collection of images, CSS files, and style-related Web control property settings that can be applied to a page at runtime.</span></span> <span data-ttu-id="ae5a4-180">Los temas son la manera de ir si los diseños de su sitio difieren solo en las imágenes mostradas y según sus reglas de CSS.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-180">Themes are the way to go if your site's layouts differ only in the images displayed and by their CSS rules.</span></span> <span data-ttu-id="ae5a4-181">Si los diseños difieren de forma más sustancial, como usar controles Web diferentes o tener un diseño radicalmente diferente, tendrá que usar páginas maestras independientes.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-181">If the layouts differ more substantially, such as using different Web controls or having a radically different layout, then you will need to use separate master pages.</span></span> <span data-ttu-id="ae5a4-182">Consulte la sección lecturas adicionales al final de este tutorial para obtener más información sobre los temas.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-182">Consult the Further Reading section at the end of this tutorial for more information on Themes.</span></span>

<span data-ttu-id="ae5a4-183">[![nuestras páginas de contenido ahora pueden usar una nueva apariencia y funcionamiento](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-183">[![Our Content Pages Can Now Use a New Look and Feel](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span></span>

<span data-ttu-id="ae5a4-184">**Figura 04**: las páginas de contenido ahora pueden usar una nueva apariencia y funcionamiento ([haga clic para ver la imagen de tamaño completo](specifying-the-master-page-programmatically-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ae5a4-184">**Figure 04**: Our Content Pages Can Now Use a New Look and Feel ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image12.png))</span></span>

<span data-ttu-id="ae5a4-185">Cuando se fusiona el marcado de las páginas maestra y de contenido, la clase `MasterPage` comprueba para asegurarse de que todos los controles de contenido de la página de contenido hagan referencia a un control ContentPlaceHolder en la página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-185">When the master and content pages' markup are fused, the `MasterPage` class checks to ensure that every Content control in the content page references a ContentPlaceHolder in the master page.</span></span> <span data-ttu-id="ae5a4-186">Se produce una excepción si se encuentra un control de contenido que hace referencia a un ContentPlaceHolder no existente.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-186">An exception is thrown if a Content control that references a non-existent ContentPlaceHolder is found.</span></span> <span data-ttu-id="ae5a4-187">En otras palabras, es imperativo que la página maestra que se asigna a la página de contenido tenga un ContentPlaceHolder para cada control de contenido en la página de contenido.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-187">In other words, it is imperative that the master page being assigned to the content page have a ContentPlaceHolder for each Content control in the content page.</span></span>

<span data-ttu-id="ae5a4-188">La página maestra de `Site.master` incluye cuatro controles ContentPlaceHolder:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-188">The `Site.master` master page includes four ContentPlaceHolder controls:</span></span>

- `head`
- `MainContent`
- `QuickLoginUI`
- `LeftColumnContent`

<span data-ttu-id="ae5a4-189">Algunas de las páginas de contenido del sitio web incluyen solo uno o dos controles de contenido. otros incluyen un control de contenido para cada uno de los ContentPlaceHolders disponibles.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-189">Some of the content pages in our website include just one or two Content controls; others include a Content control for each of the available ContentPlaceHolders.</span></span> <span data-ttu-id="ae5a4-190">Si la nueva página maestra (`Alternate.master`) se puede asignar alguna vez a las páginas de contenido que tienen controles de contenido para todos los ContentPlaceHolders en `Site.master`, es esencial que `Alternate.master` incluya también los mismos controles de ContentPlaceHolder que `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-190">If our new master page (`Alternate.master`) may ever be assigned to those content pages that have Content controls for all of the ContentPlaceHolders in `Site.master` then it is essential that `Alternate.master` also include the same ContentPlaceHolder controls as `Site.master`.</span></span>

<span data-ttu-id="ae5a4-191">Para que la página maestra de `Alternate.master` tenga un aspecto similar al mío (vea la ilustración 4), empiece por definir los estilos de la página maestra en la hoja de estilos de `AlternateStyles.css`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-191">To get your `Alternate.master` master page to look similar to mine (see Figure 4), start by defining the master page's styles in the `AlternateStyles.css` style sheet.</span></span> <span data-ttu-id="ae5a4-192">Agregue las siguientes reglas en `AlternateStyles.css`:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-192">Add the following rules into `AlternateStyles.css`:</span></span>

[!code-css[Main](specifying-the-master-page-programmatically-vb/samples/sample5.css)]

<span data-ttu-id="ae5a4-193">A continuación, agregue el siguiente marcado declarativo a `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-193">Next, add the following declarative markup to `Alternate.master`.</span></span> <span data-ttu-id="ae5a4-194">Como puede ver, `Alternate.master` contiene cuatro controles ContentPlaceHolder con los mismos valores `ID` que los controles ContentPlaceHolder en `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-194">As you can see, `Alternate.master` contains four ContentPlaceHolder controls with the same `ID` values as the ContentPlaceHolder controls in `Site.master`.</span></span> <span data-ttu-id="ae5a4-195">Además, incluye un control ScriptManager, que es necesario para las páginas del sitio web que usan el marco de ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-195">Moreover, it includes a ScriptManager control, which is necessary for those pages in our website that use the ASP.NET AJAX framework.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample6.aspx)]

### <a name="testing-the-new-master-page"></a><span data-ttu-id="ae5a4-196">Probar la nueva página maestra</span><span class="sxs-lookup"><span data-stu-id="ae5a4-196">Testing the New Master Page</span></span>

<span data-ttu-id="ae5a4-197">Para probar esta nueva página maestra, actualice el método `OnPreInit` de la clase `BasePage` para que se asigne a la propiedad `MasterPageFile` el valor `"~/Alternate.maser"` y, a continuación, visite el sitio Web.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-197">To test this new master page update the `BasePage` class's `OnPreInit` method so that the `MasterPageFile` property is assigned the value `"~/Alternate.maser"` and then visit the website.</span></span> <span data-ttu-id="ae5a4-198">Cada página debe funcionar sin errores excepto en dos: `~/Admin/AddProduct.aspx` y `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-198">Every page should function without error except for two: `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="ae5a4-199">La adición de un producto a DetailsView en `~/Admin/AddProduct.aspx` da como resultado un `NullReferenceException` de la línea de código que intenta establecer la propiedad `GridMessageText` de la página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-199">Adding a product to the DetailsView in `~/Admin/AddProduct.aspx` results in a `NullReferenceException` from the line of code that attempts to set the master page's `GridMessageText` property.</span></span> <span data-ttu-id="ae5a4-200">Al visitar `~/Admin/Products.aspx` se inicia una `InvalidCastException` en la carga de la página con el mensaje: "no se puede convertir el objeto de tipo ' ASP. alterno\_Master ' al tipo ' ASP. site\_Master '".</span><span class="sxs-lookup"><span data-stu-id="ae5a4-200">When visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown on page load with the message: "Unable to cast object of type 'ASP.alternate\_master' to type 'ASP.site\_master'."</span></span>

<span data-ttu-id="ae5a4-201">Estos errores se producen porque el `Site.master` clase de código subyacente incluye eventos, propiedades y métodos públicos que no están definidos en `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-201">These errors occur because the `Site.master` code-behind class includes public events, properties, and methods that are not defined in `Alternate.master`.</span></span> <span data-ttu-id="ae5a4-202">La parte de marcado de estas dos páginas tiene una directiva de `@MasterType` que hace referencia a la página maestra de `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-202">The markup portion of these two pages have a `@MasterType` directive that references the `Site.master` master page.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample7.aspx)]

<span data-ttu-id="ae5a4-203">Además, el controlador de eventos `ItemInserted` de DetailsView en `~/Admin/AddProduct.aspx` incluye código que convierte la propiedad `Page.Master` con tipo flexible en un objeto de tipo `Site`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-203">Also, the DetailsView's `ItemInserted` event handler in `~/Admin/AddProduct.aspx` includes code that casts the loosely-typed `Page.Master` property to an object of type `Site`.</span></span> <span data-ttu-id="ae5a4-204">La Directiva `@MasterType` (usada de esta manera) y la conversión en el controlador de eventos `ItemInserted` acoplan estrechamente las páginas `~/Admin/AddProduct.aspx` y `~/Admin/Products.aspx` a la página maestra de `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-204">The `@MasterType` directive (used this way) and the cast in the `ItemInserted` event handler tightly couples the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to the `Site.master` master page.</span></span>

<span data-ttu-id="ae5a4-205">Para romper este acoplamiento estrecho, podemos tener `Site.master` y `Alternate.master` derivan de una clase base común que contiene las definiciones de los miembros públicos.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-205">To break this tight coupling we can have `Site.master` and `Alternate.master` derive from a common base class that contains definitions for the public members.</span></span> <span data-ttu-id="ae5a4-206">A continuación, se puede actualizar la Directiva de `@MasterType` para hacer referencia a este tipo base común.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-206">Following that, we can update the `@MasterType` directive to reference this common base type.</span></span>

### <a name="creating-a-custom-base-master-page-class"></a><span data-ttu-id="ae5a4-207">Crear una clase de página maestra base personalizada</span><span class="sxs-lookup"><span data-stu-id="ae5a4-207">Creating a Custom Base Master Page Class</span></span>

<span data-ttu-id="ae5a4-208">Agregue un nuevo archivo de clase a la carpeta `App_Code` denominada `BaseMasterPage.vb` y haga que se derive de `System.Web.UI.MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-208">Add a new class file to the `App_Code` folder named `BaseMasterPage.vb` and have it derive from `System.Web.UI.MasterPage`.</span></span> <span data-ttu-id="ae5a4-209">Es necesario definir el método `RefreshRecentProductsGrid` y la propiedad `GridMessageText` en `BaseMasterPage`, pero no se pueden mover directamente desde `Site.master` porque estos miembros trabajan con controles Web específicos de la página maestra de `Site.master` (la `RecentProducts` la etiqueta GridView y `GridMessage`).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-209">We need to define the `RefreshRecentProductsGrid` method and the `GridMessageText` property in `BaseMasterPage`, but we can't simply move them there from `Site.master` because these members work with Web controls that are specific to the `Site.master` master page (the `RecentProducts` GridView and `GridMessage` Label).</span></span>

<span data-ttu-id="ae5a4-210">Lo que debemos hacer es configurar `BaseMasterPage` de forma que estos miembros se definan allí, pero se implementan en las clases derivadas de `BaseMasterPage`(`Site.master` y `Alternate.master`).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-210">What we need to do is configure `BaseMasterPage` in such a way that these members are defined there, but are actually implemented by `BaseMasterPage`'s derived classes (`Site.master` and `Alternate.master`).</span></span> <span data-ttu-id="ae5a4-211">Este tipo de herencia es posible marcando la clase como `MustInherit` y sus miembros como `MustOverride`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-211">This type of inheritance is possible by marking the class as `MustInherit` and its members as `MustOverride`.</span></span> <span data-ttu-id="ae5a4-212">En Resumen, agregar estas palabras clave a la clase y sus dos miembros anuncian que `BaseMasterPage` no ha implementado `RefreshRecentProductsGrid` y `GridMessageText`, pero que son sus clases derivadas.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-212">In short, adding these keywords to the class and its two members announces that `BaseMasterPage` hasn't implemented `RefreshRecentProductsGrid` and `GridMessageText`, but that its derived classes will.</span></span>

<span data-ttu-id="ae5a4-213">También necesitamos definir el evento `PricesDoubled` en `BaseMasterPage` y proporcionar un medio por las clases derivadas para generar el evento.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-213">We also need to define the `PricesDoubled` event in `BaseMasterPage` and provide a means by the derived classes to raise the event.</span></span> <span data-ttu-id="ae5a4-214">El patrón utilizado en el .NET Framework para facilitar este comportamiento es crear un evento público en la clase base y agregar un método protegido y reemplazable denominado `OnEventName`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-214">The pattern used in the .NET Framework to facilitate this behavior is to create a public event in the base class and add a protected, overridable method named `OnEventName`.</span></span> <span data-ttu-id="ae5a4-215">Después, las clases derivadas pueden llamar a este método para generar el evento o puede invalidarlo para ejecutar el código inmediatamente antes o después de que se produzca el evento.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-215">Derived classes can then call this method to raise the event or can override it to execute code immediately before or after the event is raised.</span></span>

<span data-ttu-id="ae5a4-216">Actualice la clase de `BaseMasterPage` para que contenga el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-216">Update your `BaseMasterPage` class so that it contains the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample8.vb)]

<span data-ttu-id="ae5a4-217">A continuación, vaya a la clase de código subyacente `Site.master` y haga que se derive de `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-217">Next, go to the `Site.master` code-behind class and have it derive from `BaseMasterPage`.</span></span> <span data-ttu-id="ae5a4-218">Dado que `BaseMasterPage` contiene miembros marcados `MustOverride` necesitamos invalidar esos miembros aquí en `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-218">Because `BaseMasterPage` contains members marked `MustOverride` we need to override those members here in `Site.master`.</span></span> <span data-ttu-id="ae5a4-219">Agregue la palabra clave `Overrides` a las definiciones de método y propiedad.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-219">Add the `Overrides` keyword to the method and property definitions.</span></span> <span data-ttu-id="ae5a4-220">Actualice también el código que genera el evento `PricesDoubled` en el controlador de eventos `Click` del botón `DoublePrice` con una llamada al método `OnPricesDoubled` de la clase base.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-220">Also update the code that raises the `PricesDoubled` event in the `DoublePrice` Button's `Click` event handler with a call to the base class's `OnPricesDoubled` method.</span></span>

<span data-ttu-id="ae5a4-221">Después de estas modificaciones, la clase de código subyacente `Site.master` debe contener el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-221">After these modifications the `Site.master` code-behind class should contain the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample9.vb)]

<span data-ttu-id="ae5a4-222">También necesitamos actualizar la clase de código subyacente de `Alternate.master`para que se derive de `BaseMasterPage` e invalide los dos miembros de `MustOverride`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-222">We also need to update `Alternate.master`'s code-behind class to derive from `BaseMasterPage` and override the two `MustOverride` members.</span></span> <span data-ttu-id="ae5a4-223">Pero como `Alternate.master` no contiene un control GridView que Enumere los productos más recientes ni una etiqueta que muestre un mensaje después de agregar un nuevo producto a la base de datos, estos métodos no tienen que hacer nada.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-223">But because `Alternate.master` does not contain a GridView that lists the most recent products nor a Label that displays a message after a new product is added to the database, these methods do not need to do anything.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample10.vb)]

### <a name="referencing-the-base-master-page-class"></a><span data-ttu-id="ae5a4-224">Referencia a la clase de página maestra base</span><span class="sxs-lookup"><span data-stu-id="ae5a4-224">Referencing the Base Master Page Class</span></span>

<span data-ttu-id="ae5a4-225">Ahora que hemos completado la clase `BaseMasterPage` y que nuestras dos páginas maestras la extienden, nuestro último paso es actualizar las páginas `~/Admin/AddProduct.aspx` y `~/Admin/Products.aspx` para hacer referencia a este tipo común.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-225">Now that we have completed the `BaseMasterPage` class and have our two master pages extending it, our final step is to update the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to refer to this common type.</span></span> <span data-ttu-id="ae5a4-226">Empiece por cambiar la Directiva de `@MasterType` en ambas páginas de:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-226">Start by changing the `@MasterType` directive in both pages from:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample11.aspx)]

<span data-ttu-id="ae5a4-227">A:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-227">To:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample12.aspx)]

<span data-ttu-id="ae5a4-228">En lugar de hacer referencia a una ruta de acceso de archivo, la propiedad `@MasterType` ahora hace referencia al tipo base (`BaseMasterPage`).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-228">Rather than referencing a file path, the `@MasterType` property now references the base type (`BaseMasterPage`).</span></span> <span data-ttu-id="ae5a4-229">Por consiguiente, la propiedad fuertemente tipada `Master` utilizada en las clases de código subyacente de ambas páginas es ahora de tipo `BaseMasterPage` (en lugar de tipo `Site`).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-229">Consequently, the strongly-typed `Master` property used in both pages' code-behind classes is now of type `BaseMasterPage` (instead of type `Site`).</span></span> <span data-ttu-id="ae5a4-230">Con este cambio en el lugar de la revisita `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-230">With this change in place revisit `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="ae5a4-231">Anteriormente, esto producía un error de conversión porque la página se configuró para usar la página maestra de `Alternate.master`, pero la Directiva de `@MasterType` hacía referencia al archivo `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-231">Previously, this resulted in a casting error because the page is configured to use the `Alternate.master` master page, but the `@MasterType` directive referenced the `Site.master` file.</span></span> <span data-ttu-id="ae5a4-232">Pero ahora la página se representa sin errores.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-232">But now the page renders without error.</span></span> <span data-ttu-id="ae5a4-233">Esto se debe a que la página maestra de `Alternate.master` se puede convertir en un objeto de tipo `BaseMasterPage` (ya que lo extiende).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-233">This is because the `Alternate.master` master page can be cast to an object of type `BaseMasterPage` (since it extends it).</span></span>

<span data-ttu-id="ae5a4-234">Hay un pequeño cambio que se debe realizar en `~/Admin/AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-234">There's one small change that needs to be made in `~/Admin/AddProduct.aspx`.</span></span> <span data-ttu-id="ae5a4-235">El controlador de eventos `ItemInserted` del control DetailsView utiliza la propiedad fuertemente tipada `Master` y la propiedad `Page.Master` de tipo flexible.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-235">The DetailsView control's `ItemInserted` event handler uses both the strongly-typed `Master` property and the loosely-typed `Page.Master` property.</span></span> <span data-ttu-id="ae5a4-236">Hemos corregido la referencia fuertemente tipada cuando se actualizó la Directiva de `@MasterType`, pero todavía necesitamos actualizar la referencia de tipo flexible.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-236">We fixed the strongly-typed reference when we updated the `@MasterType` directive, but we still need to update the loosely-typed reference.</span></span> <span data-ttu-id="ae5a4-237">Reemplace la siguiente línea de código:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-237">Replace the following line of code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample13.vb)]

<span data-ttu-id="ae5a4-238">Con lo siguiente, que convierte `Page.Master` al tipo base:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-238">With the following, which casts `Page.Master` to the base type:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample14.vb)]

## <a name="step-4-determining-what-master-page-to-bind-to-the-content-pages"></a><span data-ttu-id="ae5a4-239">Paso 4: determinar qué página maestra se va a enlazar a las páginas de contenido</span><span class="sxs-lookup"><span data-stu-id="ae5a4-239">Step 4: Determining What Master Page to Bind to the Content Pages</span></span>

<span data-ttu-id="ae5a4-240">En la clase `BasePage` se establecen actualmente todas las propiedades de `MasterPageFile` de las páginas de contenido en un valor codificado de forma rígida en la fase de preinicialización del ciclo de vida de la página.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-240">Our `BasePage` class currently sets all content pages' `MasterPageFile` properties to a hard-coded value in the PreInit stage of the page lifecycle.</span></span> <span data-ttu-id="ae5a4-241">Podemos actualizar este código para basar la página maestra en un factor externo.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-241">We can update this code to base the master page on some external factor.</span></span> <span data-ttu-id="ae5a4-242">Quizás la página maestra que se va a cargar depende de las preferencias del usuario que ha iniciado sesión actualmente.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-242">Perhaps the master page to load depends on the preferences of the currently logged on user.</span></span> <span data-ttu-id="ae5a4-243">En ese caso, es necesario escribir código en el método `OnPreInit` en `BasePage` que busca las preferencias de la página maestra del usuario que se visita actualmente.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-243">In that case, we'd need to write code in the `OnPreInit` method in `BasePage` that looks up the currently visiting user's master page preferences.</span></span>

<span data-ttu-id="ae5a4-244">Vamos a crear una página web que permite al usuario elegir la página maestra que se va a usar: `Site.master` o `Alternate.master` y guardar esta opción en una variable de sesión.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-244">Let's create a web page that allows the user to choose which master page to use - `Site.master` or `Alternate.master` - and save this choice in a Session variable.</span></span> <span data-ttu-id="ae5a4-245">Empiece por crear una nueva página web en el directorio raíz denominado `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-245">Start by creating a new web page in the root directory named `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="ae5a4-246">Al crear esta página (o cualquier otra página de contenido en adelante), no es necesario enlazarla a una página maestra porque la página maestra se establece mediante programación en `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-246">When creating this page (or any other content pages henceforth) you don't need to bind it to a master page because the master page is set programmatically in `BasePage`.</span></span> <span data-ttu-id="ae5a4-247">Sin embargo, si no enlaza la nueva página a una página maestra, el marcado declarativo predeterminado de la nueva página contiene un formulario web y otro contenido proporcionado por la página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-247">However, if you do not bind the new page to a master page then the new page's default declarative markup contains a Web Form and other content supplied by the master page.</span></span> <span data-ttu-id="ae5a4-248">Deberá reemplazar manualmente este marcado con los controles de contenido adecuados.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-248">You'll need to manually replace this markup with the appropriate Content controls.</span></span> <span data-ttu-id="ae5a4-249">Por ese motivo, me resulta más fácil enlazar la nueva página de ASP.NET a una página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-249">For that reason, I find it easier to bind the new ASP.NET page to a master page.</span></span>

> [!NOTE]
> <span data-ttu-id="ae5a4-250">Dado que `Site.master` y `Alternate.master` tienen el mismo conjunto de controles de ContentPlaceHolder, no importa qué página maestra elija al crear la nueva página de contenido.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-250">Because `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls it doesn't matter what master page you choose when creating the new content page.</span></span> <span data-ttu-id="ae5a4-251">Por coherencia, recomiendo usar `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-251">For consistency, I'd suggest using `Site.master`.</span></span>

<span data-ttu-id="ae5a4-252">[![agregar una nueva página de contenido al sitio web](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-252">[![Add a New Content Page to the Website](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span></span>

<span data-ttu-id="ae5a4-253">**Figura 05**: agregar una nueva página de contenido al sitio web ([haga clic para ver la imagen de tamaño completo](specifying-the-master-page-programmatically-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ae5a4-253">**Figure 05**: Add a New Content Page to the Website ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image15.png))</span></span>

<span data-ttu-id="ae5a4-254">Actualice el archivo de `Web.sitemap` para incluir una entrada para esta lección.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-254">Update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="ae5a4-255">Agregue el siguiente marcado debajo del `<siteMapNode>` para la lección páginas maestras y ASP.NET AJAX:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-255">Add the following markup beneath the `<siteMapNode>` for the Master Pages and ASP.NET AJAX lesson:</span></span>

[!code-xml[Main](specifying-the-master-page-programmatically-vb/samples/sample15.xml)]

<span data-ttu-id="ae5a4-256">Antes de agregar contenido a la página de `ChooseMasterPage.aspx`, dedique un momento a actualizar la clase de código subyacente de la página para que se derive de `BasePage` (en lugar de `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-256">Before adding any content to the `ChooseMasterPage.aspx` page take a moment to update the page's code-behind class so that it derives from `BasePage` (rather than `System.Web.UI.Page`).</span></span> <span data-ttu-id="ae5a4-257">Después, agregue un control DropDownList a la página, establezca su propiedad `ID` en `MasterPageChoice`y agregue dos ListItems con los valores `Text` de "~/site.Master" y "~/Alternate.Master".</span><span class="sxs-lookup"><span data-stu-id="ae5a4-257">Next, add a DropDownList control to the page, set its `ID` property to `MasterPageChoice`, and add two ListItems with the `Text` values of "~/Site.master" and "~/Alternate.master".</span></span>

<span data-ttu-id="ae5a4-258">Agregue un control Web de botón a la página y establezca sus propiedades `ID` y `Text` en `SaveLayout` y "guardar opción de diseño", respectivamente.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-258">Add a Button Web control to the page and set its `ID` and `Text` properties to `SaveLayout` and "Save Layout Choice", respectively.</span></span> <span data-ttu-id="ae5a4-259">En este momento, el marcado declarativo de la página debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-259">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample16.aspx)]

<span data-ttu-id="ae5a4-260">Cuando se visita la página por primera vez, es necesario mostrar la opción de la página maestra seleccionada actualmente por el usuario.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-260">When the page is first visited we need to display the user's currently selected master page choice.</span></span> <span data-ttu-id="ae5a4-261">Cree un controlador de eventos `Page_Load` y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-261">Create a `Page_Load` event handler and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample17.vb)]

<span data-ttu-id="ae5a4-262">El código anterior solo se ejecuta en la primera visita de la página (y no en los postbacks posteriores).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-262">The above code executes only on the first page visit (and not on subsequent postbacks).</span></span> <span data-ttu-id="ae5a4-263">En primer lugar, comprueba para ver si existe la variable de sesión `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-263">It first checks to see if the Session variable `MyMasterPage` exists.</span></span> <span data-ttu-id="ae5a4-264">Si lo hace, intenta encontrar el ListItem correspondiente en el `MasterPageChoice` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-264">If it does, it attempts to find the matching ListItem in the `MasterPageChoice` DropDownList.</span></span> <span data-ttu-id="ae5a4-265">Si se encuentra un ListItem coincidente, su propiedad `Selected` se establece en `True`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-265">If a matching ListItem is found, its `Selected` property is set to `True`.</span></span>

<span data-ttu-id="ae5a4-266">También necesitamos código que guarde la elección del usuario en la variable de sesión `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-266">We also need code that saves the user's choice into the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="ae5a4-267">Cree un controlador de eventos para el evento de `Click` del botón `SaveLayout` y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-267">Create an event handler for the `SaveLayout` Button's `Click` event and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample18.vb)]

> [!NOTE]
> <span data-ttu-id="ae5a4-268">En el momento en que se ejecuta el controlador de eventos `Click` en el postback, ya se ha seleccionado la página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-268">By the time the `Click` event handler executes on postback, the master page has already been selected.</span></span> <span data-ttu-id="ae5a4-269">Por lo tanto, la selección de la lista desplegable del usuario no estará en vigor hasta que visite la siguiente página.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-269">Therefore, the user's drop-down list selection won't be in effect until the next page visit.</span></span> <span data-ttu-id="ae5a4-270">El `Response.Redirect` obliga al explorador a volver a solicitar `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-270">The `Response.Redirect` forces the browser to re-request `ChooseMasterPage.aspx`.</span></span>

<span data-ttu-id="ae5a4-271">Una vez completada la página `ChooseMasterPage.aspx`, nuestra tarea final es tener `BasePage` asignar la propiedad `MasterPageFile` basada en el valor de la variable de sesión `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-271">With the `ChooseMasterPage.aspx` page complete, our final task is to have `BasePage` assign the `MasterPageFile` property based on the value of the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="ae5a4-272">Si la variable de sesión no está establecida, `BasePage` establecer el valor predeterminado en `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-272">If the Session variable is not set have `BasePage` default to `Site.master`.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample19.vb)]

> [!NOTE]
> <span data-ttu-id="ae5a4-273">He cambiado el código que asigna la propiedad `MasterPageFile` del objeto `Page` del controlador de eventos `OnPreInit` y en dos métodos independientes.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-273">I moved the code that assigns the `Page` object's `MasterPageFile` property out of the `OnPreInit` event handler and into two separate methods.</span></span> <span data-ttu-id="ae5a4-274">Este primer método, `SetMasterPageFile`, asigna la propiedad `MasterPageFile` al valor devuelto por el segundo método, `GetMasterPageFileFromSession`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-274">This first method, `SetMasterPageFile`, assigns the `MasterPageFile` property to the value returned by the second method, `GetMasterPageFileFromSession`.</span></span> <span data-ttu-id="ae5a4-275">He marcado el método `SetMasterPageFile` `Overridable` para que las clases futuras que amplían `BasePage` puedan reemplazarlo opcionalmente para implementar la lógica personalizada, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-275">I marked the `SetMasterPageFile` method `Overridable` so that future classes that extend `BasePage` can optionally override it to implement custom logic, if needed.</span></span> <span data-ttu-id="ae5a4-276">Veremos un ejemplo de cómo invalidar la propiedad `SetMasterPageFile` de `BasePage`en el siguiente tutorial.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-276">We'll see an example of overriding `BasePage`'s `SetMasterPageFile` property in the next tutorial.</span></span>

<span data-ttu-id="ae5a4-277">Con este código en su lugar, visite la página `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-277">With this code in place, visit the `ChooseMasterPage.aspx` page.</span></span> <span data-ttu-id="ae5a4-278">Inicialmente, se selecciona la página maestra de `Site.master` (vea la figura 6), pero el usuario puede elegir una página maestra diferente de la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-278">Initially, the `Site.master` master page is selected (see Figure 6), but the user can pick a different master page from the drop-down list.</span></span>

<span data-ttu-id="ae5a4-279">[![las páginas de contenido se muestran mediante la página maestra site. Master](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-279">[![Content Pages are Displayed Using the Site.master Master Page](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span></span>

<span data-ttu-id="ae5a4-280">**Figura 06**: las páginas de contenido se muestran en la página maestra de `Site.master` ([haga clic para ver la imagen a tamaño completo](specifying-the-master-page-programmatically-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="ae5a4-280">**Figure 06**: Content Pages are Displayed Using the `Site.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image18.png))</span></span>

<span data-ttu-id="ae5a4-281">[![páginas de contenido se muestran ahora mediante la página maestra alternativa.](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-281">[![Content Pages are Now Displayed Using the Alternate.master Master Page](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span></span>

<span data-ttu-id="ae5a4-282">**Figura 07**: las páginas de contenido se muestran ahora en la página maestra de `Alternate.master` ([haga clic para ver la imagen a tamaño completo](specifying-the-master-page-programmatically-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ae5a4-282">**Figure 07**: Content Pages are Now Displayed Using the `Alternate.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image21.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ae5a4-283">Resumen</span><span class="sxs-lookup"><span data-stu-id="ae5a4-283">Summary</span></span>

<span data-ttu-id="ae5a4-284">Cuando se visita una página de contenido, sus controles de contenido se fusionan con los controles ContentPlaceHolder de la página maestra.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-284">When a content page is visited, its Content controls are fused with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="ae5a4-285">La página maestra de la página de contenido se indica mediante la propiedad `MasterPageFile` de la clase `Page`, que se asigna al atributo `MasterPageFile` de la Directiva `@Page` durante la fase de inicialización.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-285">The content page's master page is denoted by the `Page` class's `MasterPageFile` property, which is assigned to the `@Page` directive's `MasterPageFile` attribute during the Initialization stage.</span></span> <span data-ttu-id="ae5a4-286">Como se ha mostrado en este tutorial, podemos asignar un valor a la propiedad `MasterPageFile`, siempre y cuando lo hagamos antes del final de la fase de PreInit.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-286">As this tutorial showed, we can assign a value to the `MasterPageFile` property as long as we do so before the end of the PreInit stage.</span></span> <span data-ttu-id="ae5a4-287">La posibilidad de especificar mediante programación la página maestra abre la puerta para escenarios más avanzados, como enlazar dinámicamente una página de contenido a una página maestra basada en factores externos.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-287">Being able to programmatically specify the master page opens the door for more advanced scenarios, such as dynamically binding a content page to a master page based on external factors.</span></span>

<span data-ttu-id="ae5a4-288">¡ Feliz programación!</span><span class="sxs-lookup"><span data-stu-id="ae5a4-288">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="ae5a4-289">Información adicional</span><span class="sxs-lookup"><span data-stu-id="ae5a4-289">Further Reading</span></span>

<span data-ttu-id="ae5a4-290">Para obtener más información sobre los temas descritos en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="ae5a4-290">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="ae5a4-291">Diagrama del ciclo de vida de la página ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ae5a4-291">ASP.NET Page Lifecycle Diagram</span></span>](http://emanish.googlepages.com/Asp.Net2.0Lifecycle.PNG)
- [<span data-ttu-id="ae5a4-292">Información general del ciclo de vida de la página ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ae5a4-292">ASP.NET Page Lifecycle Overview</span></span>](https://msdn.microsoft.com/library/ms178472.aspx)
- [<span data-ttu-id="ae5a4-293">Información general sobre temas y máscaras de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ae5a4-293">ASP.NET Themes and Skins Overview</span></span>](https://msdn.microsoft.com/library/ykzx33wh.aspx)
- [<span data-ttu-id="ae5a4-294">Páginas maestras: sugerencias, trucos y capturas</span><span class="sxs-lookup"><span data-stu-id="ae5a4-294">Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="ae5a4-295">Temas de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ae5a4-295">Themes in ASP.NET</span></span>](http://www.odetocode.com/articles/423.aspx)

### <a name="about-the-author"></a><span data-ttu-id="ae5a4-296">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="ae5a4-296">About the Author</span></span>

<span data-ttu-id="ae5a4-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de varios libros de ASP/ASP. net y fundador de 4GuysFromRolla.com, ha estado trabajando con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ae5a4-298">Scott funciona como consultor, profesor y redactor independiente.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-298">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ae5a4-299">Su último libro se [*enseña a ASP.NET 3,5 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-299">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="ae5a4-300">Se puede acceder a Scott en [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) o a través de su blog en [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="ae5a4-300">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="ae5a4-301">Agradecimiento especial a</span><span class="sxs-lookup"><span data-stu-id="ae5a4-301">Special Thanks To</span></span>

<span data-ttu-id="ae5a4-302">Muchos revisores útiles revisaron esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-302">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ae5a4-303">El revisor responsable de este tutorial fue Banerjee.</span><span class="sxs-lookup"><span data-stu-id="ae5a4-303">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="ae5a4-304">¿Está interesado en revisar los próximos artículos de MSDN?</span><span class="sxs-lookup"><span data-stu-id="ae5a4-304">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ae5a4-305">Si es así, coloque una línea en [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-305">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ae5a4-306">[Anterior](master-pages-and-asp-net-ajax-vb.md)
> [Siguiente](nested-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ae5a4-306">[Previous](master-pages-and-asp-net-ajax-vb.md)
[Next](nested-master-pages-vb.md)</span></span>
